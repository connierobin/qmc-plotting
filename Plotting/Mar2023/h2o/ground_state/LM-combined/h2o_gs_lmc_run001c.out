Rank =    0  Free Memory = 86257 MB
Rank =    1  Free Memory = 86257 MB
Rank =    2  Free Memory = 86257 MB
Rank =    3  Free Memory = 86257 MB
Rank =    4  Free Memory = 86256 MB
Rank =    5  Free Memory = 86256 MB
Rank =    6  Free Memory = 86256 MB
Rank =    7  Free Memory = 86256 MB
Rank =    8  Free Memory = 86255 MB
Rank =    9  Free Memory = 86254 MB
Rank =   10  Free Memory = 86254 MB
Rank =   11  Free Memory = 86254 MB
Rank =   12  Free Memory = 86254 MB
Rank =   13  Free Memory = 86253 MB
Rank =   14  Free Memory = 86253 MB
Rank =   15  Free Memory = 86238 MB
Rank =   16  Free Memory = 86238 MB
Rank =   17  Free Memory = 86238 MB
Rank =   18  Free Memory = 86238 MB
Rank =   19  Free Memory = 86238 MB
Rank =   20  Free Memory = 86238 MB
Rank =   21  Free Memory = 86238 MB
Rank =   22  Free Memory = 86238 MB
Rank =   23  Free Memory = 86238 MB
Rank =   24  Free Memory = 86238 MB
Rank =   25  Free Memory = 86238 MB
Rank =   26  Free Memory = 86238 MB
Rank =   27  Free Memory = 86238 MB
Rank =   28  Free Memory = 86238 MB
Rank =   29  Free Memory = 86238 MB
Rank =   30  Free Memory = 86238 MB
Rank =   31  Free Memory = 86238 MB
Rank =   32  Free Memory = 83922 MB
Rank =   33  Free Memory = 83922 MB
Rank =   34  Free Memory = 83922 MB
Rank =   35  Free Memory = 83922 MB
Rank =   36  Free Memory = 83922 MB
Rank =   37  Free Memory = 83922 MB
Rank =   38  Free Memory = 83922 MB
Rank =   39  Free Memory = 83922 MB
Rank =   40  Free Memory = 83922 MB
Rank =   41  Free Memory = 83922 MB
Rank =   42  Free Memory = 83922 MB
Rank =   43  Free Memory = 83922 MB
Rank =   44  Free Memory = 83922 MB
Rank =   45  Free Memory = 83922 MB
Rank =   46  Free Memory = 83922 MB
Rank =   47  Free Memory = 83922 MB
Rank =   48  Free Memory = 83922 MB
Rank =   49  Free Memory = 83922 MB
Rank =   50  Free Memory = 83922 MB
Rank =   51  Free Memory = 83922 MB
Rank =   52  Free Memory = 83922 MB
Rank =   53  Free Memory = 83921 MB
Rank =   54  Free Memory = 83921 MB
Rank =   55  Free Memory = 83921 MB
Rank =   56  Free Memory = 83921 MB
Rank =   57  Free Memory = 83921 MB
Rank =   58  Free Memory = 83921 MB
Rank =   59  Free Memory = 83921 MB
Rank =   60  Free Memory = 83921 MB
Rank =   61  Free Memory = 83921 MB
Rank =   62  Free Memory = 83921 MB
Rank =   63  Free Memory = 83921 MB
Rank =   64  Free Memory = 84497 MB
Rank =   65  Free Memory = 84497 MB
Rank =   66  Free Memory = 84496 MB
Rank =   67  Free Memory = 84496 MB
Rank =   68  Free Memory = 84496 MB
Rank =   69  Free Memory = 84496 MB
Rank =   70  Free Memory = 84496 MB
Rank =   71  Free Memory = 84496 MB
Rank =   72  Free Memory = 84496 MB
Rank =   73  Free Memory = 84496 MB
Rank =   74  Free Memory = 84495 MB
Rank =   75  Free Memory = 84495 MB
Rank =   76  Free Memory = 84495 MB
Rank =   77  Free Memory = 84495 MB
Rank =   78  Free Memory = 84495 MB
Rank =   79  Free Memory = 84495 MB
Rank =   80  Free Memory = 84495 MB
Rank =   81  Free Memory = 84495 MB
Rank =   82  Free Memory = 84495 MB
Rank =   83  Free Memory = 84495 MB
Rank =   84  Free Memory = 84494 MB
Rank =   85  Free Memory = 84494 MB
Rank =   86  Free Memory = 84494 MB
Rank =   87  Free Memory = 84494 MB
Rank =   88  Free Memory = 84494 MB
Rank =   89  Free Memory = 84494 MB
Rank =   90  Free Memory = 84494 MB
Rank =   91  Free Memory = 84494 MB
Rank =   92  Free Memory = 84494 MB
Rank =   93  Free Memory = 84494 MB
Rank =   94  Free Memory = 84494 MB
Rank =   95  Free Memory = 84494 MB
Rank =   96  Free Memory = 72000 MB
Rank =   97  Free Memory = 72000 MB
Rank =   98  Free Memory = 71999 MB
Rank =   99  Free Memory = 71999 MB
Rank =  100  Free Memory = 71999 MB
Rank =  101  Free Memory = 71999 MB
Rank =  102  Free Memory = 71999 MB
Rank =  103  Free Memory = 71999 MB
Rank =  104  Free Memory = 71999 MB
Rank =  105  Free Memory = 71999 MB
Rank =  106  Free Memory = 71999 MB
Rank =  107  Free Memory = 71999 MB
Rank =  108  Free Memory = 71999 MB
Rank =  109  Free Memory = 71999 MB
Rank =  110  Free Memory = 71999 MB
Rank =  111  Free Memory = 71999 MB
Rank =  112  Free Memory = 71999 MB
Rank =  113  Free Memory = 71999 MB
Rank =  114  Free Memory = 71999 MB
Rank =  115  Free Memory = 71999 MB
Rank =  116  Free Memory = 71999 MB
Rank =  117  Free Memory = 71999 MB
Rank =  118  Free Memory = 71999 MB
Rank =  119  Free Memory = 71999 MB
Rank =  120  Free Memory = 71999 MB
Rank =  121  Free Memory = 71999 MB
Rank =  122  Free Memory = 71999 MB
Rank =  123  Free Memory = 71999 MB
Rank =  124  Free Memory = 71999 MB
Rank =  125  Free Memory = 71999 MB
Rank =  126  Free Memory = 71999 MB
Rank =  127  Free Memory = 71999 MB
  Input file(s): opt_h2o_gs_lmc_run001c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_lmc_run001c.xml

  Project = H2O
  date    = 2023-03-03 12:26:28 PST
  host    = n0012.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 1012

  Range of prime numbers to use as seeds over processors and threads = 8069-9209


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.036799e-01    1         1  ON     0
     uu_1                 4.370039e-02    1         1  ON     1
     uu_2                -4.751526e-02    1         1  ON     2
     uu_3                -9.904437e-02    1         1  ON     3
     uu_4                -1.294219e-01    1         1  ON     4
     uu_5                -1.342281e-01    1         1  ON     5
     uu_6                -1.118892e-01    1         1  ON     6
     uu_7                -3.803740e-02    1         1  ON     7
     uu_8                 1.008668e-01    1         1  ON     8
     uu_9                 1.201848e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.471070e-01    1         1  ON     0
     ud_1                 8.998351e-02    1         1  ON     1
     ud_2                -1.727309e-02    1         1  ON     2
     ud_3                -7.538195e-02    1         1  ON     3
     ud_4                -1.203890e-01    1         1  ON     4
     ud_5                -1.507893e-01    1         1  ON     5
     ud_6                -1.541540e-01    1         1  ON     6
     ud_7                -1.094150e-01    1         1  ON     7
     ud_8                 5.948145e-03    1         1  ON     8
     ud_9                 9.251988e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.402288e-01    1         1  ON     0
     eO_1                -4.286506e-01    1         1  ON     1
     eO_2                -3.455094e-02    1         1  ON     2
     eO_3                 2.024933e-01    1         1  ON     3
     eO_4                 2.802468e-01    1         1  ON     4
     eO_5                 3.038408e-01    1         1  ON     5
     eO_6                 2.493764e-01    1         1  ON     6
     eO_7                 1.108766e-01    1         1  ON     7
     eO_8                 2.771128e-02    1         1  ON     8
     eO_9                 1.834436e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.814830e-01    1         1  ON     0
     eH1_1                -1.020714e-01    1         1  ON     1
     eH1_2                -6.230086e-02    1         1  ON     2
     eH1_3                -2.601353e-02    1         1  ON     3
     eH1_4                 1.958756e-02    1         1  ON     4
     eH1_5                 3.568262e-02    1         1  ON     5
     eH1_6                 7.685546e-02    1         1  ON     6
     eH1_7                 1.104950e-01    1         1  ON     7
     eH1_8                 9.001468e-02    1         1  ON     8
     eH1_9                 2.406849e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.826253e-01    1         1  ON     0
     eH2_1                -1.036000e-01    1         1  ON     1
     eH2_2                -6.368918e-02    1         1  ON     2
     eH2_3                -2.766797e-02    1         1  ON     3
     eH2_4                 1.867338e-02    1         1  ON     4
     eH2_5                 3.506271e-02    1         1  ON     5
     eH2_6                 7.835838e-02    1         1  ON     6
     eH2_7                 1.139679e-01    1         1  ON     7
     eH2_8                 9.324184e-02    1         1  ON     8
     eH2_9                 2.614975e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.710687e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.3947e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 119
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1783
    reference variance = 0.188447
====================================================
  Execution time = 2.1107e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2127e-01
  Total weights = 1.956573754e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301624712347
                                         uncertainty =       0.002210888158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301624712347
                                         uncertainty =       0.002210888158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388303352
  error estimate for blocks of size 2^( 2) =       0.000398020843
  error estimate for blocks of size 2^( 3) =       0.000406835359
  error estimate for blocks of size 2^( 4) =       0.000413585736
  error estimate for blocks of size 2^( 5) =       0.000417894175
  error estimate for blocks of size 2^( 6) =       0.000421127392
  error estimate for blocks of size 2^( 7) =       0.000423496367

      target function =                  N/A
              le_mean =     -17.216571906406
             les_mean =     296.731616575474
             stat err =       0.000419025917
             autocorr =       1.164499998250
              std dev =       0.549143866668
             le_variance =       0.301558986299


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721657190641e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216571906461       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216574338532       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216578669276       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216579565990       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216583963955       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216583648463       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216585028300       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216584624526       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216585561629       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216584794008       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216585349461       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216585102164       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216585177008       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216585190956       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e-01 is 3.768847e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216571906461       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216572867609       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216574475302       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216574552671       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216575392827       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216575522117       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216576185995       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216575948662       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216575990094       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216575887785       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216575971486       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+00 is 1.053117e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216571906461       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216572187564       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216572651222       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216572630701       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216572813337       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216572876898       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216573048035       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216573006089       residual = 9.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216572991145       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216572976494       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+00 is 2.704219e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7193e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0   2.039255e-01                 1 1 ON  0
uu_1   4.384656e-02                 1 1 ON  1
uu_2   -4.747652e-02                1 1 ON  2
uu_3   -9.907619e-02                1 1 ON  3
uu_4   -1.295121e-01                1 1 ON  4
uu_5   -1.343727e-01                1 1 ON  5
uu_6   -1.119987e-01                1 1 ON  6
uu_7   -3.815569e-02                1 1 ON  7
uu_8   1.008078e-01                 1 1 ON  8
uu_9   1.202355e-01                 1 1 ON  9
ud_0   3.474545e-01                 1 1 ON  10
ud_1   9.016898e-02                 1 1 ON  11
ud_2   -1.726434e-02                1 1 ON  12
ud_3   -7.553792e-02                1 1 ON  13
ud_4   -1.206183e-01                1 1 ON  14
ud_5   -1.509779e-01                1 1 ON  15
ud_6   -1.541116e-01                1 1 ON  16
ud_7   -1.094095e-01                1 1 ON  17
ud_8   5.867799e-03                 1 1 ON  18
ud_9   9.252616e-02                 1 1 ON  19
eO_0   -7.412819e-01                1 1 ON  20
eO_1   -4.293131e-01                1 1 ON  21
eO_2   -3.455267e-02                1 1 ON  22
eO_3   2.032228e-01                 1 1 ON  23
eO_4   2.810117e-01                 1 1 ON  24
eO_5   3.038388e-01                 1 1 ON  25
eO_6   2.494347e-01                 1 1 ON  26
eO_7   1.110077e-01                 1 1 ON  27
eO_8   2.773031e-02                 1 1 ON  28
eO_9   1.835464e-02                 1 1 ON  29
eH1_0  -1.816224e-01                1 1 ON  30
eH1_1  -1.021323e-01                1 1 ON  31
eH1_2  -6.232673e-02                1 1 ON  32
eH1_3  -2.602446e-02                1 1 ON  33
eH1_4  1.957644e-02                 1 1 ON  34
eH1_5  3.572985e-02                 1 1 ON  35
eH1_6  7.694318e-02                 1 1 ON  36
eH1_7  1.105025e-01                 1 1 ON  37
eH1_8  9.008952e-02                 1 1 ON  38
eH1_9  2.408891e-02                 1 1 ON  39
eH2_0  -1.827258e-01                1 1 ON  40
eH2_1  -1.036258e-01                1 1 ON  41
eH2_2  -6.365751e-02                1 1 ON  42
eH2_3  -2.757810e-02                1 1 ON  43
eH2_4  1.862507e-02                 1 1 ON  44
eH2_5  3.502549e-02                 1 1 ON  45
eH2_6  7.836782e-02                 1 1 ON  46
eH2_7  1.139333e-01                 1 1 ON  47
eH2_8  9.331419e-02                 1 1 ON  48
eH2_9  2.618043e-02                 1 1 ON  49
ci_001 -4.136658e-02                3 1 ON  50
ci_002 -3.017242e-02                3 1 ON  51
ci_003 -2.532578e-02                3 1 ON  52
ci_004 2.143206e-02                 3 1 ON  53
ci_005 2.142911e-02                 3 1 ON  54
ci_006 -1.881536e-02                3 1 ON  55
ci_007 -1.902488e-02                3 1 ON  56
ci_008 -1.798499e-02                3 1 ON  57
ci_009 -1.770263e-02                3 1 ON  58
ci_010 -1.792235e-02                3 1 ON  59
ci_011 -1.630054e-02                3 1 ON  60
ci_012 -1.629326e-02                3 1 ON  61
ci_013 -1.897988e-02                3 1 ON  62
ci_014 1.388383e-02                 3 1 ON  63
ci_015 1.390090e-02                 3 1 ON  64
ci_016 1.638566e-02                 3 1 ON  65
ci_017 1.657785e-02                 3 1 ON  66
ci_018 1.247732e-02                 3 1 ON  67
ci_019 1.267274e-02                 3 1 ON  68
ci_020 1.316092e-02                 3 1 ON  69
ci_021 1.357104e-02                 3 1 ON  70
ci_022 1.163810e-02                 3 1 ON  71
ci_023 1.140929e-02                 3 1 ON  72
ci_024 1.235671e-02                 3 1 ON  73
ci_025 1.191556e-02                 3 1 ON  74
ci_026 1.118331e-02                 3 1 ON  75
ci_027 1.145887e-02                 3 1 ON  76
ci_028 -1.445075e-02                3 1 ON  77
ci_029 -1.465535e-02                3 1 ON  78
ci_030 -1.091003e-02                3 1 ON  79
ci_031 -1.172164e-02                3 1 ON  80
ci_032 -1.357064e-02                3 1 ON  81
ci_033 1.074966e-02                 3 1 ON  82
ci_034 1.067381e-02                 3 1 ON  83
ci_035 -4.904168e-03                3 1 ON  84
ci_036 -1.081108e-02                3 1 ON  85
ci_037 -1.032395e-02                3 1 ON  86
ci_038 1.644701e-03                 3 1 ON  87
ci_039 2.034400e-03                 3 1 ON  88
ci_040 -4.029871e-03                3 1 ON  89
ci_041 1.006728e-02                 3 1 ON  90
ci_042 9.626582e-03                 3 1 ON  91
ci_043 -3.449109e-03                3 1 ON  92
ci_044 -1.537923e-02                3 1 ON  93
ci_045 -1.663500e-03                3 1 ON  94
ci_046 5.201424e-03                 3 1 ON  95
ci_047 5.930616e-03                 3 1 ON  96
ci_048 -1.125153e-02                3 1 ON  97
ci_049 -1.180068e-02                3 1 ON  98
ci_050 7.707558e-03                 3 1 ON  99
ci_051 7.552740e-03                 3 1 ON  100
ci_052 -7.041240e-03                3 1 ON  101
ci_053 -6.811125e-03                3 1 ON  102
ci_054 -3.071881e-03                3 1 ON  103
ci_055 -3.140997e-03                3 1 ON  104
ci_056 4.700506e-03                 3 1 ON  105
ci_057 4.552141e-03                 3 1 ON  106
ci_058 -6.615424e-03                3 1 ON  107
ci_059 -6.697783e-03                3 1 ON  108
ci_060 8.328767e-03                 3 1 ON  109
ci_061 8.078098e-03                 3 1 ON  110
ci_062 -3.262456e-03                3 1 ON  111
ci_063 -3.115162e-03                3 1 ON  112
ci_064 -3.027305e-03                3 1 ON  113
ci_065 -4.143303e-03                3 1 ON  114
ci_066 6.026042e-03                 3 1 ON  115
ci_067 5.414669e-03                 3 1 ON  116
ci_068 -5.377547e-03                3 1 ON  117
ci_069 -4.933337e-03                3 1 ON  118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1669
    reference variance = 0.300071
====================================================
  Execution time = 2.0421e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1089e-01
  Total weights = 1.9564e+06
  Execution time = 1.8320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00498612
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297590606527
                                         uncertainty =       0.002187062551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297590606527
                                         uncertainty =       0.002187062551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385735390
  error estimate for blocks of size 2^( 2) =       0.000395732733
  error estimate for blocks of size 2^( 3) =       0.000404644040
  error estimate for blocks of size 2^( 4) =       0.000411303620
  error estimate for blocks of size 2^( 5) =       0.000414770072
  error estimate for blocks of size 2^( 6) =       0.000416354410
  error estimate for blocks of size 2^( 7) =       0.000417176654

      target function =                  N/A
              le_mean =     -17.217333849267
             les_mean =     296.750349619415
             stat err =       0.000414901189
             autocorr =       1.156938807690
              std dev =       0.545512219328
             le_variance =       0.297583581436

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00111014
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297436642024
                                         uncertainty =       0.002186948988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297436642024
                                         uncertainty =       0.002186948988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385635750
  error estimate for blocks of size 2^( 2) =       0.000395649911
  error estimate for blocks of size 2^( 3) =       0.000404586586
  error estimate for blocks of size 2^( 4) =       0.000411261135
  error estimate for blocks of size 2^( 5) =       0.000414732558
  error estimate for blocks of size 2^( 6) =       0.000416294634
  error estimate for blocks of size 2^( 7) =       0.000417122866

      target function =                  N/A
              le_mean =     -17.217333797825
             les_mean =     296.748424911122
             stat err =       0.000414852798
             autocorr =       1.157266739037
              std dev =       0.545371308226
             le_variance =       0.297429863837

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00504483
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297323739124
                                         uncertainty =       0.002184159957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297323739124
                                         uncertainty =       0.002184159957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385562516
  error estimate for blocks of size 2^( 2) =       0.000395579657
  error estimate for blocks of size 2^( 3) =       0.000404516936
  error estimate for blocks of size 2^( 4) =       0.000411192841
  error estimate for blocks of size 2^( 5) =       0.000414664147
  error estimate for blocks of size 2^( 6) =       0.000416229547
  error estimate for blocks of size 2^( 7) =       0.000417056953

      target function =                  N/A
              le_mean =     -17.217330838221
             les_mean =     296.747119950613
             stat err =       0.000414785872
             autocorr =       1.157332902029
              std dev =       0.545267738821
             le_variance =       0.297316906999

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0179756
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297676722390
                                         uncertainty =       0.002189252383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297676722390
                                         uncertainty =       0.002189252383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385790776
  error estimate for blocks of size 2^( 2) =       0.000395789200
  error estimate for blocks of size 2^( 3) =       0.000404703350
  error estimate for blocks of size 2^( 4) =       0.000411371468
  error estimate for blocks of size 2^( 5) =       0.000414857121
  error estimate for blocks of size 2^( 6) =       0.000416422103
  error estimate for blocks of size 2^( 7) =       0.000417224396

      target function =                  N/A
              le_mean =     -17.217324417360
             les_mean =     298.671224146275
             stat err =       0.000414968772
             autocorr =       1.156983464517
              std dev =       0.545590547235
             le_variance =       0.297669045232


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217333849267        initial  <--
     2.5000e-01     2.5000e+00             3.7688e-03       -17.217333797825
     1.0000e+00     1.0000e+01             1.0531e-03       -17.217330838221
     4.0000e+00     4.0000e+01             2.7042e-04       -17.217324417360

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6796
  </log>
  <optVariables href="H2O.s000.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6879e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7173e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1723
    reference variance = 0.216614
====================================================
  Execution time = 2.2960e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1237e-01
  Total weights = 1.956170463e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298570961516
                                         uncertainty =       0.002049209832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298570961516
                                         uncertainty =       0.002049209832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386328583
  error estimate for blocks of size 2^( 2) =       0.000396482425
  error estimate for blocks of size 2^( 3) =       0.000405079208
  error estimate for blocks of size 2^( 4) =       0.000411426636
  error estimate for blocks of size 2^( 5) =       0.000416047722
  error estimate for blocks of size 2^( 6) =       0.000417993123
  error estimate for blocks of size 2^( 7) =       0.000420089450

      target function =                  N/A
              le_mean =     -17.216152122548
             les_mean =     296.708259262788
             stat err =       0.000416389233
             autocorr =       1.161676751610
              std dev =       0.546351122183
             le_variance =       0.298499548711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721615212255e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216152122590       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216152737848       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216152833476       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216153420389       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216154263337       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216154458542       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216154329060       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216154305408       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216154245555       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216154215490       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+00 is 4.214985e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216152122590       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216152286707       residual = 9.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216152313684       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216152452915       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216152693703       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216152733821       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216152700628       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216152697442       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216152685039       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216152678755       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+01 is 1.067028e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216152122590       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216152164318       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216152171281       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216152205544       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216152267749       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216152277401       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216152269566       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216152267369       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216152264945       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216152264040       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+01 is 2.676131e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9016e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.037056e-01 1 1  ON 0
  uu_1                 4.371631e-02 1 1  ON 1
  uu_2                -4.750617e-02 1 1  ON 2
  uu_3                -9.904554e-02 1 1  ON 3
  uu_4                -1.294360e-01 1 1  ON 4
  uu_5                -1.342462e-01 1 1  ON 5
  uu_6                -1.118936e-01 1 1  ON 6
  uu_7                -3.805276e-02 1 1  ON 7
  uu_8                 1.008571e-01 1 1  ON 8
  uu_9                 1.201899e-01 1 1  ON 9
  ud_0                 3.471489e-01 1 1  ON 10
  ud_1                 8.999607e-02 1 1  ON 11
  ud_2                -1.727537e-02 1 1  ON 12
  ud_3                -7.539054e-02 1 1  ON 13
  ud_4                -1.204088e-01 1 1  ON 14
  ud_5                -1.507897e-01 1 1  ON 15
  ud_6                -1.541545e-01 1 1  ON 16
  ud_7                -1.094255e-01 1 1  ON 17
  ud_8                 5.931700e-03 1 1  ON 18
  ud_9                 9.251847e-02 1 1  ON 19
  eO_0                -7.403355e-01 1 1  ON 20
  eO_1                -4.287159e-01 1 1  ON 21
  eO_2                -3.455825e-02 1 1  ON 22
  eO_3                 2.025662e-01 1 1  ON 23
  eO_4                 2.803326e-01 1 1  ON 24
  eO_5                 3.038469e-01 1 1  ON 25
  eO_6                 2.493790e-01 1 1  ON 26
  eO_7                 1.108862e-01 1 1  ON 27
  eO_8                 2.771247e-02 1 1  ON 28
  eO_9                 1.834492e-02 1 1  ON 29
 eH1_0                -1.814956e-01 1 1  ON 30
 eH1_1                -1.020707e-01 1 1  ON 31
 eH1_2                -6.229441e-02 1 1  ON 32
 eH1_3                -2.601262e-02 1 1  ON 33
 eH1_4                 1.958710e-02 1 1  ON 34
 eH1_5                 3.568102e-02 1 1  ON 35
 eH1_6                 7.685690e-02 1 1  ON 36
 eH1_7                 1.104914e-01 1 1  ON 37
 eH1_8                 9.002028e-02 1 1  ON 38
 eH1_9                 2.407062e-02 1 1  ON 39
 eH2_0                -1.826335e-01 1 1  ON 40
 eH2_1                -1.036015e-01 1 1  ON 41
 eH2_2                -6.368732e-02 1 1  ON 42
 eH2_3                -2.765409e-02 1 1  ON 43
 eH2_4                 1.866228e-02 1 1  ON 44
 eH2_5                 3.506489e-02 1 1  ON 45
 eH2_6                 7.835902e-02 1 1  ON 46
 eH2_7                 1.139621e-01 1 1  ON 47
 eH2_8                 9.324735e-02 1 1  ON 48
 eH2_9                 2.615185e-02 1 1  ON 49
ci_001                -4.168698e-02 3 1  ON 50
ci_002                -3.011705e-02 3 1  ON 51
ci_003                -2.530592e-02 3 1  ON 52
ci_004                 2.147732e-02 3 1  ON 53
ci_005                 2.161332e-02 3 1  ON 54
ci_006                -1.879660e-02 3 1  ON 55
ci_007                -1.930278e-02 3 1  ON 56
ci_008                -1.806163e-02 3 1  ON 57
ci_009                -1.762015e-02 3 1  ON 58
ci_010                -1.792220e-02 3 1  ON 59
ci_011                -1.635133e-02 3 1  ON 60
ci_012                -1.646336e-02 3 1  ON 61
ci_013                -1.900837e-02 3 1  ON 62
ci_014                 1.377531e-02 3 1  ON 63
ci_015                 1.399342e-02 3 1  ON 64
ci_016                 1.630958e-02 3 1  ON 65
ci_017                 1.656155e-02 3 1  ON 66
ci_018                 1.254804e-02 3 1  ON 67
ci_019                 1.289737e-02 3 1  ON 68
ci_020                 1.326598e-02 3 1  ON 69
ci_021                 1.359160e-02 3 1  ON 70
ci_022                 1.176785e-02 3 1  ON 71
ci_023                 1.150281e-02 3 1  ON 72
ci_024                 1.253013e-02 3 1  ON 73
ci_025                 1.221035e-02 3 1  ON 74
ci_026                 1.110906e-02 3 1  ON 75
ci_027                 1.152042e-02 3 1  ON 76
ci_028                -1.444773e-02 3 1  ON 77
ci_029                -1.476283e-02 3 1  ON 78
ci_030                -1.105442e-02 3 1  ON 79
ci_031                -1.175986e-02 3 1  ON 80
ci_032                -1.334740e-02 3 1  ON 81
ci_033                 1.084315e-02 3 1  ON 82
ci_034                 1.077080e-02 3 1  ON 83
ci_035                -4.997017e-03 3 1  ON 84
ci_036                -1.090236e-02 3 1  ON 85
ci_037                -1.027822e-02 3 1  ON 86
ci_038                 1.629732e-03 3 1  ON 87
ci_039                 1.960683e-03 3 1  ON 88
ci_040                -4.120338e-03 3 1  ON 89
ci_041                 1.001337e-02 3 1  ON 90
ci_042                 9.727067e-03 3 1  ON 91
ci_043                -3.560988e-03 3 1  ON 92
ci_044                -1.544216e-02 3 1  ON 93
ci_045                -1.688128e-03 3 1  ON 94
ci_046                 5.229861e-03 3 1  ON 95
ci_047                 5.921740e-03 3 1  ON 96
ci_048                -1.129692e-02 3 1  ON 97
ci_049                -1.193983e-02 3 1  ON 98
ci_050                 7.718323e-03 3 1  ON 99
ci_051                 7.727915e-03 3 1  ON 100
ci_052                -6.990520e-03 3 1  ON 101
ci_053                -6.819399e-03 3 1  ON 102
ci_054                -2.921179e-03 3 1  ON 103
ci_055                -3.087488e-03 3 1  ON 104
ci_056                 4.756841e-03 3 1  ON 105
ci_057                 4.626714e-03 3 1  ON 106
ci_058                -6.903398e-03 3 1  ON 107
ci_059                -6.878160e-03 3 1  ON 108
ci_060                 8.397599e-03 3 1  ON 109
ci_061                 8.254334e-03 3 1  ON 110
ci_062                -3.055100e-03 3 1  ON 111
ci_063                -3.013331e-03 3 1  ON 112
ci_064                -2.994349e-03 3 1  ON 113
ci_065                -4.121938e-03 3 1  ON 114
ci_066                 6.029221e-03 3 1  ON 115
ci_067                 5.262567e-03 3 1  ON 116
ci_068                -5.343373e-03 3 1  ON 117
ci_069                -5.116575e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1878
    reference variance = 0.189919
====================================================
  Execution time = 2.0306e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2738e-01
  Total weights = 1.9568e+06
  Execution time = 1.8408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301196109570
                                         uncertainty =       0.002300653265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301196109570
                                         uncertainty =       0.002300653265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388091189
  error estimate for blocks of size 2^( 2) =       0.000397993796
  error estimate for blocks of size 2^( 3) =       0.000407532294
  error estimate for blocks of size 2^( 4) =       0.000415381062
  error estimate for blocks of size 2^( 5) =       0.000419775464
  error estimate for blocks of size 2^( 6) =       0.000421182699
  error estimate for blocks of size 2^( 7) =       0.000423033829

      target function =                  N/A
              le_mean =     -17.216862519836
             les_mean =     296.747282203120
             stat err =       0.000419843263
             autocorr =       1.170325887621
              std dev =       0.548843823477
             le_variance =       0.301229542569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301300592780
                                         uncertainty =       0.002340033671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301300592780
                                         uncertainty =       0.002340033671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388158070
  error estimate for blocks of size 2^( 2) =       0.000398056515
  error estimate for blocks of size 2^( 3) =       0.000407593383
  error estimate for blocks of size 2^( 4) =       0.000415439575
  error estimate for blocks of size 2^( 5) =       0.000419831261
  error estimate for blocks of size 2^( 6) =       0.000421247391
  error estimate for blocks of size 2^( 7) =       0.000423076118

      target function =                  N/A
              le_mean =     -17.216861780742
             les_mean =     296.754615998392
             stat err =       0.000419898586
             autocorr =       1.170230965284
              std dev =       0.548938406404
             le_variance =       0.301333374026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301249982196
                                         uncertainty =       0.002320653693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301249982196
                                         uncertainty =       0.002320653693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388125668
  error estimate for blocks of size 2^( 2) =       0.000398026147
  error estimate for blocks of size 2^( 3) =       0.000407563856
  error estimate for blocks of size 2^( 4) =       0.000415411173
  error estimate for blocks of size 2^( 5) =       0.000419804310
  error estimate for blocks of size 2^( 6) =       0.000421216441
  error estimate for blocks of size 2^( 7) =       0.000423055740

      target function =                  N/A
              le_mean =     -17.216862127152
             les_mean =     296.748564754690
             stat err =       0.000419871916
             autocorr =       1.170277688824
              std dev =       0.548892582910
             le_variance =       0.301283067573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301202672422
                                         uncertainty =       0.002303061504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301202672422
                                         uncertainty =       0.002303061504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388095389
  error estimate for blocks of size 2^( 2) =       0.000397997732
  error estimate for blocks of size 2^( 3) =       0.000407536140
  error estimate for blocks of size 2^( 4) =       0.000415384727
  error estimate for blocks of size 2^( 5) =       0.000419778961
  error estimate for blocks of size 2^( 6) =       0.000421186828
  error estimate for blocks of size 2^( 7) =       0.000423036490

      target function =                  N/A
              le_mean =     -17.216862464721
             les_mean =     296.747378085923
             stat err =       0.000419846752
             autocorr =       1.170320006965
              std dev =       0.548849762328
             le_variance =       0.301236061607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216862519836        initial  <--
     2.5000e+00     2.5000e+01             4.2150e-04       -17.216861780742
     1.0000e+01     1.0000e+02             1.0670e-04       -17.216862127152
     4.0000e+01     4.0000e+02             2.6761e-05       -17.216862464721

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5950
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8618e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7176e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2052
    reference variance = 0.187083
====================================================
  Execution time = 2.0613e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1200e-01
  Total weights = 1.956552239e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297839413315
                                         uncertainty =       0.001908545560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297839413315
                                         uncertainty =       0.001908545560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385852121
  error estimate for blocks of size 2^( 2) =       0.000395629160
  error estimate for blocks of size 2^( 3) =       0.000405221828
  error estimate for blocks of size 2^( 4) =       0.000411626825
  error estimate for blocks of size 2^( 5) =       0.000416496391
  error estimate for blocks of size 2^( 6) =       0.000418486618
  error estimate for blocks of size 2^( 7) =       0.000418999098

      target function =                  N/A
              le_mean =     -17.216780864996
             les_mean =     296.729543885557
             stat err =       0.000416402233
             autocorr =       1.164620191451
              std dev =       0.545677302576
             le_variance =       0.297763718547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721678086500e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216780865028       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216781136786       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216781170462       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216781174520       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216781231012       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216781234884       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216781279040       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216781281058       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216781273024       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216781267754       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+01 is 4.067445e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216780865028       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216780933458       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216780942058       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216780943113       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216780957059       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216780958041       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216780969171       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216780969767       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216780967735       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216780966373       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+02 is 1.017582e-05

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216780865028       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216780882167       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216780884328       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216780884594       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216780888070       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216780888316       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216780891104       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216780891260       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216780890749       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216780890407       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+02 is 2.544401e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091139 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6650e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.036836e-01 1 1  ON 0
  uu_1                 4.370049e-02 1 1  ON 1
  uu_2                -4.751461e-02 1 1  ON 2
  uu_3                -9.904460e-02 1 1  ON 3
  uu_4                -1.294229e-01 1 1  ON 4
  uu_5                -1.342292e-01 1 1  ON 5
  uu_6                -1.118906e-01 1 1  ON 6
  uu_7                -3.803895e-02 1 1  ON 7
  uu_8                 1.008662e-01 1 1  ON 8
  uu_9                 1.201855e-01 1 1  ON 9
  ud_0                 3.471111e-01 1 1  ON 10
  ud_1                 8.998547e-02 1 1  ON 11
  ud_2                -1.727226e-02 1 1  ON 12
  ud_3                -7.538341e-02 1 1  ON 13
  ud_4                -1.203914e-01 1 1  ON 14
  ud_5                -1.507901e-01 1 1  ON 15
  ud_6                -1.541549e-01 1 1  ON 16
  ud_7                -1.094158e-01 1 1  ON 17
  ud_8                 5.946826e-03 1 1  ON 18
  ud_9                 9.251997e-02 1 1  ON 19
  eO_0                -7.402390e-01 1 1  ON 20
  eO_1                -4.286572e-01 1 1  ON 21
  eO_2                -3.455200e-02 1 1  ON 22
  eO_3                 2.025011e-01 1 1  ON 23
  eO_4                 2.802547e-01 1 1  ON 24
  eO_5                 3.038411e-01 1 1  ON 25
  eO_6                 2.493767e-01 1 1  ON 26
  eO_7                 1.108778e-01 1 1  ON 27
  eO_8                 2.771147e-02 1 1  ON 28
  eO_9                 1.834444e-02 1 1  ON 29
 eH1_0                -1.814837e-01 1 1  ON 30
 eH1_1                -1.020717e-01 1 1  ON 31
 eH1_2                -6.230046e-02 1 1  ON 32
 eH1_3                -2.601410e-02 1 1  ON 33
 eH1_4                 1.958798e-02 1 1  ON 34
 eH1_5                 3.568291e-02 1 1  ON 35
 eH1_6                 7.685530e-02 1 1  ON 36
 eH1_7                 1.104945e-01 1 1  ON 37
 eH1_8                 9.001537e-02 1 1  ON 38
 eH1_9                 2.406873e-02 1 1  ON 39
 eH2_0                -1.826267e-01 1 1  ON 40
 eH2_1                -1.035995e-01 1 1  ON 41
 eH2_2                -6.368853e-02 1 1  ON 42
 eH2_3                -2.766727e-02 1 1  ON 43
 eH2_4                 1.867232e-02 1 1  ON 44
 eH2_5                 3.506265e-02 1 1  ON 45
 eH2_6                 7.835858e-02 1 1  ON 46
 eH2_7                 1.139676e-01 1 1  ON 47
 eH2_8                 9.324251e-02 1 1  ON 48
 eH2_9                 2.614989e-02 1 1  ON 49
ci_001                -4.170635e-02 3 1  ON 50
ci_002                -3.012157e-02 3 1  ON 51
ci_003                -2.528625e-02 3 1  ON 52
ci_004                 2.147451e-02 3 1  ON 53
ci_005                 2.161778e-02 3 1  ON 54
ci_006                -1.879140e-02 3 1  ON 55
ci_007                -1.932094e-02 3 1  ON 56
ci_008                -1.805496e-02 3 1  ON 57
ci_009                -1.762598e-02 3 1  ON 58
ci_010                -1.791298e-02 3 1  ON 59
ci_011                -1.637430e-02 3 1  ON 60
ci_012                -1.648207e-02 3 1  ON 61
ci_013                -1.900141e-02 3 1  ON 62
ci_014                 1.376931e-02 3 1  ON 63
ci_015                 1.399683e-02 3 1  ON 64
ci_016                 1.632086e-02 3 1  ON 65
ci_017                 1.654822e-02 3 1  ON 66
ci_018                 1.257167e-02 3 1  ON 67
ci_019                 1.289707e-02 3 1  ON 68
ci_020                 1.326151e-02 3 1  ON 69
ci_021                 1.359592e-02 3 1  ON 70
ci_022                 1.177238e-02 3 1  ON 71
ci_023                 1.150920e-02 3 1  ON 72
ci_024                 1.252478e-02 3 1  ON 73
ci_025                 1.223029e-02 3 1  ON 74
ci_026                 1.110556e-02 3 1  ON 75
ci_027                 1.151886e-02 3 1  ON 76
ci_028                -1.444818e-02 3 1  ON 77
ci_029                -1.476278e-02 3 1  ON 78
ci_030                -1.103082e-02 3 1  ON 79
ci_031                -1.177172e-02 3 1  ON 80
ci_032                -1.332899e-02 3 1  ON 81
ci_033                 1.088093e-02 3 1  ON 82
ci_034                 1.077787e-02 3 1  ON 83
ci_035                -4.994819e-03 3 1  ON 84
ci_036                -1.089539e-02 3 1  ON 85
ci_037                -1.030066e-02 3 1  ON 86
ci_038                 1.624089e-03 3 1  ON 87
ci_039                 1.981809e-03 3 1  ON 88
ci_040                -4.113292e-03 3 1  ON 89
ci_041                 1.002133e-02 3 1  ON 90
ci_042                 9.732836e-03 3 1  ON 91
ci_043                -3.583699e-03 3 1  ON 92
ci_044                -1.543073e-02 3 1  ON 93
ci_045                -1.673168e-03 3 1  ON 94
ci_046                 5.226727e-03 3 1  ON 95
ci_047                 5.916067e-03 3 1  ON 96
ci_048                -1.129103e-02 3 1  ON 97
ci_049                -1.192720e-02 3 1  ON 98
ci_050                 7.725948e-03 3 1  ON 99
ci_051                 7.748514e-03 3 1  ON 100
ci_052                -7.009590e-03 3 1  ON 101
ci_053                -6.823606e-03 3 1  ON 102
ci_054                -2.932331e-03 3 1  ON 103
ci_055                -3.084010e-03 3 1  ON 104
ci_056                 4.763543e-03 3 1  ON 105
ci_057                 4.621690e-03 3 1  ON 106
ci_058                -6.910851e-03 3 1  ON 107
ci_059                -6.880623e-03 3 1  ON 108
ci_060                 8.400102e-03 3 1  ON 109
ci_061                 8.235451e-03 3 1  ON 110
ci_062                -3.046651e-03 3 1  ON 111
ci_063                -3.002987e-03 3 1  ON 112
ci_064                -2.988301e-03 3 1  ON 113
ci_065                -4.122252e-03 3 1  ON 114
ci_066                 6.043419e-03 3 1  ON 115
ci_067                 5.243731e-03 3 1  ON 116
ci_068                -5.346924e-03 3 1  ON 117
ci_069                -5.110253e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.166
    reference variance = 0.20197
====================================================
  Execution time = 2.0534e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1365e-01
  Total weights = 1.9568e+06
  Execution time = 1.8389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299124494754
                                         uncertainty =       0.002028869237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299124494754
                                         uncertainty =       0.002028869237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386683819
  error estimate for blocks of size 2^( 2) =       0.000396965459
  error estimate for blocks of size 2^( 3) =       0.000406223085
  error estimate for blocks of size 2^( 4) =       0.000412305337
  error estimate for blocks of size 2^( 5) =       0.000417078972
  error estimate for blocks of size 2^( 6) =       0.000418671714
  error estimate for blocks of size 2^( 7) =       0.000419235476

      target function =                  N/A
              le_mean =     -17.216039070624
             les_mean =     296.705652749562
             stat err =       0.000416822875
             autocorr =       1.161959769376
              std dev =       0.546853500896
             le_variance =       0.299048751442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299131993902
                                         uncertainty =       0.002029288892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299131993902
                                         uncertainty =       0.002029288892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386688676
  error estimate for blocks of size 2^( 2) =       0.000396970208
  error estimate for blocks of size 2^( 3) =       0.000406227761
  error estimate for blocks of size 2^( 4) =       0.000412309965
  error estimate for blocks of size 2^( 5) =       0.000417083349
  error estimate for blocks of size 2^( 6) =       0.000418675598
  error estimate for blocks of size 2^( 7) =       0.000419237591

      target function =                  N/A
              le_mean =     -17.216039253639
             les_mean =     296.705645732558
             stat err =       0.000416826625
             autocorr =       1.161951488917
              std dev =       0.546860369889
             le_variance =       0.299056264155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299128245769
                                         uncertainty =       0.002029080166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299128245769
                                         uncertainty =       0.002029080166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386686248
  error estimate for blocks of size 2^( 2) =       0.000396967836
  error estimate for blocks of size 2^( 3) =       0.000406225425
  error estimate for blocks of size 2^( 4) =       0.000412307653
  error estimate for blocks of size 2^( 5) =       0.000417081162
  error estimate for blocks of size 2^( 6) =       0.000418673657
  error estimate for blocks of size 2^( 7) =       0.000419236527

      target function =                  N/A
              le_mean =     -17.216039160964
             les_mean =     296.705647591691
             stat err =       0.000416824750
             autocorr =       1.161955621230
              std dev =       0.546856936799
             le_variance =       0.299052509326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299124962675
                                         uncertainty =       0.002028895621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299124962675
                                         uncertainty =       0.002028895621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386684122
  error estimate for blocks of size 2^( 2) =       0.000396965756
  error estimate for blocks of size 2^( 3) =       0.000406223377
  error estimate for blocks of size 2^( 4) =       0.000412305626
  error estimate for blocks of size 2^( 5) =       0.000417079245
  error estimate for blocks of size 2^( 6) =       0.000418671957
  error estimate for blocks of size 2^( 7) =       0.000419235607

      target function =                  N/A
              le_mean =     -17.216039081752
             les_mean =     296.705651934690
             stat err =       0.000416823109
             autocorr =       1.161959250534
              std dev =       0.546853929514
             le_variance =       0.299049220225


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216039070624        initial
     2.5000e+01     2.5000e+02             4.0674e-05       -17.216039253639  <--
     1.0000e+02     1.0000e+03             1.0176e-05       -17.216039160964
     4.0000e+02     4.0000e+03             2.5444e-06       -17.216039081752

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.9790e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.036947e-01 1 1  ON 0
  uu_1                 4.370090e-02 1 1  ON 1
  uu_2                -4.751264e-02 1 1  ON 2
  uu_3                -9.904527e-02 1 1  ON 3
  uu_4                -1.294260e-01 1 1  ON 4
  uu_5                -1.342325e-01 1 1  ON 5
  uu_6                -1.118948e-01 1 1  ON 6
  uu_7                -3.804359e-02 1 1  ON 7
  uu_8                 1.008643e-01 1 1  ON 8
  uu_9                 1.201874e-01 1 1  ON 9
  ud_0                 3.471233e-01 1 1  ON 10
  ud_1                 8.999136e-02 1 1  ON 11
  ud_2                -1.726978e-02 1 1  ON 12
  ud_3                -7.538774e-02 1 1  ON 13
  ud_4                -1.203984e-01 1 1  ON 14
  ud_5                -1.507924e-01 1 1  ON 15
  ud_6                -1.541575e-01 1 1  ON 16
  ud_7                -1.094184e-01 1 1  ON 17
  ud_8                 5.942872e-03 1 1  ON 18
  ud_9                 9.252026e-02 1 1  ON 19
  eO_0                -7.402695e-01 1 1  ON 20
  eO_1                -4.286770e-01 1 1  ON 21
  eO_2                -3.455515e-02 1 1  ON 22
  eO_3                 2.025246e-01 1 1  ON 23
  eO_4                 2.802784e-01 1 1  ON 24
  eO_5                 3.038419e-01 1 1  ON 25
  eO_6                 2.493775e-01 1 1  ON 26
  eO_7                 1.108815e-01 1 1  ON 27
  eO_8                 2.771203e-02 1 1  ON 28
  eO_9                 1.834468e-02 1 1  ON 29
 eH1_0                -1.814857e-01 1 1  ON 30
 eH1_1                -1.020726e-01 1 1  ON 31
 eH1_2                -6.229928e-02 1 1  ON 32
 eH1_3                -2.601578e-02 1 1  ON 33
 eH1_4                 1.958921e-02 1 1  ON 34
 eH1_5                 3.568380e-02 1 1  ON 35
 eH1_6                 7.685485e-02 1 1  ON 36
 eH1_7                 1.104931e-01 1 1  ON 37
 eH1_8                 9.001746e-02 1 1  ON 38
 eH1_9                 2.406946e-02 1 1  ON 39
 eH2_0                -1.826311e-01 1 1  ON 40
 eH2_1                -1.035981e-01 1 1  ON 41
 eH2_2                -6.368661e-02 1 1  ON 42
 eH2_3                -2.766514e-02 1 1  ON 43
 eH2_4                 1.866916e-02 1 1  ON 44
 eH2_5                 3.506248e-02 1 1  ON 45
 eH2_6                 7.835918e-02 1 1  ON 46
 eH2_7                 1.139667e-01 1 1  ON 47
 eH2_8                 9.324449e-02 1 1  ON 48
 eH2_9                 2.615030e-02 1 1  ON 49
ci_001                -4.169742e-02 3 1  ON 50
ci_002                -3.012278e-02 3 1  ON 51
ci_003                -2.528638e-02 3 1  ON 52
ci_004                 2.146746e-02 3 1  ON 53
ci_005                 2.161731e-02 3 1  ON 54
ci_006                -1.879264e-02 3 1  ON 55
ci_007                -1.931483e-02 3 1  ON 56
ci_008                -1.806019e-02 3 1  ON 57
ci_009                -1.762296e-02 3 1  ON 58
ci_010                -1.790738e-02 3 1  ON 59
ci_011                -1.637527e-02 3 1  ON 60
ci_012                -1.648556e-02 3 1  ON 61
ci_013                -1.900454e-02 3 1  ON 62
ci_014                 1.376714e-02 3 1  ON 63
ci_015                 1.399711e-02 3 1  ON 64
ci_016                 1.632782e-02 3 1  ON 65
ci_017                 1.654649e-02 3 1  ON 66
ci_018                 1.257468e-02 3 1  ON 67
ci_019                 1.289655e-02 3 1  ON 68
ci_020                 1.326139e-02 3 1  ON 69
ci_021                 1.359200e-02 3 1  ON 70
ci_022                 1.177192e-02 3 1  ON 71
ci_023                 1.150797e-02 3 1  ON 72
ci_024                 1.252250e-02 3 1  ON 73
ci_025                 1.223885e-02 3 1  ON 74
ci_026                 1.111291e-02 3 1  ON 75
ci_027                 1.151433e-02 3 1  ON 76
ci_028                -1.445092e-02 3 1  ON 77
ci_029                -1.476433e-02 3 1  ON 78
ci_030                -1.103425e-02 3 1  ON 79
ci_031                -1.177177e-02 3 1  ON 80
ci_032                -1.333207e-02 3 1  ON 81
ci_033                 1.087564e-02 3 1  ON 82
ci_034                 1.077329e-02 3 1  ON 83
ci_035                -4.990693e-03 3 1  ON 84
ci_036                -1.089516e-02 3 1  ON 85
ci_037                -1.030592e-02 3 1  ON 86
ci_038                 1.628557e-03 3 1  ON 87
ci_039                 1.984611e-03 3 1  ON 88
ci_040                -4.112133e-03 3 1  ON 89
ci_041                 1.002277e-02 3 1  ON 90
ci_042                 9.738886e-03 3 1  ON 91
ci_043                -3.580791e-03 3 1  ON 92
ci_044                -1.542868e-02 3 1  ON 93
ci_045                -1.672655e-03 3 1  ON 94
ci_046                 5.235248e-03 3 1  ON 95
ci_047                 5.915655e-03 3 1  ON 96
ci_048                -1.129233e-02 3 1  ON 97
ci_049                -1.193033e-02 3 1  ON 98
ci_050                 7.721794e-03 3 1  ON 99
ci_051                 7.743411e-03 3 1  ON 100
ci_052                -7.006431e-03 3 1  ON 101
ci_053                -6.826316e-03 3 1  ON 102
ci_054                -2.935195e-03 3 1  ON 103
ci_055                -3.092677e-03 3 1  ON 104
ci_056                 4.755327e-03 3 1  ON 105
ci_057                 4.613424e-03 3 1  ON 106
ci_058                -6.906198e-03 3 1  ON 107
ci_059                -6.884371e-03 3 1  ON 108
ci_060                 8.402440e-03 3 1  ON 109
ci_061                 8.237993e-03 3 1  ON 110
ci_062                -3.048165e-03 3 1  ON 111
ci_063                -2.999830e-03 3 1  ON 112
ci_064                -2.988349e-03 3 1  ON 113
ci_065                -4.119177e-03 3 1  ON 114
ci_066                 6.040991e-03 3 1  ON 115
ci_067                 5.247334e-03 3 1  ON 116
ci_068                -5.335916e-03 3 1  ON 117
ci_069                -5.104155e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6447e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7179e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1624
    reference variance = 0.208449
====================================================
  Execution time = 2.0810e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1244e-01
  Total weights = 1.956407814e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1497e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296519320571
                                         uncertainty =       0.001967898708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296519320571
                                         uncertainty =       0.001967898708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385019576
  error estimate for blocks of size 2^( 2) =       0.000394795246
  error estimate for blocks of size 2^( 3) =       0.000403919671
  error estimate for blocks of size 2^( 4) =       0.000411031736
  error estimate for blocks of size 2^( 5) =       0.000415344907
  error estimate for blocks of size 2^( 6) =       0.000416579405
  error estimate for blocks of size 2^( 7) =       0.000419220582

      target function =                  N/A
              le_mean =     -17.216667878251
             les_mean =     296.726087857347
             stat err =       0.000415544158
             autocorr =       1.164846607501
              std dev =       0.544499905619
             le_variance =       0.296480147219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666787825e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216667878285       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216667131951       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216667020188       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216667261647       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216667391715       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216667811683       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216667799802       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216667786378       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216667767012       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216667755735       residual = 8.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+00 is 1.743947e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216667878285       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216667685346       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216667655810       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216667710729       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216667743092       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216667851939       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216667849192       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216667846401       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216667842873       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216667839605       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+01 is 4.371032e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216667878285       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216667829636       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216667822146       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216667835494       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216667843582       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216667871037       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216667870374       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216667869722       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216667868912       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216667868089       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+02 is 1.093410e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095014 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6973e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.037082e-01 1 1  ON 0
  uu_1                 4.370780e-02 1 1  ON 1
  uu_2                -4.751310e-02 1 1  ON 2
  uu_3                -9.904678e-02 1 1  ON 3
  uu_4                -1.294324e-01 1 1  ON 4
  uu_5                -1.342423e-01 1 1  ON 5
  uu_6                -1.118974e-01 1 1  ON 6
  uu_7                -3.804573e-02 1 1  ON 7
  uu_8                 1.008624e-01 1 1  ON 8
  uu_9                 1.201898e-01 1 1  ON 9
  ud_0                 3.471436e-01 1 1  ON 10
  ud_1                 8.999427e-02 1 1  ON 11
  ud_2                -1.727093e-02 1 1  ON 12
  ud_3                -7.539685e-02 1 1  ON 13
  ud_4                -1.204062e-01 1 1  ON 14
  ud_5                -1.507992e-01 1 1  ON 15
  ud_6                -1.541539e-01 1 1  ON 16
  ud_7                -1.094181e-01 1 1  ON 17
  ud_8                 5.939166e-03 1 1  ON 18
  ud_9                 9.252049e-02 1 1  ON 19
  eO_0                -7.403132e-01 1 1  ON 20
  eO_1                -4.287043e-01 1 1  ON 21
  eO_2                -3.455622e-02 1 1  ON 22
  eO_3                 2.025573e-01 1 1  ON 23
  eO_4                 2.803076e-01 1 1  ON 24
  eO_5                 3.038426e-01 1 1  ON 25
  eO_6                 2.493804e-01 1 1  ON 26
  eO_7                 1.108866e-01 1 1  ON 27
  eO_8                 2.771306e-02 1 1  ON 28
  eO_9                 1.834495e-02 1 1  ON 29
 eH1_0                -1.814907e-01 1 1  ON 30
 eH1_1                -1.020712e-01 1 1  ON 31
 eH1_2                -6.229746e-02 1 1  ON 32
 eH1_3                -2.601616e-02 1 1  ON 33
 eH1_4                 1.958794e-02 1 1  ON 34
 eH1_5                 3.568230e-02 1 1  ON 35
 eH1_6                 7.685525e-02 1 1  ON 36
 eH1_7                 1.104933e-01 1 1  ON 37
 eH1_8                 9.002091e-02 1 1  ON 38
 eH1_9                 2.407025e-02 1 1  ON 39
 eH2_0                -1.826325e-01 1 1  ON 40
 eH2_1                -1.036014e-01 1 1  ON 41
 eH2_2                -6.368128e-02 1 1  ON 42
 eH2_3                -2.766134e-02 1 1  ON 43
 eH2_4                 1.866909e-02 1 1  ON 44
 eH2_5                 3.505927e-02 1 1  ON 45
 eH2_6                 7.835696e-02 1 1  ON 46
 eH2_7                 1.139646e-01 1 1  ON 47
 eH2_8                 9.324686e-02 1 1  ON 48
 eH2_9                 2.615097e-02 1 1  ON 49
ci_001                -4.169021e-02 3 1  ON 50
ci_002                -3.011994e-02 3 1  ON 51
ci_003                -2.528446e-02 3 1  ON 52
ci_004                 2.147190e-02 3 1  ON 53
ci_005                 2.161488e-02 3 1  ON 54
ci_006                -1.879781e-02 3 1  ON 55
ci_007                -1.931452e-02 3 1  ON 56
ci_008                -1.805655e-02 3 1  ON 57
ci_009                -1.762078e-02 3 1  ON 58
ci_010                -1.790814e-02 3 1  ON 59
ci_011                -1.638028e-02 3 1  ON 60
ci_012                -1.647851e-02 3 1  ON 61
ci_013                -1.900809e-02 3 1  ON 62
ci_014                 1.376890e-02 3 1  ON 63
ci_015                 1.398576e-02 3 1  ON 64
ci_016                 1.632403e-02 3 1  ON 65
ci_017                 1.654804e-02 3 1  ON 66
ci_018                 1.256979e-02 3 1  ON 67
ci_019                 1.289628e-02 3 1  ON 68
ci_020                 1.325749e-02 3 1  ON 69
ci_021                 1.359278e-02 3 1  ON 70
ci_022                 1.176980e-02 3 1  ON 71
ci_023                 1.150003e-02 3 1  ON 72
ci_024                 1.251081e-02 3 1  ON 73
ci_025                 1.223050e-02 3 1  ON 74
ci_026                 1.111349e-02 3 1  ON 75
ci_027                 1.150735e-02 3 1  ON 76
ci_028                -1.445627e-02 3 1  ON 77
ci_029                -1.476418e-02 3 1  ON 78
ci_030                -1.103335e-02 3 1  ON 79
ci_031                -1.176018e-02 3 1  ON 80
ci_032                -1.333596e-02 3 1  ON 81
ci_033                 1.088262e-02 3 1  ON 82
ci_034                 1.076527e-02 3 1  ON 83
ci_035                -4.968621e-03 3 1  ON 84
ci_036                -1.089779e-02 3 1  ON 85
ci_037                -1.029990e-02 3 1  ON 86
ci_038                 1.627266e-03 3 1  ON 87
ci_039                 1.981337e-03 3 1  ON 88
ci_040                -4.107235e-03 3 1  ON 89
ci_041                 1.002396e-02 3 1  ON 90
ci_042                 9.741547e-03 3 1  ON 91
ci_043                -3.574905e-03 3 1  ON 92
ci_044                -1.542700e-02 3 1  ON 93
ci_045                -1.670388e-03 3 1  ON 94
ci_046                 5.244600e-03 3 1  ON 95
ci_047                 5.912459e-03 3 1  ON 96
ci_048                -1.129304e-02 3 1  ON 97
ci_049                -1.193174e-02 3 1  ON 98
ci_050                 7.724848e-03 3 1  ON 99
ci_051                 7.736136e-03 3 1  ON 100
ci_052                -7.004408e-03 3 1  ON 101
ci_053                -6.813630e-03 3 1  ON 102
ci_054                -2.945487e-03 3 1  ON 103
ci_055                -3.095695e-03 3 1  ON 104
ci_056                 4.773215e-03 3 1  ON 105
ci_057                 4.607037e-03 3 1  ON 106
ci_058                -6.907570e-03 3 1  ON 107
ci_059                -6.881360e-03 3 1  ON 108
ci_060                 8.400564e-03 3 1  ON 109
ci_061                 8.242244e-03 3 1  ON 110
ci_062                -3.058233e-03 3 1  ON 111
ci_063                -3.006185e-03 3 1  ON 112
ci_064                -2.987873e-03 3 1  ON 113
ci_065                -4.113941e-03 3 1  ON 114
ci_066                 6.041205e-03 3 1  ON 115
ci_067                 5.253845e-03 3 1  ON 116
ci_068                -5.337319e-03 3 1  ON 117
ci_069                -5.106314e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2681
    reference variance = 0.310133
====================================================
  Execution time = 2.0367e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1451e-01
  Total weights = 1.9567e+06
  Execution time = 1.8452e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299081930238
                                         uncertainty =       0.002147921257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299081930238
                                         uncertainty =       0.002147921257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386710786
  error estimate for blocks of size 2^( 2) =       0.000396887483
  error estimate for blocks of size 2^( 3) =       0.000406165582
  error estimate for blocks of size 2^( 4) =       0.000412608475
  error estimate for blocks of size 2^( 5) =       0.000416351396
  error estimate for blocks of size 2^( 6) =       0.000418592482
  error estimate for blocks of size 2^( 7) =       0.000418738102

      target function =                  N/A
              le_mean =     -17.216382657396
             les_mean =     296.718349832428
             stat err =       0.000416572614
             autocorr =       1.160403043616
              std dev =       0.546891638340
             le_variance =       0.299090464086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299090748933
                                         uncertainty =       0.002146633649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299090748933
                                         uncertainty =       0.002146633649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386716536
  error estimate for blocks of size 2^( 2) =       0.000396892611
  error estimate for blocks of size 2^( 3) =       0.000406171248
  error estimate for blocks of size 2^( 4) =       0.000412616630
  error estimate for blocks of size 2^( 5) =       0.000416359384
  error estimate for blocks of size 2^( 6) =       0.000418601084
  error estimate for blocks of size 2^( 7) =       0.000418744113

      target function =                  N/A
              le_mean =     -17.216382675419
             les_mean =     296.718351466966
             stat err =       0.000416580303
             autocorr =       1.160411371633
              std dev =       0.546899770437
             le_variance =       0.299099358904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299086329259
                                         uncertainty =       0.002147252180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299086329259
                                         uncertainty =       0.002147252180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386713656
  error estimate for blocks of size 2^( 2) =       0.000396890038
  error estimate for blocks of size 2^( 3) =       0.000406168426
  error estimate for blocks of size 2^( 4) =       0.000412612630
  error estimate for blocks of size 2^( 5) =       0.000416355484
  error estimate for blocks of size 2^( 6) =       0.000418596890
  error estimate for blocks of size 2^( 7) =       0.000418741142

      target function =                  N/A
              le_mean =     -17.216382632785
             les_mean =     296.718344248554
             stat err =       0.000416576536
             autocorr =       1.160407677142
              std dev =       0.546895696437
             le_variance =       0.299094902781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299082458529
                                         uncertainty =       0.002147836510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299082458529
                                         uncertainty =       0.002147836510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386711131
  error estimate for blocks of size 2^( 2) =       0.000396887788
  error estimate for blocks of size 2^( 3) =       0.000406165924
  error estimate for blocks of size 2^( 4) =       0.000412608983
  error estimate for blocks of size 2^( 5) =       0.000416351896
  error estimate for blocks of size 2^( 6) =       0.000418593022
  error estimate for blocks of size 2^( 7) =       0.000418738470

      target function =                  N/A
              le_mean =     -17.216382650803
             les_mean =     296.718348437616
             stat err =       0.000416573093
             autocorr =       1.160403644970
              std dev =       0.546892125924
             le_variance =       0.299090997398


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216382657396        initial
     6.2500e+00     6.2500e+01             1.7439e-04       -17.216382675419  <--
     2.5000e+01     2.5000e+02             4.3710e-05       -17.216382632785
     1.0000e+02     1.0000e+03             1.0934e-05       -17.216382650803

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.9625e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.037482e-01 1 1  ON 0
  uu_1                 4.372814e-02 1 1  ON 1
  uu_2                -4.751388e-02 1 1  ON 2
  uu_3                -9.905156e-02 1 1  ON 3
  uu_4                -1.294514e-01 1 1  ON 4
  uu_5                -1.342713e-01 1 1  ON 5
  uu_6                -1.119055e-01 1 1  ON 6
  uu_7                -3.805216e-02 1 1  ON 7
  uu_8                 1.008567e-01 1 1  ON 8
  uu_9                 1.201972e-01 1 1  ON 9
  ud_0                 3.472018e-01 1 1  ON 10
  ud_1                 9.000392e-02 1 1  ON 11
  ud_2                -1.727426e-02 1 1  ON 12
  ud_3                -7.542323e-02 1 1  ON 13
  ud_4                -1.204296e-01 1 1  ON 14
  ud_5                -1.508191e-01 1 1  ON 15
  ud_6                -1.541434e-01 1 1  ON 16
  ud_7                -1.094175e-01 1 1  ON 17
  ud_8                 5.928084e-03 1 1  ON 18
  ud_9                 9.252117e-02 1 1  ON 19
  eO_0                -7.404439e-01 1 1  ON 20
  eO_1                -4.287854e-01 1 1  ON 21
  eO_2                -3.455979e-02 1 1  ON 22
  eO_3                 2.026542e-01 1 1  ON 23
  eO_4                 2.803955e-01 1 1  ON 24
  eO_5                 3.038447e-01 1 1  ON 25
  eO_6                 2.493892e-01 1 1  ON 26
  eO_7                 1.109022e-01 1 1  ON 27
  eO_8                 2.771615e-02 1 1  ON 28
  eO_9                 1.834573e-02 1 1  ON 29
 eH1_0                -1.815052e-01 1 1  ON 30
 eH1_1                -1.020675e-01 1 1  ON 31
 eH1_2                -6.229221e-02 1 1  ON 32
 eH1_3                -2.601710e-02 1 1  ON 33
 eH1_4                 1.958403e-02 1 1  ON 34
 eH1_5                 3.567795e-02 1 1  ON 35
 eH1_6                 7.685655e-02 1 1  ON 36
 eH1_7                 1.104938e-01 1 1  ON 37
 eH1_8                 9.003127e-02 1 1  ON 38
 eH1_9                 2.407263e-02 1 1  ON 39
 eH2_0                -1.826368e-01 1 1  ON 40
 eH2_1                -1.036111e-01 1 1  ON 41
 eH2_2                -6.366585e-02 1 1  ON 42
 eH2_3                -2.764992e-02 1 1  ON 43
 eH2_4                 1.866888e-02 1 1  ON 44
 eH2_5                 3.504976e-02 1 1  ON 45
 eH2_6                 7.835037e-02 1 1  ON 46
 eH2_7                 1.139583e-01 1 1  ON 47
 eH2_8                 9.325394e-02 1 1  ON 48
 eH2_9                 2.615295e-02 1 1  ON 49
ci_001                -4.166912e-02 3 1  ON 50
ci_002                -3.011168e-02 3 1  ON 51
ci_003                -2.527877e-02 3 1  ON 52
ci_004                 2.148483e-02 3 1  ON 53
ci_005                 2.160770e-02 3 1  ON 54
ci_006                -1.881281e-02 3 1  ON 55
ci_007                -1.931355e-02 3 1  ON 56
ci_008                -1.804607e-02 3 1  ON 57
ci_009                -1.761442e-02 3 1  ON 58
ci_010                -1.791045e-02 3 1  ON 59
ci_011                -1.639471e-02 3 1  ON 60
ci_012                -1.645794e-02 3 1  ON 61
ci_013                -1.901846e-02 3 1  ON 62
ci_014                 1.377390e-02 3 1  ON 63
ci_015                 1.395286e-02 3 1  ON 64
ci_016                 1.631321e-02 3 1  ON 65
ci_017                 1.655253e-02 3 1  ON 66
ci_018                 1.255562e-02 3 1  ON 67
ci_019                 1.289549e-02 3 1  ON 68
ci_020                 1.324614e-02 3 1  ON 69
ci_021                 1.359493e-02 3 1  ON 70
ci_022                 1.176355e-02 3 1  ON 71
ci_023                 1.147713e-02 3 1  ON 72
ci_024                 1.247651e-02 3 1  ON 73
ci_025                 1.220608e-02 3 1  ON 74
ci_026                 1.111524e-02 3 1  ON 75
ci_027                 1.148712e-02 3 1  ON 76
ci_028                -1.447188e-02 3 1  ON 77
ci_029                -1.476379e-02 3 1  ON 78
ci_030                -1.103069e-02 3 1  ON 79
ci_031                -1.172655e-02 3 1  ON 80
ci_032                -1.334712e-02 3 1  ON 81
ci_033                 1.090284e-02 3 1  ON 82
ci_034                 1.074204e-02 3 1  ON 83
ci_035                -4.906535e-03 3 1  ON 84
ci_036                -1.090540e-02 3 1  ON 85
ci_037                -1.028245e-02 3 1  ON 86
ci_038                 1.623439e-03 3 1  ON 87
ci_039                 1.971899e-03 3 1  ON 88
ci_040                -4.093427e-03 3 1  ON 89
ci_041                 1.002740e-02 3 1  ON 90
ci_042                 9.749287e-03 3 1  ON 91
ci_043                -3.558243e-03 3 1  ON 92
ci_044                -1.542210e-02 3 1  ON 93
ci_045                -1.663953e-03 3 1  ON 94
ci_046                 5.271512e-03 3 1  ON 95
ci_047                 5.903182e-03 3 1  ON 96
ci_048                -1.129511e-02 3 1  ON 97
ci_049                -1.193581e-02 3 1  ON 98
ci_050                 7.733534e-03 3 1  ON 99
ci_051                 7.715423e-03 3 1  ON 100
ci_052                -6.998646e-03 3 1  ON 101
ci_053                -6.777373e-03 3 1  ON 102
ci_054                -2.974851e-03 3 1  ON 103
ci_055                -3.104239e-03 3 1  ON 104
ci_056                 4.824015e-03 3 1  ON 105
ci_057                 4.588823e-03 3 1  ON 106
ci_058                -6.911509e-03 3 1  ON 107
ci_059                -6.872704e-03 3 1  ON 108
ci_060                 8.395146e-03 3 1  ON 109
ci_061                 8.254564e-03 3 1  ON 110
ci_062                -3.087192e-03 3 1  ON 111
ci_063                -3.024383e-03 3 1  ON 112
ci_064                -2.986516e-03 3 1  ON 113
ci_065                -4.099518e-03 3 1  ON 114
ci_066                 6.041784e-03 3 1  ON 115
ci_067                 5.272402e-03 3 1  ON 116
ci_068                -5.341419e-03 3 1  ON 117
ci_069                -5.112579e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6604e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7188e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1975
    reference variance = 0.266562
====================================================
  Execution time = 2.0840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1869e-01
  Total weights = 1.956747682e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301770521587
                                         uncertainty =       0.002391287019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301770521587
                                         uncertainty =       0.002391287019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388395236
  error estimate for blocks of size 2^( 2) =       0.000398545955
  error estimate for blocks of size 2^( 3) =       0.000407451261
  error estimate for blocks of size 2^( 4) =       0.000413677310
  error estimate for blocks of size 2^( 5) =       0.000417738010
  error estimate for blocks of size 2^( 6) =       0.000419836628
  error estimate for blocks of size 2^( 7) =       0.000421217386

      target function =                  N/A
              le_mean =     -17.216802394515
             les_mean =     296.736972212373
             stat err =       0.000418117334
             autocorr =       1.158906917573
              std dev =       0.549273810640
             le_variance =       0.301701719055


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680239451e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216802394578       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216804611436       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216804686862       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216805840257       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216806533357       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216807277498       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216806897506       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216806675599       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216806580837       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216806558071       residual = 6.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+00 is 6.938187e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216802394578       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216803020024       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216803046638       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216803396600       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216803582226       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216803740366       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216803631259       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216803589895       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216803568512       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216803556294       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+00 is 1.779609e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216802394578       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216802556130       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216802563394       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216802654930       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216802702193       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216802740349       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216802712157       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216802702559       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216802697648       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216802694224       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+01 is 4.479794e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099054 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7039e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.037906e-01 1 1  ON 0
  uu_1                 4.377081e-02 1 1  ON 1
  uu_2                -4.750968e-02 1 1  ON 2
  uu_3                -9.904745e-02 1 1  ON 3
  uu_4                -1.294677e-01 1 1  ON 4
  uu_5                -1.343023e-01 1 1  ON 5
  uu_6                -1.119309e-01 1 1  ON 6
  uu_7                -3.807932e-02 1 1  ON 7
  uu_8                 1.008448e-01 1 1  ON 8
  uu_9                 1.202049e-01 1 1  ON 9
  ud_0                 3.472566e-01 1 1  ON 10
  ud_1                 9.002798e-02 1 1  ON 11
  ud_2                -1.727778e-02 1 1  ON 12
  ud_3                -7.544919e-02 1 1  ON 13
  ud_4                -1.204660e-01 1 1  ON 14
  ud_5                -1.508310e-01 1 1  ON 15
  ud_6                -1.541195e-01 1 1  ON 16
  ud_7                -1.094290e-01 1 1  ON 17
  ud_8                 5.904761e-03 1 1  ON 18
  ud_9                 9.252129e-02 1 1  ON 19
  eO_0                -7.406218e-01 1 1  ON 20
  eO_1                -4.288848e-01 1 1  ON 21
  eO_2                -3.456727e-02 1 1  ON 22
  eO_3                 2.027686e-01 1 1  ON 23
  eO_4                 2.805224e-01 1 1  ON 24
  eO_5                 3.038584e-01 1 1  ON 25
  eO_6                 2.493980e-01 1 1  ON 26
  eO_7                 1.109192e-01 1 1  ON 27
  eO_8                 2.771827e-02 1 1  ON 28
  eO_9                 1.834652e-02 1 1  ON 29
 eH1_0                -1.815122e-01 1 1  ON 30
 eH1_1                -1.020798e-01 1 1  ON 31
 eH1_2                -6.228938e-02 1 1  ON 32
 eH1_3                -2.601663e-02 1 1  ON 33
 eH1_4                 1.957493e-02 1 1  ON 34
 eH1_5                 3.569413e-02 1 1  ON 35
 eH1_6                 7.685982e-02 1 1  ON 36
 eH1_7                 1.104870e-01 1 1  ON 37
 eH1_8                 9.004022e-02 1 1  ON 38
 eH1_9                 2.407561e-02 1 1  ON 39
 eH2_0                -1.826410e-01 1 1  ON 40
 eH2_1                -1.036212e-01 1 1  ON 41
 eH2_2                -6.366441e-02 1 1  ON 42
 eH2_3                -2.764043e-02 1 1  ON 43
 eH2_4                 1.865409e-02 1 1  ON 44
 eH2_5                 3.505025e-02 1 1  ON 45
 eH2_6                 7.835913e-02 1 1  ON 46
 eH2_7                 1.139541e-01 1 1  ON 47
 eH2_8                 9.326278e-02 1 1  ON 48
 eH2_9                 2.615537e-02 1 1  ON 49
ci_001                -4.164787e-02 3 1  ON 50
ci_002                -3.014328e-02 3 1  ON 51
ci_003                -2.525832e-02 3 1  ON 52
ci_004                 2.146969e-02 3 1  ON 53
ci_005                 2.161075e-02 3 1  ON 54
ci_006                -1.879770e-02 3 1  ON 55
ci_007                -1.930301e-02 3 1  ON 56
ci_008                -1.800774e-02 3 1  ON 57
ci_009                -1.761310e-02 3 1  ON 58
ci_010                -1.789073e-02 3 1  ON 59
ci_011                -1.638074e-02 3 1  ON 60
ci_012                -1.642540e-02 3 1  ON 61
ci_013                -1.901716e-02 3 1  ON 62
ci_014                 1.378621e-02 3 1  ON 63
ci_015                 1.393115e-02 3 1  ON 64
ci_016                 1.632313e-02 3 1  ON 65
ci_017                 1.654195e-02 3 1  ON 66
ci_018                 1.257093e-02 3 1  ON 67
ci_019                 1.289714e-02 3 1  ON 68
ci_020                 1.326369e-02 3 1  ON 69
ci_021                 1.356518e-02 3 1  ON 70
ci_022                 1.175759e-02 3 1  ON 71
ci_023                 1.147476e-02 3 1  ON 72
ci_024                 1.248478e-02 3 1  ON 73
ci_025                 1.219152e-02 3 1  ON 74
ci_026                 1.112669e-02 3 1  ON 75
ci_027                 1.147038e-02 3 1  ON 76
ci_028                -1.449537e-02 3 1  ON 77
ci_029                -1.475137e-02 3 1  ON 78
ci_030                -1.102664e-02 3 1  ON 79
ci_031                -1.170905e-02 3 1  ON 80
ci_032                -1.337125e-02 3 1  ON 81
ci_033                 1.088617e-02 3 1  ON 82
ci_034                 1.071208e-02 3 1  ON 83
ci_035                -4.913341e-03 3 1  ON 84
ci_036                -1.088762e-02 3 1  ON 85
ci_037                -1.030450e-02 3 1  ON 86
ci_038                 1.629779e-03 3 1  ON 87
ci_039                 1.985076e-03 3 1  ON 88
ci_040                -4.059108e-03 3 1  ON 89
ci_041                 1.003157e-02 3 1  ON 90
ci_042                 9.771230e-03 3 1  ON 91
ci_043                -3.520606e-03 3 1  ON 92
ci_044                -1.542565e-02 3 1  ON 93
ci_045                -1.668937e-03 3 1  ON 94
ci_046                 5.240914e-03 3 1  ON 95
ci_047                 5.880236e-03 3 1  ON 96
ci_048                -1.131201e-02 3 1  ON 97
ci_049                -1.193561e-02 3 1  ON 98
ci_050                 7.678228e-03 3 1  ON 99
ci_051                 7.682126e-03 3 1  ON 100
ci_052                -6.989226e-03 3 1  ON 101
ci_053                -6.731252e-03 3 1  ON 102
ci_054                -2.980342e-03 3 1  ON 103
ci_055                -3.095260e-03 3 1  ON 104
ci_056                 4.844109e-03 3 1  ON 105
ci_057                 4.587727e-03 3 1  ON 106
ci_058                -6.857222e-03 3 1  ON 107
ci_059                -6.867787e-03 3 1  ON 108
ci_060                 8.407914e-03 3 1  ON 109
ci_061                 8.271084e-03 3 1  ON 110
ci_062                -3.078882e-03 3 1  ON 111
ci_063                -3.069424e-03 3 1  ON 112
ci_064                -2.962801e-03 3 1  ON 113
ci_065                -4.112349e-03 3 1  ON 114
ci_066                 6.033860e-03 3 1  ON 115
ci_067                 5.311541e-03 3 1  ON 116
ci_068                -5.299969e-03 3 1  ON 117
ci_069                -5.117786e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2422
    reference variance = 0.54983
====================================================
  Execution time = 2.0443e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1563e-01
  Total weights = 1.9565e+06
  Execution time = 1.8333e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300457385731
                                         uncertainty =       0.002273922564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300457385731
                                         uncertainty =       0.002273922564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387595149
  error estimate for blocks of size 2^( 2) =       0.000397484238
  error estimate for blocks of size 2^( 3) =       0.000406495243
  error estimate for blocks of size 2^( 4) =       0.000412824322
  error estimate for blocks of size 2^( 5) =       0.000416961478
  error estimate for blocks of size 2^( 6) =       0.000419544474
  error estimate for blocks of size 2^( 7) =       0.000423563097

      target function =                  N/A
              le_mean =     -17.216586967993
             les_mean =     296.726848320537
             stat err =       0.000418223342
             autocorr =       1.164286527301
              std dev =       0.548142316002
             le_variance =       0.300459998593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299978218193
                                         uncertainty =       0.002114610636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299978218193
                                         uncertainty =       0.002114610636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387287160
  error estimate for blocks of size 2^( 2) =       0.000397185362
  error estimate for blocks of size 2^( 3) =       0.000406196849
  error estimate for blocks of size 2^( 4) =       0.000412541577
  error estimate for blocks of size 2^( 5) =       0.000416682938
  error estimate for blocks of size 2^( 6) =       0.000419267968
  error estimate for blocks of size 2^( 7) =       0.000423265900

      target function =                  N/A
              le_mean =     -17.216583525127
             les_mean =     296.728354685761
             stat err =       0.000417939595
             autocorr =       1.164557237831
              std dev =       0.547706753939
             le_variance =       0.299982688310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300159865668
                                         uncertainty =       0.002169791224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300159865668
                                         uncertainty =       0.002169791224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387403921
  error estimate for blocks of size 2^( 2) =       0.000397298818
  error estimate for blocks of size 2^( 3) =       0.000406310582
  error estimate for blocks of size 2^( 4) =       0.000412649262
  error estimate for blocks of size 2^( 5) =       0.000416789341
  error estimate for blocks of size 2^( 6) =       0.000419373929
  error estimate for blocks of size 2^( 7) =       0.000423380101

      target function =                  N/A
              le_mean =     -17.216584517553
             les_mean =     296.726141625188
             stat err =       0.000418048158
             autocorr =       1.164460079844
              std dev =       0.547871879413
             le_variance =       0.300163596252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300415387079
                                         uncertainty =       0.002258120456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300415387079
                                         uncertainty =       0.002258120456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387568159
  error estimate for blocks of size 2^( 2) =       0.000397458051
  error estimate for blocks of size 2^( 3) =       0.000406469188
  error estimate for blocks of size 2^( 4) =       0.000412799589
  error estimate for blocks of size 2^( 5) =       0.000416937156
  error estimate for blocks of size 2^( 6) =       0.000419520378
  error estimate for blocks of size 2^( 7) =       0.000423537318

      target function =                  N/A
              le_mean =     -17.216586590826
             les_mean =     296.726734784939
             stat err =       0.000418198610
             autocorr =       1.164310974558
              std dev =       0.548104146563
             le_variance =       0.300418155479


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216586967993        initial  <--
     1.5625e+00     1.5625e+01             6.9382e-04       -17.216583525127
     6.2500e+00     6.2500e+01             1.7796e-04       -17.216584517553
     2.5000e+01     2.5000e+02             4.4798e-05       -17.216586590826

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6898
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.037482e-01 1 1  ON 0
  uu_1                 4.372814e-02 1 1  ON 1
  uu_2                -4.751388e-02 1 1  ON 2
  uu_3                -9.905156e-02 1 1  ON 3
  uu_4                -1.294514e-01 1 1  ON 4
  uu_5                -1.342713e-01 1 1  ON 5
  uu_6                -1.119055e-01 1 1  ON 6
  uu_7                -3.805216e-02 1 1  ON 7
  uu_8                 1.008567e-01 1 1  ON 8
  uu_9                 1.201972e-01 1 1  ON 9
  ud_0                 3.472018e-01 1 1  ON 10
  ud_1                 9.000392e-02 1 1  ON 11
  ud_2                -1.727426e-02 1 1  ON 12
  ud_3                -7.542323e-02 1 1  ON 13
  ud_4                -1.204296e-01 1 1  ON 14
  ud_5                -1.508191e-01 1 1  ON 15
  ud_6                -1.541434e-01 1 1  ON 16
  ud_7                -1.094175e-01 1 1  ON 17
  ud_8                 5.928084e-03 1 1  ON 18
  ud_9                 9.252117e-02 1 1  ON 19
  eO_0                -7.404439e-01 1 1  ON 20
  eO_1                -4.287854e-01 1 1  ON 21
  eO_2                -3.455979e-02 1 1  ON 22
  eO_3                 2.026542e-01 1 1  ON 23
  eO_4                 2.803955e-01 1 1  ON 24
  eO_5                 3.038447e-01 1 1  ON 25
  eO_6                 2.493892e-01 1 1  ON 26
  eO_7                 1.109022e-01 1 1  ON 27
  eO_8                 2.771615e-02 1 1  ON 28
  eO_9                 1.834573e-02 1 1  ON 29
 eH1_0                -1.815052e-01 1 1  ON 30
 eH1_1                -1.020675e-01 1 1  ON 31
 eH1_2                -6.229221e-02 1 1  ON 32
 eH1_3                -2.601710e-02 1 1  ON 33
 eH1_4                 1.958403e-02 1 1  ON 34
 eH1_5                 3.567795e-02 1 1  ON 35
 eH1_6                 7.685655e-02 1 1  ON 36
 eH1_7                 1.104938e-01 1 1  ON 37
 eH1_8                 9.003127e-02 1 1  ON 38
 eH1_9                 2.407263e-02 1 1  ON 39
 eH2_0                -1.826368e-01 1 1  ON 40
 eH2_1                -1.036111e-01 1 1  ON 41
 eH2_2                -6.366585e-02 1 1  ON 42
 eH2_3                -2.764992e-02 1 1  ON 43
 eH2_4                 1.866888e-02 1 1  ON 44
 eH2_5                 3.504976e-02 1 1  ON 45
 eH2_6                 7.835037e-02 1 1  ON 46
 eH2_7                 1.139583e-01 1 1  ON 47
 eH2_8                 9.325394e-02 1 1  ON 48
 eH2_9                 2.615295e-02 1 1  ON 49
ci_001                -4.166912e-02 3 1  ON 50
ci_002                -3.011168e-02 3 1  ON 51
ci_003                -2.527877e-02 3 1  ON 52
ci_004                 2.148483e-02 3 1  ON 53
ci_005                 2.160770e-02 3 1  ON 54
ci_006                -1.881281e-02 3 1  ON 55
ci_007                -1.931355e-02 3 1  ON 56
ci_008                -1.804607e-02 3 1  ON 57
ci_009                -1.761442e-02 3 1  ON 58
ci_010                -1.791045e-02 3 1  ON 59
ci_011                -1.639471e-02 3 1  ON 60
ci_012                -1.645794e-02 3 1  ON 61
ci_013                -1.901846e-02 3 1  ON 62
ci_014                 1.377390e-02 3 1  ON 63
ci_015                 1.395286e-02 3 1  ON 64
ci_016                 1.631321e-02 3 1  ON 65
ci_017                 1.655253e-02 3 1  ON 66
ci_018                 1.255562e-02 3 1  ON 67
ci_019                 1.289549e-02 3 1  ON 68
ci_020                 1.324614e-02 3 1  ON 69
ci_021                 1.359493e-02 3 1  ON 70
ci_022                 1.176355e-02 3 1  ON 71
ci_023                 1.147713e-02 3 1  ON 72
ci_024                 1.247651e-02 3 1  ON 73
ci_025                 1.220608e-02 3 1  ON 74
ci_026                 1.111524e-02 3 1  ON 75
ci_027                 1.148712e-02 3 1  ON 76
ci_028                -1.447188e-02 3 1  ON 77
ci_029                -1.476379e-02 3 1  ON 78
ci_030                -1.103069e-02 3 1  ON 79
ci_031                -1.172655e-02 3 1  ON 80
ci_032                -1.334712e-02 3 1  ON 81
ci_033                 1.090284e-02 3 1  ON 82
ci_034                 1.074204e-02 3 1  ON 83
ci_035                -4.906535e-03 3 1  ON 84
ci_036                -1.090540e-02 3 1  ON 85
ci_037                -1.028245e-02 3 1  ON 86
ci_038                 1.623439e-03 3 1  ON 87
ci_039                 1.971899e-03 3 1  ON 88
ci_040                -4.093427e-03 3 1  ON 89
ci_041                 1.002740e-02 3 1  ON 90
ci_042                 9.749287e-03 3 1  ON 91
ci_043                -3.558243e-03 3 1  ON 92
ci_044                -1.542210e-02 3 1  ON 93
ci_045                -1.663953e-03 3 1  ON 94
ci_046                 5.271512e-03 3 1  ON 95
ci_047                 5.903182e-03 3 1  ON 96
ci_048                -1.129511e-02 3 1  ON 97
ci_049                -1.193581e-02 3 1  ON 98
ci_050                 7.733534e-03 3 1  ON 99
ci_051                 7.715423e-03 3 1  ON 100
ci_052                -6.998646e-03 3 1  ON 101
ci_053                -6.777373e-03 3 1  ON 102
ci_054                -2.974851e-03 3 1  ON 103
ci_055                -3.104239e-03 3 1  ON 104
ci_056                 4.824015e-03 3 1  ON 105
ci_057                 4.588823e-03 3 1  ON 106
ci_058                -6.911509e-03 3 1  ON 107
ci_059                -6.872704e-03 3 1  ON 108
ci_060                 8.395146e-03 3 1  ON 109
ci_061                 8.254564e-03 3 1  ON 110
ci_062                -3.087192e-03 3 1  ON 111
ci_063                -3.024383e-03 3 1  ON 112
ci_064                -2.986516e-03 3 1  ON 113
ci_065                -4.099518e-03 3 1  ON 114
ci_066                 6.041784e-03 3 1  ON 115
ci_067                 5.272402e-03 3 1  ON 116
ci_068                -5.341419e-03 3 1  ON 117
ci_069                -5.112579e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6735e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7195e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1945
    reference variance = 0.187286
====================================================
  Execution time = 2.0623e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1324e-01
  Total weights = 1.956785468e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298277012878
                                         uncertainty =       0.002157778221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298277012878
                                         uncertainty =       0.002157778221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386180016
  error estimate for blocks of size 2^( 2) =       0.000396333661
  error estimate for blocks of size 2^( 3) =       0.000406017375
  error estimate for blocks of size 2^( 4) =       0.000412868000
  error estimate for blocks of size 2^( 5) =       0.000417538643
  error estimate for blocks of size 2^( 6) =       0.000420462158
  error estimate for blocks of size 2^( 7) =       0.000419551479

      target function =                  N/A
              le_mean =     -17.216474815709
             les_mean =     296.720244523329
             stat err =       0.000417605070
             autocorr =       1.169369961060
              std dev =       0.546141015453
             le_variance =       0.298270008760


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647481571e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216474815772       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216475251513       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216475255048       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216475424656       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216475316303       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216475385433       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216475414350       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216475433180       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216475424733       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216475419702       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+01 is 6.753515e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216474815772       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216474925876       residual = 8.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216474926958       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216474970046       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216474942744       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216474959517       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216474966529       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216474971705       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216474969540       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216474968237       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+01 is 1.690227e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216474815772       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216474843372       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216474843656       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216474854471       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216474847632       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216474851793       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216474853532       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216474854856       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216474854311       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216474853983       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+02 is 4.226698e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103086 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6715e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.037544e-01 1 1  ON 0
  uu_1                 4.372996e-02 1 1  ON 1
  uu_2                -4.751363e-02 1 1  ON 2
  uu_3                -9.905192e-02 1 1  ON 3
  uu_4                -1.294540e-01 1 1  ON 4
  uu_5                -1.342745e-01 1 1  ON 5
  uu_6                -1.119064e-01 1 1  ON 6
  uu_7                -3.805419e-02 1 1  ON 7
  uu_8                 1.008554e-01 1 1  ON 8
  uu_9                 1.201982e-01 1 1  ON 9
  ud_0                 3.472088e-01 1 1  ON 10
  ud_1                 9.000576e-02 1 1  ON 11
  ud_2                -1.727560e-02 1 1  ON 12
  ud_3                -7.542631e-02 1 1  ON 13
  ud_4                -1.204336e-01 1 1  ON 14
  ud_5                -1.508203e-01 1 1  ON 15
  ud_6                -1.541419e-01 1 1  ON 16
  ud_7                -1.094171e-01 1 1  ON 17
  ud_8                 5.926241e-03 1 1  ON 18
  ud_9                 9.252121e-02 1 1  ON 19
  eO_0                -7.404608e-01 1 1  ON 20
  eO_1                -4.287964e-01 1 1  ON 21
  eO_2                -3.456019e-02 1 1  ON 22
  eO_3                 2.026651e-01 1 1  ON 23
  eO_4                 2.804077e-01 1 1  ON 24
  eO_5                 3.038461e-01 1 1  ON 25
  eO_6                 2.493908e-01 1 1  ON 26
  eO_7                 1.109041e-01 1 1  ON 27
  eO_8                 2.771639e-02 1 1  ON 28
  eO_9                 1.834585e-02 1 1  ON 29
 eH1_0                -1.815059e-01 1 1  ON 30
 eH1_1                -1.020665e-01 1 1  ON 31
 eH1_2                -6.229279e-02 1 1  ON 32
 eH1_3                -2.601782e-02 1 1  ON 33
 eH1_4                 1.958263e-02 1 1  ON 34
 eH1_5                 3.567809e-02 1 1  ON 35
 eH1_6                 7.685734e-02 1 1  ON 36
 eH1_7                 1.104937e-01 1 1  ON 37
 eH1_8                 9.003246e-02 1 1  ON 38
 eH1_9                 2.407290e-02 1 1  ON 39
 eH2_0                -1.826406e-01 1 1  ON 40
 eH2_1                -1.036117e-01 1 1  ON 41
 eH2_2                -6.366516e-02 1 1  ON 42
 eH2_3                -2.765031e-02 1 1  ON 43
 eH2_4                 1.866891e-02 1 1  ON 44
 eH2_5                 3.505217e-02 1 1  ON 45
 eH2_6                 7.835111e-02 1 1  ON 46
 eH2_7                 1.139578e-01 1 1  ON 47
 eH2_8                 9.325503e-02 1 1  ON 48
 eH2_9                 2.615330e-02 1 1  ON 49
ci_001                -4.166649e-02 3 1  ON 50
ci_002                -3.011362e-02 3 1  ON 51
ci_003                -2.528165e-02 3 1  ON 52
ci_004                 2.148114e-02 3 1  ON 53
ci_005                 2.160765e-02 3 1  ON 54
ci_006                -1.881117e-02 3 1  ON 55
ci_007                -1.931493e-02 3 1  ON 56
ci_008                -1.804392e-02 3 1  ON 57
ci_009                -1.761329e-02 3 1  ON 58
ci_010                -1.791015e-02 3 1  ON 59
ci_011                -1.639236e-02 3 1  ON 60
ci_012                -1.645748e-02 3 1  ON 61
ci_013                -1.901870e-02 3 1  ON 62
ci_014                 1.377184e-02 3 1  ON 63
ci_015                 1.395044e-02 3 1  ON 64
ci_016                 1.631573e-02 3 1  ON 65
ci_017                 1.655220e-02 3 1  ON 66
ci_018                 1.255350e-02 3 1  ON 67
ci_019                 1.289384e-02 3 1  ON 68
ci_020                 1.324558e-02 3 1  ON 69
ci_021                 1.359313e-02 3 1  ON 70
ci_022                 1.176732e-02 3 1  ON 71
ci_023                 1.147446e-02 3 1  ON 72
ci_024                 1.247343e-02 3 1  ON 73
ci_025                 1.220772e-02 3 1  ON 74
ci_026                 1.111375e-02 3 1  ON 75
ci_027                 1.148460e-02 3 1  ON 76
ci_028                -1.447098e-02 3 1  ON 77
ci_029                -1.475893e-02 3 1  ON 78
ci_030                -1.103252e-02 3 1  ON 79
ci_031                -1.172693e-02 3 1  ON 80
ci_032                -1.335008e-02 3 1  ON 81
ci_033                 1.090045e-02 3 1  ON 82
ci_034                 1.073989e-02 3 1  ON 83
ci_035                -4.905291e-03 3 1  ON 84
ci_036                -1.090612e-02 3 1  ON 85
ci_037                -1.028266e-02 3 1  ON 86
ci_038                 1.623377e-03 3 1  ON 87
ci_039                 1.970088e-03 3 1  ON 88
ci_040                -4.093679e-03 3 1  ON 89
ci_041                 1.002723e-02 3 1  ON 90
ci_042                 9.752057e-03 3 1  ON 91
ci_043                -3.554604e-03 3 1  ON 92
ci_044                -1.541990e-02 3 1  ON 93
ci_045                -1.665228e-03 3 1  ON 94
ci_046                 5.272894e-03 3 1  ON 95
ci_047                 5.900152e-03 3 1  ON 96
ci_048                -1.129320e-02 3 1  ON 97
ci_049                -1.193668e-02 3 1  ON 98
ci_050                 7.733267e-03 3 1  ON 99
ci_051                 7.714149e-03 3 1  ON 100
ci_052                -6.995326e-03 3 1  ON 101
ci_053                -6.776503e-03 3 1  ON 102
ci_054                -2.975235e-03 3 1  ON 103
ci_055                -3.104667e-03 3 1  ON 104
ci_056                 4.820424e-03 3 1  ON 105
ci_057                 4.587515e-03 3 1  ON 106
ci_058                -6.911059e-03 3 1  ON 107
ci_059                -6.872180e-03 3 1  ON 108
ci_060                 8.390899e-03 3 1  ON 109
ci_061                 8.253404e-03 3 1  ON 110
ci_062                -3.086891e-03 3 1  ON 111
ci_063                -3.021630e-03 3 1  ON 112
ci_064                -2.987093e-03 3 1  ON 113
ci_065                -4.102166e-03 3 1  ON 114
ci_066                 6.036713e-03 3 1  ON 115
ci_067                 5.274540e-03 3 1  ON 116
ci_068                -5.341679e-03 3 1  ON 117
ci_069                -5.112988e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2256
    reference variance = 0.149882
====================================================
  Execution time = 2.0592e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1112e-01
  Total weights = 1.9567e+06
  Execution time = 1.8538e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297880769293
                                         uncertainty =       0.002715169229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297880769293
                                         uncertainty =       0.002715169229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385950567
  error estimate for blocks of size 2^( 2) =       0.000396448700
  error estimate for blocks of size 2^( 3) =       0.000405324454
  error estimate for blocks of size 2^( 4) =       0.000411803544
  error estimate for blocks of size 2^( 5) =       0.000415760073
  error estimate for blocks of size 2^( 6) =       0.000417943026
  error estimate for blocks of size 2^( 7) =       0.000420473517

      target function =                  N/A
              le_mean =     -17.216163457519
             les_mean =     296.707407891814
             stat err =       0.000416495040
             autocorr =       1.164545071070
              std dev =       0.545816525899
             le_variance =       0.297915679944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297884051169
                                         uncertainty =       0.002717438285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297884051169
                                         uncertainty =       0.002717438285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385952720
  error estimate for blocks of size 2^( 2) =       0.000396450693
  error estimate for blocks of size 2^( 3) =       0.000405326113
  error estimate for blocks of size 2^( 4) =       0.000411805346
  error estimate for blocks of size 2^( 5) =       0.000415762746
  error estimate for blocks of size 2^( 6) =       0.000417946324
  error estimate for blocks of size 2^( 7) =       0.000420476891

      target function =                  N/A
              le_mean =     -17.216163473635
             les_mean =     296.707396963606
             stat err =       0.000416497827
             autocorr =       1.164547658410
              std dev =       0.545819571606
             le_variance =       0.297919004749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297882402634
                                         uncertainty =       0.002716312330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297882402634
                                         uncertainty =       0.002716312330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385951639
  error estimate for blocks of size 2^( 2) =       0.000396449691
  error estimate for blocks of size 2^( 3) =       0.000405325275
  error estimate for blocks of size 2^( 4) =       0.000411804438
  error estimate for blocks of size 2^( 5) =       0.000415761407
  error estimate for blocks of size 2^( 6) =       0.000417944674
  error estimate for blocks of size 2^( 7) =       0.000420475204

      target function =                  N/A
              le_mean =     -17.216163462888
             les_mean =     296.707401216887
             stat err =       0.000416496431
             autocorr =       1.164546379272
              std dev =       0.545818041820
             le_variance =       0.297917334776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297880971011
                                         uncertainty =       0.002715312315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297880971011
                                         uncertainty =       0.002715312315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385950699
  error estimate for blocks of size 2^( 2) =       0.000396448822
  error estimate for blocks of size 2^( 3) =       0.000405324555
  error estimate for blocks of size 2^( 4) =       0.000411803654
  error estimate for blocks of size 2^( 5) =       0.000415760239
  error estimate for blocks of size 2^( 6) =       0.000417943230
  error estimate for blocks of size 2^( 7) =       0.000420473727

      target function =                  N/A
              le_mean =     -17.216163457863
             les_mean =     296.707406914915
             stat err =       0.000416495212
             autocorr =       1.164545235336
              std dev =       0.545816713147
             le_variance =       0.297915884350


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216163457519        initial
     1.5625e+01     1.5625e+02             6.7535e-05       -17.216163473635  <--
     6.2500e+01     6.2500e+02             1.6902e-05       -17.216163462888
     2.5000e+02     2.5000e+03             4.2267e-06       -17.216163457863

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.9864e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.037728e-01 1 1  ON 0
  uu_1                 4.373542e-02 1 1  ON 1
  uu_2                -4.751280e-02 1 1  ON 2
  uu_3                -9.905307e-02 1 1  ON 3
  uu_4                -1.294616e-01 1 1  ON 4
  uu_5                -1.342839e-01 1 1  ON 5
  uu_6                -1.119090e-01 1 1  ON 6
  uu_7                -3.806024e-02 1 1  ON 7
  uu_8                 1.008517e-01 1 1  ON 8
  uu_9                 1.202010e-01 1 1  ON 9
  ud_0                 3.472292e-01 1 1  ON 10
  ud_1                 9.001129e-02 1 1  ON 11
  ud_2                -1.727949e-02 1 1  ON 12
  ud_3                -7.543548e-02 1 1  ON 13
  ud_4                -1.204454e-01 1 1  ON 14
  ud_5                -1.508241e-01 1 1  ON 15
  ud_6                -1.541373e-01 1 1  ON 16
  ud_7                -1.094158e-01 1 1  ON 17
  ud_8                 5.920724e-03 1 1  ON 18
  ud_9                 9.252136e-02 1 1  ON 19
  eO_0                -7.405114e-01 1 1  ON 20
  eO_1                -4.288295e-01 1 1  ON 21
  eO_2                -3.456147e-02 1 1  ON 22
  eO_3                 2.026977e-01 1 1  ON 23
  eO_4                 2.804440e-01 1 1  ON 24
  eO_5                 3.038502e-01 1 1  ON 25
  eO_6                 2.493956e-01 1 1  ON 26
  eO_7                 1.109101e-01 1 1  ON 27
  eO_8                 2.771712e-02 1 1  ON 28
  eO_9                 1.834618e-02 1 1  ON 29
 eH1_0                -1.815080e-01 1 1  ON 30
 eH1_1                -1.020634e-01 1 1  ON 31
 eH1_2                -6.229451e-02 1 1  ON 32
 eH1_3                -2.601995e-02 1 1  ON 33
 eH1_4                 1.957841e-02 1 1  ON 34
 eH1_5                 3.567851e-02 1 1  ON 35
 eH1_6                 7.685972e-02 1 1  ON 36
 eH1_7                 1.104934e-01 1 1  ON 37
 eH1_8                 9.003603e-02 1 1  ON 38
 eH1_9                 2.407370e-02 1 1  ON 39
 eH2_0                -1.826520e-01 1 1  ON 40
 eH2_1                -1.036135e-01 1 1  ON 41
 eH2_2                -6.366316e-02 1 1  ON 42
 eH2_3                -2.765139e-02 1 1  ON 43
 eH2_4                 1.866897e-02 1 1  ON 44
 eH2_5                 3.505941e-02 1 1  ON 45
 eH2_6                 7.835334e-02 1 1  ON 46
 eH2_7                 1.139561e-01 1 1  ON 47
 eH2_8                 9.325829e-02 1 1  ON 48
 eH2_9                 2.615434e-02 1 1  ON 49
ci_001                -4.165865e-02 3 1  ON 50
ci_002                -3.011934e-02 3 1  ON 51
ci_003                -2.529021e-02 3 1  ON 52
ci_004                 2.147020e-02 3 1  ON 53
ci_005                 2.160751e-02 3 1  ON 54
ci_006                -1.880629e-02 3 1  ON 55
ci_007                -1.931902e-02 3 1  ON 56
ci_008                -1.803755e-02 3 1  ON 57
ci_009                -1.760993e-02 3 1  ON 58
ci_010                -1.790925e-02 3 1  ON 59
ci_011                -1.638538e-02 3 1  ON 60
ci_012                -1.645612e-02 3 1  ON 61
ci_013                -1.901936e-02 3 1  ON 62
ci_014                 1.376576e-02 3 1  ON 63
ci_015                 1.394330e-02 3 1  ON 64
ci_016                 1.632319e-02 3 1  ON 65
ci_017                 1.655120e-02 3 1  ON 66
ci_018                 1.254721e-02 3 1  ON 67
ci_019                 1.288894e-02 3 1  ON 68
ci_020                 1.324391e-02 3 1  ON 69
ci_021                 1.358777e-02 3 1  ON 70
ci_022                 1.177848e-02 3 1  ON 71
ci_023                 1.146656e-02 3 1  ON 72
ci_024                 1.246424e-02 3 1  ON 73
ci_025                 1.221259e-02 3 1  ON 74
ci_026                 1.110934e-02 3 1  ON 75
ci_027                 1.147715e-02 3 1  ON 76
ci_028                -1.446830e-02 3 1  ON 77
ci_029                -1.474452e-02 3 1  ON 78
ci_030                -1.103796e-02 3 1  ON 79
ci_031                -1.172805e-02 3 1  ON 80
ci_032                -1.335879e-02 3 1  ON 81
ci_033                 1.089339e-02 3 1  ON 82
ci_034                 1.073353e-02 3 1  ON 83
ci_035                -4.901631e-03 3 1  ON 84
ci_036                -1.090826e-02 3 1  ON 85
ci_037                -1.028330e-02 3 1  ON 86
ci_038                 1.623176e-03 3 1  ON 87
ci_039                 1.964761e-03 3 1  ON 88
ci_040                -4.094391e-03 3 1  ON 89
ci_041                 1.002674e-02 3 1  ON 90
ci_042                 9.760237e-03 3 1  ON 91
ci_043                -3.543914e-03 3 1  ON 92
ci_044                -1.541336e-02 3 1  ON 93
ci_045                -1.668940e-03 3 1  ON 94
ci_046                 5.276972e-03 3 1  ON 95
ci_047                 5.891211e-03 3 1  ON 96
ci_048                -1.128753e-02 3 1  ON 97
ci_049                -1.193927e-02 3 1  ON 98
ci_050                 7.732481e-03 3 1  ON 99
ci_051                 7.710412e-03 3 1  ON 100
ci_052                -6.985551e-03 3 1  ON 101
ci_053                -6.773943e-03 3 1  ON 102
ci_054                -2.976351e-03 3 1  ON 103
ci_055                -3.105919e-03 3 1  ON 104
ci_056                 4.809859e-03 3 1  ON 105
ci_057                 4.583666e-03 3 1  ON 106
ci_058                -6.909735e-03 3 1  ON 107
ci_059                -6.870636e-03 3 1  ON 108
ci_060                 8.378355e-03 3 1  ON 109
ci_061                 8.249977e-03 3 1  ON 110
ci_062                -3.086006e-03 3 1  ON 111
ci_063                -3.013510e-03 3 1  ON 112
ci_064                -2.988743e-03 3 1  ON 113
ci_065                -4.109873e-03 3 1  ON 114
ci_066                 6.021819e-03 3 1  ON 115
ci_067                 5.280825e-03 3 1  ON 116
ci_068                -5.342434e-03 3 1  ON 117
ci_069                -5.114183e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6586e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2188
    reference variance = 0.216879
====================================================
  Execution time = 2.0838e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1430e-01
  Total weights = 1.956378300e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0470e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300049370275
                                         uncertainty =       0.002209299951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300049370275
                                         uncertainty =       0.002209299951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387335154
  error estimate for blocks of size 2^( 2) =       0.000397711987
  error estimate for blocks of size 2^( 3) =       0.000407168569
  error estimate for blocks of size 2^( 4) =       0.000413478033
  error estimate for blocks of size 2^( 5) =       0.000418559460
  error estimate for blocks of size 2^( 6) =       0.000420912349
  error estimate for blocks of size 2^( 7) =       0.000421848513

      target function =                  N/A
              le_mean =     -17.216608631622
             les_mean =     296.725917762586
             stat err =       0.000418699589
             autocorr =       1.168506784601
              std dev =       0.547774628470
             le_variance =       0.300057043596


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660863162e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216608631633       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216610943146       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216611024022       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216611041586       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216611743206       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216611764403       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216611837521       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216611860711       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216611851355       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216611861042       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+00 is 2.793413e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216608631633       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216609236951       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216609258194       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216609262880       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216609440243       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216609444470       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216609462011       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216609467785       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216609465902       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216609468712       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+01 is 7.042695e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216608631633       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216608784781       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216608790164       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216608791369       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216608835827       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216608836815       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216608841163       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216608842590       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216608842146       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216608842878       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+01 is 1.764375e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107107 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6898e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.037823e-01 1 1  ON 0
  uu_1                 4.375093e-02 1 1  ON 1
  uu_2                -4.750773e-02 1 1  ON 2
  uu_3                -9.906031e-02 1 1  ON 3
  uu_4                -1.294692e-01 1 1  ON 4
  uu_5                -1.342931e-01 1 1  ON 5
  uu_6                -1.119103e-01 1 1  ON 6
  uu_7                -3.806802e-02 1 1  ON 7
  uu_8                 1.008482e-01 1 1  ON 8
  uu_9                 1.202044e-01 1 1  ON 9
  ud_0                 3.472440e-01 1 1  ON 10
  ud_1                 9.002242e-02 1 1  ON 11
  ud_2                -1.727613e-02 1 1  ON 12
  ud_3                -7.544181e-02 1 1  ON 13
  ud_4                -1.204600e-01 1 1  ON 14
  ud_5                -1.508287e-01 1 1  ON 15
  ud_6                -1.541331e-01 1 1  ON 16
  ud_7                -1.094186e-01 1 1  ON 17
  ud_8                 5.913245e-03 1 1  ON 18
  ud_9                 9.252072e-02 1 1  ON 19
  eO_0                -7.405818e-01 1 1  ON 20
  eO_1                -4.288745e-01 1 1  ON 21
  eO_2                -3.456558e-02 1 1  ON 22
  eO_3                 2.027455e-01 1 1  ON 23
  eO_4                 2.805001e-01 1 1  ON 24
  eO_5                 3.038531e-01 1 1  ON 25
  eO_6                 2.493992e-01 1 1  ON 26
  eO_7                 1.109177e-01 1 1  ON 27
  eO_8                 2.771827e-02 1 1  ON 28
  eO_9                 1.834644e-02 1 1  ON 29
 eH1_0                -1.815124e-01 1 1  ON 30
 eH1_1                -1.020672e-01 1 1  ON 31
 eH1_2                -6.229517e-02 1 1  ON 32
 eH1_3                -2.602440e-02 1 1  ON 33
 eH1_4                 1.957828e-02 1 1  ON 34
 eH1_5                 3.568590e-02 1 1  ON 35
 eH1_6                 7.686193e-02 1 1  ON 36
 eH1_7                 1.104913e-01 1 1  ON 37
 eH1_8                 9.004053e-02 1 1  ON 38
 eH1_9                 2.407490e-02 1 1  ON 39
 eH2_0                -1.826555e-01 1 1  ON 40
 eH2_1                -1.036197e-01 1 1  ON 41
 eH2_2                -6.366228e-02 1 1  ON 42
 eH2_3                -2.764359e-02 1 1  ON 43
 eH2_4                 1.866161e-02 1 1  ON 44
 eH2_5                 3.506177e-02 1 1  ON 45
 eH2_6                 7.835375e-02 1 1  ON 46
 eH2_7                 1.139549e-01 1 1  ON 47
 eH2_8                 9.326322e-02 1 1  ON 48
 eH2_9                 2.615598e-02 1 1  ON 49
ci_001                -4.162652e-02 3 1  ON 50
ci_002                -3.012083e-02 3 1  ON 51
ci_003                -2.528543e-02 3 1  ON 52
ci_004                 2.146252e-02 3 1  ON 53
ci_005                 2.160351e-02 3 1  ON 54
ci_006                -1.881101e-02 3 1  ON 55
ci_007                -1.932904e-02 3 1  ON 56
ci_008                -1.801180e-02 3 1  ON 57
ci_009                -1.759416e-02 3 1  ON 58
ci_010                -1.790889e-02 3 1  ON 59
ci_011                -1.639731e-02 3 1  ON 60
ci_012                -1.645497e-02 3 1  ON 61
ci_013                -1.901994e-02 3 1  ON 62
ci_014                 1.377422e-02 3 1  ON 63
ci_015                 1.395851e-02 3 1  ON 64
ci_016                 1.632999e-02 3 1  ON 65
ci_017                 1.655715e-02 3 1  ON 66
ci_018                 1.255004e-02 3 1  ON 67
ci_019                 1.290334e-02 3 1  ON 68
ci_020                 1.323475e-02 3 1  ON 69
ci_021                 1.357196e-02 3 1  ON 70
ci_022                 1.176263e-02 3 1  ON 71
ci_023                 1.147034e-02 3 1  ON 72
ci_024                 1.245698e-02 3 1  ON 73
ci_025                 1.220638e-02 3 1  ON 74
ci_026                 1.110824e-02 3 1  ON 75
ci_027                 1.148919e-02 3 1  ON 76
ci_028                -1.446674e-02 3 1  ON 77
ci_029                -1.474079e-02 3 1  ON 78
ci_030                -1.103134e-02 3 1  ON 79
ci_031                -1.172157e-02 3 1  ON 80
ci_032                -1.335522e-02 3 1  ON 81
ci_033                 1.087773e-02 3 1  ON 82
ci_034                 1.074739e-02 3 1  ON 83
ci_035                -4.890433e-03 3 1  ON 84
ci_036                -1.089927e-02 3 1  ON 85
ci_037                -1.029706e-02 3 1  ON 86
ci_038                 1.620272e-03 3 1  ON 87
ci_039                 1.959455e-03 3 1  ON 88
ci_040                -4.101465e-03 3 1  ON 89
ci_041                 1.002411e-02 3 1  ON 90
ci_042                 9.761783e-03 3 1  ON 91
ci_043                -3.524013e-03 3 1  ON 92
ci_044                -1.540188e-02 3 1  ON 93
ci_045                -1.668721e-03 3 1  ON 94
ci_046                 5.283506e-03 3 1  ON 95
ci_047                 5.896303e-03 3 1  ON 96
ci_048                -1.129249e-02 3 1  ON 97
ci_049                -1.193197e-02 3 1  ON 98
ci_050                 7.729068e-03 3 1  ON 99
ci_051                 7.715507e-03 3 1  ON 100
ci_052                -6.966171e-03 3 1  ON 101
ci_053                -6.768858e-03 3 1  ON 102
ci_054                -2.976696e-03 3 1  ON 103
ci_055                -3.111718e-03 3 1  ON 104
ci_056                 4.802993e-03 3 1  ON 105
ci_057                 4.577620e-03 3 1  ON 106
ci_058                -6.906693e-03 3 1  ON 107
ci_059                -6.856964e-03 3 1  ON 108
ci_060                 8.380272e-03 3 1  ON 109
ci_061                 8.254399e-03 3 1  ON 110
ci_062                -3.072821e-03 3 1  ON 111
ci_063                -3.015626e-03 3 1  ON 112
ci_064                -2.987324e-03 3 1  ON 113
ci_065                -4.102950e-03 3 1  ON 114
ci_066                 6.022396e-03 3 1  ON 115
ci_067                 5.296530e-03 3 1  ON 116
ci_068                -5.337616e-03 3 1  ON 117
ci_069                -5.099321e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1843
    reference variance = 0.531209
====================================================
  Execution time = 2.2603e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1041e-01
  Total weights = 1.9564e+06
  Execution time = 1.8350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297860273420
                                         uncertainty =       0.002102984926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297860273420
                                         uncertainty =       0.002102984926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385913157
  error estimate for blocks of size 2^( 2) =       0.000395985412
  error estimate for blocks of size 2^( 3) =       0.000404974231
  error estimate for blocks of size 2^( 4) =       0.000411866842
  error estimate for blocks of size 2^( 5) =       0.000414799548
  error estimate for blocks of size 2^( 6) =       0.000416521547
  error estimate for blocks of size 2^( 7) =       0.000419879516

      target function =                  N/A
              le_mean =     -17.216645866981
             les_mean =     296.723294574760
             stat err =       0.000415766863
             autocorr =       1.160701577572
              std dev =       0.545763621029
             le_variance =       0.297857930038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297799779517
                                         uncertainty =       0.002101735465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297799779517
                                         uncertainty =       0.002101735465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385873787
  error estimate for blocks of size 2^( 2) =       0.000395947231
  error estimate for blocks of size 2^( 3) =       0.000404937221
  error estimate for blocks of size 2^( 4) =       0.000411831243
  error estimate for blocks of size 2^( 5) =       0.000414769214
  error estimate for blocks of size 2^( 6) =       0.000416489702
  error estimate for blocks of size 2^( 7) =       0.000419852205

      target function =                  N/A
              le_mean =     -17.216646454633
             les_mean =     296.723441779589
             stat err =       0.000415735591
             autocorr =       1.160763802892
              std dev =       0.545707943268
             le_variance =       0.297797159346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297826547040
                                         uncertainty =       0.002102306402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297826547040
                                         uncertainty =       0.002102306402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385891215
  error estimate for blocks of size 2^( 2) =       0.000395964157
  error estimate for blocks of size 2^( 3) =       0.000404953657
  error estimate for blocks of size 2^( 4) =       0.000411847062
  error estimate for blocks of size 2^( 5) =       0.000414782594
  error estimate for blocks of size 2^( 6) =       0.000416503766
  error estimate for blocks of size 2^( 7) =       0.000419864012

      target function =                  N/A
              le_mean =     -17.216646116901
             les_mean =     296.723309923960
             stat err =       0.000415749359
             autocorr =       1.160735837153
              std dev =       0.545732589422
             le_variance =       0.297824059157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297855891596
                                         uncertainty =       0.002102897746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297855891596
                                         uncertainty =       0.002102897746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385910307
  error estimate for blocks of size 2^( 2) =       0.000395982648
  error estimate for blocks of size 2^( 3) =       0.000404971555
  error estimate for blocks of size 2^( 4) =       0.000411864269
  error estimate for blocks of size 2^( 5) =       0.000414797334
  error estimate for blocks of size 2^( 6) =       0.000416519232
  error estimate for blocks of size 2^( 7) =       0.000419877485

      target function =                  N/A
              le_mean =     -17.216645891037
             les_mean =     296.723292573919
             stat err =       0.000415764580
             autocorr =       1.160705973954
              std dev =       0.545759589895
             le_variance =       0.297853529962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216645866981        initial
     3.9062e+00     3.9062e+01             2.7934e-04       -17.216646454633  <--
     1.5625e+01     1.5625e+02             7.0427e-05       -17.216646116901
     6.2500e+01     6.2500e+02             1.7644e-05       -17.216645891037

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 3.1903e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.038123e-01 1 1  ON 0
  uu_1                 4.379641e-02 1 1  ON 1
  uu_2                -4.749327e-02 1 1  ON 2
  uu_3                -9.908061e-02 1 1  ON 3
  uu_4                -1.294931e-01 1 1  ON 4
  uu_5                -1.343201e-01 1 1  ON 5
  uu_6                -1.119143e-01 1 1  ON 6
  uu_7                -3.809127e-02 1 1  ON 7
  uu_8                 1.008378e-01 1 1  ON 8
  uu_9                 1.202143e-01 1 1  ON 9
  ud_0                 3.472886e-01 1 1  ON 10
  ud_1                 9.005515e-02 1 1  ON 11
  ud_2                -1.726631e-02 1 1  ON 12
  ud_3                -7.546052e-02 1 1  ON 13
  ud_4                -1.205023e-01 1 1  ON 14
  ud_5                -1.508431e-01 1 1  ON 15
  ud_6                -1.541206e-01 1 1  ON 16
  ud_7                -1.094268e-01 1 1  ON 17
  ud_8                 5.890894e-03 1 1  ON 18
  ud_9                 9.251883e-02 1 1  ON 19
  eO_0                -7.407907e-01 1 1  ON 20
  eO_1                -4.290082e-01 1 1  ON 21
  eO_2                -3.457825e-02 1 1  ON 22
  eO_3                 2.028861e-01 1 1  ON 23
  eO_4                 2.806674e-01 1 1  ON 24
  eO_5                 3.038623e-01 1 1  ON 25
  eO_6                 2.494100e-01 1 1  ON 26
  eO_7                 1.109404e-01 1 1  ON 27
  eO_8                 2.772170e-02 1 1  ON 28
  eO_9                 1.834722e-02 1 1  ON 29
 eH1_0                -1.815256e-01 1 1  ON 30
 eH1_1                -1.020788e-01 1 1  ON 31
 eH1_2                -6.229731e-02 1 1  ON 32
 eH1_3                -2.603691e-02 1 1  ON 33
 eH1_4                 1.957714e-02 1 1  ON 34
 eH1_5                 3.570786e-02 1 1  ON 35
 eH1_6                 7.686878e-02 1 1  ON 36
 eH1_7                 1.104850e-01 1 1  ON 37
 eH1_8                 9.005398e-02 1 1  ON 38
 eH1_9                 2.407846e-02 1 1  ON 39
 eH2_0                -1.826659e-01 1 1  ON 40
 eH2_1                -1.036376e-01 1 1  ON 41
 eH2_2                -6.365956e-02 1 1  ON 42
 eH2_3                -2.762131e-02 1 1  ON 43
 eH2_4                 1.864050e-02 1 1  ON 44
 eH2_5                 3.506843e-02 1 1  ON 45
 eH2_6                 7.835499e-02 1 1  ON 46
 eH2_7                 1.139511e-01 1 1  ON 47
 eH2_8                 9.327793e-02 1 1  ON 48
 eH2_9                 2.616088e-02 1 1  ON 49
ci_001                -4.153425e-02 3 1  ON 50
ci_002                -3.012488e-02 3 1  ON 51
ci_003                -2.527200e-02 3 1  ON 52
ci_004                 2.144058e-02 3 1  ON 53
ci_005                 2.159195e-02 3 1  ON 54
ci_006                -1.882423e-02 3 1  ON 55
ci_007                -1.935759e-02 3 1  ON 56
ci_008                -1.793979e-02 3 1  ON 57
ci_009                -1.755012e-02 3 1  ON 58
ci_010                -1.790826e-02 3 1  ON 59
ci_011                -1.643098e-02 3 1  ON 60
ci_012                -1.645142e-02 3 1  ON 61
ci_013                -1.902170e-02 3 1  ON 62
ci_014                 1.379814e-02 3 1  ON 63
ci_015                 1.400149e-02 3 1  ON 64
ci_016                 1.634942e-02 3 1  ON 65
ci_017                 1.657423e-02 3 1  ON 66
ci_018                 1.255793e-02 3 1  ON 67
ci_019                 1.294377e-02 3 1  ON 68
ci_020                 1.320849e-02 3 1  ON 69
ci_021                 1.352669e-02 3 1  ON 70
ci_022                 1.171807e-02 3 1  ON 71
ci_023                 1.148093e-02 3 1  ON 72
ci_024                 1.243604e-02 3 1  ON 73
ci_025                 1.218821e-02 3 1  ON 74
ci_026                 1.110504e-02 3 1  ON 75
ci_027                 1.152323e-02 3 1  ON 76
ci_028                -1.446226e-02 3 1  ON 77
ci_029                -1.473024e-02 3 1  ON 78
ci_030                -1.101251e-02 3 1  ON 79
ci_031                -1.170303e-02 3 1  ON 80
ci_032                -1.334566e-02 3 1  ON 81
ci_033                 1.083295e-02 3 1  ON 82
ci_034                 1.078630e-02 3 1  ON 83
ci_035                -4.860014e-03 3 1  ON 84
ci_036                -1.087359e-02 3 1  ON 85
ci_037                -1.033598e-02 3 1  ON 86
ci_038                 1.612092e-03 3 1  ON 87
ci_039                 1.944581e-03 3 1  ON 88
ci_040                -4.120513e-03 3 1  ON 89
ci_041                 1.001664e-02 3 1  ON 90
ci_042                 9.766052e-03 3 1  ON 91
ci_043                -3.469470e-03 3 1  ON 92
ci_044                -1.536884e-02 3 1  ON 93
ci_045                -1.667989e-03 3 1  ON 94
ci_046                 5.301821e-03 3 1  ON 95
ci_047                 5.910517e-03 3 1  ON 96
ci_048                -1.130686e-02 3 1  ON 97
ci_049                -1.191118e-02 3 1  ON 98
ci_050                 7.719709e-03 3 1  ON 99
ci_051                 7.729365e-03 3 1  ON 100
ci_052                -6.912378e-03 3 1  ON 101
ci_053                -6.754914e-03 3 1  ON 102
ci_054                -2.977529e-03 3 1  ON 103
ci_055                -3.127798e-03 3 1  ON 104
ci_056                 4.783960e-03 3 1  ON 105
ci_057                 4.560854e-03 3 1  ON 106
ci_058                -6.898300e-03 3 1  ON 107
ci_059                -6.818942e-03 3 1  ON 108
ci_060                 8.385566e-03 3 1  ON 109
ci_061                 8.267011e-03 3 1  ON 110
ci_062                -3.035778e-03 3 1  ON 111
ci_063                -3.021400e-03 3 1  ON 112
ci_064                -2.983458e-03 3 1  ON 113
ci_065                -4.084793e-03 3 1  ON 114
ci_066                 6.024008e-03 3 1  ON 115
ci_067                 5.339612e-03 3 1  ON 116
ci_068                -5.324004e-03 3 1  ON 117
ci_069                -5.057389e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8814e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2411
    reference variance = 0.178515
====================================================
  Execution time = 2.1305e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1514e-01
  Total weights = 1.956297794e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0579e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302145013506
                                         uncertainty =       0.001877899330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302145013506
                                         uncertainty =       0.001877899330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388638105
  error estimate for blocks of size 2^( 2) =       0.000398204153
  error estimate for blocks of size 2^( 3) =       0.000407536848
  error estimate for blocks of size 2^( 4) =       0.000414519951
  error estimate for blocks of size 2^( 5) =       0.000419164534
  error estimate for blocks of size 2^( 6) =       0.000420137705
  error estimate for blocks of size 2^( 7) =       0.000421108935

      target function =                  N/A
              le_mean =     -17.215967379602
             les_mean =     296.704673498057
             stat err =       0.000418732781
             autocorr =       1.160868868222
              std dev =       0.549617278267
             le_variance =       0.302079152569


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721596737960e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215967379621       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215973875852       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215973441720       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215972529817       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215975591093       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215975437504       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215975734253       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215975842619       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215975975367       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215975981907       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215975962678       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e-01 is 1.071452e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215967379621       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215969319327       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215969232860       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215969033752       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215969891793       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215969761645       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215969805953       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215969871304       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215969879128       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215969890918       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+00 is 2.785654e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215967379621       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215967889314       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215967869906       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215967825023       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215968045969       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215968005679       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215968014756       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215968032702       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215968034613       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215968037123       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+01 is 7.045839e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116219 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7384e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.038704e-01 1 1  ON 0
  uu_1                 4.386943e-02 1 1  ON 1
  uu_2                -4.745799e-02 1 1  ON 2
  uu_3                -9.907285e-02 1 1  ON 3
  uu_4                -1.295077e-01 1 1  ON 4
  uu_5                -1.343724e-01 1 1  ON 5
  uu_6                -1.119692e-01 1 1  ON 6
  uu_7                -3.814680e-02 1 1  ON 7
  uu_8                 1.008176e-01 1 1  ON 8
  uu_9                 1.202270e-01 1 1  ON 9
  ud_0                 3.473530e-01 1 1  ON 10
  ud_1                 9.011632e-02 1 1  ON 11
  ud_2                -1.725469e-02 1 1  ON 12
  ud_3                -7.549292e-02 1 1  ON 13
  ud_4                -1.205382e-01 1 1  ON 14
  ud_5                -1.508646e-01 1 1  ON 15
  ud_6                -1.541112e-01 1 1  ON 16
  ud_7                -1.094511e-01 1 1  ON 17
  ud_8                 5.851910e-03 1 1  ON 18
  ud_9                 9.251605e-02 1 1  ON 19
  eO_0                -7.410693e-01 1 1  ON 20
  eO_1                -4.291625e-01 1 1  ON 21
  eO_2                -3.458794e-02 1 1  ON 22
  eO_3                 2.030745e-01 1 1  ON 23
  eO_4                 2.808780e-01 1 1  ON 24
  eO_5                 3.038664e-01 1 1  ON 25
  eO_6                 2.494177e-01 1 1  ON 26
  eO_7                 1.109669e-01 1 1  ON 27
  eO_8                 2.772580e-02 1 1  ON 28
  eO_9                 1.834772e-02 1 1  ON 29
 eH1_0                -1.815417e-01 1 1  ON 30
 eH1_1                -1.020997e-01 1 1  ON 31
 eH1_2                -6.229651e-02 1 1  ON 32
 eH1_3                -2.605150e-02 1 1  ON 33
 eH1_4                 1.959746e-02 1 1  ON 34
 eH1_5                 3.573617e-02 1 1  ON 35
 eH1_6                 7.686525e-02 1 1  ON 36
 eH1_7                 1.104702e-01 1 1  ON 37
 eH1_8                 9.006910e-02 1 1  ON 38
 eH1_9                 2.408367e-02 1 1  ON 39
 eH2_0                -1.826963e-01 1 1  ON 40
 eH2_1                -1.036393e-01 1 1  ON 41
 eH2_2                -6.365977e-02 1 1  ON 42
 eH2_3                -2.761029e-02 1 1  ON 43
 eH2_4                 1.864854e-02 1 1  ON 44
 eH2_5                 3.508686e-02 1 1  ON 45
 eH2_6                 7.835010e-02 1 1  ON 46
 eH2_7                 1.139359e-01 1 1  ON 47
 eH2_8                 9.328934e-02 1 1  ON 48
 eH2_9                 2.616384e-02 1 1  ON 49
ci_001                -4.150289e-02 3 1  ON 50
ci_002                -3.016215e-02 3 1  ON 51
ci_003                -2.526339e-02 3 1  ON 52
ci_004                 2.143050e-02 3 1  ON 53
ci_005                 2.159519e-02 3 1  ON 54
ci_006                -1.886015e-02 3 1  ON 55
ci_007                -1.933420e-02 3 1  ON 56
ci_008                -1.794301e-02 3 1  ON 57
ci_009                -1.756482e-02 3 1  ON 58
ci_010                -1.789393e-02 3 1  ON 59
ci_011                -1.641338e-02 3 1  ON 60
ci_012                -1.645918e-02 3 1  ON 61
ci_013                -1.906150e-02 3 1  ON 62
ci_014                 1.376695e-02 3 1  ON 63
ci_015                 1.397062e-02 3 1  ON 64
ci_016                 1.638798e-02 3 1  ON 65
ci_017                 1.654566e-02 3 1  ON 66
ci_018                 1.253608e-02 3 1  ON 67
ci_019                 1.290336e-02 3 1  ON 68
ci_020                 1.322654e-02 3 1  ON 69
ci_021                 1.351416e-02 3 1  ON 70
ci_022                 1.168065e-02 3 1  ON 71
ci_023                 1.147828e-02 3 1  ON 72
ci_024                 1.240330e-02 3 1  ON 73
ci_025                 1.216138e-02 3 1  ON 74
ci_026                 1.111208e-02 3 1  ON 75
ci_027                 1.152468e-02 3 1  ON 76
ci_028                -1.449109e-02 3 1  ON 77
ci_029                -1.469449e-02 3 1  ON 78
ci_030                -1.102334e-02 3 1  ON 79
ci_031                -1.168863e-02 3 1  ON 80
ci_032                -1.336720e-02 3 1  ON 81
ci_033                 1.080535e-02 3 1  ON 82
ci_034                 1.074889e-02 3 1  ON 83
ci_035                -4.845882e-03 3 1  ON 84
ci_036                -1.078764e-02 3 1  ON 85
ci_037                -1.031920e-02 3 1  ON 86
ci_038                 1.639224e-03 3 1  ON 87
ci_039                 1.894423e-03 3 1  ON 88
ci_040                -4.081271e-03 3 1  ON 89
ci_041                 1.000901e-02 3 1  ON 90
ci_042                 9.762668e-03 3 1  ON 91
ci_043                -3.399263e-03 3 1  ON 92
ci_044                -1.536533e-02 3 1  ON 93
ci_045                -1.667923e-03 3 1  ON 94
ci_046                 5.283471e-03 3 1  ON 95
ci_047                 5.951423e-03 3 1  ON 96
ci_048                -1.137271e-02 3 1  ON 97
ci_049                -1.190090e-02 3 1  ON 98
ci_050                 7.664418e-03 3 1  ON 99
ci_051                 7.620955e-03 3 1  ON 100
ci_052                -6.846280e-03 3 1  ON 101
ci_053                -6.717859e-03 3 1  ON 102
ci_054                -2.997754e-03 3 1  ON 103
ci_055                -3.102599e-03 3 1  ON 104
ci_056                 4.765933e-03 3 1  ON 105
ci_057                 4.558999e-03 3 1  ON 106
ci_058                -6.840597e-03 3 1  ON 107
ci_059                -6.810017e-03 3 1  ON 108
ci_060                 8.335255e-03 3 1  ON 109
ci_061                 8.189097e-03 3 1  ON 110
ci_062                -3.050307e-03 3 1  ON 111
ci_063                -3.037891e-03 3 1  ON 112
ci_064                -2.999448e-03 3 1  ON 113
ci_065                -4.109027e-03 3 1  ON 114
ci_066                 5.978385e-03 3 1  ON 115
ci_067                 5.356399e-03 3 1  ON 116
ci_068                -5.350504e-03 3 1  ON 117
ci_069                -5.052448e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.143
    reference variance = 0.898521
====================================================
  Execution time = 2.0762e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0867e-01
  Total weights = 1.9568e+06
  Execution time = 1.8428e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295801069995
                                         uncertainty =       0.001832724127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295801069995
                                         uncertainty =       0.001832724127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384579803
  error estimate for blocks of size 2^( 2) =       0.000394632657
  error estimate for blocks of size 2^( 3) =       0.000403536490
  error estimate for blocks of size 2^( 4) =       0.000411368543
  error estimate for blocks of size 2^( 5) =       0.000416468108
  error estimate for blocks of size 2^( 6) =       0.000419111175
  error estimate for blocks of size 2^( 7) =       0.000418565389

      target function =                  N/A
              le_mean =     -17.216012746225
             les_mean =     296.699918685294
             stat err =       0.000416378304
             autocorr =       1.172204106366
              std dev =       0.543877972882
             le_variance =       0.295803249386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295532512573
                                         uncertainty =       0.001824031903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295532512573
                                         uncertainty =       0.001824031903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384405376
  error estimate for blocks of size 2^( 2) =       0.000394463745
  error estimate for blocks of size 2^( 3) =       0.000403372597
  error estimate for blocks of size 2^( 4) =       0.000411210531
  error estimate for blocks of size 2^( 5) =       0.000416314152
  error estimate for blocks of size 2^( 6) =       0.000418952745
  error estimate for blocks of size 2^( 7) =       0.000418406702

      target function =                  N/A
              le_mean =     -17.216015038587
             les_mean =     296.699696266567
             stat err =       0.000416221032
             autocorr =       1.172381988518
              std dev =       0.543631296845
             le_variance =       0.295534986909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295616165507
                                         uncertainty =       0.001827272529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295616165507
                                         uncertainty =       0.001827272529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384459701
  error estimate for blocks of size 2^( 2) =       0.000394516560
  error estimate for blocks of size 2^( 3) =       0.000403424214
  error estimate for blocks of size 2^( 4) =       0.000411260374
  error estimate for blocks of size 2^( 5) =       0.000416363086
  error estimate for blocks of size 2^( 6) =       0.000419003593
  error estimate for blocks of size 2^( 7) =       0.000418457563

      target function =                  N/A
              le_mean =     -17.216013555299
             les_mean =     296.699724909579
             stat err =       0.000416271154
             autocorr =       1.172332991513
              std dev =       0.543708123221
             le_variance =       0.295618523257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295774918647
                                         uncertainty =       0.001831986731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295774918647
                                         uncertainty =       0.001831986731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384562818
  error estimate for blocks of size 2^( 2) =       0.000394616237
  error estimate for blocks of size 2^( 3) =       0.000403520614
  error estimate for blocks of size 2^( 4) =       0.000411353246
  error estimate for blocks of size 2^( 5) =       0.000416453289
  error estimate for blocks of size 2^( 6) =       0.000419096013
  error estimate for blocks of size 2^( 7) =       0.000418550194

      target function =                  N/A
              le_mean =     -17.216012744960
             les_mean =     296.699877058964
             stat err =       0.000416363185
             autocorr =       1.172222522457
              std dev =       0.543853952957
             le_variance =       0.295777122147


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216012746225        initial
     9.7656e-01     9.7656e+00             1.0715e-03       -17.216015038587  <--
     3.9062e+00     3.9062e+01             2.7857e-04       -17.216013555299
     1.5625e+01     1.5625e+02             7.0458e-05       -17.216012744960

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 3.0037e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.040667e-01 1 1  ON 0
  uu_1                 4.406875e-02 1 1  ON 1
  uu_2                -4.735553e-02 1 1  ON 2
  uu_3                -9.905740e-02 1 1  ON 3
  uu_4                -1.295655e-01 1 1  ON 4
  uu_5                -1.345136e-01 1 1  ON 5
  uu_6                -1.121272e-01 1 1  ON 6
  uu_7                -3.831275e-02 1 1  ON 7
  uu_8                 1.007566e-01 1 1  ON 8
  uu_9                 1.202651e-01 1 1  ON 9
  ud_0                 3.475430e-01 1 1  ON 10
  ud_1                 9.028025e-02 1 1  ON 11
  ud_2                -1.721235e-02 1 1  ON 12
  ud_3                -7.557291e-02 1 1  ON 13
  ud_4                -1.206359e-01 1 1  ON 14
  ud_5                -1.509371e-01 1 1  ON 15
  ud_6                -1.540882e-01 1 1  ON 16
  ud_7                -1.095229e-01 1 1  ON 17
  ud_8                 5.734718e-03 1 1  ON 18
  ud_9                 9.250764e-02 1 1  ON 19
  eO_0                -7.418622e-01 1 1  ON 20
  eO_1                -4.296213e-01 1 1  ON 21
  eO_2                -3.462728e-02 1 1  ON 22
  eO_3                 2.035908e-01 1 1  ON 23
  eO_4                 2.815103e-01 1 1  ON 24
  eO_5                 3.038891e-01 1 1  ON 25
  eO_6                 2.494423e-01 1 1  ON 26
  eO_7                 1.110469e-01 1 1  ON 27
  eO_8                 2.773816e-02 1 1  ON 28
  eO_9                 1.834923e-02 1 1  ON 29
 eH1_0                -1.815875e-01 1 1  ON 30
 eH1_1                -1.021577e-01 1 1  ON 31
 eH1_2                -6.230077e-02 1 1  ON 32
 eH1_3                -2.608596e-02 1 1  ON 33
 eH1_4                 1.964523e-02 1 1  ON 34
 eH1_5                 3.581738e-02 1 1  ON 35
 eH1_6                 7.685973e-02 1 1  ON 36
 eH1_7                 1.104269e-01 1 1  ON 37
 eH1_8                 9.011481e-02 1 1  ON 38
 eH1_9                 2.409944e-02 1 1  ON 39
 eH2_0                -1.827770e-01 1 1  ON 40
 eH2_1                -1.036516e-01 1 1  ON 41
 eH2_2                -6.365746e-02 1 1  ON 42
 eH2_3                -2.758444e-02 1 1  ON 43
 eH2_4                 1.867098e-02 1 1  ON 44
 eH2_5                 3.513970e-02 1 1  ON 45
 eH2_6                 7.833935e-02 1 1  ON 46
 eH2_7                 1.138912e-01 1 1  ON 47
 eH2_8                 9.332382e-02 1 1  ON 48
 eH2_9                 2.617276e-02 1 1  ON 49
ci_001                -4.141631e-02 3 1  ON 50
ci_002                -3.025191e-02 3 1  ON 51
ci_003                -2.523639e-02 3 1  ON 52
ci_004                 2.140547e-02 3 1  ON 53
ci_005                 2.160142e-02 3 1  ON 54
ci_006                -1.894939e-02 3 1  ON 55
ci_007                -1.927451e-02 3 1  ON 56
ci_008                -1.794894e-02 3 1  ON 57
ci_009                -1.759574e-02 3 1  ON 58
ci_010                -1.785527e-02 3 1  ON 59
ci_011                -1.636873e-02 3 1  ON 60
ci_012                -1.647684e-02 3 1  ON 61
ci_013                -1.916387e-02 3 1  ON 62
ci_014                 1.369329e-02 3 1  ON 63
ci_015                 1.389692e-02 3 1  ON 64
ci_016                 1.648245e-02 3 1  ON 65
ci_017                 1.647056e-02 3 1  ON 66
ci_018                 1.248147e-02 3 1  ON 67
ci_019                 1.280461e-02 3 1  ON 68
ci_020                 1.326936e-02 3 1  ON 69
ci_021                 1.348275e-02 3 1  ON 70
ci_022                 1.159211e-02 3 1  ON 71
ci_023                 1.147096e-02 3 1  ON 72
ci_024                 1.231696e-02 3 1  ON 73
ci_025                 1.209092e-02 3 1  ON 74
ci_026                 1.112796e-02 3 1  ON 75
ci_027                 1.152541e-02 3 1  ON 76
ci_028                -1.456159e-02 3 1  ON 77
ci_029                -1.460397e-02 3 1  ON 78
ci_030                -1.104893e-02 3 1  ON 79
ci_031                -1.165146e-02 3 1  ON 80
ci_032                -1.341507e-02 3 1  ON 81
ci_033                 1.073914e-02 3 1  ON 82
ci_034                 1.065895e-02 3 1  ON 83
ci_035                -4.812161e-03 3 1  ON 84
ci_036                -1.057750e-02 3 1  ON 85
ci_037                -1.027657e-02 3 1  ON 86
ci_038                 1.692673e-03 3 1  ON 87
ci_039                 1.785084e-03 3 1  ON 88
ci_040                -3.996449e-03 3 1  ON 89
ci_041                 9.990392e-03 3 1  ON 90
ci_042                 9.753706e-03 3 1  ON 91
ci_043                -3.243917e-03 3 1  ON 92
ci_044                -1.535459e-02 3 1  ON 93
ci_045                -1.663838e-03 3 1  ON 94
ci_046                 5.238453e-03 3 1  ON 95
ci_047                 6.047101e-03 3 1  ON 96
ci_048                -1.154189e-02 3 1  ON 97
ci_049                -1.187438e-02 3 1  ON 98
ci_050                 7.545694e-03 3 1  ON 99
ci_051                 7.382055e-03 3 1  ON 100
ci_052                -6.696633e-03 3 1  ON 101
ci_053                -6.633698e-03 3 1  ON 102
ci_054                -3.040881e-03 3 1  ON 103
ci_055                -3.041302e-03 3 1  ON 104
ci_056                 4.725879e-03 3 1  ON 105
ci_057                 4.555015e-03 3 1  ON 106
ci_058                -6.707437e-03 3 1  ON 107
ci_059                -6.791145e-03 3 1  ON 108
ci_060                 8.215075e-03 3 1  ON 109
ci_061                 8.002899e-03 3 1  ON 110
ci_062                -3.081565e-03 3 1  ON 111
ci_063                -3.076020e-03 3 1  ON 112
ci_064                -3.032279e-03 3 1  ON 113
ci_065                -4.158642e-03 3 1  ON 114
ci_066                 5.878646e-03 3 1  ON 115
ci_067                 5.394399e-03 3 1  ON 116
ci_068                -5.410910e-03 3 1  ON 117
ci_069                -5.039970e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7444e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1809
    reference variance = 0.190136
====================================================
  Execution time = 2.0922e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1960e-01
  Total weights = 1.956506538e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0442e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301684079277
                                         uncertainty =       0.002787068815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301684079277
                                         uncertainty =       0.002787068815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388327817
  error estimate for blocks of size 2^( 2) =       0.000398224649
  error estimate for blocks of size 2^( 3) =       0.000407339990
  error estimate for blocks of size 2^( 4) =       0.000414525294
  error estimate for blocks of size 2^( 5) =       0.000418064874
  error estimate for blocks of size 2^( 6) =       0.000420456190
  error estimate for blocks of size 2^( 7) =       0.000420455609

      target function =                  N/A
              le_mean =     -17.217072974994
             les_mean =     296.747204529689
             stat err =       0.000418375492
             autocorr =       1.160741386410
              std dev =       0.549178465364
             le_variance =       0.301596986820


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721707297499e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217072975034       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217079753745       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217078228444       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217082437707       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217082412205       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217082352711       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217084641534       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217083844211       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217083966372       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217084178246       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217084382276       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217084698480       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217084647748       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e-01 is 3.628310e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217072975034       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217075706753       residual = 8.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217075059524       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217075935197       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217076870219       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217075984014       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217076350769       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217076427583       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217076270502       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217076414579       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217076436790       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e-01 is 1.001656e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217072975034       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217073781312       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217073586886       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217073583381       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217073918354       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217073769284       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217073858126       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217073840257       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217073830244       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217073847279       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+00 is 2.565193e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126422 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6989e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.043816e-01 1 1  ON 0
  uu_1                 4.413093e-02 1 1  ON 1
  uu_2                -4.730796e-02 1 1  ON 2
  uu_3                -9.907787e-02 1 1  ON 3
  uu_4                -1.296475e-01 1 1  ON 4
  uu_5                -1.345934e-01 1 1  ON 5
  uu_6                -1.122075e-01 1 1  ON 6
  uu_7                -3.852566e-02 1 1  ON 7
  uu_8                 1.006724e-01 1 1  ON 8
  uu_9                 1.203309e-01 1 1  ON 9
  ud_0                 3.478156e-01 1 1  ON 10
  ud_1                 9.046079e-02 1 1  ON 11
  ud_2                -1.716349e-02 1 1  ON 12
  ud_3                -7.567792e-02 1 1  ON 13
  ud_4                -1.208713e-01 1 1  ON 14
  ud_5                -1.510280e-01 1 1  ON 15
  ud_6                -1.540800e-01 1 1  ON 16
  ud_7                -1.095667e-01 1 1  ON 17
  ud_8                 5.614923e-03 1 1  ON 18
  ud_9                 9.251302e-02 1 1  ON 19
  eO_0                -7.428638e-01 1 1  ON 20
  eO_1                -4.302685e-01 1 1  ON 21
  eO_2                -3.473891e-02 1 1  ON 22
  eO_3                 2.042678e-01 1 1  ON 23
  eO_4                 2.822731e-01 1 1  ON 24
  eO_5                 3.040000e-01 1 1  ON 25
  eO_6                 2.495067e-01 1 1  ON 26
  eO_7                 1.111530e-01 1 1  ON 27
  eO_8                 2.775790e-02 1 1  ON 28
  eO_9                 1.836050e-02 1 1  ON 29
 eH1_0                -1.815976e-01 1 1  ON 30
 eH1_1                -1.022501e-01 1 1  ON 31
 eH1_2                -6.229778e-02 1 1  ON 32
 eH1_3                -2.605327e-02 1 1  ON 33
 eH1_4                 1.958488e-02 1 1  ON 34
 eH1_5                 3.582118e-02 1 1  ON 35
 eH1_6                 7.690563e-02 1 1  ON 36
 eH1_7                 1.104180e-01 1 1  ON 37
 eH1_8                 9.017093e-02 1 1  ON 38
 eH1_9                 2.411912e-02 1 1  ON 39
 eH2_0                -1.828089e-01 1 1  ON 40
 eH2_1                -1.036538e-01 1 1  ON 41
 eH2_2                -6.364943e-02 1 1  ON 42
 eH2_3                -2.752442e-02 1 1  ON 43
 eH2_4                 1.856716e-02 1 1  ON 44
 eH2_5                 3.510731e-02 1 1  ON 45
 eH2_6                 7.836626e-02 1 1  ON 46
 eH2_7                 1.138609e-01 1 1  ON 47
 eH2_8                 9.339209e-02 1 1  ON 48
 eH2_9                 2.620087e-02 1 1  ON 49
ci_001                -4.119053e-02 3 1  ON 50
ci_002                -3.014478e-02 3 1  ON 51
ci_003                -2.515752e-02 3 1  ON 52
ci_004                 2.136103e-02 3 1  ON 53
ci_005                 2.157527e-02 3 1  ON 54
ci_006                -1.907696e-02 3 1  ON 55
ci_007                -1.910997e-02 3 1  ON 56
ci_008                -1.789096e-02 3 1  ON 57
ci_009                -1.770877e-02 3 1  ON 58
ci_010                -1.762558e-02 3 1  ON 59
ci_011                -1.624777e-02 3 1  ON 60
ci_012                -1.630798e-02 3 1  ON 61
ci_013                -1.908259e-02 3 1  ON 62
ci_014                 1.367680e-02 3 1  ON 63
ci_015                 1.387494e-02 3 1  ON 64
ci_016                 1.641840e-02 3 1  ON 65
ci_017                 1.667116e-02 3 1  ON 66
ci_018                 1.257573e-02 3 1  ON 67
ci_019                 1.267969e-02 3 1  ON 68
ci_020                 1.339739e-02 3 1  ON 69
ci_021                 1.364666e-02 3 1  ON 70
ci_022                 1.165652e-02 3 1  ON 71
ci_023                 1.154498e-02 3 1  ON 72
ci_024                 1.235248e-02 3 1  ON 73
ci_025                 1.200453e-02 3 1  ON 74
ci_026                 1.098375e-02 3 1  ON 75
ci_027                 1.145243e-02 3 1  ON 76
ci_028                -1.454739e-02 3 1  ON 77
ci_029                -1.440543e-02 3 1  ON 78
ci_030                -1.110752e-02 3 1  ON 79
ci_031                -1.169501e-02 3 1  ON 80
ci_032                -1.342310e-02 3 1  ON 81
ci_033                 1.082298e-02 3 1  ON 82
ci_034                 1.058695e-02 3 1  ON 83
ci_035                -4.622444e-03 3 1  ON 84
ci_036                -1.056137e-02 3 1  ON 85
ci_037                -1.012281e-02 3 1  ON 86
ci_038                 1.645230e-03 3 1  ON 87
ci_039                 1.800116e-03 3 1  ON 88
ci_040                -3.863413e-03 3 1  ON 89
ci_041                 9.918284e-03 3 1  ON 90
ci_042                 9.760634e-03 3 1  ON 91
ci_043                -3.173498e-03 3 1  ON 92
ci_044                -1.530773e-02 3 1  ON 93
ci_045                -1.825151e-03 3 1  ON 94
ci_046                 5.369424e-03 3 1  ON 95
ci_047                 5.953187e-03 3 1  ON 96
ci_048                -1.170380e-02 3 1  ON 97
ci_049                -1.190843e-02 3 1  ON 98
ci_050                 7.423402e-03 3 1  ON 99
ci_051                 7.264406e-03 3 1  ON 100
ci_052                -6.807274e-03 3 1  ON 101
ci_053                -6.662624e-03 3 1  ON 102
ci_054                -3.050058e-03 3 1  ON 103
ci_055                -2.998514e-03 3 1  ON 104
ci_056                 4.704753e-03 3 1  ON 105
ci_057                 4.634511e-03 3 1  ON 106
ci_058                -6.610500e-03 3 1  ON 107
ci_059                -6.752128e-03 3 1  ON 108
ci_060                 8.582203e-03 3 1  ON 109
ci_061                 8.263690e-03 3 1  ON 110
ci_062                -2.957244e-03 3 1  ON 111
ci_063                -3.111937e-03 3 1  ON 112
ci_064                -3.203698e-03 3 1  ON 113
ci_065                -3.956657e-03 3 1  ON 114
ci_066                 5.677038e-03 3 1  ON 115
ci_067                 5.474672e-03 3 1  ON 116
ci_068                -5.265264e-03 3 1  ON 117
ci_069                -5.166237e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.0959
    reference variance = 7.80657
====================================================
  Execution time = 2.0424e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1388e-01
  Total weights = 1.9566e+06
  Execution time = 1.8405e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299102721022
                                         uncertainty =       0.002218106188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299102721022
                                         uncertainty =       0.002218106188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386757262
  error estimate for blocks of size 2^( 2) =       0.000396944708
  error estimate for blocks of size 2^( 3) =       0.000405845077
  error estimate for blocks of size 2^( 4) =       0.000412746418
  error estimate for blocks of size 2^( 5) =       0.000417078361
  error estimate for blocks of size 2^( 6) =       0.000419848097
  error estimate for blocks of size 2^( 7) =       0.000419855544

      target function =                  N/A
              le_mean =     -17.216231370680
             les_mean =     296.772898416820
             stat err =       0.000417382105
             autocorr =       1.164637304736
              std dev =       0.546957364726
             le_variance =       0.299162358828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299227176740
                                         uncertainty =       0.002195463592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299227176740
                                         uncertainty =       0.002195463592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386841652
  error estimate for blocks of size 2^( 2) =       0.000396997336
  error estimate for blocks of size 2^( 3) =       0.000405891301
  error estimate for blocks of size 2^( 4) =       0.000412814264
  error estimate for blocks of size 2^( 5) =       0.000417140238
  error estimate for blocks of size 2^( 6) =       0.000419920832
  error estimate for blocks of size 2^( 7) =       0.000419905254

      target function =                  N/A
              le_mean =     -17.216248508048
             les_mean =     296.714707564999
             stat err =       0.000417445147
             autocorr =       1.164480915699
              std dev =       0.547076710466
             le_variance =       0.299292927134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299135523522
                                         uncertainty =       0.002215365010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299135523522
                                         uncertainty =       0.002215365010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386781860
  error estimate for blocks of size 2^( 2) =       0.000396948228
  error estimate for blocks of size 2^( 3) =       0.000405850488
  error estimate for blocks of size 2^( 4) =       0.000412777763
  error estimate for blocks of size 2^( 5) =       0.000417119363
  error estimate for blocks of size 2^( 6) =       0.000419915464
  error estimate for blocks of size 2^( 7) =       0.000419901622

      target function =                  N/A
              le_mean =     -17.216249475096
             les_mean =     296.719907894369
             stat err =       0.000417428553
             autocorr =       1.164748368600
              std dev =       0.546992151853
             le_variance =       0.299200414189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299049793433
                                         uncertainty =       0.002216969467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299049793433
                                         uncertainty =       0.002216969467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386723562
  error estimate for blocks of size 2^( 2) =       0.000396902867
  error estimate for blocks of size 2^( 3) =       0.000405800650
  error estimate for blocks of size 2^( 4) =       0.000412714333
  error estimate for blocks of size 2^( 5) =       0.000417027703
  error estimate for blocks of size 2^( 6) =       0.000419795916
  error estimate for blocks of size 2^( 7) =       0.000419795784

      target function =                  N/A
              le_mean =     -17.216236491618
             les_mean =     296.714117170895
             stat err =       0.000417333434
             autocorr =       1.164568640516
              std dev =       0.546909706205
             le_variance =       0.299110226742


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216231370680        initial
     2.4414e-01     2.4414e+00             3.6283e-03       -17.216248508048
     9.7656e-01     9.7656e+00             1.0017e-03       -17.216249475096  <--
     3.9062e+00     3.9062e+01             2.5652e-04       -17.216236491618

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.9736e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.043816e-01 1 1  ON 0
  uu_1                 4.413093e-02 1 1  ON 1
  uu_2                -4.730796e-02 1 1  ON 2
  uu_3                -9.907787e-02 1 1  ON 3
  uu_4                -1.296475e-01 1 1  ON 4
  uu_5                -1.345934e-01 1 1  ON 5
  uu_6                -1.122075e-01 1 1  ON 6
  uu_7                -3.852566e-02 1 1  ON 7
  uu_8                 1.006724e-01 1 1  ON 8
  uu_9                 1.203309e-01 1 1  ON 9
  ud_0                 3.478156e-01 1 1  ON 10
  ud_1                 9.046079e-02 1 1  ON 11
  ud_2                -1.716349e-02 1 1  ON 12
  ud_3                -7.567792e-02 1 1  ON 13
  ud_4                -1.208713e-01 1 1  ON 14
  ud_5                -1.510280e-01 1 1  ON 15
  ud_6                -1.540800e-01 1 1  ON 16
  ud_7                -1.095667e-01 1 1  ON 17
  ud_8                 5.614923e-03 1 1  ON 18
  ud_9                 9.251302e-02 1 1  ON 19
  eO_0                -7.428638e-01 1 1  ON 20
  eO_1                -4.302685e-01 1 1  ON 21
  eO_2                -3.473891e-02 1 1  ON 22
  eO_3                 2.042678e-01 1 1  ON 23
  eO_4                 2.822731e-01 1 1  ON 24
  eO_5                 3.040000e-01 1 1  ON 25
  eO_6                 2.495067e-01 1 1  ON 26
  eO_7                 1.111530e-01 1 1  ON 27
  eO_8                 2.775790e-02 1 1  ON 28
  eO_9                 1.836050e-02 1 1  ON 29
 eH1_0                -1.815976e-01 1 1  ON 30
 eH1_1                -1.022501e-01 1 1  ON 31
 eH1_2                -6.229778e-02 1 1  ON 32
 eH1_3                -2.605327e-02 1 1  ON 33
 eH1_4                 1.958488e-02 1 1  ON 34
 eH1_5                 3.582118e-02 1 1  ON 35
 eH1_6                 7.690563e-02 1 1  ON 36
 eH1_7                 1.104180e-01 1 1  ON 37
 eH1_8                 9.017093e-02 1 1  ON 38
 eH1_9                 2.411912e-02 1 1  ON 39
 eH2_0                -1.828089e-01 1 1  ON 40
 eH2_1                -1.036538e-01 1 1  ON 41
 eH2_2                -6.364943e-02 1 1  ON 42
 eH2_3                -2.752442e-02 1 1  ON 43
 eH2_4                 1.856716e-02 1 1  ON 44
 eH2_5                 3.510731e-02 1 1  ON 45
 eH2_6                 7.836626e-02 1 1  ON 46
 eH2_7                 1.138609e-01 1 1  ON 47
 eH2_8                 9.339209e-02 1 1  ON 48
 eH2_9                 2.620087e-02 1 1  ON 49
ci_001                -4.119053e-02 3 1  ON 50
ci_002                -3.014478e-02 3 1  ON 51
ci_003                -2.515752e-02 3 1  ON 52
ci_004                 2.136103e-02 3 1  ON 53
ci_005                 2.157527e-02 3 1  ON 54
ci_006                -1.907696e-02 3 1  ON 55
ci_007                -1.910997e-02 3 1  ON 56
ci_008                -1.789096e-02 3 1  ON 57
ci_009                -1.770877e-02 3 1  ON 58
ci_010                -1.762558e-02 3 1  ON 59
ci_011                -1.624777e-02 3 1  ON 60
ci_012                -1.630798e-02 3 1  ON 61
ci_013                -1.908259e-02 3 1  ON 62
ci_014                 1.367680e-02 3 1  ON 63
ci_015                 1.387494e-02 3 1  ON 64
ci_016                 1.641840e-02 3 1  ON 65
ci_017                 1.667116e-02 3 1  ON 66
ci_018                 1.257573e-02 3 1  ON 67
ci_019                 1.267969e-02 3 1  ON 68
ci_020                 1.339739e-02 3 1  ON 69
ci_021                 1.364666e-02 3 1  ON 70
ci_022                 1.165652e-02 3 1  ON 71
ci_023                 1.154498e-02 3 1  ON 72
ci_024                 1.235248e-02 3 1  ON 73
ci_025                 1.200453e-02 3 1  ON 74
ci_026                 1.098375e-02 3 1  ON 75
ci_027                 1.145243e-02 3 1  ON 76
ci_028                -1.454739e-02 3 1  ON 77
ci_029                -1.440543e-02 3 1  ON 78
ci_030                -1.110752e-02 3 1  ON 79
ci_031                -1.169501e-02 3 1  ON 80
ci_032                -1.342310e-02 3 1  ON 81
ci_033                 1.082298e-02 3 1  ON 82
ci_034                 1.058695e-02 3 1  ON 83
ci_035                -4.622444e-03 3 1  ON 84
ci_036                -1.056137e-02 3 1  ON 85
ci_037                -1.012281e-02 3 1  ON 86
ci_038                 1.645230e-03 3 1  ON 87
ci_039                 1.800116e-03 3 1  ON 88
ci_040                -3.863413e-03 3 1  ON 89
ci_041                 9.918284e-03 3 1  ON 90
ci_042                 9.760634e-03 3 1  ON 91
ci_043                -3.173498e-03 3 1  ON 92
ci_044                -1.530773e-02 3 1  ON 93
ci_045                -1.825151e-03 3 1  ON 94
ci_046                 5.369424e-03 3 1  ON 95
ci_047                 5.953187e-03 3 1  ON 96
ci_048                -1.170380e-02 3 1  ON 97
ci_049                -1.190843e-02 3 1  ON 98
ci_050                 7.423402e-03 3 1  ON 99
ci_051                 7.264406e-03 3 1  ON 100
ci_052                -6.807274e-03 3 1  ON 101
ci_053                -6.662624e-03 3 1  ON 102
ci_054                -3.050058e-03 3 1  ON 103
ci_055                -2.998514e-03 3 1  ON 104
ci_056                 4.704753e-03 3 1  ON 105
ci_057                 4.634511e-03 3 1  ON 106
ci_058                -6.610500e-03 3 1  ON 107
ci_059                -6.752128e-03 3 1  ON 108
ci_060                 8.582203e-03 3 1  ON 109
ci_061                 8.263690e-03 3 1  ON 110
ci_062                -2.957244e-03 3 1  ON 111
ci_063                -3.111937e-03 3 1  ON 112
ci_064                -3.203698e-03 3 1  ON 113
ci_065                -3.956657e-03 3 1  ON 114
ci_066                 5.677038e-03 3 1  ON 115
ci_067                 5.474672e-03 3 1  ON 116
ci_068                -5.265264e-03 3 1  ON 117
ci_069                -5.166237e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6747e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2318
    reference variance = 0.188097
====================================================
  Execution time = 2.0707e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1160e-01
  Total weights = 1.956722876e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0563e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297582620378
                                         uncertainty =       0.002149994270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297582620378
                                         uncertainty =       0.002149994270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385706929
  error estimate for blocks of size 2^( 2) =       0.000395762030
  error estimate for blocks of size 2^( 3) =       0.000405143325
  error estimate for blocks of size 2^( 4) =       0.000411728793
  error estimate for blocks of size 2^( 5) =       0.000416021015
  error estimate for blocks of size 2^( 6) =       0.000419305772
  error estimate for blocks of size 2^( 7) =       0.000421061611

      target function =                  N/A
              le_mean =     -17.216294956907
             les_mean =     296.712413108181
             stat err =       0.000417029298
             autocorr =       1.169010066115
              std dev =       0.545471970520
             le_variance =       0.297539670623


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629495691e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216294956968       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216302288210       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216302371537       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216300667942       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216307972719       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216308623875       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216309001508       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216307341319       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216307493863       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216307525059       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216307483041       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216307717660       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216307825864       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e-01 is 3.054366e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216294956968       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216297953337       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216298106494       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216297078779       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216299126304       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216300064524       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216299712069       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216299634676       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216299463328       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216299504482       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216299489289       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e-01 is 8.311842e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216294956968       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216295847379       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216295908780       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216295635524       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216296187242       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216296388938       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216296330023       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216296348534       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216296282149       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216296280046       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+00 is 2.124436e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131335 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6777e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.045623e-01 1 1  ON 0
  uu_1                 4.428781e-02 1 1  ON 1
  uu_2                -4.724931e-02 1 1  ON 2
  uu_3                -9.913244e-02 1 1  ON 3
  uu_4                -1.296929e-01 1 1  ON 4
  uu_5                -1.347806e-01 1 1  ON 5
  uu_6                -1.122278e-01 1 1  ON 6
  uu_7                -3.864722e-02 1 1  ON 7
  uu_8                 1.005678e-01 1 1  ON 8
  uu_9                 1.203784e-01 1 1  ON 9
  ud_0                 3.479590e-01 1 1  ON 10
  ud_1                 9.056007e-02 1 1  ON 11
  ud_2                -1.703308e-02 1 1  ON 12
  ud_3                -7.569247e-02 1 1  ON 13
  ud_4                -1.209666e-01 1 1  ON 14
  ud_5                -1.512118e-01 1 1  ON 15
  ud_6                -1.541196e-01 1 1  ON 16
  ud_7                -1.095769e-01 1 1  ON 17
  ud_8                 5.501419e-03 1 1  ON 18
  ud_9                 9.252198e-02 1 1  ON 19
  eO_0                -7.436950e-01 1 1  ON 20
  eO_1                -4.308563e-01 1 1  ON 21
  eO_2                -3.492019e-02 1 1  ON 22
  eO_3                 2.048199e-01 1 1  ON 23
  eO_4                 2.829835e-01 1 1  ON 24
  eO_5                 3.041000e-01 1 1  ON 25
  eO_6                 2.496060e-01 1 1  ON 26
  eO_7                 1.112560e-01 1 1  ON 27
  eO_8                 2.777055e-02 1 1  ON 28
  eO_9                 1.837121e-02 1 1  ON 29
 eH1_0                -1.816556e-01 1 1  ON 30
 eH1_1                -1.023192e-01 1 1  ON 31
 eH1_2                -6.226535e-02 1 1  ON 32
 eH1_3                -2.602392e-02 1 1  ON 33
 eH1_4                 1.952888e-02 1 1  ON 34
 eH1_5                 3.579356e-02 1 1  ON 35
 eH1_6                 7.694822e-02 1 1  ON 36
 eH1_7                 1.104244e-01 1 1  ON 37
 eH1_8                 9.024120e-02 1 1  ON 38
 eH1_9                 2.413981e-02 1 1  ON 39
 eH2_0                -1.829204e-01 1 1  ON 40
 eH2_1                -1.036251e-01 1 1  ON 41
 eH2_2                -6.364641e-02 1 1  ON 42
 eH2_3                -2.743967e-02 1 1  ON 43
 eH2_4                 1.849897e-02 1 1  ON 44
 eH2_5                 3.511691e-02 1 1  ON 45
 eH2_6                 7.836039e-02 1 1  ON 46
 eH2_7                 1.138230e-01 1 1  ON 47
 eH2_8                 9.345793e-02 1 1  ON 48
 eH2_9                 2.621875e-02 1 1  ON 49
ci_001                -4.110276e-02 3 1  ON 50
ci_002                -3.014839e-02 3 1  ON 51
ci_003                -2.521342e-02 3 1  ON 52
ci_004                 2.135633e-02 3 1  ON 53
ci_005                 2.156951e-02 3 1  ON 54
ci_006                -1.922262e-02 3 1  ON 55
ci_007                -1.912846e-02 3 1  ON 56
ci_008                -1.784709e-02 3 1  ON 57
ci_009                -1.794004e-02 3 1  ON 58
ci_010                -1.768139e-02 3 1  ON 59
ci_011                -1.617042e-02 3 1  ON 60
ci_012                -1.625330e-02 3 1  ON 61
ci_013                -1.920396e-02 3 1  ON 62
ci_014                 1.368004e-02 3 1  ON 63
ci_015                 1.383099e-02 3 1  ON 64
ci_016                 1.648821e-02 3 1  ON 65
ci_017                 1.665122e-02 3 1  ON 66
ci_018                 1.266716e-02 3 1  ON 67
ci_019                 1.289792e-02 3 1  ON 68
ci_020                 1.340936e-02 3 1  ON 69
ci_021                 1.362536e-02 3 1  ON 70
ci_022                 1.134045e-02 3 1  ON 71
ci_023                 1.131234e-02 3 1  ON 72
ci_024                 1.231887e-02 3 1  ON 73
ci_025                 1.192501e-02 3 1  ON 74
ci_026                 1.108652e-02 3 1  ON 75
ci_027                 1.145711e-02 3 1  ON 76
ci_028                -1.451052e-02 3 1  ON 77
ci_029                -1.453320e-02 3 1  ON 78
ci_030                -1.115760e-02 3 1  ON 79
ci_031                -1.166575e-02 3 1  ON 80
ci_032                -1.343866e-02 3 1  ON 81
ci_033                 1.083595e-02 3 1  ON 82
ci_034                 1.043886e-02 3 1  ON 83
ci_035                -4.750547e-03 3 1  ON 84
ci_036                -1.041199e-02 3 1  ON 85
ci_037                -1.007839e-02 3 1  ON 86
ci_038                 1.625937e-03 3 1  ON 87
ci_039                 1.742964e-03 3 1  ON 88
ci_040                -3.933899e-03 3 1  ON 89
ci_041                 9.864118e-03 3 1  ON 90
ci_042                 9.908955e-03 3 1  ON 91
ci_043                -3.160132e-03 3 1  ON 92
ci_044                -1.552708e-02 3 1  ON 93
ci_045                -1.777783e-03 3 1  ON 94
ci_046                 5.367678e-03 3 1  ON 95
ci_047                 5.920751e-03 3 1  ON 96
ci_048                -1.184162e-02 3 1  ON 97
ci_049                -1.195221e-02 3 1  ON 98
ci_050                 7.432067e-03 3 1  ON 99
ci_051                 7.333604e-03 3 1  ON 100
ci_052                -6.716617e-03 3 1  ON 101
ci_053                -6.687710e-03 3 1  ON 102
ci_054                -3.154862e-03 3 1  ON 103
ci_055                -3.074353e-03 3 1  ON 104
ci_056                 4.932492e-03 3 1  ON 105
ci_057                 4.598306e-03 3 1  ON 106
ci_058                -6.756112e-03 3 1  ON 107
ci_059                -6.613959e-03 3 1  ON 108
ci_060                 8.534464e-03 3 1  ON 109
ci_061                 8.309398e-03 3 1  ON 110
ci_062                -2.973410e-03 3 1  ON 111
ci_063                -3.131805e-03 3 1  ON 112
ci_064                -3.119662e-03 3 1  ON 113
ci_065                -4.112685e-03 3 1  ON 114
ci_066                 5.807492e-03 3 1  ON 115
ci_067                 5.507865e-03 3 1  ON 116
ci_068                -5.068320e-03 3 1  ON 117
ci_069                -4.999575e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2802
    reference variance = 0.539019
====================================================
  Execution time = 2.0638e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1377e-01
  Total weights = 1.9570e+06
  Execution time = 1.8601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299409487472
                                         uncertainty =       0.001736799899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299409487472
                                         uncertainty =       0.001736799899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386887862
  error estimate for blocks of size 2^( 2) =       0.000396824446
  error estimate for blocks of size 2^( 3) =       0.000405863377
  error estimate for blocks of size 2^( 4) =       0.000412736625
  error estimate for blocks of size 2^( 5) =       0.000416389778
  error estimate for blocks of size 2^( 6) =       0.000418825381
  error estimate for blocks of size 2^( 7) =       0.000421561870

      target function =                  N/A
              le_mean =     -17.216173571909
             les_mean =     296.741866237215
             stat err =       0.000417378414
             autocorr =       1.163830565812
              std dev =       0.547142061545
             le_variance =       0.299364435512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299821414238
                                         uncertainty =       0.001738922079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299821414238
                                         uncertainty =       0.001738922079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387154079
  error estimate for blocks of size 2^( 2) =       0.000397071702
  error estimate for blocks of size 2^( 3) =       0.000406089684
  error estimate for blocks of size 2^( 4) =       0.000412933781
  error estimate for blocks of size 2^( 5) =       0.000416570081
  error estimate for blocks of size 2^( 6) =       0.000419003787
  error estimate for blocks of size 2^( 7) =       0.000421726622

      target function =                  N/A
              le_mean =     -17.216175534309
             les_mean =     296.711190582753
             stat err =       0.000417558568
             autocorr =       1.163234086751
              std dev =       0.547518549143
             le_variance =       0.299776561655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299663101302
                                         uncertainty =       0.001737881187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299663101302
                                         uncertainty =       0.001737881187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387051896
  error estimate for blocks of size 2^( 2) =       0.000396977419
  error estimate for blocks of size 2^( 3) =       0.000406006417
  error estimate for blocks of size 2^( 4) =       0.000412862003
  error estimate for blocks of size 2^( 5) =       0.000416500214
  error estimate for blocks of size 2^( 6) =       0.000418937084
  error estimate for blocks of size 2^( 7) =       0.000421666349

      target function =                  N/A
              le_mean =     -17.216173852139
             les_mean =     296.720171741734
             stat err =       0.000417491412
             autocorr =       1.163474029084
              std dev =       0.547374041347
             le_variance =       0.299618341140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299432049137
                                         uncertainty =       0.001736316299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299432049137
                                         uncertainty =       0.001736316299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386902481
  error estimate for blocks of size 2^( 2) =       0.000396839023
  error estimate for blocks of size 2^( 3) =       0.000405879635
  error estimate for blocks of size 2^( 4) =       0.000412750716
  error estimate for blocks of size 2^( 5) =       0.000416403626
  error estimate for blocks of size 2^( 6) =       0.000418833959
  error estimate for blocks of size 2^( 7) =       0.000421570914

      target function =                  N/A
              le_mean =     -17.216173797301
             les_mean =     296.710571919061
             stat err =       0.000417389804
             autocorr =       1.163806134190
              std dev =       0.547162735746
             le_variance =       0.299387059389


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216173571909        initial
     2.4414e-01     2.4414e+00             3.0544e-03       -17.216175534309  <--
     9.7656e-01     9.7656e+00             8.3118e-04       -17.216173852139
     3.9062e+00     3.9062e+01             2.1244e-04       -17.216173797301

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.9974e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.050859e-01 1 1  ON 0
  uu_1                 4.467998e-02 1 1  ON 1
  uu_2                -4.706130e-02 1 1  ON 2
  uu_3                -9.920621e-02 1 1  ON 3
  uu_4                -1.298889e-01 1 1  ON 4
  uu_5                -1.352295e-01 1 1  ON 5
  uu_6                -1.123391e-01 1 1  ON 6
  uu_7                -3.901389e-02 1 1  ON 7
  uu_8                 1.002575e-01 1 1  ON 8
  uu_9                 1.205169e-01 1 1  ON 9
  ud_0                 3.483791e-01 1 1  ON 10
  ud_1                 9.092295e-02 1 1  ON 11
  ud_2                -1.678266e-02 1 1  ON 12
  ud_3                -7.572380e-02 1 1  ON 13
  ud_4                -1.212118e-01 1 1  ON 14
  ud_5                -1.516624e-01 1 1  ON 15
  ud_6                -1.542833e-01 1 1  ON 16
  ud_7                -1.096279e-01 1 1  ON 17
  ud_8                 5.165051e-03 1 1  ON 18
  ud_9                 9.254699e-02 1 1  ON 19
  eO_0                -7.459182e-01 1 1  ON 20
  eO_1                -4.324704e-01 1 1  ON 21
  eO_2                -3.541090e-02 1 1  ON 22
  eO_3                 2.060584e-01 1 1  ON 23
  eO_4                 2.850320e-01 1 1  ON 24
  eO_5                 3.044498e-01 1 1  ON 25
  eO_6                 2.498929e-01 1 1  ON 26
  eO_7                 1.115562e-01 1 1  ON 27
  eO_8                 2.780747e-02 1 1  ON 28
  eO_9                 1.840260e-02 1 1  ON 29
 eH1_0                -1.818112e-01 1 1  ON 30
 eH1_1                -1.024685e-01 1 1  ON 31
 eH1_2                -6.223785e-02 1 1  ON 32
 eH1_3                -2.595359e-02 1 1  ON 33
 eH1_4                 1.941670e-02 1 1  ON 34
 eH1_5                 3.567074e-02 1 1  ON 35
 eH1_6                 7.707708e-02 1 1  ON 36
 eH1_7                 1.104449e-01 1 1  ON 37
 eH1_8                 9.044670e-02 1 1  ON 38
 eH1_9                 2.420040e-02 1 1  ON 39
 eH2_0                -1.831477e-01 1 1  ON 40
 eH2_1                -1.036222e-01 1 1  ON 41
 eH2_2                -6.361978e-02 1 1  ON 42
 eH2_3                -2.727212e-02 1 1  ON 43
 eH2_4                 1.839007e-02 1 1  ON 44
 eH2_5                 3.509180e-02 1 1  ON 45
 eH2_6                 7.834953e-02 1 1  ON 46
 eH2_7                 1.137133e-01 1 1  ON 47
 eH2_8                 9.365026e-02 1 1  ON 48
 eH2_9                 2.627105e-02 1 1  ON 49
ci_001                -4.090655e-02 3 1  ON 50
ci_002                -3.013719e-02 3 1  ON 51
ci_003                -2.527339e-02 3 1  ON 52
ci_004                 2.133634e-02 3 1  ON 53
ci_005                 2.154008e-02 3 1  ON 54
ci_006                -1.945373e-02 3 1  ON 55
ci_007                -1.912987e-02 3 1  ON 56
ci_008                -1.776972e-02 3 1  ON 57
ci_009                -1.825132e-02 3 1  ON 58
ci_010                -1.776338e-02 3 1  ON 59
ci_011                -1.604675e-02 3 1  ON 60
ci_012                -1.617002e-02 3 1  ON 61
ci_013                -1.942140e-02 3 1  ON 62
ci_014                 1.368417e-02 3 1  ON 63
ci_015                 1.375817e-02 3 1  ON 64
ci_016                 1.658956e-02 3 1  ON 65
ci_017                 1.661356e-02 3 1  ON 66
ci_018                 1.279473e-02 3 1  ON 67
ci_019                 1.321050e-02 3 1  ON 68
ci_020                 1.341793e-02 3 1  ON 69
ci_021                 1.357596e-02 3 1  ON 70
ci_022                 1.087308e-02 3 1  ON 71
ci_023                 1.096491e-02 3 1  ON 72
ci_024                 1.224548e-02 3 1  ON 73
ci_025                 1.177250e-02 3 1  ON 74
ci_026                 1.122807e-02 3 1  ON 75
ci_027                 1.145235e-02 3 1  ON 76
ci_028                -1.444496e-02 3 1  ON 77
ci_029                -1.475875e-02 3 1  ON 78
ci_030                -1.122994e-02 3 1  ON 79
ci_031                -1.160665e-02 3 1  ON 80
ci_032                -1.345906e-02 3 1  ON 81
ci_033                 1.085162e-02 3 1  ON 82
ci_034                 1.020183e-02 3 1  ON 83
ci_035                -4.884648e-03 3 1  ON 84
ci_036                -1.015884e-02 3 1  ON 85
ci_037                -9.992010e-03 3 1  ON 86
ci_038                 1.580448e-03 3 1  ON 87
ci_039                 1.656062e-03 3 1  ON 88
ci_040                -3.999391e-03 3 1  ON 89
ci_041                 9.774078e-03 3 1  ON 90
ci_042                 1.012056e-02 3 1  ON 91
ci_043                -3.132062e-03 3 1  ON 92
ci_044                -1.591018e-02 3 1  ON 93
ci_045                -1.713754e-03 3 1  ON 94
ci_046                 5.356022e-03 3 1  ON 95
ci_047                 5.862488e-03 3 1  ON 96
ci_048                -1.209553e-02 3 1  ON 97
ci_049                -1.203389e-02 3 1  ON 98
ci_050                 7.437486e-03 3 1  ON 99
ci_051                 7.412287e-03 3 1  ON 100
ci_052                -6.589927e-03 3 1  ON 101
ci_053                -6.721128e-03 3 1  ON 102
ci_054                -3.278109e-03 3 1  ON 103
ci_055                -3.161028e-03 3 1  ON 104
ci_056                 5.224555e-03 3 1  ON 105
ci_057                 4.551230e-03 3 1  ON 106
ci_058                -6.952153e-03 3 1  ON 107
ci_059                -6.418543e-03 3 1  ON 108
ci_060                 8.471476e-03 3 1  ON 109
ci_061                 8.390174e-03 3 1  ON 110
ci_062                -2.983183e-03 3 1  ON 111
ci_063                -3.146657e-03 3 1  ON 112
ci_064                -3.038521e-03 3 1  ON 113
ci_065                -4.265492e-03 3 1  ON 114
ci_066                 5.969662e-03 3 1  ON 115
ci_067                 5.550326e-03 3 1  ON 116
ci_068                -4.782344e-03 3 1  ON 117
ci_069                -4.757249e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6757e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2283
    reference variance = 0.209593
====================================================
  Execution time = 2.1063e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1340e-01
  Total weights = 1.957015824e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1226e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299926409939
                                         uncertainty =       0.002838292994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299926409939
                                         uncertainty =       0.002838292994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387210532
  error estimate for blocks of size 2^( 2) =       0.000397844259
  error estimate for blocks of size 2^( 3) =       0.000406910262
  error estimate for blocks of size 2^( 4) =       0.000413744471
  error estimate for blocks of size 2^( 5) =       0.000417864185
  error estimate for blocks of size 2^( 6) =       0.000420073326
  error estimate for blocks of size 2^( 7) =       0.000419740107

      target function =                  N/A
              le_mean =     -17.216055353311
             les_mean =     296.705961822460
             stat err =       0.000417855522
             autocorr =       1.164549542592
              std dev =       0.547598385887
             le_variance =       0.299863992226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721605535331e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216055353341       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216070308739       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216077210936       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216082719818       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216081277177       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216101062202       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216100718421       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216102516727       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216104613555       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216103006727       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216103310729       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216104629332       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216103956425       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216103890949       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216104399664       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216104719155       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216105380221       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216105196667       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216104871726       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216105036104       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216105282730       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e-02 is 1.022968e-02

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216055353341       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216064918031       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216067784814       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216071906173       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216070001394       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216076710472       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216077203567       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216077251094       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216077553369       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216077222144       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216077484978       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216077533951       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216077247278       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216077304689       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e-01 is 3.277422e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216055353341       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216059270387       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216059968988       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216061633669       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216060782497       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216062415586       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216062630694       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216062659167       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216062635846       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216062701259       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216062688417       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e-01 is 9.019098e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141389 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7205e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.059366e-01 1 1  ON 0
  uu_1                 4.530986e-02 1 1  ON 1
  uu_2                -4.696845e-02 1 1  ON 2
  uu_3                -9.941032e-02 1 1  ON 3
  uu_4                -1.305078e-01 1 1  ON 4
  uu_5                -1.355854e-01 1 1  ON 5
  uu_6                -1.126304e-01 1 1  ON 6
  uu_7                -3.954105e-02 1 1  ON 7
  uu_8                 9.998470e-02 1 1  ON 8
  uu_9                 1.208234e-01 1 1  ON 9
  ud_0                 3.493565e-01 1 1  ON 10
  ud_1                 9.146337e-02 1 1  ON 11
  ud_2                -1.671535e-02 1 1  ON 12
  ud_3                -7.584708e-02 1 1  ON 13
  ud_4                -1.216924e-01 1 1  ON 14
  ud_5                -1.521080e-01 1 1  ON 15
  ud_6                -1.544107e-01 1 1  ON 16
  ud_7                -1.099828e-01 1 1  ON 17
  ud_8                 4.601127e-03 1 1  ON 18
  ud_9                 9.261270e-02 1 1  ON 19
  eO_0                -7.491956e-01 1 1  ON 20
  eO_1                -4.347669e-01 1 1  ON 21
  eO_2                -3.577354e-02 1 1  ON 22
  eO_3                 2.074634e-01 1 1  ON 23
  eO_4                 2.880749e-01 1 1  ON 24
  eO_5                 3.049469e-01 1 1  ON 25
  eO_6                 2.501842e-01 1 1  ON 26
  eO_7                 1.120134e-01 1 1  ON 27
  eO_8                 2.791598e-02 1 1  ON 28
  eO_9                 1.847811e-02 1 1  ON 29
 eH1_0                -1.820163e-01 1 1  ON 30
 eH1_1                -1.024212e-01 1 1  ON 31
 eH1_2                -6.231231e-02 1 1  ON 32
 eH1_3                -2.597116e-02 1 1  ON 33
 eH1_4                 1.930992e-02 1 1  ON 34
 eH1_5                 3.581462e-02 1 1  ON 35
 eH1_6                 7.704712e-02 1 1  ON 36
 eH1_7                 1.102819e-01 1 1  ON 37
 eH1_8                 9.070392e-02 1 1  ON 38
 eH1_9                 2.428696e-02 1 1  ON 39
 eH2_0                -1.832582e-01 1 1  ON 40
 eH2_1                -1.038263e-01 1 1  ON 41
 eH2_2                -6.343256e-02 1 1  ON 42
 eH2_3                -2.706945e-02 1 1  ON 43
 eH2_4                 1.823350e-02 1 1  ON 44
 eH2_5                 3.497071e-02 1 1  ON 45
 eH2_6                 7.819876e-02 1 1  ON 46
 eH2_7                 1.135915e-01 1 1  ON 47
 eH2_8                 9.395743e-02 1 1  ON 48
 eH2_9                 2.639239e-02 1 1  ON 49
ci_001                -4.060979e-02 3 1  ON 50
ci_002                -3.009186e-02 3 1  ON 51
ci_003                -2.502696e-02 3 1  ON 52
ci_004                 2.102653e-02 3 1  ON 53
ci_005                 2.108729e-02 3 1  ON 54
ci_006                -1.940137e-02 3 1  ON 55
ci_007                -1.913696e-02 3 1  ON 56
ci_008                -1.780738e-02 3 1  ON 57
ci_009                -1.770158e-02 3 1  ON 58
ci_010                -1.696319e-02 3 1  ON 59
ci_011                -1.597407e-02 3 1  ON 60
ci_012                -1.594126e-02 3 1  ON 61
ci_013                -1.927546e-02 3 1  ON 62
ci_014                 1.404290e-02 3 1  ON 63
ci_015                 1.394569e-02 3 1  ON 64
ci_016                 1.637803e-02 3 1  ON 65
ci_017                 1.651499e-02 3 1  ON 66
ci_018                 1.281302e-02 3 1  ON 67
ci_019                 1.265007e-02 3 1  ON 68
ci_020                 1.303991e-02 3 1  ON 69
ci_021                 1.372050e-02 3 1  ON 70
ci_022                 1.140363e-02 3 1  ON 71
ci_023                 1.071275e-02 3 1  ON 72
ci_024                 1.194123e-02 3 1  ON 73
ci_025                 1.204598e-02 3 1  ON 74
ci_026                 1.091242e-02 3 1  ON 75
ci_027                 1.132829e-02 3 1  ON 76
ci_028                -1.460401e-02 3 1  ON 77
ci_029                -1.480242e-02 3 1  ON 78
ci_030                -1.133172e-02 3 1  ON 79
ci_031                -1.125726e-02 3 1  ON 80
ci_032                -1.359502e-02 3 1  ON 81
ci_033                 1.069419e-02 3 1  ON 82
ci_034                 1.002321e-02 3 1  ON 83
ci_035                -4.991066e-03 3 1  ON 84
ci_036                -1.071700e-02 3 1  ON 85
ci_037                -1.035484e-02 3 1  ON 86
ci_038                 1.660391e-03 3 1  ON 87
ci_039                 1.764910e-03 3 1  ON 88
ci_040                -4.042264e-03 3 1  ON 89
ci_041                 9.904276e-03 3 1  ON 90
ci_042                 1.001140e-02 3 1  ON 91
ci_043                -2.900720e-03 3 1  ON 92
ci_044                -1.589353e-02 3 1  ON 93
ci_045                -1.534714e-03 3 1  ON 94
ci_046                 5.526073e-03 3 1  ON 95
ci_047                 6.050073e-03 3 1  ON 96
ci_048                -1.204298e-02 3 1  ON 97
ci_049                -1.196268e-02 3 1  ON 98
ci_050                 7.372384e-03 3 1  ON 99
ci_051                 7.488645e-03 3 1  ON 100
ci_052                -7.074171e-03 3 1  ON 101
ci_053                -6.334990e-03 3 1  ON 102
ci_054                -2.708430e-03 3 1  ON 103
ci_055                -3.448363e-03 3 1  ON 104
ci_056                 4.804221e-03 3 1  ON 105
ci_057                 4.661801e-03 3 1  ON 106
ci_058                -6.895105e-03 3 1  ON 107
ci_059                -6.678753e-03 3 1  ON 108
ci_060                 8.071476e-03 3 1  ON 109
ci_061                 8.410996e-03 3 1  ON 110
ci_062                -3.405845e-03 3 1  ON 111
ci_063                -2.731394e-03 3 1  ON 112
ci_064                -2.983055e-03 3 1  ON 113
ci_065                -4.102711e-03 3 1  ON 114
ci_066                 5.894580e-03 3 1  ON 115
ci_067                 5.690359e-03 3 1  ON 116
ci_068                -4.213117e-03 3 1  ON 117
ci_069                -5.033768e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2239
    reference variance = 0.321062
====================================================
  Execution time = 2.0524e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2161e-01
  Total weights = 1.9567e+06
  Execution time = 1.8249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0433229
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303731822922
                                         uncertainty =       0.006108438978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303731822922
                                         uncertainty =       0.006108438978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389650811
  error estimate for blocks of size 2^( 2) =       0.000399376831
  error estimate for blocks of size 2^( 3) =       0.000407755886
  error estimate for blocks of size 2^( 4) =       0.000413824795
  error estimate for blocks of size 2^( 5) =       0.000418816537
  error estimate for blocks of size 2^( 6) =       0.000421003583
  error estimate for blocks of size 2^( 7) =       0.000423523298

      target function =                  N/A
              le_mean =     -17.216311344456
             les_mean =     296.727152283210
             stat err =       0.000419292054
             autocorr =       1.157929434373
              std dev =       0.551049461894
             le_variance =       0.303655509454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304893304561
                                         uncertainty =       0.006029657654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304893304561
                                         uncertainty =       0.006029657654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390394239
  error estimate for blocks of size 2^( 2) =       0.000400089814
  error estimate for blocks of size 2^( 3) =       0.000408441189
  error estimate for blocks of size 2^( 4) =       0.000414515963
  error estimate for blocks of size 2^( 5) =       0.000419484992
  error estimate for blocks of size 2^( 6) =       0.000421666878
  error estimate for blocks of size 2^( 7) =       0.000424233647

      target function =                  N/A
              le_mean =     -17.216292405580
             les_mean =     296.731190655534
             stat err =       0.000419975370
             autocorr =       1.157286380577
              std dev =       0.552100827851
             le_variance =       0.304815324114

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0421534
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304676449201
                                         uncertainty =       0.005893714578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304676449201
                                         uncertainty =       0.005893714578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390255168
  error estimate for blocks of size 2^( 2) =       0.000399968661
  error estimate for blocks of size 2^( 3) =       0.000408344434
  error estimate for blocks of size 2^( 4) =       0.000414437478
  error estimate for blocks of size 2^( 5) =       0.000419416209
  error estimate for blocks of size 2^( 6) =       0.000421603219
  error estimate for blocks of size 2^( 7) =       0.000424146732

      target function =                  N/A
              le_mean =     -17.216301937410
             les_mean =     296.745378513716
             stat err =       0.000419900910
             autocorr =       1.157700721530
              std dev =       0.551904151925
             le_variance =       0.304598192912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303812289195
                                         uncertainty =       0.006047997140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303812289195
                                         uncertainty =       0.006047997140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389702209
  error estimate for blocks of size 2^( 2) =       0.000399424947
  error estimate for blocks of size 2^( 3) =       0.000407803530
  error estimate for blocks of size 2^( 4) =       0.000413874071
  error estimate for blocks of size 2^( 5) =       0.000418867406
  error estimate for blocks of size 2^( 6) =       0.000421065676
  error estimate for blocks of size 2^( 7) =       0.000423607524

      target function =                  N/A
              le_mean =     -17.216299584167
             les_mean =     296.733379818347
             stat err =       0.000419353669
             autocorr =       1.157964271698
              std dev =       0.551122149219
             le_variance =       0.303735623359


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216311344456        initial  <--
     6.1035e-02     6.1035e-01             1.0230e-02       -17.216292405580
     2.4414e-01     2.4414e+00             3.2774e-03       -17.216301937410
     9.7656e-01     9.7656e+00             9.0191e-04       -17.216299584167

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7947
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.050859e-01 1 1  ON 0
  uu_1                 4.467998e-02 1 1  ON 1
  uu_2                -4.706130e-02 1 1  ON 2
  uu_3                -9.920621e-02 1 1  ON 3
  uu_4                -1.298889e-01 1 1  ON 4
  uu_5                -1.352295e-01 1 1  ON 5
  uu_6                -1.123391e-01 1 1  ON 6
  uu_7                -3.901389e-02 1 1  ON 7
  uu_8                 1.002575e-01 1 1  ON 8
  uu_9                 1.205169e-01 1 1  ON 9
  ud_0                 3.483791e-01 1 1  ON 10
  ud_1                 9.092295e-02 1 1  ON 11
  ud_2                -1.678266e-02 1 1  ON 12
  ud_3                -7.572380e-02 1 1  ON 13
  ud_4                -1.212118e-01 1 1  ON 14
  ud_5                -1.516624e-01 1 1  ON 15
  ud_6                -1.542833e-01 1 1  ON 16
  ud_7                -1.096279e-01 1 1  ON 17
  ud_8                 5.165051e-03 1 1  ON 18
  ud_9                 9.254699e-02 1 1  ON 19
  eO_0                -7.459182e-01 1 1  ON 20
  eO_1                -4.324704e-01 1 1  ON 21
  eO_2                -3.541090e-02 1 1  ON 22
  eO_3                 2.060584e-01 1 1  ON 23
  eO_4                 2.850320e-01 1 1  ON 24
  eO_5                 3.044498e-01 1 1  ON 25
  eO_6                 2.498929e-01 1 1  ON 26
  eO_7                 1.115562e-01 1 1  ON 27
  eO_8                 2.780747e-02 1 1  ON 28
  eO_9                 1.840260e-02 1 1  ON 29
 eH1_0                -1.818112e-01 1 1  ON 30
 eH1_1                -1.024685e-01 1 1  ON 31
 eH1_2                -6.223785e-02 1 1  ON 32
 eH1_3                -2.595359e-02 1 1  ON 33
 eH1_4                 1.941670e-02 1 1  ON 34
 eH1_5                 3.567074e-02 1 1  ON 35
 eH1_6                 7.707708e-02 1 1  ON 36
 eH1_7                 1.104449e-01 1 1  ON 37
 eH1_8                 9.044670e-02 1 1  ON 38
 eH1_9                 2.420040e-02 1 1  ON 39
 eH2_0                -1.831477e-01 1 1  ON 40
 eH2_1                -1.036222e-01 1 1  ON 41
 eH2_2                -6.361978e-02 1 1  ON 42
 eH2_3                -2.727212e-02 1 1  ON 43
 eH2_4                 1.839007e-02 1 1  ON 44
 eH2_5                 3.509180e-02 1 1  ON 45
 eH2_6                 7.834953e-02 1 1  ON 46
 eH2_7                 1.137133e-01 1 1  ON 47
 eH2_8                 9.365026e-02 1 1  ON 48
 eH2_9                 2.627105e-02 1 1  ON 49
ci_001                -4.090655e-02 3 1  ON 50
ci_002                -3.013719e-02 3 1  ON 51
ci_003                -2.527339e-02 3 1  ON 52
ci_004                 2.133634e-02 3 1  ON 53
ci_005                 2.154008e-02 3 1  ON 54
ci_006                -1.945373e-02 3 1  ON 55
ci_007                -1.912987e-02 3 1  ON 56
ci_008                -1.776972e-02 3 1  ON 57
ci_009                -1.825132e-02 3 1  ON 58
ci_010                -1.776338e-02 3 1  ON 59
ci_011                -1.604675e-02 3 1  ON 60
ci_012                -1.617002e-02 3 1  ON 61
ci_013                -1.942140e-02 3 1  ON 62
ci_014                 1.368417e-02 3 1  ON 63
ci_015                 1.375817e-02 3 1  ON 64
ci_016                 1.658956e-02 3 1  ON 65
ci_017                 1.661356e-02 3 1  ON 66
ci_018                 1.279473e-02 3 1  ON 67
ci_019                 1.321050e-02 3 1  ON 68
ci_020                 1.341793e-02 3 1  ON 69
ci_021                 1.357596e-02 3 1  ON 70
ci_022                 1.087308e-02 3 1  ON 71
ci_023                 1.096491e-02 3 1  ON 72
ci_024                 1.224548e-02 3 1  ON 73
ci_025                 1.177250e-02 3 1  ON 74
ci_026                 1.122807e-02 3 1  ON 75
ci_027                 1.145235e-02 3 1  ON 76
ci_028                -1.444496e-02 3 1  ON 77
ci_029                -1.475875e-02 3 1  ON 78
ci_030                -1.122994e-02 3 1  ON 79
ci_031                -1.160665e-02 3 1  ON 80
ci_032                -1.345906e-02 3 1  ON 81
ci_033                 1.085162e-02 3 1  ON 82
ci_034                 1.020183e-02 3 1  ON 83
ci_035                -4.884648e-03 3 1  ON 84
ci_036                -1.015884e-02 3 1  ON 85
ci_037                -9.992010e-03 3 1  ON 86
ci_038                 1.580448e-03 3 1  ON 87
ci_039                 1.656062e-03 3 1  ON 88
ci_040                -3.999391e-03 3 1  ON 89
ci_041                 9.774078e-03 3 1  ON 90
ci_042                 1.012056e-02 3 1  ON 91
ci_043                -3.132062e-03 3 1  ON 92
ci_044                -1.591018e-02 3 1  ON 93
ci_045                -1.713754e-03 3 1  ON 94
ci_046                 5.356022e-03 3 1  ON 95
ci_047                 5.862488e-03 3 1  ON 96
ci_048                -1.209553e-02 3 1  ON 97
ci_049                -1.203389e-02 3 1  ON 98
ci_050                 7.437486e-03 3 1  ON 99
ci_051                 7.412287e-03 3 1  ON 100
ci_052                -6.589927e-03 3 1  ON 101
ci_053                -6.721128e-03 3 1  ON 102
ci_054                -3.278109e-03 3 1  ON 103
ci_055                -3.161028e-03 3 1  ON 104
ci_056                 5.224555e-03 3 1  ON 105
ci_057                 4.551230e-03 3 1  ON 106
ci_058                -6.952153e-03 3 1  ON 107
ci_059                -6.418543e-03 3 1  ON 108
ci_060                 8.471476e-03 3 1  ON 109
ci_061                 8.390174e-03 3 1  ON 110
ci_062                -2.983183e-03 3 1  ON 111
ci_063                -3.146657e-03 3 1  ON 112
ci_064                -3.038521e-03 3 1  ON 113
ci_065                -4.265492e-03 3 1  ON 114
ci_066                 5.969662e-03 3 1  ON 115
ci_067                 5.550326e-03 3 1  ON 116
ci_068                -4.782344e-03 3 1  ON 117
ci_069                -4.757249e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7013e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.249
    reference variance = 0.203713
====================================================
  Execution time = 2.1033e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1250e-01
  Total weights = 1.956484038e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1603e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297575515330
                                         uncertainty =       0.001690428538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297575515330
                                         uncertainty =       0.001690428538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385716850
  error estimate for blocks of size 2^( 2) =       0.000395242861
  error estimate for blocks of size 2^( 3) =       0.000404364092
  error estimate for blocks of size 2^( 4) =       0.000411241856
  error estimate for blocks of size 2^( 5) =       0.000415572654
  error estimate for blocks of size 2^( 6) =       0.000417957186
  error estimate for blocks of size 2^( 7) =       0.000421399286

      target function =                  N/A
              le_mean =     -17.217087795534
             les_mean =     296.740615040101
             stat err =       0.000416542745
             autocorr =       1.166223874331
              std dev =       0.545486000264
             le_variance =       0.297554976484


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721708779553e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217087795582       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217090959941       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217090714123       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217091349934       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217095750978       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217093320865       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217094385612       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217094362182       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217094465238       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217094415796       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217094285563       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e-01 is 1.415717e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217087795582       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217088821974       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217088743577       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217088631316       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217090007830       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217089426105       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217089509319       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217089560246       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217089579492       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217089603332       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+00 is 3.717618e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217087795582       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217088072794       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217088051611       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217087994266       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217088352530       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217088209102       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217088227061       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217088239429       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217088245562       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217088253520       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+00 is 9.411741e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150377 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7214e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.050968e-01 1 1  ON 0
  uu_1                 4.475927e-02 1 1  ON 1
  uu_2                -4.702896e-02 1 1  ON 2
  uu_3                -9.923269e-02 1 1  ON 3
  uu_4                -1.299115e-01 1 1  ON 4
  uu_5                -1.352793e-01 1 1  ON 5
  uu_6                -1.123640e-01 1 1  ON 6
  uu_7                -3.904475e-02 1 1  ON 7
  uu_8                 1.002334e-01 1 1  ON 8
  uu_9                 1.205441e-01 1 1  ON 9
  ud_0                 3.484704e-01 1 1  ON 10
  ud_1                 9.098509e-02 1 1  ON 11
  ud_2                -1.676622e-02 1 1  ON 12
  ud_3                -7.574614e-02 1 1  ON 13
  ud_4                -1.212857e-01 1 1  ON 14
  ud_5                -1.516950e-01 1 1  ON 15
  ud_6                -1.542821e-01 1 1  ON 16
  ud_7                -1.096384e-01 1 1  ON 17
  ud_8                 5.114821e-03 1 1  ON 18
  ud_9                 9.254442e-02 1 1  ON 19
  eO_0                -7.462900e-01 1 1  ON 20
  eO_1                -4.327241e-01 1 1  ON 21
  eO_2                -3.541673e-02 1 1  ON 22
  eO_3                 2.062508e-01 1 1  ON 23
  eO_4                 2.853422e-01 1 1  ON 24
  eO_5                 3.044878e-01 1 1  ON 25
  eO_6                 2.499223e-01 1 1  ON 26
  eO_7                 1.116057e-01 1 1  ON 27
  eO_8                 2.781555e-02 1 1  ON 28
  eO_9                 1.840498e-02 1 1  ON 29
 eH1_0                -1.818654e-01 1 1  ON 30
 eH1_1                -1.024937e-01 1 1  ON 31
 eH1_2                -6.222052e-02 1 1  ON 32
 eH1_3                -2.595909e-02 1 1  ON 33
 eH1_4                 1.939847e-02 1 1  ON 34
 eH1_5                 3.566731e-02 1 1  ON 35
 eH1_6                 7.712683e-02 1 1  ON 36
 eH1_7                 1.104490e-01 1 1  ON 37
 eH1_8                 9.047171e-02 1 1  ON 38
 eH1_9                 2.420807e-02 1 1  ON 39
 eH2_0                -1.831803e-01 1 1  ON 40
 eH2_1                -1.036135e-01 1 1  ON 41
 eH2_2                -6.360651e-02 1 1  ON 42
 eH2_3                -2.729053e-02 1 1  ON 43
 eH2_4                 1.836559e-02 1 1  ON 44
 eH2_5                 3.511962e-02 1 1  ON 45
 eH2_6                 7.836114e-02 1 1  ON 46
 eH2_7                 1.136941e-01 1 1  ON 47
 eH2_8                 9.367433e-02 1 1  ON 48
 eH2_9                 2.627861e-02 1 1  ON 49
ci_001                -4.078493e-02 3 1  ON 50
ci_002                -3.005634e-02 3 1  ON 51
ci_003                -2.526519e-02 3 1  ON 52
ci_004                 2.123875e-02 3 1  ON 53
ci_005                 2.150393e-02 3 1  ON 54
ci_006                -1.938248e-02 3 1  ON 55
ci_007                -1.911850e-02 3 1  ON 56
ci_008                -1.774244e-02 3 1  ON 57
ci_009                -1.822562e-02 3 1  ON 58
ci_010                -1.768059e-02 3 1  ON 59
ci_011                -1.614328e-02 3 1  ON 60
ci_012                -1.622592e-02 3 1  ON 61
ci_013                -1.938688e-02 3 1  ON 62
ci_014                 1.377309e-02 3 1  ON 63
ci_015                 1.374136e-02 3 1  ON 64
ci_016                 1.655491e-02 3 1  ON 65
ci_017                 1.654782e-02 3 1  ON 66
ci_018                 1.282012e-02 3 1  ON 67
ci_019                 1.321491e-02 3 1  ON 68
ci_020                 1.345430e-02 3 1  ON 69
ci_021                 1.351847e-02 3 1  ON 70
ci_022                 1.093660e-02 3 1  ON 71
ci_023                 1.094043e-02 3 1  ON 72
ci_024                 1.217210e-02 3 1  ON 73
ci_025                 1.169899e-02 3 1  ON 74
ci_026                 1.115431e-02 3 1  ON 75
ci_027                 1.149516e-02 3 1  ON 76
ci_028                -1.448912e-02 3 1  ON 77
ci_029                -1.476776e-02 3 1  ON 78
ci_030                -1.121904e-02 3 1  ON 79
ci_031                -1.156725e-02 3 1  ON 80
ci_032                -1.348212e-02 3 1  ON 81
ci_033                 1.085050e-02 3 1  ON 82
ci_034                 1.022588e-02 3 1  ON 83
ci_035                -4.816891e-03 3 1  ON 84
ci_036                -1.022110e-02 3 1  ON 85
ci_037                -9.998878e-03 3 1  ON 86
ci_038                 1.584170e-03 3 1  ON 87
ci_039                 1.598444e-03 3 1  ON 88
ci_040                -4.064435e-03 3 1  ON 89
ci_041                 9.799682e-03 3 1  ON 90
ci_042                 1.012956e-02 3 1  ON 91
ci_043                -3.116097e-03 3 1  ON 92
ci_044                -1.584531e-02 3 1  ON 93
ci_045                -1.727719e-03 3 1  ON 94
ci_046                 5.401492e-03 3 1  ON 95
ci_047                 5.811980e-03 3 1  ON 96
ci_048                -1.205344e-02 3 1  ON 97
ci_049                -1.199690e-02 3 1  ON 98
ci_050                 7.426723e-03 3 1  ON 99
ci_051                 7.497833e-03 3 1  ON 100
ci_052                -6.613070e-03 3 1  ON 101
ci_053                -6.673882e-03 3 1  ON 102
ci_054                -3.284574e-03 3 1  ON 103
ci_055                -3.175794e-03 3 1  ON 104
ci_056                 5.191046e-03 3 1  ON 105
ci_057                 4.487794e-03 3 1  ON 106
ci_058                -6.901845e-03 3 1  ON 107
ci_059                -6.423201e-03 3 1  ON 108
ci_060                 8.425523e-03 3 1  ON 109
ci_061                 8.419087e-03 3 1  ON 110
ci_062                -2.997550e-03 3 1  ON 111
ci_063                -3.155840e-03 3 1  ON 112
ci_064                -2.988695e-03 3 1  ON 113
ci_065                -4.180579e-03 3 1  ON 114
ci_066                 5.906479e-03 3 1  ON 115
ci_067                 5.681659e-03 3 1  ON 116
ci_068                -4.834121e-03 3 1  ON 117
ci_069                -4.717031e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2562
    reference variance = 0.24218
====================================================
  Execution time = 2.2491e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1266e-01
  Total weights = 1.9566e+06
  Execution time = 1.8334e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299911673820
                                         uncertainty =       0.002288481599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299911673820
                                         uncertainty =       0.002288481599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387285629
  error estimate for blocks of size 2^( 2) =       0.000397396072
  error estimate for blocks of size 2^( 3) =       0.000406388746
  error estimate for blocks of size 2^( 4) =       0.000412639245
  error estimate for blocks of size 2^( 5) =       0.000416999655
  error estimate for blocks of size 2^( 6) =       0.000417459339
  error estimate for blocks of size 2^( 7) =       0.000419739378

      target function =                  N/A
              le_mean =     -17.216239341576
             les_mean =     296.711721715093
             stat err =       0.000416709404
             autocorr =       1.157720813040
              std dev =       0.547704588428
             le_variance =       0.299980316185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300072929849
                                         uncertainty =       0.002287760532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300072929849
                                         uncertainty =       0.002287760532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387388947
  error estimate for blocks of size 2^( 2) =       0.000397503413
  error estimate for blocks of size 2^( 3) =       0.000406496787
  error estimate for blocks of size 2^( 4) =       0.000412749938
  error estimate for blocks of size 2^( 5) =       0.000417118539
  error estimate for blocks of size 2^( 6) =       0.000417574294
  error estimate for blocks of size 2^( 7) =       0.000419855276

      target function =                  N/A
              le_mean =     -17.216244590478
             les_mean =     296.744118320302
             stat err =       0.000416824512
             autocorr =       1.157742695853
              std dev =       0.547850702769
             le_variance =       0.300140392525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299979876974
                                         uncertainty =       0.002288618738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299979876974
                                         uncertainty =       0.002288618738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387329224
  error estimate for blocks of size 2^( 2) =       0.000397444094
  error estimate for blocks of size 2^( 3) =       0.000406434299
  error estimate for blocks of size 2^( 4) =       0.000412686391
  error estimate for blocks of size 2^( 5) =       0.000417052046
  error estimate for blocks of size 2^( 6) =       0.000417510626
  error estimate for blocks of size 2^( 7) =       0.000419788219

      target function =                  N/A
              le_mean =     -17.216244402527
             les_mean =     296.713108648071
             stat err =       0.000416759320
             autocorr =       1.157737530465
              std dev =       0.547766240988
             le_variance =       0.300047854766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299918140527
                                         uncertainty =       0.002288500708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299918140527
                                         uncertainty =       0.002288500708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387289748
  error estimate for blocks of size 2^( 2) =       0.000397400779
  error estimate for blocks of size 2^( 3) =       0.000406393199
  error estimate for blocks of size 2^( 4) =       0.000412643908
  error estimate for blocks of size 2^( 5) =       0.000417005039
  error estimate for blocks of size 2^( 6) =       0.000417464500
  error estimate for blocks of size 2^( 7) =       0.000419744116

      target function =                  N/A
              le_mean =     -17.216239771265
             les_mean =     296.711603187735
             stat err =       0.000416714391
             autocorr =       1.157723889028
              std dev =       0.547710414302
             le_variance =       0.299986697934


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216239341576        initial
     6.1035e-01     6.1035e+00             1.4157e-03       -17.216244590478  <--
     2.4414e+00     2.4414e+01             3.7176e-04       -17.216244402527
     9.7656e+00     9.7656e+01             9.4117e-05       -17.216239771265

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 3.1809e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.052001e-01 1 1  ON 0
  uu_1                 4.495699e-02 1 1  ON 1
  uu_2                -4.694793e-02 1 1  ON 2
  uu_3                -9.928587e-02 1 1  ON 3
  uu_4                -1.300121e-01 1 1  ON 4
  uu_5                -1.354255e-01 1 1  ON 5
  uu_6                -1.124458e-01 1 1  ON 6
  uu_7                -3.914015e-02 1 1  ON 7
  uu_8                 1.001604e-01 1 1  ON 8
  uu_9                 1.206251e-01 1 1  ON 9
  ud_0                 3.487279e-01 1 1  ON 10
  ud_1                 9.116025e-02 1 1  ON 11
  ud_2                -1.671228e-02 1 1  ON 12
  ud_3                -7.580712e-02 1 1  ON 13
  ud_4                -1.214627e-01 1 1  ON 14
  ud_5                -1.518131e-01 1 1  ON 15
  ud_6                -1.542869e-01 1 1  ON 16
  ud_7                -1.096698e-01 1 1  ON 17
  ud_8                 4.964914e-03 1 1  ON 18
  ud_9                 9.253663e-02 1 1  ON 19
  eO_0                -7.473339e-01 1 1  ON 20
  eO_1                -4.334410e-01 1 1  ON 21
  eO_2                -3.548618e-02 1 1  ON 22
  eO_3                 2.067756e-01 1 1  ON 23
  eO_4                 2.862499e-01 1 1  ON 24
  eO_5                 3.046133e-01 1 1  ON 25
  eO_6                 2.500116e-01 1 1  ON 26
  eO_7                 1.117531e-01 1 1  ON 27
  eO_8                 2.783965e-02 1 1  ON 28
  eO_9                 1.841209e-02 1 1  ON 29
 eH1_0                -1.820126e-01 1 1  ON 30
 eH1_1                -1.025598e-01 1 1  ON 31
 eH1_2                -6.218927e-02 1 1  ON 32
 eH1_3                -2.596968e-02 1 1  ON 33
 eH1_4                 1.934480e-02 1 1  ON 34
 eH1_5                 3.564728e-02 1 1  ON 35
 eH1_6                 7.727422e-02 1 1  ON 36
 eH1_7                 1.104621e-01 1 1  ON 37
 eH1_8                 9.054641e-02 1 1  ON 38
 eH1_9                 2.423095e-02 1 1  ON 39
 eH2_0                -1.832638e-01 1 1  ON 40
 eH2_1                -1.036001e-01 1 1  ON 41
 eH2_2                -6.357884e-02 1 1  ON 42
 eH2_3                -2.733035e-02 1 1  ON 43
 eH2_4                 1.829856e-02 1 1  ON 44
 eH2_5                 3.518850e-02 1 1  ON 45
 eH2_6                 7.839788e-02 1 1  ON 46
 eH2_7                 1.136384e-01 1 1  ON 47
 eH2_8                 9.374624e-02 1 1  ON 48
 eH2_9                 2.630117e-02 1 1  ON 49
ci_001                -4.051022e-02 3 1  ON 50
ci_002                -2.987805e-02 3 1  ON 51
ci_003                -2.525701e-02 3 1  ON 52
ci_004                 2.101086e-02 3 1  ON 53
ci_005                 2.142218e-02 3 1  ON 54
ci_006                -1.922480e-02 3 1  ON 55
ci_007                -1.910010e-02 3 1  ON 56
ci_008                -1.768609e-02 3 1  ON 57
ci_009                -1.817673e-02 3 1  ON 58
ci_010                -1.748989e-02 3 1  ON 59
ci_011                -1.635059e-02 3 1  ON 60
ci_012                -1.634329e-02 3 1  ON 61
ci_013                -1.930091e-02 3 1  ON 62
ci_014                 1.396687e-02 3 1  ON 63
ci_015                 1.370249e-02 3 1  ON 64
ci_016                 1.648114e-02 3 1  ON 65
ci_017                 1.640421e-02 3 1  ON 66
ci_018                 1.287604e-02 3 1  ON 67
ci_019                 1.322443e-02 3 1  ON 68
ci_020                 1.353897e-02 3 1  ON 69
ci_021                 1.338811e-02 3 1  ON 70
ci_022                 1.106964e-02 3 1  ON 71
ci_023                 1.088668e-02 3 1  ON 72
ci_024                 1.199665e-02 3 1  ON 73
ci_025                 1.152298e-02 3 1  ON 74
ci_026                 1.099451e-02 3 1  ON 75
ci_027                 1.159136e-02 3 1  ON 76
ci_028                -1.459182e-02 3 1  ON 77
ci_029                -1.479038e-02 3 1  ON 78
ci_030                -1.119536e-02 3 1  ON 79
ci_031                -1.148343e-02 3 1  ON 80
ci_032                -1.353427e-02 3 1  ON 81
ci_033                 1.084166e-02 3 1  ON 82
ci_034                 1.027170e-02 3 1  ON 83
ci_035                -4.691552e-03 3 1  ON 84
ci_036                -1.036033e-02 3 1  ON 85
ci_037                -1.001364e-02 3 1  ON 86
ci_038                 1.581597e-03 3 1  ON 87
ci_039                 1.486421e-03 3 1  ON 88
ci_040                -4.178272e-03 3 1  ON 89
ci_041                 9.854340e-03 3 1  ON 90
ci_042                 1.014986e-02 3 1  ON 91
ci_043                -3.084809e-03 3 1  ON 92
ci_044                -1.569569e-02 3 1  ON 93
ci_045                -1.750775e-03 3 1  ON 94
ci_046                 5.495528e-03 3 1  ON 95
ci_047                 5.703043e-03 3 1  ON 96
ci_048                -1.195210e-02 3 1  ON 97
ci_049                -1.191216e-02 3 1  ON 98
ci_050                 7.405313e-03 3 1  ON 99
ci_051                 7.663131e-03 3 1  ON 100
ci_052                -6.659259e-03 3 1  ON 101
ci_053                -6.578249e-03 3 1  ON 102
ci_054                -3.291027e-03 3 1  ON 103
ci_055                -3.199615e-03 3 1  ON 104
ci_056                 5.125038e-03 3 1  ON 105
ci_057                 4.363726e-03 3 1  ON 106
ci_058                -6.799474e-03 3 1  ON 107
ci_059                -6.432806e-03 3 1  ON 108
ci_060                 8.323900e-03 3 1  ON 109
ci_061                 8.479723e-03 3 1  ON 110
ci_062                -3.024554e-03 3 1  ON 111
ci_063                -3.171801e-03 3 1  ON 112
ci_064                -2.906046e-03 3 1  ON 113
ci_065                -4.037992e-03 3 1  ON 114
ci_066                 5.783974e-03 3 1  ON 115
ci_067                 5.931442e-03 3 1  ON 116
ci_068                -4.943976e-03 3 1  ON 117
ci_069                -4.625987e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9040e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2613
    reference variance = 0.422593
====================================================
  Execution time = 2.0728e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0833e-01
  Total weights = 1.956575383e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295114542230
                                         uncertainty =       0.002328275161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295114542230
                                         uncertainty =       0.002328275161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384103661
  error estimate for blocks of size 2^( 2) =       0.000394185591
  error estimate for blocks of size 2^( 3) =       0.000402808632
  error estimate for blocks of size 2^( 4) =       0.000409047191
  error estimate for blocks of size 2^( 5) =       0.000413136517
  error estimate for blocks of size 2^( 6) =       0.000415565972
  error estimate for blocks of size 2^( 7) =       0.000416067470

      target function =                  N/A
              le_mean =     -17.215538002790
             les_mean =     296.683079428300
             stat err =       0.000413454288
             autocorr =       1.158665581969
              std dev =       0.543204607077
             le_variance =       0.295071245150


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721553800279e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215538002786       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215548297684       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215545911458       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215548146547       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215545762981       residual = 9.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215551896312       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215552339631       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215556913284       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215556624345       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215556715378       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215556282343       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215556371758       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215555888793       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215555991719       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215555996898       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e-01 is 4.284761e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215538002786       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215542997539       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215541995776       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215542581832       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215540663532       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215542555751       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215543342671       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215544144512       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215544013975       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215544039545       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215544082951       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e-01 is 1.156497e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215538002786       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215539635415       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215539321957       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215539440301       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215538746606       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215539212063       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215539473991       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215539645038       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215539613948       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215539629726       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+00 is 2.841912e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155912 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6812e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.057523e-01 1 1  ON 0
  uu_1                 4.522274e-02 1 1  ON 1
  uu_2                -4.693878e-02 1 1  ON 2
  uu_3                -9.942344e-02 1 1  ON 3
  uu_4                -1.303428e-01 1 1  ON 4
  uu_5                -1.355356e-01 1 1  ON 5
  uu_6                -1.125297e-01 1 1  ON 6
  uu_7                -3.936380e-02 1 1  ON 7
  uu_8                 1.000389e-01 1 1  ON 8
  uu_9                 1.206943e-01 1 1  ON 9
  ud_0                 3.489806e-01 1 1  ON 10
  ud_1                 9.130689e-02 1 1  ON 11
  ud_2                -1.660982e-02 1 1  ON 12
  ud_3                -7.577784e-02 1 1  ON 13
  ud_4                -1.216193e-01 1 1  ON 14
  ud_5                -1.519840e-01 1 1  ON 15
  ud_6                -1.543103e-01 1 1  ON 16
  ud_7                -1.097296e-01 1 1  ON 17
  ud_8                 4.750735e-03 1 1  ON 18
  ud_9                 9.252659e-02 1 1  ON 19
  eO_0                -7.484904e-01 1 1  ON 20
  eO_1                -4.344274e-01 1 1  ON 21
  eO_2                -3.575486e-02 1 1  ON 22
  eO_3                 2.074862e-01 1 1  ON 23
  eO_4                 2.873392e-01 1 1  ON 24
  eO_5                 3.048552e-01 1 1  ON 25
  eO_6                 2.501525e-01 1 1  ON 26
  eO_7                 1.119402e-01 1 1  ON 27
  eO_8                 2.785898e-02 1 1  ON 28
  eO_9                 1.841888e-02 1 1  ON 29
 eH1_0                -1.820217e-01 1 1  ON 30
 eH1_1                -1.026627e-01 1 1  ON 31
 eH1_2                -6.223030e-02 1 1  ON 32
 eH1_3                -2.602208e-02 1 1  ON 33
 eH1_4                 1.931678e-02 1 1  ON 34
 eH1_5                 3.576169e-02 1 1  ON 35
 eH1_6                 7.729733e-02 1 1  ON 36
 eH1_7                 1.104400e-01 1 1  ON 37
 eH1_8                 9.063329e-02 1 1  ON 38
 eH1_9                 2.424824e-02 1 1  ON 39
 eH2_0                -1.833133e-01 1 1  ON 40
 eH2_1                -1.036648e-01 1 1  ON 41
 eH2_2                -6.352422e-02 1 1  ON 42
 eH2_3                -2.729060e-02 1 1  ON 43
 eH2_4                 1.832134e-02 1 1  ON 44
 eH2_5                 3.505686e-02 1 1  ON 45
 eH2_6                 7.841479e-02 1 1  ON 46
 eH2_7                 1.136022e-01 1 1  ON 47
 eH2_8                 9.384719e-02 1 1  ON 48
 eH2_9                 2.633566e-02 1 1  ON 49
ci_001                -4.030772e-02 3 1  ON 50
ci_002                -3.010471e-02 3 1  ON 51
ci_003                -2.539689e-02 3 1  ON 52
ci_004                 2.116807e-02 3 1  ON 53
ci_005                 2.123472e-02 3 1  ON 54
ci_006                -1.928374e-02 3 1  ON 55
ci_007                -1.902957e-02 3 1  ON 56
ci_008                -1.771627e-02 3 1  ON 57
ci_009                -1.804179e-02 3 1  ON 58
ci_010                -1.742995e-02 3 1  ON 59
ci_011                -1.648940e-02 3 1  ON 60
ci_012                -1.626545e-02 3 1  ON 61
ci_013                -1.935772e-02 3 1  ON 62
ci_014                 1.387061e-02 3 1  ON 63
ci_015                 1.383016e-02 3 1  ON 64
ci_016                 1.650476e-02 3 1  ON 65
ci_017                 1.640256e-02 3 1  ON 66
ci_018                 1.292731e-02 3 1  ON 67
ci_019                 1.316819e-02 3 1  ON 68
ci_020                 1.356536e-02 3 1  ON 69
ci_021                 1.342354e-02 3 1  ON 70
ci_022                 1.153542e-02 3 1  ON 71
ci_023                 1.086067e-02 3 1  ON 72
ci_024                 1.197621e-02 3 1  ON 73
ci_025                 1.159905e-02 3 1  ON 74
ci_026                 1.100030e-02 3 1  ON 75
ci_027                 1.118955e-02 3 1  ON 76
ci_028                -1.434435e-02 3 1  ON 77
ci_029                -1.457553e-02 3 1  ON 78
ci_030                -1.114357e-02 3 1  ON 79
ci_031                -1.138314e-02 3 1  ON 80
ci_032                -1.379946e-02 3 1  ON 81
ci_033                 1.059983e-02 3 1  ON 82
ci_034                 1.044488e-02 3 1  ON 83
ci_035                -4.828981e-03 3 1  ON 84
ci_036                -1.038075e-02 3 1  ON 85
ci_037                -1.012020e-02 3 1  ON 86
ci_038                 1.489619e-03 3 1  ON 87
ci_039                 1.474172e-03 3 1  ON 88
ci_040                -4.286831e-03 3 1  ON 89
ci_041                 9.686172e-03 3 1  ON 90
ci_042                 1.008086e-02 3 1  ON 91
ci_043                -3.197221e-03 3 1  ON 92
ci_044                -1.566111e-02 3 1  ON 93
ci_045                -1.705596e-03 3 1  ON 94
ci_046                 5.541093e-03 3 1  ON 95
ci_047                 5.752922e-03 3 1  ON 96
ci_048                -1.179623e-02 3 1  ON 97
ci_049                -1.190348e-02 3 1  ON 98
ci_050                 7.275441e-03 3 1  ON 99
ci_051                 7.533867e-03 3 1  ON 100
ci_052                -6.612219e-03 3 1  ON 101
ci_053                -6.697232e-03 3 1  ON 102
ci_054                -3.272813e-03 3 1  ON 103
ci_055                -3.147208e-03 3 1  ON 104
ci_056                 4.815752e-03 3 1  ON 105
ci_057                 4.737683e-03 3 1  ON 106
ci_058                -6.789627e-03 3 1  ON 107
ci_059                -6.529483e-03 3 1  ON 108
ci_060                 8.336196e-03 3 1  ON 109
ci_061                 8.559708e-03 3 1  ON 110
ci_062                -3.203437e-03 3 1  ON 111
ci_063                -3.121940e-03 3 1  ON 112
ci_064                -3.059451e-03 3 1  ON 113
ci_065                -4.022267e-03 3 1  ON 114
ci_066                 5.837121e-03 3 1  ON 115
ci_067                 5.437707e-03 3 1  ON 116
ci_068                -5.117779e-03 3 1  ON 117
ci_069                -4.581859e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2917
    reference variance = 0.468394
====================================================
  Execution time = 2.0735e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1957e-01
  Total weights = 1.9564e+06
  Execution time = 1.8296e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299616746572
                                         uncertainty =       0.001897620377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299616746572
                                         uncertainty =       0.001897620377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387130560
  error estimate for blocks of size 2^( 2) =       0.000396738558
  error estimate for blocks of size 2^( 3) =       0.000405658015
  error estimate for blocks of size 2^( 4) =       0.000412409969
  error estimate for blocks of size 2^( 5) =       0.000416929061
  error estimate for blocks of size 2^( 6) =       0.000418936189
  error estimate for blocks of size 2^( 7) =       0.000420879068

      target function =                  N/A
              le_mean =     -17.216506708256
             les_mean =     296.729943274435
             stat err =       0.000417288572
             autocorr =       1.161871422047
              std dev =       0.547485288894
             le_variance =       0.299740141555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300104014653
                                         uncertainty =       0.001812894750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300104014653
                                         uncertainty =       0.001812894750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387445861
  error estimate for blocks of size 2^( 2) =       0.000397017286
  error estimate for blocks of size 2^( 3) =       0.000405911881
  error estimate for blocks of size 2^( 4) =       0.000412643524
  error estimate for blocks of size 2^( 5) =       0.000417140456
  error estimate for blocks of size 2^( 6) =       0.000419105610
  error estimate for blocks of size 2^( 7) =       0.000421049922

      target function =                  N/A
              le_mean =     -17.216498253232
             les_mean =     296.733543990410
             stat err =       0.000417484878
             autocorr =       1.161072788346
              std dev =       0.547931191554
             le_variance =       0.300228590678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299932109149
                                         uncertainty =       0.001815487065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299932109149
                                         uncertainty =       0.001815487065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387334843
  error estimate for blocks of size 2^( 2) =       0.000396914304
  error estimate for blocks of size 2^( 3) =       0.000405820908
  error estimate for blocks of size 2^( 4) =       0.000412560067
  error estimate for blocks of size 2^( 5) =       0.000417062066
  error estimate for blocks of size 2^( 6) =       0.000419028819
  error estimate for blocks of size 2^( 7) =       0.000420973258

      target function =                  N/A
              le_mean =     -17.216499031604
             les_mean =     296.729284444555
             stat err =       0.000417406052
             autocorr =       1.161299802409
              std dev =       0.547774188068
             le_variance =       0.300056561113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299631789065
                                         uncertainty =       0.001878855937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299631789065
                                         uncertainty =       0.001878855937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387141418
  error estimate for blocks of size 2^( 2) =       0.000396744803
  error estimate for blocks of size 2^( 3) =       0.000405663132
  error estimate for blocks of size 2^( 4) =       0.000412413278
  error estimate for blocks of size 2^( 5) =       0.000416932038
  error estimate for blocks of size 2^( 6) =       0.000418929699
  error estimate for blocks of size 2^( 7) =       0.000420872728

      target function =                  N/A
              le_mean =     -17.216502153147
             les_mean =     296.736550155239
             stat err =       0.000417286936
             autocorr =       1.161797144258
              std dev =       0.547500643234
             le_variance =       0.299756954341


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216506708256        initial  <--
     1.5259e-01     1.5259e+00             4.2848e-03       -17.216498253232
     6.1035e-01     6.1035e+00             1.1565e-03       -17.216499031604
     2.4414e+00     2.4414e+01             2.8419e-04       -17.216502153147

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0816
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.052001e-01 1 1  ON 0
  uu_1                 4.495699e-02 1 1  ON 1
  uu_2                -4.694793e-02 1 1  ON 2
  uu_3                -9.928587e-02 1 1  ON 3
  uu_4                -1.300121e-01 1 1  ON 4
  uu_5                -1.354255e-01 1 1  ON 5
  uu_6                -1.124458e-01 1 1  ON 6
  uu_7                -3.914015e-02 1 1  ON 7
  uu_8                 1.001604e-01 1 1  ON 8
  uu_9                 1.206251e-01 1 1  ON 9
  ud_0                 3.487279e-01 1 1  ON 10
  ud_1                 9.116025e-02 1 1  ON 11
  ud_2                -1.671228e-02 1 1  ON 12
  ud_3                -7.580712e-02 1 1  ON 13
  ud_4                -1.214627e-01 1 1  ON 14
  ud_5                -1.518131e-01 1 1  ON 15
  ud_6                -1.542869e-01 1 1  ON 16
  ud_7                -1.096698e-01 1 1  ON 17
  ud_8                 4.964914e-03 1 1  ON 18
  ud_9                 9.253663e-02 1 1  ON 19
  eO_0                -7.473339e-01 1 1  ON 20
  eO_1                -4.334410e-01 1 1  ON 21
  eO_2                -3.548618e-02 1 1  ON 22
  eO_3                 2.067756e-01 1 1  ON 23
  eO_4                 2.862499e-01 1 1  ON 24
  eO_5                 3.046133e-01 1 1  ON 25
  eO_6                 2.500116e-01 1 1  ON 26
  eO_7                 1.117531e-01 1 1  ON 27
  eO_8                 2.783965e-02 1 1  ON 28
  eO_9                 1.841209e-02 1 1  ON 29
 eH1_0                -1.820126e-01 1 1  ON 30
 eH1_1                -1.025598e-01 1 1  ON 31
 eH1_2                -6.218927e-02 1 1  ON 32
 eH1_3                -2.596968e-02 1 1  ON 33
 eH1_4                 1.934480e-02 1 1  ON 34
 eH1_5                 3.564728e-02 1 1  ON 35
 eH1_6                 7.727422e-02 1 1  ON 36
 eH1_7                 1.104621e-01 1 1  ON 37
 eH1_8                 9.054641e-02 1 1  ON 38
 eH1_9                 2.423095e-02 1 1  ON 39
 eH2_0                -1.832638e-01 1 1  ON 40
 eH2_1                -1.036001e-01 1 1  ON 41
 eH2_2                -6.357884e-02 1 1  ON 42
 eH2_3                -2.733035e-02 1 1  ON 43
 eH2_4                 1.829856e-02 1 1  ON 44
 eH2_5                 3.518850e-02 1 1  ON 45
 eH2_6                 7.839788e-02 1 1  ON 46
 eH2_7                 1.136384e-01 1 1  ON 47
 eH2_8                 9.374624e-02 1 1  ON 48
 eH2_9                 2.630117e-02 1 1  ON 49
ci_001                -4.051022e-02 3 1  ON 50
ci_002                -2.987805e-02 3 1  ON 51
ci_003                -2.525701e-02 3 1  ON 52
ci_004                 2.101086e-02 3 1  ON 53
ci_005                 2.142218e-02 3 1  ON 54
ci_006                -1.922480e-02 3 1  ON 55
ci_007                -1.910010e-02 3 1  ON 56
ci_008                -1.768609e-02 3 1  ON 57
ci_009                -1.817673e-02 3 1  ON 58
ci_010                -1.748989e-02 3 1  ON 59
ci_011                -1.635059e-02 3 1  ON 60
ci_012                -1.634329e-02 3 1  ON 61
ci_013                -1.930091e-02 3 1  ON 62
ci_014                 1.396687e-02 3 1  ON 63
ci_015                 1.370249e-02 3 1  ON 64
ci_016                 1.648114e-02 3 1  ON 65
ci_017                 1.640421e-02 3 1  ON 66
ci_018                 1.287604e-02 3 1  ON 67
ci_019                 1.322443e-02 3 1  ON 68
ci_020                 1.353897e-02 3 1  ON 69
ci_021                 1.338811e-02 3 1  ON 70
ci_022                 1.106964e-02 3 1  ON 71
ci_023                 1.088668e-02 3 1  ON 72
ci_024                 1.199665e-02 3 1  ON 73
ci_025                 1.152298e-02 3 1  ON 74
ci_026                 1.099451e-02 3 1  ON 75
ci_027                 1.159136e-02 3 1  ON 76
ci_028                -1.459182e-02 3 1  ON 77
ci_029                -1.479038e-02 3 1  ON 78
ci_030                -1.119536e-02 3 1  ON 79
ci_031                -1.148343e-02 3 1  ON 80
ci_032                -1.353427e-02 3 1  ON 81
ci_033                 1.084166e-02 3 1  ON 82
ci_034                 1.027170e-02 3 1  ON 83
ci_035                -4.691552e-03 3 1  ON 84
ci_036                -1.036033e-02 3 1  ON 85
ci_037                -1.001364e-02 3 1  ON 86
ci_038                 1.581597e-03 3 1  ON 87
ci_039                 1.486421e-03 3 1  ON 88
ci_040                -4.178272e-03 3 1  ON 89
ci_041                 9.854340e-03 3 1  ON 90
ci_042                 1.014986e-02 3 1  ON 91
ci_043                -3.084809e-03 3 1  ON 92
ci_044                -1.569569e-02 3 1  ON 93
ci_045                -1.750775e-03 3 1  ON 94
ci_046                 5.495528e-03 3 1  ON 95
ci_047                 5.703043e-03 3 1  ON 96
ci_048                -1.195210e-02 3 1  ON 97
ci_049                -1.191216e-02 3 1  ON 98
ci_050                 7.405313e-03 3 1  ON 99
ci_051                 7.663131e-03 3 1  ON 100
ci_052                -6.659259e-03 3 1  ON 101
ci_053                -6.578249e-03 3 1  ON 102
ci_054                -3.291027e-03 3 1  ON 103
ci_055                -3.199615e-03 3 1  ON 104
ci_056                 5.125038e-03 3 1  ON 105
ci_057                 4.363726e-03 3 1  ON 106
ci_058                -6.799474e-03 3 1  ON 107
ci_059                -6.432806e-03 3 1  ON 108
ci_060                 8.323900e-03 3 1  ON 109
ci_061                 8.479723e-03 3 1  ON 110
ci_062                -3.024554e-03 3 1  ON 111
ci_063                -3.171801e-03 3 1  ON 112
ci_064                -2.906046e-03 3 1  ON 113
ci_065                -4.037992e-03 3 1  ON 114
ci_066                 5.783974e-03 3 1  ON 115
ci_067                 5.931442e-03 3 1  ON 116
ci_068                -4.943976e-03 3 1  ON 117
ci_069                -4.625987e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6900e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1806
    reference variance = 0.182944
====================================================
  Execution time = 2.0785e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1713e-01
  Total weights = 1.956600029e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0210e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299925029718
                                         uncertainty =       0.001711211145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299925029718
                                         uncertainty =       0.001711211145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387263416
  error estimate for blocks of size 2^( 2) =       0.000397580756
  error estimate for blocks of size 2^( 3) =       0.000406726928
  error estimate for blocks of size 2^( 4) =       0.000413218633
  error estimate for blocks of size 2^( 5) =       0.000417584302
  error estimate for blocks of size 2^( 6) =       0.000420453999
  error estimate for blocks of size 2^( 7) =       0.000422287211

      target function =                  N/A
              le_mean =     -17.215227337814
             les_mean =     296.681181377100
             stat err =       0.000418386036
             autocorr =       1.167189624090
              std dev =       0.547673175387
             le_variance =       0.299945907039


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721522733781e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215227337842       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215226322217       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215226592478       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215226846317       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215226485954       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215226304394       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215226724214       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215226828959       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215226870886       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215226918395       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+00 is 4.837236e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215227337842       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215227055002       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215227124802       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215227188896       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215227086400       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215227011195       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215227093494       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215227134049       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215227153649       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215227161088       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+00 is 1.197278e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215227337842       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215227265058       residual = 7.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215227282634       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215227298542       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215227271782       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215227250616       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215227269639       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215227279980       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215227286075       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215227287531       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+01 is 2.979847e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159820 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6818e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.052506e-01 1 1  ON 0
  uu_1                 4.498835e-02 1 1  ON 1
  uu_2                -4.694975e-02 1 1  ON 2
  uu_3                -9.929328e-02 1 1  ON 3
  uu_4                -1.300472e-01 1 1  ON 4
  uu_5                -1.354400e-01 1 1  ON 5
  uu_6                -1.124551e-01 1 1  ON 6
  uu_7                -3.915984e-02 1 1  ON 7
  uu_8                 1.001486e-01 1 1  ON 8
  uu_9                 1.206342e-01 1 1  ON 9
  ud_0                 3.487921e-01 1 1  ON 10
  ud_1                 9.117301e-02 1 1  ON 11
  ud_2                -1.671553e-02 1 1  ON 12
  ud_3                -7.581760e-02 1 1  ON 13
  ud_4                -1.214743e-01 1 1  ON 14
  ud_5                -1.518356e-01 1 1  ON 15
  ud_6                -1.542936e-01 1 1  ON 16
  ud_7                -1.096721e-01 1 1  ON 17
  ud_8                 4.945407e-03 1 1  ON 18
  ud_9                 9.253211e-02 1 1  ON 19
  eO_0                -7.474537e-01 1 1  ON 20
  eO_1                -4.335500e-01 1 1  ON 21
  eO_2                -3.551125e-02 1 1  ON 22
  eO_3                 2.068542e-01 1 1  ON 23
  eO_4                 2.863669e-01 1 1  ON 24
  eO_5                 3.046372e-01 1 1  ON 25
  eO_6                 2.500239e-01 1 1  ON 26
  eO_7                 1.117720e-01 1 1  ON 27
  eO_8                 2.784246e-02 1 1  ON 28
  eO_9                 1.841227e-02 1 1  ON 29
 eH1_0                -1.820123e-01 1 1  ON 30
 eH1_1                -1.025797e-01 1 1  ON 31
 eH1_2                -6.218452e-02 1 1  ON 32
 eH1_3                -2.596949e-02 1 1  ON 33
 eH1_4                 1.935543e-02 1 1  ON 34
 eH1_5                 3.564561e-02 1 1  ON 35
 eH1_6                 7.727475e-02 1 1  ON 36
 eH1_7                 1.104561e-01 1 1  ON 37
 eH1_8                 9.055568e-02 1 1  ON 38
 eH1_9                 2.423279e-02 1 1  ON 39
 eH2_0                -1.832786e-01 1 1  ON 40
 eH2_1                -1.036285e-01 1 1  ON 41
 eH2_2                -6.356825e-02 1 1  ON 42
 eH2_3                -2.732009e-02 1 1  ON 43
 eH2_4                 1.829705e-02 1 1  ON 44
 eH2_5                 3.518946e-02 1 1  ON 45
 eH2_6                 7.840698e-02 1 1  ON 46
 eH2_7                 1.136364e-01 1 1  ON 47
 eH2_8                 9.375834e-02 1 1  ON 48
 eH2_9                 2.630439e-02 1 1  ON 49
ci_001                -4.049185e-02 3 1  ON 50
ci_002                -2.987308e-02 3 1  ON 51
ci_003                -2.525462e-02 3 1  ON 52
ci_004                 2.102569e-02 3 1  ON 53
ci_005                 2.141091e-02 3 1  ON 54
ci_006                -1.922735e-02 3 1  ON 55
ci_007                -1.913707e-02 3 1  ON 56
ci_008                -1.767114e-02 3 1  ON 57
ci_009                -1.814298e-02 3 1  ON 58
ci_010                -1.748259e-02 3 1  ON 59
ci_011                -1.636603e-02 3 1  ON 60
ci_012                -1.634516e-02 3 1  ON 61
ci_013                -1.930331e-02 3 1  ON 62
ci_014                 1.396023e-02 3 1  ON 63
ci_015                 1.370459e-02 3 1  ON 64
ci_016                 1.650840e-02 3 1  ON 65
ci_017                 1.641804e-02 3 1  ON 66
ci_018                 1.285924e-02 3 1  ON 67
ci_019                 1.318472e-02 3 1  ON 68
ci_020                 1.354438e-02 3 1  ON 69
ci_021                 1.340230e-02 3 1  ON 70
ci_022                 1.106755e-02 3 1  ON 71
ci_023                 1.087450e-02 3 1  ON 72
ci_024                 1.196338e-02 3 1  ON 73
ci_025                 1.149436e-02 3 1  ON 74
ci_026                 1.098395e-02 3 1  ON 75
ci_027                 1.159802e-02 3 1  ON 76
ci_028                -1.455177e-02 3 1  ON 77
ci_029                -1.474812e-02 3 1  ON 78
ci_030                -1.120643e-02 3 1  ON 79
ci_031                -1.145484e-02 3 1  ON 80
ci_032                -1.353642e-02 3 1  ON 81
ci_033                 1.085709e-02 3 1  ON 82
ci_034                 1.031757e-02 3 1  ON 83
ci_035                -4.682185e-03 3 1  ON 84
ci_036                -1.036018e-02 3 1  ON 85
ci_037                -1.004824e-02 3 1  ON 86
ci_038                 1.587499e-03 3 1  ON 87
ci_039                 1.475601e-03 3 1  ON 88
ci_040                -4.148666e-03 3 1  ON 89
ci_041                 9.836530e-03 3 1  ON 90
ci_042                 1.013919e-02 3 1  ON 91
ci_043                -3.080670e-03 3 1  ON 92
ci_044                -1.570246e-02 3 1  ON 93
ci_045                -1.737229e-03 3 1  ON 94
ci_046                 5.514565e-03 3 1  ON 95
ci_047                 5.667241e-03 3 1  ON 96
ci_048                -1.194078e-02 3 1  ON 97
ci_049                -1.191680e-02 3 1  ON 98
ci_050                 7.403871e-03 3 1  ON 99
ci_051                 7.613882e-03 3 1  ON 100
ci_052                -6.629807e-03 3 1  ON 101
ci_053                -6.604357e-03 3 1  ON 102
ci_054                -3.305954e-03 3 1  ON 103
ci_055                -3.194086e-03 3 1  ON 104
ci_056                 5.109083e-03 3 1  ON 105
ci_057                 4.398491e-03 3 1  ON 106
ci_058                -6.807973e-03 3 1  ON 107
ci_059                -6.479231e-03 3 1  ON 108
ci_060                 8.345340e-03 3 1  ON 109
ci_061                 8.489998e-03 3 1  ON 110
ci_062                -3.039272e-03 3 1  ON 111
ci_063                -3.146075e-03 3 1  ON 112
ci_064                -2.941282e-03 3 1  ON 113
ci_065                -4.019434e-03 3 1  ON 114
ci_066                 5.778027e-03 3 1  ON 115
ci_067                 5.909470e-03 3 1  ON 116
ci_068                -4.958872e-03 3 1  ON 117
ci_069                -4.634783e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1643
    reference variance = 0.239989
====================================================
  Execution time = 2.0444e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1437e-01
  Total weights = 1.9568e+06
  Execution time = 1.8322e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298898887205
                                         uncertainty =       0.001848315907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298898887205
                                         uncertainty =       0.001848315907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386563711
  error estimate for blocks of size 2^( 2) =       0.000396616566
  error estimate for blocks of size 2^( 3) =       0.000405420319
  error estimate for blocks of size 2^( 4) =       0.000412219823
  error estimate for blocks of size 2^( 5) =       0.000416332040
  error estimate for blocks of size 2^( 6) =       0.000418742156
  error estimate for blocks of size 2^( 7) =       0.000420063853

      target function =                  N/A
              le_mean =     -17.216254848448
             les_mean =     296.724823195528
             stat err =       0.000416839468
             autocorr =       1.162774508324
              std dev =       0.546683642853
             le_variance =       0.298863005364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298974582000
                                         uncertainty =       0.001849419085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298974582000
                                         uncertainty =       0.001849419085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386612484
  error estimate for blocks of size 2^( 2) =       0.000396660320
  error estimate for blocks of size 2^( 3) =       0.000405459812
  error estimate for blocks of size 2^( 4) =       0.000412254157
  error estimate for blocks of size 2^( 5) =       0.000416360170
  error estimate for blocks of size 2^( 6) =       0.000418767413
  error estimate for blocks of size 2^( 7) =       0.000420083852

      target function =                  N/A
              le_mean =     -17.216252908280
             les_mean =     296.742127135151
             stat err =       0.000416866398
             autocorr =       1.162631356348
              std dev =       0.546752618662
             le_variance =       0.298938426013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298938487602
                                         uncertainty =       0.001848841154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298938487602
                                         uncertainty =       0.001848841154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386589220
  error estimate for blocks of size 2^( 2) =       0.000396638998
  error estimate for blocks of size 2^( 3) =       0.000405441009
  error estimate for blocks of size 2^( 4) =       0.000412237720
  error estimate for blocks of size 2^( 5) =       0.000416347124
  error estimate for blocks of size 2^( 6) =       0.000418755584
  error estimate for blocks of size 2^( 7) =       0.000420074567

      target function =                  N/A
              le_mean =     -17.216252943317
             les_mean =     296.713805635202
             stat err =       0.000416853749
             autocorr =       1.162700727364
              std dev =       0.546719717758
             le_variance =       0.298902449785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298903568249
                                         uncertainty =       0.001848394319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298903568249
                                         uncertainty =       0.001848394319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386566725
  error estimate for blocks of size 2^( 2) =       0.000396619128
  error estimate for blocks of size 2^( 3) =       0.000405422781
  error estimate for blocks of size 2^( 4) =       0.000412222145
  error estimate for blocks of size 2^( 5) =       0.000416333726
  error estimate for blocks of size 2^( 6) =       0.000418743130
  error estimate for blocks of size 2^( 7) =       0.000420063899

      target function =                  N/A
              le_mean =     -17.216254902058
             les_mean =     296.714362328565
             stat err =       0.000416840725
             autocorr =       1.162763388469
              std dev =       0.546687905637
             le_variance =       0.298867666170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216254848448        initial
     1.5259e+00     1.5259e+01             4.8372e-04       -17.216252908280
     6.1035e+00     6.1035e+01             1.1973e-04       -17.216252943317
     2.4414e+01     2.4414e+02             2.9798e-05       -17.216254902058  <--

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 2.9731e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.052129e-01 1 1  ON 0
  uu_1                 4.496505e-02 1 1  ON 1
  uu_2                -4.694859e-02 1 1  ON 2
  uu_3                -9.928766e-02 1 1  ON 3
  uu_4                -1.300211e-01 1 1  ON 4
  uu_5                -1.354291e-01 1 1  ON 5
  uu_6                -1.124482e-01 1 1  ON 6
  uu_7                -3.914510e-02 1 1  ON 7
  uu_8                 1.001574e-01 1 1  ON 8
  uu_9                 1.206274e-01 1 1  ON 9
  ud_0                 3.487445e-01 1 1  ON 10
  ud_1                 9.116330e-02 1 1  ON 11
  ud_2                -1.671327e-02 1 1  ON 12
  ud_3                -7.580978e-02 1 1  ON 13
  ud_4                -1.214656e-01 1 1  ON 14
  ud_5                -1.518188e-01 1 1  ON 15
  ud_6                -1.542886e-01 1 1  ON 16
  ud_7                -1.096704e-01 1 1  ON 17
  ud_8                 4.960021e-03 1 1  ON 18
  ud_9                 9.253550e-02 1 1  ON 19
  eO_0                -7.473637e-01 1 1  ON 20
  eO_1                -4.334686e-01 1 1  ON 21
  eO_2                -3.549233e-02 1 1  ON 22
  eO_3                 2.067954e-01 1 1  ON 23
  eO_4                 2.862792e-01 1 1  ON 24
  eO_5                 3.046193e-01 1 1  ON 25
  eO_6                 2.500147e-01 1 1  ON 26
  eO_7                 1.117579e-01 1 1  ON 27
  eO_8                 2.784035e-02 1 1  ON 28
  eO_9                 1.841213e-02 1 1  ON 29
 eH1_0                -1.820125e-01 1 1  ON 30
 eH1_1                -1.025648e-01 1 1  ON 31
 eH1_2                -6.218800e-02 1 1  ON 32
 eH1_3                -2.596967e-02 1 1  ON 33
 eH1_4                 1.934752e-02 1 1  ON 34
 eH1_5                 3.564682e-02 1 1  ON 35
 eH1_6                 7.727434e-02 1 1  ON 36
 eH1_7                 1.104606e-01 1 1  ON 37
 eH1_8                 9.054873e-02 1 1  ON 38
 eH1_9                 2.423141e-02 1 1  ON 39
 eH2_0                -1.832675e-01 1 1  ON 40
 eH2_1                -1.036073e-01 1 1  ON 41
 eH2_2                -6.357606e-02 1 1  ON 42
 eH2_3                -2.732776e-02 1 1  ON 43
 eH2_4                 1.829818e-02 1 1  ON 44
 eH2_5                 3.518874e-02 1 1  ON 45
 eH2_6                 7.840015e-02 1 1  ON 46
 eH2_7                 1.136379e-01 1 1  ON 47
 eH2_8                 9.374927e-02 1 1  ON 48
 eH2_9                 2.630198e-02 1 1  ON 49
ci_001                -4.050556e-02 3 1  ON 50
ci_002                -2.987679e-02 3 1  ON 51
ci_003                -2.525639e-02 3 1  ON 52
ci_004                 2.101465e-02 3 1  ON 53
ci_005                 2.141930e-02 3 1  ON 54
ci_006                -1.922547e-02 3 1  ON 55
ci_007                -1.910958e-02 3 1  ON 56
ci_008                -1.768222e-02 3 1  ON 57
ci_009                -1.816800e-02 3 1  ON 58
ci_010                -1.748801e-02 3 1  ON 59
ci_011                -1.635458e-02 3 1  ON 60
ci_012                -1.634380e-02 3 1  ON 61
ci_013                -1.930151e-02 3 1  ON 62
ci_014                 1.396520e-02 3 1  ON 63
ci_015                 1.370307e-02 3 1  ON 64
ci_016                 1.648811e-02 3 1  ON 65
ci_017                 1.640777e-02 3 1  ON 66
ci_018                 1.287170e-02 3 1  ON 67
ci_019                 1.321422e-02 3 1  ON 68
ci_020                 1.354036e-02 3 1  ON 69
ci_021                 1.339174e-02 3 1  ON 70
ci_022                 1.106912e-02 3 1  ON 71
ci_023                 1.088356e-02 3 1  ON 72
ci_024                 1.198817e-02 3 1  ON 73
ci_025                 1.151570e-02 3 1  ON 74
ci_026                 1.099180e-02 3 1  ON 75
ci_027                 1.159307e-02 3 1  ON 76
ci_028                -1.458159e-02 3 1  ON 77
ci_029                -1.477959e-02 3 1  ON 78
ci_030                -1.119821e-02 3 1  ON 79
ci_031                -1.147608e-02 3 1  ON 80
ci_032                -1.353480e-02 3 1  ON 81
ci_033                 1.084564e-02 3 1  ON 82
ci_034                 1.028349e-02 3 1  ON 83
ci_035                -4.689105e-03 3 1  ON 84
ci_036                -1.036030e-02 3 1  ON 85
ci_037                -1.002252e-02 3 1  ON 86
ci_038                 1.583173e-03 3 1  ON 87
ci_039                 1.483618e-03 3 1  ON 88
ci_040                -4.170533e-03 3 1  ON 89
ci_041                 9.849757e-03 3 1  ON 90
ci_042                 1.014709e-02 3 1  ON 91
ci_043                -3.083728e-03 3 1  ON 92
ci_044                -1.569740e-02 3 1  ON 93
ci_045                -1.747244e-03 3 1  ON 94
ci_046                 5.500437e-03 3 1  ON 95
ci_047                 5.693823e-03 3 1  ON 96
ci_048                -1.194924e-02 3 1  ON 97
ci_049                -1.191336e-02 3 1  ON 98
ci_050                 7.404928e-03 3 1  ON 99
ci_051                 7.650290e-03 3 1  ON 100
ci_052                -6.651603e-03 3 1  ON 101
ci_053                -6.585036e-03 3 1  ON 102
ci_054                -3.294900e-03 3 1  ON 103
ci_055                -3.198198e-03 3 1  ON 104
ci_056                 5.120908e-03 3 1  ON 105
ci_057                 4.372769e-03 3 1  ON 106
ci_058                -6.801664e-03 3 1  ON 107
ci_059                -6.444844e-03 3 1  ON 108
ci_060                 8.329419e-03 3 1  ON 109
ci_061                 8.482356e-03 3 1  ON 110
ci_062                -3.028379e-03 3 1  ON 111
ci_063                -3.165156e-03 3 1  ON 112
ci_064                -2.915416e-03 3 1  ON 113
ci_065                -4.033080e-03 3 1  ON 114
ci_066                 5.782428e-03 3 1  ON 115
ci_067                 5.925733e-03 3 1  ON 116
ci_068                -4.947814e-03 3 1  ON 117
ci_069                -4.628250e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6556e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.116
    reference variance = 0.771047
====================================================
  Execution time = 2.0686e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1428e-01
  Total weights = 1.956737651e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300745788286
                                         uncertainty =       0.002389625351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300745788286
                                         uncertainty =       0.002389625351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387768785
  error estimate for blocks of size 2^( 2) =       0.000397675425
  error estimate for blocks of size 2^( 3) =       0.000406398016
  error estimate for blocks of size 2^( 4) =       0.000412989980
  error estimate for blocks of size 2^( 5) =       0.000416983351
  error estimate for blocks of size 2^( 6) =       0.000419940492
  error estimate for blocks of size 2^( 7) =       0.000420970801

      target function =                  N/A
              le_mean =     -17.216220862406
             les_mean =     296.712540759966
             stat err =       0.000417721156
             autocorr =       1.160452185059
              std dev =       0.548387874528
             le_variance =       0.300729260929


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721622086241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216220862462       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216221837388       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216221894749       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216222034951       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216222029098       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216222268456       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216222110109       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216222124692       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216222116281       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216222126775       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+00 is 1.337785e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216220862462       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216221113996       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216221127469       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216221158605       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216221157842       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216221219814       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216221181407       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216221184481       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216221181357       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216221184009       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+01 is 3.353034e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216220862462       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216220925853       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216220929165       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216220936694       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216220936528       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216220952154       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216220942639       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216220943386       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216220942533       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216220943187       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+01 is 8.387799e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163675 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6765e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.052232e-01 1 1  ON 0
  uu_1                 4.497310e-02 1 1  ON 1
  uu_2                -4.694380e-02 1 1  ON 2
  uu_3                -9.928529e-02 1 1  ON 3
  uu_4                -1.300316e-01 1 1  ON 4
  uu_5                -1.354338e-01 1 1  ON 5
  uu_6                -1.124524e-01 1 1  ON 6
  uu_7                -3.915283e-02 1 1  ON 7
  uu_8                 1.001535e-01 1 1  ON 8
  uu_9                 1.206296e-01 1 1  ON 9
  ud_0                 3.487570e-01 1 1  ON 10
  ud_1                 9.116766e-02 1 1  ON 11
  ud_2                -1.671607e-02 1 1  ON 12
  ud_3                -7.581405e-02 1 1  ON 13
  ud_4                -1.214681e-01 1 1  ON 14
  ud_5                -1.518224e-01 1 1  ON 15
  ud_6                -1.542871e-01 1 1  ON 16
  ud_7                -1.096730e-01 1 1  ON 17
  ud_8                 4.954085e-03 1 1  ON 18
  ud_9                 9.253530e-02 1 1  ON 19
  eO_0                -7.473973e-01 1 1  ON 20
  eO_1                -4.334906e-01 1 1  ON 21
  eO_2                -3.549759e-02 1 1  ON 22
  eO_3                 2.068171e-01 1 1  ON 23
  eO_4                 2.863072e-01 1 1  ON 24
  eO_5                 3.046222e-01 1 1  ON 25
  eO_6                 2.500171e-01 1 1  ON 26
  eO_7                 1.117622e-01 1 1  ON 27
  eO_8                 2.784089e-02 1 1  ON 28
  eO_9                 1.841247e-02 1 1  ON 29
 eH1_0                -1.820151e-01 1 1  ON 30
 eH1_1                -1.025665e-01 1 1  ON 31
 eH1_2                -6.219226e-02 1 1  ON 32
 eH1_3                -2.596960e-02 1 1  ON 33
 eH1_4                 1.934821e-02 1 1  ON 34
 eH1_5                 3.565020e-02 1 1  ON 35
 eH1_6                 7.727548e-02 1 1  ON 36
 eH1_7                 1.104599e-01 1 1  ON 37
 eH1_8                 9.055129e-02 1 1  ON 38
 eH1_9                 2.423225e-02 1 1  ON 39
 eH2_0                -1.832663e-01 1 1  ON 40
 eH2_1                -1.036069e-01 1 1  ON 41
 eH2_2                -6.357256e-02 1 1  ON 42
 eH2_3                -2.732814e-02 1 1  ON 43
 eH2_4                 1.829754e-02 1 1  ON 44
 eH2_5                 3.518353e-02 1 1  ON 45
 eH2_6                 7.839927e-02 1 1  ON 46
 eH2_7                 1.136367e-01 1 1  ON 47
 eH2_8                 9.375134e-02 1 1  ON 48
 eH2_9                 2.630266e-02 1 1  ON 49
ci_001                -4.049846e-02 3 1  ON 50
ci_002                -2.986802e-02 3 1  ON 51
ci_003                -2.525813e-02 3 1  ON 52
ci_004                 2.101003e-02 3 1  ON 53
ci_005                 2.141912e-02 3 1  ON 54
ci_006                -1.922204e-02 3 1  ON 55
ci_007                -1.910180e-02 3 1  ON 56
ci_008                -1.767802e-02 3 1  ON 57
ci_009                -1.816126e-02 3 1  ON 58
ci_010                -1.749265e-02 3 1  ON 59
ci_011                -1.634455e-02 3 1  ON 60
ci_012                -1.633110e-02 3 1  ON 61
ci_013                -1.930691e-02 3 1  ON 62
ci_014                 1.396772e-02 3 1  ON 63
ci_015                 1.371105e-02 3 1  ON 64
ci_016                 1.648741e-02 3 1  ON 65
ci_017                 1.641109e-02 3 1  ON 66
ci_018                 1.286899e-02 3 1  ON 67
ci_019                 1.320536e-02 3 1  ON 68
ci_020                 1.353732e-02 3 1  ON 69
ci_021                 1.339379e-02 3 1  ON 70
ci_022                 1.106581e-02 3 1  ON 71
ci_023                 1.088407e-02 3 1  ON 72
ci_024                 1.198774e-02 3 1  ON 73
ci_025                 1.151970e-02 3 1  ON 74
ci_026                 1.098212e-02 3 1  ON 75
ci_027                 1.158657e-02 3 1  ON 76
ci_028                -1.458482e-02 3 1  ON 77
ci_029                -1.478183e-02 3 1  ON 78
ci_030                -1.120123e-02 3 1  ON 79
ci_031                -1.147104e-02 3 1  ON 80
ci_032                -1.352692e-02 3 1  ON 81
ci_033                 1.084044e-02 3 1  ON 82
ci_034                 1.028064e-02 3 1  ON 83
ci_035                -4.693081e-03 3 1  ON 84
ci_036                -1.036076e-02 3 1  ON 85
ci_037                -1.003112e-02 3 1  ON 86
ci_038                 1.581837e-03 3 1  ON 87
ci_039                 1.484494e-03 3 1  ON 88
ci_040                -4.174212e-03 3 1  ON 89
ci_041                 9.846575e-03 3 1  ON 90
ci_042                 1.015158e-02 3 1  ON 91
ci_043                -3.079409e-03 3 1  ON 92
ci_044                -1.569318e-02 3 1  ON 93
ci_045                -1.746626e-03 3 1  ON 94
ci_046                 5.500267e-03 3 1  ON 95
ci_047                 5.688155e-03 3 1  ON 96
ci_048                -1.194882e-02 3 1  ON 97
ci_049                -1.191351e-02 3 1  ON 98
ci_050                 7.418863e-03 3 1  ON 99
ci_051                 7.656288e-03 3 1  ON 100
ci_052                -6.648296e-03 3 1  ON 101
ci_053                -6.590693e-03 3 1  ON 102
ci_054                -3.292168e-03 3 1  ON 103
ci_055                -3.193086e-03 3 1  ON 104
ci_056                 5.116716e-03 3 1  ON 105
ci_057                 4.370349e-03 3 1  ON 106
ci_058                -6.797020e-03 3 1  ON 107
ci_059                -6.454838e-03 3 1  ON 108
ci_060                 8.327398e-03 3 1  ON 109
ci_061                 8.478758e-03 3 1  ON 110
ci_062                -3.023659e-03 3 1  ON 111
ci_063                -3.171061e-03 3 1  ON 112
ci_064                -2.928326e-03 3 1  ON 113
ci_065                -4.035239e-03 3 1  ON 114
ci_066                 5.784163e-03 3 1  ON 115
ci_067                 5.923691e-03 3 1  ON 116
ci_068                -4.944454e-03 3 1  ON 117
ci_069                -4.623932e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2145
    reference variance = 0.272636
====================================================
  Execution time = 2.0743e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0924e-01
  Total weights = 1.9564e+06
  Execution time = 1.8320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564781179
                                         uncertainty =       0.001911037422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564781179
                                         uncertainty =       0.001911037422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385694828
  error estimate for blocks of size 2^( 2) =       0.000395445052
  error estimate for blocks of size 2^( 3) =       0.000404050391
  error estimate for blocks of size 2^( 4) =       0.000410357124
  error estimate for blocks of size 2^( 5) =       0.000415327367
  error estimate for blocks of size 2^( 6) =       0.000417271717
  error estimate for blocks of size 2^( 7) =       0.000419553877

      target function =                  N/A
              le_mean =     -17.216827870179
             les_mean =     296.728391060598
             stat err =       0.000415627521
             autocorr =       1.161237260881
              std dev =       0.545454857126
             le_variance =       0.297521001162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297596530539
                                         uncertainty =       0.001911921761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297596530539
                                         uncertainty =       0.001911921761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385715428
  error estimate for blocks of size 2^( 2) =       0.000395464592
  error estimate for blocks of size 2^( 3) =       0.000404068633
  error estimate for blocks of size 2^( 4) =       0.000410374327
  error estimate for blocks of size 2^( 5) =       0.000415345882
  error estimate for blocks of size 2^( 6) =       0.000417290551
  error estimate for blocks of size 2^( 7) =       0.000419574682

      target function =                  N/A
              le_mean =     -17.216827472693
             les_mean =     296.728421656905
             stat err =       0.000415646360
             autocorr =       1.161218495169
              std dev =       0.545483988825
             le_variance =       0.297552782065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297581231659
                                         uncertainty =       0.001911497918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297581231659
                                         uncertainty =       0.001911497918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385705501
  error estimate for blocks of size 2^( 2) =       0.000395455169
  error estimate for blocks of size 2^( 3) =       0.000404059837
  error estimate for blocks of size 2^( 4) =       0.000410366029
  error estimate for blocks of size 2^( 5) =       0.000415336945
  error estimate for blocks of size 2^( 6) =       0.000417281451
  error estimate for blocks of size 2^( 7) =       0.000419564650

      target function =                  N/A
              le_mean =     -17.216827636394
             les_mean =     296.728398349131
             stat err =       0.000415637269
             autocorr =       1.161227462732
              std dev =       0.545469950958
             le_variance =       0.297537467398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297566841526
                                         uncertainty =       0.001911095486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297566841526
                                         uncertainty =       0.001911095486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385696165
  error estimate for blocks of size 2^( 2) =       0.000395446318
  error estimate for blocks of size 2^( 3) =       0.000404051573
  error estimate for blocks of size 2^( 4) =       0.000410358237
  error estimate for blocks of size 2^( 5) =       0.000415328565
  error estimate for blocks of size 2^( 6) =       0.000417272934
  error estimate for blocks of size 2^( 7) =       0.000419555226

      target function =                  N/A
              le_mean =     -17.216827838004
             les_mean =     296.728391380820
             stat err =       0.000415628740
             autocorr =       1.161236025477
              std dev =       0.545456747579
             le_variance =       0.297523063480


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216827870179        initial  <--
     6.1035e+00     6.1035e+01             1.3378e-04       -17.216827472693
     2.4414e+01     2.4414e+02             3.3530e-05       -17.216827636394
     9.7656e+01     9.7656e+02             8.3878e-06       -17.216827838004

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0305
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.052129e-01 1 1  ON 0
  uu_1                 4.496505e-02 1 1  ON 1
  uu_2                -4.694859e-02 1 1  ON 2
  uu_3                -9.928766e-02 1 1  ON 3
  uu_4                -1.300211e-01 1 1  ON 4
  uu_5                -1.354291e-01 1 1  ON 5
  uu_6                -1.124482e-01 1 1  ON 6
  uu_7                -3.914510e-02 1 1  ON 7
  uu_8                 1.001574e-01 1 1  ON 8
  uu_9                 1.206274e-01 1 1  ON 9
  ud_0                 3.487445e-01 1 1  ON 10
  ud_1                 9.116330e-02 1 1  ON 11
  ud_2                -1.671327e-02 1 1  ON 12
  ud_3                -7.580978e-02 1 1  ON 13
  ud_4                -1.214656e-01 1 1  ON 14
  ud_5                -1.518188e-01 1 1  ON 15
  ud_6                -1.542886e-01 1 1  ON 16
  ud_7                -1.096704e-01 1 1  ON 17
  ud_8                 4.960021e-03 1 1  ON 18
  ud_9                 9.253550e-02 1 1  ON 19
  eO_0                -7.473637e-01 1 1  ON 20
  eO_1                -4.334686e-01 1 1  ON 21
  eO_2                -3.549233e-02 1 1  ON 22
  eO_3                 2.067954e-01 1 1  ON 23
  eO_4                 2.862792e-01 1 1  ON 24
  eO_5                 3.046193e-01 1 1  ON 25
  eO_6                 2.500147e-01 1 1  ON 26
  eO_7                 1.117579e-01 1 1  ON 27
  eO_8                 2.784035e-02 1 1  ON 28
  eO_9                 1.841213e-02 1 1  ON 29
 eH1_0                -1.820125e-01 1 1  ON 30
 eH1_1                -1.025648e-01 1 1  ON 31
 eH1_2                -6.218800e-02 1 1  ON 32
 eH1_3                -2.596967e-02 1 1  ON 33
 eH1_4                 1.934752e-02 1 1  ON 34
 eH1_5                 3.564682e-02 1 1  ON 35
 eH1_6                 7.727434e-02 1 1  ON 36
 eH1_7                 1.104606e-01 1 1  ON 37
 eH1_8                 9.054873e-02 1 1  ON 38
 eH1_9                 2.423141e-02 1 1  ON 39
 eH2_0                -1.832675e-01 1 1  ON 40
 eH2_1                -1.036073e-01 1 1  ON 41
 eH2_2                -6.357606e-02 1 1  ON 42
 eH2_3                -2.732776e-02 1 1  ON 43
 eH2_4                 1.829818e-02 1 1  ON 44
 eH2_5                 3.518874e-02 1 1  ON 45
 eH2_6                 7.840015e-02 1 1  ON 46
 eH2_7                 1.136379e-01 1 1  ON 47
 eH2_8                 9.374927e-02 1 1  ON 48
 eH2_9                 2.630198e-02 1 1  ON 49
ci_001                -4.050556e-02 3 1  ON 50
ci_002                -2.987679e-02 3 1  ON 51
ci_003                -2.525639e-02 3 1  ON 52
ci_004                 2.101465e-02 3 1  ON 53
ci_005                 2.141930e-02 3 1  ON 54
ci_006                -1.922547e-02 3 1  ON 55
ci_007                -1.910958e-02 3 1  ON 56
ci_008                -1.768222e-02 3 1  ON 57
ci_009                -1.816800e-02 3 1  ON 58
ci_010                -1.748801e-02 3 1  ON 59
ci_011                -1.635458e-02 3 1  ON 60
ci_012                -1.634380e-02 3 1  ON 61
ci_013                -1.930151e-02 3 1  ON 62
ci_014                 1.396520e-02 3 1  ON 63
ci_015                 1.370307e-02 3 1  ON 64
ci_016                 1.648811e-02 3 1  ON 65
ci_017                 1.640777e-02 3 1  ON 66
ci_018                 1.287170e-02 3 1  ON 67
ci_019                 1.321422e-02 3 1  ON 68
ci_020                 1.354036e-02 3 1  ON 69
ci_021                 1.339174e-02 3 1  ON 70
ci_022                 1.106912e-02 3 1  ON 71
ci_023                 1.088356e-02 3 1  ON 72
ci_024                 1.198817e-02 3 1  ON 73
ci_025                 1.151570e-02 3 1  ON 74
ci_026                 1.099180e-02 3 1  ON 75
ci_027                 1.159307e-02 3 1  ON 76
ci_028                -1.458159e-02 3 1  ON 77
ci_029                -1.477959e-02 3 1  ON 78
ci_030                -1.119821e-02 3 1  ON 79
ci_031                -1.147608e-02 3 1  ON 80
ci_032                -1.353480e-02 3 1  ON 81
ci_033                 1.084564e-02 3 1  ON 82
ci_034                 1.028349e-02 3 1  ON 83
ci_035                -4.689105e-03 3 1  ON 84
ci_036                -1.036030e-02 3 1  ON 85
ci_037                -1.002252e-02 3 1  ON 86
ci_038                 1.583173e-03 3 1  ON 87
ci_039                 1.483618e-03 3 1  ON 88
ci_040                -4.170533e-03 3 1  ON 89
ci_041                 9.849757e-03 3 1  ON 90
ci_042                 1.014709e-02 3 1  ON 91
ci_043                -3.083728e-03 3 1  ON 92
ci_044                -1.569740e-02 3 1  ON 93
ci_045                -1.747244e-03 3 1  ON 94
ci_046                 5.500437e-03 3 1  ON 95
ci_047                 5.693823e-03 3 1  ON 96
ci_048                -1.194924e-02 3 1  ON 97
ci_049                -1.191336e-02 3 1  ON 98
ci_050                 7.404928e-03 3 1  ON 99
ci_051                 7.650290e-03 3 1  ON 100
ci_052                -6.651603e-03 3 1  ON 101
ci_053                -6.585036e-03 3 1  ON 102
ci_054                -3.294900e-03 3 1  ON 103
ci_055                -3.198198e-03 3 1  ON 104
ci_056                 5.120908e-03 3 1  ON 105
ci_057                 4.372769e-03 3 1  ON 106
ci_058                -6.801664e-03 3 1  ON 107
ci_059                -6.444844e-03 3 1  ON 108
ci_060                 8.329419e-03 3 1  ON 109
ci_061                 8.482356e-03 3 1  ON 110
ci_062                -3.028379e-03 3 1  ON 111
ci_063                -3.165156e-03 3 1  ON 112
ci_064                -2.915416e-03 3 1  ON 113
ci_065                -4.033080e-03 3 1  ON 114
ci_066                 5.782428e-03 3 1  ON 115
ci_067                 5.925733e-03 3 1  ON 116
ci_068                -4.947814e-03 3 1  ON 117
ci_069                -4.628250e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6802e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2037
    reference variance = 0.234591
====================================================
  Execution time = 2.0717e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1426e-01
  Total weights = 1.956840532e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299667744202
                                         uncertainty =       0.003625428118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299667744202
                                         uncertainty =       0.003625428118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387061539
  error estimate for blocks of size 2^( 2) =       0.000396907880
  error estimate for blocks of size 2^( 3) =       0.000405527153
  error estimate for blocks of size 2^( 4) =       0.000412452322
  error estimate for blocks of size 2^( 5) =       0.000416533898
  error estimate for blocks of size 2^( 6) =       0.000419013144
  error estimate for blocks of size 2^( 7) =       0.000419107433

      target function =                  N/A
              le_mean =     -17.217117774361
             les_mean =     296.743401550188
             stat err =       0.000416776699
             autocorr =       1.159436114611
              std dev =       0.547387677827
             le_variance =       0.299633269837


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721711777436e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217117774406       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217117834263       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217117852368       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217117877925       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217117900110       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217117888394       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217117890131       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217117888120       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217117885914       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217117885816       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+01 is 1.255856e-05

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217117774406       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217117789415       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217117793963       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217117800378       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217117805940       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217117803000       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217117803430       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217117802939       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217117802382       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217117802355       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+02 is 3.140470e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217117774406       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217117778161       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217117779299       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217117780904       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217117782296       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217117781561       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217117781669       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217117781547       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217117781403       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217117781399       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+02 is 7.851693e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172334 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6745e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.052140e-01 1 1  ON 0
  uu_1                 4.496507e-02 1 1  ON 1
  uu_2                -4.694838e-02 1 1  ON 2
  uu_3                -9.928768e-02 1 1  ON 3
  uu_4                -1.300220e-01 1 1  ON 4
  uu_5                -1.354291e-01 1 1  ON 5
  uu_6                -1.124485e-01 1 1  ON 6
  uu_7                -3.914538e-02 1 1  ON 7
  uu_8                 1.001572e-01 1 1  ON 8
  uu_9                 1.206277e-01 1 1  ON 9
  ud_0                 3.487454e-01 1 1  ON 10
  ud_1                 9.116365e-02 1 1  ON 11
  ud_2                -1.671319e-02 1 1  ON 12
  ud_3                -7.580971e-02 1 1  ON 13
  ud_4                -1.214663e-01 1 1  ON 14
  ud_5                -1.518196e-01 1 1  ON 15
  ud_6                -1.542887e-01 1 1  ON 16
  ud_7                -1.096704e-01 1 1  ON 17
  ud_8                 4.959674e-03 1 1  ON 18
  ud_9                 9.253558e-02 1 1  ON 19
  eO_0                -7.473669e-01 1 1  ON 20
  eO_1                -4.334706e-01 1 1  ON 21
  eO_2                -3.549358e-02 1 1  ON 22
  eO_3                 2.067972e-01 1 1  ON 23
  eO_4                 2.862823e-01 1 1  ON 24
  eO_5                 3.046197e-01 1 1  ON 25
  eO_6                 2.500149e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784046e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025649e-01 1 1  ON 31
 eH1_2                -6.218814e-02 1 1  ON 32
 eH1_3                -2.596954e-02 1 1  ON 33
 eH1_4                 1.934750e-02 1 1  ON 34
 eH1_5                 3.564658e-02 1 1  ON 35
 eH1_6                 7.727438e-02 1 1  ON 36
 eH1_7                 1.104607e-01 1 1  ON 37
 eH1_8                 9.054906e-02 1 1  ON 38
 eH1_9                 2.423151e-02 1 1  ON 39
 eH2_0                -1.832677e-01 1 1  ON 40
 eH2_1                -1.036080e-01 1 1  ON 41
 eH2_2                -6.357557e-02 1 1  ON 42
 eH2_3                -2.732761e-02 1 1  ON 43
 eH2_4                 1.829817e-02 1 1  ON 44
 eH2_5                 3.518888e-02 1 1  ON 45
 eH2_6                 7.840018e-02 1 1  ON 46
 eH2_7                 1.136376e-01 1 1  ON 47
 eH2_8                 9.374949e-02 1 1  ON 48
 eH2_9                 2.630207e-02 1 1  ON 49
ci_001                -4.050572e-02 3 1  ON 50
ci_002                -2.987765e-02 3 1  ON 51
ci_003                -2.525579e-02 3 1  ON 52
ci_004                 2.101540e-02 3 1  ON 53
ci_005                 2.141838e-02 3 1  ON 54
ci_006                -1.922546e-02 3 1  ON 55
ci_007                -1.910976e-02 3 1  ON 56
ci_008                -1.768236e-02 3 1  ON 57
ci_009                -1.816715e-02 3 1  ON 58
ci_010                -1.748759e-02 3 1  ON 59
ci_011                -1.635548e-02 3 1  ON 60
ci_012                -1.634379e-02 3 1  ON 61
ci_013                -1.930259e-02 3 1  ON 62
ci_014                 1.396467e-02 3 1  ON 63
ci_015                 1.370372e-02 3 1  ON 64
ci_016                 1.648824e-02 3 1  ON 65
ci_017                 1.640816e-02 3 1  ON 66
ci_018                 1.287149e-02 3 1  ON 67
ci_019                 1.321493e-02 3 1  ON 68
ci_020                 1.354003e-02 3 1  ON 69
ci_021                 1.339157e-02 3 1  ON 70
ci_022                 1.106867e-02 3 1  ON 71
ci_023                 1.088338e-02 3 1  ON 72
ci_024                 1.198879e-02 3 1  ON 73
ci_025                 1.151541e-02 3 1  ON 74
ci_026                 1.099246e-02 3 1  ON 75
ci_027                 1.159245e-02 3 1  ON 76
ci_028                -1.458229e-02 3 1  ON 77
ci_029                -1.477982e-02 3 1  ON 78
ci_030                -1.119720e-02 3 1  ON 79
ci_031                -1.147497e-02 3 1  ON 80
ci_032                -1.353501e-02 3 1  ON 81
ci_033                 1.084529e-02 3 1  ON 82
ci_034                 1.028285e-02 3 1  ON 83
ci_035                -4.689434e-03 3 1  ON 84
ci_036                -1.036035e-02 3 1  ON 85
ci_037                -1.002202e-02 3 1  ON 86
ci_038                 1.583503e-03 3 1  ON 87
ci_039                 1.483910e-03 3 1  ON 88
ci_040                -4.169975e-03 3 1  ON 89
ci_041                 9.849541e-03 3 1  ON 90
ci_042                 1.014756e-02 3 1  ON 91
ci_043                -3.084009e-03 3 1  ON 92
ci_044                -1.569750e-02 3 1  ON 93
ci_045                -1.746511e-03 3 1  ON 94
ci_046                 5.500312e-03 3 1  ON 95
ci_047                 5.693350e-03 3 1  ON 96
ci_048                -1.194929e-02 3 1  ON 97
ci_049                -1.191344e-02 3 1  ON 98
ci_050                 7.404589e-03 3 1  ON 99
ci_051                 7.650123e-03 3 1  ON 100
ci_052                -6.650965e-03 3 1  ON 101
ci_053                -6.584667e-03 3 1  ON 102
ci_054                -3.294201e-03 3 1  ON 103
ci_055                -3.198249e-03 3 1  ON 104
ci_056                 5.119771e-03 3 1  ON 105
ci_057                 4.372799e-03 3 1  ON 106
ci_058                -6.800948e-03 3 1  ON 107
ci_059                -6.444515e-03 3 1  ON 108
ci_060                 8.329890e-03 3 1  ON 109
ci_061                 8.482285e-03 3 1  ON 110
ci_062                -3.028678e-03 3 1  ON 111
ci_063                -3.165336e-03 3 1  ON 112
ci_064                -2.916123e-03 3 1  ON 113
ci_065                -4.033487e-03 3 1  ON 114
ci_066                 5.782866e-03 3 1  ON 115
ci_067                 5.924702e-03 3 1  ON 116
ci_068                -4.946786e-03 3 1  ON 117
ci_069                -4.628873e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2391
    reference variance = 0.350455
====================================================
  Execution time = 2.0500e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1255e-01
  Total weights = 1.9565e+06
  Execution time = 1.8332e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298877353987
                                         uncertainty =       0.001881417598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298877353987
                                         uncertainty =       0.001881417598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386632240
  error estimate for blocks of size 2^( 2) =       0.000396824813
  error estimate for blocks of size 2^( 3) =       0.000406096967
  error estimate for blocks of size 2^( 4) =       0.000412157120
  error estimate for blocks of size 2^( 5) =       0.000416863101
  error estimate for blocks of size 2^( 6) =       0.000420150981
  error estimate for blocks of size 2^( 7) =       0.000421721616

      target function =                  N/A
              le_mean =     -17.216874692291
             les_mean =     296.733325051020
             stat err =       0.000417723205
             autocorr =       1.167296197884
              std dev =       0.546780557577
             le_variance =       0.298968978144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298877252787
                                         uncertainty =       0.001881508188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298877252787
                                         uncertainty =       0.001881508188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386632182
  error estimate for blocks of size 2^( 2) =       0.000396824691
  error estimate for blocks of size 2^( 3) =       0.000406096788
  error estimate for blocks of size 2^( 4) =       0.000412156891
  error estimate for blocks of size 2^( 5) =       0.000416862860
  error estimate for blocks of size 2^( 6) =       0.000420150810
  error estimate for blocks of size 2^( 7) =       0.000421721090

      target function =                  N/A
              le_mean =     -17.216874614711
             les_mean =     296.733329396846
             stat err =       0.000417722913
             autocorr =       1.167294918329
              std dev =       0.546780475001
             le_variance =       0.298968887842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298877301028
                                         uncertainty =       0.001881462989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298877301028
                                         uncertainty =       0.001881462989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386632209
  error estimate for blocks of size 2^( 2) =       0.000396824750
  error estimate for blocks of size 2^( 3) =       0.000406096876
  error estimate for blocks of size 2^( 4) =       0.000412157004
  error estimate for blocks of size 2^( 5) =       0.000416862979
  error estimate for blocks of size 2^( 6) =       0.000420150894
  error estimate for blocks of size 2^( 7) =       0.000421721351

      target function =                  N/A
              le_mean =     -17.216874653190
             les_mean =     296.733327056659
             stat err =       0.000417723057
             autocorr =       1.167295557671
              std dev =       0.546780514143
             le_variance =       0.298968930647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298877347147
                                         uncertainty =       0.001881423272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298877347147
                                         uncertainty =       0.001881423272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386632236
  error estimate for blocks of size 2^( 2) =       0.000396824805
  error estimate for blocks of size 2^( 3) =       0.000406096956
  error estimate for blocks of size 2^( 4) =       0.000412157105
  error estimate for blocks of size 2^( 5) =       0.000416863086
  error estimate for blocks of size 2^( 6) =       0.000420150970
  error estimate for blocks of size 2^( 7) =       0.000421721583

      target function =                  N/A
              le_mean =     -17.216874687374
             les_mean =     296.733325286369
             stat err =       0.000417723186
             autocorr =       1.167296117874
              std dev =       0.546780551947
             le_variance =       0.298968971987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216874692291        initial  <--
     6.1035e+01     6.1035e+02             1.2559e-05       -17.216874614711
     2.4414e+02     2.4414e+03             3.1405e-06       -17.216874653190
     9.7656e+02     9.7656e+03             7.8517e-07       -17.216874687374

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7936
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.052129e-01 1 1  ON 0
  uu_1                 4.496505e-02 1 1  ON 1
  uu_2                -4.694859e-02 1 1  ON 2
  uu_3                -9.928766e-02 1 1  ON 3
  uu_4                -1.300211e-01 1 1  ON 4
  uu_5                -1.354291e-01 1 1  ON 5
  uu_6                -1.124482e-01 1 1  ON 6
  uu_7                -3.914510e-02 1 1  ON 7
  uu_8                 1.001574e-01 1 1  ON 8
  uu_9                 1.206274e-01 1 1  ON 9
  ud_0                 3.487445e-01 1 1  ON 10
  ud_1                 9.116330e-02 1 1  ON 11
  ud_2                -1.671327e-02 1 1  ON 12
  ud_3                -7.580978e-02 1 1  ON 13
  ud_4                -1.214656e-01 1 1  ON 14
  ud_5                -1.518188e-01 1 1  ON 15
  ud_6                -1.542886e-01 1 1  ON 16
  ud_7                -1.096704e-01 1 1  ON 17
  ud_8                 4.960021e-03 1 1  ON 18
  ud_9                 9.253550e-02 1 1  ON 19
  eO_0                -7.473637e-01 1 1  ON 20
  eO_1                -4.334686e-01 1 1  ON 21
  eO_2                -3.549233e-02 1 1  ON 22
  eO_3                 2.067954e-01 1 1  ON 23
  eO_4                 2.862792e-01 1 1  ON 24
  eO_5                 3.046193e-01 1 1  ON 25
  eO_6                 2.500147e-01 1 1  ON 26
  eO_7                 1.117579e-01 1 1  ON 27
  eO_8                 2.784035e-02 1 1  ON 28
  eO_9                 1.841213e-02 1 1  ON 29
 eH1_0                -1.820125e-01 1 1  ON 30
 eH1_1                -1.025648e-01 1 1  ON 31
 eH1_2                -6.218800e-02 1 1  ON 32
 eH1_3                -2.596967e-02 1 1  ON 33
 eH1_4                 1.934752e-02 1 1  ON 34
 eH1_5                 3.564682e-02 1 1  ON 35
 eH1_6                 7.727434e-02 1 1  ON 36
 eH1_7                 1.104606e-01 1 1  ON 37
 eH1_8                 9.054873e-02 1 1  ON 38
 eH1_9                 2.423141e-02 1 1  ON 39
 eH2_0                -1.832675e-01 1 1  ON 40
 eH2_1                -1.036073e-01 1 1  ON 41
 eH2_2                -6.357606e-02 1 1  ON 42
 eH2_3                -2.732776e-02 1 1  ON 43
 eH2_4                 1.829818e-02 1 1  ON 44
 eH2_5                 3.518874e-02 1 1  ON 45
 eH2_6                 7.840015e-02 1 1  ON 46
 eH2_7                 1.136379e-01 1 1  ON 47
 eH2_8                 9.374927e-02 1 1  ON 48
 eH2_9                 2.630198e-02 1 1  ON 49
ci_001                -4.050556e-02 3 1  ON 50
ci_002                -2.987679e-02 3 1  ON 51
ci_003                -2.525639e-02 3 1  ON 52
ci_004                 2.101465e-02 3 1  ON 53
ci_005                 2.141930e-02 3 1  ON 54
ci_006                -1.922547e-02 3 1  ON 55
ci_007                -1.910958e-02 3 1  ON 56
ci_008                -1.768222e-02 3 1  ON 57
ci_009                -1.816800e-02 3 1  ON 58
ci_010                -1.748801e-02 3 1  ON 59
ci_011                -1.635458e-02 3 1  ON 60
ci_012                -1.634380e-02 3 1  ON 61
ci_013                -1.930151e-02 3 1  ON 62
ci_014                 1.396520e-02 3 1  ON 63
ci_015                 1.370307e-02 3 1  ON 64
ci_016                 1.648811e-02 3 1  ON 65
ci_017                 1.640777e-02 3 1  ON 66
ci_018                 1.287170e-02 3 1  ON 67
ci_019                 1.321422e-02 3 1  ON 68
ci_020                 1.354036e-02 3 1  ON 69
ci_021                 1.339174e-02 3 1  ON 70
ci_022                 1.106912e-02 3 1  ON 71
ci_023                 1.088356e-02 3 1  ON 72
ci_024                 1.198817e-02 3 1  ON 73
ci_025                 1.151570e-02 3 1  ON 74
ci_026                 1.099180e-02 3 1  ON 75
ci_027                 1.159307e-02 3 1  ON 76
ci_028                -1.458159e-02 3 1  ON 77
ci_029                -1.477959e-02 3 1  ON 78
ci_030                -1.119821e-02 3 1  ON 79
ci_031                -1.147608e-02 3 1  ON 80
ci_032                -1.353480e-02 3 1  ON 81
ci_033                 1.084564e-02 3 1  ON 82
ci_034                 1.028349e-02 3 1  ON 83
ci_035                -4.689105e-03 3 1  ON 84
ci_036                -1.036030e-02 3 1  ON 85
ci_037                -1.002252e-02 3 1  ON 86
ci_038                 1.583173e-03 3 1  ON 87
ci_039                 1.483618e-03 3 1  ON 88
ci_040                -4.170533e-03 3 1  ON 89
ci_041                 9.849757e-03 3 1  ON 90
ci_042                 1.014709e-02 3 1  ON 91
ci_043                -3.083728e-03 3 1  ON 92
ci_044                -1.569740e-02 3 1  ON 93
ci_045                -1.747244e-03 3 1  ON 94
ci_046                 5.500437e-03 3 1  ON 95
ci_047                 5.693823e-03 3 1  ON 96
ci_048                -1.194924e-02 3 1  ON 97
ci_049                -1.191336e-02 3 1  ON 98
ci_050                 7.404928e-03 3 1  ON 99
ci_051                 7.650290e-03 3 1  ON 100
ci_052                -6.651603e-03 3 1  ON 101
ci_053                -6.585036e-03 3 1  ON 102
ci_054                -3.294900e-03 3 1  ON 103
ci_055                -3.198198e-03 3 1  ON 104
ci_056                 5.120908e-03 3 1  ON 105
ci_057                 4.372769e-03 3 1  ON 106
ci_058                -6.801664e-03 3 1  ON 107
ci_059                -6.444844e-03 3 1  ON 108
ci_060                 8.329419e-03 3 1  ON 109
ci_061                 8.482356e-03 3 1  ON 110
ci_062                -3.028379e-03 3 1  ON 111
ci_063                -3.165156e-03 3 1  ON 112
ci_064                -2.915416e-03 3 1  ON 113
ci_065                -4.033080e-03 3 1  ON 114
ci_066                 5.782428e-03 3 1  ON 115
ci_067                 5.925733e-03 3 1  ON 116
ci_068                -4.947814e-03 3 1  ON 117
ci_069                -4.628250e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6561e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2333
    reference variance = 0.30241
====================================================
  Execution time = 2.0720e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1385e-01
  Total weights = 1.956618528e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300436434835
                                         uncertainty =       0.002135860688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300436434835
                                         uncertainty =       0.002135860688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387618136
  error estimate for blocks of size 2^( 2) =       0.000397990907
  error estimate for blocks of size 2^( 3) =       0.000406978390
  error estimate for blocks of size 2^( 4) =       0.000414246674
  error estimate for blocks of size 2^( 5) =       0.000418506344
  error estimate for blocks of size 2^( 6) =       0.000420821494
  error estimate for blocks of size 2^( 7) =       0.000421968961

      target function =                  N/A
              le_mean =     -17.216712742440
             les_mean =     296.729048681850
             stat err =       0.000418885868
             autocorr =       1.167839716733
              std dev =       0.548174824491
             le_variance =       0.300495638206


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671274244e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216712742478       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216712739244       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216712736903       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216712738882       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216712739141       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216712739673       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216712740472       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216712740183       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216712740070       residual = 9.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+02 is 1.369718e-06

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216712742478       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216712741669       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216712741083       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216712741577       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216712741643       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216712741778       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216712741976       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216712741906       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216712741865       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+03 is 3.424479e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216712742478       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216712742276       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216712742129       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216712742250       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216712742274       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216712742306       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216712742357       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216712742320       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216712742349       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+03 is 8.561313e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180266 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6838e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.052130e-01 1 1  ON 0
  uu_1                 4.496507e-02 1 1  ON 1
  uu_2                -4.694857e-02 1 1  ON 2
  uu_3                -9.928762e-02 1 1  ON 3
  uu_4                -1.300211e-01 1 1  ON 4
  uu_5                -1.354291e-01 1 1  ON 5
  uu_6                -1.124482e-01 1 1  ON 6
  uu_7                -3.914513e-02 1 1  ON 7
  uu_8                 1.001574e-01 1 1  ON 8
  uu_9                 1.206274e-01 1 1  ON 9
  ud_0                 3.487446e-01 1 1  ON 10
  ud_1                 9.116336e-02 1 1  ON 11
  ud_2                -1.671328e-02 1 1  ON 12
  ud_3                -7.580984e-02 1 1  ON 13
  ud_4                -1.214657e-01 1 1  ON 14
  ud_5                -1.518189e-01 1 1  ON 15
  ud_6                -1.542886e-01 1 1  ON 16
  ud_7                -1.096704e-01 1 1  ON 17
  ud_8                 4.959961e-03 1 1  ON 18
  ud_9                 9.253549e-02 1 1  ON 19
  eO_0                -7.473641e-01 1 1  ON 20
  eO_1                -4.334688e-01 1 1  ON 21
  eO_2                -3.549241e-02 1 1  ON 22
  eO_3                 2.067955e-01 1 1  ON 23
  eO_4                 2.862795e-01 1 1  ON 24
  eO_5                 3.046193e-01 1 1  ON 25
  eO_6                 2.500147e-01 1 1  ON 26
  eO_7                 1.117579e-01 1 1  ON 27
  eO_8                 2.784036e-02 1 1  ON 28
  eO_9                 1.841213e-02 1 1  ON 29
 eH1_0                -1.820125e-01 1 1  ON 30
 eH1_1                -1.025649e-01 1 1  ON 31
 eH1_2                -6.218799e-02 1 1  ON 32
 eH1_3                -2.596965e-02 1 1  ON 33
 eH1_4                 1.934749e-02 1 1  ON 34
 eH1_5                 3.564684e-02 1 1  ON 35
 eH1_6                 7.727435e-02 1 1  ON 36
 eH1_7                 1.104606e-01 1 1  ON 37
 eH1_8                 9.054876e-02 1 1  ON 38
 eH1_9                 2.423142e-02 1 1  ON 39
 eH2_0                -1.832675e-01 1 1  ON 40
 eH2_1                -1.036074e-01 1 1  ON 41
 eH2_2                -6.357604e-02 1 1  ON 42
 eH2_3                -2.732776e-02 1 1  ON 43
 eH2_4                 1.829816e-02 1 1  ON 44
 eH2_5                 3.518873e-02 1 1  ON 45
 eH2_6                 7.840017e-02 1 1  ON 46
 eH2_7                 1.136379e-01 1 1  ON 47
 eH2_8                 9.374929e-02 1 1  ON 48
 eH2_9                 2.630198e-02 1 1  ON 49
ci_001                -4.050557e-02 3 1  ON 50
ci_002                -2.987683e-02 3 1  ON 51
ci_003                -2.525627e-02 3 1  ON 52
ci_004                 2.101467e-02 3 1  ON 53
ci_005                 2.141928e-02 3 1  ON 54
ci_006                -1.922548e-02 3 1  ON 55
ci_007                -1.910961e-02 3 1  ON 56
ci_008                -1.768225e-02 3 1  ON 57
ci_009                -1.816791e-02 3 1  ON 58
ci_010                -1.748800e-02 3 1  ON 59
ci_011                -1.635464e-02 3 1  ON 60
ci_012                -1.634378e-02 3 1  ON 61
ci_013                -1.930144e-02 3 1  ON 62
ci_014                 1.396508e-02 3 1  ON 63
ci_015                 1.370315e-02 3 1  ON 64
ci_016                 1.648821e-02 3 1  ON 65
ci_017                 1.640775e-02 3 1  ON 66
ci_018                 1.287171e-02 3 1  ON 67
ci_019                 1.321419e-02 3 1  ON 68
ci_020                 1.354032e-02 3 1  ON 69
ci_021                 1.339160e-02 3 1  ON 70
ci_022                 1.106917e-02 3 1  ON 71
ci_023                 1.088357e-02 3 1  ON 72
ci_024                 1.198820e-02 3 1  ON 73
ci_025                 1.151572e-02 3 1  ON 74
ci_026                 1.099178e-02 3 1  ON 75
ci_027                 1.159299e-02 3 1  ON 76
ci_028                -1.458166e-02 3 1  ON 77
ci_029                -1.477955e-02 3 1  ON 78
ci_030                -1.119824e-02 3 1  ON 79
ci_031                -1.147613e-02 3 1  ON 80
ci_032                -1.353483e-02 3 1  ON 81
ci_033                 1.084568e-02 3 1  ON 82
ci_034                 1.028347e-02 3 1  ON 83
ci_035                -4.689050e-03 3 1  ON 84
ci_036                -1.036029e-02 3 1  ON 85
ci_037                -1.002257e-02 3 1  ON 86
ci_038                 1.583232e-03 3 1  ON 87
ci_039                 1.483597e-03 3 1  ON 88
ci_040                -4.170507e-03 3 1  ON 89
ci_041                 9.849801e-03 3 1  ON 90
ci_042                 1.014706e-02 3 1  ON 91
ci_043                -3.083671e-03 3 1  ON 92
ci_044                -1.569737e-02 3 1  ON 93
ci_045                -1.747147e-03 3 1  ON 94
ci_046                 5.500448e-03 3 1  ON 95
ci_047                 5.693836e-03 3 1  ON 96
ci_048                -1.194921e-02 3 1  ON 97
ci_049                -1.191333e-02 3 1  ON 98
ci_050                 7.404949e-03 3 1  ON 99
ci_051                 7.650181e-03 3 1  ON 100
ci_052                -6.651612e-03 3 1  ON 101
ci_053                -6.585041e-03 3 1  ON 102
ci_054                -3.294847e-03 3 1  ON 103
ci_055                -3.198130e-03 3 1  ON 104
ci_056                 5.120884e-03 3 1  ON 105
ci_057                 4.372796e-03 3 1  ON 106
ci_058                -6.801596e-03 3 1  ON 107
ci_059                -6.444955e-03 3 1  ON 108
ci_060                 8.329380e-03 3 1  ON 109
ci_061                 8.482363e-03 3 1  ON 110
ci_062                -3.028348e-03 3 1  ON 111
ci_063                -3.165244e-03 3 1  ON 112
ci_064                -2.915486e-03 3 1  ON 113
ci_065                -4.033079e-03 3 1  ON 114
ci_066                 5.782388e-03 3 1  ON 115
ci_067                 5.925684e-03 3 1  ON 116
ci_068                -4.947828e-03 3 1  ON 117
ci_069                -4.628255e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2297
    reference variance = 0.338875
====================================================
  Execution time = 2.0618e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2070e-01
  Total weights = 1.9565e+06
  Execution time = 1.8270e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302759038485
                                         uncertainty =       0.002521717033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302759038485
                                         uncertainty =       0.002521717033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389118650
  error estimate for blocks of size 2^( 2) =       0.000399140392
  error estimate for blocks of size 2^( 3) =       0.000407971170
  error estimate for blocks of size 2^( 4) =       0.000415075386
  error estimate for blocks of size 2^( 5) =       0.000420289117
  error estimate for blocks of size 2^( 6) =       0.000422214616
  error estimate for blocks of size 2^( 7) =       0.000423516050

      target function =                  N/A
              le_mean =     -17.216420270051
             les_mean =     296.725829636203
             stat err =       0.000420273792
             autocorr =       1.166542388689
              std dev =       0.550296872116
             le_variance =       0.302826647461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302759322386
                                         uncertainty =       0.002521733987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302759322386
                                         uncertainty =       0.002521733987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389118832
  error estimate for blocks of size 2^( 2) =       0.000399140556
  error estimate for blocks of size 2^( 3) =       0.000407971312
  error estimate for blocks of size 2^( 4) =       0.000415075507
  error estimate for blocks of size 2^( 5) =       0.000420289232
  error estimate for blocks of size 2^( 6) =       0.000422214743
  error estimate for blocks of size 2^( 7) =       0.000423516195

      target function =                  N/A
              le_mean =     -17.216420272068
             les_mean =     296.725826411368
             stat err =       0.000420273919
             autocorr =       1.166542003193
              std dev =       0.550297129284
             le_variance =       0.302826930498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302759180432
                                         uncertainty =       0.002521725512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302759180432
                                         uncertainty =       0.002521725512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389118741
  error estimate for blocks of size 2^( 2) =       0.000399140474
  error estimate for blocks of size 2^( 3) =       0.000407971241
  error estimate for blocks of size 2^( 4) =       0.000415075446
  error estimate for blocks of size 2^( 5) =       0.000420289174
  error estimate for blocks of size 2^( 6) =       0.000422214680
  error estimate for blocks of size 2^( 7) =       0.000423516122

      target function =                  N/A
              le_mean =     -17.216420271059
             les_mean =     296.725827813522
             stat err =       0.000420273856
             autocorr =       1.166542195817
              std dev =       0.550297000697
             le_variance =       0.302826788976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302759056227
                                         uncertainty =       0.002521718093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302759056227
                                         uncertainty =       0.002521718093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389118661
  error estimate for blocks of size 2^( 2) =       0.000399140402
  error estimate for blocks of size 2^( 3) =       0.000407971179
  error estimate for blocks of size 2^( 4) =       0.000415075393
  error estimate for blocks of size 2^( 5) =       0.000420289124
  error estimate for blocks of size 2^( 6) =       0.000422214624
  error estimate for blocks of size 2^( 7) =       0.000423516059

      target function =                  N/A
              le_mean =     -17.216420270177
             les_mean =     296.725829380537
             stat err =       0.000420273800
             autocorr =       1.166542364566
              std dev =       0.550296888188
             le_variance =       0.302826665149


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216420270051        initial
     6.1035e+02     6.1035e+03             1.3697e-06       -17.216420272068  <--
     2.4414e+03     2.4414e+04             3.4245e-07       -17.216420271059
     9.7656e+03     9.7656e+04             8.5613e-08       -17.216420270177

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 2.9891e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.052132e-01 1 1  ON 0
  uu_1                 4.496512e-02 1 1  ON 1
  uu_2                -4.694852e-02 1 1  ON 2
  uu_3                -9.928749e-02 1 1  ON 3
  uu_4                -1.300213e-01 1 1  ON 4
  uu_5                -1.354292e-01 1 1  ON 5
  uu_6                -1.124483e-01 1 1  ON 6
  uu_7                -3.914522e-02 1 1  ON 7
  uu_8                 1.001573e-01 1 1  ON 8
  uu_9                 1.206275e-01 1 1  ON 9
  ud_0                 3.487450e-01 1 1  ON 10
  ud_1                 9.116354e-02 1 1  ON 11
  ud_2                -1.671331e-02 1 1  ON 12
  ud_3                -7.581001e-02 1 1  ON 13
  ud_4                -1.214658e-01 1 1  ON 14
  ud_5                -1.518191e-01 1 1  ON 15
  ud_6                -1.542885e-01 1 1  ON 16
  ud_7                -1.096705e-01 1 1  ON 17
  ud_8                 4.959781e-03 1 1  ON 18
  ud_9                 9.253547e-02 1 1  ON 19
  eO_0                -7.473651e-01 1 1  ON 20
  eO_1                -4.334695e-01 1 1  ON 21
  eO_2                -3.549265e-02 1 1  ON 22
  eO_3                 2.067960e-01 1 1  ON 23
  eO_4                 2.862805e-01 1 1  ON 24
  eO_5                 3.046195e-01 1 1  ON 25
  eO_6                 2.500148e-01 1 1  ON 26
  eO_7                 1.117581e-01 1 1  ON 27
  eO_8                 2.784037e-02 1 1  ON 28
  eO_9                 1.841214e-02 1 1  ON 29
 eH1_0                -1.820126e-01 1 1  ON 30
 eH1_1                -1.025650e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596959e-02 1 1  ON 33
 eH1_4                 1.934739e-02 1 1  ON 34
 eH1_5                 3.564687e-02 1 1  ON 35
 eH1_6                 7.727438e-02 1 1  ON 36
 eH1_7                 1.104606e-01 1 1  ON 37
 eH1_8                 9.054885e-02 1 1  ON 38
 eH1_9                 2.423144e-02 1 1  ON 39
 eH2_0                -1.832675e-01 1 1  ON 40
 eH2_1                -1.036074e-01 1 1  ON 41
 eH2_2                -6.357600e-02 1 1  ON 42
 eH2_3                -2.732775e-02 1 1  ON 43
 eH2_4                 1.829811e-02 1 1  ON 44
 eH2_5                 3.518869e-02 1 1  ON 45
 eH2_6                 7.840022e-02 1 1  ON 46
 eH2_7                 1.136378e-01 1 1  ON 47
 eH2_8                 9.374936e-02 1 1  ON 48
 eH2_9                 2.630201e-02 1 1  ON 49
ci_001                -4.050559e-02 3 1  ON 50
ci_002                -2.987696e-02 3 1  ON 51
ci_003                -2.525593e-02 3 1  ON 52
ci_004                 2.101474e-02 3 1  ON 53
ci_005                 2.141921e-02 3 1  ON 54
ci_006                -1.922551e-02 3 1  ON 55
ci_007                -1.910969e-02 3 1  ON 56
ci_008                -1.768234e-02 3 1  ON 57
ci_009                -1.816764e-02 3 1  ON 58
ci_010                -1.748798e-02 3 1  ON 59
ci_011                -1.635481e-02 3 1  ON 60
ci_012                -1.634373e-02 3 1  ON 61
ci_013                -1.930123e-02 3 1  ON 62
ci_014                 1.396471e-02 3 1  ON 63
ci_015                 1.370338e-02 3 1  ON 64
ci_016                 1.648851e-02 3 1  ON 65
ci_017                 1.640768e-02 3 1  ON 66
ci_018                 1.287174e-02 3 1  ON 67
ci_019                 1.321411e-02 3 1  ON 68
ci_020                 1.354019e-02 3 1  ON 69
ci_021                 1.339120e-02 3 1  ON 70
ci_022                 1.106932e-02 3 1  ON 71
ci_023                 1.088362e-02 3 1  ON 72
ci_024                 1.198832e-02 3 1  ON 73
ci_025                 1.151576e-02 3 1  ON 74
ci_026                 1.099172e-02 3 1  ON 75
ci_027                 1.159273e-02 3 1  ON 76
ci_028                -1.458186e-02 3 1  ON 77
ci_029                -1.477945e-02 3 1  ON 78
ci_030                -1.119833e-02 3 1  ON 79
ci_031                -1.147625e-02 3 1  ON 80
ci_032                -1.353494e-02 3 1  ON 81
ci_033                 1.084578e-02 3 1  ON 82
ci_034                 1.028340e-02 3 1  ON 83
ci_035                -4.688886e-03 3 1  ON 84
ci_036                -1.036028e-02 3 1  ON 85
ci_037                -1.002272e-02 3 1  ON 86
ci_038                 1.583408e-03 3 1  ON 87
ci_039                 1.483534e-03 3 1  ON 88
ci_040                -4.170432e-03 3 1  ON 89
ci_041                 9.849932e-03 3 1  ON 90
ci_042                 1.014696e-02 3 1  ON 91
ci_043                -3.083503e-03 3 1  ON 92
ci_044                -1.569729e-02 3 1  ON 93
ci_045                -1.746857e-03 3 1  ON 94
ci_046                 5.500481e-03 3 1  ON 95
ci_047                 5.693877e-03 3 1  ON 96
ci_048                -1.194913e-02 3 1  ON 97
ci_049                -1.191322e-02 3 1  ON 98
ci_050                 7.405011e-03 3 1  ON 99
ci_051                 7.649855e-03 3 1  ON 100
ci_052                -6.651639e-03 3 1  ON 101
ci_053                -6.585056e-03 3 1  ON 102
ci_054                -3.294688e-03 3 1  ON 103
ci_055                -3.197927e-03 3 1  ON 104
ci_056                 5.120810e-03 3 1  ON 105
ci_057                 4.372877e-03 3 1  ON 106
ci_058                -6.801392e-03 3 1  ON 107
ci_059                -6.445288e-03 3 1  ON 108
ci_060                 8.329265e-03 3 1  ON 109
ci_061                 8.482384e-03 3 1  ON 110
ci_062                -3.028253e-03 3 1  ON 111
ci_063                -3.165510e-03 3 1  ON 112
ci_064                -2.915694e-03 3 1  ON 113
ci_065                -4.033077e-03 3 1  ON 114
ci_066                 5.782268e-03 3 1  ON 115
ci_067                 5.925538e-03 3 1  ON 116
ci_068                -4.947870e-03 3 1  ON 117
ci_069                -4.628269e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6751e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.3106
    reference variance = 0.211133
====================================================
  Execution time = 2.2869e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1532e-01
  Total weights = 1.956571450e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0503e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301047748014
                                         uncertainty =       0.003346371339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301047748014
                                         uncertainty =       0.003346371339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387937367
  error estimate for blocks of size 2^( 2) =       0.000398262282
  error estimate for blocks of size 2^( 3) =       0.000407187538
  error estimate for blocks of size 2^( 4) =       0.000413607280
  error estimate for blocks of size 2^( 5) =       0.000418902218
  error estimate for blocks of size 2^( 6) =       0.000421527769
  error estimate for blocks of size 2^( 7) =       0.000422690634

      target function =                  N/A
              le_mean =     -17.216288141112
             les_mean =     296.715893498852
             stat err =       0.000419181975
             autocorr =       1.167567433151
              std dev =       0.548626285231
             le_variance =       0.300990800847


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721628814111e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216288141152       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216288151610       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216288148807       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216288157573       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216288154004       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216288150936       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216288154096       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216288155300       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216288156162       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216288156956       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+02 is 5.352713e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216288141152       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216288143770       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216288143069       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216288145263       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216288144373       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216288143602       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216288144388       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216288144686       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216288144906       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216288145103       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+02 is 1.338115e-06

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216288141152       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216288141806       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216288141631       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216288142180       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216288141957       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216288141760       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216288141959       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216288142051       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216288142093       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216288142140       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+03 is 3.345247e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184221 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8933e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.052135e-01 1 1  ON 0
  uu_1                 4.496539e-02 1 1  ON 1
  uu_2                -4.694836e-02 1 1  ON 2
  uu_3                -9.928754e-02 1 1  ON 3
  uu_4                -1.300216e-01 1 1  ON 4
  uu_5                -1.354292e-01 1 1  ON 5
  uu_6                -1.124486e-01 1 1  ON 6
  uu_7                -3.914546e-02 1 1  ON 7
  uu_8                 1.001572e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487456e-01 1 1  ON 10
  ud_1                 9.116369e-02 1 1  ON 11
  ud_2                -1.671316e-02 1 1  ON 12
  ud_3                -7.581022e-02 1 1  ON 13
  ud_4                -1.214660e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542885e-01 1 1  ON 16
  ud_7                -1.096706e-01 1 1  ON 17
  ud_8                 4.959479e-03 1 1  ON 18
  ud_9                 9.253547e-02 1 1  ON 19
  eO_0                -7.473664e-01 1 1  ON 20
  eO_1                -4.334705e-01 1 1  ON 21
  eO_2                -3.549279e-02 1 1  ON 22
  eO_3                 2.067968e-01 1 1  ON 23
  eO_4                 2.862818e-01 1 1  ON 24
  eO_5                 3.046196e-01 1 1  ON 25
  eO_6                 2.500149e-01 1 1  ON 26
  eO_7                 1.117582e-01 1 1  ON 27
  eO_8                 2.784039e-02 1 1  ON 28
  eO_9                 1.841215e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025650e-01 1 1  ON 31
 eH1_2                -6.218804e-02 1 1  ON 32
 eH1_3                -2.596964e-02 1 1  ON 33
 eH1_4                 1.934745e-02 1 1  ON 34
 eH1_5                 3.564704e-02 1 1  ON 35
 eH1_6                 7.727438e-02 1 1  ON 36
 eH1_7                 1.104604e-01 1 1  ON 37
 eH1_8                 9.054894e-02 1 1  ON 38
 eH1_9                 2.423147e-02 1 1  ON 39
 eH2_0                -1.832675e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357591e-02 1 1  ON 42
 eH2_3                -2.732777e-02 1 1  ON 43
 eH2_4                 1.829808e-02 1 1  ON 44
 eH2_5                 3.518870e-02 1 1  ON 45
 eH2_6                 7.840024e-02 1 1  ON 46
 eH2_7                 1.136378e-01 1 1  ON 47
 eH2_8                 9.374945e-02 1 1  ON 48
 eH2_9                 2.630204e-02 1 1  ON 49
ci_001                -4.050551e-02 3 1  ON 50
ci_002                -2.987703e-02 3 1  ON 51
ci_003                -2.525611e-02 3 1  ON 52
ci_004                 2.101454e-02 3 1  ON 53
ci_005                 2.141910e-02 3 1  ON 54
ci_006                -1.922524e-02 3 1  ON 55
ci_007                -1.910985e-02 3 1  ON 56
ci_008                -1.768243e-02 3 1  ON 57
ci_009                -1.816735e-02 3 1  ON 58
ci_010                -1.748763e-02 3 1  ON 59
ci_011                -1.635465e-02 3 1  ON 60
ci_012                -1.634370e-02 3 1  ON 61
ci_013                -1.930140e-02 3 1  ON 62
ci_014                 1.396463e-02 3 1  ON 63
ci_015                 1.370362e-02 3 1  ON 64
ci_016                 1.648859e-02 3 1  ON 65
ci_017                 1.640769e-02 3 1  ON 66
ci_018                 1.287187e-02 3 1  ON 67
ci_019                 1.321339e-02 3 1  ON 68
ci_020                 1.354001e-02 3 1  ON 69
ci_021                 1.339129e-02 3 1  ON 70
ci_022                 1.106972e-02 3 1  ON 71
ci_023                 1.088349e-02 3 1  ON 72
ci_024                 1.198841e-02 3 1  ON 73
ci_025                 1.151561e-02 3 1  ON 74
ci_026                 1.099159e-02 3 1  ON 75
ci_027                 1.159256e-02 3 1  ON 76
ci_028                -1.458163e-02 3 1  ON 77
ci_029                -1.477924e-02 3 1  ON 78
ci_030                -1.119798e-02 3 1  ON 79
ci_031                -1.147643e-02 3 1  ON 80
ci_032                -1.353489e-02 3 1  ON 81
ci_033                 1.084556e-02 3 1  ON 82
ci_034                 1.028352e-02 3 1  ON 83
ci_035                -4.688760e-03 3 1  ON 84
ci_036                -1.036052e-02 3 1  ON 85
ci_037                -1.002276e-02 3 1  ON 86
ci_038                 1.583238e-03 3 1  ON 87
ci_039                 1.483757e-03 3 1  ON 88
ci_040                -4.170322e-03 3 1  ON 89
ci_041                 9.850001e-03 3 1  ON 90
ci_042                 1.014706e-02 3 1  ON 91
ci_043                -3.083409e-03 3 1  ON 92
ci_044                -1.569708e-02 3 1  ON 93
ci_045                -1.746790e-03 3 1  ON 94
ci_046                 5.500635e-03 3 1  ON 95
ci_047                 5.693941e-03 3 1  ON 96
ci_048                -1.194893e-02 3 1  ON 97
ci_049                -1.191306e-02 3 1  ON 98
ci_050                 7.404622e-03 3 1  ON 99
ci_051                 7.649805e-03 3 1  ON 100
ci_052                -6.651870e-03 3 1  ON 101
ci_053                -6.585381e-03 3 1  ON 102
ci_054                -3.294437e-03 3 1  ON 103
ci_055                -3.197885e-03 3 1  ON 104
ci_056                 5.120421e-03 3 1  ON 105
ci_057                 4.373015e-03 3 1  ON 106
ci_058                -6.801281e-03 3 1  ON 107
ci_059                -6.445591e-03 3 1  ON 108
ci_060                 8.329079e-03 3 1  ON 109
ci_061                 8.482348e-03 3 1  ON 110
ci_062                -3.027888e-03 3 1  ON 111
ci_063                -3.165490e-03 3 1  ON 112
ci_064                -2.916055e-03 3 1  ON 113
ci_065                -4.033251e-03 3 1  ON 114
ci_066                 5.782083e-03 3 1  ON 115
ci_067                 5.925120e-03 3 1  ON 116
ci_068                -4.947828e-03 3 1  ON 117
ci_069                -4.628312e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2473
    reference variance = 0.181432
====================================================
  Execution time = 2.0269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1631e-01
  Total weights = 1.9566e+06
  Execution time = 1.8307e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301210639737
                                         uncertainty =       0.002695856757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301210639737
                                         uncertainty =       0.002695856757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388017853
  error estimate for blocks of size 2^( 2) =       0.000397943558
  error estimate for blocks of size 2^( 3) =       0.000406793105
  error estimate for blocks of size 2^( 4) =       0.000414017142
  error estimate for blocks of size 2^( 5) =       0.000417873039
  error estimate for blocks of size 2^( 6) =       0.000419919250
  error estimate for blocks of size 2^( 7) =       0.000420921154

      target function =                  N/A
              le_mean =     -17.216546394601
             les_mean =     296.725776993559
             stat err =       0.000418182646
             autocorr =       1.161525093293
              std dev =       0.548740109940
             le_variance =       0.301115708257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301210706749
                                         uncertainty =       0.002695788633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301210706749
                                         uncertainty =       0.002695788633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388017896
  error estimate for blocks of size 2^( 2) =       0.000397943562
  error estimate for blocks of size 2^( 3) =       0.000406793106
  error estimate for blocks of size 2^( 4) =       0.000414017125
  error estimate for blocks of size 2^( 5) =       0.000417873047
  error estimate for blocks of size 2^( 6) =       0.000419919252
  error estimate for blocks of size 2^( 7) =       0.000420921157

      target function =                  N/A
              le_mean =     -17.216546347949
             les_mean =     296.725771696373
             stat err =       0.000418182645
             autocorr =       1.161524827366
              std dev =       0.548740171641
             le_variance =       0.301115775973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301210673009
                                         uncertainty =       0.002695822631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301210673009
                                         uncertainty =       0.002695822631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388017875
  error estimate for blocks of size 2^( 2) =       0.000397943560
  error estimate for blocks of size 2^( 3) =       0.000406793105
  error estimate for blocks of size 2^( 4) =       0.000414017133
  error estimate for blocks of size 2^( 5) =       0.000417873043
  error estimate for blocks of size 2^( 6) =       0.000419919251
  error estimate for blocks of size 2^( 7) =       0.000420921156

      target function =                  N/A
              le_mean =     -17.216546371205
             les_mean =     296.725774309295
             stat err =       0.000418182646
             autocorr =       1.161524960190
              std dev =       0.548740140579
             le_variance =       0.301115741882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301210643865
                                         uncertainty =       0.002695852489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301210643865
                                         uncertainty =       0.002695852489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388017856
  error estimate for blocks of size 2^( 2) =       0.000397943558
  error estimate for blocks of size 2^( 3) =       0.000406793105
  error estimate for blocks of size 2^( 4) =       0.000414017141
  error estimate for blocks of size 2^( 5) =       0.000417873039
  error estimate for blocks of size 2^( 6) =       0.000419919250
  error estimate for blocks of size 2^( 7) =       0.000420921155

      target function =                  N/A
              le_mean =     -17.216546391672
             les_mean =     296.725776654298
             stat err =       0.000418182646
             autocorr =       1.161525076628
              std dev =       0.548740113742
             le_variance =       0.301115712429


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216546394601        initial  <--
     1.5259e+02     1.5259e+03             5.3527e-06       -17.216546347949
     6.1035e+02     6.1035e+03             1.3381e-06       -17.216546371205
     2.4414e+03     2.4414e+04             3.3452e-07       -17.216546391672

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5516
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.052132e-01 1 1  ON 0
  uu_1                 4.496512e-02 1 1  ON 1
  uu_2                -4.694852e-02 1 1  ON 2
  uu_3                -9.928749e-02 1 1  ON 3
  uu_4                -1.300213e-01 1 1  ON 4
  uu_5                -1.354292e-01 1 1  ON 5
  uu_6                -1.124483e-01 1 1  ON 6
  uu_7                -3.914522e-02 1 1  ON 7
  uu_8                 1.001573e-01 1 1  ON 8
  uu_9                 1.206275e-01 1 1  ON 9
  ud_0                 3.487450e-01 1 1  ON 10
  ud_1                 9.116354e-02 1 1  ON 11
  ud_2                -1.671331e-02 1 1  ON 12
  ud_3                -7.581001e-02 1 1  ON 13
  ud_4                -1.214658e-01 1 1  ON 14
  ud_5                -1.518191e-01 1 1  ON 15
  ud_6                -1.542885e-01 1 1  ON 16
  ud_7                -1.096705e-01 1 1  ON 17
  ud_8                 4.959781e-03 1 1  ON 18
  ud_9                 9.253547e-02 1 1  ON 19
  eO_0                -7.473651e-01 1 1  ON 20
  eO_1                -4.334695e-01 1 1  ON 21
  eO_2                -3.549265e-02 1 1  ON 22
  eO_3                 2.067960e-01 1 1  ON 23
  eO_4                 2.862805e-01 1 1  ON 24
  eO_5                 3.046195e-01 1 1  ON 25
  eO_6                 2.500148e-01 1 1  ON 26
  eO_7                 1.117581e-01 1 1  ON 27
  eO_8                 2.784037e-02 1 1  ON 28
  eO_9                 1.841214e-02 1 1  ON 29
 eH1_0                -1.820126e-01 1 1  ON 30
 eH1_1                -1.025650e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596959e-02 1 1  ON 33
 eH1_4                 1.934739e-02 1 1  ON 34
 eH1_5                 3.564687e-02 1 1  ON 35
 eH1_6                 7.727438e-02 1 1  ON 36
 eH1_7                 1.104606e-01 1 1  ON 37
 eH1_8                 9.054885e-02 1 1  ON 38
 eH1_9                 2.423144e-02 1 1  ON 39
 eH2_0                -1.832675e-01 1 1  ON 40
 eH2_1                -1.036074e-01 1 1  ON 41
 eH2_2                -6.357600e-02 1 1  ON 42
 eH2_3                -2.732775e-02 1 1  ON 43
 eH2_4                 1.829811e-02 1 1  ON 44
 eH2_5                 3.518869e-02 1 1  ON 45
 eH2_6                 7.840022e-02 1 1  ON 46
 eH2_7                 1.136378e-01 1 1  ON 47
 eH2_8                 9.374936e-02 1 1  ON 48
 eH2_9                 2.630201e-02 1 1  ON 49
ci_001                -4.050559e-02 3 1  ON 50
ci_002                -2.987696e-02 3 1  ON 51
ci_003                -2.525593e-02 3 1  ON 52
ci_004                 2.101474e-02 3 1  ON 53
ci_005                 2.141921e-02 3 1  ON 54
ci_006                -1.922551e-02 3 1  ON 55
ci_007                -1.910969e-02 3 1  ON 56
ci_008                -1.768234e-02 3 1  ON 57
ci_009                -1.816764e-02 3 1  ON 58
ci_010                -1.748798e-02 3 1  ON 59
ci_011                -1.635481e-02 3 1  ON 60
ci_012                -1.634373e-02 3 1  ON 61
ci_013                -1.930123e-02 3 1  ON 62
ci_014                 1.396471e-02 3 1  ON 63
ci_015                 1.370338e-02 3 1  ON 64
ci_016                 1.648851e-02 3 1  ON 65
ci_017                 1.640768e-02 3 1  ON 66
ci_018                 1.287174e-02 3 1  ON 67
ci_019                 1.321411e-02 3 1  ON 68
ci_020                 1.354019e-02 3 1  ON 69
ci_021                 1.339120e-02 3 1  ON 70
ci_022                 1.106932e-02 3 1  ON 71
ci_023                 1.088362e-02 3 1  ON 72
ci_024                 1.198832e-02 3 1  ON 73
ci_025                 1.151576e-02 3 1  ON 74
ci_026                 1.099172e-02 3 1  ON 75
ci_027                 1.159273e-02 3 1  ON 76
ci_028                -1.458186e-02 3 1  ON 77
ci_029                -1.477945e-02 3 1  ON 78
ci_030                -1.119833e-02 3 1  ON 79
ci_031                -1.147625e-02 3 1  ON 80
ci_032                -1.353494e-02 3 1  ON 81
ci_033                 1.084578e-02 3 1  ON 82
ci_034                 1.028340e-02 3 1  ON 83
ci_035                -4.688886e-03 3 1  ON 84
ci_036                -1.036028e-02 3 1  ON 85
ci_037                -1.002272e-02 3 1  ON 86
ci_038                 1.583408e-03 3 1  ON 87
ci_039                 1.483534e-03 3 1  ON 88
ci_040                -4.170432e-03 3 1  ON 89
ci_041                 9.849932e-03 3 1  ON 90
ci_042                 1.014696e-02 3 1  ON 91
ci_043                -3.083503e-03 3 1  ON 92
ci_044                -1.569729e-02 3 1  ON 93
ci_045                -1.746857e-03 3 1  ON 94
ci_046                 5.500481e-03 3 1  ON 95
ci_047                 5.693877e-03 3 1  ON 96
ci_048                -1.194913e-02 3 1  ON 97
ci_049                -1.191322e-02 3 1  ON 98
ci_050                 7.405011e-03 3 1  ON 99
ci_051                 7.649855e-03 3 1  ON 100
ci_052                -6.651639e-03 3 1  ON 101
ci_053                -6.585056e-03 3 1  ON 102
ci_054                -3.294688e-03 3 1  ON 103
ci_055                -3.197927e-03 3 1  ON 104
ci_056                 5.120810e-03 3 1  ON 105
ci_057                 4.372877e-03 3 1  ON 106
ci_058                -6.801392e-03 3 1  ON 107
ci_059                -6.445288e-03 3 1  ON 108
ci_060                 8.329265e-03 3 1  ON 109
ci_061                 8.482384e-03 3 1  ON 110
ci_062                -3.028253e-03 3 1  ON 111
ci_063                -3.165510e-03 3 1  ON 112
ci_064                -2.915694e-03 3 1  ON 113
ci_065                -4.033077e-03 3 1  ON 114
ci_066                 5.782268e-03 3 1  ON 115
ci_067                 5.925538e-03 3 1  ON 116
ci_068                -4.947870e-03 3 1  ON 117
ci_069                -4.628269e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8491e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1896
    reference variance = 0.4313
====================================================
  Execution time = 2.0690e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1671e-01
  Total weights = 1.956736590e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300562744064
                                         uncertainty =       0.002304122472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300562744064
                                         uncertainty =       0.002304122472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387691985
  error estimate for blocks of size 2^( 2) =       0.000397758013
  error estimate for blocks of size 2^( 3) =       0.000406614946
  error estimate for blocks of size 2^( 4) =       0.000414007393
  error estimate for blocks of size 2^( 5) =       0.000417870523
  error estimate for blocks of size 2^( 6) =       0.000420458517
  error estimate for blocks of size 2^( 7) =       0.000419395155

      target function =                  N/A
              le_mean =     -17.216930097120
             les_mean =     296.739388897079
             stat err =       0.000417932897
             autocorr =       1.162089212355
              std dev =       0.548279263184
             le_variance =       0.300610150437


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693009712e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216930097140       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216930099575       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216930100015       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216930099831       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216930100245       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216930100741       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216930100628       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216930100693       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216930100576       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216930100599       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+03 is 5.294752e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216930097140       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216930097749       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216930097859       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216930097813       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216930097922       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216930098039       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216930098012       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216930098018       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216930098004       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216930098021       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+03 is 1.323713e-07

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216930097140       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216930097293       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216930097320       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216930097309       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216930097334       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216930097365       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216930097363       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216930097362       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216930097349       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216930097371       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+04 is 3.309299e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188109 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6690e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.052132e-01 1 1  ON 0
  uu_1                 4.496514e-02 1 1  ON 1
  uu_2                -4.694849e-02 1 1  ON 2
  uu_3                -9.928747e-02 1 1  ON 3
  uu_4                -1.300213e-01 1 1  ON 4
  uu_5                -1.354292e-01 1 1  ON 5
  uu_6                -1.124484e-01 1 1  ON 6
  uu_7                -3.914523e-02 1 1  ON 7
  uu_8                 1.001573e-01 1 1  ON 8
  uu_9                 1.206275e-01 1 1  ON 9
  ud_0                 3.487451e-01 1 1  ON 10
  ud_1                 9.116355e-02 1 1  ON 11
  ud_2                -1.671333e-02 1 1  ON 12
  ud_3                -7.581003e-02 1 1  ON 13
  ud_4                -1.214658e-01 1 1  ON 14
  ud_5                -1.518191e-01 1 1  ON 15
  ud_6                -1.542885e-01 1 1  ON 16
  ud_7                -1.096705e-01 1 1  ON 17
  ud_8                 4.959758e-03 1 1  ON 18
  ud_9                 9.253547e-02 1 1  ON 19
  eO_0                -7.473652e-01 1 1  ON 20
  eO_1                -4.334696e-01 1 1  ON 21
  eO_2                -3.549267e-02 1 1  ON 22
  eO_3                 2.067961e-01 1 1  ON 23
  eO_4                 2.862806e-01 1 1  ON 24
  eO_5                 3.046195e-01 1 1  ON 25
  eO_6                 2.500148e-01 1 1  ON 26
  eO_7                 1.117581e-01 1 1  ON 27
  eO_8                 2.784037e-02 1 1  ON 28
  eO_9                 1.841214e-02 1 1  ON 29
 eH1_0                -1.820126e-01 1 1  ON 30
 eH1_1                -1.025650e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596959e-02 1 1  ON 33
 eH1_4                 1.934739e-02 1 1  ON 34
 eH1_5                 3.564687e-02 1 1  ON 35
 eH1_6                 7.727438e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054886e-02 1 1  ON 38
 eH1_9                 2.423144e-02 1 1  ON 39
 eH2_0                -1.832675e-01 1 1  ON 40
 eH2_1                -1.036075e-01 1 1  ON 41
 eH2_2                -6.357600e-02 1 1  ON 42
 eH2_3                -2.732775e-02 1 1  ON 43
 eH2_4                 1.829810e-02 1 1  ON 44
 eH2_5                 3.518869e-02 1 1  ON 45
 eH2_6                 7.840022e-02 1 1  ON 46
 eH2_7                 1.136378e-01 1 1  ON 47
 eH2_8                 9.374938e-02 1 1  ON 48
 eH2_9                 2.630201e-02 1 1  ON 49
ci_001                -4.050558e-02 3 1  ON 50
ci_002                -2.987696e-02 3 1  ON 51
ci_003                -2.525594e-02 3 1  ON 52
ci_004                 2.101475e-02 3 1  ON 53
ci_005                 2.141921e-02 3 1  ON 54
ci_006                -1.922548e-02 3 1  ON 55
ci_007                -1.910967e-02 3 1  ON 56
ci_008                -1.768234e-02 3 1  ON 57
ci_009                -1.816759e-02 3 1  ON 58
ci_010                -1.748799e-02 3 1  ON 59
ci_011                -1.635480e-02 3 1  ON 60
ci_012                -1.634375e-02 3 1  ON 61
ci_013                -1.930121e-02 3 1  ON 62
ci_014                 1.396468e-02 3 1  ON 63
ci_015                 1.370341e-02 3 1  ON 64
ci_016                 1.648853e-02 3 1  ON 65
ci_017                 1.640772e-02 3 1  ON 66
ci_018                 1.287168e-02 3 1  ON 67
ci_019                 1.321410e-02 3 1  ON 68
ci_020                 1.354015e-02 3 1  ON 69
ci_021                 1.339120e-02 3 1  ON 70
ci_022                 1.106937e-02 3 1  ON 71
ci_023                 1.088364e-02 3 1  ON 72
ci_024                 1.198831e-02 3 1  ON 73
ci_025                 1.151575e-02 3 1  ON 74
ci_026                 1.099171e-02 3 1  ON 75
ci_027                 1.159276e-02 3 1  ON 76
ci_028                -1.458186e-02 3 1  ON 77
ci_029                -1.477945e-02 3 1  ON 78
ci_030                -1.119835e-02 3 1  ON 79
ci_031                -1.147623e-02 3 1  ON 80
ci_032                -1.353493e-02 3 1  ON 81
ci_033                 1.084576e-02 3 1  ON 82
ci_034                 1.028336e-02 3 1  ON 83
ci_035                -4.688868e-03 3 1  ON 84
ci_036                -1.036025e-02 3 1  ON 85
ci_037                -1.002269e-02 3 1  ON 86
ci_038                 1.583434e-03 3 1  ON 87
ci_039                 1.483564e-03 3 1  ON 88
ci_040                -4.170417e-03 3 1  ON 89
ci_041                 9.849937e-03 3 1  ON 90
ci_042                 1.014692e-02 3 1  ON 91
ci_043                -3.083475e-03 3 1  ON 92
ci_044                -1.569721e-02 3 1  ON 93
ci_045                -1.746848e-03 3 1  ON 94
ci_046                 5.500517e-03 3 1  ON 95
ci_047                 5.693902e-03 3 1  ON 96
ci_048                -1.194915e-02 3 1  ON 97
ci_049                -1.191324e-02 3 1  ON 98
ci_050                 7.404968e-03 3 1  ON 99
ci_051                 7.649816e-03 3 1  ON 100
ci_052                -6.651632e-03 3 1  ON 101
ci_053                -6.585029e-03 3 1  ON 102
ci_054                -3.294636e-03 3 1  ON 103
ci_055                -3.197936e-03 3 1  ON 104
ci_056                 5.120772e-03 3 1  ON 105
ci_057                 4.372879e-03 3 1  ON 106
ci_058                -6.801377e-03 3 1  ON 107
ci_059                -6.445294e-03 3 1  ON 108
ci_060                 8.329290e-03 3 1  ON 109
ci_061                 8.482401e-03 3 1  ON 110
ci_062                -3.028270e-03 3 1  ON 111
ci_063                -3.165511e-03 3 1  ON 112
ci_064                -2.915711e-03 3 1  ON 113
ci_065                -4.033086e-03 3 1  ON 114
ci_066                 5.782246e-03 3 1  ON 115
ci_067                 5.925572e-03 3 1  ON 116
ci_068                -4.947870e-03 3 1  ON 117
ci_069                -4.628264e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1905
    reference variance = 0.399268
====================================================
  Execution time = 2.0568e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1755e-01
  Total weights = 1.9566e+06
  Execution time = 1.8348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302140099565
                                         uncertainty =       0.002168518378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302140099565
                                         uncertainty =       0.002168518378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388671987
  error estimate for blocks of size 2^( 2) =       0.000398678412
  error estimate for blocks of size 2^( 3) =       0.000407175408
  error estimate for blocks of size 2^( 4) =       0.000413873561
  error estimate for blocks of size 2^( 5) =       0.000418364852
  error estimate for blocks of size 2^( 6) =       0.000420716864
  error estimate for blocks of size 2^( 7) =       0.000421089604

      target function =                  N/A
              le_mean =     -17.216147233940
             les_mean =     296.713273353204
             stat err =       0.000418511220
             autocorr =       1.159438536535
              std dev =       0.549665195004
             le_variance =       0.302131826599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302140048713
                                         uncertainty =       0.002168522976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302140048713
                                         uncertainty =       0.002168522976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388671954
  error estimate for blocks of size 2^( 2) =       0.000398678377
  error estimate for blocks of size 2^( 3) =       0.000407175377
  error estimate for blocks of size 2^( 4) =       0.000413873531
  error estimate for blocks of size 2^( 5) =       0.000418364822
  error estimate for blocks of size 2^( 6) =       0.000420716844
  error estimate for blocks of size 2^( 7) =       0.000421089594

      target function =                  N/A
              le_mean =     -17.216147235420
             les_mean =     296.713274848119
             stat err =       0.000418511198
             autocorr =       1.159438608569
              std dev =       0.549665148226
             le_variance =       0.302131775175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302140074128
                                         uncertainty =       0.002168520677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302140074128
                                         uncertainty =       0.002168520677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388671970
  error estimate for blocks of size 2^( 2) =       0.000398678394
  error estimate for blocks of size 2^( 3) =       0.000407175392
  error estimate for blocks of size 2^( 4) =       0.000413873546
  error estimate for blocks of size 2^( 5) =       0.000418364837
  error estimate for blocks of size 2^( 6) =       0.000420716854
  error estimate for blocks of size 2^( 7) =       0.000421089599

      target function =                  N/A
              le_mean =     -17.216147234680
             les_mean =     296.713274099629
             stat err =       0.000418511209
             autocorr =       1.159438572565
              std dev =       0.549665171605
             le_variance =       0.302131800876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302140096384
                                         uncertainty =       0.002168518665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302140096384
                                         uncertainty =       0.002168518665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388671985
  error estimate for blocks of size 2^( 2) =       0.000398678410
  error estimate for blocks of size 2^( 3) =       0.000407175406
  error estimate for blocks of size 2^( 4) =       0.000413873559
  error estimate for blocks of size 2^( 5) =       0.000418364850
  error estimate for blocks of size 2^( 6) =       0.000420716863
  error estimate for blocks of size 2^( 7) =       0.000421089603

      target function =                  N/A
              le_mean =     -17.216147234032
             les_mean =     296.713273446386
             stat err =       0.000418511219
             autocorr =       1.159438541041
              std dev =       0.549665192078
             le_variance =       0.302131823383


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216147233940        initial
     1.5259e+03     1.5259e+04             5.2948e-07       -17.216147235420  <--
     6.1035e+03     6.1035e+04             1.3237e-07       -17.216147234680
     2.4414e+04     2.4414e+05             3.3093e-08       -17.216147234032

*****************************************************************************
Applying the update for shift_i =   1.5259e+03     and shift_s =   1.5259e+04
*****************************************************************************

  Execution time = 2.9867e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.052133e-01 1 1  ON 0
  uu_1                 4.496521e-02 1 1  ON 1
  uu_2                -4.694842e-02 1 1  ON 2
  uu_3                -9.928743e-02 1 1  ON 3
  uu_4                -1.300214e-01 1 1  ON 4
  uu_5                -1.354293e-01 1 1  ON 5
  uu_6                -1.124484e-01 1 1  ON 6
  uu_7                -3.914527e-02 1 1  ON 7
  uu_8                 1.001573e-01 1 1  ON 8
  uu_9                 1.206275e-01 1 1  ON 9
  ud_0                 3.487452e-01 1 1  ON 10
  ud_1                 9.116361e-02 1 1  ON 11
  ud_2                -1.671339e-02 1 1  ON 12
  ud_3                -7.581006e-02 1 1  ON 13
  ud_4                -1.214658e-01 1 1  ON 14
  ud_5                -1.518191e-01 1 1  ON 15
  ud_6                -1.542885e-01 1 1  ON 16
  ud_7                -1.096705e-01 1 1  ON 17
  ud_8                 4.959691e-03 1 1  ON 18
  ud_9                 9.253548e-02 1 1  ON 19
  eO_0                -7.473656e-01 1 1  ON 20
  eO_1                -4.334698e-01 1 1  ON 21
  eO_2                -3.549273e-02 1 1  ON 22
  eO_3                 2.067963e-01 1 1  ON 23
  eO_4                 2.862810e-01 1 1  ON 24
  eO_5                 3.046195e-01 1 1  ON 25
  eO_6                 2.500149e-01 1 1  ON 26
  eO_7                 1.117581e-01 1 1  ON 27
  eO_8                 2.784038e-02 1 1  ON 28
  eO_9                 1.841214e-02 1 1  ON 29
 eH1_0                -1.820126e-01 1 1  ON 30
 eH1_1                -1.025650e-01 1 1  ON 31
 eH1_2                -6.218794e-02 1 1  ON 32
 eH1_3                -2.596961e-02 1 1  ON 33
 eH1_4                 1.934738e-02 1 1  ON 34
 eH1_5                 3.564684e-02 1 1  ON 35
 eH1_6                 7.727440e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054889e-02 1 1  ON 38
 eH1_9                 2.423146e-02 1 1  ON 39
 eH2_0                -1.832675e-01 1 1  ON 40
 eH2_1                -1.036075e-01 1 1  ON 41
 eH2_2                -6.357598e-02 1 1  ON 42
 eH2_3                -2.732772e-02 1 1  ON 43
 eH2_4                 1.829806e-02 1 1  ON 44
 eH2_5                 3.518868e-02 1 1  ON 45
 eH2_6                 7.840020e-02 1 1  ON 46
 eH2_7                 1.136378e-01 1 1  ON 47
 eH2_8                 9.374941e-02 1 1  ON 48
 eH2_9                 2.630202e-02 1 1  ON 49
ci_001                -4.050553e-02 3 1  ON 50
ci_002                -2.987695e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101478e-02 3 1  ON 53
ci_005                 2.141923e-02 3 1  ON 54
ci_006                -1.922539e-02 3 1  ON 55
ci_007                -1.910961e-02 3 1  ON 56
ci_008                -1.768231e-02 3 1  ON 57
ci_009                -1.816742e-02 3 1  ON 58
ci_010                -1.748801e-02 3 1  ON 59
ci_011                -1.635476e-02 3 1  ON 60
ci_012                -1.634378e-02 3 1  ON 61
ci_013                -1.930113e-02 3 1  ON 62
ci_014                 1.396460e-02 3 1  ON 63
ci_015                 1.370350e-02 3 1  ON 64
ci_016                 1.648857e-02 3 1  ON 65
ci_017                 1.640782e-02 3 1  ON 66
ci_018                 1.287151e-02 3 1  ON 67
ci_019                 1.321406e-02 3 1  ON 68
ci_020                 1.354005e-02 3 1  ON 69
ci_021                 1.339122e-02 3 1  ON 70
ci_022                 1.106951e-02 3 1  ON 71
ci_023                 1.088368e-02 3 1  ON 72
ci_024                 1.198829e-02 3 1  ON 73
ci_025                 1.151569e-02 3 1  ON 74
ci_026                 1.099169e-02 3 1  ON 75
ci_027                 1.159282e-02 3 1  ON 76
ci_028                -1.458185e-02 3 1  ON 77
ci_029                -1.477944e-02 3 1  ON 78
ci_030                -1.119842e-02 3 1  ON 79
ci_031                -1.147615e-02 3 1  ON 80
ci_032                -1.353489e-02 3 1  ON 81
ci_033                 1.084569e-02 3 1  ON 82
ci_034                 1.028324e-02 3 1  ON 83
ci_035                -4.688815e-03 3 1  ON 84
ci_036                -1.036019e-02 3 1  ON 85
ci_037                -1.002263e-02 3 1  ON 86
ci_038                 1.583509e-03 3 1  ON 87
ci_039                 1.483653e-03 3 1  ON 88
ci_040                -4.170370e-03 3 1  ON 89
ci_041                 9.849950e-03 3 1  ON 90
ci_042                 1.014681e-02 3 1  ON 91
ci_043                -3.083390e-03 3 1  ON 92
ci_044                -1.569698e-02 3 1  ON 93
ci_045                -1.746823e-03 3 1  ON 94
ci_046                 5.500625e-03 3 1  ON 95
ci_047                 5.693978e-03 3 1  ON 96
ci_048                -1.194919e-02 3 1  ON 97
ci_049                -1.191331e-02 3 1  ON 98
ci_050                 7.404841e-03 3 1  ON 99
ci_051                 7.649700e-03 3 1  ON 100
ci_052                -6.651612e-03 3 1  ON 101
ci_053                -6.584948e-03 3 1  ON 102
ci_054                -3.294482e-03 3 1  ON 103
ci_055                -3.197961e-03 3 1  ON 104
ci_056                 5.120658e-03 3 1  ON 105
ci_057                 4.372886e-03 3 1  ON 106
ci_058                -6.801330e-03 3 1  ON 107
ci_059                -6.445314e-03 3 1  ON 108
ci_060                 8.329364e-03 3 1  ON 109
ci_061                 8.482455e-03 3 1  ON 110
ci_062                -3.028322e-03 3 1  ON 111
ci_063                -3.165516e-03 3 1  ON 112
ci_064                -2.915764e-03 3 1  ON 113
ci_065                -4.033114e-03 3 1  ON 114
ci_066                 5.782179e-03 3 1  ON 115
ci_067                 5.925674e-03 3 1  ON 116
ci_068                -4.947869e-03 3 1  ON 117
ci_069                -4.628248e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6563e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2044
    reference variance = 0.202724
====================================================
  Execution time = 2.0617e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1360e-01
  Total weights = 1.956501173e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300257590754
                                         uncertainty =       0.002211476679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300257590754
                                         uncertainty =       0.002211476679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387456944
  error estimate for blocks of size 2^( 2) =       0.000397651074
  error estimate for blocks of size 2^( 3) =       0.000406730978
  error estimate for blocks of size 2^( 4) =       0.000413777943
  error estimate for blocks of size 2^( 5) =       0.000418270536
  error estimate for blocks of size 2^( 6) =       0.000420935828
  error estimate for blocks of size 2^( 7) =       0.000422863904

      target function =                  N/A
              le_mean =     -17.217252063446
             les_mean =     296.747370467568
             stat err =       0.000418962053
             autocorr =       1.169236815611
              std dev =       0.547946864612
             le_variance =       0.300245766438


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721725206345e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217252063489       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217252069486       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217252071450       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217252073191       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217252076433       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217252079408       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217252079902       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217252079797       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217252079353       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217252078958       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+02 is 2.397874e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217252063489       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217252064989       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217252065480       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217252065917       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217252066726       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217252067471       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217252067593       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217252067568       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217252067453       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217252067357       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+03 is 5.995715e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217252063489       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217252063864       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217252063987       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217252064095       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217252064321       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217252064487       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217252064528       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217252064481       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217252064491       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217252064445       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+03 is 1.498993e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192049 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6655e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.052134e-01 1 1  ON 0
  uu_1                 4.496536e-02 1 1  ON 1
  uu_2                -4.694837e-02 1 1  ON 2
  uu_3                -9.928738e-02 1 1  ON 3
  uu_4                -1.300215e-01 1 1  ON 4
  uu_5                -1.354294e-01 1 1  ON 5
  uu_6                -1.124485e-01 1 1  ON 6
  uu_7                -3.914540e-02 1 1  ON 7
  uu_8                 1.001572e-01 1 1  ON 8
  uu_9                 1.206275e-01 1 1  ON 9
  ud_0                 3.487454e-01 1 1  ON 10
  ud_1                 9.116374e-02 1 1  ON 11
  ud_2                -1.671339e-02 1 1  ON 12
  ud_3                -7.581005e-02 1 1  ON 13
  ud_4                -1.214659e-01 1 1  ON 14
  ud_5                -1.518191e-01 1 1  ON 15
  ud_6                -1.542886e-01 1 1  ON 16
  ud_7                -1.096706e-01 1 1  ON 17
  ud_8                 4.959598e-03 1 1  ON 18
  ud_9                 9.253547e-02 1 1  ON 19
  eO_0                -7.473662e-01 1 1  ON 20
  eO_1                -4.334701e-01 1 1  ON 21
  eO_2                -3.549278e-02 1 1  ON 22
  eO_3                 2.067965e-01 1 1  ON 23
  eO_4                 2.862815e-01 1 1  ON 24
  eO_5                 3.046196e-01 1 1  ON 25
  eO_6                 2.500149e-01 1 1  ON 26
  eO_7                 1.117582e-01 1 1  ON 27
  eO_8                 2.784039e-02 1 1  ON 28
  eO_9                 1.841215e-02 1 1  ON 29
 eH1_0                -1.820126e-01 1 1  ON 30
 eH1_1                -1.025651e-01 1 1  ON 31
 eH1_2                -6.218794e-02 1 1  ON 32
 eH1_3                -2.596959e-02 1 1  ON 33
 eH1_4                 1.934739e-02 1 1  ON 34
 eH1_5                 3.564685e-02 1 1  ON 35
 eH1_6                 7.727442e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054893e-02 1 1  ON 38
 eH1_9                 2.423147e-02 1 1  ON 39
 eH2_0                -1.832676e-01 1 1  ON 40
 eH2_1                -1.036075e-01 1 1  ON 41
 eH2_2                -6.357591e-02 1 1  ON 42
 eH2_3                -2.732771e-02 1 1  ON 43
 eH2_4                 1.829807e-02 1 1  ON 44
 eH2_5                 3.518873e-02 1 1  ON 45
 eH2_6                 7.840018e-02 1 1  ON 46
 eH2_7                 1.136378e-01 1 1  ON 47
 eH2_8                 9.374944e-02 1 1  ON 48
 eH2_9                 2.630203e-02 1 1  ON 49
ci_001                -4.050555e-02 3 1  ON 50
ci_002                -2.987695e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101488e-02 3 1  ON 53
ci_005                 2.141925e-02 3 1  ON 54
ci_006                -1.922540e-02 3 1  ON 55
ci_007                -1.910958e-02 3 1  ON 56
ci_008                -1.768227e-02 3 1  ON 57
ci_009                -1.816726e-02 3 1  ON 58
ci_010                -1.748794e-02 3 1  ON 59
ci_011                -1.635478e-02 3 1  ON 60
ci_012                -1.634361e-02 3 1  ON 61
ci_013                -1.930115e-02 3 1  ON 62
ci_014                 1.396470e-02 3 1  ON 63
ci_015                 1.370334e-02 3 1  ON 64
ci_016                 1.648860e-02 3 1  ON 65
ci_017                 1.640783e-02 3 1  ON 66
ci_018                 1.287147e-02 3 1  ON 67
ci_019                 1.321396e-02 3 1  ON 68
ci_020                 1.354010e-02 3 1  ON 69
ci_021                 1.339118e-02 3 1  ON 70
ci_022                 1.106955e-02 3 1  ON 71
ci_023                 1.088368e-02 3 1  ON 72
ci_024                 1.198821e-02 3 1  ON 73
ci_025                 1.151575e-02 3 1  ON 74
ci_026                 1.099164e-02 3 1  ON 75
ci_027                 1.159276e-02 3 1  ON 76
ci_028                -1.458196e-02 3 1  ON 77
ci_029                -1.477953e-02 3 1  ON 78
ci_030                -1.119849e-02 3 1  ON 79
ci_031                -1.147610e-02 3 1  ON 80
ci_032                -1.353494e-02 3 1  ON 81
ci_033                 1.084557e-02 3 1  ON 82
ci_034                 1.028305e-02 3 1  ON 83
ci_035                -4.688773e-03 3 1  ON 84
ci_036                -1.036027e-02 3 1  ON 85
ci_037                -1.002270e-02 3 1  ON 86
ci_038                 1.583589e-03 3 1  ON 87
ci_039                 1.483603e-03 3 1  ON 88
ci_040                -4.170325e-03 3 1  ON 89
ci_041                 9.849995e-03 3 1  ON 90
ci_042                 1.014671e-02 3 1  ON 91
ci_043                -3.083375e-03 3 1  ON 92
ci_044                -1.569672e-02 3 1  ON 93
ci_045                -1.746826e-03 3 1  ON 94
ci_046                 5.500570e-03 3 1  ON 95
ci_047                 5.693776e-03 3 1  ON 96
ci_048                -1.194910e-02 3 1  ON 97
ci_049                -1.191336e-02 3 1  ON 98
ci_050                 7.404798e-03 3 1  ON 99
ci_051                 7.649729e-03 3 1  ON 100
ci_052                -6.651576e-03 3 1  ON 101
ci_053                -6.584969e-03 3 1  ON 102
ci_054                -3.294433e-03 3 1  ON 103
ci_055                -3.197897e-03 3 1  ON 104
ci_056                 5.120594e-03 3 1  ON 105
ci_057                 4.372897e-03 3 1  ON 106
ci_058                -6.801347e-03 3 1  ON 107
ci_059                -6.445144e-03 3 1  ON 108
ci_060                 8.329365e-03 3 1  ON 109
ci_061                 8.482389e-03 3 1  ON 110
ci_062                -3.028435e-03 3 1  ON 111
ci_063                -3.165569e-03 3 1  ON 112
ci_064                -2.915951e-03 3 1  ON 113
ci_065                -4.033112e-03 3 1  ON 114
ci_066                 5.782250e-03 3 1  ON 115
ci_067                 5.925521e-03 3 1  ON 116
ci_068                -4.947906e-03 3 1  ON 117
ci_069                -4.628143e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2228
    reference variance = 0.124503
====================================================
  Execution time = 2.0554e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1937e-01
  Total weights = 1.9565e+06
  Execution time = 1.8329e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302114989879
                                         uncertainty =       0.002915533100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302114989879
                                         uncertainty =       0.002915533100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388661371
  error estimate for blocks of size 2^( 2) =       0.000398619214
  error estimate for blocks of size 2^( 3) =       0.000407254614
  error estimate for blocks of size 2^( 4) =       0.000414375951
  error estimate for blocks of size 2^( 5) =       0.000418803235
  error estimate for blocks of size 2^( 6) =       0.000419417848
  error estimate for blocks of size 2^( 7) =       0.000420177850

      target function =                  N/A
              le_mean =     -17.216664437680
             les_mean =     296.732902588300
             stat err =       0.000418193721
             autocorr =       1.157743253663
              std dev =       0.549650182120
             le_variance =       0.302115322705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302114114107
                                         uncertainty =       0.002915606680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302114114107
                                         uncertainty =       0.002915606680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388660809
  error estimate for blocks of size 2^( 2) =       0.000398618661
  error estimate for blocks of size 2^( 3) =       0.000407254067
  error estimate for blocks of size 2^( 4) =       0.000414375429
  error estimate for blocks of size 2^( 5) =       0.000418802721
  error estimate for blocks of size 2^( 6) =       0.000419417377
  error estimate for blocks of size 2^( 7) =       0.000420177374

      target function =                  N/A
              le_mean =     -17.216664461046
             les_mean =     296.733021587123
             stat err =       0.000418193225
             autocorr =       1.157743855574
              std dev =       0.549649387752
             le_variance =       0.302114449456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302114551670
                                         uncertainty =       0.002915569912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302114551670
                                         uncertainty =       0.002915569912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388661090
  error estimate for blocks of size 2^( 2) =       0.000398618937
  error estimate for blocks of size 2^( 3) =       0.000407254340
  error estimate for blocks of size 2^( 4) =       0.000414375690
  error estimate for blocks of size 2^( 5) =       0.000418802978
  error estimate for blocks of size 2^( 6) =       0.000419417612
  error estimate for blocks of size 2^( 7) =       0.000420177611

      target function =                  N/A
              le_mean =     -17.216664449259
             les_mean =     296.732921541754
             stat err =       0.000418193473
             autocorr =       1.157743553371
              std dev =       0.549649784643
             le_variance =       0.302114885758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302114935087
                                         uncertainty =       0.002915537701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302114935087
                                         uncertainty =       0.002915537701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388661336
  error estimate for blocks of size 2^( 2) =       0.000398619179
  error estimate for blocks of size 2^( 3) =       0.000407254580
  error estimate for blocks of size 2^( 4) =       0.000414375919
  error estimate for blocks of size 2^( 5) =       0.000418803203
  error estimate for blocks of size 2^( 6) =       0.000419417819
  error estimate for blocks of size 2^( 7) =       0.000420177820

      target function =                  N/A
              le_mean =     -17.216664439123
             les_mean =     296.732903929642
             stat err =       0.000418193690
             autocorr =       1.157743291068
              std dev =       0.549650132421
             le_variance =       0.302115268071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216664437680        initial
     3.8147e+02     3.8147e+03             2.3979e-06       -17.216664461046  <--
     1.5259e+03     1.5259e+04             5.9957e-07       -17.216664449259
     6.1035e+03     6.1035e+04             1.4990e-07       -17.216664439123

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 2.9848e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581001e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959321e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334709e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862829e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816675e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159258e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002294e-02 3 1  ON 86
ci_038                 1.583828e-03 3 1  ON 87
ci_039                 1.483454e-03 3 1  ON 88
ci_040                -4.170189e-03 3 1  ON 89
ci_041                 9.850130e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083330e-03 3 1  ON 92
ci_044                -1.569597e-02 3 1  ON 93
ci_045                -1.746838e-03 3 1  ON 94
ci_046                 5.500404e-03 3 1  ON 95
ci_047                 5.693170e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404667e-03 3 1  ON 99
ci_051                 7.649816e-03 3 1  ON 100
ci_052                -6.651469e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197703e-03 3 1  ON 104
ci_056                 5.120402e-03 3 1  ON 105
ci_057                 4.372930e-03 3 1  ON 106
ci_058                -6.801398e-03 3 1  ON 107
ci_059                -6.444635e-03 3 1  ON 108
ci_060                 8.329368e-03 3 1  ON 109
ci_061                 8.482192e-03 3 1  ON 110
ci_062                -3.028774e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916513e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782464e-03 3 1  ON 115
ci_067                 5.925064e-03 3 1  ON 116
ci_068                -4.948017e-03 3 1  ON 117
ci_069                -4.627828e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6509e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2467
    reference variance = 0.215871
====================================================
  Execution time = 2.0710e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1857e-01
  Total weights = 1.956911295e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9807e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299804640293
                                         uncertainty =       0.002756759442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299804640293
                                         uncertainty =       0.002756759442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387166495
  error estimate for blocks of size 2^( 2) =       0.000396951719
  error estimate for blocks of size 2^( 3) =       0.000405729817
  error estimate for blocks of size 2^( 4) =       0.000411795379
  error estimate for blocks of size 2^( 5) =       0.000417257710
  error estimate for blocks of size 2^( 6) =       0.000420182071
  error estimate for blocks of size 2^( 7) =       0.000422375304

      target function =                  N/A
              le_mean =     -17.216407727001
             les_mean =     296.723263093259
             stat err =       0.000417902616
             autocorr =       1.165077046043
              std dev =       0.547536108261
             le_variance =       0.299795789850


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721640772700e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216407727047       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216407732582       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216407743649       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216407756960       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216407756829       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216407776585       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216407767805       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216407770145       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216407767713       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216407767629       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+01 is 7.256569e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216407727047       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216407728434       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216407731206       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216407734539       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216407734512       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216407739457       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216407737260       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216407737846       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216407737235       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216407737212       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+02 is 1.813960e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216407727047       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216407727394       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216407728088       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216407728921       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216407728915       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216407730151       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216407729603       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216407729748       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216407729599       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216407729591       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+03 is 4.534787e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195985 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6704e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.052146e-01 1 1  ON 0
  uu_1                 4.496590e-02 1 1  ON 1
  uu_2                -4.694829e-02 1 1  ON 2
  uu_3                -9.928717e-02 1 1  ON 3
  uu_4                -1.300225e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124489e-01 1 1  ON 6
  uu_7                -3.914604e-02 1 1  ON 7
  uu_8                 1.001569e-01 1 1  ON 8
  uu_9                 1.206277e-01 1 1  ON 9
  ud_0                 3.487469e-01 1 1  ON 10
  ud_1                 9.116441e-02 1 1  ON 11
  ud_2                -1.671349e-02 1 1  ON 12
  ud_3                -7.580993e-02 1 1  ON 13
  ud_4                -1.214666e-01 1 1  ON 14
  ud_5                -1.518198e-01 1 1  ON 15
  ud_6                -1.542887e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.958960e-03 1 1  ON 18
  ud_9                 9.253538e-02 1 1  ON 19
  eO_0                -7.473698e-01 1 1  ON 20
  eO_1                -4.334724e-01 1 1  ON 21
  eO_2                -3.549350e-02 1 1  ON 22
  eO_3                 2.067983e-01 1 1  ON 23
  eO_4                 2.862847e-01 1 1  ON 24
  eO_5                 3.046202e-01 1 1  ON 25
  eO_6                 2.500152e-01 1 1  ON 26
  eO_7                 1.117587e-01 1 1  ON 27
  eO_8                 2.784046e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820126e-01 1 1  ON 30
 eH1_1                -1.025651e-01 1 1  ON 31
 eH1_2                -6.218808e-02 1 1  ON 32
 eH1_3                -2.596965e-02 1 1  ON 33
 eH1_4                 1.934727e-02 1 1  ON 34
 eH1_5                 3.564677e-02 1 1  ON 35
 eH1_6                 7.727457e-02 1 1  ON 36
 eH1_7                 1.104604e-01 1 1  ON 37
 eH1_8                 9.054919e-02 1 1  ON 38
 eH1_9                 2.423155e-02 1 1  ON 39
 eH2_0                -1.832680e-01 1 1  ON 40
 eH2_1                -1.036080e-01 1 1  ON 41
 eH2_2                -6.357556e-02 1 1  ON 42
 eH2_3                -2.732767e-02 1 1  ON 43
 eH2_4                 1.829813e-02 1 1  ON 44
 eH2_5                 3.518900e-02 1 1  ON 45
 eH2_6                 7.840021e-02 1 1  ON 46
 eH2_7                 1.136376e-01 1 1  ON 47
 eH2_8                 9.374965e-02 1 1  ON 48
 eH2_9                 2.630210e-02 1 1  ON 49
ci_001                -4.050545e-02 3 1  ON 50
ci_002                -2.987755e-02 3 1  ON 51
ci_003                -2.525550e-02 3 1  ON 52
ci_004                 2.101502e-02 3 1  ON 53
ci_005                 2.141914e-02 3 1  ON 54
ci_006                -1.922500e-02 3 1  ON 55
ci_007                -1.910930e-02 3 1  ON 56
ci_008                -1.768204e-02 3 1  ON 57
ci_009                -1.816534e-02 3 1  ON 58
ci_010                -1.748744e-02 3 1  ON 59
ci_011                -1.635539e-02 3 1  ON 60
ci_012                -1.634392e-02 3 1  ON 61
ci_013                -1.930095e-02 3 1  ON 62
ci_014                 1.396465e-02 3 1  ON 63
ci_015                 1.370286e-02 3 1  ON 64
ci_016                 1.648873e-02 3 1  ON 65
ci_017                 1.640814e-02 3 1  ON 66
ci_018                 1.287128e-02 3 1  ON 67
ci_019                 1.321325e-02 3 1  ON 68
ci_020                 1.354049e-02 3 1  ON 69
ci_021                 1.339139e-02 3 1  ON 70
ci_022                 1.106981e-02 3 1  ON 71
ci_023                 1.088403e-02 3 1  ON 72
ci_024                 1.198783e-02 3 1  ON 73
ci_025                 1.151602e-02 3 1  ON 74
ci_026                 1.099159e-02 3 1  ON 75
ci_027                 1.159276e-02 3 1  ON 76
ci_028                -1.458217e-02 3 1  ON 77
ci_029                -1.477974e-02 3 1  ON 78
ci_030                -1.119893e-02 3 1  ON 79
ci_031                -1.147565e-02 3 1  ON 80
ci_032                -1.353488e-02 3 1  ON 81
ci_033                 1.084523e-02 3 1  ON 82
ci_034                 1.028245e-02 3 1  ON 83
ci_035                -4.688490e-03 3 1  ON 84
ci_036                -1.035935e-02 3 1  ON 85
ci_037                -1.002304e-02 3 1  ON 86
ci_038                 1.583734e-03 3 1  ON 87
ci_039                 1.483714e-03 3 1  ON 88
ci_040                -4.170043e-03 3 1  ON 89
ci_041                 9.850336e-03 3 1  ON 90
ci_042                 1.014657e-02 3 1  ON 91
ci_043                -3.083063e-03 3 1  ON 92
ci_044                -1.569550e-02 3 1  ON 93
ci_045                -1.746644e-03 3 1  ON 94
ci_046                 5.500690e-03 3 1  ON 95
ci_047                 5.693097e-03 3 1  ON 96
ci_048                -1.194893e-02 3 1  ON 97
ci_049                -1.191352e-02 3 1  ON 98
ci_050                 7.404320e-03 3 1  ON 99
ci_051                 7.649654e-03 3 1  ON 100
ci_052                -6.651493e-03 3 1  ON 101
ci_053                -6.584886e-03 3 1  ON 102
ci_054                -3.294674e-03 3 1  ON 103
ci_055                -3.197745e-03 3 1  ON 104
ci_056                 5.119947e-03 3 1  ON 105
ci_057                 4.372904e-03 3 1  ON 106
ci_058                -6.802047e-03 3 1  ON 107
ci_059                -6.444690e-03 3 1  ON 108
ci_060                 8.329896e-03 3 1  ON 109
ci_061                 8.482114e-03 3 1  ON 110
ci_062                -3.028922e-03 3 1  ON 111
ci_063                -3.165678e-03 3 1  ON 112
ci_064                -2.916457e-03 3 1  ON 113
ci_065                -4.033320e-03 3 1  ON 114
ci_066                 5.782282e-03 3 1  ON 115
ci_067                 5.924506e-03 3 1  ON 116
ci_068                -4.948078e-03 3 1  ON 117
ci_069                -4.627890e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2159
    reference variance = 0.216096
====================================================
  Execution time = 2.0461e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1546e-01
  Total weights = 1.9564e+06
  Execution time = 1.8276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299167493664
                                         uncertainty =       0.001951425984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299167493664
                                         uncertainty =       0.001951425984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386751348
  error estimate for blocks of size 2^( 2) =       0.000396721134
  error estimate for blocks of size 2^( 3) =       0.000405777042
  error estimate for blocks of size 2^( 4) =       0.000412473377
  error estimate for blocks of size 2^( 5) =       0.000416824388
  error estimate for blocks of size 2^( 6) =       0.000418255134
  error estimate for blocks of size 2^( 7) =       0.000419881948

      target function =                  N/A
              le_mean =     -17.215966050563
             les_mean =     296.704946498062
             stat err =       0.000416858712
             autocorr =       1.161753773450
              std dev =       0.546949001679
             le_variance =       0.299153210438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299170781020
                                         uncertainty =       0.001951488478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299170781020
                                         uncertainty =       0.001951488478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386753484
  error estimate for blocks of size 2^( 2) =       0.000396723167
  error estimate for blocks of size 2^( 3) =       0.000405778964
  error estimate for blocks of size 2^( 4) =       0.000412475307
  error estimate for blocks of size 2^( 5) =       0.000416826227
  error estimate for blocks of size 2^( 6) =       0.000418257062
  error estimate for blocks of size 2^( 7) =       0.000419884163

      target function =                  N/A
              le_mean =     -17.215966040291
             les_mean =     296.704947792158
             stat err =       0.000416860690
             autocorr =       1.161751967996
              std dev =       0.546952022149
             le_variance =       0.299156514533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299169140762
                                         uncertainty =       0.001951457302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299169140762
                                         uncertainty =       0.001951457302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386752418
  error estimate for blocks of size 2^( 2) =       0.000396722153
  error estimate for blocks of size 2^( 3) =       0.000405778005
  error estimate for blocks of size 2^( 4) =       0.000412474344
  error estimate for blocks of size 2^( 5) =       0.000416825309
  error estimate for blocks of size 2^( 6) =       0.000418256100
  error estimate for blocks of size 2^( 7) =       0.000419883058

      target function =                  N/A
              le_mean =     -17.215966045298
             les_mean =     296.704947112161
             stat err =       0.000416859703
             autocorr =       1.161752869005
              std dev =       0.546950515056
             le_variance =       0.299154865920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299167699597
                                         uncertainty =       0.001951429901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299167699597
                                         uncertainty =       0.001951429901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386751482
  error estimate for blocks of size 2^( 2) =       0.000396721261
  error estimate for blocks of size 2^( 3) =       0.000405777163
  error estimate for blocks of size 2^( 4) =       0.000412473498
  error estimate for blocks of size 2^( 5) =       0.000416824503
  error estimate for blocks of size 2^( 6) =       0.000418255255
  error estimate for blocks of size 2^( 7) =       0.000419882087

      target function =                  N/A
              le_mean =     -17.215966049894
             les_mean =     296.704946571032
             stat err =       0.000416858836
             autocorr =       1.161753660363
              std dev =       0.546949190894
             le_variance =       0.299153417420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215966050563        initial  <--
     9.5367e+01     9.5367e+02             7.2566e-06       -17.215966040291
     3.8147e+02     3.8147e+03             1.8140e-06       -17.215966045298
     1.5259e+03     1.5259e+04             4.5348e-07       -17.215966049894

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7140
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581001e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959321e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334709e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862829e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816675e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159258e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002294e-02 3 1  ON 86
ci_038                 1.583828e-03 3 1  ON 87
ci_039                 1.483454e-03 3 1  ON 88
ci_040                -4.170189e-03 3 1  ON 89
ci_041                 9.850130e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083330e-03 3 1  ON 92
ci_044                -1.569597e-02 3 1  ON 93
ci_045                -1.746838e-03 3 1  ON 94
ci_046                 5.500404e-03 3 1  ON 95
ci_047                 5.693170e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404667e-03 3 1  ON 99
ci_051                 7.649816e-03 3 1  ON 100
ci_052                -6.651469e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197703e-03 3 1  ON 104
ci_056                 5.120402e-03 3 1  ON 105
ci_057                 4.372930e-03 3 1  ON 106
ci_058                -6.801398e-03 3 1  ON 107
ci_059                -6.444635e-03 3 1  ON 108
ci_060                 8.329368e-03 3 1  ON 109
ci_061                 8.482192e-03 3 1  ON 110
ci_062                -3.028774e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916513e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782464e-03 3 1  ON 115
ci_067                 5.925064e-03 3 1  ON 116
ci_068                -4.948017e-03 3 1  ON 117
ci_069                -4.627828e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6424e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2018
    reference variance = 0.278771
====================================================
  Execution time = 2.1193e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1344e-01
  Total weights = 1.956674735e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0619e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299714017279
                                         uncertainty =       0.002659201986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299714017279
                                         uncertainty =       0.002659201986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387115867
  error estimate for blocks of size 2^( 2) =       0.000397207308
  error estimate for blocks of size 2^( 3) =       0.000405821562
  error estimate for blocks of size 2^( 4) =       0.000412307858
  error estimate for blocks of size 2^( 5) =       0.000417122136
  error estimate for blocks of size 2^( 6) =       0.000419526051
  error estimate for blocks of size 2^( 7) =       0.000420408839

      target function =                  N/A
              le_mean =     -17.216470680916
             les_mean =     296.720307033838
             stat err =       0.000417341221
             autocorr =       1.162252850040
              std dev =       0.547464509751
             le_variance =       0.299717389437


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647068092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216470680987       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216470685690       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216470684605       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216470683248       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216470684782       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216470684151       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216470684536       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216470684618       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216470684702       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+02 is 8.159735e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216470680987       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216470682163       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216470681892       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216470681552       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216470681936       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216470681778       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216470681873       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216470681893       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216470681901       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+03 is 2.039965e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216470680987       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216470681281       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216470681213       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216470681130       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216470681226       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216470681203       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216470681243       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216470681203       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216470681216       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+04 is 5.099933e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199341 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7267e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.052137e-01 1 1  ON 0
  uu_1                 4.496584e-02 1 1  ON 1
  uu_2                -4.694817e-02 1 1  ON 2
  uu_3                -9.928723e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124489e-01 1 1  ON 6
  uu_7                -3.914581e-02 1 1  ON 7
  uu_8                 1.001570e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116415e-02 1 1  ON 11
  ud_2                -1.671342e-02 1 1  ON 12
  ud_3                -7.581003e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959282e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473682e-01 1 1  ON 20
  eO_1                -4.334711e-01 1 1  ON 21
  eO_2                -3.549296e-02 1 1  ON 22
  eO_3                 2.067974e-01 1 1  ON 23
  eO_4                 2.862831e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596952e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727448e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054905e-02 1 1  ON 38
 eH1_9                 2.423151e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829810e-02 1 1  ON 44
 eH2_5                 3.518886e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374954e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050562e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525598e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141930e-02 3 1  ON 54
ci_006                -1.922544e-02 3 1  ON 55
ci_007                -1.910949e-02 3 1  ON 56
ci_008                -1.768214e-02 3 1  ON 57
ci_009                -1.816671e-02 3 1  ON 58
ci_010                -1.748765e-02 3 1  ON 59
ci_011                -1.635477e-02 3 1  ON 60
ci_012                -1.634306e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396494e-02 3 1  ON 63
ci_015                 1.370287e-02 3 1  ON 64
ci_016                 1.648871e-02 3 1  ON 65
ci_017                 1.640792e-02 3 1  ON 66
ci_018                 1.287131e-02 3 1  ON 67
ci_019                 1.321362e-02 3 1  ON 68
ci_020                 1.354026e-02 3 1  ON 69
ci_021                 1.339101e-02 3 1  ON 70
ci_022                 1.106971e-02 3 1  ON 71
ci_023                 1.088368e-02 3 1  ON 72
ci_024                 1.198797e-02 3 1  ON 73
ci_025                 1.151593e-02 3 1  ON 74
ci_026                 1.099154e-02 3 1  ON 75
ci_027                 1.159250e-02 3 1  ON 76
ci_028                -1.458221e-02 3 1  ON 77
ci_029                -1.477976e-02 3 1  ON 78
ci_030                -1.119874e-02 3 1  ON 79
ci_031                -1.147588e-02 3 1  ON 80
ci_032                -1.353517e-02 3 1  ON 81
ci_033                 1.084514e-02 3 1  ON 82
ci_034                 1.028244e-02 3 1  ON 83
ci_035                -4.688623e-03 3 1  ON 84
ci_036                -1.036055e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583835e-03 3 1  ON 87
ci_039                 1.483460e-03 3 1  ON 88
ci_040                -4.170180e-03 3 1  ON 89
ci_041                 9.850141e-03 3 1  ON 90
ci_042                 1.014639e-02 3 1  ON 91
ci_043                -3.083352e-03 3 1  ON 92
ci_044                -1.569594e-02 3 1  ON 93
ci_045                -1.746842e-03 3 1  ON 94
ci_046                 5.500410e-03 3 1  ON 95
ci_047                 5.693147e-03 3 1  ON 96
ci_048                -1.194881e-02 3 1  ON 97
ci_049                -1.191352e-02 3 1  ON 98
ci_050                 7.404734e-03 3 1  ON 99
ci_051                 7.649840e-03 3 1  ON 100
ci_052                -6.651483e-03 3 1  ON 101
ci_053                -6.584983e-03 3 1  ON 102
ci_054                -3.294300e-03 3 1  ON 103
ci_055                -3.197719e-03 3 1  ON 104
ci_056                 5.120338e-03 3 1  ON 105
ci_057                 4.372969e-03 3 1  ON 106
ci_058                -6.801370e-03 3 1  ON 107
ci_059                -6.444623e-03 3 1  ON 108
ci_060                 8.329340e-03 3 1  ON 109
ci_061                 8.482250e-03 3 1  ON 110
ci_062                -3.028729e-03 3 1  ON 111
ci_063                -3.165735e-03 3 1  ON 112
ci_064                -2.916511e-03 3 1  ON 113
ci_065                -4.033121e-03 3 1  ON 114
ci_066                 5.782440e-03 3 1  ON 115
ci_067                 5.925028e-03 3 1  ON 116
ci_068                -4.947970e-03 3 1  ON 117
ci_069                -4.627822e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2293
    reference variance = 0.162979
====================================================
  Execution time = 2.0537e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0725e-01
  Total weights = 1.9564e+06
  Execution time = 1.8339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294475746916
                                         uncertainty =       0.001802228322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294475746916
                                         uncertainty =       0.001802228322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383882124
  error estimate for blocks of size 2^( 2) =       0.000393960777
  error estimate for blocks of size 2^( 3) =       0.000403236860
  error estimate for blocks of size 2^( 4) =       0.000410186709
  error estimate for blocks of size 2^( 5) =       0.000414781694
  error estimate for blocks of size 2^( 6) =       0.000416024653
  error estimate for blocks of size 2^( 7) =       0.000417191055

      target function =                  N/A
              le_mean =     -17.216145463398
             les_mean =     296.702913904232
             stat err =       0.000414546028
             autocorr =       1.166137434893
              std dev =       0.542891306611
             le_variance =       0.294730970794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294475779963
                                         uncertainty =       0.001802230116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294475779963
                                         uncertainty =       0.001802230116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383882141
  error estimate for blocks of size 2^( 2) =       0.000393960798
  error estimate for blocks of size 2^( 3) =       0.000403236882
  error estimate for blocks of size 2^( 4) =       0.000410186734
  error estimate for blocks of size 2^( 5) =       0.000414781735
  error estimate for blocks of size 2^( 6) =       0.000416024706
  error estimate for blocks of size 2^( 7) =       0.000417191104

      target function =                  N/A
              le_mean =     -17.216145462675
             les_mean =     296.702913813239
             stat err =       0.000414546070
             autocorr =       1.166137570368
              std dev =       0.542891330029
             le_variance =       0.294730996221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294475763426
                                         uncertainty =       0.001802229220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294475763426
                                         uncertainty =       0.001802229220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383882133
  error estimate for blocks of size 2^( 2) =       0.000393960788
  error estimate for blocks of size 2^( 3) =       0.000403236871
  error estimate for blocks of size 2^( 4) =       0.000410186721
  error estimate for blocks of size 2^( 5) =       0.000414781715
  error estimate for blocks of size 2^( 6) =       0.000416024679
  error estimate for blocks of size 2^( 7) =       0.000417191080

      target function =                  N/A
              le_mean =     -17.216145463035
             les_mean =     296.702913858536
             stat err =       0.000414546049
             autocorr =       1.166137502652
              std dev =       0.542891318307
             le_variance =       0.294730983493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294475748979
                                         uncertainty =       0.001802228435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294475748979
                                         uncertainty =       0.001802228435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383882125
  error estimate for blocks of size 2^( 2) =       0.000393960778
  error estimate for blocks of size 2^( 3) =       0.000403236862
  error estimate for blocks of size 2^( 4) =       0.000410186710
  error estimate for blocks of size 2^( 5) =       0.000414781697
  error estimate for blocks of size 2^( 6) =       0.000416024656
  error estimate for blocks of size 2^( 7) =       0.000417191058

      target function =                  N/A
              le_mean =     -17.216145463352
             les_mean =     296.702913898500
             stat err =       0.000414546030
             autocorr =       1.166137443371
              std dev =       0.542891308073
             le_variance =       0.294730972381


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216145463398        initial  <--
     9.5367e+02     9.5367e+03             8.1597e-07       -17.216145462675
     3.8147e+03     3.8147e+04             2.0400e-07       -17.216145463035
     1.5259e+04     1.5259e+05             5.0999e-08       -17.216145463352

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8159
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581001e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959321e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334709e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862829e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816675e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159258e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002294e-02 3 1  ON 86
ci_038                 1.583828e-03 3 1  ON 87
ci_039                 1.483454e-03 3 1  ON 88
ci_040                -4.170189e-03 3 1  ON 89
ci_041                 9.850130e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083330e-03 3 1  ON 92
ci_044                -1.569597e-02 3 1  ON 93
ci_045                -1.746838e-03 3 1  ON 94
ci_046                 5.500404e-03 3 1  ON 95
ci_047                 5.693170e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404667e-03 3 1  ON 99
ci_051                 7.649816e-03 3 1  ON 100
ci_052                -6.651469e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197703e-03 3 1  ON 104
ci_056                 5.120402e-03 3 1  ON 105
ci_057                 4.372930e-03 3 1  ON 106
ci_058                -6.801398e-03 3 1  ON 107
ci_059                -6.444635e-03 3 1  ON 108
ci_060                 8.329368e-03 3 1  ON 109
ci_061                 8.482192e-03 3 1  ON 110
ci_062                -3.028774e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916513e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782464e-03 3 1  ON 115
ci_067                 5.925064e-03 3 1  ON 116
ci_068                -4.948017e-03 3 1  ON 117
ci_069                -4.627828e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7090e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2044
    reference variance = 0.199157
====================================================
  Execution time = 2.2735e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1733e-01
  Total weights = 1.956643469e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0816e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301991919083
                                         uncertainty =       0.002179442009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301991919083
                                         uncertainty =       0.002179442009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388601544
  error estimate for blocks of size 2^( 2) =       0.000398590414
  error estimate for blocks of size 2^( 3) =       0.000407950634
  error estimate for blocks of size 2^( 4) =       0.000415308550
  error estimate for blocks of size 2^( 5) =       0.000418019584
  error estimate for blocks of size 2^( 6) =       0.000420578066
  error estimate for blocks of size 2^( 7) =       0.000421424056

      target function =                  N/A
              le_mean =     -17.217109906076
             les_mean =     296.746199731112
             stat err =       0.000418832564
             autocorr =       1.161640746486
              std dev =       0.549565574253
             le_variance =       0.302022320404


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721710990608e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217109906123       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217109906537       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217109906537       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217109906603       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217109906874       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217109906803       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217109906824       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217109906796       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217109906798       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217109906795       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+03 is 8.899508e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217109906123       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217109906227       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217109906227       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217109906244       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217109906343       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217109906336       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217109906296       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217109906306       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217109906278       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217109906272       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+04 is 2.224882e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217109906123       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217109906149       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217109906149       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217109906154       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217109906175       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217109906196       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217109906271       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217109906165       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217109906303       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217109905679       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+05 is 5.562208e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207959 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8838e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423151e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050560e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141930e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396500e-02 3 1  ON 63
ci_015                 1.370289e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151593e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147593e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084521e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688647e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002294e-02 3 1  ON 86
ci_038                 1.583826e-03 3 1  ON 87
ci_039                 1.483452e-03 3 1  ON 88
ci_040                -4.170184e-03 3 1  ON 89
ci_041                 9.850129e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746839e-03 3 1  ON 94
ci_046                 5.500401e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194884e-02 3 1  ON 97
ci_049                -1.191351e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649817e-03 3 1  ON 100
ci_052                -6.651467e-03 3 1  ON 101
ci_053                -6.585029e-03 3 1  ON 102
ci_054                -3.294290e-03 3 1  ON 103
ci_055                -3.197705e-03 3 1  ON 104
ci_056                 5.120397e-03 3 1  ON 105
ci_057                 4.372932e-03 3 1  ON 106
ci_058                -6.801394e-03 3 1  ON 107
ci_059                -6.444632e-03 3 1  ON 108
ci_060                 8.329369e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028776e-03 3 1  ON 111
ci_063                -3.165723e-03 3 1  ON 112
ci_064                -2.916513e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782467e-03 3 1  ON 115
ci_067                 5.925059e-03 3 1  ON 116
ci_068                -4.948023e-03 3 1  ON 117
ci_069                -4.627830e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2734
    reference variance = 0.478441
====================================================
  Execution time = 2.0575e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1150e-01
  Total weights = 1.9566e+06
  Execution time = 1.8247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298133776180
                                         uncertainty =       0.001952999339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298133776180
                                         uncertainty =       0.001952999339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386070712
  error estimate for blocks of size 2^( 2) =       0.000395894696
  error estimate for blocks of size 2^( 3) =       0.000404750724
  error estimate for blocks of size 2^( 4) =       0.000411278286
  error estimate for blocks of size 2^( 5) =       0.000415347752
  error estimate for blocks of size 2^( 6) =       0.000418620923
  error estimate for blocks of size 2^( 7) =       0.000421646909

      target function =                  N/A
              le_mean =     -17.217047435365
             les_mean =     296.738220006808
             stat err =       0.000416723467
             autocorr =       1.165097317807
              std dev =       0.545986437247
             le_variance =       0.298101189658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298133788903
                                         uncertainty =       0.001952998743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298133788903
                                         uncertainty =       0.001952998743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386070720
  error estimate for blocks of size 2^( 2) =       0.000395894703
  error estimate for blocks of size 2^( 3) =       0.000404750730
  error estimate for blocks of size 2^( 4) =       0.000411278293
  error estimate for blocks of size 2^( 5) =       0.000415347758
  error estimate for blocks of size 2^( 6) =       0.000418620928
  error estimate for blocks of size 2^( 7) =       0.000421646913

      target function =                  N/A
              le_mean =     -17.217047435325
             les_mean =     296.738220226447
             stat err =       0.000416723473
             autocorr =       1.165097299192
              std dev =       0.545986448902
             le_variance =       0.298101202385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298133782541
                                         uncertainty =       0.001952999041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298133782541
                                         uncertainty =       0.001952999041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386070716
  error estimate for blocks of size 2^( 2) =       0.000395894699
  error estimate for blocks of size 2^( 3) =       0.000404750727
  error estimate for blocks of size 2^( 4) =       0.000411278289
  error estimate for blocks of size 2^( 5) =       0.000415347755
  error estimate for blocks of size 2^( 6) =       0.000418620925
  error estimate for blocks of size 2^( 7) =       0.000421646911

      target function =                  N/A
              le_mean =     -17.217047435345
             les_mean =     296.738220116305
             stat err =       0.000416723470
             autocorr =       1.165097308503
              std dev =       0.545986443075
             le_variance =       0.298101196022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298133776975
                                         uncertainty =       0.001952999301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298133776975
                                         uncertainty =       0.001952999301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386070713
  error estimate for blocks of size 2^( 2) =       0.000395894696
  error estimate for blocks of size 2^( 3) =       0.000404750724
  error estimate for blocks of size 2^( 4) =       0.000411278286
  error estimate for blocks of size 2^( 5) =       0.000415347752
  error estimate for blocks of size 2^( 6) =       0.000418620923
  error estimate for blocks of size 2^( 7) =       0.000421646909

      target function =                  N/A
              le_mean =     -17.217047435362
             les_mean =     296.738220020460
             stat err =       0.000416723468
             autocorr =       1.165097316643
              std dev =       0.545986437976
             le_variance =       0.298101190453


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217047435365        initial  <--
     9.5367e+03     9.5367e+04             8.8995e-08       -17.217047435325
     3.8147e+04     3.8147e+05             2.2249e-08       -17.217047435345
     1.5259e+05     1.5259e+06             5.5622e-09       -17.217047435362

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8266
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581001e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959321e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334709e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862829e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816675e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159258e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002294e-02 3 1  ON 86
ci_038                 1.583828e-03 3 1  ON 87
ci_039                 1.483454e-03 3 1  ON 88
ci_040                -4.170189e-03 3 1  ON 89
ci_041                 9.850130e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083330e-03 3 1  ON 92
ci_044                -1.569597e-02 3 1  ON 93
ci_045                -1.746838e-03 3 1  ON 94
ci_046                 5.500404e-03 3 1  ON 95
ci_047                 5.693170e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404667e-03 3 1  ON 99
ci_051                 7.649816e-03 3 1  ON 100
ci_052                -6.651469e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197703e-03 3 1  ON 104
ci_056                 5.120402e-03 3 1  ON 105
ci_057                 4.372930e-03 3 1  ON 106
ci_058                -6.801398e-03 3 1  ON 107
ci_059                -6.444635e-03 3 1  ON 108
ci_060                 8.329368e-03 3 1  ON 109
ci_061                 8.482192e-03 3 1  ON 110
ci_062                -3.028774e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916513e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782464e-03 3 1  ON 115
ci_067                 5.925064e-03 3 1  ON 116
ci_068                -4.948017e-03 3 1  ON 117
ci_069                -4.627828e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8687e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1545
    reference variance = 0.281744
====================================================
  Execution time = 2.0992e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1778e-01
  Total weights = 1.956450592e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1197e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299691516150
                                         uncertainty =       0.002148684696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299691516150
                                         uncertainty =       0.002148684696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387076534
  error estimate for blocks of size 2^( 2) =       0.000397420356
  error estimate for blocks of size 2^( 3) =       0.000406610982
  error estimate for blocks of size 2^( 4) =       0.000412728195
  error estimate for blocks of size 2^( 5) =       0.000417674738
  error estimate for blocks of size 2^( 6) =       0.000418683054
  error estimate for blocks of size 2^( 7) =       0.000417960546

      target function =                  N/A
              le_mean =     -17.216217970746
             les_mean =     296.715945093673
             stat err =       0.000416761633
             autocorr =       1.159262469338
              std dev =       0.547408883555
             le_variance =       0.299656485795


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721621797075e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216217970789       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216217970684       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216217970677       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216217970674       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216217970696       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216217970711       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216217970776       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216217970685       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216217970897       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216217971040       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+04 is 1.401232e-08

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216217970789       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216217970763       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216217970761       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216217970767       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216217970759       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216217970859       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216217971143       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216217970799       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216217970761       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216217970384       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+05 is 3.503086e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216217970789       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216217970782       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216217970782       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216217970783       residual = 5.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216217970783       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216217970146       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216217970787       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216217971410       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216217971601       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216217968949       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+06 is 8.757720e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216596 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7133e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581001e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959321e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862829e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816675e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159258e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002294e-02 3 1  ON 86
ci_038                 1.583828e-03 3 1  ON 87
ci_039                 1.483454e-03 3 1  ON 88
ci_040                -4.170188e-03 3 1  ON 89
ci_041                 9.850130e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083330e-03 3 1  ON 92
ci_044                -1.569597e-02 3 1  ON 93
ci_045                -1.746838e-03 3 1  ON 94
ci_046                 5.500405e-03 3 1  ON 95
ci_047                 5.693170e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404667e-03 3 1  ON 99
ci_051                 7.649815e-03 3 1  ON 100
ci_052                -6.651469e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120402e-03 3 1  ON 105
ci_057                 4.372928e-03 3 1  ON 106
ci_058                -6.801398e-03 3 1  ON 107
ci_059                -6.444635e-03 3 1  ON 108
ci_060                 8.329368e-03 3 1  ON 109
ci_061                 8.482192e-03 3 1  ON 110
ci_062                -3.028774e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916513e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782464e-03 3 1  ON 115
ci_067                 5.925064e-03 3 1  ON 116
ci_068                -4.948017e-03 3 1  ON 117
ci_069                -4.627828e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2288
    reference variance = 0.185096
====================================================
  Execution time = 2.0479e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1486e-01
  Total weights = 1.9567e+06
  Execution time = 1.8305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299447837232
                                         uncertainty =       0.001777959479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299447837232
                                         uncertainty =       0.001777959479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386944364
  error estimate for blocks of size 2^( 2) =       0.000396743261
  error estimate for blocks of size 2^( 3) =       0.000406004531
  error estimate for blocks of size 2^( 4) =       0.000412566248
  error estimate for blocks of size 2^( 5) =       0.000417228902
  error estimate for blocks of size 2^( 6) =       0.000419153351
  error estimate for blocks of size 2^( 7) =       0.000421188474

      target function =                  N/A
              le_mean =     -17.216710775126
             les_mean =     296.729986266425
             stat err =       0.000417534244
             autocorr =       1.164359655798
              std dev =       0.547221967100
             le_variance =       0.299451881276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299447838178
                                         uncertainty =       0.001777959594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299447838178
                                         uncertainty =       0.001777959594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386944364
  error estimate for blocks of size 2^( 2) =       0.000396743262
  error estimate for blocks of size 2^( 3) =       0.000406004531
  error estimate for blocks of size 2^( 4) =       0.000412566248
  error estimate for blocks of size 2^( 5) =       0.000417228903
  error estimate for blocks of size 2^( 6) =       0.000419153351
  error estimate for blocks of size 2^( 7) =       0.000421188474

      target function =                  N/A
              le_mean =     -17.216710775129
             les_mean =     296.729986257298
             stat err =       0.000417534244
             autocorr =       1.164359654035
              std dev =       0.547221967946
             le_variance =       0.299451882202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299447837705
                                         uncertainty =       0.001777959536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299447837705
                                         uncertainty =       0.001777959536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386944364
  error estimate for blocks of size 2^( 2) =       0.000396743262
  error estimate for blocks of size 2^( 3) =       0.000406004531
  error estimate for blocks of size 2^( 4) =       0.000412566248
  error estimate for blocks of size 2^( 5) =       0.000417228903
  error estimate for blocks of size 2^( 6) =       0.000419153351
  error estimate for blocks of size 2^( 7) =       0.000421188474

      target function =                  N/A
              le_mean =     -17.216710775128
             les_mean =     296.729986261859
             stat err =       0.000417534244
             autocorr =       1.164359654928
              std dev =       0.547221967523
             le_variance =       0.299451881739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299447837291
                                         uncertainty =       0.001777959486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299447837291
                                         uncertainty =       0.001777959486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386944364
  error estimate for blocks of size 2^( 2) =       0.000396743261
  error estimate for blocks of size 2^( 3) =       0.000406004531
  error estimate for blocks of size 2^( 4) =       0.000412566248
  error estimate for blocks of size 2^( 5) =       0.000417228903
  error estimate for blocks of size 2^( 6) =       0.000419153351
  error estimate for blocks of size 2^( 7) =       0.000421188474

      target function =                  N/A
              le_mean =     -17.216710775126
             les_mean =     296.729986265854
             stat err =       0.000417534244
             autocorr =       1.164359655685
              std dev =       0.547221967153
             le_variance =       0.299451881334


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216710775126        initial
     9.5367e+04     9.5367e+05             1.4012e-08       -17.216710775129  <--
     3.8147e+05     3.8147e+06             3.5031e-09       -17.216710775128
     1.5259e+06     1.5259e+07             8.7577e-10       -17.216710775126

*****************************************************************************
Applying the update for shift_i =   9.5367e+04     and shift_s =   9.5367e+05
*****************************************************************************

  Execution time = 2.9754e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959320e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850132e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083329e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746837e-03 3 1  ON 94
ci_046                 5.500407e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649813e-03 3 1  ON 100
ci_052                -6.651469e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294289e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444635e-03 3 1  ON 108
ci_060                 8.329367e-03 3 1  ON 109
ci_061                 8.482191e-03 3 1  ON 110
ci_062                -3.028774e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916513e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627828e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6909e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2827
    reference variance = 0.289585
====================================================
  Execution time = 2.1049e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0976e-01
  Total weights = 1.956615556e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297992087317
                                         uncertainty =       0.002218651131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297992087317
                                         uncertainty =       0.002218651131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386012485
  error estimate for blocks of size 2^( 2) =       0.000395840882
  error estimate for blocks of size 2^( 3) =       0.000405028870
  error estimate for blocks of size 2^( 4) =       0.000412206938
  error estimate for blocks of size 2^( 5) =       0.000416948536
  error estimate for blocks of size 2^( 6) =       0.000420430823
  error estimate for blocks of size 2^( 7) =       0.000419482474

      target function =                  N/A
              le_mean =     -17.215794416838
             les_mean =     296.693336849978
             stat err =       0.000417267193
             autocorr =       1.168492092840
              std dev =       0.545904091260
             le_variance =       0.298011276855


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721579441684e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215794416888       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215794416930       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215794416940       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215794416974       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215794416921       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215794416956       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215794416952       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215794416973       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215794416973       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215794416948       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+04 is 3.231285e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215794416888       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215794416898       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215794416901       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215794416909       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215794416872       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215794416859       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215794416896       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215794416919       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215794416802       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215794417164       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+04 is 8.078211e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215794416888       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215794416891       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215794416891       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215794416886       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215794416890       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215794417029       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215794417071       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215794416887       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215794416875       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215794417031       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+05 is 2.019551e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.225259 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7197e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959318e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141930e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321364e-02 3 1  ON 68
ci_020                 1.354026e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099149e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688644e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170187e-03 3 1  ON 89
ci_041                 9.850132e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746837e-03 3 1  ON 94
ci_046                 5.500407e-03 3 1  ON 95
ci_047                 5.693170e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404670e-03 3 1  ON 99
ci_051                 7.649811e-03 3 1  ON 100
ci_052                -6.651471e-03 3 1  ON 101
ci_053                -6.585029e-03 3 1  ON 102
ci_054                -3.294287e-03 3 1  ON 103
ci_055                -3.197701e-03 3 1  ON 104
ci_056                 5.120397e-03 3 1  ON 105
ci_057                 4.372925e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444635e-03 3 1  ON 108
ci_060                 8.329363e-03 3 1  ON 109
ci_061                 8.482191e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916513e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782461e-03 3 1  ON 115
ci_067                 5.925062e-03 3 1  ON 116
ci_068                -4.948018e-03 3 1  ON 117
ci_069                -4.627831e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2249
    reference variance = 0.187412
====================================================
  Execution time = 2.0455e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2335e-01
  Total weights = 1.9564e+06
  Execution time = 1.8282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305943698819
                                         uncertainty =       0.009604873897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305943698819
                                         uncertainty =       0.009604873897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391113399
  error estimate for blocks of size 2^( 2) =       0.000401101674
  error estimate for blocks of size 2^( 3) =       0.000410365076
  error estimate for blocks of size 2^( 4) =       0.000417777568
  error estimate for blocks of size 2^( 5) =       0.000422046803
  error estimate for blocks of size 2^( 6) =       0.000424247793
  error estimate for blocks of size 2^( 7) =       0.000427596156

      target function =                  N/A
              le_mean =     -17.216105822998
             les_mean =     296.717650711093
             stat err =       0.000422917080
             autocorr =       1.169243759484
              std dev =       0.553117873391
             le_variance =       0.305939381865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305943703017
                                         uncertainty =       0.009604872701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305943703017
                                         uncertainty =       0.009604872701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391113402
  error estimate for blocks of size 2^( 2) =       0.000401101677
  error estimate for blocks of size 2^( 3) =       0.000410365078
  error estimate for blocks of size 2^( 4) =       0.000417777570
  error estimate for blocks of size 2^( 5) =       0.000422046805
  error estimate for blocks of size 2^( 6) =       0.000424247795
  error estimate for blocks of size 2^( 7) =       0.000427596158

      target function =                  N/A
              le_mean =     -17.216105822828
             les_mean =     296.717650685928
             stat err =       0.000422917082
             autocorr =       1.169243755849
              std dev =       0.553117877175
             le_variance =       0.305939386050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305943700918
                                         uncertainty =       0.009604873299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305943700918
                                         uncertainty =       0.009604873299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391113400
  error estimate for blocks of size 2^( 2) =       0.000401101676
  error estimate for blocks of size 2^( 3) =       0.000410365077
  error estimate for blocks of size 2^( 4) =       0.000417777569
  error estimate for blocks of size 2^( 5) =       0.000422046804
  error estimate for blocks of size 2^( 6) =       0.000424247794
  error estimate for blocks of size 2^( 7) =       0.000427596157

      target function =                  N/A
              le_mean =     -17.216105822913
             les_mean =     296.717650698510
             stat err =       0.000422917081
             autocorr =       1.169243757671
              std dev =       0.553117875283
             le_variance =       0.305939383958

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305943699082
                                         uncertainty =       0.009604873822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305943699082
                                         uncertainty =       0.009604873822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391113399
  error estimate for blocks of size 2^( 2) =       0.000401101675
  error estimate for blocks of size 2^( 3) =       0.000410365076
  error estimate for blocks of size 2^( 4) =       0.000417777568
  error estimate for blocks of size 2^( 5) =       0.000422046803
  error estimate for blocks of size 2^( 6) =       0.000424247793
  error estimate for blocks of size 2^( 7) =       0.000427596156

      target function =                  N/A
              le_mean =     -17.216105822987
             les_mean =     296.717650709520
             stat err =       0.000422917080
             autocorr =       1.169243759275
              std dev =       0.553117873628
             le_variance =       0.305939382127


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216105822998        initial  <--
     2.3842e+04     2.3842e+05             3.2313e-08       -17.216105822828
     9.5367e+04     9.5367e+05             8.0782e-09       -17.216105822913
     3.8147e+05     3.8147e+06             2.0196e-09       -17.216105822987

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7084
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959320e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850132e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083329e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746837e-03 3 1  ON 94
ci_046                 5.500407e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649813e-03 3 1  ON 100
ci_052                -6.651469e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294289e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444635e-03 3 1  ON 108
ci_060                 8.329367e-03 3 1  ON 109
ci_061                 8.482191e-03 3 1  ON 110
ci_062                -3.028774e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916513e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627828e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6944e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.174
    reference variance = 0.216639
====================================================
  Execution time = 2.0709e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1434e-01
  Total weights = 1.956316523e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300152840774
                                         uncertainty =       0.002101577819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300152840774
                                         uncertainty =       0.002101577819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387415146
  error estimate for blocks of size 2^( 2) =       0.000397308715
  error estimate for blocks of size 2^( 3) =       0.000406452053
  error estimate for blocks of size 2^( 4) =       0.000413288582
  error estimate for blocks of size 2^( 5) =       0.000417764542
  error estimate for blocks of size 2^( 6) =       0.000419669133
  error estimate for blocks of size 2^( 7) =       0.000419625442

      target function =                  N/A
              le_mean =     -17.215841005046
             les_mean =     296.699516741026
             stat err =       0.000417586925
             autocorr =       1.161824666849
              std dev =       0.547887753840
             le_variance =       0.300180990808


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721584100505e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215841005077       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215841005088       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215841005081       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215841005070       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215841005093       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215841004894       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215841005008       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215841005243       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215841005382       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215841005680       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+05 is 3.127701e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215841005077       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215841005080       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215841005078       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215841005079       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215841005079       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215841004892       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215841005362       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215841005443       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215841005200       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215841005741       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+05 is 7.819257e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215841005077       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215841005078       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215841005078       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215841005078       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215841004579       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215841007347       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215841007305       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215841006649       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215841004570       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215841001070       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+06 is 1.954815e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233975 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6721e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850132e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746837e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649813e-03 3 1  ON 100
ci_052                -6.651469e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444635e-03 3 1  ON 108
ci_060                 8.329367e-03 3 1  ON 109
ci_061                 8.482191e-03 3 1  ON 110
ci_062                -3.028774e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916513e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627828e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2251
    reference variance = 0.157444
====================================================
  Execution time = 2.0525e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1936e-01
  Total weights = 1.9564e+06
  Execution time = 1.8274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299916778150
                                         uncertainty =       0.002265151015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299916778150
                                         uncertainty =       0.002265151015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387237166
  error estimate for blocks of size 2^( 2) =       0.000397091569
  error estimate for blocks of size 2^( 3) =       0.000406359631
  error estimate for blocks of size 2^( 4) =       0.000413076674
  error estimate for blocks of size 2^( 5) =       0.000417561334
  error estimate for blocks of size 2^( 6) =       0.000419489032
  error estimate for blocks of size 2^( 7) =       0.000420024845

      target function =                  N/A
              le_mean =     -17.215908002493
             les_mean =     296.706844479888
             stat err =       0.000417537971
             autocorr =       1.162620264020
              std dev =       0.547636051486
             le_variance =       0.299905244887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299916778965
                                         uncertainty =       0.002265151021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299916778965
                                         uncertainty =       0.002265151021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387237166
  error estimate for blocks of size 2^( 2) =       0.000397091570
  error estimate for blocks of size 2^( 3) =       0.000406359631
  error estimate for blocks of size 2^( 4) =       0.000413076675
  error estimate for blocks of size 2^( 5) =       0.000417561334
  error estimate for blocks of size 2^( 6) =       0.000419489033
  error estimate for blocks of size 2^( 7) =       0.000420024845

      target function =                  N/A
              le_mean =     -17.215908002499
             les_mean =     296.706844478592
             stat err =       0.000417537972
             autocorr =       1.162620262962
              std dev =       0.547636052234
             le_variance =       0.299905245706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299916778558
                                         uncertainty =       0.002265151018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299916778558
                                         uncertainty =       0.002265151018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387237166
  error estimate for blocks of size 2^( 2) =       0.000397091569
  error estimate for blocks of size 2^( 3) =       0.000406359631
  error estimate for blocks of size 2^( 4) =       0.000413076675
  error estimate for blocks of size 2^( 5) =       0.000417561334
  error estimate for blocks of size 2^( 6) =       0.000419489033
  error estimate for blocks of size 2^( 7) =       0.000420024845

      target function =                  N/A
              le_mean =     -17.215908002496
             les_mean =     296.706844479240
             stat err =       0.000417537972
             autocorr =       1.162620263496
              std dev =       0.547636051860
             le_variance =       0.299905245297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299916778201
                                         uncertainty =       0.002265151016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299916778201
                                         uncertainty =       0.002265151016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387237166
  error estimate for blocks of size 2^( 2) =       0.000397091569
  error estimate for blocks of size 2^( 3) =       0.000406359631
  error estimate for blocks of size 2^( 4) =       0.000413076674
  error estimate for blocks of size 2^( 5) =       0.000417561334
  error estimate for blocks of size 2^( 6) =       0.000419489032
  error estimate for blocks of size 2^( 7) =       0.000420024845

      target function =                  N/A
              le_mean =     -17.215908002493
             les_mean =     296.706844479807
             stat err =       0.000417537971
             autocorr =       1.162620263964
              std dev =       0.547636051533
             le_variance =       0.299905244939


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215908002493        initial
     2.3842e+05     2.3842e+06             3.1277e-09       -17.215908002499  <--
     9.5367e+05     9.5367e+06             7.8193e-10       -17.215908002496
     3.8147e+06     3.8147e+07             1.9548e-10       -17.215908002493

*****************************************************************************
Applying the update for shift_i =   2.3842e+05     and shift_s =   2.3842e+06
*****************************************************************************

  Execution time = 2.9786e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6536e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2504
    reference variance = 0.262551
====================================================
  Execution time = 2.0782e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1591e-01
  Total weights = 1.956431575e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302290365948
                                         uncertainty =       0.002869778160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302290365948
                                         uncertainty =       0.002869778160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388763954
  error estimate for blocks of size 2^( 2) =       0.000398613476
  error estimate for blocks of size 2^( 3) =       0.000407798214
  error estimate for blocks of size 2^( 4) =       0.000415020863
  error estimate for blocks of size 2^( 5) =       0.000419185161
  error estimate for blocks of size 2^( 6) =       0.000421569102
  error estimate for blocks of size 2^( 7) =       0.000425658846

      target function =                  N/A
              le_mean =     -17.216553542841
             les_mean =     296.725622415833
             stat err =       0.000420358493
             autocorr =       1.169143100584
              std dev =       0.549795256686
             le_variance =       0.302274824275


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655354284e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216553542873       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216553542871       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216553542895       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216553542917       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216553542896       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216553542919       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216553542918       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216553543045       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216553542887       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+04 is 1.333366e-08

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216553542873       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216553542873       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216553542879       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216553542879       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216553542793       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216553542904       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216553542619       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216553542773       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216553542974       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+05 is 3.333418e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216553542873       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216553542873       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216553542875       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216553543222       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216553542885       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216553542627       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216553542688       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216553541811       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216553542746       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+05 is 8.333543e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241794 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6909e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088371e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649813e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585030e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120399e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801398e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482191e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782462e-03 3 1  ON 115
ci_067                 5.925062e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627828e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1723
    reference variance = 0.188153
====================================================
  Execution time = 2.1019e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1694e-01
  Total weights = 1.9569e+06
  Execution time = 1.8305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300966546284
                                         uncertainty =       0.002105347862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300966546284
                                         uncertainty =       0.002105347862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387885091
  error estimate for blocks of size 2^( 2) =       0.000398208398
  error estimate for blocks of size 2^( 3) =       0.000407581566
  error estimate for blocks of size 2^( 4) =       0.000414023709
  error estimate for blocks of size 2^( 5) =       0.000419163852
  error estimate for blocks of size 2^( 6) =       0.000422185841
  error estimate for blocks of size 2^( 7) =       0.000423867378

      target function =                  N/A
              le_mean =     -17.216954988608
             les_mean =     296.740477016436
             stat err =       0.000419810195
             autocorr =       1.171385350153
              std dev =       0.548552355918
             le_variance =       0.300909687183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300966547168
                                         uncertainty =       0.002105347845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300966547168
                                         uncertainty =       0.002105347845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387885091
  error estimate for blocks of size 2^( 2) =       0.000398208398
  error estimate for blocks of size 2^( 3) =       0.000407581566
  error estimate for blocks of size 2^( 4) =       0.000414023709
  error estimate for blocks of size 2^( 5) =       0.000419163852
  error estimate for blocks of size 2^( 6) =       0.000422185841
  error estimate for blocks of size 2^( 7) =       0.000423867378

      target function =                  N/A
              le_mean =     -17.216954988605
             les_mean =     296.740477015019
             stat err =       0.000419810195
             autocorr =       1.171385349082
              std dev =       0.548552356730
             le_variance =       0.300909688074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300966546726
                                         uncertainty =       0.002105347854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300966546726
                                         uncertainty =       0.002105347854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387885091
  error estimate for blocks of size 2^( 2) =       0.000398208398
  error estimate for blocks of size 2^( 3) =       0.000407581566
  error estimate for blocks of size 2^( 4) =       0.000414023709
  error estimate for blocks of size 2^( 5) =       0.000419163852
  error estimate for blocks of size 2^( 6) =       0.000422185841
  error estimate for blocks of size 2^( 7) =       0.000423867378

      target function =                  N/A
              le_mean =     -17.216954988606
             les_mean =     296.740477015726
             stat err =       0.000419810195
             autocorr =       1.171385349620
              std dev =       0.548552356324
             le_variance =       0.300909687629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300966546339
                                         uncertainty =       0.002105347861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300966546339
                                         uncertainty =       0.002105347861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387885091
  error estimate for blocks of size 2^( 2) =       0.000398208398
  error estimate for blocks of size 2^( 3) =       0.000407581566
  error estimate for blocks of size 2^( 4) =       0.000414023709
  error estimate for blocks of size 2^( 5) =       0.000419163852
  error estimate for blocks of size 2^( 6) =       0.000422185841
  error estimate for blocks of size 2^( 7) =       0.000423867378

      target function =                  N/A
              le_mean =     -17.216954988608
             les_mean =     296.740477016347
             stat err =       0.000419810195
             autocorr =       1.171385350082
              std dev =       0.548552355969
             le_variance =       0.300909687239


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216954988608        initial  <--
     5.9605e+04     5.9605e+05             1.3334e-08       -17.216954988605
     2.3842e+05     2.3842e+06             3.3334e-09       -17.216954988606
     9.5367e+05     9.5367e+06             8.3335e-10       -17.216954988608

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2789
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7205e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2038
    reference variance = 0.264057
====================================================
  Execution time = 2.0725e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1250e-01
  Total weights = 1.956723270e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300248658550
                                         uncertainty =       0.002210921915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300248658550
                                         uncertainty =       0.002210921915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387395644
  error estimate for blocks of size 2^( 2) =       0.000397845107
  error estimate for blocks of size 2^( 3) =       0.000407129341
  error estimate for blocks of size 2^( 4) =       0.000413857543
  error estimate for blocks of size 2^( 5) =       0.000417201736
  error estimate for blocks of size 2^( 6) =       0.000419166616
  error estimate for blocks of size 2^( 7) =       0.000419613704

      target function =                  N/A
              le_mean =     -17.216611298606
             les_mean =     296.724203468086
             stat err =       0.000417459900
             autocorr =       1.161234851499
              std dev =       0.547860174339
             le_variance =       0.300150770627


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721661129861e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216611298667       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216611298669       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216611298670       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216611298669       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216611298667       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216611304469       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216611295166       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216611297258       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216611299473       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216611298047       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+05 is 1.380039e-09

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216611298667       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216611298668       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216611298668       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216611297036       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216611298622       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216611299274       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216611298737       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216611299033       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216611296981       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216611300711       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+06 is 3.450100e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216611298667       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216611298668       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216611298668       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216611298912       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216611299816       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216611298320       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216611297531       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216611293892       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216611299238       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216611285715       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+06 is 8.625268e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.245697 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6809e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482191e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2894
    reference variance = 0.189572
====================================================
  Execution time = 2.2535e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0803e-01
  Total weights = 1.9567e+06
  Execution time = 1.8345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295398970642
                                         uncertainty =       0.001554406141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295398970642
                                         uncertainty =       0.001554406141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384297806
  error estimate for blocks of size 2^( 2) =       0.000394263858
  error estimate for blocks of size 2^( 3) =       0.000403559369
  error estimate for blocks of size 2^( 4) =       0.000409570331
  error estimate for blocks of size 2^( 5) =       0.000413265393
  error estimate for blocks of size 2^( 6) =       0.000415303160
  error estimate for blocks of size 2^( 7) =       0.000416843279

      target function =                  N/A
              le_mean =     -17.215775380305
             les_mean =     296.690947937534
             stat err =       0.000413745541
             autocorr =       1.159126516817
              std dev =       0.543479169697
             le_variance =       0.295369607895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295398970544
                                         uncertainty =       0.001554406135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295398970544
                                         uncertainty =       0.001554406135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384297806
  error estimate for blocks of size 2^( 2) =       0.000394263858
  error estimate for blocks of size 2^( 3) =       0.000403559369
  error estimate for blocks of size 2^( 4) =       0.000409570331
  error estimate for blocks of size 2^( 5) =       0.000413265393
  error estimate for blocks of size 2^( 6) =       0.000415303159
  error estimate for blocks of size 2^( 7) =       0.000416843279

      target function =                  N/A
              le_mean =     -17.215775380305
             les_mean =     296.690947938189
             stat err =       0.000413745541
             autocorr =       1.159126516711
              std dev =       0.543479169607
             le_variance =       0.295369607796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295398970593
                                         uncertainty =       0.001554406138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295398970593
                                         uncertainty =       0.001554406138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384297806
  error estimate for blocks of size 2^( 2) =       0.000394263858
  error estimate for blocks of size 2^( 3) =       0.000403559369
  error estimate for blocks of size 2^( 4) =       0.000409570331
  error estimate for blocks of size 2^( 5) =       0.000413265393
  error estimate for blocks of size 2^( 6) =       0.000415303159
  error estimate for blocks of size 2^( 7) =       0.000416843279

      target function =                  N/A
              le_mean =     -17.215775380305
             les_mean =     296.690947937861
             stat err =       0.000413745541
             autocorr =       1.159126516770
              std dev =       0.543479169652
             le_variance =       0.295369607846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295398970636
                                         uncertainty =       0.001554406140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295398970636
                                         uncertainty =       0.001554406140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384297806
  error estimate for blocks of size 2^( 2) =       0.000394263858
  error estimate for blocks of size 2^( 3) =       0.000403559369
  error estimate for blocks of size 2^( 4) =       0.000409570331
  error estimate for blocks of size 2^( 5) =       0.000413265393
  error estimate for blocks of size 2^( 6) =       0.000415303160
  error estimate for blocks of size 2^( 7) =       0.000416843279

      target function =                  N/A
              le_mean =     -17.215775380305
             les_mean =     296.690947937574
             stat err =       0.000413745541
             autocorr =       1.159126516815
              std dev =       0.543479169692
             le_variance =       0.295369607889


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215775380305        initial  <--
     5.9605e+05     5.9605e+06             1.3800e-09       -17.215775380305
     2.3842e+06     2.3842e+07             3.4501e-10       -17.215775380305
     9.5367e+06     9.5367e+07             8.6253e-11       -17.215775380305

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.0815
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8901e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1773
    reference variance = 0.274134
====================================================
  Execution time = 2.1089e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1696e-01
  Total weights = 1.956646679e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301664331160
                                         uncertainty =       0.002383990204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301664331160
                                         uncertainty =       0.002383990204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388338823
  error estimate for blocks of size 2^( 2) =       0.000398131240
  error estimate for blocks of size 2^( 3) =       0.000406687591
  error estimate for blocks of size 2^( 4) =       0.000413609486
  error estimate for blocks of size 2^( 5) =       0.000416977349
  error estimate for blocks of size 2^( 6) =       0.000418268722
  error estimate for blocks of size 2^( 7) =       0.000419685940

      target function =                  N/A
              le_mean =     -17.215778350135
             les_mean =     296.699987382894
             stat err =       0.000417135374
             autocorr =       1.153805015049
              std dev =       0.549194029984
             le_variance =       0.301614082570


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721577835014e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215778350169       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215778350170       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215778350170       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215778350171       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215778350130       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215778350628       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215778350517       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215778342796       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215778353978       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215778369994       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+06 is 1.312262e-10

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215778350169       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215778350169       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215778350170       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215778347584       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215778363861       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215778348315       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215778338472       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215778333808       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215778353722       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215778349975       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+07 is 3.280655e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215778350169       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215778350169       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215778350169       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215778327525       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215778328299       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215778416688       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215778391311       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215778375058       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215778337357       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215778351155       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+07 is 8.201584e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249627 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7116e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2376
    reference variance = 0.495772
====================================================
  Execution time = 2.0834e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1301e-01
  Total weights = 1.9564e+06
  Execution time = 1.8693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298752578199
                                         uncertainty =       0.002673097830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298752578199
                                         uncertainty =       0.002673097830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386476227
  error estimate for blocks of size 2^( 2) =       0.000396297235
  error estimate for blocks of size 2^( 3) =       0.000405114304
  error estimate for blocks of size 2^( 4) =       0.000411836186
  error estimate for blocks of size 2^( 5) =       0.000416076571
  error estimate for blocks of size 2^( 6) =       0.000417079975
  error estimate for blocks of size 2^( 7) =       0.000417579820

      target function =                  N/A
              le_mean =     -17.216242007950
             les_mean =     296.711997857065
             stat err =       0.000415643138
             autocorr =       1.156633215275
              std dev =       0.546559922015
             le_variance =       0.298727748353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298752578254
                                         uncertainty =       0.002673097831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298752578254
                                         uncertainty =       0.002673097831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386476227
  error estimate for blocks of size 2^( 2) =       0.000396297235
  error estimate for blocks of size 2^( 3) =       0.000405114305
  error estimate for blocks of size 2^( 4) =       0.000411836186
  error estimate for blocks of size 2^( 5) =       0.000416076571
  error estimate for blocks of size 2^( 6) =       0.000417079975
  error estimate for blocks of size 2^( 7) =       0.000417579820

      target function =                  N/A
              le_mean =     -17.216242007950
             les_mean =     296.711997857174
             stat err =       0.000415643138
             autocorr =       1.156633215219
              std dev =       0.546559922065
             le_variance =       0.298727748408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298752578227
                                         uncertainty =       0.002673097831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298752578227
                                         uncertainty =       0.002673097831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386476227
  error estimate for blocks of size 2^( 2) =       0.000396297235
  error estimate for blocks of size 2^( 3) =       0.000405114304
  error estimate for blocks of size 2^( 4) =       0.000411836186
  error estimate for blocks of size 2^( 5) =       0.000416076571
  error estimate for blocks of size 2^( 6) =       0.000417079975
  error estimate for blocks of size 2^( 7) =       0.000417579820

      target function =                  N/A
              le_mean =     -17.216242007950
             les_mean =     296.711997857119
             stat err =       0.000415643138
             autocorr =       1.156633215247
              std dev =       0.546559922040
             le_variance =       0.298727748381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298752578203
                                         uncertainty =       0.002673097830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298752578203
                                         uncertainty =       0.002673097830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386476227
  error estimate for blocks of size 2^( 2) =       0.000396297235
  error estimate for blocks of size 2^( 3) =       0.000405114304
  error estimate for blocks of size 2^( 4) =       0.000411836186
  error estimate for blocks of size 2^( 5) =       0.000416076571
  error estimate for blocks of size 2^( 6) =       0.000417079975
  error estimate for blocks of size 2^( 7) =       0.000417579820

      target function =                  N/A
              le_mean =     -17.216242007950
             les_mean =     296.711997857072
             stat err =       0.000415643138
             autocorr =       1.156633215275
              std dev =       0.546559922018
             le_variance =       0.298727748357


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216242007950        initial  <--
     5.9605e+06     5.9605e+07             1.3123e-10       -17.216242007950
     2.3842e+07     2.3842e+08             3.2807e-11       -17.216242007950
     9.5367e+07     9.5367e+08             8.2016e-12       -17.216242007950

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1358
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7260e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1879
    reference variance = 0.400816
====================================================
  Execution time = 2.0956e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0802e-01
  Total weights = 1.956802462e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9917e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294469869704
                                         uncertainty =       0.001381544635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294469869704
                                         uncertainty =       0.001381544635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383740098
  error estimate for blocks of size 2^( 2) =       0.000393708710
  error estimate for blocks of size 2^( 3) =       0.000402680173
  error estimate for blocks of size 2^( 4) =       0.000409886415
  error estimate for blocks of size 2^( 5) =       0.000414583498
  error estimate for blocks of size 2^( 6) =       0.000417497809
  error estimate for blocks of size 2^( 7) =       0.000420171430

      target function =                  N/A
              le_mean =     -17.216307204506
             les_mean =     296.709256438332
             stat err =       0.000415534788
             autocorr =       1.172574408150
              std dev =       0.542690451614
             le_variance =       0.294512926273


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630720451e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216307204559       residual = 9.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216307204559       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216307204559       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216307226958       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216307178523       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216307180571       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216307199297       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216307360298       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216307010644       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216307194457       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+07 is 1.345651e-11

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216307204559       residual = 9.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216307204559       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216307204559       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216307354207       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216307326787       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216307312196       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216307187715       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216307183030       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216307234803       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216306815427       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+08 is 3.364360e-12

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216307204559       residual = 9.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216307204559       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216307204559       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216307204559       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216307069272       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216307292816       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216306949859       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216307291567       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216306991644       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216306397264       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+08 is 8.411518e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253556 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6961e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1855
    reference variance = 0.186983
====================================================
  Execution time = 2.0235e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1225e-01
  Total weights = 1.9566e+06
  Execution time = 1.8360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298117989040
                                         uncertainty =       0.001837295402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298117989040
                                         uncertainty =       0.001837295402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386052777
  error estimate for blocks of size 2^( 2) =       0.000396044620
  error estimate for blocks of size 2^( 3) =       0.000405457692
  error estimate for blocks of size 2^( 4) =       0.000412202053
  error estimate for blocks of size 2^( 5) =       0.000416087364
  error estimate for blocks of size 2^( 6) =       0.000417811154
  error estimate for blocks of size 2^( 7) =       0.000419194546

      target function =                  N/A
              le_mean =     -17.216406852694
             les_mean =     296.716915957814
             stat err =       0.000416323779
             autocorr =       1.162971501172
              std dev =       0.545961073446
             le_variance =       0.298073493719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298117989045
                                         uncertainty =       0.001837295402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298117989045
                                         uncertainty =       0.001837295402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386052777
  error estimate for blocks of size 2^( 2) =       0.000396044620
  error estimate for blocks of size 2^( 3) =       0.000405457692
  error estimate for blocks of size 2^( 4) =       0.000412202053
  error estimate for blocks of size 2^( 5) =       0.000416087364
  error estimate for blocks of size 2^( 6) =       0.000417811154
  error estimate for blocks of size 2^( 7) =       0.000419194546

      target function =                  N/A
              le_mean =     -17.216406852694
             les_mean =     296.716915957826
             stat err =       0.000416323779
             autocorr =       1.162971501156
              std dev =       0.545961073450
             le_variance =       0.298073493723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298117989042
                                         uncertainty =       0.001837295402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298117989042
                                         uncertainty =       0.001837295402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386052777
  error estimate for blocks of size 2^( 2) =       0.000396044620
  error estimate for blocks of size 2^( 3) =       0.000405457692
  error estimate for blocks of size 2^( 4) =       0.000412202053
  error estimate for blocks of size 2^( 5) =       0.000416087364
  error estimate for blocks of size 2^( 6) =       0.000417811154
  error estimate for blocks of size 2^( 7) =       0.000419194546

      target function =                  N/A
              le_mean =     -17.216406852694
             les_mean =     296.716915957820
             stat err =       0.000416323779
             autocorr =       1.162971501151
              std dev =       0.545961073448
             le_variance =       0.298073493721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298117989040
                                         uncertainty =       0.001837295402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298117989040
                                         uncertainty =       0.001837295402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386052777
  error estimate for blocks of size 2^( 2) =       0.000396044620
  error estimate for blocks of size 2^( 3) =       0.000405457692
  error estimate for blocks of size 2^( 4) =       0.000412202053
  error estimate for blocks of size 2^( 5) =       0.000416087364
  error estimate for blocks of size 2^( 6) =       0.000417811154
  error estimate for blocks of size 2^( 7) =       0.000419194546

      target function =                  N/A
              le_mean =     -17.216406852694
             les_mean =     296.716915957815
             stat err =       0.000416323779
             autocorr =       1.162971501163
              std dev =       0.545961073447
             le_variance =       0.298073493719


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216406852694        initial  <--
     5.9605e+07     5.9605e+08             1.3457e-11       -17.216406852694
     2.3842e+08     2.3842e+09             3.3644e-12       -17.216406852694
     9.5367e+08     9.5367e+09             8.4115e-13       -17.216406852694

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5207
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6488e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2374
    reference variance = 0.132603
====================================================
  Execution time = 2.0497e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1775e-01
  Total weights = 1.956676141e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298936673133
                                         uncertainty =       0.002224654580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298936673133
                                         uncertainty =       0.002224654580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386573671
  error estimate for blocks of size 2^( 2) =       0.000396412834
  error estimate for blocks of size 2^( 3) =       0.000405550456
  error estimate for blocks of size 2^( 4) =       0.000411974595
  error estimate for blocks of size 2^( 5) =       0.000415492837
  error estimate for blocks of size 2^( 6) =       0.000416718889
  error estimate for blocks of size 2^( 7) =       0.000417883307

      target function =                  N/A
              le_mean =     -17.216222270651
             les_mean =     296.716058667950
             stat err =       0.000415517407
             autocorr =       1.155350887227
              std dev =       0.546697727779
             le_variance =       0.298878405559


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721622227065e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216222270686       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216222270686       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216222270686       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216222544078       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216222203697       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216222513238       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216222304882       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216223002056       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216222593206       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216222616004       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+08 is 1.343493e-12

solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216222270686       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216222270686       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216222270686       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216222270686       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216222270686       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216223130322       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216221832279       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216221917734       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216225646077       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216220428697       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+09 is 3.357266e-13

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216222270686       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216222270686       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216222270686       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216227710363       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216222270686       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216230056711       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216222888703       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216216055000       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216219214684       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216216981642       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+09 is 8.393620e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.257380 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6679e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2112
    reference variance = 0.151823
====================================================
  Execution time = 2.0367e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1386e-01
  Total weights = 1.9566e+06
  Execution time = 1.8420e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299949677354
                                         uncertainty =       0.002116060912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299949677354
                                         uncertainty =       0.002116060912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387251376
  error estimate for blocks of size 2^( 2) =       0.000397436046
  error estimate for blocks of size 2^( 3) =       0.000405949952
  error estimate for blocks of size 2^( 4) =       0.000412954554
  error estimate for blocks of size 2^( 5) =       0.000417248634
  error estimate for blocks of size 2^( 6) =       0.000419541425
  error estimate for blocks of size 2^( 7) =       0.000420578789

      target function =                  N/A
              le_mean =     -17.216834312068
             les_mean =     296.733245997573
             stat err =       0.000417580850
             autocorr =       1.162773726797
              std dev =       0.547656147725
             le_variance =       0.299927256141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299949677355
                                         uncertainty =       0.002116060912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299949677355
                                         uncertainty =       0.002116060912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387251376
  error estimate for blocks of size 2^( 2) =       0.000397436046
  error estimate for blocks of size 2^( 3) =       0.000405949952
  error estimate for blocks of size 2^( 4) =       0.000412954554
  error estimate for blocks of size 2^( 5) =       0.000417248634
  error estimate for blocks of size 2^( 6) =       0.000419541425
  error estimate for blocks of size 2^( 7) =       0.000420578789

      target function =                  N/A
              le_mean =     -17.216834312068
             les_mean =     296.733245997574
             stat err =       0.000417580850
             autocorr =       1.162773726794
              std dev =       0.547656147726
             le_variance =       0.299927256142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299949677355
                                         uncertainty =       0.002116060912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299949677355
                                         uncertainty =       0.002116060912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387251376
  error estimate for blocks of size 2^( 2) =       0.000397436046
  error estimate for blocks of size 2^( 3) =       0.000405949952
  error estimate for blocks of size 2^( 4) =       0.000412954554
  error estimate for blocks of size 2^( 5) =       0.000417248634
  error estimate for blocks of size 2^( 6) =       0.000419541425
  error estimate for blocks of size 2^( 7) =       0.000420578789

      target function =                  N/A
              le_mean =     -17.216834312068
             les_mean =     296.733245997573
             stat err =       0.000417580850
             autocorr =       1.162773726796
              std dev =       0.547656147725
             le_variance =       0.299927256141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299949677354
                                         uncertainty =       0.002116060912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299949677354
                                         uncertainty =       0.002116060912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387251376
  error estimate for blocks of size 2^( 2) =       0.000397436046
  error estimate for blocks of size 2^( 3) =       0.000405949952
  error estimate for blocks of size 2^( 4) =       0.000412954554
  error estimate for blocks of size 2^( 5) =       0.000417248634
  error estimate for blocks of size 2^( 6) =       0.000419541425
  error estimate for blocks of size 2^( 7) =       0.000420578789

      target function =                  N/A
              le_mean =     -17.216834312068
             les_mean =     296.733245997573
             stat err =       0.000417580850
             autocorr =       1.162773726791
              std dev =       0.547656147725
             le_variance =       0.299927256141


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216834312068        initial  <--
     5.9605e+08     5.9605e+09             1.3435e-12       -17.216834312068
     2.3842e+09     2.3842e+10             3.3573e-13       -17.216834312068
     9.5367e+09     9.5367e+10             8.3936e-14       -17.216834312068

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6545
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6339e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2223
    reference variance = 0.393739
====================================================
  Execution time = 2.0520e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5319e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1291e-01
  Total weights = 1.956676621e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0402e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297161491356
                                         uncertainty =       0.001754198412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297161491356
                                         uncertainty =       0.001754198412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385445076
  error estimate for blocks of size 2^( 2) =       0.000395534349
  error estimate for blocks of size 2^( 3) =       0.000404433028
  error estimate for blocks of size 2^( 4) =       0.000411467867
  error estimate for blocks of size 2^( 5) =       0.000415754245
  error estimate for blocks of size 2^( 6) =       0.000417915294
  error estimate for blocks of size 2^( 7) =       0.000419859683

      target function =                  N/A
              le_mean =     -17.217409351679
             les_mean =     296.752092481970
             stat err =       0.000416249272
             autocorr =       1.166223987589
              std dev =       0.545101654252
             le_variance =       0.297135813468


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721740935168e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217409351746       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217409351746       residual = 8.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217409351746       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217409351746       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217405380168       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217429739387       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217411541727       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217409941090       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217399702208       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217427431667       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217416899872       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217394071765       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217398005224       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217375434185       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217412350098       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+09 is 1.624634e-13

solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217409351746       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217409351746       residual = 8.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217409351746       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217417414237       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217398848094       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217405286706       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217405481784       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217406762691       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217420650056       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217390024980       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217465975035       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217359615077       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217077508592       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217510374834       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217259702307       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216817972104       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217020437715       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217496464775       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217349829646       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217205748527       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.218462346407       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.218858591568       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.218227854860       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.219591279656       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.218231989816       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216677858057       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.217310555268       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.216366272736       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.217304306368       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.219618201895       residual = 7.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.215967183022       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.222801819098       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.213401119899       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.215366030990       residual = 6.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.211582415146       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.209262534453       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.223518766939       residual = 5.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.212775555717       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.218355682861       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.216796653840       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.209770947217       residual = 9.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.212841874159       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.214497099196       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.222503623076       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.215014743997       residual = 8.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.221444104120       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.228621689518       residual = 2.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.208108249371       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.212855084597       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.211318619998       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.211726196643       residual = 8.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.220797283511       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.204935235765       residual = 2.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.221710593591       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.188841399865       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.242755505033       residual = 9.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.224591475365       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -17.221428531028       residual = 4.31e-03           smallest_sin_value = 9.99e-01
davidson iteration   58:   krylov dim =  59   energy =     -17.216199635147       residual = 3.87e-04           smallest_sin_value = 9.98e-01
davidson iteration   59:   krylov dim =  60   energy =     -17.203927169422       residual = 2.46e-02           smallest_sin_value = 9.91e-01
davidson iteration   60 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         60 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+10 is 4.063682e-14

solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217409351746       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217409351746       residual = 8.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217409351746       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217409351746       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217400840126       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217405590217       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217380065653       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217395214886       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217230562109       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217360381576       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.218107601975       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217556394213       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217620427431       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217870259538       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217029007583       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215942339537       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217968128276       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216971929370       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.222953716607       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217643619851       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.207289407259       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.217330111865       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.219478882717       residual = 6.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216700018354       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.229590624867       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.220622066040       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.220565434036       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.213728582112       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.217836793140       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.226217032075       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.215030357975       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.216422079432       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.214040986940       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.217842455397       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.209571135311       residual = 9.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.225496739835       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.224715616133       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.209168595639       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.202229072302       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.160721211377       residual = 4.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.209953711799       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.242540751671       residual = 1.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.208014493998       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.197751994891       residual = 5.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.227386063544       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.219447572934       residual = 4.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.232711744963       residual = 3.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.208422836495       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.207472334455       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.209698401962       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.210467912618       residual = 9.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.162322186247       residual = 5.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.242802196798       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.239418262743       residual = 8.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.215412211435       residual = 6.88e-03           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   energy =     -17.163729829638       residual = 4.47e-01           smallest_sin_value = 9.98e-01
davidson iteration   56:   krylov dim =  57   energy =     -17.083230741123       residual = 2.84e+00           smallest_sin_value = 9.96e-01
davidson iteration   57:   krylov dim =  58   energy =     -17.339321762469       residual = 2.35e+00           smallest_sin_value = 9.96e-01
davidson iteration   58 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         58 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+10 is 1.018540e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.435890 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6748e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2614
    reference variance = 0.59699
====================================================
  Execution time = 2.0768e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1513e-01
  Total weights = 1.9567e+06
  Execution time = 1.8347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299911247136
                                         uncertainty =       0.001847742719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299911247136
                                         uncertainty =       0.001847742719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387224718
  error estimate for blocks of size 2^( 2) =       0.000397363633
  error estimate for blocks of size 2^( 3) =       0.000406646612
  error estimate for blocks of size 2^( 4) =       0.000413556821
  error estimate for blocks of size 2^( 5) =       0.000417142306
  error estimate for blocks of size 2^( 6) =       0.000419726608
  error estimate for blocks of size 2^( 7) =       0.000419992382

      target function =                  N/A
              le_mean =     -17.216307955960
             les_mean =     296.716393227108
             stat err =       0.000417604529
             autocorr =       1.163065724284
              std dev =       0.547618447380
             le_variance =       0.299885963911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299911247136
                                         uncertainty =       0.001847742719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299911247136
                                         uncertainty =       0.001847742719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387224718
  error estimate for blocks of size 2^( 2) =       0.000397363633
  error estimate for blocks of size 2^( 3) =       0.000406646612
  error estimate for blocks of size 2^( 4) =       0.000413556821
  error estimate for blocks of size 2^( 5) =       0.000417142306
  error estimate for blocks of size 2^( 6) =       0.000419726608
  error estimate for blocks of size 2^( 7) =       0.000419992382

      target function =                  N/A
              le_mean =     -17.216307955960
             les_mean =     296.716393227108
             stat err =       0.000417604529
             autocorr =       1.163065724290
              std dev =       0.547618447380
             le_variance =       0.299885963911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299911247136
                                         uncertainty =       0.001847742719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299911247136
                                         uncertainty =       0.001847742719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387224718
  error estimate for blocks of size 2^( 2) =       0.000397363633
  error estimate for blocks of size 2^( 3) =       0.000406646612
  error estimate for blocks of size 2^( 4) =       0.000413556821
  error estimate for blocks of size 2^( 5) =       0.000417142306
  error estimate for blocks of size 2^( 6) =       0.000419726608
  error estimate for blocks of size 2^( 7) =       0.000419992382

      target function =                  N/A
              le_mean =     -17.216307955960
             les_mean =     296.716393227108
             stat err =       0.000417604529
             autocorr =       1.163065724284
              std dev =       0.547618447380
             le_variance =       0.299885963911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299911247136
                                         uncertainty =       0.001847742719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299911247136
                                         uncertainty =       0.001847742719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387224718
  error estimate for blocks of size 2^( 2) =       0.000397363633
  error estimate for blocks of size 2^( 3) =       0.000406646612
  error estimate for blocks of size 2^( 4) =       0.000413556821
  error estimate for blocks of size 2^( 5) =       0.000417142306
  error estimate for blocks of size 2^( 6) =       0.000419726608
  error estimate for blocks of size 2^( 7) =       0.000419992382

      target function =                  N/A
              le_mean =     -17.216307955960
             les_mean =     296.716393227108
             stat err =       0.000417604529
             autocorr =       1.163065724281
              std dev =       0.547618447380
             le_variance =       0.299885963911


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216307955960        initial  <--
     5.9605e+09     5.9605e+10             1.6246e-13       -17.216307955960
     2.3842e+10     2.3842e+11             4.0637e-14       -17.216307955960
     9.5367e+10     9.5367e+11             1.0185e-14       -17.216307955960

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0632
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6817e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.0992
    reference variance = 18.3898
====================================================
  Execution time = 2.0605e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1319e-01
  Total weights = 1.956756912e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299572024332
                                         uncertainty =       0.002414292277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299572024332
                                         uncertainty =       0.002414292277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387016612
  error estimate for blocks of size 2^( 2) =       0.000396909345
  error estimate for blocks of size 2^( 3) =       0.000406380807
  error estimate for blocks of size 2^( 4) =       0.000413123420
  error estimate for blocks of size 2^( 5) =       0.000418091220
  error estimate for blocks of size 2^( 6) =       0.000420725614
  error estimate for blocks of size 2^( 7) =       0.000421364361

      target function =                  N/A
              le_mean =     -17.216528852962
             les_mean =     296.722058313559
             stat err =       0.000418326154
             autocorr =       1.168344241537
              std dev =       0.547324141049
             le_variance =       0.299563715375


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652885296e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216528852983       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216528852983       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216528852983       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216528852983       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216528852983       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216496352701       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216553771019       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216516222368       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216586173439       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216225931976       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215797347023       residual = 8.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216417609293       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216491035086       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216227792636       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217178741092       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216812605171       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215468890899       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215339439821       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.214118797423       residual = 9.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216290016950       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215531105085       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.217491936299       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216484197101       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.215797432610       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216528001944       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216805388217       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.215451389689       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.216790921402       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.216842172269       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.217057614932       residual = 9.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.210401453393       residual = 5.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.220870439154       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.216999348058       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.218640645027       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.207644679481       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.212643792369       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.223749142481       residual = 7.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.210780302547       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.220582681999       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.218261254660       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.213223847396       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.214256018947       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.222880292378       residual = 7.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.213425056124       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.217658627920       residual = 6.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.214153374461       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.222735702509       residual = 7.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.222167601301       residual = 5.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.211090718376       residual = 4.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.207830459836       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.219703422276       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.216667355803       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.217192620165       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.215416754117       residual = 3.07e-04           smallest_sin_value = 9.98e-01
davidson iteration   54:   krylov dim =  55   energy =     -17.219242334995       residual = 5.55e-03           smallest_sin_value = 9.98e-01
davidson iteration   55:   krylov dim =  56   energy =     -17.217391474135       residual = 2.04e-03           smallest_sin_value = 9.98e-01
davidson iteration   56:   krylov dim =  57   energy =     -17.221941811671       residual = 5.32e-03           smallest_sin_value = 9.96e-01
davidson iteration   57:   krylov dim =  58   energy =     -17.224442427666       residual = 1.35e-02           smallest_sin_value = 9.94e-01
davidson iteration   58 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         58 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+10 is 1.369981e-14

solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216528852983       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216528852983       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216528852983       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216479799532       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216493014721       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216484915626       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216468841638       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216746203878       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216301905703       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216254665074       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216092453628       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216486147670       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216566749154       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216808304959       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213361144822       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216568195544       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214313680226       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.213189351075       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.209267079001       residual = 8.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.221559237759       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.207689494136       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.221438680792       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216478656144       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.239460127896       residual = 8.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.227857673905       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.218718696227       residual = 6.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.202825024676       residual = 3.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.230020806180       residual = 2.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.203622162618       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.210469912977       residual = 5.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.220923308538       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.220416385704       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.209516296544       residual = 8.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.194938810574       residual = 7.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.238499662570       residual = 7.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.248516163457       residual = 1.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.196257324797       residual = 6.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.214883970410       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.239668132562       residual = 8.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.118010432742       residual = 1.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.193124596290       residual = 8.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.140146421303       residual = 9.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.245366395362       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.186671069816       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.208987523791       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.130880762563       residual = 1.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.195799310897       residual = 6.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.212176219147       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.190926855288       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.264544652245       residual = 3.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.237710074731       residual = 8.90e-02           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   energy =     -17.272948340999       residual = 5.32e-01           smallest_sin_value = 9.97e-01
davidson iteration   52:   krylov dim =  53   energy =     -17.175947314263       residual = 2.56e-01           smallest_sin_value = 9.97e-01
davidson iteration   53:   krylov dim =  54   energy =     -17.228787860201       residual = 2.37e-02           smallest_sin_value = 9.96e-01
davidson iteration   54:   krylov dim =  55   energy =     -17.258193987719       residual = 3.01e-01           smallest_sin_value = 9.95e-01
davidson iteration   55:   krylov dim =  56   energy =     -17.250133515421       residual = 1.78e-01           smallest_sin_value = 9.91e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.61e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+11 is 3.239149e-15

solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216528852983       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216528852983       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216528852983       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216529012637       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216527949817       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216417727768       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216649057658       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216736090748       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216406471476       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217077690364       residual = 9.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215251188824       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217443637500       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216533718718       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.212754392863       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217842408582       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.218483880441       residual = 7.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.224987455802       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.224678017561       residual = 9.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.222865139084       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.206190507235       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.218299815983       residual = 6.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.231614060656       residual = 3.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.190294499786       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.209422407385       residual = 6.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.223407368302       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.228939423449       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.204685813216       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.209285465698       residual = 9.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.226313994760       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.223925075390       residual = 7.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.218535336023       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.240055375124       residual = 9.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.219960602138       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.163460652113       residual = 4.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.118559541090       residual = 1.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.203409511020       residual = 4.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.428061769345       residual = 7.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.107148440144       residual = 1.97e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.373866770222       residual = 3.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.201864770389       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.947238051896       residual = 1.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.537472253077       residual = 1.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.577561546117       residual = 2.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.245845198445       residual = 2.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.858527786581       residual = 1.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.298385355803       residual = 1.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.205247206333       residual = 1.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.226123778699       residual = 2.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.169492934596       residual = 6.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.143863598530       residual = 1.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.387508738299       residual = 4.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.265842150493       residual = 4.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.993798221043       residual = 7.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.250318672020       residual = 7.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.058149985147       residual = 3.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.873762005691       residual = 1.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.408177839977       residual = 1.29e+01           smallest_sin_value = 9.99e-01
davidson iteration   57:   krylov dim =  58   energy =     -16.599085115799       residual = 6.14e+01           smallest_sin_value = 9.99e-01
davidson iteration   58:   krylov dim =  59   energy =     -16.885779327789       residual = 1.61e+01           smallest_sin_value = 9.93e-01
davidson iteration   59 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         59 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+11 is 3.457397e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.666178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6900e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2414
    reference variance = 0.236633
====================================================
  Execution time = 2.2653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1206e-01
  Total weights = 1.9566e+06
  Execution time = 1.9199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298879099891
                                         uncertainty =       0.002114875846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298879099891
                                         uncertainty =       0.002114875846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386536338
  error estimate for blocks of size 2^( 2) =       0.000396632768
  error estimate for blocks of size 2^( 3) =       0.000405357414
  error estimate for blocks of size 2^( 4) =       0.000412277137
  error estimate for blocks of size 2^( 5) =       0.000416134134
  error estimate for blocks of size 2^( 6) =       0.000416940900
  error estimate for blocks of size 2^( 7) =       0.000417993415

      target function =                  N/A
              le_mean =     -17.216668509522
             les_mean =     296.725736062002
             stat err =       0.000415836396
             autocorr =       1.157349002997
              std dev =       0.546644931297
             le_variance =       0.298820680913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298879099891
                                         uncertainty =       0.002114875846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298879099891
                                         uncertainty =       0.002114875846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386536338
  error estimate for blocks of size 2^( 2) =       0.000396632768
  error estimate for blocks of size 2^( 3) =       0.000405357414
  error estimate for blocks of size 2^( 4) =       0.000412277137
  error estimate for blocks of size 2^( 5) =       0.000416134134
  error estimate for blocks of size 2^( 6) =       0.000416940900
  error estimate for blocks of size 2^( 7) =       0.000417993415

      target function =                  N/A
              le_mean =     -17.216668509522
             les_mean =     296.725736062002
             stat err =       0.000415836396
             autocorr =       1.157349003002
              std dev =       0.546644931297
             le_variance =       0.298820680912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298879099891
                                         uncertainty =       0.002114875846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298879099891
                                         uncertainty =       0.002114875846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386536338
  error estimate for blocks of size 2^( 2) =       0.000396632768
  error estimate for blocks of size 2^( 3) =       0.000405357414
  error estimate for blocks of size 2^( 4) =       0.000412277137
  error estimate for blocks of size 2^( 5) =       0.000416134134
  error estimate for blocks of size 2^( 6) =       0.000416940900
  error estimate for blocks of size 2^( 7) =       0.000417993415

      target function =                  N/A
              le_mean =     -17.216668509522
             les_mean =     296.725736062002
             stat err =       0.000415836396
             autocorr =       1.157349003002
              std dev =       0.546644931297
             le_variance =       0.298820680912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298879099891
                                         uncertainty =       0.002114875846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298879099891
                                         uncertainty =       0.002114875846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386536338
  error estimate for blocks of size 2^( 2) =       0.000396632768
  error estimate for blocks of size 2^( 3) =       0.000405357414
  error estimate for blocks of size 2^( 4) =       0.000412277137
  error estimate for blocks of size 2^( 5) =       0.000416134134
  error estimate for blocks of size 2^( 6) =       0.000416940900
  error estimate for blocks of size 2^( 7) =       0.000417993415

      target function =                  N/A
              le_mean =     -17.216668509522
             les_mean =     296.725736062002
             stat err =       0.000415836396
             autocorr =       1.157349003005
              std dev =       0.546644931297
             le_variance =       0.298820680913


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216668509522        initial  <--
     5.9605e+10     5.9605e+11             1.3700e-14       -17.216668509522
     2.3842e+11     2.3842e+12             3.2391e-15       -17.216668509522
     9.5367e+11     9.5367e+12             3.4574e-16       -17.216668509522

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.9889
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8895e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1849
    reference variance = 0.432735
====================================================
  Execution time = 2.0889e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1428e-01
  Total weights = 1.956976123e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297873315128
                                         uncertainty =       0.002555901375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297873315128
                                         uncertainty =       0.002555901375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385890441
  error estimate for blocks of size 2^( 2) =       0.000395679835
  error estimate for blocks of size 2^( 3) =       0.000404379931
  error estimate for blocks of size 2^( 4) =       0.000410478136
  error estimate for blocks of size 2^( 5) =       0.000414481635
  error estimate for blocks of size 2^( 6) =       0.000416987988
  error estimate for blocks of size 2^( 7) =       0.000416949565

      target function =                  N/A
              le_mean =     -17.216817190890
             les_mean =     296.733077081764
             stat err =       0.000414724331
             autocorr =       1.155023947724
              std dev =       0.545731495582
             le_variance =       0.297822865270


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721681719089e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216817190945       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216817190945       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216817190945       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216816907915       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216711974966       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216350550655       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217075340388       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216265534513       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.222460822217       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.225761351910       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.219852385789       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216058052825       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213822909952       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.205198835930       residual = 2.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214405742791       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.206678761243       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215452064061       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.209017564284       residual = 9.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215614685463       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.220148632301       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.203911427675       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.206216310814       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.215938451783       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.215408918913       residual = 6.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.172219189609       residual = 3.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.252596253741       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.244475433592       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.217500150165       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.242147283109       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.217495051873       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.210860593305       residual = 8.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.073086925140       residual = 3.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.138459835005       residual = 9.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.225164350370       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.187987375725       residual = 1.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.257625674451       residual = 2.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.272984763418       residual = 4.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.275328147517       residual = 5.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.176883267566       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.225681459877       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.168016324293       residual = 3.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.106883841197       residual = 1.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.225480077041       residual = 3.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.220558705327       residual = 4.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.188399441875       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.189638108885       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.155858490011       residual = 5.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.231384295698       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.332542632761       residual = 2.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.289341427081       residual = 9.23e-01           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   energy =     -17.266408796745       residual = 6.73e-01           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   energy =     -17.263738639620       residual = 3.94e-01           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   energy =     -17.121510495025       residual = 1.29e+00           smallest_sin_value = 9.94e-01
davidson iteration   53:   krylov dim =  54   energy =     -17.231272787368       residual = 6.86e-02           smallest_sin_value = 9.92e-01
davidson iteration   54:   krylov dim =  55   energy =     -17.395994375176       residual = 4.93e+00           smallest_sin_value = 9.92e-01
davidson iteration   55:   krylov dim =  56   energy =     -17.287108894734       residual = 8.44e-01           smallest_sin_value = 9.91e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.60e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+11 is 5.953942e-16

solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216817190945       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216817190945       residual = 8.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216817190945       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216817190945       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216578108537       residual = 8.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.218167248457       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.207915720539       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.221707327004       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.189940521869       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.185493428324       residual = 1.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.205301315071       residual = 2.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.263002649875       residual = 3.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.230328920957       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.258049324930       residual = 2.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.193069444595       residual = 8.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.281791680711       residual = 6.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.264329681161       residual = 3.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.199565549625       residual = 4.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.235729441695       residual = 9.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.264411799637       residual = 3.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.069456976735       residual = 3.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.135096465747       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.025095182996       residual = 5.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.178985715127       residual = 3.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.365209042275       residual = 3.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.062380843017       residual = 4.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.182775283981       residual = 1.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.769938835524       residual = 3.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.195996122636       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.135694915181       residual = 9.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.373001177493       residual = 1.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.588864792667       residual = 2.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.155665628724       residual = 7.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.222624847422       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.360154810087       residual = 3.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.442537247403       residual = 9.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.097164589672       residual = 3.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.038921449707       residual = 8.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.150642687926       residual = 2.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.459374563395       residual = 1.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.385800162547       residual = 9.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.515024643074       residual = 7.76e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.448290654563       residual = 1.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.612876101054       residual = 2.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.899831623552       residual = 1.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.107899253559       residual = 1.98e+02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -15.252227109788       residual = 6.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.140069226401       residual = 3.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.278608766305       residual = 1.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -18.050765376108       residual = 1.82e+02           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   energy =     -17.973324994206       residual = 9.16e+01           smallest_sin_value = 9.98e-01
davidson iteration   51:   krylov dim =  52   energy =     -17.500376553336       residual = 3.34e+01           smallest_sin_value = 9.94e-01
davidson iteration   52:   krylov dim =  53   energy =     -17.608400405527       residual = 2.44e+01           smallest_sin_value = 9.91e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+12 is 1.531123e-16

solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216817190945       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216817190945       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.799288 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7053e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2726
    reference variance = 0.174889
====================================================
  Execution time = 2.0635e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1126e-01
  Total weights = 1.9567e+06
  Execution time = 1.8289e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299161250012
                                         uncertainty =       0.001552709762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299161250012
                                         uncertainty =       0.001552709762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386711171
  error estimate for blocks of size 2^( 2) =       0.000396802067
  error estimate for blocks of size 2^( 3) =       0.000405758596
  error estimate for blocks of size 2^( 4) =       0.000412843817
  error estimate for blocks of size 2^( 5) =       0.000417576857
  error estimate for blocks of size 2^( 6) =       0.000418601907
  error estimate for blocks of size 2^( 7) =       0.000420947398

      target function =                  N/A
              le_mean =     -17.216204339679
             les_mean =     296.708951704046
             stat err =       0.000417492495
             autocorr =       1.165531214171
              std dev =       0.546892183439
             le_variance =       0.299091060307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299161250012
                                         uncertainty =       0.001552709762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299161250012
                                         uncertainty =       0.001552709762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386711171
  error estimate for blocks of size 2^( 2) =       0.000396802067
  error estimate for blocks of size 2^( 3) =       0.000405758596
  error estimate for blocks of size 2^( 4) =       0.000412843817
  error estimate for blocks of size 2^( 5) =       0.000417576857
  error estimate for blocks of size 2^( 6) =       0.000418601907
  error estimate for blocks of size 2^( 7) =       0.000420947398

      target function =                  N/A
              le_mean =     -17.216204339679
             les_mean =     296.708951704046
             stat err =       0.000417492495
             autocorr =       1.165531214166
              std dev =       0.546892183440
             le_variance =       0.299091060307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299161250012
                                         uncertainty =       0.001552709762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299161250012
                                         uncertainty =       0.001552709762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386711171
  error estimate for blocks of size 2^( 2) =       0.000396802067
  error estimate for blocks of size 2^( 3) =       0.000405758596
  error estimate for blocks of size 2^( 4) =       0.000412843817
  error estimate for blocks of size 2^( 5) =       0.000417576857
  error estimate for blocks of size 2^( 6) =       0.000418601907
  error estimate for blocks of size 2^( 7) =       0.000420947398

      target function =                  N/A
              le_mean =     -17.216204339679
             les_mean =     296.708951704046
             stat err =       0.000417492495
             autocorr =       1.165531214171
              std dev =       0.546892183440
             le_variance =       0.299091060307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299161250012
                                         uncertainty =       0.001552709762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299161250012
                                         uncertainty =       0.001552709762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386711171
  error estimate for blocks of size 2^( 2) =       0.000396802067
  error estimate for blocks of size 2^( 3) =       0.000405758596
  error estimate for blocks of size 2^( 4) =       0.000412843817
  error estimate for blocks of size 2^( 5) =       0.000417576857
  error estimate for blocks of size 2^( 6) =       0.000418601907
  error estimate for blocks of size 2^( 7) =       0.000420947398

      target function =                  N/A
              le_mean =     -17.216204339679
             les_mean =     296.708951704046
             stat err =       0.000417492495
             autocorr =       1.165531214171
              std dev =       0.546892183439
             le_variance =       0.299091060307


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216204339679        initial  <--
     5.9605e+11     5.9605e+12             5.9539e-16       -17.216204339679
     2.3842e+12     2.3842e+13             1.5311e-16       -17.216204339679
     9.5367e+12     9.5367e+13             0.0000e+00       -17.216204339679

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8614
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6920e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2738
    reference variance = 0.201113
====================================================
  Execution time = 2.0876e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1607e-01
  Total weights = 1.956597189e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301689754907
                                         uncertainty =       0.002768142521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301689754907
                                         uncertainty =       0.002768142521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388358965
  error estimate for blocks of size 2^( 2) =       0.000398321522
  error estimate for blocks of size 2^( 3) =       0.000406960455
  error estimate for blocks of size 2^( 4) =       0.000413620834
  error estimate for blocks of size 2^( 5) =       0.000416971079
  error estimate for blocks of size 2^( 6) =       0.000420479109
  error estimate for blocks of size 2^( 7) =       0.000419525879

      target function =                  N/A
              le_mean =     -17.217154343695
             les_mean =     296.746477028599
             stat err =       0.000417649225
             autocorr =       1.156529431632
              std dev =       0.549222516017
             le_variance =       0.301645372100


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721715434370e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+12, overlap shift 5.9605e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217154343759       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217154343759       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217154343759       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217154343759       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217154343759       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217943706843       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215855597156       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.230064039542       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.202429947320       residual = 4.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.161683559843       residual = 4.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.252151678688       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.185098018098       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215538157194       residual = 7.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.170899422326       residual = 3.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.243551386270       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.207240197492       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.232262772961       residual = 5.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.238730349177       residual = 6.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.252115167395       residual = 1.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.256176519533       residual = 2.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.170050512519       residual = 3.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.061720347699       residual = 3.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.951532135123       residual = 1.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.206854671979       residual = 3.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.283551629008       residual = 6.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.708725040939       residual = 3.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.319421944148       residual = 1.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.193356931640       residual = 1.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.150726284854       residual = 6.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.093598236888       residual = 2.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.016391379864       residual = 6.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.192178418151       residual = 2.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.587469720058       residual = 2.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.145443544443       residual = 9.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.476014667475       residual = 1.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.526670237996       residual = 1.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.212647203659       residual = 2.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.763818815563       residual = 3.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.474107279427       residual = 1.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.336471636086       residual = 1.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.420895431018       residual = 1.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.195246223245       residual = 4.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.136524558665       residual = 2.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -15.998924984811       residual = 2.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.269289849199       residual = 1.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -15.430887430821       residual = 4.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -15.863786790349       residual = 2.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -13.858619474778       residual = 1.73e+03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.710296396415       residual = 6.44e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -18.921450405143       residual = 4.63e+02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.988221980936       residual = 1.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.733938312012       residual = 5.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.931673095873       residual = 3.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.199963376812       residual = 9.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -18.057450889905       residual = 1.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -18.763034177240       residual = 3.84e+02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -11.314794898585       residual = 5.42e+03           smallest_sin_value = 9.98e-01
davidson iteration   57:   krylov dim =  58   energy =     -19.041072478453       residual = 5.36e+02           smallest_sin_value = 9.97e-01
davidson iteration   58:   krylov dim =  59   energy =     -15.951734947155       residual = 3.22e+02           smallest_sin_value = 9.97e-01
davidson iteration   59 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         59 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+12 is 8.571269e-17

solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217154343759       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217154343759       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217154343759       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217154343759       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.286513486068       residual = 7.06e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.244928108559       residual = 1.66e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.207179964098       residual = 4.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.228582981195       residual = 2.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.199260154619       residual = 1.54e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.165203529001       residual = 6.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.188194856937       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.244444370284       residual = 4.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.203288600230       residual = 8.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.244593323581       residual = 2.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.199514729597       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.763508863118       residual = 4.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.619385198042       residual = 2.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.206781498934       residual = 1.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.511419046381       residual = 1.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.043621574427       residual = 6.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.765874122841       residual = 6.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.678129889346       residual = 5.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.759904189212       residual = 6.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.085860267355       residual = 6.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.780508486737       residual = 4.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.271911016206       residual = 4.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.897167519580       residual = 7.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.131583040091       residual = 1.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -18.313084780890       residual = 1.96e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -19.610499116468       residual = 8.73e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -14.729463082070       residual = 1.07e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -18.742606655773       residual = 3.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.518817749846       residual = 7.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -14.651688309055       residual = 1.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.738964265437       residual = 5.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -14.132928491221       residual = 1.44e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.922713612501       residual = 1.01e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -15.477418374821       residual = 4.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.303733624299       residual = 8.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.658082999063       residual = 9.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -13.737478618346       residual = 1.85e+03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -11.841462200446       residual = 4.46e+03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -19.618121453219       residual = 1.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -15.017609212674       residual = 7.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -20.279549617851       residual = 1.46e+03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -14.671242424474       residual = 9.63e+02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -14.200550464666       residual = 1.37e+03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -21.210835079758       residual = 2.27e+03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -23.855111514562       residual = 7.39e+03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -11.277691477669       residual = 7.23e+03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.166016760836       residual = 3.88e+02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -20.229725323957       residual = 1.52e+03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -11.498638884979       residual = 5.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =      -8.360860291071       residual = 1.18e+04           smallest_sin_value = 1.00e+00
davidson iteration   54 stopping due to too large eigenvalue change
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+13 is 2.215330e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217154343759       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217154343759       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217154343759       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217154343759       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+13 is 5.538325e-18

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.948280 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7043e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.3412
    reference variance = 0.503305
====================================================
  Execution time = 2.0442e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1185e-01
  Total weights = 1.9566e+06
  Execution time = 1.8364e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297783397534
                                         uncertainty =       0.002029453944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297783397534
                                         uncertainty =       0.002029453944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385854201
  error estimate for blocks of size 2^( 2) =       0.000396241439
  error estimate for blocks of size 2^( 3) =       0.000405411815
  error estimate for blocks of size 2^( 4) =       0.000412534274
  error estimate for blocks of size 2^( 5) =       0.000416600469
  error estimate for blocks of size 2^( 6) =       0.000418792738
  error estimate for blocks of size 2^( 7) =       0.000422372754

      target function =                  N/A
              le_mean =     -17.216824482247
             les_mean =     296.730893017937
             stat err =       0.000417575059
             autocorr =       1.171177269049
              std dev =       0.545680244675
             le_variance =       0.297766929429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297783397534
                                         uncertainty =       0.002029453944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297783397534
                                         uncertainty =       0.002029453944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385854201
  error estimate for blocks of size 2^( 2) =       0.000396241439
  error estimate for blocks of size 2^( 3) =       0.000405411815
  error estimate for blocks of size 2^( 4) =       0.000412534274
  error estimate for blocks of size 2^( 5) =       0.000416600469
  error estimate for blocks of size 2^( 6) =       0.000418792738
  error estimate for blocks of size 2^( 7) =       0.000422372754

      target function =                  N/A
              le_mean =     -17.216824482247
             les_mean =     296.730893017937
             stat err =       0.000417575059
             autocorr =       1.171177269050
              std dev =       0.545680244675
             le_variance =       0.297766929429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297783397534
                                         uncertainty =       0.002029453944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297783397534
                                         uncertainty =       0.002029453944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385854201
  error estimate for blocks of size 2^( 2) =       0.000396241439
  error estimate for blocks of size 2^( 3) =       0.000405411815
  error estimate for blocks of size 2^( 4) =       0.000412534274
  error estimate for blocks of size 2^( 5) =       0.000416600469
  error estimate for blocks of size 2^( 6) =       0.000418792738
  error estimate for blocks of size 2^( 7) =       0.000422372754

      target function =                  N/A
              le_mean =     -17.216824482247
             les_mean =     296.730893017937
             stat err =       0.000417575059
             autocorr =       1.171177269049
              std dev =       0.545680244675
             le_variance =       0.297766929429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297783397534
                                         uncertainty =       0.002029453944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297783397534
                                         uncertainty =       0.002029453944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385854201
  error estimate for blocks of size 2^( 2) =       0.000396241439
  error estimate for blocks of size 2^( 3) =       0.000405411815
  error estimate for blocks of size 2^( 4) =       0.000412534274
  error estimate for blocks of size 2^( 5) =       0.000416600469
  error estimate for blocks of size 2^( 6) =       0.000418792738
  error estimate for blocks of size 2^( 7) =       0.000422372754

      target function =                  N/A
              le_mean =     -17.216824482247
             les_mean =     296.730893017937
             stat err =       0.000417575059
             autocorr =       1.171177269053
              std dev =       0.545680244675
             le_variance =       0.297766929429


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216824482247        initial  <--
     5.9605e+12     5.9605e+13             8.5713e-17       -17.216824482247
     2.3842e+13     2.3842e+14             2.2153e-17       -17.216824482247
     9.5367e+13     9.5367e+14             5.5383e-18       -17.216824482247

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7081
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6757e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2429
    reference variance = 0.354714
====================================================
  Execution time = 2.0625e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1744e-01
  Total weights = 1.956789579e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300415053987
                                         uncertainty =       0.002157817942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300415053987
                                         uncertainty =       0.002157817942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387604807
  error estimate for blocks of size 2^( 2) =       0.000397846994
  error estimate for blocks of size 2^( 3) =       0.000407408241
  error estimate for blocks of size 2^( 4) =       0.000413512592
  error estimate for blocks of size 2^( 5) =       0.000417697525
  error estimate for blocks of size 2^( 6) =       0.000419986205
  error estimate for blocks of size 2^( 7) =       0.000420744006

      target function =                  N/A
              le_mean =     -17.216698412468
             les_mean =     296.732140341402
             stat err =       0.000417985082
             autocorr =       1.162902368672
              std dev =       0.548155974606
             le_variance =       0.300474972496


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669841247e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+13, overlap shift 5.9605e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216698412513       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216698412513       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.69e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216698412513       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216698412513       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.69e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216698412513       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216698412513       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.73e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.949436 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6686e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2067
    reference variance = 0.239211
====================================================
  Execution time = 2.0457e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1919e-01
  Total weights = 1.9565e+06
  Execution time = 1.8387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301952850432
                                         uncertainty =       0.002501925850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301952850432
                                         uncertainty =       0.002501925850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388550206
  error estimate for blocks of size 2^( 2) =       0.000398618989
  error estimate for blocks of size 2^( 3) =       0.000407236470
  error estimate for blocks of size 2^( 4) =       0.000413321606
  error estimate for blocks of size 2^( 5) =       0.000417300417
  error estimate for blocks of size 2^( 6) =       0.000419165736
  error estimate for blocks of size 2^( 7) =       0.000419897395

      target function =                  N/A
              le_mean =     -17.216121922461
             les_mean =     296.714046446224
             stat err =       0.000417421289
             autocorr =       1.154130457797
              std dev =       0.549492970559
             le_variance =       0.301942524694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301952850432
                                         uncertainty =       0.002501925850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301952850432
                                         uncertainty =       0.002501925850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388550206
  error estimate for blocks of size 2^( 2) =       0.000398618989
  error estimate for blocks of size 2^( 3) =       0.000407236470
  error estimate for blocks of size 2^( 4) =       0.000413321606
  error estimate for blocks of size 2^( 5) =       0.000417300417
  error estimate for blocks of size 2^( 6) =       0.000419165736
  error estimate for blocks of size 2^( 7) =       0.000419897395

      target function =                  N/A
              le_mean =     -17.216121922461
             les_mean =     296.714046446224
             stat err =       0.000417421289
             autocorr =       1.154130457797
              std dev =       0.549492970559
             le_variance =       0.301942524694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301952850432
                                         uncertainty =       0.002501925850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301952850432
                                         uncertainty =       0.002501925850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388550206
  error estimate for blocks of size 2^( 2) =       0.000398618989
  error estimate for blocks of size 2^( 3) =       0.000407236470
  error estimate for blocks of size 2^( 4) =       0.000413321606
  error estimate for blocks of size 2^( 5) =       0.000417300417
  error estimate for blocks of size 2^( 6) =       0.000419165736
  error estimate for blocks of size 2^( 7) =       0.000419897395

      target function =                  N/A
              le_mean =     -17.216121922461
             les_mean =     296.714046446224
             stat err =       0.000417421289
             autocorr =       1.154130457797
              std dev =       0.549492970559
             le_variance =       0.301942524694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301952850432
                                         uncertainty =       0.002501925850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301952850432
                                         uncertainty =       0.002501925850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388550206
  error estimate for blocks of size 2^( 2) =       0.000398618989
  error estimate for blocks of size 2^( 3) =       0.000407236470
  error estimate for blocks of size 2^( 4) =       0.000413321606
  error estimate for blocks of size 2^( 5) =       0.000417300417
  error estimate for blocks of size 2^( 6) =       0.000419165736
  error estimate for blocks of size 2^( 7) =       0.000419897395

      target function =                  N/A
              le_mean =     -17.216121922461
             les_mean =     296.714046446224
             stat err =       0.000417421289
             autocorr =       1.154130457797
              std dev =       0.549492970559
             le_variance =       0.301942524694


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216121922461        initial  <--
     5.9605e+13     5.9605e+14             0.0000e+00       -17.216121922461
     2.3842e+14     2.3842e+15             0.0000e+00       -17.216121922461
     9.5367e+14     9.5367e+15             0.0000e+00       -17.216121922461

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7367
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2336
    reference variance = 0.241965
====================================================
  Execution time = 2.0786e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1474e-01
  Total weights = 1.956611892e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0521e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298773895074
                                         uncertainty =       0.001894346663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298773895074
                                         uncertainty =       0.001894346663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386441731
  error estimate for blocks of size 2^( 2) =       0.000396588518
  error estimate for blocks of size 2^( 3) =       0.000405892780
  error estimate for blocks of size 2^( 4) =       0.000413090095
  error estimate for blocks of size 2^( 5) =       0.000416962611
  error estimate for blocks of size 2^( 6) =       0.000418742170
  error estimate for blocks of size 2^( 7) =       0.000418240214

      target function =                  N/A
              le_mean =     -17.217231462844
             les_mean =     296.747802145431
             stat err =       0.000416758773
             autocorr =       1.163058238751
              std dev =       0.546511137644
             le_variance =       0.298674423569


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721723146284e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+14, overlap shift 5.9605e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217231462882       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217231462882       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217231462882       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217231462882       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217231462882       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217231462882       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.950609 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6849e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.23
    reference variance = 0.182586
====================================================
  Execution time = 2.0759e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1258e-01
  Total weights = 1.9567e+06
  Execution time = 1.8392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299230696697
                                         uncertainty =       0.002391688446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299230696697
                                         uncertainty =       0.002391688446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386846585
  error estimate for blocks of size 2^( 2) =       0.000396611663
  error estimate for blocks of size 2^( 3) =       0.000405038845
  error estimate for blocks of size 2^( 4) =       0.000412344195
  error estimate for blocks of size 2^( 5) =       0.000416365378
  error estimate for blocks of size 2^( 6) =       0.000419660314
  error estimate for blocks of size 2^( 7) =       0.000419812125

      target function =                  N/A
              le_mean =     -17.215883879801
             les_mean =     296.699240686061
             stat err =       0.000417045503
             autocorr =       1.162222691436
              std dev =       0.547083687361
             le_variance =       0.299300560977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299230696697
                                         uncertainty =       0.002391688446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299230696697
                                         uncertainty =       0.002391688446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386846585
  error estimate for blocks of size 2^( 2) =       0.000396611663
  error estimate for blocks of size 2^( 3) =       0.000405038845
  error estimate for blocks of size 2^( 4) =       0.000412344195
  error estimate for blocks of size 2^( 5) =       0.000416365378
  error estimate for blocks of size 2^( 6) =       0.000419660314
  error estimate for blocks of size 2^( 7) =       0.000419812125

      target function =                  N/A
              le_mean =     -17.215883879801
             les_mean =     296.699240686061
             stat err =       0.000417045503
             autocorr =       1.162222691436
              std dev =       0.547083687361
             le_variance =       0.299300560977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299230696697
                                         uncertainty =       0.002391688446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299230696697
                                         uncertainty =       0.002391688446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386846585
  error estimate for blocks of size 2^( 2) =       0.000396611663
  error estimate for blocks of size 2^( 3) =       0.000405038845
  error estimate for blocks of size 2^( 4) =       0.000412344195
  error estimate for blocks of size 2^( 5) =       0.000416365378
  error estimate for blocks of size 2^( 6) =       0.000419660314
  error estimate for blocks of size 2^( 7) =       0.000419812125

      target function =                  N/A
              le_mean =     -17.215883879801
             les_mean =     296.699240686061
             stat err =       0.000417045503
             autocorr =       1.162222691436
              std dev =       0.547083687361
             le_variance =       0.299300560977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299230696697
                                         uncertainty =       0.002391688446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299230696697
                                         uncertainty =       0.002391688446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386846585
  error estimate for blocks of size 2^( 2) =       0.000396611663
  error estimate for blocks of size 2^( 3) =       0.000405038845
  error estimate for blocks of size 2^( 4) =       0.000412344195
  error estimate for blocks of size 2^( 5) =       0.000416365378
  error estimate for blocks of size 2^( 6) =       0.000419660314
  error estimate for blocks of size 2^( 7) =       0.000419812125

      target function =                  N/A
              le_mean =     -17.215883879801
             les_mean =     296.699240686061
             stat err =       0.000417045503
             autocorr =       1.162222691436
              std dev =       0.547083687361
             le_variance =       0.299300560977


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215883879801        initial  <--
     5.9605e+14     5.9605e+15             0.0000e+00       -17.215883879801
     2.3842e+15     2.3842e+16             0.0000e+00       -17.215883879801
     9.5367e+15     9.5367e+16             0.0000e+00       -17.215883879801

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0522
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6907e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.3276
    reference variance = 0.230789
====================================================
  Execution time = 2.0613e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1097e-01
  Total weights = 1.956685176e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0497e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297870328668
                                         uncertainty =       0.002143507555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297870328668
                                         uncertainty =       0.002143507555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385939174
  error estimate for blocks of size 2^( 2) =       0.000395823935
  error estimate for blocks of size 2^( 3) =       0.000404727527
  error estimate for blocks of size 2^( 4) =       0.000411596902
  error estimate for blocks of size 2^( 5) =       0.000415957138
  error estimate for blocks of size 2^( 6) =       0.000417845891
  error estimate for blocks of size 2^( 7) =       0.000421135473

      target function =                  N/A
              le_mean =     -17.216492017112
             les_mean =     296.718570927149
             stat err =       0.000416633851
             autocorr =       1.165390248975
              std dev =       0.545800413934
             le_variance =       0.297898091851


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649201711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+15, overlap shift 5.9605e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216492017169       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216492017169       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216492017169       residual = 1.22e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -13.399862563252       residual = 2.28e+03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.528381433619       residual = 1.45e+01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+15 is 5.447416e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216492017169       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216492017169       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216492017169       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+16 is 1.361854e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216492017169       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216492017169       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216492017169       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 7.03e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+16 is 3.404635e-21

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.952505 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6674e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2566
    reference variance = 0.210985
====================================================
  Execution time = 2.0423e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1407e-01
  Total weights = 1.9566e+06
  Execution time = 1.8348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299765630346
                                         uncertainty =       0.001851012557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299765630346
                                         uncertainty =       0.001851012557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387123943
  error estimate for blocks of size 2^( 2) =       0.000397583977
  error estimate for blocks of size 2^( 3) =       0.000406967238
  error estimate for blocks of size 2^( 4) =       0.000413766803
  error estimate for blocks of size 2^( 5) =       0.000418365857
  error estimate for blocks of size 2^( 6) =       0.000420844540
  error estimate for blocks of size 2^( 7) =       0.000426305707

      target function =                  N/A
              le_mean =     -17.216462365356
             les_mean =     296.720641660596
             stat err =       0.000419820727
             autocorr =       1.176055146178
              std dev =       0.547475930700
             le_variance =       0.299729894696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299765630346
                                         uncertainty =       0.001851012557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299765630346
                                         uncertainty =       0.001851012557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387123943
  error estimate for blocks of size 2^( 2) =       0.000397583977
  error estimate for blocks of size 2^( 3) =       0.000406967238
  error estimate for blocks of size 2^( 4) =       0.000413766803
  error estimate for blocks of size 2^( 5) =       0.000418365857
  error estimate for blocks of size 2^( 6) =       0.000420844540
  error estimate for blocks of size 2^( 7) =       0.000426305707

      target function =                  N/A
              le_mean =     -17.216462365356
             les_mean =     296.720641660596
             stat err =       0.000419820727
             autocorr =       1.176055146178
              std dev =       0.547475930700
             le_variance =       0.299729894696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299765630346
                                         uncertainty =       0.001851012557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299765630346
                                         uncertainty =       0.001851012557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387123943
  error estimate for blocks of size 2^( 2) =       0.000397583977
  error estimate for blocks of size 2^( 3) =       0.000406967238
  error estimate for blocks of size 2^( 4) =       0.000413766803
  error estimate for blocks of size 2^( 5) =       0.000418365857
  error estimate for blocks of size 2^( 6) =       0.000420844540
  error estimate for blocks of size 2^( 7) =       0.000426305707

      target function =                  N/A
              le_mean =     -17.216462365356
             les_mean =     296.720641660596
             stat err =       0.000419820727
             autocorr =       1.176055146178
              std dev =       0.547475930700
             le_variance =       0.299729894696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299765630346
                                         uncertainty =       0.001851012557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299765630346
                                         uncertainty =       0.001851012557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387123943
  error estimate for blocks of size 2^( 2) =       0.000397583977
  error estimate for blocks of size 2^( 3) =       0.000406967238
  error estimate for blocks of size 2^( 4) =       0.000413766803
  error estimate for blocks of size 2^( 5) =       0.000418365857
  error estimate for blocks of size 2^( 6) =       0.000420844540
  error estimate for blocks of size 2^( 7) =       0.000426305707

      target function =                  N/A
              le_mean =     -17.216462365356
             les_mean =     296.720641660596
             stat err =       0.000419820727
             autocorr =       1.176055146178
              std dev =       0.547475930700
             le_variance =       0.299729894696


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216462365356        initial  <--
     5.9605e+15     5.9605e+16             5.4474e-20       -17.216462365356
     2.3842e+16     2.3842e+17             1.3619e-20       -17.216462365356
     9.5367e+16     9.5367e+17             3.4046e-21       -17.216462365356

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6749
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6355e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2494
    reference variance = 0.314356
====================================================
  Execution time = 2.2761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1192e-01
  Total weights = 1.956744869e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297043171144
                                         uncertainty =       0.001713970914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297043171144
                                         uncertainty =       0.001713970914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385371815
  error estimate for blocks of size 2^( 2) =       0.000395531394
  error estimate for blocks of size 2^( 3) =       0.000404538217
  error estimate for blocks of size 2^( 4) =       0.000411970414
  error estimate for blocks of size 2^( 5) =       0.000415960258
  error estimate for blocks of size 2^( 6) =       0.000418505864
  error estimate for blocks of size 2^( 7) =       0.000419207438

      target function =                  N/A
              le_mean =     -17.216816803302
             les_mean =     296.730696609042
             stat err =       0.000416410994
             autocorr =       1.167574166810
              std dev =       0.544998046981
             le_variance =       0.297022871213


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721681680330e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+16, overlap shift 5.9605e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216816803331       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216816803331       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216816803331       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216816803331       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216816803331       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216816803331       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.953653 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8927e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1752
    reference variance = 0.186068
====================================================
  Execution time = 2.0947e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1648e-01
  Total weights = 1.9564e+06
  Execution time = 1.8328e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302195366808
                                         uncertainty =       0.001895761120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302195366808
                                         uncertainty =       0.001895761120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388720239
  error estimate for blocks of size 2^( 2) =       0.000398501674
  error estimate for blocks of size 2^( 3) =       0.000408087803
  error estimate for blocks of size 2^( 4) =       0.000415272526
  error estimate for blocks of size 2^( 5) =       0.000419504082
  error estimate for blocks of size 2^( 6) =       0.000421645627
  error estimate for blocks of size 2^( 7) =       0.000422827198

      target function =                  N/A
              le_mean =     -17.216369703889
             les_mean =     296.719863442924
             stat err =       0.000419812358
             autocorr =       1.166369438822
              std dev =       0.549733433941
             le_variance =       0.302206848393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302195366808
                                         uncertainty =       0.001895761120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302195366808
                                         uncertainty =       0.001895761120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388720239
  error estimate for blocks of size 2^( 2) =       0.000398501674
  error estimate for blocks of size 2^( 3) =       0.000408087803
  error estimate for blocks of size 2^( 4) =       0.000415272526
  error estimate for blocks of size 2^( 5) =       0.000419504082
  error estimate for blocks of size 2^( 6) =       0.000421645627
  error estimate for blocks of size 2^( 7) =       0.000422827198

      target function =                  N/A
              le_mean =     -17.216369703889
             les_mean =     296.719863442924
             stat err =       0.000419812358
             autocorr =       1.166369438822
              std dev =       0.549733433941
             le_variance =       0.302206848393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302195366808
                                         uncertainty =       0.001895761120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302195366808
                                         uncertainty =       0.001895761120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388720239
  error estimate for blocks of size 2^( 2) =       0.000398501674
  error estimate for blocks of size 2^( 3) =       0.000408087803
  error estimate for blocks of size 2^( 4) =       0.000415272526
  error estimate for blocks of size 2^( 5) =       0.000419504082
  error estimate for blocks of size 2^( 6) =       0.000421645627
  error estimate for blocks of size 2^( 7) =       0.000422827198

      target function =                  N/A
              le_mean =     -17.216369703889
             les_mean =     296.719863442924
             stat err =       0.000419812358
             autocorr =       1.166369438822
              std dev =       0.549733433941
             le_variance =       0.302206848393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302195366808
                                         uncertainty =       0.001895761120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302195366808
                                         uncertainty =       0.001895761120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388720239
  error estimate for blocks of size 2^( 2) =       0.000398501674
  error estimate for blocks of size 2^( 3) =       0.000408087803
  error estimate for blocks of size 2^( 4) =       0.000415272526
  error estimate for blocks of size 2^( 5) =       0.000419504082
  error estimate for blocks of size 2^( 6) =       0.000421645627
  error estimate for blocks of size 2^( 7) =       0.000422827198

      target function =                  N/A
              le_mean =     -17.216369703889
             les_mean =     296.719863442924
             stat err =       0.000419812358
             autocorr =       1.166369438822
              std dev =       0.549733433941
             le_variance =       0.302206848393


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216369703889        initial  <--
     5.9605e+16     5.9605e+17             0.0000e+00       -17.216369703889
     2.3842e+17     2.3842e+18             0.0000e+00       -17.216369703889
     9.5367e+17     9.5367e+18             0.0000e+00       -17.216369703889

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2165
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9149e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2383
    reference variance = 0.354677
====================================================
  Execution time = 2.0917e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1001e-01
  Total weights = 1.956281879e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1225e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296070811968
                                         uncertainty =       0.001980884088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296070811968
                                         uncertainty =       0.001980884088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384779622
  error estimate for blocks of size 2^( 2) =       0.000395048462
  error estimate for blocks of size 2^( 3) =       0.000403762835
  error estimate for blocks of size 2^( 4) =       0.000410486469
  error estimate for blocks of size 2^( 5) =       0.000415855062
  error estimate for blocks of size 2^( 6) =       0.000418159983
  error estimate for blocks of size 2^( 7) =       0.000420260964

      target function =                  N/A
              le_mean =     -17.217023567351
             les_mean =     296.735915185292
             stat err =       0.000416190619
             autocorr =       1.169931531885
              std dev =       0.544160560641
             le_variance =       0.296110715757


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721702356735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+17, overlap shift 5.9605e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217023567413       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217023567413       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217023567413       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217023567413       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217023567413       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217023567413       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.954850 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7050e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2017
    reference variance = 0.16977
====================================================
  Execution time = 2.0527e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1645e-01
  Total weights = 1.9569e+06
  Execution time = 1.8470e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301216858966
                                         uncertainty =       0.002678860665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301216858966
                                         uncertainty =       0.002678860665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388041653
  error estimate for blocks of size 2^( 2) =       0.000398212744
  error estimate for blocks of size 2^( 3) =       0.000407261576
  error estimate for blocks of size 2^( 4) =       0.000414176158
  error estimate for blocks of size 2^( 5) =       0.000418893558
  error estimate for blocks of size 2^( 6) =       0.000421206098
  error estimate for blocks of size 2^( 7) =       0.000421817790

      target function =                  N/A
              le_mean =     -17.216305906739
             les_mean =     296.717636611862
             stat err =       0.000419023401
             autocorr =       1.166057220029
              std dev =       0.548773768684
             le_variance =       0.301152649196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301216858966
                                         uncertainty =       0.002678860665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301216858966
                                         uncertainty =       0.002678860665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388041653
  error estimate for blocks of size 2^( 2) =       0.000398212744
  error estimate for blocks of size 2^( 3) =       0.000407261576
  error estimate for blocks of size 2^( 4) =       0.000414176158
  error estimate for blocks of size 2^( 5) =       0.000418893558
  error estimate for blocks of size 2^( 6) =       0.000421206098
  error estimate for blocks of size 2^( 7) =       0.000421817790

      target function =                  N/A
              le_mean =     -17.216305906739
             les_mean =     296.717636611862
             stat err =       0.000419023401
             autocorr =       1.166057220029
              std dev =       0.548773768684
             le_variance =       0.301152649196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301216858966
                                         uncertainty =       0.002678860665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301216858966
                                         uncertainty =       0.002678860665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388041653
  error estimate for blocks of size 2^( 2) =       0.000398212744
  error estimate for blocks of size 2^( 3) =       0.000407261576
  error estimate for blocks of size 2^( 4) =       0.000414176158
  error estimate for blocks of size 2^( 5) =       0.000418893558
  error estimate for blocks of size 2^( 6) =       0.000421206098
  error estimate for blocks of size 2^( 7) =       0.000421817790

      target function =                  N/A
              le_mean =     -17.216305906739
             les_mean =     296.717636611862
             stat err =       0.000419023401
             autocorr =       1.166057220029
              std dev =       0.548773768684
             le_variance =       0.301152649196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301216858966
                                         uncertainty =       0.002678860665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301216858966
                                         uncertainty =       0.002678860665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388041653
  error estimate for blocks of size 2^( 2) =       0.000398212744
  error estimate for blocks of size 2^( 3) =       0.000407261576
  error estimate for blocks of size 2^( 4) =       0.000414176158
  error estimate for blocks of size 2^( 5) =       0.000418893558
  error estimate for blocks of size 2^( 6) =       0.000421206098
  error estimate for blocks of size 2^( 7) =       0.000421817790

      target function =                  N/A
              le_mean =     -17.216305906739
             les_mean =     296.717636611862
             stat err =       0.000419023401
             autocorr =       1.166057220029
              std dev =       0.548773768684
             le_variance =       0.301152649196


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216305906739        initial  <--
     5.9605e+17     5.9605e+18             0.0000e+00       -17.216305906739
     2.3842e+18     2.3842e+19             0.0000e+00       -17.216305906739
     9.5367e+18     9.5367e+19             0.0000e+00       -17.216305906739

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8490
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6905e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1952
    reference variance = 0.404364
====================================================
  Execution time = 2.0577e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1542e-01
  Total weights = 1.956172925e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300679135927
                                         uncertainty =       0.002129181179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300679135927
                                         uncertainty =       0.002129181179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387694813
  error estimate for blocks of size 2^( 2) =       0.000397832284
  error estimate for blocks of size 2^( 3) =       0.000406771540
  error estimate for blocks of size 2^( 4) =       0.000413723072
  error estimate for blocks of size 2^( 5) =       0.000418732071
  error estimate for blocks of size 2^( 6) =       0.000420866866
  error estimate for blocks of size 2^( 7) =       0.000420125526

      target function =                  N/A
              le_mean =     -17.216749110981
             les_mean =     296.731868156679
             stat err =       0.000418361884
             autocorr =       1.164459097426
              std dev =       0.548283262601
             le_variance =       0.300614536049


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721674911098e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+18, overlap shift 5.9605e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216749111034       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216749111034       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+19, overlap shift 2.3842e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216749111034       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216749111034       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216749111034       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216749111034       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.956017 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6595e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1961
    reference variance = 0.166734
====================================================
  Execution time = 2.0659e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1796e-01
  Total weights = 1.9568e+06
  Execution time = 1.8375e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299531885115
                                         uncertainty =       0.001816341463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299531885115
                                         uncertainty =       0.001816341463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386961360
  error estimate for blocks of size 2^( 2) =       0.000396785950
  error estimate for blocks of size 2^( 3) =       0.000406145357
  error estimate for blocks of size 2^( 4) =       0.000412710389
  error estimate for blocks of size 2^( 5) =       0.000415820164
  error estimate for blocks of size 2^( 6) =       0.000418376828
  error estimate for blocks of size 2^( 7) =       0.000417514099

      target function =                  N/A
              le_mean =     -17.217184339646
             les_mean =     296.749399620177
             stat err =       0.000416105370
             autocorr =       1.156302436509
              std dev =       0.547246002977
             le_variance =       0.299478187774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299531885115
                                         uncertainty =       0.001816341463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299531885115
                                         uncertainty =       0.001816341463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386961360
  error estimate for blocks of size 2^( 2) =       0.000396785950
  error estimate for blocks of size 2^( 3) =       0.000406145357
  error estimate for blocks of size 2^( 4) =       0.000412710389
  error estimate for blocks of size 2^( 5) =       0.000415820164
  error estimate for blocks of size 2^( 6) =       0.000418376828
  error estimate for blocks of size 2^( 7) =       0.000417514099

      target function =                  N/A
              le_mean =     -17.217184339646
             les_mean =     296.749399620177
             stat err =       0.000416105370
             autocorr =       1.156302436509
              std dev =       0.547246002977
             le_variance =       0.299478187774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299531885115
                                         uncertainty =       0.001816341463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299531885115
                                         uncertainty =       0.001816341463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386961360
  error estimate for blocks of size 2^( 2) =       0.000396785950
  error estimate for blocks of size 2^( 3) =       0.000406145357
  error estimate for blocks of size 2^( 4) =       0.000412710389
  error estimate for blocks of size 2^( 5) =       0.000415820164
  error estimate for blocks of size 2^( 6) =       0.000418376828
  error estimate for blocks of size 2^( 7) =       0.000417514099

      target function =                  N/A
              le_mean =     -17.217184339646
             les_mean =     296.749399620177
             stat err =       0.000416105370
             autocorr =       1.156302436509
              std dev =       0.547246002977
             le_variance =       0.299478187774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299531885115
                                         uncertainty =       0.001816341463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299531885115
                                         uncertainty =       0.001816341463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386961360
  error estimate for blocks of size 2^( 2) =       0.000396785950
  error estimate for blocks of size 2^( 3) =       0.000406145357
  error estimate for blocks of size 2^( 4) =       0.000412710389
  error estimate for blocks of size 2^( 5) =       0.000415820164
  error estimate for blocks of size 2^( 6) =       0.000418376828
  error estimate for blocks of size 2^( 7) =       0.000417514099

      target function =                  N/A
              le_mean =     -17.217184339646
             les_mean =     296.749399620177
             stat err =       0.000416105370
             autocorr =       1.156302436509
              std dev =       0.547246002977
             le_variance =       0.299478187774


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217184339646        initial  <--
     5.9605e+18     5.9605e+19             0.0000e+00       -17.217184339646
     2.3842e+19     2.3842e+20             0.0000e+00       -17.217184339646
     9.5367e+19     9.5367e+20             0.0000e+00       -17.217184339646

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9268
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1624
    reference variance = 0.358271
====================================================
  Execution time = 2.0638e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1312e-01
  Total weights = 1.956640652e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298701258751
                                         uncertainty =       0.001671482028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298701258751
                                         uncertainty =       0.001671482028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386415803
  error estimate for blocks of size 2^( 2) =       0.000396438154
  error estimate for blocks of size 2^( 3) =       0.000405757655
  error estimate for blocks of size 2^( 4) =       0.000412072091
  error estimate for blocks of size 2^( 5) =       0.000416571537
  error estimate for blocks of size 2^( 6) =       0.000420102049
  error estimate for blocks of size 2^( 7) =       0.000420315114

      target function =                  N/A
              le_mean =     -17.216551798963
             les_mean =     296.722779636404
             stat err =       0.000417265198
             autocorr =       1.166043005711
              std dev =       0.546474469518
             le_variance =       0.298634345835


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655179896e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+19, overlap shift 5.9605e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216551798968       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216551798968       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216551798968       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216551798968       residual = 9.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216551798907       residual = 2.21e-01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+19 is 7.668227e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+20, overlap shift 2.3842e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216551798968       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216551798968       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216551798968       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216551798968       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+20 is 1.917057e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216551798968       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216551798968       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216551798968       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216551798968       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+20 is 4.792642e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.957863 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6778e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2174
    reference variance = 0.156392
====================================================
  Execution time = 2.0789e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1236e-01
  Total weights = 1.9565e+06
  Execution time = 1.8386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299300907252
                                         uncertainty =       0.002160685483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299300907252
                                         uncertainty =       0.002160685483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386863381
  error estimate for blocks of size 2^( 2) =       0.000397127951
  error estimate for blocks of size 2^( 3) =       0.000406140580
  error estimate for blocks of size 2^( 4) =       0.000413725690
  error estimate for blocks of size 2^( 5) =       0.000417594460
  error estimate for blocks of size 2^( 6) =       0.000421723714
  error estimate for blocks of size 2^( 7) =       0.000425025837

      target function =                  N/A
              le_mean =     -17.215966257449
             les_mean =     296.701857611599
             stat err =       0.000419517425
             autocorr =       1.175938918301
              std dev =       0.547107439691
             le_variance =       0.299326550566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299300907252
                                         uncertainty =       0.002160685483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299300907252
                                         uncertainty =       0.002160685483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386863381
  error estimate for blocks of size 2^( 2) =       0.000397127951
  error estimate for blocks of size 2^( 3) =       0.000406140580
  error estimate for blocks of size 2^( 4) =       0.000413725690
  error estimate for blocks of size 2^( 5) =       0.000417594460
  error estimate for blocks of size 2^( 6) =       0.000421723714
  error estimate for blocks of size 2^( 7) =       0.000425025837

      target function =                  N/A
              le_mean =     -17.215966257449
             les_mean =     296.701857611599
             stat err =       0.000419517425
             autocorr =       1.175938918301
              std dev =       0.547107439691
             le_variance =       0.299326550566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299300907252
                                         uncertainty =       0.002160685483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299300907252
                                         uncertainty =       0.002160685483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386863381
  error estimate for blocks of size 2^( 2) =       0.000397127951
  error estimate for blocks of size 2^( 3) =       0.000406140580
  error estimate for blocks of size 2^( 4) =       0.000413725690
  error estimate for blocks of size 2^( 5) =       0.000417594460
  error estimate for blocks of size 2^( 6) =       0.000421723714
  error estimate for blocks of size 2^( 7) =       0.000425025837

      target function =                  N/A
              le_mean =     -17.215966257449
             les_mean =     296.701857611599
             stat err =       0.000419517425
             autocorr =       1.175938918301
              std dev =       0.547107439691
             le_variance =       0.299326550566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299300907252
                                         uncertainty =       0.002160685483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299300907252
                                         uncertainty =       0.002160685483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386863381
  error estimate for blocks of size 2^( 2) =       0.000397127951
  error estimate for blocks of size 2^( 3) =       0.000406140580
  error estimate for blocks of size 2^( 4) =       0.000413725690
  error estimate for blocks of size 2^( 5) =       0.000417594460
  error estimate for blocks of size 2^( 6) =       0.000421723714
  error estimate for blocks of size 2^( 7) =       0.000425025837

      target function =                  N/A
              le_mean =     -17.215966257449
             les_mean =     296.701857611599
             stat err =       0.000419517425
             autocorr =       1.175938918301
              std dev =       0.547107439691
             le_variance =       0.299326550566


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215966257449        initial  <--
     5.9605e+19     5.9605e+20             7.6682e-24       -17.215966257449
     2.3842e+20     2.3842e+21             1.9171e-24       -17.215966257449
     9.5367e+20     9.5367e+21             4.7926e-25       -17.215966257449

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0434
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6828e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.1677
    reference variance = 0.351129
====================================================
  Execution time = 2.0708e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1964e-01
  Total weights = 1.956928132e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301901801621
                                         uncertainty =       0.002619235091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301901801621
                                         uncertainty =       0.002619235091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388508630
  error estimate for blocks of size 2^( 2) =       0.000398550944
  error estimate for blocks of size 2^( 3) =       0.000407738406
  error estimate for blocks of size 2^( 4) =       0.000414161320
  error estimate for blocks of size 2^( 5) =       0.000418026556
  error estimate for blocks of size 2^( 6) =       0.000419393897
  error estimate for blocks of size 2^( 7) =       0.000421221686

      target function =                  N/A
              le_mean =     -17.215980379456
             les_mean =     296.709624230451
             stat err =       0.000418200865
             autocorr =       1.158693343911
              std dev =       0.549434173761
             le_variance =       0.301877911297


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721598037946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+20, overlap shift 5.9605e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215980379473       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215980379473       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+21, overlap shift 2.3842e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215980379473       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215980379473       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+21, overlap shift 9.5367e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215980379473       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215980379473       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.959039 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6816e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2221
    reference variance = 0.240736
====================================================
  Execution time = 2.0403e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0780e-01
  Total weights = 1.9567e+06
  Execution time = 1.8355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295428322647
                                         uncertainty =       0.002029216244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295428322647
                                         uncertainty =       0.002029216244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384501612
  error estimate for blocks of size 2^( 2) =       0.000394639855
  error estimate for blocks of size 2^( 3) =       0.000403818894
  error estimate for blocks of size 2^( 4) =       0.000410564753
  error estimate for blocks of size 2^( 5) =       0.000414503811
  error estimate for blocks of size 2^( 6) =       0.000417193643
  error estimate for blocks of size 2^( 7) =       0.000418488676

      target function =                  N/A
              le_mean =     -17.215568258371
             les_mean =     296.683593399599
             stat err =       0.000415187721
             autocorr =       1.165984214860
              std dev =       0.543767395112
             le_variance =       0.295682979987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295428322647
                                         uncertainty =       0.002029216244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295428322647
                                         uncertainty =       0.002029216244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384501612
  error estimate for blocks of size 2^( 2) =       0.000394639855
  error estimate for blocks of size 2^( 3) =       0.000403818894
  error estimate for blocks of size 2^( 4) =       0.000410564753
  error estimate for blocks of size 2^( 5) =       0.000414503811
  error estimate for blocks of size 2^( 6) =       0.000417193643
  error estimate for blocks of size 2^( 7) =       0.000418488676

      target function =                  N/A
              le_mean =     -17.215568258371
             les_mean =     296.683593399599
             stat err =       0.000415187721
             autocorr =       1.165984214860
              std dev =       0.543767395112
             le_variance =       0.295682979987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295428322647
                                         uncertainty =       0.002029216244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295428322647
                                         uncertainty =       0.002029216244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384501612
  error estimate for blocks of size 2^( 2) =       0.000394639855
  error estimate for blocks of size 2^( 3) =       0.000403818894
  error estimate for blocks of size 2^( 4) =       0.000410564753
  error estimate for blocks of size 2^( 5) =       0.000414503811
  error estimate for blocks of size 2^( 6) =       0.000417193643
  error estimate for blocks of size 2^( 7) =       0.000418488676

      target function =                  N/A
              le_mean =     -17.215568258371
             les_mean =     296.683593399599
             stat err =       0.000415187721
             autocorr =       1.165984214860
              std dev =       0.543767395112
             le_variance =       0.295682979987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295428322647
                                         uncertainty =       0.002029216244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295428322647
                                         uncertainty =       0.002029216244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384501612
  error estimate for blocks of size 2^( 2) =       0.000394639855
  error estimate for blocks of size 2^( 3) =       0.000403818894
  error estimate for blocks of size 2^( 4) =       0.000410564753
  error estimate for blocks of size 2^( 5) =       0.000414503811
  error estimate for blocks of size 2^( 6) =       0.000417193643
  error estimate for blocks of size 2^( 7) =       0.000418488676

      target function =                  N/A
              le_mean =     -17.215568258371
             les_mean =     296.683593399599
             stat err =       0.000415187721
             autocorr =       1.165984214860
              std dev =       0.543767395112
             le_variance =       0.295682979987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215568258371        initial  <--
     5.9605e+20     5.9605e+21             0.0000e+00       -17.215568258371
     2.3842e+21     2.3842e+22             0.0000e+00       -17.215568258371
     9.5367e+21     9.5367e+22             0.0000e+00       -17.215568258371

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6406
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6462e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2425
    reference variance = 0.246809
====================================================
  Execution time = 2.2678e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1582e-01
  Total weights = 1.956642260e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0509e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302216599808
                                         uncertainty =       0.002462056294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302216599808
                                         uncertainty =       0.002462056294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388711878
  error estimate for blocks of size 2^( 2) =       0.000399075082
  error estimate for blocks of size 2^( 3) =       0.000407975842
  error estimate for blocks of size 2^( 4) =       0.000415717089
  error estimate for blocks of size 2^( 5) =       0.000420073510
  error estimate for blocks of size 2^( 6) =       0.000422939445
  error estimate for blocks of size 2^( 7) =       0.000425794502

      target function =                  N/A
              le_mean =     -17.216862746969
             les_mean =     296.736180533972
             stat err =       0.000421131136
             autocorr =       1.173759391991
              std dev =       0.549721610078
             le_variance =       0.302193848587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721686274697e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+21, overlap shift 5.9605e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216862747022       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216862747022       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+22, overlap shift 2.3842e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216862747022       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216862747022       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+22, overlap shift 9.5367e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216862747022       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216862747022       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.960208 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8739e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.3001
    reference variance = 0.59818
====================================================
  Execution time = 2.0774e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1556e-01
  Total weights = 1.9566e+06
  Execution time = 1.8464e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299807555884
                                         uncertainty =       0.002008803151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299807555884
                                         uncertainty =       0.002008803151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387152403
  error estimate for blocks of size 2^( 2) =       0.000396935273
  error estimate for blocks of size 2^( 3) =       0.000405880022
  error estimate for blocks of size 2^( 4) =       0.000412047924
  error estimate for blocks of size 2^( 5) =       0.000416666032
  error estimate for blocks of size 2^( 6) =       0.000417035530
  error estimate for blocks of size 2^( 7) =       0.000419992910

      target function =                  N/A
              le_mean =     -17.216512510394
             les_mean =     296.723860634108
             stat err =       0.000416435599
             autocorr =       1.156995786647
              std dev =       0.547516179143
             le_variance =       0.299773966424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299807555884
                                         uncertainty =       0.002008803151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299807555884
                                         uncertainty =       0.002008803151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387152403
  error estimate for blocks of size 2^( 2) =       0.000396935273
  error estimate for blocks of size 2^( 3) =       0.000405880022
  error estimate for blocks of size 2^( 4) =       0.000412047924
  error estimate for blocks of size 2^( 5) =       0.000416666032
  error estimate for blocks of size 2^( 6) =       0.000417035530
  error estimate for blocks of size 2^( 7) =       0.000419992910

      target function =                  N/A
              le_mean =     -17.216512510394
             les_mean =     296.723860634108
             stat err =       0.000416435599
             autocorr =       1.156995786647
              std dev =       0.547516179143
             le_variance =       0.299773966424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299807555884
                                         uncertainty =       0.002008803151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299807555884
                                         uncertainty =       0.002008803151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387152403
  error estimate for blocks of size 2^( 2) =       0.000396935273
  error estimate for blocks of size 2^( 3) =       0.000405880022
  error estimate for blocks of size 2^( 4) =       0.000412047924
  error estimate for blocks of size 2^( 5) =       0.000416666032
  error estimate for blocks of size 2^( 6) =       0.000417035530
  error estimate for blocks of size 2^( 7) =       0.000419992910

      target function =                  N/A
              le_mean =     -17.216512510394
             les_mean =     296.723860634108
             stat err =       0.000416435599
             autocorr =       1.156995786647
              std dev =       0.547516179143
             le_variance =       0.299773966424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299807555884
                                         uncertainty =       0.002008803151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299807555884
                                         uncertainty =       0.002008803151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387152403
  error estimate for blocks of size 2^( 2) =       0.000396935273
  error estimate for blocks of size 2^( 3) =       0.000405880022
  error estimate for blocks of size 2^( 4) =       0.000412047924
  error estimate for blocks of size 2^( 5) =       0.000416666032
  error estimate for blocks of size 2^( 6) =       0.000417035530
  error estimate for blocks of size 2^( 7) =       0.000419992910

      target function =                  N/A
              le_mean =     -17.216512510394
             les_mean =     296.723860634108
             stat err =       0.000416435599
             autocorr =       1.156995786647
              std dev =       0.547516179143
             le_variance =       0.299773966424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216512510394        initial  <--
     5.9605e+21     5.9605e+22             0.0000e+00       -17.216512510394
     2.3842e+22     2.3842e+23             0.0000e+00       -17.216512510394
     9.5367e+22     9.5367e+23             0.0000e+00       -17.216512510394

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0616
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8807e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.3709
    reference variance = 0.514341
====================================================
  Execution time = 2.1101e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1355e-01
  Total weights = 1.956261619e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0476e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299698442286
                                         uncertainty =       0.001986756039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299698442286
                                         uncertainty =       0.001986756039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387076054
  error estimate for blocks of size 2^( 2) =       0.000397438509
  error estimate for blocks of size 2^( 3) =       0.000406408541
  error estimate for blocks of size 2^( 4) =       0.000412571779
  error estimate for blocks of size 2^( 5) =       0.000416404738
  error estimate for blocks of size 2^( 6) =       0.000419354093
  error estimate for blocks of size 2^( 7) =       0.000421299177

      target function =                  N/A
              le_mean =     -17.216824408944
             les_mean =     296.732592807320
             stat err =       0.000417407447
             autocorr =       1.162860918264
              std dev =       0.547408205709
             le_variance =       0.299655743678


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682440894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+22, overlap shift 5.9605e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216824408985       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216824408985       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216824408985       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+22 is 5.590606e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+23, overlap shift 2.3842e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216824408985       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216824408985       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216824408985       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216824450246       residual = 1.95e+05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+23 is 1.397652e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+23, overlap shift 9.5367e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216824408985       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216824408985       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216824408985       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+23 is 3.494129e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.961746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7160e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2482
    reference variance = 0.22291
====================================================
  Execution time = 2.0529e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1577e-01
  Total weights = 1.9566e+06
  Execution time = 1.8362e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301162654401
                                         uncertainty =       0.002105574607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301162654401
                                         uncertainty =       0.002105574607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388221878
  error estimate for blocks of size 2^( 2) =       0.000397928930
  error estimate for blocks of size 2^( 3) =       0.000406763551
  error estimate for blocks of size 2^( 4) =       0.000413360775
  error estimate for blocks of size 2^( 5) =       0.000417208399
  error estimate for blocks of size 2^( 6) =       0.000419486957
  error estimate for blocks of size 2^( 7) =       0.000420980074

      target function =                  N/A
              le_mean =     -17.217110593092
             les_mean =     296.744666130166
             stat err =       0.000417759051
             autocorr =       1.157955113026
              std dev =       0.549028644813
             le_variance =       0.301432452825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301162654401
                                         uncertainty =       0.002105574607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301162654401
                                         uncertainty =       0.002105574607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388221878
  error estimate for blocks of size 2^( 2) =       0.000397928930
  error estimate for blocks of size 2^( 3) =       0.000406763551
  error estimate for blocks of size 2^( 4) =       0.000413360775
  error estimate for blocks of size 2^( 5) =       0.000417208399
  error estimate for blocks of size 2^( 6) =       0.000419486957
  error estimate for blocks of size 2^( 7) =       0.000420980074

      target function =                  N/A
              le_mean =     -17.217110593092
             les_mean =     296.744666130166
             stat err =       0.000417759051
             autocorr =       1.157955113026
              std dev =       0.549028644813
             le_variance =       0.301432452825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301162654401
                                         uncertainty =       0.002105574607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301162654401
                                         uncertainty =       0.002105574607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388221878
  error estimate for blocks of size 2^( 2) =       0.000397928930
  error estimate for blocks of size 2^( 3) =       0.000406763551
  error estimate for blocks of size 2^( 4) =       0.000413360775
  error estimate for blocks of size 2^( 5) =       0.000417208399
  error estimate for blocks of size 2^( 6) =       0.000419486957
  error estimate for blocks of size 2^( 7) =       0.000420980074

      target function =                  N/A
              le_mean =     -17.217110593092
             les_mean =     296.744666130166
             stat err =       0.000417759051
             autocorr =       1.157955113026
              std dev =       0.549028644813
             le_variance =       0.301432452825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301162654401
                                         uncertainty =       0.002105574607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301162654401
                                         uncertainty =       0.002105574607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388221878
  error estimate for blocks of size 2^( 2) =       0.000397928930
  error estimate for blocks of size 2^( 3) =       0.000406763551
  error estimate for blocks of size 2^( 4) =       0.000413360775
  error estimate for blocks of size 2^( 5) =       0.000417208399
  error estimate for blocks of size 2^( 6) =       0.000419486957
  error estimate for blocks of size 2^( 7) =       0.000420980074

      target function =                  N/A
              le_mean =     -17.217110593092
             les_mean =     296.744666130166
             stat err =       0.000417759051
             autocorr =       1.157955113026
              std dev =       0.549028644813
             le_variance =       0.301432452825


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217110593092        initial  <--
     5.9605e+22     5.9605e+23             5.5906e-27       -17.217110593092
     2.3842e+23     2.3842e+24             1.3977e-27       -17.217110593092
     9.5367e+23     9.5367e+24             3.4941e-28       -17.217110593092

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7960
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6962e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.3667
    reference variance = 0.733418
====================================================
  Execution time = 2.0641e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1395e-01
  Total weights = 1.956777640e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300464595802
                                         uncertainty =       0.002316407575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300464595802
                                         uncertainty =       0.002316407575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387594346
  error estimate for blocks of size 2^( 2) =       0.000397319538
  error estimate for blocks of size 2^( 3) =       0.000406468743
  error estimate for blocks of size 2^( 4) =       0.000413053477
  error estimate for blocks of size 2^( 5) =       0.000416523672
  error estimate for blocks of size 2^( 6) =       0.000418826968
  error estimate for blocks of size 2^( 7) =       0.000420612458

      target function =                  N/A
              le_mean =     -17.216759255136
             les_mean =     296.730745781327
             stat err =       0.000417254144
             autocorr =       1.158901299362
              std dev =       0.548141181156
             le_variance =       0.300458754479


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675925514e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+23, overlap shift 5.9605e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216759255163       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216759255163       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+24, overlap shift 2.3842e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216759255163       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216759255163       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+24, overlap shift 9.5367e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216759255163       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216759255163       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.963014 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6686e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.203
    reference variance = 0.169122
====================================================
  Execution time = 2.0487e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1133e-01
  Total weights = 1.9568e+06
  Execution time = 1.8352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298756387719
                                         uncertainty =       0.002115668202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298756387719
                                         uncertainty =       0.002115668202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386464651
  error estimate for blocks of size 2^( 2) =       0.000396361842
  error estimate for blocks of size 2^( 3) =       0.000405065545
  error estimate for blocks of size 2^( 4) =       0.000411601361
  error estimate for blocks of size 2^( 5) =       0.000416249479
  error estimate for blocks of size 2^( 6) =       0.000416367447
  error estimate for blocks of size 2^( 7) =       0.000416546210

      target function =                  N/A
              le_mean =     -17.216610654468
             les_mean =     296.723009979576
             stat err =       0.000415191125
             autocorr =       1.154188041230
              std dev =       0.546543550641
             le_variance =       0.298709852747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298756387719
                                         uncertainty =       0.002115668202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298756387719
                                         uncertainty =       0.002115668202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386464651
  error estimate for blocks of size 2^( 2) =       0.000396361842
  error estimate for blocks of size 2^( 3) =       0.000405065545
  error estimate for blocks of size 2^( 4) =       0.000411601361
  error estimate for blocks of size 2^( 5) =       0.000416249479
  error estimate for blocks of size 2^( 6) =       0.000416367447
  error estimate for blocks of size 2^( 7) =       0.000416546210

      target function =                  N/A
              le_mean =     -17.216610654468
             les_mean =     296.723009979576
             stat err =       0.000415191125
             autocorr =       1.154188041230
              std dev =       0.546543550641
             le_variance =       0.298709852747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298756387719
                                         uncertainty =       0.002115668202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298756387719
                                         uncertainty =       0.002115668202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386464651
  error estimate for blocks of size 2^( 2) =       0.000396361842
  error estimate for blocks of size 2^( 3) =       0.000405065545
  error estimate for blocks of size 2^( 4) =       0.000411601361
  error estimate for blocks of size 2^( 5) =       0.000416249479
  error estimate for blocks of size 2^( 6) =       0.000416367447
  error estimate for blocks of size 2^( 7) =       0.000416546210

      target function =                  N/A
              le_mean =     -17.216610654468
             les_mean =     296.723009979576
             stat err =       0.000415191125
             autocorr =       1.154188041230
              std dev =       0.546543550641
             le_variance =       0.298709852747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298756387719
                                         uncertainty =       0.002115668202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298756387719
                                         uncertainty =       0.002115668202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386464651
  error estimate for blocks of size 2^( 2) =       0.000396361842
  error estimate for blocks of size 2^( 3) =       0.000405065545
  error estimate for blocks of size 2^( 4) =       0.000411601361
  error estimate for blocks of size 2^( 5) =       0.000416249479
  error estimate for blocks of size 2^( 6) =       0.000416367447
  error estimate for blocks of size 2^( 7) =       0.000416546210

      target function =                  N/A
              le_mean =     -17.216610654468
             les_mean =     296.723009979576
             stat err =       0.000415191125
             autocorr =       1.154188041230
              std dev =       0.546543550641
             le_variance =       0.298709852747


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216610654468        initial  <--
     5.9605e+23     5.9605e+24             0.0000e+00       -17.216610654468
     2.3842e+24     2.3842e+25             0.0000e+00       -17.216610654468
     9.5367e+24     9.5367e+25             0.0000e+00       -17.216610654468

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7242
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6416e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1815
    reference variance = 0.301555
====================================================
  Execution time = 2.0957e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1422e-01
  Total weights = 1.956641160e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301351757715
                                         uncertainty =       0.002312498216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301351757715
                                         uncertainty =       0.002312498216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388093448
  error estimate for blocks of size 2^( 2) =       0.000397970337
  error estimate for blocks of size 2^( 3) =       0.000407552386
  error estimate for blocks of size 2^( 4) =       0.000414875214
  error estimate for blocks of size 2^( 5) =       0.000419771871
  error estimate for blocks of size 2^( 6) =       0.000421379989
  error estimate for blocks of size 2^( 7) =       0.000422233624

      target function =                  N/A
              le_mean =     -17.216136475825
             les_mean =     296.709574653536
             stat err =       0.000419565175
             autocorr =       1.168762432355
              std dev =       0.548847018133
             le_variance =       0.301233049314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721613647583e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+24, overlap shift 5.9605e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216136475841       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216136475841       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+25, overlap shift 2.3842e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216136475841       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216136475841       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+25, overlap shift 9.5367e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216136475841       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216136475841       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.964173 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6960e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2314
    reference variance = 0.132784
====================================================
  Execution time = 2.0513e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1342e-01
  Total weights = 1.9564e+06
  Execution time = 1.8337e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298768395893
                                         uncertainty =       0.001760126297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298768395893
                                         uncertainty =       0.001760126297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386485974
  error estimate for blocks of size 2^( 2) =       0.000396464290
  error estimate for blocks of size 2^( 3) =       0.000405223015
  error estimate for blocks of size 2^( 4) =       0.000411863385
  error estimate for blocks of size 2^( 5) =       0.000415947846
  error estimate for blocks of size 2^( 6) =       0.000418750573
  error estimate for blocks of size 2^( 7) =       0.000418124107

      target function =                  N/A
              le_mean =     -17.216083734602
             les_mean =     296.706959347456
             stat err =       0.000416171478
             autocorr =       1.159517078390
              std dev =       0.546573706181
             le_variance =       0.298742816289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298768395893
                                         uncertainty =       0.001760126297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298768395893
                                         uncertainty =       0.001760126297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386485974
  error estimate for blocks of size 2^( 2) =       0.000396464290
  error estimate for blocks of size 2^( 3) =       0.000405223015
  error estimate for blocks of size 2^( 4) =       0.000411863385
  error estimate for blocks of size 2^( 5) =       0.000415947846
  error estimate for blocks of size 2^( 6) =       0.000418750573
  error estimate for blocks of size 2^( 7) =       0.000418124107

      target function =                  N/A
              le_mean =     -17.216083734602
             les_mean =     296.706959347456
             stat err =       0.000416171478
             autocorr =       1.159517078390
              std dev =       0.546573706181
             le_variance =       0.298742816289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298768395893
                                         uncertainty =       0.001760126297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298768395893
                                         uncertainty =       0.001760126297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386485974
  error estimate for blocks of size 2^( 2) =       0.000396464290
  error estimate for blocks of size 2^( 3) =       0.000405223015
  error estimate for blocks of size 2^( 4) =       0.000411863385
  error estimate for blocks of size 2^( 5) =       0.000415947846
  error estimate for blocks of size 2^( 6) =       0.000418750573
  error estimate for blocks of size 2^( 7) =       0.000418124107

      target function =                  N/A
              le_mean =     -17.216083734602
             les_mean =     296.706959347456
             stat err =       0.000416171478
             autocorr =       1.159517078390
              std dev =       0.546573706181
             le_variance =       0.298742816289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298768395893
                                         uncertainty =       0.001760126297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298768395893
                                         uncertainty =       0.001760126297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386485974
  error estimate for blocks of size 2^( 2) =       0.000396464290
  error estimate for blocks of size 2^( 3) =       0.000405223015
  error estimate for blocks of size 2^( 4) =       0.000411863385
  error estimate for blocks of size 2^( 5) =       0.000415947846
  error estimate for blocks of size 2^( 6) =       0.000418750573
  error estimate for blocks of size 2^( 7) =       0.000418124107

      target function =                  N/A
              le_mean =     -17.216083734602
             les_mean =     296.706959347456
             stat err =       0.000416171478
             autocorr =       1.159517078390
              std dev =       0.546573706181
             le_variance =       0.298742816289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216083734602        initial  <--
     5.9605e+24     5.9605e+25             0.0000e+00       -17.216083734602
     2.3842e+25     2.3842e+26             0.0000e+00       -17.216083734602
     9.5367e+25     9.5367e+26             0.0000e+00       -17.216083734602

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7434
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6709e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2558
    reference variance = 0.222711
====================================================
  Execution time = 2.0776e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1330e-01
  Total weights = 1.956451184e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297431793409
                                         uncertainty =       0.001739234982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297431793409
                                         uncertainty =       0.001739234982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385607870
  error estimate for blocks of size 2^( 2) =       0.000395511225
  error estimate for blocks of size 2^( 3) =       0.000404888003
  error estimate for blocks of size 2^( 4) =       0.000411691343
  error estimate for blocks of size 2^( 5) =       0.000415744634
  error estimate for blocks of size 2^( 6) =       0.000419191982
  error estimate for blocks of size 2^( 7) =       0.000420917882

      target function =                  N/A
              le_mean =     -17.216392505513
             les_mean =     296.717470073004
             stat err =       0.000416886460
             autocorr =       1.168809689613
              std dev =       0.545331878906
             le_variance =       0.297386858151


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639250551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+25, overlap shift 5.9605e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216392505559       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216392505559       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+26, overlap shift 2.3842e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216392505559       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216392505559       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+26, overlap shift 9.5367e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216392505559       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216392505559       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.965337 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6828e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2257
    reference variance = 0.148147
====================================================
  Execution time = 2.0695e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1631e-01
  Total weights = 1.9567e+06
  Execution time = 1.8379e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300540890575
                                         uncertainty =       0.003138169910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300540890575
                                         uncertainty =       0.003138169910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387752105
  error estimate for blocks of size 2^( 2) =       0.000397790432
  error estimate for blocks of size 2^( 3) =       0.000406760364
  error estimate for blocks of size 2^( 4) =       0.000413343161
  error estimate for blocks of size 2^( 5) =       0.000417747624
  error estimate for blocks of size 2^( 6) =       0.000418800833
  error estimate for blocks of size 2^( 7) =       0.000423156528

      target function =                  N/A
              le_mean =     -17.216217996259
             les_mean =     296.714471224524
             stat err =       0.000418262037
             autocorr =       1.163559425284
              std dev =       0.548364285030
             le_variance =       0.300703389097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300540890575
                                         uncertainty =       0.003138169910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300540890575
                                         uncertainty =       0.003138169910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387752105
  error estimate for blocks of size 2^( 2) =       0.000397790432
  error estimate for blocks of size 2^( 3) =       0.000406760364
  error estimate for blocks of size 2^( 4) =       0.000413343161
  error estimate for blocks of size 2^( 5) =       0.000417747624
  error estimate for blocks of size 2^( 6) =       0.000418800833
  error estimate for blocks of size 2^( 7) =       0.000423156528

      target function =                  N/A
              le_mean =     -17.216217996259
             les_mean =     296.714471224524
             stat err =       0.000418262037
             autocorr =       1.163559425284
              std dev =       0.548364285030
             le_variance =       0.300703389097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300540890575
                                         uncertainty =       0.003138169910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300540890575
                                         uncertainty =       0.003138169910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387752105
  error estimate for blocks of size 2^( 2) =       0.000397790432
  error estimate for blocks of size 2^( 3) =       0.000406760364
  error estimate for blocks of size 2^( 4) =       0.000413343161
  error estimate for blocks of size 2^( 5) =       0.000417747624
  error estimate for blocks of size 2^( 6) =       0.000418800833
  error estimate for blocks of size 2^( 7) =       0.000423156528

      target function =                  N/A
              le_mean =     -17.216217996259
             les_mean =     296.714471224524
             stat err =       0.000418262037
             autocorr =       1.163559425284
              std dev =       0.548364285030
             le_variance =       0.300703389097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300540890575
                                         uncertainty =       0.003138169910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300540890575
                                         uncertainty =       0.003138169910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387752105
  error estimate for blocks of size 2^( 2) =       0.000397790432
  error estimate for blocks of size 2^( 3) =       0.000406760364
  error estimate for blocks of size 2^( 4) =       0.000413343161
  error estimate for blocks of size 2^( 5) =       0.000417747624
  error estimate for blocks of size 2^( 6) =       0.000418800833
  error estimate for blocks of size 2^( 7) =       0.000423156528

      target function =                  N/A
              le_mean =     -17.216217996259
             les_mean =     296.714471224524
             stat err =       0.000418262037
             autocorr =       1.163559425284
              std dev =       0.548364285030
             le_variance =       0.300703389097


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216217996259        initial  <--
     5.9605e+25     5.9605e+26             0.0000e+00       -17.216217996259
     2.3842e+26     2.3842e+27             0.0000e+00       -17.216217996259
     9.5367e+26     9.5367e+27             0.0000e+00       -17.216217996259

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9879
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6822e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2194
    reference variance = 0.454895
====================================================
  Execution time = 2.0706e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1430e-01
  Total weights = 1.956450319e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0474e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299678129441
                                         uncertainty =       0.002887618128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299678129441
                                         uncertainty =       0.002887618128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387131857
  error estimate for blocks of size 2^( 2) =       0.000397157525
  error estimate for blocks of size 2^( 3) =       0.000406190735
  error estimate for blocks of size 2^( 4) =       0.000413079759
  error estimate for blocks of size 2^( 5) =       0.000417581303
  error estimate for blocks of size 2^( 6) =       0.000421119321
  error estimate for blocks of size 2^( 7) =       0.000423504912

      target function =                  N/A
              le_mean =     -17.216483066002
             les_mean =     296.721594067432
             stat err =       0.000418821324
             autocorr =       1.170414649590
              std dev =       0.547487122433
             le_variance =       0.299742149230


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721648306600e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+26, overlap shift 5.9605e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216483066023       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216483066023       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+27, overlap shift 2.3842e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216483066023       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216483066023       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+27, overlap shift 9.5367e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216483066023       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216483066023       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.966520 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6764e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2387
    reference variance = 0.228003
====================================================
  Execution time = 2.2249e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1033e-01
  Total weights = 1.9567e+06
  Execution time = 1.8472e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296988260665
                                         uncertainty =       0.001698320154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296988260665
                                         uncertainty =       0.001698320154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385293252
  error estimate for blocks of size 2^( 2) =       0.000395569223
  error estimate for blocks of size 2^( 3) =       0.000404387891
  error estimate for blocks of size 2^( 4) =       0.000410579769
  error estimate for blocks of size 2^( 5) =       0.000414805373
  error estimate for blocks of size 2^( 6) =       0.000417992290
  error estimate for blocks of size 2^( 7) =       0.000419496588

      target function =                  N/A
              le_mean =     -17.216118183647
             les_mean =     296.705054668678
             stat err =       0.000415718505
             autocorr =       1.164168672879
              std dev =       0.544886942018
             le_variance =       0.296901779581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296988260665
                                         uncertainty =       0.001698320154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296988260665
                                         uncertainty =       0.001698320154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385293252
  error estimate for blocks of size 2^( 2) =       0.000395569223
  error estimate for blocks of size 2^( 3) =       0.000404387891
  error estimate for blocks of size 2^( 4) =       0.000410579769
  error estimate for blocks of size 2^( 5) =       0.000414805373
  error estimate for blocks of size 2^( 6) =       0.000417992290
  error estimate for blocks of size 2^( 7) =       0.000419496588

      target function =                  N/A
              le_mean =     -17.216118183647
             les_mean =     296.705054668678
             stat err =       0.000415718505
             autocorr =       1.164168672879
              std dev =       0.544886942018
             le_variance =       0.296901779581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296988260665
                                         uncertainty =       0.001698320154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296988260665
                                         uncertainty =       0.001698320154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385293252
  error estimate for blocks of size 2^( 2) =       0.000395569223
  error estimate for blocks of size 2^( 3) =       0.000404387891
  error estimate for blocks of size 2^( 4) =       0.000410579769
  error estimate for blocks of size 2^( 5) =       0.000414805373
  error estimate for blocks of size 2^( 6) =       0.000417992290
  error estimate for blocks of size 2^( 7) =       0.000419496588

      target function =                  N/A
              le_mean =     -17.216118183647
             les_mean =     296.705054668678
             stat err =       0.000415718505
             autocorr =       1.164168672879
              std dev =       0.544886942018
             le_variance =       0.296901779581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296988260665
                                         uncertainty =       0.001698320154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296988260665
                                         uncertainty =       0.001698320154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385293252
  error estimate for blocks of size 2^( 2) =       0.000395569223
  error estimate for blocks of size 2^( 3) =       0.000404387891
  error estimate for blocks of size 2^( 4) =       0.000410579769
  error estimate for blocks of size 2^( 5) =       0.000414805373
  error estimate for blocks of size 2^( 6) =       0.000417992290
  error estimate for blocks of size 2^( 7) =       0.000419496588

      target function =                  N/A
              le_mean =     -17.216118183647
             les_mean =     296.705054668678
             stat err =       0.000415718505
             autocorr =       1.164168672879
              std dev =       0.544886942018
             le_variance =       0.296901779581


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216118183647        initial  <--
     5.9605e+26     5.9605e+27             0.0000e+00       -17.216118183647
     2.3842e+27     2.3842e+28             0.0000e+00       -17.216118183647
     9.5367e+27     9.5367e+28             0.0000e+00       -17.216118183647

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5458
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8316e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2513
    reference variance = 0.396525
====================================================
  Execution time = 2.0740e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1737e-01
  Total weights = 1.956654069e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299706339631
                                         uncertainty =       0.002099082464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299706339631
                                         uncertainty =       0.002099082464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387273152
  error estimate for blocks of size 2^( 2) =       0.000397357822
  error estimate for blocks of size 2^( 3) =       0.000406452113
  error estimate for blocks of size 2^( 4) =       0.000413067227
  error estimate for blocks of size 2^( 5) =       0.000417703815
  error estimate for blocks of size 2^( 6) =       0.000419185071
  error estimate for blocks of size 2^( 7) =       0.000420877494

      target function =                  N/A
              le_mean =     -17.216360356180
             les_mean =     296.720436193057
             stat err =       0.000417708402
             autocorr =       1.163353338967
              std dev =       0.547686944029
             le_variance =       0.299960988659


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721636035618e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+27, overlap shift 5.9605e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216360356191       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216360356191       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+28, overlap shift 2.3842e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216360356191       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216360356191       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+28, overlap shift 9.5367e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216360356191       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216360356191       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.967710 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6852e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2447
    reference variance = 0.225976
====================================================
  Execution time = 2.0864e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1342e-01
  Total weights = 1.9564e+06
  Execution time = 1.8326e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297621299851
                                         uncertainty =       0.002062771583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297621299851
                                         uncertainty =       0.002062771583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385722138
  error estimate for blocks of size 2^( 2) =       0.000396174485
  error estimate for blocks of size 2^( 3) =       0.000405291601
  error estimate for blocks of size 2^( 4) =       0.000412237110
  error estimate for blocks of size 2^( 5) =       0.000416223382
  error estimate for blocks of size 2^( 6) =       0.000417653360
  error estimate for blocks of size 2^( 7) =       0.000421440003

      target function =                  N/A
              le_mean =     -17.216181674641
             les_mean =     296.710333357524
             stat err =       0.000416888464
             autocorr =       1.168128508935
              std dev =       0.545493479371
             le_variance =       0.297563136036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297621299851
                                         uncertainty =       0.002062771583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297621299851
                                         uncertainty =       0.002062771583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385722138
  error estimate for blocks of size 2^( 2) =       0.000396174485
  error estimate for blocks of size 2^( 3) =       0.000405291601
  error estimate for blocks of size 2^( 4) =       0.000412237110
  error estimate for blocks of size 2^( 5) =       0.000416223382
  error estimate for blocks of size 2^( 6) =       0.000417653360
  error estimate for blocks of size 2^( 7) =       0.000421440003

      target function =                  N/A
              le_mean =     -17.216181674641
             les_mean =     296.710333357524
             stat err =       0.000416888464
             autocorr =       1.168128508935
              std dev =       0.545493479371
             le_variance =       0.297563136036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297621299851
                                         uncertainty =       0.002062771583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297621299851
                                         uncertainty =       0.002062771583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385722138
  error estimate for blocks of size 2^( 2) =       0.000396174485
  error estimate for blocks of size 2^( 3) =       0.000405291601
  error estimate for blocks of size 2^( 4) =       0.000412237110
  error estimate for blocks of size 2^( 5) =       0.000416223382
  error estimate for blocks of size 2^( 6) =       0.000417653360
  error estimate for blocks of size 2^( 7) =       0.000421440003

      target function =                  N/A
              le_mean =     -17.216181674641
             les_mean =     296.710333357524
             stat err =       0.000416888464
             autocorr =       1.168128508935
              std dev =       0.545493479371
             le_variance =       0.297563136036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297621299851
                                         uncertainty =       0.002062771583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297621299851
                                         uncertainty =       0.002062771583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385722138
  error estimate for blocks of size 2^( 2) =       0.000396174485
  error estimate for blocks of size 2^( 3) =       0.000405291601
  error estimate for blocks of size 2^( 4) =       0.000412237110
  error estimate for blocks of size 2^( 5) =       0.000416223382
  error estimate for blocks of size 2^( 6) =       0.000417653360
  error estimate for blocks of size 2^( 7) =       0.000421440003

      target function =                  N/A
              le_mean =     -17.216181674641
             les_mean =     296.710333357524
             stat err =       0.000416888464
             autocorr =       1.168128508935
              std dev =       0.545493479371
             le_variance =       0.297563136036


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216181674641        initial  <--
     5.9605e+27     5.9605e+28             0.0000e+00       -17.216181674641
     2.3842e+28     2.3842e+29             0.0000e+00       -17.216181674641
     9.5367e+28     9.5367e+29             0.0000e+00       -17.216181674641

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1033
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6961e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.1124
    reference variance = 0.360015
====================================================
  Execution time = 2.0991e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0962e-01
  Total weights = 1.956549309e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0229e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296736201419
                                         uncertainty =       0.001690109135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296736201419
                                         uncertainty =       0.001690109135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385149956
  error estimate for blocks of size 2^( 2) =       0.000394922759
  error estimate for blocks of size 2^( 3) =       0.000404249442
  error estimate for blocks of size 2^( 4) =       0.000411619982
  error estimate for blocks of size 2^( 5) =       0.000416638567
  error estimate for blocks of size 2^( 6) =       0.000419921658
  error estimate for blocks of size 2^( 7) =       0.000421387058

      target function =                  N/A
              le_mean =     -17.216705391835
             les_mean =     296.724564022030
             stat err =       0.000417391816
             autocorr =       1.174432755728
              std dev =       0.544684290629
             le_variance =       0.296680976458


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721670539184e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+28, overlap shift 5.9605e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216705391899       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216705391899       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+29, overlap shift 2.3842e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216705391899       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216705391899       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+29, overlap shift 9.5367e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216705391899       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216705391899       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.968892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7024e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.1902
    reference variance = 0.296885
====================================================
  Execution time = 2.0565e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1041e-01
  Total weights = 1.9566e+06
  Execution time = 1.8366e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297295828343
                                         uncertainty =       0.002151818214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297295828343
                                         uncertainty =       0.002151818214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385558528
  error estimate for blocks of size 2^( 2) =       0.000395827347
  error estimate for blocks of size 2^( 3) =       0.000405022755
  error estimate for blocks of size 2^( 4) =       0.000412110073
  error estimate for blocks of size 2^( 5) =       0.000417007462
  error estimate for blocks of size 2^( 6) =       0.000420369021
  error estimate for blocks of size 2^( 7) =       0.000422200275

      target function =                  N/A
              le_mean =     -17.216805336987
             les_mean =     296.728799177752
             stat err =       0.000417921708
             autocorr =       1.174922533307
              std dev =       0.545262099315
             le_variance =       0.297310756950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297295828343
                                         uncertainty =       0.002151818214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297295828343
                                         uncertainty =       0.002151818214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385558528
  error estimate for blocks of size 2^( 2) =       0.000395827347
  error estimate for blocks of size 2^( 3) =       0.000405022755
  error estimate for blocks of size 2^( 4) =       0.000412110073
  error estimate for blocks of size 2^( 5) =       0.000417007462
  error estimate for blocks of size 2^( 6) =       0.000420369021
  error estimate for blocks of size 2^( 7) =       0.000422200275

      target function =                  N/A
              le_mean =     -17.216805336987
             les_mean =     296.728799177752
             stat err =       0.000417921708
             autocorr =       1.174922533307
              std dev =       0.545262099315
             le_variance =       0.297310756950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297295828343
                                         uncertainty =       0.002151818214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297295828343
                                         uncertainty =       0.002151818214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385558528
  error estimate for blocks of size 2^( 2) =       0.000395827347
  error estimate for blocks of size 2^( 3) =       0.000405022755
  error estimate for blocks of size 2^( 4) =       0.000412110073
  error estimate for blocks of size 2^( 5) =       0.000417007462
  error estimate for blocks of size 2^( 6) =       0.000420369021
  error estimate for blocks of size 2^( 7) =       0.000422200275

      target function =                  N/A
              le_mean =     -17.216805336987
             les_mean =     296.728799177752
             stat err =       0.000417921708
             autocorr =       1.174922533307
              std dev =       0.545262099315
             le_variance =       0.297310756950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297295828343
                                         uncertainty =       0.002151818214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297295828343
                                         uncertainty =       0.002151818214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385558528
  error estimate for blocks of size 2^( 2) =       0.000395827347
  error estimate for blocks of size 2^( 3) =       0.000405022755
  error estimate for blocks of size 2^( 4) =       0.000412110073
  error estimate for blocks of size 2^( 5) =       0.000417007462
  error estimate for blocks of size 2^( 6) =       0.000420369021
  error estimate for blocks of size 2^( 7) =       0.000422200275

      target function =                  N/A
              le_mean =     -17.216805336987
             les_mean =     296.728799177752
             stat err =       0.000417921708
             autocorr =       1.174922533307
              std dev =       0.545262099315
             le_variance =       0.297310756950


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216805336987        initial  <--
     5.9605e+28     5.9605e+29             0.0000e+00       -17.216805336987
     2.3842e+29     2.3842e+30             0.0000e+00       -17.216805336987
     9.5367e+29     9.5367e+30             0.0000e+00       -17.216805336987

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8719
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6902e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1848
    reference variance = 0.208829
====================================================
  Execution time = 2.0590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1624e-01
  Total weights = 1.956423655e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302406316325
                                         uncertainty =       0.002730542518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302406316325
                                         uncertainty =       0.002730542518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388828726
  error estimate for blocks of size 2^( 2) =       0.000398947890
  error estimate for blocks of size 2^( 3) =       0.000408212909
  error estimate for blocks of size 2^( 4) =       0.000415176052
  error estimate for blocks of size 2^( 5) =       0.000419524820
  error estimate for blocks of size 2^( 6) =       0.000420984976
  error estimate for blocks of size 2^( 7) =       0.000421902524

      target function =                  N/A
              le_mean =     -17.216664063776
             les_mean =     296.729764845656
             stat err =       0.000419397093
             autocorr =       1.163413629264
              std dev =       0.549886857870
             le_variance =       0.302375556458


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666406378e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+29, overlap shift 5.9605e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216664063822       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216664063822       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+30, overlap shift 2.3842e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216664063822       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216664063822       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+30, overlap shift 9.5367e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216664063822       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216664063822       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.970064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6637e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2118
    reference variance = 0.203224
====================================================
  Execution time = 2.0469e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0906e-01
  Total weights = 1.9563e+06
  Execution time = 1.8437e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296312800920
                                         uncertainty =       0.001743620520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296312800920
                                         uncertainty =       0.001743620520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384903496
  error estimate for blocks of size 2^( 2) =       0.000395212702
  error estimate for blocks of size 2^( 3) =       0.000404534294
  error estimate for blocks of size 2^( 4) =       0.000411348892
  error estimate for blocks of size 2^( 5) =       0.000414944913
  error estimate for blocks of size 2^( 6) =       0.000417939801
  error estimate for blocks of size 2^( 7) =       0.000422105829

      target function =                  N/A
              le_mean =     -17.216123161379
             les_mean =     296.703958401155
             stat err =       0.000416584859
             autocorr =       1.171394689653
              std dev =       0.544335744212
             le_variance =       0.296301402427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296312800920
                                         uncertainty =       0.001743620520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296312800920
                                         uncertainty =       0.001743620520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384903496
  error estimate for blocks of size 2^( 2) =       0.000395212702
  error estimate for blocks of size 2^( 3) =       0.000404534294
  error estimate for blocks of size 2^( 4) =       0.000411348892
  error estimate for blocks of size 2^( 5) =       0.000414944913
  error estimate for blocks of size 2^( 6) =       0.000417939801
  error estimate for blocks of size 2^( 7) =       0.000422105829

      target function =                  N/A
              le_mean =     -17.216123161379
             les_mean =     296.703958401155
             stat err =       0.000416584859
             autocorr =       1.171394689653
              std dev =       0.544335744212
             le_variance =       0.296301402427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296312800920
                                         uncertainty =       0.001743620520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296312800920
                                         uncertainty =       0.001743620520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384903496
  error estimate for blocks of size 2^( 2) =       0.000395212702
  error estimate for blocks of size 2^( 3) =       0.000404534294
  error estimate for blocks of size 2^( 4) =       0.000411348892
  error estimate for blocks of size 2^( 5) =       0.000414944913
  error estimate for blocks of size 2^( 6) =       0.000417939801
  error estimate for blocks of size 2^( 7) =       0.000422105829

      target function =                  N/A
              le_mean =     -17.216123161379
             les_mean =     296.703958401155
             stat err =       0.000416584859
             autocorr =       1.171394689653
              std dev =       0.544335744212
             le_variance =       0.296301402427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296312800920
                                         uncertainty =       0.001743620520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296312800920
                                         uncertainty =       0.001743620520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384903496
  error estimate for blocks of size 2^( 2) =       0.000395212702
  error estimate for blocks of size 2^( 3) =       0.000404534294
  error estimate for blocks of size 2^( 4) =       0.000411348892
  error estimate for blocks of size 2^( 5) =       0.000414944913
  error estimate for blocks of size 2^( 6) =       0.000417939801
  error estimate for blocks of size 2^( 7) =       0.000422105829

      target function =                  N/A
              le_mean =     -17.216123161379
             les_mean =     296.703958401155
             stat err =       0.000416584859
             autocorr =       1.171394689653
              std dev =       0.544335744212
             le_variance =       0.296301402427


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216123161379        initial  <--
     5.9605e+29     5.9605e+30             0.0000e+00       -17.216123161379
     2.3842e+30     2.3842e+31             0.0000e+00       -17.216123161379
     9.5367e+30     9.5367e+31             0.0000e+00       -17.216123161379

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8776
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6521e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.209
    reference variance = 0.199462
====================================================
  Execution time = 2.0721e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1107e-01
  Total weights = 1.956560554e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297595810693
                                         uncertainty =       0.001906813698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297595810693
                                         uncertainty =       0.001906813698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385730725
  error estimate for blocks of size 2^( 2) =       0.000395835257
  error estimate for blocks of size 2^( 3) =       0.000404505648
  error estimate for blocks of size 2^( 4) =       0.000410230953
  error estimate for blocks of size 2^( 5) =       0.000413817579
  error estimate for blocks of size 2^( 6) =       0.000415711580
  error estimate for blocks of size 2^( 7) =       0.000417198352

      target function =                  N/A
              le_mean =     -17.216933280988
             les_mean =     296.733863171766
             stat err =       0.000414239616
             autocorr =       1.153280086583
              std dev =       0.545505623287
             le_variance =       0.297576385038


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693328099e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+30, overlap shift 5.9605e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216933281044       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216933281044       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+31, overlap shift 2.3842e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216933281044       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216933281044       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+31, overlap shift 9.5367e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216933281044       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216933281044       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.971235 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6748e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.219
    reference variance = 0.202363
====================================================
  Execution time = 2.0478e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1221e-01
  Total weights = 1.9568e+06
  Execution time = 1.8327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296100627956
                                         uncertainty =       0.001742327533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296100627956
                                         uncertainty =       0.001742327533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384820071
  error estimate for blocks of size 2^( 2) =       0.000394794772
  error estimate for blocks of size 2^( 3) =       0.000404038178
  error estimate for blocks of size 2^( 4) =       0.000411333136
  error estimate for blocks of size 2^( 5) =       0.000415755466
  error estimate for blocks of size 2^( 6) =       0.000417703588
  error estimate for blocks of size 2^( 7) =       0.000419371646

      target function =                  N/A
              le_mean =     -17.216415472929
             les_mean =     296.717171718830
             stat err =       0.000416040959
             autocorr =       1.168844523478
              std dev =       0.544217763757
             le_variance =       0.296172974389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296100627956
                                         uncertainty =       0.001742327533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296100627956
                                         uncertainty =       0.001742327533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384820071
  error estimate for blocks of size 2^( 2) =       0.000394794772
  error estimate for blocks of size 2^( 3) =       0.000404038178
  error estimate for blocks of size 2^( 4) =       0.000411333136
  error estimate for blocks of size 2^( 5) =       0.000415755466
  error estimate for blocks of size 2^( 6) =       0.000417703588
  error estimate for blocks of size 2^( 7) =       0.000419371646

      target function =                  N/A
              le_mean =     -17.216415472929
             les_mean =     296.717171718830
             stat err =       0.000416040959
             autocorr =       1.168844523478
              std dev =       0.544217763757
             le_variance =       0.296172974389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296100627956
                                         uncertainty =       0.001742327533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296100627956
                                         uncertainty =       0.001742327533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384820071
  error estimate for blocks of size 2^( 2) =       0.000394794772
  error estimate for blocks of size 2^( 3) =       0.000404038178
  error estimate for blocks of size 2^( 4) =       0.000411333136
  error estimate for blocks of size 2^( 5) =       0.000415755466
  error estimate for blocks of size 2^( 6) =       0.000417703588
  error estimate for blocks of size 2^( 7) =       0.000419371646

      target function =                  N/A
              le_mean =     -17.216415472929
             les_mean =     296.717171718830
             stat err =       0.000416040959
             autocorr =       1.168844523478
              std dev =       0.544217763757
             le_variance =       0.296172974389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296100627956
                                         uncertainty =       0.001742327533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296100627956
                                         uncertainty =       0.001742327533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384820071
  error estimate for blocks of size 2^( 2) =       0.000394794772
  error estimate for blocks of size 2^( 3) =       0.000404038178
  error estimate for blocks of size 2^( 4) =       0.000411333136
  error estimate for blocks of size 2^( 5) =       0.000415755466
  error estimate for blocks of size 2^( 6) =       0.000417703588
  error estimate for blocks of size 2^( 7) =       0.000419371646

      target function =                  N/A
              le_mean =     -17.216415472929
             les_mean =     296.717171718830
             stat err =       0.000416040959
             autocorr =       1.168844523478
              std dev =       0.544217763757
             le_variance =       0.296172974389


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216415472929        initial  <--
     5.9605e+30     5.9605e+31             0.0000e+00       -17.216415472929
     2.3842e+31     2.3842e+32             0.0000e+00       -17.216415472929
     9.5367e+31     9.5367e+32             0.0000e+00       -17.216415472929

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7462
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6500e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2476
    reference variance = 0.270552
====================================================
  Execution time = 2.0621e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2113e-01
  Total weights = 1.956976312e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303303117431
                                         uncertainty =       0.003010343961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303303117431
                                         uncertainty =       0.003010343961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389370498
  error estimate for blocks of size 2^( 2) =       0.000399415502
  error estimate for blocks of size 2^( 3) =       0.000408400605
  error estimate for blocks of size 2^( 4) =       0.000414985526
  error estimate for blocks of size 2^( 5) =       0.000419941200
  error estimate for blocks of size 2^( 6) =       0.000420448311
  error estimate for blocks of size 2^( 7) =       0.000421456817

      target function =                  N/A
              le_mean =     -17.216232803923
             les_mean =     296.719806447523
             stat err =       0.000419207963
             autocorr =       1.159132182228
              std dev =       0.550653038497
             le_variance =       0.303218768806


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721623280392e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+31, overlap shift 5.9605e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216232803962       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216232803962       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216232803962       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216232806444       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+31 is 6.291609e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+32, overlap shift 2.3842e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216232803962       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216232803962       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216232803962       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216232806444       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+32 is 1.572902e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+32, overlap shift 9.5367e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216232803962       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216232803962       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216232803962       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216232806444       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+32 is 3.932255e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.973032 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6625e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1958
    reference variance = 0.284766
====================================================
  Execution time = 2.2412e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0893e-01
  Total weights = 1.9566e+06
  Execution time = 1.9469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296485212291
                                         uncertainty =       0.001703525736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296485212291
                                         uncertainty =       0.001703525736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384980774
  error estimate for blocks of size 2^( 2) =       0.000395111011
  error estimate for blocks of size 2^( 3) =       0.000404398241
  error estimate for blocks of size 2^( 4) =       0.000411007611
  error estimate for blocks of size 2^( 5) =       0.000415545977
  error estimate for blocks of size 2^( 6) =       0.000417782469
  error estimate for blocks of size 2^( 7) =       0.000420141439

      target function =                  N/A
              le_mean =     -17.216177963811
             les_mean =     296.705714190790
             stat err =       0.000416119374
             autocorr =       1.168309186042
              std dev =       0.544445031351
             le_variance =       0.296420392162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296485212291
                                         uncertainty =       0.001703525736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296485212291
                                         uncertainty =       0.001703525736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384980774
  error estimate for blocks of size 2^( 2) =       0.000395111011
  error estimate for blocks of size 2^( 3) =       0.000404398241
  error estimate for blocks of size 2^( 4) =       0.000411007611
  error estimate for blocks of size 2^( 5) =       0.000415545977
  error estimate for blocks of size 2^( 6) =       0.000417782469
  error estimate for blocks of size 2^( 7) =       0.000420141439

      target function =                  N/A
              le_mean =     -17.216177963811
             les_mean =     296.705714190790
             stat err =       0.000416119374
             autocorr =       1.168309186042
              std dev =       0.544445031351
             le_variance =       0.296420392162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296485212291
                                         uncertainty =       0.001703525736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296485212291
                                         uncertainty =       0.001703525736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384980774
  error estimate for blocks of size 2^( 2) =       0.000395111011
  error estimate for blocks of size 2^( 3) =       0.000404398241
  error estimate for blocks of size 2^( 4) =       0.000411007611
  error estimate for blocks of size 2^( 5) =       0.000415545977
  error estimate for blocks of size 2^( 6) =       0.000417782469
  error estimate for blocks of size 2^( 7) =       0.000420141439

      target function =                  N/A
              le_mean =     -17.216177963811
             les_mean =     296.705714190790
             stat err =       0.000416119374
             autocorr =       1.168309186042
              std dev =       0.544445031351
             le_variance =       0.296420392162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296485212291
                                         uncertainty =       0.001703525736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296485212291
                                         uncertainty =       0.001703525736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384980774
  error estimate for blocks of size 2^( 2) =       0.000395111011
  error estimate for blocks of size 2^( 3) =       0.000404398241
  error estimate for blocks of size 2^( 4) =       0.000411007611
  error estimate for blocks of size 2^( 5) =       0.000415545977
  error estimate for blocks of size 2^( 6) =       0.000417782469
  error estimate for blocks of size 2^( 7) =       0.000420141439

      target function =                  N/A
              le_mean =     -17.216177963811
             les_mean =     296.705714190790
             stat err =       0.000416119374
             autocorr =       1.168309186042
              std dev =       0.544445031351
             le_variance =       0.296420392162


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216177963811        initial  <--
     5.9605e+31     5.9605e+32             6.2916e-36       -17.216177963811
     2.3842e+32     2.3842e+33             1.5729e-36       -17.216177963811
     9.5367e+32     9.5367e+33             3.9323e-37       -17.216177963811

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7881
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8419e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2409
    reference variance = 0.19528
====================================================
  Execution time = 2.0568e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1542e-01
  Total weights = 1.956337559e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0058e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301836040416
                                         uncertainty =       0.002142150353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301836040416
                                         uncertainty =       0.002142150353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388489609
  error estimate for blocks of size 2^( 2) =       0.000399122345
  error estimate for blocks of size 2^( 3) =       0.000408240251
  error estimate for blocks of size 2^( 4) =       0.000414665833
  error estimate for blocks of size 2^( 5) =       0.000418997350
  error estimate for blocks of size 2^( 6) =       0.000421100899
  error estimate for blocks of size 2^( 7) =       0.000423104101

      target function =                  N/A
              le_mean =     -17.215922056542
             les_mean =     296.703389439914
             stat err =       0.000419467046
             autocorr =       1.165834437110
              std dev =       0.549407274470
             le_variance =       0.301848353241


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721592205654e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+32, overlap shift 5.9605e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215922056556       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215922056556       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+33, overlap shift 2.3842e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215922056556       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215922056556       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+33, overlap shift 9.5367e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215922056556       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215922056556       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.974214 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6584e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.1232
    reference variance = 0.377558
====================================================
  Execution time = 2.0308e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0909e-01
  Total weights = 1.9566e+06
  Execution time = 1.8324e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295761414950
                                         uncertainty =       0.001596786217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295761414950
                                         uncertainty =       0.001596786217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384648033
  error estimate for blocks of size 2^( 2) =       0.000394561164
  error estimate for blocks of size 2^( 3) =       0.000403745862
  error estimate for blocks of size 2^( 4) =       0.000409688971
  error estimate for blocks of size 2^( 5) =       0.000412972938
  error estimate for blocks of size 2^( 6) =       0.000415905936
  error estimate for blocks of size 2^( 7) =       0.000416837118

      target function =                  N/A
              le_mean =     -17.216286809213
             les_mean =     296.709624926056
             stat err =       0.000413851241
             autocorr =       1.157607925829
              std dev =       0.543974464906
             le_variance =       0.295908218470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295761414950
                                         uncertainty =       0.001596786217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295761414950
                                         uncertainty =       0.001596786217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384648033
  error estimate for blocks of size 2^( 2) =       0.000394561164
  error estimate for blocks of size 2^( 3) =       0.000403745862
  error estimate for blocks of size 2^( 4) =       0.000409688971
  error estimate for blocks of size 2^( 5) =       0.000412972938
  error estimate for blocks of size 2^( 6) =       0.000415905936
  error estimate for blocks of size 2^( 7) =       0.000416837118

      target function =                  N/A
              le_mean =     -17.216286809213
             les_mean =     296.709624926056
             stat err =       0.000413851241
             autocorr =       1.157607925829
              std dev =       0.543974464906
             le_variance =       0.295908218470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295761414950
                                         uncertainty =       0.001596786217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295761414950
                                         uncertainty =       0.001596786217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384648033
  error estimate for blocks of size 2^( 2) =       0.000394561164
  error estimate for blocks of size 2^( 3) =       0.000403745862
  error estimate for blocks of size 2^( 4) =       0.000409688971
  error estimate for blocks of size 2^( 5) =       0.000412972938
  error estimate for blocks of size 2^( 6) =       0.000415905936
  error estimate for blocks of size 2^( 7) =       0.000416837118

      target function =                  N/A
              le_mean =     -17.216286809213
             les_mean =     296.709624926056
             stat err =       0.000413851241
             autocorr =       1.157607925829
              std dev =       0.543974464906
             le_variance =       0.295908218470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295761414950
                                         uncertainty =       0.001596786217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295761414950
                                         uncertainty =       0.001596786217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384648033
  error estimate for blocks of size 2^( 2) =       0.000394561164
  error estimate for blocks of size 2^( 3) =       0.000403745862
  error estimate for blocks of size 2^( 4) =       0.000409688971
  error estimate for blocks of size 2^( 5) =       0.000412972938
  error estimate for blocks of size 2^( 6) =       0.000415905936
  error estimate for blocks of size 2^( 7) =       0.000416837118

      target function =                  N/A
              le_mean =     -17.216286809213
             les_mean =     296.709624926056
             stat err =       0.000413851241
             autocorr =       1.157607925829
              std dev =       0.543974464906
             le_variance =       0.295908218470


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216286809213        initial  <--
     5.9605e+32     5.9605e+33             0.0000e+00       -17.216286809213
     2.3842e+33     2.3842e+34             0.0000e+00       -17.216286809213
     9.5367e+33     9.5367e+34             0.0000e+00       -17.216286809213

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6074
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6226e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2461
    reference variance = 0.15922
====================================================
  Execution time = 2.0660e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1257e-01
  Total weights = 1.956622059e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2453e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299402660584
                                         uncertainty =       0.001734673108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299402660584
                                         uncertainty =       0.001734673108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386871498
  error estimate for blocks of size 2^( 2) =       0.000397042130
  error estimate for blocks of size 2^( 3) =       0.000406535096
  error estimate for blocks of size 2^( 4) =       0.000413018289
  error estimate for blocks of size 2^( 5) =       0.000418011425
  error estimate for blocks of size 2^( 6) =       0.000421381518
  error estimate for blocks of size 2^( 7) =       0.000422784192

      target function =                  N/A
              le_mean =     -17.216695995474
             les_mean =     296.727186111685
             stat err =       0.000418798856
             autocorr =       1.171864781692
              std dev =       0.547118919810
             le_variance =       0.299339112414


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669599547e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+33, overlap shift 5.9605e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216695995497       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216695995497       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+34, overlap shift 2.3842e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216695995497       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216695995497       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+34, overlap shift 9.5367e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216695995497       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216695995497       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.975404 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6915e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.197
    reference variance = 0.28931
====================================================
  Execution time = 2.0465e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1603e-01
  Total weights = 1.9567e+06
  Execution time = 1.8345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389290077
                                         uncertainty =       0.002770944139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389290077
                                         uncertainty =       0.002770944139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388166483
  error estimate for blocks of size 2^( 2) =       0.000398058515
  error estimate for blocks of size 2^( 3) =       0.000406953766
  error estimate for blocks of size 2^( 4) =       0.000414436418
  error estimate for blocks of size 2^( 5) =       0.000418671568
  error estimate for blocks of size 2^( 6) =       0.000420315639
  error estimate for blocks of size 2^( 7) =       0.000421779320

      target function =                  N/A
              le_mean =     -17.217031802917
             les_mean =     296.742218545966
             stat err =       0.000418800736
             autocorr =       1.164069224999
              std dev =       0.548950304629
             le_variance =       0.301346436952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389290077
                                         uncertainty =       0.002770944139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389290077
                                         uncertainty =       0.002770944139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388166483
  error estimate for blocks of size 2^( 2) =       0.000398058515
  error estimate for blocks of size 2^( 3) =       0.000406953766
  error estimate for blocks of size 2^( 4) =       0.000414436418
  error estimate for blocks of size 2^( 5) =       0.000418671568
  error estimate for blocks of size 2^( 6) =       0.000420315639
  error estimate for blocks of size 2^( 7) =       0.000421779320

      target function =                  N/A
              le_mean =     -17.217031802917
             les_mean =     296.742218545966
             stat err =       0.000418800736
             autocorr =       1.164069224999
              std dev =       0.548950304629
             le_variance =       0.301346436952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389290077
                                         uncertainty =       0.002770944139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389290077
                                         uncertainty =       0.002770944139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388166483
  error estimate for blocks of size 2^( 2) =       0.000398058515
  error estimate for blocks of size 2^( 3) =       0.000406953766
  error estimate for blocks of size 2^( 4) =       0.000414436418
  error estimate for blocks of size 2^( 5) =       0.000418671568
  error estimate for blocks of size 2^( 6) =       0.000420315639
  error estimate for blocks of size 2^( 7) =       0.000421779320

      target function =                  N/A
              le_mean =     -17.217031802917
             les_mean =     296.742218545966
             stat err =       0.000418800736
             autocorr =       1.164069224999
              std dev =       0.548950304629
             le_variance =       0.301346436952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389290077
                                         uncertainty =       0.002770944139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389290077
                                         uncertainty =       0.002770944139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388166483
  error estimate for blocks of size 2^( 2) =       0.000398058515
  error estimate for blocks of size 2^( 3) =       0.000406953766
  error estimate for blocks of size 2^( 4) =       0.000414436418
  error estimate for blocks of size 2^( 5) =       0.000418671568
  error estimate for blocks of size 2^( 6) =       0.000420315639
  error estimate for blocks of size 2^( 7) =       0.000421779320

      target function =                  N/A
              le_mean =     -17.217031802917
             les_mean =     296.742218545966
             stat err =       0.000418800736
             autocorr =       1.164069224999
              std dev =       0.548950304629
             le_variance =       0.301346436952


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217031802917        initial  <--
     5.9605e+33     5.9605e+34             0.0000e+00       -17.217031802917
     2.3842e+34     2.3842e+35             0.0000e+00       -17.217031802917
     9.5367e+34     9.5367e+35             0.0000e+00       -17.217031802917

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7296
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6667e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.0852
    reference variance = 0.201358
====================================================
  Execution time = 2.0624e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1135e-01
  Total weights = 1.956760415e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296811150463
                                         uncertainty =       0.001865630730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296811150463
                                         uncertainty =       0.001865630730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385267833
  error estimate for blocks of size 2^( 2) =       0.000395135963
  error estimate for blocks of size 2^( 3) =       0.000404005622
  error estimate for blocks of size 2^( 4) =       0.000410652966
  error estimate for blocks of size 2^( 5) =       0.000415132120
  error estimate for blocks of size 2^( 6) =       0.000416813633
  error estimate for blocks of size 2^( 7) =       0.000416804641

      target function =                  N/A
              le_mean =     -17.216734494475
             les_mean =     296.727296930915
             stat err =       0.000414850840
             autocorr =       1.159467146569
              std dev =       0.544850994654
             le_variance =       0.296862606376


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673449448e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+34, overlap shift 5.9605e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216734494523       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216734494523       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+35, overlap shift 2.3842e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216734494523       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216734494523       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+35, overlap shift 9.5367e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216734494523       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216734494523       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.976584 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6766e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2551
    reference variance = 0.242939
====================================================
  Execution time = 2.0371e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1269e-01
  Total weights = 1.9569e+06
  Execution time = 1.8335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296985356736
                                         uncertainty =       0.002556122819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296985356736
                                         uncertainty =       0.002556122819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385322731
  error estimate for blocks of size 2^( 2) =       0.000395310338
  error estimate for blocks of size 2^( 3) =       0.000404259197
  error estimate for blocks of size 2^( 4) =       0.000411586926
  error estimate for blocks of size 2^( 5) =       0.000415972776
  error estimate for blocks of size 2^( 6) =       0.000418296330
  error estimate for blocks of size 2^( 7) =       0.000419321383

      target function =                  N/A
              le_mean =     -17.215827246016
             les_mean =     296.697401792986
             stat err =       0.000416294354
             autocorr =       1.167217477078
              std dev =       0.544928631739
             le_variance =       0.296947213689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296985356736
                                         uncertainty =       0.002556122819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296985356736
                                         uncertainty =       0.002556122819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385322731
  error estimate for blocks of size 2^( 2) =       0.000395310338
  error estimate for blocks of size 2^( 3) =       0.000404259197
  error estimate for blocks of size 2^( 4) =       0.000411586926
  error estimate for blocks of size 2^( 5) =       0.000415972776
  error estimate for blocks of size 2^( 6) =       0.000418296330
  error estimate for blocks of size 2^( 7) =       0.000419321383

      target function =                  N/A
              le_mean =     -17.215827246016
             les_mean =     296.697401792986
             stat err =       0.000416294354
             autocorr =       1.167217477078
              std dev =       0.544928631739
             le_variance =       0.296947213689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296985356736
                                         uncertainty =       0.002556122819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296985356736
                                         uncertainty =       0.002556122819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385322731
  error estimate for blocks of size 2^( 2) =       0.000395310338
  error estimate for blocks of size 2^( 3) =       0.000404259197
  error estimate for blocks of size 2^( 4) =       0.000411586926
  error estimate for blocks of size 2^( 5) =       0.000415972776
  error estimate for blocks of size 2^( 6) =       0.000418296330
  error estimate for blocks of size 2^( 7) =       0.000419321383

      target function =                  N/A
              le_mean =     -17.215827246016
             les_mean =     296.697401792986
             stat err =       0.000416294354
             autocorr =       1.167217477078
              std dev =       0.544928631739
             le_variance =       0.296947213689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296985356736
                                         uncertainty =       0.002556122819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296985356736
                                         uncertainty =       0.002556122819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385322731
  error estimate for blocks of size 2^( 2) =       0.000395310338
  error estimate for blocks of size 2^( 3) =       0.000404259197
  error estimate for blocks of size 2^( 4) =       0.000411586926
  error estimate for blocks of size 2^( 5) =       0.000415972776
  error estimate for blocks of size 2^( 6) =       0.000418296330
  error estimate for blocks of size 2^( 7) =       0.000419321383

      target function =                  N/A
              le_mean =     -17.215827246016
             les_mean =     296.697401792986
             stat err =       0.000416294354
             autocorr =       1.167217477078
              std dev =       0.544928631739
             le_variance =       0.296947213689


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215827246016        initial  <--
     5.9605e+34     5.9605e+35             0.0000e+00       -17.215827246016
     2.3842e+35     2.3842e+36             0.0000e+00       -17.215827246016
     9.5367e+35     9.5367e+36             0.0000e+00       -17.215827246016

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6338
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6406e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1903
    reference variance = 0.251838
====================================================
  Execution time = 2.0685e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1483e-01
  Total weights = 1.957039408e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300265509104
                                         uncertainty =       0.002306765551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300265509104
                                         uncertainty =       0.002306765551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387449895
  error estimate for blocks of size 2^( 2) =       0.000397765996
  error estimate for blocks of size 2^( 3) =       0.000407336593
  error estimate for blocks of size 2^( 4) =       0.000414531312
  error estimate for blocks of size 2^( 5) =       0.000418967649
  error estimate for blocks of size 2^( 6) =       0.000421962662
  error estimate for blocks of size 2^( 7) =       0.000421241828

      target function =                  N/A
              le_mean =     -17.216377180151
             les_mean =     296.718470415231
             stat err =       0.000419175863
             autocorr =       1.170473101118
              std dev =       0.547936896850
             le_variance =       0.300234842930


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721637718015e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+35, overlap shift 5.9605e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216377180233       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216377180233       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+36, overlap shift 2.3842e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216377180233       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216377180233       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+36, overlap shift 9.5367e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216377180233       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216377180233       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.977769 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6738e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1857
    reference variance = 0.706195
====================================================
  Execution time = 2.0472e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1744e-01
  Total weights = 1.9566e+06
  Execution time = 1.8467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301772902293
                                         uncertainty =       0.001986201729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301772902293
                                         uncertainty =       0.001986201729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388385938
  error estimate for blocks of size 2^( 2) =       0.000398505267
  error estimate for blocks of size 2^( 3) =       0.000407655020
  error estimate for blocks of size 2^( 4) =       0.000414181154
  error estimate for blocks of size 2^( 5) =       0.000418111477
  error estimate for blocks of size 2^( 6) =       0.000420950580
  error estimate for blocks of size 2^( 7) =       0.000421712870

      target function =                  N/A
              le_mean =     -17.216458119215
             les_mean =     296.723870787845
             stat err =       0.000418739020
             autocorr =       1.162411423064
              std dev =       0.549260661639
             le_variance =       0.301687274424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301772902293
                                         uncertainty =       0.001986201729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301772902293
                                         uncertainty =       0.001986201729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388385938
  error estimate for blocks of size 2^( 2) =       0.000398505267
  error estimate for blocks of size 2^( 3) =       0.000407655020
  error estimate for blocks of size 2^( 4) =       0.000414181154
  error estimate for blocks of size 2^( 5) =       0.000418111477
  error estimate for blocks of size 2^( 6) =       0.000420950580
  error estimate for blocks of size 2^( 7) =       0.000421712870

      target function =                  N/A
              le_mean =     -17.216458119215
             les_mean =     296.723870787845
             stat err =       0.000418739020
             autocorr =       1.162411423064
              std dev =       0.549260661639
             le_variance =       0.301687274424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301772902293
                                         uncertainty =       0.001986201729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301772902293
                                         uncertainty =       0.001986201729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388385938
  error estimate for blocks of size 2^( 2) =       0.000398505267
  error estimate for blocks of size 2^( 3) =       0.000407655020
  error estimate for blocks of size 2^( 4) =       0.000414181154
  error estimate for blocks of size 2^( 5) =       0.000418111477
  error estimate for blocks of size 2^( 6) =       0.000420950580
  error estimate for blocks of size 2^( 7) =       0.000421712870

      target function =                  N/A
              le_mean =     -17.216458119215
             les_mean =     296.723870787845
             stat err =       0.000418739020
             autocorr =       1.162411423064
              std dev =       0.549260661639
             le_variance =       0.301687274424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301772902293
                                         uncertainty =       0.001986201729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301772902293
                                         uncertainty =       0.001986201729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388385938
  error estimate for blocks of size 2^( 2) =       0.000398505267
  error estimate for blocks of size 2^( 3) =       0.000407655020
  error estimate for blocks of size 2^( 4) =       0.000414181154
  error estimate for blocks of size 2^( 5) =       0.000418111477
  error estimate for blocks of size 2^( 6) =       0.000420950580
  error estimate for blocks of size 2^( 7) =       0.000421712870

      target function =                  N/A
              le_mean =     -17.216458119215
             les_mean =     296.723870787845
             stat err =       0.000418739020
             autocorr =       1.162411423064
              std dev =       0.549260661639
             le_variance =       0.301687274424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216458119215        initial  <--
     5.9605e+35     5.9605e+36             0.0000e+00       -17.216458119215
     2.3842e+36     2.3842e+37             0.0000e+00       -17.216458119215
     9.5367e+36     9.5367e+37             0.0000e+00       -17.216458119215

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7903
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6534e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2043
    reference variance = 0.225029
====================================================
  Execution time = 2.0820e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1449e-01
  Total weights = 1.956678665e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1616e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298821804372
                                         uncertainty =       0.001981407972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298821804372
                                         uncertainty =       0.001981407972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386489633
  error estimate for blocks of size 2^( 2) =       0.000396227072
  error estimate for blocks of size 2^( 3) =       0.000405515154
  error estimate for blocks of size 2^( 4) =       0.000412927912
  error estimate for blocks of size 2^( 5) =       0.000416340424
  error estimate for blocks of size 2^( 6) =       0.000417975358
  error estimate for blocks of size 2^( 7) =       0.000420060987

      target function =                  N/A
              le_mean =     -17.217111928767
             les_mean =     296.743429311823
             stat err =       0.000416826170
             autocorr =       1.163146067937
              std dev =       0.546578881332
             le_variance =       0.298748473518


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721711192877e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+36, overlap shift 5.9605e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217111928823       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217111928823       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+37, overlap shift 2.3842e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217111928823       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217111928823       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+37, overlap shift 9.5367e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217111928823       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217111928823       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.978940 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6992e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.0971
    reference variance = 0.372384
====================================================
  Execution time = 2.0736e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1244e-01
  Total weights = 1.9569e+06
  Execution time = 1.8454e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298207852499
                                         uncertainty =       0.001954015288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298207852499
                                         uncertainty =       0.001954015288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386233643
  error estimate for blocks of size 2^( 2) =       0.000396624388
  error estimate for blocks of size 2^( 3) =       0.000405616224
  error estimate for blocks of size 2^( 4) =       0.000412822421
  error estimate for blocks of size 2^( 5) =       0.000415867583
  error estimate for blocks of size 2^( 6) =       0.000418828188
  error estimate for blocks of size 2^( 7) =       0.000421012577

      target function =                  N/A
              le_mean =     -17.216555736336
             les_mean =     296.722235594724
             stat err =       0.000417132692
             autocorr =       1.166402001581
              std dev =       0.546216855899
             le_variance =       0.298352853669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298207852499
                                         uncertainty =       0.001954015288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298207852499
                                         uncertainty =       0.001954015288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386233643
  error estimate for blocks of size 2^( 2) =       0.000396624388
  error estimate for blocks of size 2^( 3) =       0.000405616224
  error estimate for blocks of size 2^( 4) =       0.000412822421
  error estimate for blocks of size 2^( 5) =       0.000415867583
  error estimate for blocks of size 2^( 6) =       0.000418828188
  error estimate for blocks of size 2^( 7) =       0.000421012577

      target function =                  N/A
              le_mean =     -17.216555736336
             les_mean =     296.722235594724
             stat err =       0.000417132692
             autocorr =       1.166402001581
              std dev =       0.546216855899
             le_variance =       0.298352853669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298207852499
                                         uncertainty =       0.001954015288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298207852499
                                         uncertainty =       0.001954015288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386233643
  error estimate for blocks of size 2^( 2) =       0.000396624388
  error estimate for blocks of size 2^( 3) =       0.000405616224
  error estimate for blocks of size 2^( 4) =       0.000412822421
  error estimate for blocks of size 2^( 5) =       0.000415867583
  error estimate for blocks of size 2^( 6) =       0.000418828188
  error estimate for blocks of size 2^( 7) =       0.000421012577

      target function =                  N/A
              le_mean =     -17.216555736336
             les_mean =     296.722235594724
             stat err =       0.000417132692
             autocorr =       1.166402001581
              std dev =       0.546216855899
             le_variance =       0.298352853669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298207852499
                                         uncertainty =       0.001954015288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298207852499
                                         uncertainty =       0.001954015288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386233643
  error estimate for blocks of size 2^( 2) =       0.000396624388
  error estimate for blocks of size 2^( 3) =       0.000405616224
  error estimate for blocks of size 2^( 4) =       0.000412822421
  error estimate for blocks of size 2^( 5) =       0.000415867583
  error estimate for blocks of size 2^( 6) =       0.000418828188
  error estimate for blocks of size 2^( 7) =       0.000421012577

      target function =                  N/A
              le_mean =     -17.216555736336
             les_mean =     296.722235594724
             stat err =       0.000417132692
             autocorr =       1.166402001581
              std dev =       0.546216855899
             le_variance =       0.298352853669


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216555736336        initial  <--
     5.9605e+36     5.9605e+37             0.0000e+00       -17.216555736336
     2.3842e+37     2.3842e+38             0.0000e+00       -17.216555736336
     9.5367e+37     9.5367e+38             0.0000e+00       -17.216555736336

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0139
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7012e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2425
    reference variance = 0.299556
====================================================
  Execution time = 2.3094e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1727e-01
  Total weights = 1.956619659e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302282789861
                                         uncertainty =       0.002254861331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302282789861
                                         uncertainty =       0.002254861331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388801460
  error estimate for blocks of size 2^( 2) =       0.000398622037
  error estimate for blocks of size 2^( 3) =       0.000407948465
  error estimate for blocks of size 2^( 4) =       0.000414399536
  error estimate for blocks of size 2^( 5) =       0.000418648670
  error estimate for blocks of size 2^( 6) =       0.000422276453
  error estimate for blocks of size 2^( 7) =       0.000423121871

      target function =                  N/A
              le_mean =     -17.216890789940
             les_mean =     296.738598535158
             stat err =       0.000419611632
             autocorr =       1.164767550681
              std dev =       0.549848298375
             le_variance =       0.302333151226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721689078994e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+37, overlap shift 5.9605e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216890789973       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216890789973       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+38, overlap shift 2.3842e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216890789973       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216890789973       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+38, overlap shift 9.5367e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216890789973       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216890789973       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.980035 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9116e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1846
    reference variance = 0.189024
====================================================
  Execution time = 2.0703e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2019e-01
  Total weights = 1.9563e+06
  Execution time = 1.8453e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710733333
                                         uncertainty =       0.002616931392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710733333
                                         uncertainty =       0.002616931392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389007821
  error estimate for blocks of size 2^( 2) =       0.000398941637
  error estimate for blocks of size 2^( 3) =       0.000408293001
  error estimate for blocks of size 2^( 4) =       0.000415493502
  error estimate for blocks of size 2^( 5) =       0.000420080857
  error estimate for blocks of size 2^( 6) =       0.000422775608
  error estimate for blocks of size 2^( 7) =       0.000425351534

      target function =                  N/A
              le_mean =     -17.216629500158
             les_mean =     296.732518995129
             stat err =       0.000420925375
             autocorr =       1.170829209674
              std dev =       0.550140136588
             le_variance =       0.302654169886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710733333
                                         uncertainty =       0.002616931392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710733333
                                         uncertainty =       0.002616931392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389007821
  error estimate for blocks of size 2^( 2) =       0.000398941637
  error estimate for blocks of size 2^( 3) =       0.000408293001
  error estimate for blocks of size 2^( 4) =       0.000415493502
  error estimate for blocks of size 2^( 5) =       0.000420080857
  error estimate for blocks of size 2^( 6) =       0.000422775608
  error estimate for blocks of size 2^( 7) =       0.000425351534

      target function =                  N/A
              le_mean =     -17.216629500158
             les_mean =     296.732518995129
             stat err =       0.000420925375
             autocorr =       1.170829209674
              std dev =       0.550140136588
             le_variance =       0.302654169886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710733333
                                         uncertainty =       0.002616931392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710733333
                                         uncertainty =       0.002616931392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389007821
  error estimate for blocks of size 2^( 2) =       0.000398941637
  error estimate for blocks of size 2^( 3) =       0.000408293001
  error estimate for blocks of size 2^( 4) =       0.000415493502
  error estimate for blocks of size 2^( 5) =       0.000420080857
  error estimate for blocks of size 2^( 6) =       0.000422775608
  error estimate for blocks of size 2^( 7) =       0.000425351534

      target function =                  N/A
              le_mean =     -17.216629500158
             les_mean =     296.732518995129
             stat err =       0.000420925375
             autocorr =       1.170829209674
              std dev =       0.550140136588
             le_variance =       0.302654169886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710733333
                                         uncertainty =       0.002616931392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710733333
                                         uncertainty =       0.002616931392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389007821
  error estimate for blocks of size 2^( 2) =       0.000398941637
  error estimate for blocks of size 2^( 3) =       0.000408293001
  error estimate for blocks of size 2^( 4) =       0.000415493502
  error estimate for blocks of size 2^( 5) =       0.000420080857
  error estimate for blocks of size 2^( 6) =       0.000422775608
  error estimate for blocks of size 2^( 7) =       0.000425351534

      target function =                  N/A
              le_mean =     -17.216629500158
             les_mean =     296.732518995129
             stat err =       0.000420925375
             autocorr =       1.170829209674
              std dev =       0.550140136588
             le_variance =       0.302654169886


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216629500158        initial  <--
     5.9605e+37     5.9605e+38             0.0000e+00       -17.216629500158
     2.3842e+38     2.3842e+39             0.0000e+00       -17.216629500158
     9.5367e+38     9.5367e+39             0.0000e+00       -17.216629500158

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0002
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9122e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2445
    reference variance = 0.279246
====================================================
  Execution time = 2.0668e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1517e-01
  Total weights = 1.956760662e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0197e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297591262854
                                         uncertainty =       0.001973090944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297591262854
                                         uncertainty =       0.001973090944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385731129
  error estimate for blocks of size 2^( 2) =       0.000395545184
  error estimate for blocks of size 2^( 3) =       0.000405428641
  error estimate for blocks of size 2^( 4) =       0.000411457321
  error estimate for blocks of size 2^( 5) =       0.000416395432
  error estimate for blocks of size 2^( 6) =       0.000417958291
  error estimate for blocks of size 2^( 7) =       0.000419527424

      target function =                  N/A
              le_mean =     -17.215935577269
             les_mean =     296.703609749807
             stat err =       0.000416334617
             autocorr =       1.164972485614
              std dev =       0.545506194594
             le_variance =       0.297577008340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721593557727e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+38, overlap shift 5.9605e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215935577297       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215935577297       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+39, overlap shift 2.3842e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215935577297       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215935577297       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+39, overlap shift 9.5367e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215935577297       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215935577297       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.981206 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6698e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2196
    reference variance = 0.230236
====================================================
  Execution time = 2.0550e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2596e-01
  Total weights = 1.9563e+06
  Execution time = 1.8444e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299552571096
                                         uncertainty =       0.002408035634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299552571096
                                         uncertainty =       0.002408035634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386935135
  error estimate for blocks of size 2^( 2) =       0.000396813666
  error estimate for blocks of size 2^( 3) =       0.000406045053
  error estimate for blocks of size 2^( 4) =       0.000412449950
  error estimate for blocks of size 2^( 5) =       0.000417357129
  error estimate for blocks of size 2^( 6) =       0.000420312189
  error estimate for blocks of size 2^( 7) =       0.000423172854

      target function =                  N/A
              le_mean =     -17.216493786464
             les_mean =     296.733618027895
             stat err =       0.000418323031
             autocorr =       1.168818874770
              std dev =       0.547208915913
             le_variance =       0.299437597654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299552571096
                                         uncertainty =       0.002408035634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299552571096
                                         uncertainty =       0.002408035634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386935135
  error estimate for blocks of size 2^( 2) =       0.000396813666
  error estimate for blocks of size 2^( 3) =       0.000406045053
  error estimate for blocks of size 2^( 4) =       0.000412449950
  error estimate for blocks of size 2^( 5) =       0.000417357129
  error estimate for blocks of size 2^( 6) =       0.000420312189
  error estimate for blocks of size 2^( 7) =       0.000423172854

      target function =                  N/A
              le_mean =     -17.216493786464
             les_mean =     296.733618027895
             stat err =       0.000418323031
             autocorr =       1.168818874770
              std dev =       0.547208915913
             le_variance =       0.299437597654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299552571096
                                         uncertainty =       0.002408035634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299552571096
                                         uncertainty =       0.002408035634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386935135
  error estimate for blocks of size 2^( 2) =       0.000396813666
  error estimate for blocks of size 2^( 3) =       0.000406045053
  error estimate for blocks of size 2^( 4) =       0.000412449950
  error estimate for blocks of size 2^( 5) =       0.000417357129
  error estimate for blocks of size 2^( 6) =       0.000420312189
  error estimate for blocks of size 2^( 7) =       0.000423172854

      target function =                  N/A
              le_mean =     -17.216493786464
             les_mean =     296.733618027895
             stat err =       0.000418323031
             autocorr =       1.168818874770
              std dev =       0.547208915913
             le_variance =       0.299437597654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299552571096
                                         uncertainty =       0.002408035634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299552571096
                                         uncertainty =       0.002408035634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386935135
  error estimate for blocks of size 2^( 2) =       0.000396813666
  error estimate for blocks of size 2^( 3) =       0.000406045053
  error estimate for blocks of size 2^( 4) =       0.000412449950
  error estimate for blocks of size 2^( 5) =       0.000417357129
  error estimate for blocks of size 2^( 6) =       0.000420312189
  error estimate for blocks of size 2^( 7) =       0.000423172854

      target function =                  N/A
              le_mean =     -17.216493786464
             les_mean =     296.733618027895
             stat err =       0.000418323031
             autocorr =       1.168818874770
              std dev =       0.547208915913
             le_variance =       0.299437597654


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216493786464        initial  <--
     5.9605e+38     5.9605e+39             0.0000e+00       -17.216493786464
     2.3842e+39     2.3842e+40             0.0000e+00       -17.216493786464
     9.5367e+39     9.5367e+40             0.0000e+00       -17.216493786464

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8695
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6574e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2651
    reference variance = 0.264221
====================================================
  Execution time = 2.0664e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1109e-01
  Total weights = 1.956280638e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296404647670
                                         uncertainty =       0.001675697817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296404647670
                                         uncertainty =       0.001675697817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384978004
  error estimate for blocks of size 2^( 2) =       0.000395243130
  error estimate for blocks of size 2^( 3) =       0.000404359771
  error estimate for blocks of size 2^( 4) =       0.000411070365
  error estimate for blocks of size 2^( 5) =       0.000414717003
  error estimate for blocks of size 2^( 6) =       0.000415632741
  error estimate for blocks of size 2^( 7) =       0.000415513630

      target function =                  N/A
              le_mean =     -17.216317791628
             les_mean =     296.712689108335
             stat err =       0.000414233435
             autocorr =       1.157759805708
              std dev =       0.544441113954
             le_variance =       0.296416126564


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631779163e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+39, overlap shift 5.9605e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216317791666       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216317791666       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+40, overlap shift 2.3842e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216317791666       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216317791666       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+40, overlap shift 9.5367e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216317791666       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216317791666       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.982373 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6687e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2634
    reference variance = 0.149652
====================================================
  Execution time = 2.0669e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1041e-01
  Total weights = 1.9568e+06
  Execution time = 1.8343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297207589168
                                         uncertainty =       0.001994572628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297207589168
                                         uncertainty =       0.001994572628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385486601
  error estimate for blocks of size 2^( 2) =       0.000395934913
  error estimate for blocks of size 2^( 3) =       0.000405251353
  error estimate for blocks of size 2^( 4) =       0.000411668173
  error estimate for blocks of size 2^( 5) =       0.000417023386
  error estimate for blocks of size 2^( 6) =       0.000418865740
  error estimate for blocks of size 2^( 7) =       0.000419633133

      target function =                  N/A
              le_mean =     -17.215879665858
             les_mean =     296.696921125423
             stat err =       0.000416797608
             autocorr =       1.169046704617
              std dev =       0.545160378783
             le_variance =       0.297199838594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297207589168
                                         uncertainty =       0.001994572628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297207589168
                                         uncertainty =       0.001994572628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385486601
  error estimate for blocks of size 2^( 2) =       0.000395934913
  error estimate for blocks of size 2^( 3) =       0.000405251353
  error estimate for blocks of size 2^( 4) =       0.000411668173
  error estimate for blocks of size 2^( 5) =       0.000417023386
  error estimate for blocks of size 2^( 6) =       0.000418865740
  error estimate for blocks of size 2^( 7) =       0.000419633133

      target function =                  N/A
              le_mean =     -17.215879665858
             les_mean =     296.696921125423
             stat err =       0.000416797608
             autocorr =       1.169046704617
              std dev =       0.545160378783
             le_variance =       0.297199838594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297207589168
                                         uncertainty =       0.001994572628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297207589168
                                         uncertainty =       0.001994572628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385486601
  error estimate for blocks of size 2^( 2) =       0.000395934913
  error estimate for blocks of size 2^( 3) =       0.000405251353
  error estimate for blocks of size 2^( 4) =       0.000411668173
  error estimate for blocks of size 2^( 5) =       0.000417023386
  error estimate for blocks of size 2^( 6) =       0.000418865740
  error estimate for blocks of size 2^( 7) =       0.000419633133

      target function =                  N/A
              le_mean =     -17.215879665858
             les_mean =     296.696921125423
             stat err =       0.000416797608
             autocorr =       1.169046704617
              std dev =       0.545160378783
             le_variance =       0.297199838594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297207589168
                                         uncertainty =       0.001994572628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297207589168
                                         uncertainty =       0.001994572628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385486601
  error estimate for blocks of size 2^( 2) =       0.000395934913
  error estimate for blocks of size 2^( 3) =       0.000405251353
  error estimate for blocks of size 2^( 4) =       0.000411668173
  error estimate for blocks of size 2^( 5) =       0.000417023386
  error estimate for blocks of size 2^( 6) =       0.000418865740
  error estimate for blocks of size 2^( 7) =       0.000419633133

      target function =                  N/A
              le_mean =     -17.215879665858
             les_mean =     296.696921125423
             stat err =       0.000416797608
             autocorr =       1.169046704617
              std dev =       0.545160378783
             le_variance =       0.297199838594


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215879665858        initial  <--
     5.9605e+39     5.9605e+40             0.0000e+00       -17.215879665858
     2.3842e+40     2.3842e+41             0.0000e+00       -17.215879665858
     9.5367e+40     9.5367e+41             0.0000e+00       -17.215879665858

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9437
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6636e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.3279
    reference variance = 0.342151
====================================================
  Execution time = 2.0697e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0859e-01
  Total weights = 1.956445042e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0022e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295657001755
                                         uncertainty =       0.001547089860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295657001755
                                         uncertainty =       0.001547089860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384485239
  error estimate for blocks of size 2^( 2) =       0.000394388905
  error estimate for blocks of size 2^( 3) =       0.000403705248
  error estimate for blocks of size 2^( 4) =       0.000410460812
  error estimate for blocks of size 2^( 5) =       0.000414138247
  error estimate for blocks of size 2^( 6) =       0.000414815270
  error estimate for blocks of size 2^( 7) =       0.000415470607

      target function =                  N/A
              le_mean =     -17.215978339843
             les_mean =     296.698499138391
             stat err =       0.000413721234
             autocorr =       1.157860614067
              std dev =       0.543744239113
             le_variance =       0.295657797569


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721597833984e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+40, overlap shift 5.9605e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215978339888       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215978339888       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215978145599       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+40 is 6.150910e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+41, overlap shift 2.3842e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215978339888       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215978339888       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215978339888       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215978339888       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.187500000000       residual = 2.37e+00           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+41 is 1.581559e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+41, overlap shift 9.5367e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215978339888       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215978339888       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215978622437       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+41 is 3.844319e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.984073 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6710e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2025
    reference variance = 0.19197
====================================================
  Execution time = 2.0739e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1352e-01
  Total weights = 1.9567e+06
  Execution time = 1.8377e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298513028002
                                         uncertainty =       0.001823177535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298513028002
                                         uncertainty =       0.001823177535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386350187
  error estimate for blocks of size 2^( 2) =       0.000396303184
  error estimate for blocks of size 2^( 3) =       0.000405432588
  error estimate for blocks of size 2^( 4) =       0.000412513649
  error estimate for blocks of size 2^( 5) =       0.000415704249
  error estimate for blocks of size 2^( 6) =       0.000417733771
  error estimate for blocks of size 2^( 7) =       0.000419596697

      target function =                  N/A
              le_mean =     -17.216170298920
             les_mean =     296.710039468468
             stat err =       0.000416387091
             autocorr =       1.161534891891
              std dev =       0.546381674686
             le_variance =       0.298532934433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298513028002
                                         uncertainty =       0.001823177535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298513028002
                                         uncertainty =       0.001823177535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386350187
  error estimate for blocks of size 2^( 2) =       0.000396303184
  error estimate for blocks of size 2^( 3) =       0.000405432588
  error estimate for blocks of size 2^( 4) =       0.000412513649
  error estimate for blocks of size 2^( 5) =       0.000415704249
  error estimate for blocks of size 2^( 6) =       0.000417733771
  error estimate for blocks of size 2^( 7) =       0.000419596697

      target function =                  N/A
              le_mean =     -17.216170298920
             les_mean =     296.710039468468
             stat err =       0.000416387091
             autocorr =       1.161534891891
              std dev =       0.546381674686
             le_variance =       0.298532934433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298513028002
                                         uncertainty =       0.001823177535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298513028002
                                         uncertainty =       0.001823177535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386350187
  error estimate for blocks of size 2^( 2) =       0.000396303184
  error estimate for blocks of size 2^( 3) =       0.000405432588
  error estimate for blocks of size 2^( 4) =       0.000412513649
  error estimate for blocks of size 2^( 5) =       0.000415704249
  error estimate for blocks of size 2^( 6) =       0.000417733771
  error estimate for blocks of size 2^( 7) =       0.000419596697

      target function =                  N/A
              le_mean =     -17.216170298920
             les_mean =     296.710039468468
             stat err =       0.000416387091
             autocorr =       1.161534891891
              std dev =       0.546381674686
             le_variance =       0.298532934433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298513028002
                                         uncertainty =       0.001823177535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298513028002
                                         uncertainty =       0.001823177535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386350187
  error estimate for blocks of size 2^( 2) =       0.000396303184
  error estimate for blocks of size 2^( 3) =       0.000405432588
  error estimate for blocks of size 2^( 4) =       0.000412513649
  error estimate for blocks of size 2^( 5) =       0.000415704249
  error estimate for blocks of size 2^( 6) =       0.000417733771
  error estimate for blocks of size 2^( 7) =       0.000419596697

      target function =                  N/A
              le_mean =     -17.216170298920
             les_mean =     296.710039468468
             stat err =       0.000416387091
             autocorr =       1.161534891891
              std dev =       0.546381674686
             le_variance =       0.298532934433


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216170298920        initial  <--
     5.9605e+40     5.9605e+41             6.1509e-45       -17.216170298920
     2.3842e+41     2.3842e+42             1.5816e-45       -17.216170298920
     9.5367e+41     9.5367e+42             3.8443e-46       -17.216170298920

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0098
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6726e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2005
    reference variance = 0.175617
====================================================
  Execution time = 2.0596e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1311e-01
  Total weights = 1.956429776e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299233135097
                                         uncertainty =       0.002072291609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299233135097
                                         uncertainty =       0.002072291609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386772243
  error estimate for blocks of size 2^( 2) =       0.000396778610
  error estimate for blocks of size 2^( 3) =       0.000405433932
  error estimate for blocks of size 2^( 4) =       0.000412396846
  error estimate for blocks of size 2^( 5) =       0.000416303386
  error estimate for blocks of size 2^( 6) =       0.000417213267
  error estimate for blocks of size 2^( 7) =       0.000417765848

      target function =                  N/A
              le_mean =     -17.216682844961
             les_mean =     296.727277001053
             stat err =       0.000415919837
             autocorr =       1.156401562196
              std dev =       0.546978551490
             le_variance =       0.299185535790


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668284496e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+41, overlap shift 5.9605e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216682845003       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216682845003       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+42, overlap shift 2.3842e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216682845003       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216682845003       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+42, overlap shift 9.5367e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216682845003       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216682845003       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.985260 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6681e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.1861
    reference variance = 0.182484
====================================================
  Execution time = 2.0474e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1264e-01
  Total weights = 1.9564e+06
  Execution time = 1.8391e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297463576947
                                         uncertainty =       0.001669460523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297463576947
                                         uncertainty =       0.001669460523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385691502
  error estimate for blocks of size 2^( 2) =       0.000395893155
  error estimate for blocks of size 2^( 3) =       0.000404979342
  error estimate for blocks of size 2^( 4) =       0.000411600133
  error estimate for blocks of size 2^( 5) =       0.000415850277
  error estimate for blocks of size 2^( 6) =       0.000418324112
  error estimate for blocks of size 2^( 7) =       0.000419117019

      target function =                  N/A
              le_mean =     -17.216577550605
             les_mean =     296.723183232462
             stat err =       0.000416222885
             autocorr =       1.164586553001
              std dev =       0.545450152771
             le_variance =       0.297515869158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297463576947
                                         uncertainty =       0.001669460523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297463576947
                                         uncertainty =       0.001669460523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385691502
  error estimate for blocks of size 2^( 2) =       0.000395893155
  error estimate for blocks of size 2^( 3) =       0.000404979342
  error estimate for blocks of size 2^( 4) =       0.000411600133
  error estimate for blocks of size 2^( 5) =       0.000415850277
  error estimate for blocks of size 2^( 6) =       0.000418324112
  error estimate for blocks of size 2^( 7) =       0.000419117019

      target function =                  N/A
              le_mean =     -17.216577550605
             les_mean =     296.723183232462
             stat err =       0.000416222885
             autocorr =       1.164586553001
              std dev =       0.545450152771
             le_variance =       0.297515869158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297463576947
                                         uncertainty =       0.001669460523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297463576947
                                         uncertainty =       0.001669460523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385691502
  error estimate for blocks of size 2^( 2) =       0.000395893155
  error estimate for blocks of size 2^( 3) =       0.000404979342
  error estimate for blocks of size 2^( 4) =       0.000411600133
  error estimate for blocks of size 2^( 5) =       0.000415850277
  error estimate for blocks of size 2^( 6) =       0.000418324112
  error estimate for blocks of size 2^( 7) =       0.000419117019

      target function =                  N/A
              le_mean =     -17.216577550605
             les_mean =     296.723183232462
             stat err =       0.000416222885
             autocorr =       1.164586553001
              std dev =       0.545450152771
             le_variance =       0.297515869158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297463576947
                                         uncertainty =       0.001669460523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297463576947
                                         uncertainty =       0.001669460523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385691502
  error estimate for blocks of size 2^( 2) =       0.000395893155
  error estimate for blocks of size 2^( 3) =       0.000404979342
  error estimate for blocks of size 2^( 4) =       0.000411600133
  error estimate for blocks of size 2^( 5) =       0.000415850277
  error estimate for blocks of size 2^( 6) =       0.000418324112
  error estimate for blocks of size 2^( 7) =       0.000419117019

      target function =                  N/A
              le_mean =     -17.216577550605
             les_mean =     296.723183232462
             stat err =       0.000416222885
             autocorr =       1.164586553001
              std dev =       0.545450152771
             le_variance =       0.297515869158


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216577550605        initial  <--
     5.9605e+41     5.9605e+42             0.0000e+00       -17.216577550605
     2.3842e+42     2.3842e+43             0.0000e+00       -17.216577550605
     9.5367e+42     9.5367e+43             0.0000e+00       -17.216577550605

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8077
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6494e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2241
    reference variance = 0.184674
====================================================
  Execution time = 2.1781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1204e-01
  Total weights = 1.956659162e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298723254223
                                         uncertainty =       0.002174306900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298723254223
                                         uncertainty =       0.002174306900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386488033
  error estimate for blocks of size 2^( 2) =       0.000396402663
  error estimate for blocks of size 2^( 3) =       0.000405400107
  error estimate for blocks of size 2^( 4) =       0.000412622674
  error estimate for blocks of size 2^( 5) =       0.000416589253
  error estimate for blocks of size 2^( 6) =       0.000421260432
  error estimate for blocks of size 2^( 7) =       0.000422301272

      target function =                  N/A
              le_mean =     -17.215526444044
             les_mean =     296.686392365869
             stat err =       0.000418193408
             autocorr =       1.170798783577
              std dev =       0.546576617665
             le_variance =       0.298745998979


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721552644404e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+42, overlap shift 5.9605e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215526444106       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215526444106       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+42 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+43, overlap shift 2.3842e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215526444106       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215526444106       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+43 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+43, overlap shift 9.5367e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215526444106       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215526444106       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+43 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.986368 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8056e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.1904
    reference variance = 0.274352
====================================================
  Execution time = 2.0505e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1643e-01
  Total weights = 1.9567e+06
  Execution time = 1.8371e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300277049216
                                         uncertainty =       0.001744793730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300277049216
                                         uncertainty =       0.001744793730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387901835
  error estimate for blocks of size 2^( 2) =       0.000398152725
  error estimate for blocks of size 2^( 3) =       0.000407012904
  error estimate for blocks of size 2^( 4) =       0.000413995594
  error estimate for blocks of size 2^( 5) =       0.000418370171
  error estimate for blocks of size 2^( 6) =       0.000419963047
  error estimate for blocks of size 2^( 7) =       0.000421508767

      target function =                  N/A
              le_mean =     -17.216860192314
             les_mean =     296.736705502923
             stat err =       0.000418459395
             autocorr =       1.163758795328
              std dev =       0.548576036563
             le_variance =       0.300935667891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300277049216
                                         uncertainty =       0.001744793730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300277049216
                                         uncertainty =       0.001744793730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387901835
  error estimate for blocks of size 2^( 2) =       0.000398152725
  error estimate for blocks of size 2^( 3) =       0.000407012904
  error estimate for blocks of size 2^( 4) =       0.000413995594
  error estimate for blocks of size 2^( 5) =       0.000418370171
  error estimate for blocks of size 2^( 6) =       0.000419963047
  error estimate for blocks of size 2^( 7) =       0.000421508767

      target function =                  N/A
              le_mean =     -17.216860192314
             les_mean =     296.736705502923
             stat err =       0.000418459395
             autocorr =       1.163758795328
              std dev =       0.548576036563
             le_variance =       0.300935667891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300277049216
                                         uncertainty =       0.001744793730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300277049216
                                         uncertainty =       0.001744793730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387901835
  error estimate for blocks of size 2^( 2) =       0.000398152725
  error estimate for blocks of size 2^( 3) =       0.000407012904
  error estimate for blocks of size 2^( 4) =       0.000413995594
  error estimate for blocks of size 2^( 5) =       0.000418370171
  error estimate for blocks of size 2^( 6) =       0.000419963047
  error estimate for blocks of size 2^( 7) =       0.000421508767

      target function =                  N/A
              le_mean =     -17.216860192314
             les_mean =     296.736705502923
             stat err =       0.000418459395
             autocorr =       1.163758795328
              std dev =       0.548576036563
             le_variance =       0.300935667891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300277049216
                                         uncertainty =       0.001744793730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300277049216
                                         uncertainty =       0.001744793730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387901835
  error estimate for blocks of size 2^( 2) =       0.000398152725
  error estimate for blocks of size 2^( 3) =       0.000407012904
  error estimate for blocks of size 2^( 4) =       0.000413995594
  error estimate for blocks of size 2^( 5) =       0.000418370171
  error estimate for blocks of size 2^( 6) =       0.000419963047
  error estimate for blocks of size 2^( 7) =       0.000421508767

      target function =                  N/A
              le_mean =     -17.216860192314
             les_mean =     296.736705502923
             stat err =       0.000418459395
             autocorr =       1.163758795328
              std dev =       0.548576036563
             le_variance =       0.300935667891


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216860192314        initial  <--
     5.9605e+42     5.9605e+43             0.0000e+00       -17.216860192314
     2.3842e+43     2.3842e+44             0.0000e+00       -17.216860192314
     9.5367e+43     9.5367e+44             0.0000e+00       -17.216860192314

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8085
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7870e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2168
    reference variance = 0.325937
====================================================
  Execution time = 2.0611e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1102e-01
  Total weights = 1.956563643e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297646727097
                                         uncertainty =       0.002367781076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297646727097
                                         uncertainty =       0.002367781076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385859187
  error estimate for blocks of size 2^( 2) =       0.000396162346
  error estimate for blocks of size 2^( 3) =       0.000405475820
  error estimate for blocks of size 2^( 4) =       0.000413449915
  error estimate for blocks of size 2^( 5) =       0.000417546674
  error estimate for blocks of size 2^( 6) =       0.000421414949
  error estimate for blocks of size 2^( 7) =       0.000424264553

      target function =                  N/A
              le_mean =     -17.216182070733
             les_mean =     296.707944601324
             stat err =       0.000419169023
             autocorr =       1.180105054212
              std dev =       0.545687295436
             le_variance =       0.297774624401


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721618207073e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+43, overlap shift 5.9605e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216182070783       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216182070783       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216182070783       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+43 is 5.038457e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+44, overlap shift 2.3842e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216182070783       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216182070783       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216182070783       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+44 is 1.259614e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+44, overlap shift 9.5367e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216182070783       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216182070783       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216182070783       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+44 is 3.149036e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.987828 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6636e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2645
    reference variance = 0.147534
====================================================
  Execution time = 2.0324e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2206e-01
  Total weights = 1.9564e+06
  Execution time = 1.8397e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301544915181
                                         uncertainty =       0.001935450467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301544915181
                                         uncertainty =       0.001935450467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388701279
  error estimate for blocks of size 2^( 2) =       0.000398550813
  error estimate for blocks of size 2^( 3) =       0.000406842011
  error estimate for blocks of size 2^( 4) =       0.000413940751
  error estimate for blocks of size 2^( 5) =       0.000417763900
  error estimate for blocks of size 2^( 6) =       0.000420651282
  error estimate for blocks of size 2^( 7) =       0.000420877178

      target function =                  N/A
              le_mean =     -17.216528272043
             les_mean =     296.730908124724
             stat err =       0.000418308278
             autocorr =       1.158139777121
              std dev =       0.549706620599
             le_variance =       0.302177368730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301544915181
                                         uncertainty =       0.001935450467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301544915181
                                         uncertainty =       0.001935450467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388701279
  error estimate for blocks of size 2^( 2) =       0.000398550813
  error estimate for blocks of size 2^( 3) =       0.000406842011
  error estimate for blocks of size 2^( 4) =       0.000413940751
  error estimate for blocks of size 2^( 5) =       0.000417763900
  error estimate for blocks of size 2^( 6) =       0.000420651282
  error estimate for blocks of size 2^( 7) =       0.000420877178

      target function =                  N/A
              le_mean =     -17.216528272043
             les_mean =     296.730908124724
             stat err =       0.000418308278
             autocorr =       1.158139777121
              std dev =       0.549706620599
             le_variance =       0.302177368730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301544915181
                                         uncertainty =       0.001935450467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301544915181
                                         uncertainty =       0.001935450467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388701279
  error estimate for blocks of size 2^( 2) =       0.000398550813
  error estimate for blocks of size 2^( 3) =       0.000406842011
  error estimate for blocks of size 2^( 4) =       0.000413940751
  error estimate for blocks of size 2^( 5) =       0.000417763900
  error estimate for blocks of size 2^( 6) =       0.000420651282
  error estimate for blocks of size 2^( 7) =       0.000420877178

      target function =                  N/A
              le_mean =     -17.216528272043
             les_mean =     296.730908124724
             stat err =       0.000418308278
             autocorr =       1.158139777121
              std dev =       0.549706620599
             le_variance =       0.302177368730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301544915181
                                         uncertainty =       0.001935450467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301544915181
                                         uncertainty =       0.001935450467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388701279
  error estimate for blocks of size 2^( 2) =       0.000398550813
  error estimate for blocks of size 2^( 3) =       0.000406842011
  error estimate for blocks of size 2^( 4) =       0.000413940751
  error estimate for blocks of size 2^( 5) =       0.000417763900
  error estimate for blocks of size 2^( 6) =       0.000420651282
  error estimate for blocks of size 2^( 7) =       0.000420877178

      target function =                  N/A
              le_mean =     -17.216528272043
             les_mean =     296.730908124724
             stat err =       0.000418308278
             autocorr =       1.158139777121
              std dev =       0.549706620599
             le_variance =       0.302177368730


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216528272043        initial  <--
     5.9605e+43     5.9605e+44             5.0385e-48       -17.216528272043
     2.3842e+44     2.3842e+45             1.2596e-48       -17.216528272043
     9.5367e+44     9.5367e+45             3.1490e-49       -17.216528272043

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6119
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6254e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2437
    reference variance = 0.600555
====================================================
  Execution time = 2.0649e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1352e-01
  Total weights = 1.956476481e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1211e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300118423038
                                         uncertainty =       0.001981740756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300118423038
                                         uncertainty =       0.001981740756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387334632
  error estimate for blocks of size 2^( 2) =       0.000396960322
  error estimate for blocks of size 2^( 3) =       0.000406138152
  error estimate for blocks of size 2^( 4) =       0.000412989865
  error estimate for blocks of size 2^( 5) =       0.000416718386
  error estimate for blocks of size 2^( 6) =       0.000419647748
  error estimate for blocks of size 2^( 7) =       0.000422505709

      target function =                  N/A
              le_mean =     -17.216660373476
             les_mean =     296.726910830133
             stat err =       0.000417965427
             autocorr =       1.164415723032
              std dev =       0.547773889241
             le_variance =       0.300056233735


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666037348e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+44, overlap shift 5.9605e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216660373529       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216660373529       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216660373529       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+44 is 5.614611e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+45, overlap shift 2.3842e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216660373529       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216660373529       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216660373529       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+45 is 1.403653e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+45, overlap shift 9.5367e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216660373529       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216660373529       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216660373529       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+45 is 3.509132e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.989290 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6780e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.1301
    reference variance = 0.192551
====================================================
  Execution time = 2.0544e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1157e-01
  Total weights = 1.9566e+06
  Execution time = 1.8245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299613585436
                                         uncertainty =       0.002020598958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299613585436
                                         uncertainty =       0.002020598958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387011964
  error estimate for blocks of size 2^( 2) =       0.000396820360
  error estimate for blocks of size 2^( 3) =       0.000406485766
  error estimate for blocks of size 2^( 4) =       0.000413941569
  error estimate for blocks of size 2^( 5) =       0.000417767876
  error estimate for blocks of size 2^( 6) =       0.000419212274
  error estimate for blocks of size 2^( 7) =       0.000422229303

      target function =                  N/A
              le_mean =     -17.215823616019
             les_mean =     296.696154325352
             stat err =       0.000418287756
             autocorr =       1.168157821751
              std dev =       0.547317568592
             le_variance =       0.299556520889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299613585436
                                         uncertainty =       0.002020598958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299613585436
                                         uncertainty =       0.002020598958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387011964
  error estimate for blocks of size 2^( 2) =       0.000396820360
  error estimate for blocks of size 2^( 3) =       0.000406485766
  error estimate for blocks of size 2^( 4) =       0.000413941569
  error estimate for blocks of size 2^( 5) =       0.000417767876
  error estimate for blocks of size 2^( 6) =       0.000419212274
  error estimate for blocks of size 2^( 7) =       0.000422229303

      target function =                  N/A
              le_mean =     -17.215823616019
             les_mean =     296.696154325352
             stat err =       0.000418287756
             autocorr =       1.168157821751
              std dev =       0.547317568592
             le_variance =       0.299556520889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299613585436
                                         uncertainty =       0.002020598958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299613585436
                                         uncertainty =       0.002020598958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387011964
  error estimate for blocks of size 2^( 2) =       0.000396820360
  error estimate for blocks of size 2^( 3) =       0.000406485766
  error estimate for blocks of size 2^( 4) =       0.000413941569
  error estimate for blocks of size 2^( 5) =       0.000417767876
  error estimate for blocks of size 2^( 6) =       0.000419212274
  error estimate for blocks of size 2^( 7) =       0.000422229303

      target function =                  N/A
              le_mean =     -17.215823616019
             les_mean =     296.696154325352
             stat err =       0.000418287756
             autocorr =       1.168157821751
              std dev =       0.547317568592
             le_variance =       0.299556520889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299613585436
                                         uncertainty =       0.002020598958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299613585436
                                         uncertainty =       0.002020598958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387011964
  error estimate for blocks of size 2^( 2) =       0.000396820360
  error estimate for blocks of size 2^( 3) =       0.000406485766
  error estimate for blocks of size 2^( 4) =       0.000413941569
  error estimate for blocks of size 2^( 5) =       0.000417767876
  error estimate for blocks of size 2^( 6) =       0.000419212274
  error estimate for blocks of size 2^( 7) =       0.000422229303

      target function =                  N/A
              le_mean =     -17.215823616019
             les_mean =     296.696154325352
             stat err =       0.000418287756
             autocorr =       1.168157821751
              std dev =       0.547317568592
             le_variance =       0.299556520889


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215823616019        initial  <--
     5.9605e+44     5.9605e+45             5.6146e-49       -17.215823616019
     2.3842e+45     2.3842e+46             1.4037e-49       -17.215823616019
     9.5367e+45     9.5367e+46             3.5091e-50       -17.215823616019

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7979
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6584e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1701
    reference variance = 0.339408
====================================================
  Execution time = 2.0757e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1674e-01
  Total weights = 1.956855967e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301393971371
                                         uncertainty =       0.002919473499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301393971371
                                         uncertainty =       0.002919473499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388199396
  error estimate for blocks of size 2^( 2) =       0.000397841867
  error estimate for blocks of size 2^( 3) =       0.000406825670
  error estimate for blocks of size 2^( 4) =       0.000413218069
  error estimate for blocks of size 2^( 5) =       0.000417155635
  error estimate for blocks of size 2^( 6) =       0.000419883877
  error estimate for blocks of size 2^( 7) =       0.000424088265

      target function =                  N/A
              le_mean =     -17.216041653306
             les_mean =     296.708830113847
             stat err =       0.000418586462
             autocorr =       1.162681187781
              std dev =       0.548996850234
             le_variance =       0.301397541567


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604165331e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+45, overlap shift 5.9605e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216041653345       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216041653345       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216041653345       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+45 is 6.621966e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+46, overlap shift 2.3842e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216041653345       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216041653345       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216041653345       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+46 is 1.655492e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+46, overlap shift 9.5367e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216041653345       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216041653345       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216041653345       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+46 is 4.138729e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.990780 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6744e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.3267
    reference variance = 0.268428
====================================================
  Execution time = 2.0805e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1685e-01
  Total weights = 1.9565e+06
  Execution time = 1.8504e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301509970205
                                         uncertainty =       0.002207890142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301509970205
                                         uncertainty =       0.002207890142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388231716
  error estimate for blocks of size 2^( 2) =       0.000398078628
  error estimate for blocks of size 2^( 3) =       0.000406561199
  error estimate for blocks of size 2^( 4) =       0.000413520790
  error estimate for blocks of size 2^( 5) =       0.000417878748
  error estimate for blocks of size 2^( 6) =       0.000419996081
  error estimate for blocks of size 2^( 7) =       0.000420474632

      target function =                  N/A
              le_mean =     -17.217466492682
             les_mean =     296.757999205299
             stat err =       0.000417967563
             autocorr =       1.159052567767
              std dev =       0.549042558448
             le_variance =       0.301447730987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301509970205
                                         uncertainty =       0.002207890142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301509970205
                                         uncertainty =       0.002207890142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388231716
  error estimate for blocks of size 2^( 2) =       0.000398078628
  error estimate for blocks of size 2^( 3) =       0.000406561199
  error estimate for blocks of size 2^( 4) =       0.000413520790
  error estimate for blocks of size 2^( 5) =       0.000417878748
  error estimate for blocks of size 2^( 6) =       0.000419996081
  error estimate for blocks of size 2^( 7) =       0.000420474632

      target function =                  N/A
              le_mean =     -17.217466492682
             les_mean =     296.757999205299
             stat err =       0.000417967563
             autocorr =       1.159052567767
              std dev =       0.549042558448
             le_variance =       0.301447730987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301509970205
                                         uncertainty =       0.002207890142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301509970205
                                         uncertainty =       0.002207890142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388231716
  error estimate for blocks of size 2^( 2) =       0.000398078628
  error estimate for blocks of size 2^( 3) =       0.000406561199
  error estimate for blocks of size 2^( 4) =       0.000413520790
  error estimate for blocks of size 2^( 5) =       0.000417878748
  error estimate for blocks of size 2^( 6) =       0.000419996081
  error estimate for blocks of size 2^( 7) =       0.000420474632

      target function =                  N/A
              le_mean =     -17.217466492682
             les_mean =     296.757999205299
             stat err =       0.000417967563
             autocorr =       1.159052567767
              std dev =       0.549042558448
             le_variance =       0.301447730987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301509970205
                                         uncertainty =       0.002207890142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301509970205
                                         uncertainty =       0.002207890142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388231716
  error estimate for blocks of size 2^( 2) =       0.000398078628
  error estimate for blocks of size 2^( 3) =       0.000406561199
  error estimate for blocks of size 2^( 4) =       0.000413520790
  error estimate for blocks of size 2^( 5) =       0.000417878748
  error estimate for blocks of size 2^( 6) =       0.000419996081
  error estimate for blocks of size 2^( 7) =       0.000420474632

      target function =                  N/A
              le_mean =     -17.217466492682
             les_mean =     296.757999205299
             stat err =       0.000417967563
             autocorr =       1.159052567767
              std dev =       0.549042558448
             le_variance =       0.301447730987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217466492682        initial  <--
     5.9605e+45     5.9605e+46             6.6220e-50       -17.217466492682
     2.3842e+46     2.3842e+47             1.6555e-50       -17.217466492682
     9.5367e+46     9.5367e+47             4.1387e-51       -17.217466492682

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1326
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6882e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2379
    reference variance = 0.257468
====================================================
  Execution time = 2.0726e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1120e-01
  Total weights = 1.956778761e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296098070415
                                         uncertainty =       0.001734485515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296098070415
                                         uncertainty =       0.001734485515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384785367
  error estimate for blocks of size 2^( 2) =       0.000395321396
  error estimate for blocks of size 2^( 3) =       0.000404308168
  error estimate for blocks of size 2^( 4) =       0.000411917861
  error estimate for blocks of size 2^( 5) =       0.000415924312
  error estimate for blocks of size 2^( 6) =       0.000417962256
  error estimate for blocks of size 2^( 7) =       0.000419779885

      target function =                  N/A
              le_mean =     -17.216566923441
             les_mean =     296.721375672195
             stat err =       0.000416396079
             autocorr =       1.171051962842
              std dev =       0.544168684532
             le_variance =       0.296119557226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656692344e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+46, overlap shift 5.9605e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216566923501       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566923501       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566923501       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -18.000000000000       residual = 9.42e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+46 is 6.781340e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+47, overlap shift 2.3842e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216566923501       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566923501       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566923501       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.000000000000       residual = 2.31e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+47 is 1.695335e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+47, overlap shift 9.5367e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216566923501       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566923501       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566923501       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.000000000000       residual = 2.31e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+47 is 4.238338e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.992545 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6836e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1696
    reference variance = 0.268826
====================================================
  Execution time = 2.0373e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2331e-01
  Total weights = 1.9566e+06
  Execution time = 1.8524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305189800507
                                         uncertainty =       0.005207834752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305189800507
                                         uncertainty =       0.005207834752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390602772
  error estimate for blocks of size 2^( 2) =       0.000400583275
  error estimate for blocks of size 2^( 3) =       0.000409836067
  error estimate for blocks of size 2^( 4) =       0.000416555425
  error estimate for blocks of size 2^( 5) =       0.000420724073
  error estimate for blocks of size 2^( 6) =       0.000423797855
  error estimate for blocks of size 2^( 7) =       0.000425343134

      target function =                  N/A
              le_mean =     -17.216472436296
             les_mean =     296.730234985606
             stat err =       0.000421605122
             autocorr =       1.165040744206
              std dev =       0.552395737737
             le_variance =       0.305141051070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305189800507
                                         uncertainty =       0.005207834752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305189800507
                                         uncertainty =       0.005207834752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390602772
  error estimate for blocks of size 2^( 2) =       0.000400583275
  error estimate for blocks of size 2^( 3) =       0.000409836067
  error estimate for blocks of size 2^( 4) =       0.000416555425
  error estimate for blocks of size 2^( 5) =       0.000420724073
  error estimate for blocks of size 2^( 6) =       0.000423797855
  error estimate for blocks of size 2^( 7) =       0.000425343134

      target function =                  N/A
              le_mean =     -17.216472436296
             les_mean =     296.730234985606
             stat err =       0.000421605122
             autocorr =       1.165040744206
              std dev =       0.552395737737
             le_variance =       0.305141051070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305189800507
                                         uncertainty =       0.005207834752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305189800507
                                         uncertainty =       0.005207834752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390602772
  error estimate for blocks of size 2^( 2) =       0.000400583275
  error estimate for blocks of size 2^( 3) =       0.000409836067
  error estimate for blocks of size 2^( 4) =       0.000416555425
  error estimate for blocks of size 2^( 5) =       0.000420724073
  error estimate for blocks of size 2^( 6) =       0.000423797855
  error estimate for blocks of size 2^( 7) =       0.000425343134

      target function =                  N/A
              le_mean =     -17.216472436296
             les_mean =     296.730234985606
             stat err =       0.000421605122
             autocorr =       1.165040744206
              std dev =       0.552395737737
             le_variance =       0.305141051070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305189800507
                                         uncertainty =       0.005207834752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305189800507
                                         uncertainty =       0.005207834752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390602772
  error estimate for blocks of size 2^( 2) =       0.000400583275
  error estimate for blocks of size 2^( 3) =       0.000409836067
  error estimate for blocks of size 2^( 4) =       0.000416555425
  error estimate for blocks of size 2^( 5) =       0.000420724073
  error estimate for blocks of size 2^( 6) =       0.000423797855
  error estimate for blocks of size 2^( 7) =       0.000425343134

      target function =                  N/A
              le_mean =     -17.216472436296
             les_mean =     296.730234985606
             stat err =       0.000421605122
             autocorr =       1.165040744206
              std dev =       0.552395737737
             le_variance =       0.305141051070


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216472436296        initial  <--
     5.9605e+46     5.9605e+47             6.7813e-51       -17.216472436296
     2.3842e+47     2.3842e+48             1.6953e-51       -17.216472436296
     9.5367e+47     9.5367e+48             4.2383e-52       -17.216472436296

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7073
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6549e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2302
    reference variance = 0.22442
====================================================
  Execution time = 2.0709e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1214e-01
  Total weights = 1.956797739e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296548543309
                                         uncertainty =       0.001857854623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296548543309
                                         uncertainty =       0.001857854623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385047449
  error estimate for blocks of size 2^( 2) =       0.000395085378
  error estimate for blocks of size 2^( 3) =       0.000403742329
  error estimate for blocks of size 2^( 4) =       0.000410428670
  error estimate for blocks of size 2^( 5) =       0.000414288495
  error estimate for blocks of size 2^( 6) =       0.000413938442
  error estimate for blocks of size 2^( 7) =       0.000415092891

      target function =                  N/A
              le_mean =     -17.215874741934
             les_mean =     296.698482941389
             stat err =       0.000413437124
             autocorr =       1.152896820976
              std dev =       0.544539324694
             le_variance =       0.296523076139


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721587474193e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+47, overlap shift 5.9605e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215874742006       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215874742006       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.218750000000       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+47 is 5.563625e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+48, overlap shift 2.3842e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215874742006       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215874742006       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.000000000000       residual = 2.29e+02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+48 is 1.390906e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+48, overlap shift 9.5367e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215874742006       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215874742006       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.187500000000       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.000000000000       residual = 2.29e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+48 is 3.477266e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.994110 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6953e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2042
    reference variance = 0.36043
====================================================
  Execution time = 2.2659e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1535e-01
  Total weights = 1.9566e+06
  Execution time = 1.8374e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299529886654
                                         uncertainty =       0.001861606826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299529886654
                                         uncertainty =       0.001861606826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387006789
  error estimate for blocks of size 2^( 2) =       0.000397134734
  error estimate for blocks of size 2^( 3) =       0.000405823956
  error estimate for blocks of size 2^( 4) =       0.000412949191
  error estimate for blocks of size 2^( 5) =       0.000417025400
  error estimate for blocks of size 2^( 6) =       0.000418429886
  error estimate for blocks of size 2^( 7) =       0.000420448140

      target function =                  N/A
              le_mean =     -17.217081694582
             les_mean =     296.743247457740
             stat err =       0.000417213154
             autocorr =       1.162194507988
              std dev =       0.547310249317
             le_variance =       0.299548509007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299529886654
                                         uncertainty =       0.001861606826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299529886654
                                         uncertainty =       0.001861606826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387006789
  error estimate for blocks of size 2^( 2) =       0.000397134734
  error estimate for blocks of size 2^( 3) =       0.000405823956
  error estimate for blocks of size 2^( 4) =       0.000412949191
  error estimate for blocks of size 2^( 5) =       0.000417025400
  error estimate for blocks of size 2^( 6) =       0.000418429886
  error estimate for blocks of size 2^( 7) =       0.000420448140

      target function =                  N/A
              le_mean =     -17.217081694582
             les_mean =     296.743247457740
             stat err =       0.000417213154
             autocorr =       1.162194507988
              std dev =       0.547310249317
             le_variance =       0.299548509007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299529886654
                                         uncertainty =       0.001861606826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299529886654
                                         uncertainty =       0.001861606826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387006789
  error estimate for blocks of size 2^( 2) =       0.000397134734
  error estimate for blocks of size 2^( 3) =       0.000405823956
  error estimate for blocks of size 2^( 4) =       0.000412949191
  error estimate for blocks of size 2^( 5) =       0.000417025400
  error estimate for blocks of size 2^( 6) =       0.000418429886
  error estimate for blocks of size 2^( 7) =       0.000420448140

      target function =                  N/A
              le_mean =     -17.217081694582
             les_mean =     296.743247457740
             stat err =       0.000417213154
             autocorr =       1.162194507988
              std dev =       0.547310249317
             le_variance =       0.299548509007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299529886654
                                         uncertainty =       0.001861606826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299529886654
                                         uncertainty =       0.001861606826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387006789
  error estimate for blocks of size 2^( 2) =       0.000397134734
  error estimate for blocks of size 2^( 3) =       0.000405823956
  error estimate for blocks of size 2^( 4) =       0.000412949191
  error estimate for blocks of size 2^( 5) =       0.000417025400
  error estimate for blocks of size 2^( 6) =       0.000418429886
  error estimate for blocks of size 2^( 7) =       0.000420448140

      target function =                  N/A
              le_mean =     -17.217081694582
             les_mean =     296.743247457740
             stat err =       0.000417213154
             autocorr =       1.162194507988
              std dev =       0.547310249317
             le_variance =       0.299548509007


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217081694582        initial  <--
     5.9605e+47     5.9605e+48             5.5636e-52       -17.217081694582
     2.3842e+48     2.3842e+49             1.3909e-52       -17.217081694582
     9.5367e+48     9.5367e+49             3.4773e-53       -17.217081694582

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.9683
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8928e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.1321
    reference variance = 0.174727
====================================================
  Execution time = 2.0784e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1171e-01
  Total weights = 1.956452079e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297249474203
                                         uncertainty =       0.002091684945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297249474203
                                         uncertainty =       0.002091684945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385469620
  error estimate for blocks of size 2^( 2) =       0.000395427889
  error estimate for blocks of size 2^( 3) =       0.000404873294
  error estimate for blocks of size 2^( 4) =       0.000412035414
  error estimate for blocks of size 2^( 5) =       0.000415932256
  error estimate for blocks of size 2^( 6) =       0.000418297969
  error estimate for blocks of size 2^( 7) =       0.000418407029

      target function =                  N/A
              le_mean =     -17.215831908701
             les_mean =     296.696578531343
             stat err =       0.000416168167
             autocorr =       1.165621109253
              std dev =       0.545136364382
             le_variance =       0.297173655771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721583190870e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+48, overlap shift 5.9605e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215831908745       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215831908745       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.000000000000       residual = 2.29e+02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+48 is 5.994523e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+49, overlap shift 2.3842e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215831908745       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215831908745       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.000000000000       residual = 2.29e+02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+49 is 1.498631e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+49, overlap shift 9.5367e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215831908745       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215831908745       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.000000000000       residual = 2.29e+02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+49 is 3.746577e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.995569 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6915e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.1734
    reference variance = 0.155346
====================================================
  Execution time = 2.0829e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1246e-01
  Total weights = 1.9567e+06
  Execution time = 1.8368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299997699171
                                         uncertainty =       0.002531416997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299997699171
                                         uncertainty =       0.002531416997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387310268
  error estimate for blocks of size 2^( 2) =       0.000397367426
  error estimate for blocks of size 2^( 3) =       0.000406478280
  error estimate for blocks of size 2^( 4) =       0.000413837651
  error estimate for blocks of size 2^( 5) =       0.000417980228
  error estimate for blocks of size 2^( 6) =       0.000418902149
  error estimate for blocks of size 2^( 7) =       0.000420727681

      target function =                  N/A
              le_mean =     -17.216908211201
             les_mean =     296.734388581011
             stat err =       0.000417861927
             autocorr =       1.163985537578
              std dev =       0.547739434270
             le_variance =       0.300018487854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299997699171
                                         uncertainty =       0.002531416997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299997699171
                                         uncertainty =       0.002531416997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387310268
  error estimate for blocks of size 2^( 2) =       0.000397367426
  error estimate for blocks of size 2^( 3) =       0.000406478280
  error estimate for blocks of size 2^( 4) =       0.000413837651
  error estimate for blocks of size 2^( 5) =       0.000417980228
  error estimate for blocks of size 2^( 6) =       0.000418902149
  error estimate for blocks of size 2^( 7) =       0.000420727681

      target function =                  N/A
              le_mean =     -17.216908211201
             les_mean =     296.734388581011
             stat err =       0.000417861927
             autocorr =       1.163985537578
              std dev =       0.547739434270
             le_variance =       0.300018487854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299997699171
                                         uncertainty =       0.002531416997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299997699171
                                         uncertainty =       0.002531416997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387310268
  error estimate for blocks of size 2^( 2) =       0.000397367426
  error estimate for blocks of size 2^( 3) =       0.000406478280
  error estimate for blocks of size 2^( 4) =       0.000413837651
  error estimate for blocks of size 2^( 5) =       0.000417980228
  error estimate for blocks of size 2^( 6) =       0.000418902149
  error estimate for blocks of size 2^( 7) =       0.000420727681

      target function =                  N/A
              le_mean =     -17.216908211201
             les_mean =     296.734388581011
             stat err =       0.000417861927
             autocorr =       1.163985537578
              std dev =       0.547739434270
             le_variance =       0.300018487854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299997699171
                                         uncertainty =       0.002531416997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299997699171
                                         uncertainty =       0.002531416997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387310268
  error estimate for blocks of size 2^( 2) =       0.000397367426
  error estimate for blocks of size 2^( 3) =       0.000406478280
  error estimate for blocks of size 2^( 4) =       0.000413837651
  error estimate for blocks of size 2^( 5) =       0.000417980228
  error estimate for blocks of size 2^( 6) =       0.000418902149
  error estimate for blocks of size 2^( 7) =       0.000420727681

      target function =                  N/A
              le_mean =     -17.216908211201
             les_mean =     296.734388581011
             stat err =       0.000417861927
             autocorr =       1.163985537578
              std dev =       0.547739434270
             le_variance =       0.300018487854


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216908211201        initial  <--
     5.9605e+48     5.9605e+49             5.9945e-53       -17.216908211201
     2.3842e+49     2.3842e+50             1.4986e-53       -17.216908211201
     9.5367e+49     9.5367e+50             3.7466e-54       -17.216908211201

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1558
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7076e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2443
    reference variance = 0.275953
====================================================
  Execution time = 2.0643e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1178e-01
  Total weights = 1.956722197e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298016443840
                                         uncertainty =       0.001961173603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298016443840
                                         uncertainty =       0.001961173603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386060065
  error estimate for blocks of size 2^( 2) =       0.000396118852
  error estimate for blocks of size 2^( 3) =       0.000404764089
  error estimate for blocks of size 2^( 4) =       0.000411215129
  error estimate for blocks of size 2^( 5) =       0.000415032296
  error estimate for blocks of size 2^( 6) =       0.000416938712
  error estimate for blocks of size 2^( 7) =       0.000418803685

      target function =                  N/A
              le_mean =     -17.216364204718
             les_mean =     296.714980244709
             stat err =       0.000415497455
             autocorr =       1.158315792514
              std dev =       0.545971380135
             le_variance =       0.298084747927


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721636420472e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+49, overlap shift 5.9605e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216364204782       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216364204782       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+50, overlap shift 2.3842e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216364204782       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216364204782       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+50, overlap shift 9.5367e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216364204782       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216364204782       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.996749 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6680e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2071
    reference variance = 0.193686
====================================================
  Execution time = 2.0697e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1076e-01
  Total weights = 1.9568e+06
  Execution time = 1.8404e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297388922205
                                         uncertainty =       0.001839768028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297388922205
                                         uncertainty =       0.001839768028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385585008
  error estimate for blocks of size 2^( 2) =       0.000395959710
  error estimate for blocks of size 2^( 3) =       0.000405094452
  error estimate for blocks of size 2^( 4) =       0.000411988738
  error estimate for blocks of size 2^( 5) =       0.000416544999
  error estimate for blocks of size 2^( 6) =       0.000420604644
  error estimate for blocks of size 2^( 7) =       0.000424475072

      target function =                  N/A
              le_mean =     -17.215851054659
             les_mean =     296.696283895485
             stat err =       0.000418403363
             autocorr =       1.177470550428
              std dev =       0.545299548263
             le_variance =       0.297351597336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297388922205
                                         uncertainty =       0.001839768028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297388922205
                                         uncertainty =       0.001839768028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385585008
  error estimate for blocks of size 2^( 2) =       0.000395959710
  error estimate for blocks of size 2^( 3) =       0.000405094452
  error estimate for blocks of size 2^( 4) =       0.000411988738
  error estimate for blocks of size 2^( 5) =       0.000416544999
  error estimate for blocks of size 2^( 6) =       0.000420604644
  error estimate for blocks of size 2^( 7) =       0.000424475072

      target function =                  N/A
              le_mean =     -17.215851054659
             les_mean =     296.696283895485
             stat err =       0.000418403363
             autocorr =       1.177470550428
              std dev =       0.545299548263
             le_variance =       0.297351597336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297388922205
                                         uncertainty =       0.001839768028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297388922205
                                         uncertainty =       0.001839768028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385585008
  error estimate for blocks of size 2^( 2) =       0.000395959710
  error estimate for blocks of size 2^( 3) =       0.000405094452
  error estimate for blocks of size 2^( 4) =       0.000411988738
  error estimate for blocks of size 2^( 5) =       0.000416544999
  error estimate for blocks of size 2^( 6) =       0.000420604644
  error estimate for blocks of size 2^( 7) =       0.000424475072

      target function =                  N/A
              le_mean =     -17.215851054659
             les_mean =     296.696283895485
             stat err =       0.000418403363
             autocorr =       1.177470550428
              std dev =       0.545299548263
             le_variance =       0.297351597336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297388922205
                                         uncertainty =       0.001839768028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297388922205
                                         uncertainty =       0.001839768028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385585008
  error estimate for blocks of size 2^( 2) =       0.000395959710
  error estimate for blocks of size 2^( 3) =       0.000405094452
  error estimate for blocks of size 2^( 4) =       0.000411988738
  error estimate for blocks of size 2^( 5) =       0.000416544999
  error estimate for blocks of size 2^( 6) =       0.000420604644
  error estimate for blocks of size 2^( 7) =       0.000424475072

      target function =                  N/A
              le_mean =     -17.215851054659
             les_mean =     296.696283895485
             stat err =       0.000418403363
             autocorr =       1.177470550428
              std dev =       0.545299548263
             le_variance =       0.297351597336


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215851054659        initial  <--
     5.9605e+49     5.9605e+50             0.0000e+00       -17.215851054659
     2.3842e+50     2.3842e+51             0.0000e+00       -17.215851054659
     9.5367e+50     9.5367e+51             0.0000e+00       -17.215851054659

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0429
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6729e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2277
    reference variance = 0.189332
====================================================
  Execution time = 2.0693e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1482e-01
  Total weights = 1.956518061e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301320174883
                                         uncertainty =       0.002318212819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301320174883
                                         uncertainty =       0.002318212819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388104210
  error estimate for blocks of size 2^( 2) =       0.000398254661
  error estimate for blocks of size 2^( 3) =       0.000407408350
  error estimate for blocks of size 2^( 4) =       0.000414349836
  error estimate for blocks of size 2^( 5) =       0.000419188881
  error estimate for blocks of size 2^( 6) =       0.000420982425
  error estimate for blocks of size 2^( 7) =       0.000422328017

      target function =                  N/A
              le_mean =     -17.216229805485
             les_mean =     296.713390464488
             stat err =       0.000419212290
             autocorr =       1.166732521655
              std dev =       0.548862238014
             le_variance =       0.301249756318


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721622980549e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+50, overlap shift 5.9605e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216229805494       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216229805494       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+51, overlap shift 2.3842e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216229805494       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216229805494       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+51, overlap shift 9.5367e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216229805494       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216229805494       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.997932 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6763e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1672
    reference variance = 0.243722
====================================================
  Execution time = 2.0627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1242e-01
  Total weights = 1.9565e+06
  Execution time = 1.8461e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297338259353
                                         uncertainty =       0.001809026035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297338259353
                                         uncertainty =       0.001809026035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385646115
  error estimate for blocks of size 2^( 2) =       0.000395451036
  error estimate for blocks of size 2^( 3) =       0.000404713262
  error estimate for blocks of size 2^( 4) =       0.000411933077
  error estimate for blocks of size 2^( 5) =       0.000416481227
  error estimate for blocks of size 2^( 6) =       0.000417866147
  error estimate for blocks of size 2^( 7) =       0.000419105121

      target function =                  N/A
              le_mean =     -17.216679231956
             les_mean =     296.726460776965
             stat err =       0.000416346393
             autocorr =       1.165552104574
              std dev =       0.545385965514
             le_variance =       0.297445851379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297338259353
                                         uncertainty =       0.001809026035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297338259353
                                         uncertainty =       0.001809026035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385646115
  error estimate for blocks of size 2^( 2) =       0.000395451036
  error estimate for blocks of size 2^( 3) =       0.000404713262
  error estimate for blocks of size 2^( 4) =       0.000411933077
  error estimate for blocks of size 2^( 5) =       0.000416481227
  error estimate for blocks of size 2^( 6) =       0.000417866147
  error estimate for blocks of size 2^( 7) =       0.000419105121

      target function =                  N/A
              le_mean =     -17.216679231956
             les_mean =     296.726460776965
             stat err =       0.000416346393
             autocorr =       1.165552104574
              std dev =       0.545385965514
             le_variance =       0.297445851379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297338259353
                                         uncertainty =       0.001809026035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297338259353
                                         uncertainty =       0.001809026035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385646115
  error estimate for blocks of size 2^( 2) =       0.000395451036
  error estimate for blocks of size 2^( 3) =       0.000404713262
  error estimate for blocks of size 2^( 4) =       0.000411933077
  error estimate for blocks of size 2^( 5) =       0.000416481227
  error estimate for blocks of size 2^( 6) =       0.000417866147
  error estimate for blocks of size 2^( 7) =       0.000419105121

      target function =                  N/A
              le_mean =     -17.216679231956
             les_mean =     296.726460776965
             stat err =       0.000416346393
             autocorr =       1.165552104574
              std dev =       0.545385965514
             le_variance =       0.297445851379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297338259353
                                         uncertainty =       0.001809026035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297338259353
                                         uncertainty =       0.001809026035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385646115
  error estimate for blocks of size 2^( 2) =       0.000395451036
  error estimate for blocks of size 2^( 3) =       0.000404713262
  error estimate for blocks of size 2^( 4) =       0.000411933077
  error estimate for blocks of size 2^( 5) =       0.000416481227
  error estimate for blocks of size 2^( 6) =       0.000417866147
  error estimate for blocks of size 2^( 7) =       0.000419105121

      target function =                  N/A
              le_mean =     -17.216679231956
             les_mean =     296.726460776965
             stat err =       0.000416346393
             autocorr =       1.165552104574
              std dev =       0.545385965514
             le_variance =       0.297445851379


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216679231956        initial  <--
     5.9605e+50     5.9605e+51             0.0000e+00       -17.216679231956
     2.3842e+51     2.3842e+52             0.0000e+00       -17.216679231956
     9.5367e+51     9.5367e+52             0.0000e+00       -17.216679231956

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9704
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6740e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1524
    reference variance = 0.213572
====================================================
  Execution time = 2.0575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1174e-01
  Total weights = 1.957072242e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296824836288
                                         uncertainty =       0.001955451288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296824836288
                                         uncertainty =       0.001955451288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385191286
  error estimate for blocks of size 2^( 2) =       0.000395419464
  error estimate for blocks of size 2^( 3) =       0.000404502660
  error estimate for blocks of size 2^( 4) =       0.000411282708
  error estimate for blocks of size 2^( 5) =       0.000415752543
  error estimate for blocks of size 2^( 6) =       0.000416519288
  error estimate for blocks of size 2^( 7) =       0.000419473507

      target function =                  N/A
              le_mean =     -17.216539200612
             les_mean =     296.720959140720
             stat err =       0.000415757011
             autocorr =       1.165000887643
              std dev =       0.544742741022
             le_variance =       0.296744653896


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653920061e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+51, overlap shift 5.9605e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216539200668       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216539200668       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.000000000000       residual = 2.29e+02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+51 is 6.892145e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+52, overlap shift 2.3842e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216539200668       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216539200668       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+52 is 1.723036e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+52, overlap shift 9.5367e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216539200668       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216539200668       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.000000000000       residual = 2.29e+02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+52 is 4.307591e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.999378 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6556e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1556
    reference variance = 0.419915
====================================================
  Execution time = 2.0481e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1688e-01
  Total weights = 1.9564e+06
  Execution time = 1.8385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299016045596
                                         uncertainty =       0.002371864155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299016045596
                                         uncertainty =       0.002371864155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386684982
  error estimate for blocks of size 2^( 2) =       0.000396289172
  error estimate for blocks of size 2^( 3) =       0.000405510764
  error estimate for blocks of size 2^( 4) =       0.000412368698
  error estimate for blocks of size 2^( 5) =       0.000416560740
  error estimate for blocks of size 2^( 6) =       0.000419894311
  error estimate for blocks of size 2^( 7) =       0.000421997098

      target function =                  N/A
              le_mean =     -17.216223270370
             les_mean =     296.715223338187
             stat err =       0.000417705212
             autocorr =       1.166877260161
              std dev =       0.546855146381
             le_variance =       0.299050551123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299016045596
                                         uncertainty =       0.002371864155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299016045596
                                         uncertainty =       0.002371864155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386684982
  error estimate for blocks of size 2^( 2) =       0.000396289172
  error estimate for blocks of size 2^( 3) =       0.000405510764
  error estimate for blocks of size 2^( 4) =       0.000412368698
  error estimate for blocks of size 2^( 5) =       0.000416560740
  error estimate for blocks of size 2^( 6) =       0.000419894311
  error estimate for blocks of size 2^( 7) =       0.000421997098

      target function =                  N/A
              le_mean =     -17.216223270370
             les_mean =     296.715223338187
             stat err =       0.000417705212
             autocorr =       1.166877260161
              std dev =       0.546855146381
             le_variance =       0.299050551123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299016045596
                                         uncertainty =       0.002371864155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299016045596
                                         uncertainty =       0.002371864155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386684982
  error estimate for blocks of size 2^( 2) =       0.000396289172
  error estimate for blocks of size 2^( 3) =       0.000405510764
  error estimate for blocks of size 2^( 4) =       0.000412368698
  error estimate for blocks of size 2^( 5) =       0.000416560740
  error estimate for blocks of size 2^( 6) =       0.000419894311
  error estimate for blocks of size 2^( 7) =       0.000421997098

      target function =                  N/A
              le_mean =     -17.216223270370
             les_mean =     296.715223338187
             stat err =       0.000417705212
             autocorr =       1.166877260161
              std dev =       0.546855146381
             le_variance =       0.299050551123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299016045596
                                         uncertainty =       0.002371864155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299016045596
                                         uncertainty =       0.002371864155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386684982
  error estimate for blocks of size 2^( 2) =       0.000396289172
  error estimate for blocks of size 2^( 3) =       0.000405510764
  error estimate for blocks of size 2^( 4) =       0.000412368698
  error estimate for blocks of size 2^( 5) =       0.000416560740
  error estimate for blocks of size 2^( 6) =       0.000419894311
  error estimate for blocks of size 2^( 7) =       0.000421997098

      target function =                  N/A
              le_mean =     -17.216223270370
             les_mean =     296.715223338187
             stat err =       0.000417705212
             autocorr =       1.166877260161
              std dev =       0.546855146381
             le_variance =       0.299050551123


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216223270370        initial  <--
     5.9605e+51     5.9605e+52             6.8921e-56       -17.216223270370
     2.3842e+52     2.3842e+53             1.7230e-56       -17.216223270370
     9.5367e+52     9.5367e+53             4.3076e-57       -17.216223270370

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7909
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6353e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2949
    reference variance = 0.322263
====================================================
  Execution time = 2.0781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1536e-01
  Total weights = 1.956708128e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0038e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299798711132
                                         uncertainty =       0.001914873776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299798711132
                                         uncertainty =       0.001914873776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387189907
  error estimate for blocks of size 2^( 2) =       0.000397435036
  error estimate for blocks of size 2^( 3) =       0.000406851620
  error estimate for blocks of size 2^( 4) =       0.000414055195
  error estimate for blocks of size 2^( 5) =       0.000419407789
  error estimate for blocks of size 2^( 6) =       0.000421888717
  error estimate for blocks of size 2^( 7) =       0.000422258728

      target function =                  N/A
              le_mean =     -17.216699944672
             les_mean =     296.730121563644
             stat err =       0.000419402607
             autocorr =       1.173313845632
              std dev =       0.547569218142
             le_variance =       0.299832048657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669994467e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+52, overlap shift 5.9605e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216699944758       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216699944758       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+53, overlap shift 2.3842e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216699944758       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216699944758       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+53, overlap shift 9.5367e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216699944758       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216699944758       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.000575 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6795e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.1708
    reference variance = 0.320266
====================================================
  Execution time = 2.0668e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1129e-01
  Total weights = 1.9564e+06
  Execution time = 2.1207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298627488416
                                         uncertainty =       0.002193108780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298627488416
                                         uncertainty =       0.002193108780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386388342
  error estimate for blocks of size 2^( 2) =       0.000396304528
  error estimate for blocks of size 2^( 3) =       0.000405354996
  error estimate for blocks of size 2^( 4) =       0.000412460590
  error estimate for blocks of size 2^( 5) =       0.000417661229
  error estimate for blocks of size 2^( 6) =       0.000420276762
  error estimate for blocks of size 2^( 7) =       0.000421434287

      target function =                  N/A
              le_mean =     -17.217173280317
             les_mean =     296.742347208952
             stat err =       0.000417958217
             autocorr =       1.170085796873
              std dev =       0.546435633100
             le_variance =       0.298591901122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298627488416
                                         uncertainty =       0.002193108780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298627488416
                                         uncertainty =       0.002193108780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386388342
  error estimate for blocks of size 2^( 2) =       0.000396304528
  error estimate for blocks of size 2^( 3) =       0.000405354996
  error estimate for blocks of size 2^( 4) =       0.000412460590
  error estimate for blocks of size 2^( 5) =       0.000417661229
  error estimate for blocks of size 2^( 6) =       0.000420276762
  error estimate for blocks of size 2^( 7) =       0.000421434287

      target function =                  N/A
              le_mean =     -17.217173280317
             les_mean =     296.742347208952
             stat err =       0.000417958217
             autocorr =       1.170085796873
              std dev =       0.546435633100
             le_variance =       0.298591901122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298627488416
                                         uncertainty =       0.002193108780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298627488416
                                         uncertainty =       0.002193108780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386388342
  error estimate for blocks of size 2^( 2) =       0.000396304528
  error estimate for blocks of size 2^( 3) =       0.000405354996
  error estimate for blocks of size 2^( 4) =       0.000412460590
  error estimate for blocks of size 2^( 5) =       0.000417661229
  error estimate for blocks of size 2^( 6) =       0.000420276762
  error estimate for blocks of size 2^( 7) =       0.000421434287

      target function =                  N/A
              le_mean =     -17.217173280317
             les_mean =     296.742347208952
             stat err =       0.000417958217
             autocorr =       1.170085796873
              std dev =       0.546435633100
             le_variance =       0.298591901122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298627488416
                                         uncertainty =       0.002193108780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298627488416
                                         uncertainty =       0.002193108780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386388342
  error estimate for blocks of size 2^( 2) =       0.000396304528
  error estimate for blocks of size 2^( 3) =       0.000405354996
  error estimate for blocks of size 2^( 4) =       0.000412460590
  error estimate for blocks of size 2^( 5) =       0.000417661229
  error estimate for blocks of size 2^( 6) =       0.000420276762
  error estimate for blocks of size 2^( 7) =       0.000421434287

      target function =                  N/A
              le_mean =     -17.217173280317
             les_mean =     296.742347208952
             stat err =       0.000417958217
             autocorr =       1.170085796873
              std dev =       0.546435633100
             le_variance =       0.298591901122


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217173280317        initial  <--
     5.9605e+52     5.9605e+53             0.0000e+00       -17.217173280317
     2.3842e+53     2.3842e+54             0.0000e+00       -17.217173280317
     9.5367e+53     9.5367e+54             0.0000e+00       -17.217173280317

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.9122
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8713e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.1926
    reference variance = 0.239499
====================================================
  Execution time = 2.0835e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1631e-01
  Total weights = 1.956774819e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301722520527
                                         uncertainty =       0.003183207063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301722520527
                                         uncertainty =       0.003183207063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388426367
  error estimate for blocks of size 2^( 2) =       0.000398340143
  error estimate for blocks of size 2^( 3) =       0.000407249810
  error estimate for blocks of size 2^( 4) =       0.000413691585
  error estimate for blocks of size 2^( 5) =       0.000417144534
  error estimate for blocks of size 2^( 6) =       0.000418291271
  error estimate for blocks of size 2^( 7) =       0.000421743480

      target function =                  N/A
              le_mean =     -17.216385186825
             les_mean =     296.720224919078
             stat err =       0.000417717718
             autocorr =       1.156507325758
              std dev =       0.549317835736
             le_variance =       0.301750084658


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638518683e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+53, overlap shift 5.9605e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216385186855       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216385186855       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+54, overlap shift 2.3842e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216385186855       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216385186855       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+54, overlap shift 9.5367e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216385186855       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216385186855       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.001790 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6920e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2649
    reference variance = 0.309208
====================================================
  Execution time = 2.0673e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1272e-01
  Total weights = 1.9566e+06
  Execution time = 1.8438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297924157747
                                         uncertainty =       0.001836010367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297924157747
                                         uncertainty =       0.001836010367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385960180
  error estimate for blocks of size 2^( 2) =       0.000395707982
  error estimate for blocks of size 2^( 3) =       0.000404526960
  error estimate for blocks of size 2^( 4) =       0.000411449228
  error estimate for blocks of size 2^( 5) =       0.000415059002
  error estimate for blocks of size 2^( 6) =       0.000416611917
  error estimate for blocks of size 2^( 7) =       0.000419530512

      target function =                  N/A
              le_mean =     -17.215374796123
             les_mean =     296.681853070348
             stat err =       0.000415662664
             autocorr =       1.159837201210
              std dev =       0.545830120521
             le_variance =       0.297930520468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297924157747
                                         uncertainty =       0.001836010367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297924157747
                                         uncertainty =       0.001836010367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385960180
  error estimate for blocks of size 2^( 2) =       0.000395707982
  error estimate for blocks of size 2^( 3) =       0.000404526960
  error estimate for blocks of size 2^( 4) =       0.000411449228
  error estimate for blocks of size 2^( 5) =       0.000415059002
  error estimate for blocks of size 2^( 6) =       0.000416611917
  error estimate for blocks of size 2^( 7) =       0.000419530512

      target function =                  N/A
              le_mean =     -17.215374796123
             les_mean =     296.681853070348
             stat err =       0.000415662664
             autocorr =       1.159837201210
              std dev =       0.545830120521
             le_variance =       0.297930520468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297924157747
                                         uncertainty =       0.001836010367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297924157747
                                         uncertainty =       0.001836010367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385960180
  error estimate for blocks of size 2^( 2) =       0.000395707982
  error estimate for blocks of size 2^( 3) =       0.000404526960
  error estimate for blocks of size 2^( 4) =       0.000411449228
  error estimate for blocks of size 2^( 5) =       0.000415059002
  error estimate for blocks of size 2^( 6) =       0.000416611917
  error estimate for blocks of size 2^( 7) =       0.000419530512

      target function =                  N/A
              le_mean =     -17.215374796123
             les_mean =     296.681853070348
             stat err =       0.000415662664
             autocorr =       1.159837201210
              std dev =       0.545830120521
             le_variance =       0.297930520468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297924157747
                                         uncertainty =       0.001836010367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297924157747
                                         uncertainty =       0.001836010367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385960180
  error estimate for blocks of size 2^( 2) =       0.000395707982
  error estimate for blocks of size 2^( 3) =       0.000404526960
  error estimate for blocks of size 2^( 4) =       0.000411449228
  error estimate for blocks of size 2^( 5) =       0.000415059002
  error estimate for blocks of size 2^( 6) =       0.000416611917
  error estimate for blocks of size 2^( 7) =       0.000419530512

      target function =                  N/A
              le_mean =     -17.215374796123
             les_mean =     296.681853070348
             stat err =       0.000415662664
             autocorr =       1.159837201210
              std dev =       0.545830120521
             le_variance =       0.297930520468


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215374796123        initial  <--
     5.9605e+53     5.9605e+54             0.0000e+00       -17.215374796123
     2.3842e+54     2.3842e+55             0.0000e+00       -17.215374796123
     9.5367e+54     9.5367e+55             0.0000e+00       -17.215374796123

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0079
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6959e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2387
    reference variance = 0.313153
====================================================
  Execution time = 2.1041e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1920e-01
  Total weights = 1.956627901e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0328e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302237105928
                                         uncertainty =       0.002483344002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302237105928
                                         uncertainty =       0.002483344002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388678483
  error estimate for blocks of size 2^( 2) =       0.000398123011
  error estimate for blocks of size 2^( 3) =       0.000407123186
  error estimate for blocks of size 2^( 4) =       0.000413901150
  error estimate for blocks of size 2^( 5) =       0.000418303283
  error estimate for blocks of size 2^( 6) =       0.000420951612
  error estimate for blocks of size 2^( 7) =       0.000422394632

      target function =                  N/A
              le_mean =     -17.216405393104
             les_mean =     296.723814997650
             stat err =       0.000418887669
             autocorr =       1.161486468001
              std dev =       0.549674382229
             le_variance =       0.302141926479


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721640539310e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+54, overlap shift 5.9605e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216405393147       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216405393147       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+55, overlap shift 2.3842e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216405393147       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216405393147       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+55, overlap shift 9.5367e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216405393147       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216405393147       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.002976 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7084e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2103
    reference variance = 0.605694
====================================================
  Execution time = 2.0903e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0940e-01
  Total weights = 1.9568e+06
  Execution time = 1.8430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295264357376
                                         uncertainty =       0.001687238815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295264357376
                                         uncertainty =       0.001687238815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384254510
  error estimate for blocks of size 2^( 2) =       0.000394226927
  error estimate for blocks of size 2^( 3) =       0.000402991764
  error estimate for blocks of size 2^( 4) =       0.000409795276
  error estimate for blocks of size 2^( 5) =       0.000413270200
  error estimate for blocks of size 2^( 6) =       0.000415622788
  error estimate for blocks of size 2^( 7) =       0.000417408892

      target function =                  N/A
              le_mean =     -17.216380614911
             les_mean =     296.713161705509
             stat err =       0.000414024289
             autocorr =       1.160950473169
              std dev =       0.543417939523
             le_variance =       0.295303056995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295264357376
                                         uncertainty =       0.001687238815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295264357376
                                         uncertainty =       0.001687238815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384254510
  error estimate for blocks of size 2^( 2) =       0.000394226927
  error estimate for blocks of size 2^( 3) =       0.000402991764
  error estimate for blocks of size 2^( 4) =       0.000409795276
  error estimate for blocks of size 2^( 5) =       0.000413270200
  error estimate for blocks of size 2^( 6) =       0.000415622788
  error estimate for blocks of size 2^( 7) =       0.000417408892

      target function =                  N/A
              le_mean =     -17.216380614911
             les_mean =     296.713161705509
             stat err =       0.000414024289
             autocorr =       1.160950473169
              std dev =       0.543417939523
             le_variance =       0.295303056995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295264357376
                                         uncertainty =       0.001687238815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295264357376
                                         uncertainty =       0.001687238815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384254510
  error estimate for blocks of size 2^( 2) =       0.000394226927
  error estimate for blocks of size 2^( 3) =       0.000402991764
  error estimate for blocks of size 2^( 4) =       0.000409795276
  error estimate for blocks of size 2^( 5) =       0.000413270200
  error estimate for blocks of size 2^( 6) =       0.000415622788
  error estimate for blocks of size 2^( 7) =       0.000417408892

      target function =                  N/A
              le_mean =     -17.216380614911
             les_mean =     296.713161705509
             stat err =       0.000414024289
             autocorr =       1.160950473169
              std dev =       0.543417939523
             le_variance =       0.295303056995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295264357376
                                         uncertainty =       0.001687238815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295264357376
                                         uncertainty =       0.001687238815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384254510
  error estimate for blocks of size 2^( 2) =       0.000394226927
  error estimate for blocks of size 2^( 3) =       0.000402991764
  error estimate for blocks of size 2^( 4) =       0.000409795276
  error estimate for blocks of size 2^( 5) =       0.000413270200
  error estimate for blocks of size 2^( 6) =       0.000415622788
  error estimate for blocks of size 2^( 7) =       0.000417408892

      target function =                  N/A
              le_mean =     -17.216380614911
             les_mean =     296.713161705509
             stat err =       0.000414024289
             autocorr =       1.160950473169
              std dev =       0.543417939523
             le_variance =       0.295303056995


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216380614911        initial  <--
     5.9605e+54     5.9605e+55             0.0000e+00       -17.216380614911
     2.3842e+55     2.3842e+56             0.0000e+00       -17.216380614911
     9.5367e+55     9.5367e+56             0.0000e+00       -17.216380614911

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2352
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7325e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.1415
    reference variance = 0.264504
====================================================
  Execution time = 2.0945e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0901e-01
  Total weights = 1.956680580e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296654255216
                                         uncertainty =       0.001740152819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296654255216
                                         uncertainty =       0.001740152819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385079774
  error estimate for blocks of size 2^( 2) =       0.000395332964
  error estimate for blocks of size 2^( 3) =       0.000404651816
  error estimate for blocks of size 2^( 4) =       0.000412187418
  error estimate for blocks of size 2^( 5) =       0.000415962558
  error estimate for blocks of size 2^( 6) =       0.000416757091
  error estimate for blocks of size 2^( 7) =       0.000419358521

      target function =                  N/A
              le_mean =     -17.217071282206
             les_mean =     296.736554229104
             stat err =       0.000416066397
             autocorr =       1.167411232105
              std dev =       0.544585038894
             le_variance =       0.296572864588


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721707128221e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+55, overlap shift 5.9605e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217071282246       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217071282246       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+55 is 6.251138e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+56, overlap shift 2.3842e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217071282246       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217071282246       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+56 is 1.562785e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+56, overlap shift 9.5367e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217071282246       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217071282246       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217071282246       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+56 is 3.906961e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.004261 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6971e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.186
    reference variance = 0.313604
====================================================
  Execution time = 2.0569e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1484e-01
  Total weights = 1.9570e+06
  Execution time = 1.8347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301128376352
                                         uncertainty =       0.001971663143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301128376352
                                         uncertainty =       0.001971663143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388276830
  error estimate for blocks of size 2^( 2) =       0.000398343394
  error estimate for blocks of size 2^( 3) =       0.000407310978
  error estimate for blocks of size 2^( 4) =       0.000414033025
  error estimate for blocks of size 2^( 5) =       0.000419030403
  error estimate for blocks of size 2^( 6) =       0.000422256290
  error estimate for blocks of size 2^( 7) =       0.000423166579

      target function =                  N/A
              le_mean =     -17.216265796240
             les_mean =     296.714649455223
             stat err =       0.000419621574
             autocorr =       1.167972631138
              std dev =       0.549106359641
             le_variance =       0.301517794198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301128376352
                                         uncertainty =       0.001971663143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301128376352
                                         uncertainty =       0.001971663143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388276830
  error estimate for blocks of size 2^( 2) =       0.000398343394
  error estimate for blocks of size 2^( 3) =       0.000407310978
  error estimate for blocks of size 2^( 4) =       0.000414033025
  error estimate for blocks of size 2^( 5) =       0.000419030403
  error estimate for blocks of size 2^( 6) =       0.000422256290
  error estimate for blocks of size 2^( 7) =       0.000423166579

      target function =                  N/A
              le_mean =     -17.216265796240
             les_mean =     296.714649455223
             stat err =       0.000419621574
             autocorr =       1.167972631138
              std dev =       0.549106359641
             le_variance =       0.301517794198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301128376352
                                         uncertainty =       0.001971663143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301128376352
                                         uncertainty =       0.001971663143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388276830
  error estimate for blocks of size 2^( 2) =       0.000398343394
  error estimate for blocks of size 2^( 3) =       0.000407310978
  error estimate for blocks of size 2^( 4) =       0.000414033025
  error estimate for blocks of size 2^( 5) =       0.000419030403
  error estimate for blocks of size 2^( 6) =       0.000422256290
  error estimate for blocks of size 2^( 7) =       0.000423166579

      target function =                  N/A
              le_mean =     -17.216265796240
             les_mean =     296.714649455223
             stat err =       0.000419621574
             autocorr =       1.167972631138
              std dev =       0.549106359641
             le_variance =       0.301517794198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301128376352
                                         uncertainty =       0.001971663143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301128376352
                                         uncertainty =       0.001971663143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388276830
  error estimate for blocks of size 2^( 2) =       0.000398343394
  error estimate for blocks of size 2^( 3) =       0.000407310978
  error estimate for blocks of size 2^( 4) =       0.000414033025
  error estimate for blocks of size 2^( 5) =       0.000419030403
  error estimate for blocks of size 2^( 6) =       0.000422256290
  error estimate for blocks of size 2^( 7) =       0.000423166579

      target function =                  N/A
              le_mean =     -17.216265796240
             les_mean =     296.714649455223
             stat err =       0.000419621574
             autocorr =       1.167972631138
              std dev =       0.549106359641
             le_variance =       0.301517794198


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216265796240        initial  <--
     5.9605e+55     5.9605e+56             6.2511e-60       -17.216265796240
     2.3842e+56     2.3842e+57             1.5628e-60       -17.216265796240
     9.5367e+56     9.5367e+57             3.9070e-61       -17.216265796240

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8543
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6831e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2474
    reference variance = 0.187316
====================================================
  Execution time = 2.0690e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1392e-01
  Total weights = 1.956557774e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299723575250
                                         uncertainty =       0.001754177529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299723575250
                                         uncertainty =       0.001754177529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387127781
  error estimate for blocks of size 2^( 2) =       0.000397365805
  error estimate for blocks of size 2^( 3) =       0.000406554333
  error estimate for blocks of size 2^( 4) =       0.000413200853
  error estimate for blocks of size 2^( 5) =       0.000417938818
  error estimate for blocks of size 2^( 6) =       0.000420886552
  error estimate for blocks of size 2^( 7) =       0.000423614885

      target function =                  N/A
              le_mean =     -17.216147029007
             les_mean =     296.709634658490
             stat err =       0.000418910277
             autocorr =       1.170936526977
              std dev =       0.547481357865
             le_variance =       0.299735837210


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721614702901e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+56, overlap shift 5.9605e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216147029005       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216147029005       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+57, overlap shift 2.3842e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216147029005       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216147029005       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+57, overlap shift 9.5367e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216147029005       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216147029005       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.005405 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7038e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.1494
    reference variance = 0.236839
====================================================
  Execution time = 2.0594e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1370e-01
  Total weights = 1.9567e+06
  Execution time = 1.8421e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298953625423
                                         uncertainty =       0.002805012378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298953625423
                                         uncertainty =       0.002805012378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386609996
  error estimate for blocks of size 2^( 2) =       0.000396408062
  error estimate for blocks of size 2^( 3) =       0.000405937895
  error estimate for blocks of size 2^( 4) =       0.000412974013
  error estimate for blocks of size 2^( 5) =       0.000418108702
  error estimate for blocks of size 2^( 6) =       0.000420373294
  error estimate for blocks of size 2^( 7) =       0.000421588929

      target function =                  N/A
              le_mean =     -17.216545476230
             les_mean =     296.723140836078
             stat err =       0.000418261234
             autocorr =       1.170439775709
              std dev =       0.546749099551
             le_variance =       0.298934577860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298953625423
                                         uncertainty =       0.002805012378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298953625423
                                         uncertainty =       0.002805012378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386609996
  error estimate for blocks of size 2^( 2) =       0.000396408062
  error estimate for blocks of size 2^( 3) =       0.000405937895
  error estimate for blocks of size 2^( 4) =       0.000412974013
  error estimate for blocks of size 2^( 5) =       0.000418108702
  error estimate for blocks of size 2^( 6) =       0.000420373294
  error estimate for blocks of size 2^( 7) =       0.000421588929

      target function =                  N/A
              le_mean =     -17.216545476230
             les_mean =     296.723140836078
             stat err =       0.000418261234
             autocorr =       1.170439775709
              std dev =       0.546749099551
             le_variance =       0.298934577860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298953625423
                                         uncertainty =       0.002805012378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298953625423
                                         uncertainty =       0.002805012378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386609996
  error estimate for blocks of size 2^( 2) =       0.000396408062
  error estimate for blocks of size 2^( 3) =       0.000405937895
  error estimate for blocks of size 2^( 4) =       0.000412974013
  error estimate for blocks of size 2^( 5) =       0.000418108702
  error estimate for blocks of size 2^( 6) =       0.000420373294
  error estimate for blocks of size 2^( 7) =       0.000421588929

      target function =                  N/A
              le_mean =     -17.216545476230
             les_mean =     296.723140836078
             stat err =       0.000418261234
             autocorr =       1.170439775709
              std dev =       0.546749099551
             le_variance =       0.298934577860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298953625423
                                         uncertainty =       0.002805012378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298953625423
                                         uncertainty =       0.002805012378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386609996
  error estimate for blocks of size 2^( 2) =       0.000396408062
  error estimate for blocks of size 2^( 3) =       0.000405937895
  error estimate for blocks of size 2^( 4) =       0.000412974013
  error estimate for blocks of size 2^( 5) =       0.000418108702
  error estimate for blocks of size 2^( 6) =       0.000420373294
  error estimate for blocks of size 2^( 7) =       0.000421588929

      target function =                  N/A
              le_mean =     -17.216545476230
             les_mean =     296.723140836078
             stat err =       0.000418261234
             autocorr =       1.170439775709
              std dev =       0.546749099551
             le_variance =       0.298934577860


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216545476230        initial  <--
     5.9605e+56     5.9605e+57             0.0000e+00       -17.216545476230
     2.3842e+57     2.3842e+58             0.0000e+00       -17.216545476230
     9.5367e+57     9.5367e+58             0.0000e+00       -17.216545476230

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9192
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6963e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2182
    reference variance = 0.343942
====================================================
  Execution time = 2.0668e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1423e-01
  Total weights = 1.956812424e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301719487430
                                         uncertainty =       0.002200699647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301719487430
                                         uncertainty =       0.002200699647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388418816
  error estimate for blocks of size 2^( 2) =       0.000398065788
  error estimate for blocks of size 2^( 3) =       0.000406864486
  error estimate for blocks of size 2^( 4) =       0.000413225875
  error estimate for blocks of size 2^( 5) =       0.000417333259
  error estimate for blocks of size 2^( 6) =       0.000420482690
  error estimate for blocks of size 2^( 7) =       0.000421744825

      target function =                  N/A
              le_mean =     -17.216751116863
             les_mean =     296.730753053900
             stat err =       0.000418196662
             autocorr =       1.159205959246
              std dev =       0.549307156985
             le_variance =       0.301738352715


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675111686e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+57, overlap shift 5.9605e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216751116891       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216751116891       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+58, overlap shift 2.3842e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216751116891       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216751116891       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+58, overlap shift 9.5367e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216751116891       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216751116891       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.006616 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6794e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2134
    reference variance = 0.220621
====================================================
  Execution time = 2.0732e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1392e-01
  Total weights = 1.9566e+06
  Execution time = 1.8388e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487205596
                                         uncertainty =       0.001660499460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487205596
                                         uncertainty =       0.001660499460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385766254
  error estimate for blocks of size 2^( 2) =       0.000396102971
  error estimate for blocks of size 2^( 3) =       0.000405112191
  error estimate for blocks of size 2^( 4) =       0.000411817418
  error estimate for blocks of size 2^( 5) =       0.000415929542
  error estimate for blocks of size 2^( 6) =       0.000418307235
  error estimate for blocks of size 2^( 7) =       0.000419953369

      target function =                  N/A
              le_mean =     -17.216874313346
             les_mean =     296.734676638412
             stat err =       0.000416501891
             autocorr =       1.165696483422
              std dev =       0.545555868894
             le_variance =       0.297631206084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487205596
                                         uncertainty =       0.001660499460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487205596
                                         uncertainty =       0.001660499460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385766254
  error estimate for blocks of size 2^( 2) =       0.000396102971
  error estimate for blocks of size 2^( 3) =       0.000405112191
  error estimate for blocks of size 2^( 4) =       0.000411817418
  error estimate for blocks of size 2^( 5) =       0.000415929542
  error estimate for blocks of size 2^( 6) =       0.000418307235
  error estimate for blocks of size 2^( 7) =       0.000419953369

      target function =                  N/A
              le_mean =     -17.216874313346
             les_mean =     296.734676638412
             stat err =       0.000416501891
             autocorr =       1.165696483422
              std dev =       0.545555868894
             le_variance =       0.297631206084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487205596
                                         uncertainty =       0.001660499460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487205596
                                         uncertainty =       0.001660499460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385766254
  error estimate for blocks of size 2^( 2) =       0.000396102971
  error estimate for blocks of size 2^( 3) =       0.000405112191
  error estimate for blocks of size 2^( 4) =       0.000411817418
  error estimate for blocks of size 2^( 5) =       0.000415929542
  error estimate for blocks of size 2^( 6) =       0.000418307235
  error estimate for blocks of size 2^( 7) =       0.000419953369

      target function =                  N/A
              le_mean =     -17.216874313346
             les_mean =     296.734676638412
             stat err =       0.000416501891
             autocorr =       1.165696483422
              std dev =       0.545555868894
             le_variance =       0.297631206084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487205596
                                         uncertainty =       0.001660499460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487205596
                                         uncertainty =       0.001660499460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385766254
  error estimate for blocks of size 2^( 2) =       0.000396102971
  error estimate for blocks of size 2^( 3) =       0.000405112191
  error estimate for blocks of size 2^( 4) =       0.000411817418
  error estimate for blocks of size 2^( 5) =       0.000415929542
  error estimate for blocks of size 2^( 6) =       0.000418307235
  error estimate for blocks of size 2^( 7) =       0.000419953369

      target function =                  N/A
              le_mean =     -17.216874313346
             les_mean =     296.734676638412
             stat err =       0.000416501891
             autocorr =       1.165696483422
              std dev =       0.545555868894
             le_variance =       0.297631206084


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216874313346        initial  <--
     5.9605e+57     5.9605e+58             0.0000e+00       -17.216874313346
     2.3842e+58     2.3842e+59             0.0000e+00       -17.216874313346
     9.5367e+58     9.5367e+59             0.0000e+00       -17.216874313346

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0394
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6840e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2667
    reference variance = 0.243439
====================================================
  Execution time = 2.2813e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1345e-01
  Total weights = 1.956763811e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1163e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300083663352
                                         uncertainty =       0.002033448412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300083663352
                                         uncertainty =       0.002033448412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387667603
  error estimate for blocks of size 2^( 2) =       0.000397659328
  error estimate for blocks of size 2^( 3) =       0.000406625892
  error estimate for blocks of size 2^( 4) =       0.000413149894
  error estimate for blocks of size 2^( 5) =       0.000416807437
  error estimate for blocks of size 2^( 6) =       0.000418638392
  error estimate for blocks of size 2^( 7) =       0.000417892946

      target function =                  N/A
              le_mean =     -17.217039382178
             les_mean =     296.739896774405
             stat err =       0.000416622167
             autocorr =       1.154956774670
              std dev =       0.548244781262
             le_variance =       0.300572340181


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721703938218e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+58, overlap shift 5.9605e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217039382236       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217039382236       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+59, overlap shift 2.3842e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217039382236       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217039382236       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+59, overlap shift 9.5367e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217039382236       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217039382236       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.011007 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8946e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.1841
    reference variance = 0.241148
====================================================
  Execution time = 2.0726e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1214e-01
  Total weights = 1.9569e+06
  Execution time = 1.8390e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298850859878
                                         uncertainty =       0.001882434343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298850859878
                                         uncertainty =       0.001882434343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386517361
  error estimate for blocks of size 2^( 2) =       0.000396109965
  error estimate for blocks of size 2^( 3) =       0.000405006997
  error estimate for blocks of size 2^( 4) =       0.000412125141
  error estimate for blocks of size 2^( 5) =       0.000417470654
  error estimate for blocks of size 2^( 6) =       0.000419140963
  error estimate for blocks of size 2^( 7) =       0.000418994469

      target function =                  N/A
              le_mean =     -17.216299520194
             les_mean =     296.713106628229
             stat err =       0.000416932807
             autocorr =       1.163574320119
              std dev =       0.546618093807
             le_variance =       0.298791340477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298850859878
                                         uncertainty =       0.001882434343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298850859878
                                         uncertainty =       0.001882434343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386517361
  error estimate for blocks of size 2^( 2) =       0.000396109965
  error estimate for blocks of size 2^( 3) =       0.000405006997
  error estimate for blocks of size 2^( 4) =       0.000412125141
  error estimate for blocks of size 2^( 5) =       0.000417470654
  error estimate for blocks of size 2^( 6) =       0.000419140963
  error estimate for blocks of size 2^( 7) =       0.000418994469

      target function =                  N/A
              le_mean =     -17.216299520194
             les_mean =     296.713106628229
             stat err =       0.000416932807
             autocorr =       1.163574320119
              std dev =       0.546618093807
             le_variance =       0.298791340477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298850859878
                                         uncertainty =       0.001882434343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298850859878
                                         uncertainty =       0.001882434343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386517361
  error estimate for blocks of size 2^( 2) =       0.000396109965
  error estimate for blocks of size 2^( 3) =       0.000405006997
  error estimate for blocks of size 2^( 4) =       0.000412125141
  error estimate for blocks of size 2^( 5) =       0.000417470654
  error estimate for blocks of size 2^( 6) =       0.000419140963
  error estimate for blocks of size 2^( 7) =       0.000418994469

      target function =                  N/A
              le_mean =     -17.216299520194
             les_mean =     296.713106628229
             stat err =       0.000416932807
             autocorr =       1.163574320119
              std dev =       0.546618093807
             le_variance =       0.298791340477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298850859878
                                         uncertainty =       0.001882434343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298850859878
                                         uncertainty =       0.001882434343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386517361
  error estimate for blocks of size 2^( 2) =       0.000396109965
  error estimate for blocks of size 2^( 3) =       0.000405006997
  error estimate for blocks of size 2^( 4) =       0.000412125141
  error estimate for blocks of size 2^( 5) =       0.000417470654
  error estimate for blocks of size 2^( 6) =       0.000419140963
  error estimate for blocks of size 2^( 7) =       0.000418994469

      target function =                  N/A
              le_mean =     -17.216299520194
             les_mean =     296.713106628229
             stat err =       0.000416932807
             autocorr =       1.163574320119
              std dev =       0.546618093807
             le_variance =       0.298791340477


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216299520194        initial  <--
     5.9605e+58     5.9605e+59             0.0000e+00       -17.216299520194
     2.3842e+59     2.3842e+60             0.0000e+00       -17.216299520194
     9.5367e+59     9.5367e+60             0.0000e+00       -17.216299520194

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1403
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9108e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2465
    reference variance = 0.226987
====================================================
  Execution time = 2.0635e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1835e-01
  Total weights = 1.956768980e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303487132976
                                         uncertainty =       0.002678349221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303487132976
                                         uncertainty =       0.002678349221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389527174
  error estimate for blocks of size 2^( 2) =       0.000399009398
  error estimate for blocks of size 2^( 3) =       0.000407705897
  error estimate for blocks of size 2^( 4) =       0.000414523788
  error estimate for blocks of size 2^( 5) =       0.000418645746
  error estimate for blocks of size 2^( 6) =       0.000421103893
  error estimate for blocks of size 2^( 7) =       0.000423024978

      target function =                  N/A
              le_mean =     -17.216344428107
             les_mean =     296.720870398456
             stat err =       0.000419324601
             autocorr =       1.158844502424
              std dev =       0.550874612624
             le_variance =       0.303462838833


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721634442811e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+59, overlap shift 5.9605e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216344428118       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216344428118       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+60, overlap shift 2.3842e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216344428118       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216344428118       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+60, overlap shift 9.5367e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216344428118       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216344428118       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.015353 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6712e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2203
    reference variance = 0.207254
====================================================
  Execution time = 2.0657e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1535e-01
  Total weights = 1.9564e+06
  Execution time = 1.8491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299841287509
                                         uncertainty =       0.002429849519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299841287509
                                         uncertainty =       0.002429849519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387174316
  error estimate for blocks of size 2^( 2) =       0.000397310422
  error estimate for blocks of size 2^( 3) =       0.000405724622
  error estimate for blocks of size 2^( 4) =       0.000412260397
  error estimate for blocks of size 2^( 5) =       0.000416518817
  error estimate for blocks of size 2^( 6) =       0.000420517624
  error estimate for blocks of size 2^( 7) =       0.000419314436

      target function =                  N/A
              le_mean =     -17.216424606296
             les_mean =     296.720622937294
             stat err =       0.000417152818
             autocorr =       1.160853149819
              std dev =       0.547547169060
             le_variance =       0.299807902345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299841287509
                                         uncertainty =       0.002429849519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299841287509
                                         uncertainty =       0.002429849519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387174316
  error estimate for blocks of size 2^( 2) =       0.000397310422
  error estimate for blocks of size 2^( 3) =       0.000405724622
  error estimate for blocks of size 2^( 4) =       0.000412260397
  error estimate for blocks of size 2^( 5) =       0.000416518817
  error estimate for blocks of size 2^( 6) =       0.000420517624
  error estimate for blocks of size 2^( 7) =       0.000419314436

      target function =                  N/A
              le_mean =     -17.216424606296
             les_mean =     296.720622937294
             stat err =       0.000417152818
             autocorr =       1.160853149819
              std dev =       0.547547169060
             le_variance =       0.299807902345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299841287509
                                         uncertainty =       0.002429849519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299841287509
                                         uncertainty =       0.002429849519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387174316
  error estimate for blocks of size 2^( 2) =       0.000397310422
  error estimate for blocks of size 2^( 3) =       0.000405724622
  error estimate for blocks of size 2^( 4) =       0.000412260397
  error estimate for blocks of size 2^( 5) =       0.000416518817
  error estimate for blocks of size 2^( 6) =       0.000420517624
  error estimate for blocks of size 2^( 7) =       0.000419314436

      target function =                  N/A
              le_mean =     -17.216424606296
             les_mean =     296.720622937294
             stat err =       0.000417152818
             autocorr =       1.160853149819
              std dev =       0.547547169060
             le_variance =       0.299807902345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299841287509
                                         uncertainty =       0.002429849519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299841287509
                                         uncertainty =       0.002429849519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387174316
  error estimate for blocks of size 2^( 2) =       0.000397310422
  error estimate for blocks of size 2^( 3) =       0.000405724622
  error estimate for blocks of size 2^( 4) =       0.000412260397
  error estimate for blocks of size 2^( 5) =       0.000416518817
  error estimate for blocks of size 2^( 6) =       0.000420517624
  error estimate for blocks of size 2^( 7) =       0.000419314436

      target function =                  N/A
              le_mean =     -17.216424606296
             les_mean =     296.720622937294
             stat err =       0.000417152818
             autocorr =       1.160853149819
              std dev =       0.547547169060
             le_variance =       0.299807902345


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216424606296        initial  <--
     5.9605e+59     5.9605e+60             0.0000e+00       -17.216424606296
     2.3842e+60     2.3842e+61             0.0000e+00       -17.216424606296
     9.5367e+60     9.5367e+61             0.0000e+00       -17.216424606296

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0277
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6762e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.1679
    reference variance = 0.310186
====================================================
  Execution time = 2.1195e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1077e-01
  Total weights = 1.956349283e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1210e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297032939507
                                         uncertainty =       0.001865470732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297032939507
                                         uncertainty =       0.001865470732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385340974
  error estimate for blocks of size 2^( 2) =       0.000395365577
  error estimate for blocks of size 2^( 3) =       0.000404651259
  error estimate for blocks of size 2^( 4) =       0.000411159015
  error estimate for blocks of size 2^( 5) =       0.000414936052
  error estimate for blocks of size 2^( 6) =       0.000417594900
  error estimate for blocks of size 2^( 7) =       0.000418502015

      target function =                  N/A
              le_mean =     -17.215899597908
             les_mean =     296.697971107859
             stat err =       0.000415547996
             autocorr =       1.162925788912
              std dev =       0.544954431875
             le_variance =       0.296975332821


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721589959791e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+60, overlap shift 5.9605e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215899597945       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215899597945       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+61, overlap shift 2.3842e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215899597945       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215899597945       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+61, overlap shift 9.5367e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215899597945       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215899597945       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.019705 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7332e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2206
    reference variance = 0.195192
====================================================
  Execution time = 2.0535e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1750e-01
  Total weights = 1.9567e+06
  Execution time = 1.8423e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300921840250
                                         uncertainty =       0.002849790917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300921840250
                                         uncertainty =       0.002849790917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387987066
  error estimate for blocks of size 2^( 2) =       0.000397993713
  error estimate for blocks of size 2^( 3) =       0.000407079641
  error estimate for blocks of size 2^( 4) =       0.000413858924
  error estimate for blocks of size 2^( 5) =       0.000419143750
  error estimate for blocks of size 2^( 6) =       0.000420047803
  error estimate for blocks of size 2^( 7) =       0.000422986974

      target function =                  N/A
              le_mean =     -17.216662208988
             les_mean =     296.730961798475
             stat err =       0.000419009363
             autocorr =       1.166307208942
              std dev =       0.548696570104
             le_variance =       0.301067926044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300921840250
                                         uncertainty =       0.002849790917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300921840250
                                         uncertainty =       0.002849790917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387987066
  error estimate for blocks of size 2^( 2) =       0.000397993713
  error estimate for blocks of size 2^( 3) =       0.000407079641
  error estimate for blocks of size 2^( 4) =       0.000413858924
  error estimate for blocks of size 2^( 5) =       0.000419143750
  error estimate for blocks of size 2^( 6) =       0.000420047803
  error estimate for blocks of size 2^( 7) =       0.000422986974

      target function =                  N/A
              le_mean =     -17.216662208988
             les_mean =     296.730961798475
             stat err =       0.000419009363
             autocorr =       1.166307208942
              std dev =       0.548696570104
             le_variance =       0.301067926044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300921840250
                                         uncertainty =       0.002849790917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300921840250
                                         uncertainty =       0.002849790917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387987066
  error estimate for blocks of size 2^( 2) =       0.000397993713
  error estimate for blocks of size 2^( 3) =       0.000407079641
  error estimate for blocks of size 2^( 4) =       0.000413858924
  error estimate for blocks of size 2^( 5) =       0.000419143750
  error estimate for blocks of size 2^( 6) =       0.000420047803
  error estimate for blocks of size 2^( 7) =       0.000422986974

      target function =                  N/A
              le_mean =     -17.216662208988
             les_mean =     296.730961798475
             stat err =       0.000419009363
             autocorr =       1.166307208942
              std dev =       0.548696570104
             le_variance =       0.301067926044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300921840250
                                         uncertainty =       0.002849790917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300921840250
                                         uncertainty =       0.002849790917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387987066
  error estimate for blocks of size 2^( 2) =       0.000397993713
  error estimate for blocks of size 2^( 3) =       0.000407079641
  error estimate for blocks of size 2^( 4) =       0.000413858924
  error estimate for blocks of size 2^( 5) =       0.000419143750
  error estimate for blocks of size 2^( 6) =       0.000420047803
  error estimate for blocks of size 2^( 7) =       0.000422986974

      target function =                  N/A
              le_mean =     -17.216662208988
             les_mean =     296.730961798475
             stat err =       0.000419009363
             autocorr =       1.166307208942
              std dev =       0.548696570104
             le_variance =       0.301067926044


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216662208988        initial  <--
     5.9605e+60     5.9605e+61             0.0000e+00       -17.216662208988
     2.3842e+61     2.3842e+62             0.0000e+00       -17.216662208988
     9.5367e+61     9.5367e+62             0.0000e+00       -17.216662208988

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8730
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7228e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2125
    reference variance = 0.299077
====================================================
  Execution time = 2.0524e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1454e-01
  Total weights = 1.956509897e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9463e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299195551498
                                         uncertainty =       0.001805347039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299195551498
                                         uncertainty =       0.001805347039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386754826
  error estimate for blocks of size 2^( 2) =       0.000396598155
  error estimate for blocks of size 2^( 3) =       0.000405956739
  error estimate for blocks of size 2^( 4) =       0.000412616441
  error estimate for blocks of size 2^( 5) =       0.000417357200
  error estimate for blocks of size 2^( 6) =       0.000419981436
  error estimate for blocks of size 2^( 7) =       0.000420681237

      target function =                  N/A
              le_mean =     -17.216624496129
             les_mean =     296.726699865954
             stat err =       0.000417659078
             autocorr =       1.166198205157
              std dev =       0.546953920204
             le_variance =       0.299158590826


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721662449613e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+61, overlap shift 5.9605e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216624496174       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216624496174       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+61 is 4.961348e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+62, overlap shift 2.3842e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216624496174       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216624496174       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216624496174       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216624496174       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+62 is 1.382273e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+62, overlap shift 9.5367e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216624496174       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216624496174       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+62 is 3.100843e-67

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.024468 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6487e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2566
    reference variance = 0.313533
====================================================
  Execution time = 2.0654e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1468e-01
  Total weights = 1.9566e+06
  Execution time = 1.8417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298952971048
                                         uncertainty =       0.002041208285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298952971048
                                         uncertainty =       0.002041208285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386681429
  error estimate for blocks of size 2^( 2) =       0.000397213114
  error estimate for blocks of size 2^( 3) =       0.000406413185
  error estimate for blocks of size 2^( 4) =       0.000412921356
  error estimate for blocks of size 2^( 5) =       0.000417166429
  error estimate for blocks of size 2^( 6) =       0.000417630860
  error estimate for blocks of size 2^( 7) =       0.000419060822

      target function =                  N/A
              le_mean =     -17.215897299023
             les_mean =     296.701798491680
             stat err =       0.000416694867
             autocorr =       1.161260544560
              std dev =       0.546850121400
             le_variance =       0.299045055275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298952971048
                                         uncertainty =       0.002041208285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298952971048
                                         uncertainty =       0.002041208285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386681429
  error estimate for blocks of size 2^( 2) =       0.000397213114
  error estimate for blocks of size 2^( 3) =       0.000406413185
  error estimate for blocks of size 2^( 4) =       0.000412921356
  error estimate for blocks of size 2^( 5) =       0.000417166429
  error estimate for blocks of size 2^( 6) =       0.000417630860
  error estimate for blocks of size 2^( 7) =       0.000419060822

      target function =                  N/A
              le_mean =     -17.215897299023
             les_mean =     296.701798491680
             stat err =       0.000416694867
             autocorr =       1.161260544560
              std dev =       0.546850121400
             le_variance =       0.299045055275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298952971048
                                         uncertainty =       0.002041208285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298952971048
                                         uncertainty =       0.002041208285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386681429
  error estimate for blocks of size 2^( 2) =       0.000397213114
  error estimate for blocks of size 2^( 3) =       0.000406413185
  error estimate for blocks of size 2^( 4) =       0.000412921356
  error estimate for blocks of size 2^( 5) =       0.000417166429
  error estimate for blocks of size 2^( 6) =       0.000417630860
  error estimate for blocks of size 2^( 7) =       0.000419060822

      target function =                  N/A
              le_mean =     -17.215897299023
             les_mean =     296.701798491680
             stat err =       0.000416694867
             autocorr =       1.161260544560
              std dev =       0.546850121400
             le_variance =       0.299045055275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298952971048
                                         uncertainty =       0.002041208285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298952971048
                                         uncertainty =       0.002041208285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386681429
  error estimate for blocks of size 2^( 2) =       0.000397213114
  error estimate for blocks of size 2^( 3) =       0.000406413185
  error estimate for blocks of size 2^( 4) =       0.000412921356
  error estimate for blocks of size 2^( 5) =       0.000417166429
  error estimate for blocks of size 2^( 6) =       0.000417630860
  error estimate for blocks of size 2^( 7) =       0.000419060822

      target function =                  N/A
              le_mean =     -17.215897299023
             les_mean =     296.701798491680
             stat err =       0.000416694867
             autocorr =       1.161260544560
              std dev =       0.546850121400
             le_variance =       0.299045055275


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215897299023        initial  <--
     5.9605e+61     5.9605e+62             4.9613e-66       -17.215897299023
     2.3842e+62     2.3842e+63             1.3823e-66       -17.215897299023
     9.5367e+62     9.5367e+63             3.1008e-67       -17.215897299023

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9962
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6506e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.1905
    reference variance = 0.179378
====================================================
  Execution time = 2.0758e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1498e-01
  Total weights = 1.956400087e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300955571653
                                         uncertainty =       0.003112079871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300955571653
                                         uncertainty =       0.003112079871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387901271
  error estimate for blocks of size 2^( 2) =       0.000397841990
  error estimate for blocks of size 2^( 3) =       0.000406715514
  error estimate for blocks of size 2^( 4) =       0.000413102941
  error estimate for blocks of size 2^( 5) =       0.000417186511
  error estimate for blocks of size 2^( 6) =       0.000418726338
  error estimate for blocks of size 2^( 7) =       0.000417906102

      target function =                  N/A
              le_mean =     -17.216604798776
             les_mean =     296.726460095818
             stat err =       0.000416730473
             autocorr =       1.154165564822
              std dev =       0.548575237910
             le_variance =       0.300934791648


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660479878e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+62, overlap shift 5.9605e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216604798813       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216604798813       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216604798813       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+62 is 6.659077e-67

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+63, overlap shift 2.3842e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216604798813       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216604798813       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216604798813       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+63 is 1.664769e-67

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+63, overlap shift 9.5367e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216604798813       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216604798813       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216604798813       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+63 is 4.248336e-68

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.025941 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6790e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2126
    reference variance = 0.215703
====================================================
  Execution time = 2.0490e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1242e-01
  Total weights = 1.9569e+06
  Execution time = 1.8418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299157200635
                                         uncertainty =       0.002103653539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299157200635
                                         uncertainty =       0.002103653539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386765991
  error estimate for blocks of size 2^( 2) =       0.000396829423
  error estimate for blocks of size 2^( 3) =       0.000405503167
  error estimate for blocks of size 2^( 4) =       0.000412112783
  error estimate for blocks of size 2^( 5) =       0.000416759026
  error estimate for blocks of size 2^( 6) =       0.000419960926
  error estimate for blocks of size 2^( 7) =       0.000423110392

      target function =                  N/A
              le_mean =     -17.216993929160
             les_mean =     296.737304268267
             stat err =       0.000417985782
             autocorr =       1.167955942067
              std dev =       0.546969709758
             le_variance =       0.299175863393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299157200635
                                         uncertainty =       0.002103653539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299157200635
                                         uncertainty =       0.002103653539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386765991
  error estimate for blocks of size 2^( 2) =       0.000396829423
  error estimate for blocks of size 2^( 3) =       0.000405503167
  error estimate for blocks of size 2^( 4) =       0.000412112783
  error estimate for blocks of size 2^( 5) =       0.000416759026
  error estimate for blocks of size 2^( 6) =       0.000419960926
  error estimate for blocks of size 2^( 7) =       0.000423110392

      target function =                  N/A
              le_mean =     -17.216993929160
             les_mean =     296.737304268267
             stat err =       0.000417985782
             autocorr =       1.167955942067
              std dev =       0.546969709758
             le_variance =       0.299175863393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299157200635
                                         uncertainty =       0.002103653539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299157200635
                                         uncertainty =       0.002103653539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386765991
  error estimate for blocks of size 2^( 2) =       0.000396829423
  error estimate for blocks of size 2^( 3) =       0.000405503167
  error estimate for blocks of size 2^( 4) =       0.000412112783
  error estimate for blocks of size 2^( 5) =       0.000416759026
  error estimate for blocks of size 2^( 6) =       0.000419960926
  error estimate for blocks of size 2^( 7) =       0.000423110392

      target function =                  N/A
              le_mean =     -17.216993929160
             les_mean =     296.737304268267
             stat err =       0.000417985782
             autocorr =       1.167955942067
              std dev =       0.546969709758
             le_variance =       0.299175863393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299157200635
                                         uncertainty =       0.002103653539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299157200635
                                         uncertainty =       0.002103653539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386765991
  error estimate for blocks of size 2^( 2) =       0.000396829423
  error estimate for blocks of size 2^( 3) =       0.000405503167
  error estimate for blocks of size 2^( 4) =       0.000412112783
  error estimate for blocks of size 2^( 5) =       0.000416759026
  error estimate for blocks of size 2^( 6) =       0.000419960926
  error estimate for blocks of size 2^( 7) =       0.000423110392

      target function =                  N/A
              le_mean =     -17.216993929160
             les_mean =     296.737304268267
             stat err =       0.000417985782
             autocorr =       1.167955942067
              std dev =       0.546969709758
             le_variance =       0.299175863393


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216993929160        initial  <--
     5.9605e+62     5.9605e+63             6.6591e-67       -17.216993929160
     2.3842e+63     2.3842e+64             1.6648e-67       -17.216993929160
     9.5367e+63     9.5367e+64             4.2483e-68       -17.216993929160

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8291
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6626e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2436
    reference variance = 0.193747
====================================================
  Execution time = 2.2094e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1038e-01
  Total weights = 1.956645687e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295984258720
                                         uncertainty =       0.001899355763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295984258720
                                         uncertainty =       0.001899355763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384752853
  error estimate for blocks of size 2^( 2) =       0.000395216051
  error estimate for blocks of size 2^( 3) =       0.000404677319
  error estimate for blocks of size 2^( 4) =       0.000411468391
  error estimate for blocks of size 2^( 5) =       0.000414925724
  error estimate for blocks of size 2^( 6) =       0.000416375497
  error estimate for blocks of size 2^( 7) =       0.000417134498

      target function =                  N/A
              le_mean =     -17.215538536897
             les_mean =     296.685150783081
             stat err =       0.000414976027
             autocorr =       1.163274797252
              std dev =       0.544122703498
             le_variance =       0.296069516462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721553853690e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+63, overlap shift 5.9605e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215538536922       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215538536922       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+64, overlap shift 2.3842e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215538536922       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215538536922       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+64, overlap shift 9.5367e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215538536922       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215538536922       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.027141 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8170e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2074
    reference variance = 0.249778
====================================================
  Execution time = 2.0653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1283e-01
  Total weights = 1.9567e+06
  Execution time = 1.8352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299040445427
                                         uncertainty =       0.002098254229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299040445427
                                         uncertainty =       0.002098254229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386658791
  error estimate for blocks of size 2^( 2) =       0.000397281467
  error estimate for blocks of size 2^( 3) =       0.000406193131
  error estimate for blocks of size 2^( 4) =       0.000413747191
  error estimate for blocks of size 2^( 5) =       0.000417767140
  error estimate for blocks of size 2^( 6) =       0.000420122149
  error estimate for blocks of size 2^( 7) =       0.000421984352

      target function =                  N/A
              le_mean =     -17.216950878692
             les_mean =     296.736231408710
             stat err =       0.000418405208
             autocorr =       1.170950095037
              std dev =       0.546818105933
             le_variance =       0.299010040976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299040445427
                                         uncertainty =       0.002098254229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299040445427
                                         uncertainty =       0.002098254229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386658791
  error estimate for blocks of size 2^( 2) =       0.000397281467
  error estimate for blocks of size 2^( 3) =       0.000406193131
  error estimate for blocks of size 2^( 4) =       0.000413747191
  error estimate for blocks of size 2^( 5) =       0.000417767140
  error estimate for blocks of size 2^( 6) =       0.000420122149
  error estimate for blocks of size 2^( 7) =       0.000421984352

      target function =                  N/A
              le_mean =     -17.216950878692
             les_mean =     296.736231408710
             stat err =       0.000418405208
             autocorr =       1.170950095037
              std dev =       0.546818105933
             le_variance =       0.299010040976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299040445427
                                         uncertainty =       0.002098254229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299040445427
                                         uncertainty =       0.002098254229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386658791
  error estimate for blocks of size 2^( 2) =       0.000397281467
  error estimate for blocks of size 2^( 3) =       0.000406193131
  error estimate for blocks of size 2^( 4) =       0.000413747191
  error estimate for blocks of size 2^( 5) =       0.000417767140
  error estimate for blocks of size 2^( 6) =       0.000420122149
  error estimate for blocks of size 2^( 7) =       0.000421984352

      target function =                  N/A
              le_mean =     -17.216950878692
             les_mean =     296.736231408710
             stat err =       0.000418405208
             autocorr =       1.170950095037
              std dev =       0.546818105933
             le_variance =       0.299010040976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299040445427
                                         uncertainty =       0.002098254229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299040445427
                                         uncertainty =       0.002098254229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386658791
  error estimate for blocks of size 2^( 2) =       0.000397281467
  error estimate for blocks of size 2^( 3) =       0.000406193131
  error estimate for blocks of size 2^( 4) =       0.000413747191
  error estimate for blocks of size 2^( 5) =       0.000417767140
  error estimate for blocks of size 2^( 6) =       0.000420122149
  error estimate for blocks of size 2^( 7) =       0.000421984352

      target function =                  N/A
              le_mean =     -17.216950878692
             les_mean =     296.736231408710
             stat err =       0.000418405208
             autocorr =       1.170950095037
              std dev =       0.546818105933
             le_variance =       0.299010040976


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216950878692        initial  <--
     5.9605e+63     5.9605e+64             0.0000e+00       -17.216950878692
     2.3842e+64     2.3842e+65             0.0000e+00       -17.216950878692
     9.5367e+64     9.5367e+65             0.0000e+00       -17.216950878692

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9406
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8116e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.1627
    reference variance = 0.14037
====================================================
  Execution time = 2.0915e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5314e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1781e-01
  Total weights = 1.956607434e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301712293647
                                         uncertainty =       0.002521329172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301712293647
                                         uncertainty =       0.002521329172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388464876
  error estimate for blocks of size 2^( 2) =       0.000398682840
  error estimate for blocks of size 2^( 3) =       0.000407722309
  error estimate for blocks of size 2^( 4) =       0.000414940653
  error estimate for blocks of size 2^( 5) =       0.000419531795
  error estimate for blocks of size 2^( 6) =       0.000421225228
  error estimate for blocks of size 2^( 7) =       0.000422565530

      target function =                  N/A
              le_mean =     -17.216817026672
             les_mean =     296.736599270034
             stat err =       0.000419565802
             autocorr =       1.166531984187
              std dev =       0.549372295482
             le_variance =       0.301809919043


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721681702667e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+64, overlap shift 5.9605e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216817026682       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216817026682       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216817026682       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216817026682       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+64 is 5.348585e-69

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+65, overlap shift 2.3842e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216817026682       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216817026682       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+65 is 1.225696e-69

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+65, overlap shift 9.5367e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216817026682       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216817026682       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216817026682       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+65 is 3.342865e-70

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.028587 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6921e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2613
    reference variance = 0.163689
====================================================
  Execution time = 2.0594e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1098e-01
  Total weights = 1.9568e+06
  Execution time = 1.8312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296897306714
                                         uncertainty =       0.001695744765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296897306714
                                         uncertainty =       0.001695744765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385320589
  error estimate for blocks of size 2^( 2) =       0.000395431340
  error estimate for blocks of size 2^( 3) =       0.000404406936
  error estimate for blocks of size 2^( 4) =       0.000411013547
  error estimate for blocks of size 2^( 5) =       0.000414861901
  error estimate for blocks of size 2^( 6) =       0.000418300687
  error estimate for blocks of size 2^( 7) =       0.000417525075

      target function =                  N/A
              le_mean =     -17.216499303502
             les_mean =     296.718824598133
             stat err =       0.000415425302
             autocorr =       1.162362145822
              std dev =       0.544925602887
             le_variance =       0.296943912682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296897306714
                                         uncertainty =       0.001695744765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296897306714
                                         uncertainty =       0.001695744765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385320589
  error estimate for blocks of size 2^( 2) =       0.000395431340
  error estimate for blocks of size 2^( 3) =       0.000404406936
  error estimate for blocks of size 2^( 4) =       0.000411013547
  error estimate for blocks of size 2^( 5) =       0.000414861901
  error estimate for blocks of size 2^( 6) =       0.000418300687
  error estimate for blocks of size 2^( 7) =       0.000417525075

      target function =                  N/A
              le_mean =     -17.216499303502
             les_mean =     296.718824598133
             stat err =       0.000415425302
             autocorr =       1.162362145822
              std dev =       0.544925602887
             le_variance =       0.296943912682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296897306714
                                         uncertainty =       0.001695744765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296897306714
                                         uncertainty =       0.001695744765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385320589
  error estimate for blocks of size 2^( 2) =       0.000395431340
  error estimate for blocks of size 2^( 3) =       0.000404406936
  error estimate for blocks of size 2^( 4) =       0.000411013547
  error estimate for blocks of size 2^( 5) =       0.000414861901
  error estimate for blocks of size 2^( 6) =       0.000418300687
  error estimate for blocks of size 2^( 7) =       0.000417525075

      target function =                  N/A
              le_mean =     -17.216499303502
             les_mean =     296.718824598133
             stat err =       0.000415425302
             autocorr =       1.162362145822
              std dev =       0.544925602887
             le_variance =       0.296943912682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296897306714
                                         uncertainty =       0.001695744765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296897306714
                                         uncertainty =       0.001695744765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385320589
  error estimate for blocks of size 2^( 2) =       0.000395431340
  error estimate for blocks of size 2^( 3) =       0.000404406936
  error estimate for blocks of size 2^( 4) =       0.000411013547
  error estimate for blocks of size 2^( 5) =       0.000414861901
  error estimate for blocks of size 2^( 6) =       0.000418300687
  error estimate for blocks of size 2^( 7) =       0.000417525075

      target function =                  N/A
              le_mean =     -17.216499303502
             les_mean =     296.718824598133
             stat err =       0.000415425302
             autocorr =       1.162362145822
              std dev =       0.544925602887
             le_variance =       0.296943912682


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216499303502        initial  <--
     5.9605e+64     5.9605e+65             5.3486e-69       -17.216499303502
     2.3842e+65     2.3842e+66             1.2257e-69       -17.216499303502
     9.5367e+65     9.5367e+66             3.3429e-70       -17.216499303502

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8607
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6787e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.196
    reference variance = 0.188484
====================================================
  Execution time = 2.0764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5316e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1809e-01
  Total weights = 1.956745144e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300569041633
                                         uncertainty =       0.003512433992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300569041633
                                         uncertainty =       0.003512433992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387632512
  error estimate for blocks of size 2^( 2) =       0.000397732799
  error estimate for blocks of size 2^( 3) =       0.000406504542
  error estimate for blocks of size 2^( 4) =       0.000413088031
  error estimate for blocks of size 2^( 5) =       0.000416901470
  error estimate for blocks of size 2^( 6) =       0.000419725378
  error estimate for blocks of size 2^( 7) =       0.000422325358

      target function =                  N/A
              le_mean =     -17.216556782937
             les_mean =     296.727921422889
             stat err =       0.000418010059
             autocorr =       1.162875110439
              std dev =       0.548195155443
             le_variance =       0.300517928451


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655678294e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+65, overlap shift 5.9605e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216556782963       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216556782963       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+66, overlap shift 2.3842e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216556782963       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216556782963       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+66, overlap shift 9.5367e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216556782963       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216556782963       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.029744 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6799e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.1364
    reference variance = 0.273183
====================================================
  Execution time = 2.0542e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1347e-01
  Total weights = 1.9563e+06
  Execution time = 1.8396e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302121005516
                                         uncertainty =       0.002012949489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302121005516
                                         uncertainty =       0.002012949489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388653318
  error estimate for blocks of size 2^( 2) =       0.000398984943
  error estimate for blocks of size 2^( 3) =       0.000408137997
  error estimate for blocks of size 2^( 4) =       0.000414889170
  error estimate for blocks of size 2^( 5) =       0.000419812791
  error estimate for blocks of size 2^( 6) =       0.000422443261
  error estimate for blocks of size 2^( 7) =       0.000423466097

      target function =                  N/A
              le_mean =     -17.216149582526
             les_mean =     296.709281207486
             stat err =       0.000420152830
             autocorr =       1.168664429857
              std dev =       0.549638793906
             le_variance =       0.302102803767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302121005516
                                         uncertainty =       0.002012949489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302121005516
                                         uncertainty =       0.002012949489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388653318
  error estimate for blocks of size 2^( 2) =       0.000398984943
  error estimate for blocks of size 2^( 3) =       0.000408137997
  error estimate for blocks of size 2^( 4) =       0.000414889170
  error estimate for blocks of size 2^( 5) =       0.000419812791
  error estimate for blocks of size 2^( 6) =       0.000422443261
  error estimate for blocks of size 2^( 7) =       0.000423466097

      target function =                  N/A
              le_mean =     -17.216149582526
             les_mean =     296.709281207486
             stat err =       0.000420152830
             autocorr =       1.168664429857
              std dev =       0.549638793906
             le_variance =       0.302102803767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302121005516
                                         uncertainty =       0.002012949489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302121005516
                                         uncertainty =       0.002012949489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388653318
  error estimate for blocks of size 2^( 2) =       0.000398984943
  error estimate for blocks of size 2^( 3) =       0.000408137997
  error estimate for blocks of size 2^( 4) =       0.000414889170
  error estimate for blocks of size 2^( 5) =       0.000419812791
  error estimate for blocks of size 2^( 6) =       0.000422443261
  error estimate for blocks of size 2^( 7) =       0.000423466097

      target function =                  N/A
              le_mean =     -17.216149582526
             les_mean =     296.709281207486
             stat err =       0.000420152830
             autocorr =       1.168664429857
              std dev =       0.549638793906
             le_variance =       0.302102803767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302121005516
                                         uncertainty =       0.002012949489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302121005516
                                         uncertainty =       0.002012949489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388653318
  error estimate for blocks of size 2^( 2) =       0.000398984943
  error estimate for blocks of size 2^( 3) =       0.000408137997
  error estimate for blocks of size 2^( 4) =       0.000414889170
  error estimate for blocks of size 2^( 5) =       0.000419812791
  error estimate for blocks of size 2^( 6) =       0.000422443261
  error estimate for blocks of size 2^( 7) =       0.000423466097

      target function =                  N/A
              le_mean =     -17.216149582526
             les_mean =     296.709281207486
             stat err =       0.000420152830
             autocorr =       1.168664429857
              std dev =       0.549638793906
             le_variance =       0.302102803767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216149582526        initial  <--
     5.9605e+65     5.9605e+66             0.0000e+00       -17.216149582526
     2.3842e+66     2.3842e+67             0.0000e+00       -17.216149582526
     9.5367e+66     9.5367e+67             0.0000e+00       -17.216149582526

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8501
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6655e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2502
    reference variance = 0.229654
====================================================
  Execution time = 2.0814e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1434e-01
  Total weights = 1.956599437e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299726753984
                                         uncertainty =       0.003156645378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299726753984
                                         uncertainty =       0.003156645378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387090235
  error estimate for blocks of size 2^( 2) =       0.000397267617
  error estimate for blocks of size 2^( 3) =       0.000406291140
  error estimate for blocks of size 2^( 4) =       0.000413185799
  error estimate for blocks of size 2^( 5) =       0.000416751389
  error estimate for blocks of size 2^( 6) =       0.000418789207
  error estimate for blocks of size 2^( 7) =       0.000420952842

      target function =                  N/A
              le_mean =     -17.215928419227
             les_mean =     296.702535635657
             stat err =       0.000417419809
             autocorr =       1.162844595388
              std dev =       0.547428260695
             le_variance =       0.299677700607


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721592841923e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+66, overlap shift 5.9605e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215928419285       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215928419285       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+66 is 6.311947e-71

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+67, overlap shift 2.3842e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215928419285       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215928419285       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+67, overlap shift 9.5367e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215928419285       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215928419285       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215928419285       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+67 is 4.308732e-72

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.031007 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6850e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.209
    reference variance = 0.220884
====================================================
  Execution time = 2.0957e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2103e-01
  Total weights = 1.9564e+06
  Execution time = 1.8363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304223714144
                                         uncertainty =       0.004450074205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304223714144
                                         uncertainty =       0.004450074205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389981716
  error estimate for blocks of size 2^( 2) =       0.000400357903
  error estimate for blocks of size 2^( 3) =       0.000409990142
  error estimate for blocks of size 2^( 4) =       0.000416960785
  error estimate for blocks of size 2^( 5) =       0.000421076092
  error estimate for blocks of size 2^( 6) =       0.000422727903
  error estimate for blocks of size 2^( 7) =       0.000424753478

      target function =                  N/A
              le_mean =     -17.216272816667
             les_mean =     296.721084044282
             stat err =       0.000421379564
             autocorr =       1.167504188603
              std dev =       0.551517432180
             le_variance =       0.304171477998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304223714144
                                         uncertainty =       0.004450074205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304223714144
                                         uncertainty =       0.004450074205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389981716
  error estimate for blocks of size 2^( 2) =       0.000400357903
  error estimate for blocks of size 2^( 3) =       0.000409990142
  error estimate for blocks of size 2^( 4) =       0.000416960785
  error estimate for blocks of size 2^( 5) =       0.000421076092
  error estimate for blocks of size 2^( 6) =       0.000422727903
  error estimate for blocks of size 2^( 7) =       0.000424753478

      target function =                  N/A
              le_mean =     -17.216272816667
             les_mean =     296.721084044282
             stat err =       0.000421379564
             autocorr =       1.167504188603
              std dev =       0.551517432180
             le_variance =       0.304171477998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304223714144
                                         uncertainty =       0.004450074205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304223714144
                                         uncertainty =       0.004450074205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389981716
  error estimate for blocks of size 2^( 2) =       0.000400357903
  error estimate for blocks of size 2^( 3) =       0.000409990142
  error estimate for blocks of size 2^( 4) =       0.000416960785
  error estimate for blocks of size 2^( 5) =       0.000421076092
  error estimate for blocks of size 2^( 6) =       0.000422727903
  error estimate for blocks of size 2^( 7) =       0.000424753478

      target function =                  N/A
              le_mean =     -17.216272816667
             les_mean =     296.721084044282
             stat err =       0.000421379564
             autocorr =       1.167504188603
              std dev =       0.551517432180
             le_variance =       0.304171477998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304223714144
                                         uncertainty =       0.004450074205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304223714144
                                         uncertainty =       0.004450074205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389981716
  error estimate for blocks of size 2^( 2) =       0.000400357903
  error estimate for blocks of size 2^( 3) =       0.000409990142
  error estimate for blocks of size 2^( 4) =       0.000416960785
  error estimate for blocks of size 2^( 5) =       0.000421076092
  error estimate for blocks of size 2^( 6) =       0.000422727903
  error estimate for blocks of size 2^( 7) =       0.000424753478

      target function =                  N/A
              le_mean =     -17.216272816667
             les_mean =     296.721084044282
             stat err =       0.000421379564
             autocorr =       1.167504188603
              std dev =       0.551517432180
             le_variance =       0.304171477998


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216272816667        initial  <--
     5.9605e+66     5.9605e+67             6.3119e-71       -17.216272816667
     2.3842e+67     2.3842e+68             0.0000e+00       -17.216272816667
     9.5367e+67     9.5367e+68             4.3087e-72       -17.216272816667

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2475
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7103e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.3021
    reference variance = 0.330679
====================================================
  Execution time = 2.0882e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1363e-01
  Total weights = 1.956684797e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0581e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298810104132
                                         uncertainty =       0.001960934622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298810104132
                                         uncertainty =       0.001960934622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386497851
  error estimate for blocks of size 2^( 2) =       0.000396440308
  error estimate for blocks of size 2^( 3) =       0.000404923631
  error estimate for blocks of size 2^( 4) =       0.000412030929
  error estimate for blocks of size 2^( 5) =       0.000417132299
  error estimate for blocks of size 2^( 6) =       0.000419597854
  error estimate for blocks of size 2^( 7) =       0.000420940139

      target function =                  N/A
              le_mean =     -17.216143103273
             les_mean =     296.709213306707
             stat err =       0.000417425305
             autocorr =       1.166442617756
              std dev =       0.546590503167
             le_variance =       0.298761178152


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721614310327e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+67, overlap shift 5.9605e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216143103291       residual = 9.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216143103291       residual = 9.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+68, overlap shift 2.3842e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216143103291       residual = 9.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216143103291       residual = 9.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+68, overlap shift 9.5367e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216143103291       residual = 9.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216143103291       residual = 9.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.032212 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6950e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2706
    reference variance = 0.277973
====================================================
  Execution time = 2.0567e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1320e-01
  Total weights = 1.9567e+06
  Execution time = 1.8443e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297923694348
                                         uncertainty =       0.002032934830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297923694348
                                         uncertainty =       0.002032934830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385958738
  error estimate for blocks of size 2^( 2) =       0.000395832696
  error estimate for blocks of size 2^( 3) =       0.000404638055
  error estimate for blocks of size 2^( 4) =       0.000411413349
  error estimate for blocks of size 2^( 5) =       0.000415525926
  error estimate for blocks of size 2^( 6) =       0.000417086718
  error estimate for blocks of size 2^( 7) =       0.000417911332

      target function =                  N/A
              le_mean =     -17.216113895129
             les_mean =     296.707777972797
             stat err =       0.000415484331
             autocorr =       1.158850852642
              std dev =       0.545828082237
             le_variance =       0.297928295359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297923694348
                                         uncertainty =       0.002032934830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297923694348
                                         uncertainty =       0.002032934830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385958738
  error estimate for blocks of size 2^( 2) =       0.000395832696
  error estimate for blocks of size 2^( 3) =       0.000404638055
  error estimate for blocks of size 2^( 4) =       0.000411413349
  error estimate for blocks of size 2^( 5) =       0.000415525926
  error estimate for blocks of size 2^( 6) =       0.000417086718
  error estimate for blocks of size 2^( 7) =       0.000417911332

      target function =                  N/A
              le_mean =     -17.216113895129
             les_mean =     296.707777972797
             stat err =       0.000415484331
             autocorr =       1.158850852642
              std dev =       0.545828082237
             le_variance =       0.297928295359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297923694348
                                         uncertainty =       0.002032934830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297923694348
                                         uncertainty =       0.002032934830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385958738
  error estimate for blocks of size 2^( 2) =       0.000395832696
  error estimate for blocks of size 2^( 3) =       0.000404638055
  error estimate for blocks of size 2^( 4) =       0.000411413349
  error estimate for blocks of size 2^( 5) =       0.000415525926
  error estimate for blocks of size 2^( 6) =       0.000417086718
  error estimate for blocks of size 2^( 7) =       0.000417911332

      target function =                  N/A
              le_mean =     -17.216113895129
             les_mean =     296.707777972797
             stat err =       0.000415484331
             autocorr =       1.158850852642
              std dev =       0.545828082237
             le_variance =       0.297928295359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297923694348
                                         uncertainty =       0.002032934830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297923694348
                                         uncertainty =       0.002032934830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385958738
  error estimate for blocks of size 2^( 2) =       0.000395832696
  error estimate for blocks of size 2^( 3) =       0.000404638055
  error estimate for blocks of size 2^( 4) =       0.000411413349
  error estimate for blocks of size 2^( 5) =       0.000415525926
  error estimate for blocks of size 2^( 6) =       0.000417086718
  error estimate for blocks of size 2^( 7) =       0.000417911332

      target function =                  N/A
              le_mean =     -17.216113895129
             les_mean =     296.707777972797
             stat err =       0.000415484331
             autocorr =       1.158850852642
              std dev =       0.545828082237
             le_variance =       0.297928295359


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216113895129        initial  <--
     5.9605e+67     5.9605e+68             0.0000e+00       -17.216113895129
     2.3842e+68     2.3842e+69             0.0000e+00       -17.216113895129
     9.5367e+68     9.5367e+69             0.0000e+00       -17.216113895129

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9067
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6863e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2403
    reference variance = 0.203675
====================================================
  Execution time = 2.0969e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1072e-01
  Total weights = 1.956723910e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296697412153
                                         uncertainty =       0.002271736062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296697412153
                                         uncertainty =       0.002271736062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385126340
  error estimate for blocks of size 2^( 2) =       0.000395259008
  error estimate for blocks of size 2^( 3) =       0.000404045449
  error estimate for blocks of size 2^( 4) =       0.000411381888
  error estimate for blocks of size 2^( 5) =       0.000416316923
  error estimate for blocks of size 2^( 6) =       0.000418302836
  error estimate for blocks of size 2^( 7) =       0.000418305797

      target function =                  N/A
              le_mean =     -17.215923145333
             les_mean =     296.698730048861
             stat err =       0.000416076861
             autocorr =       1.167187648341
              std dev =       0.544650893693
             le_variance =       0.296644596001


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721592314533e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+68, overlap shift 5.9605e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215923145372       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215923145372       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+69, overlap shift 2.3842e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215923145372       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215923145372       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+69, overlap shift 9.5367e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215923145372       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215923145372       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.033385 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7068e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2292
    reference variance = 0.238333
====================================================
  Execution time = 2.2538e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1605e-01
  Total weights = 1.9565e+06
  Execution time = 1.8315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414739756
                                         uncertainty =       0.002010951222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414739756
                                         uncertainty =       0.002010951222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387519424
  error estimate for blocks of size 2^( 2) =       0.000397087824
  error estimate for blocks of size 2^( 3) =       0.000406316967
  error estimate for blocks of size 2^( 4) =       0.000412673743
  error estimate for blocks of size 2^( 5) =       0.000416820009
  error estimate for blocks of size 2^( 6) =       0.000418317640
  error estimate for blocks of size 2^( 7) =       0.000420441586

      target function =                  N/A
              le_mean =     -17.216745654037
             les_mean =     296.732385222988
             stat err =       0.000417063244
             autocorr =       1.158288870318
              std dev =       0.548035224646
             le_variance =       0.300342607453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414739756
                                         uncertainty =       0.002010951222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414739756
                                         uncertainty =       0.002010951222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387519424
  error estimate for blocks of size 2^( 2) =       0.000397087824
  error estimate for blocks of size 2^( 3) =       0.000406316967
  error estimate for blocks of size 2^( 4) =       0.000412673743
  error estimate for blocks of size 2^( 5) =       0.000416820009
  error estimate for blocks of size 2^( 6) =       0.000418317640
  error estimate for blocks of size 2^( 7) =       0.000420441586

      target function =                  N/A
              le_mean =     -17.216745654037
             les_mean =     296.732385222988
             stat err =       0.000417063244
             autocorr =       1.158288870318
              std dev =       0.548035224646
             le_variance =       0.300342607453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414739756
                                         uncertainty =       0.002010951222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414739756
                                         uncertainty =       0.002010951222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387519424
  error estimate for blocks of size 2^( 2) =       0.000397087824
  error estimate for blocks of size 2^( 3) =       0.000406316967
  error estimate for blocks of size 2^( 4) =       0.000412673743
  error estimate for blocks of size 2^( 5) =       0.000416820009
  error estimate for blocks of size 2^( 6) =       0.000418317640
  error estimate for blocks of size 2^( 7) =       0.000420441586

      target function =                  N/A
              le_mean =     -17.216745654037
             les_mean =     296.732385222988
             stat err =       0.000417063244
             autocorr =       1.158288870318
              std dev =       0.548035224646
             le_variance =       0.300342607453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414739756
                                         uncertainty =       0.002010951222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300414739756
                                         uncertainty =       0.002010951222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387519424
  error estimate for blocks of size 2^( 2) =       0.000397087824
  error estimate for blocks of size 2^( 3) =       0.000406316967
  error estimate for blocks of size 2^( 4) =       0.000412673743
  error estimate for blocks of size 2^( 5) =       0.000416820009
  error estimate for blocks of size 2^( 6) =       0.000418317640
  error estimate for blocks of size 2^( 7) =       0.000420441586

      target function =                  N/A
              le_mean =     -17.216745654037
             les_mean =     296.732385222988
             stat err =       0.000417063244
             autocorr =       1.158288870318
              std dev =       0.548035224646
             le_variance =       0.300342607453


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216745654037        initial  <--
     5.9605e+68     5.9605e+69             0.0000e+00       -17.216745654037
     2.3842e+69     2.3842e+70             0.0000e+00       -17.216745654037
     9.5367e+69     9.5367e+70             0.0000e+00       -17.216745654037

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.8042
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8879e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2839
    reference variance = 0.231011
====================================================
  Execution time = 2.0678e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1471e-01
  Total weights = 1.956178344e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300589680025
                                         uncertainty =       0.003953602537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300589680025
                                         uncertainty =       0.003953602537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387683017
  error estimate for blocks of size 2^( 2) =       0.000397928089
  error estimate for blocks of size 2^( 3) =       0.000407224469
  error estimate for blocks of size 2^( 4) =       0.000413447980
  error estimate for blocks of size 2^( 5) =       0.000416808044
  error estimate for blocks of size 2^( 6) =       0.000418438314
  error estimate for blocks of size 2^( 7) =       0.000420233215

      target function =                  N/A
              le_mean =     -17.216134418522
             les_mean =     296.709990690423
             stat err =       0.000417231888
             autocorr =       1.158247663446
              std dev =       0.548266580786
             le_variance =       0.300596243607


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721613441852e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+69, overlap shift 5.9605e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216134418546       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216134418546       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+70, overlap shift 2.3842e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216134418546       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216134418546       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+70 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+70, overlap shift 9.5367e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216134418546       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216134418546       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+70 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.034587 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6663e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.1905
    reference variance = 0.1675
====================================================
  Execution time = 2.0575e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1567e-01
  Total weights = 1.9563e+06
  Execution time = 1.8330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219227720
                                         uncertainty =       0.002126459256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219227720
                                         uncertainty =       0.002126459256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386827909
  error estimate for blocks of size 2^( 2) =       0.000396515068
  error estimate for blocks of size 2^( 3) =       0.000405420505
  error estimate for blocks of size 2^( 4) =       0.000411303328
  error estimate for blocks of size 2^( 5) =       0.000415418715
  error estimate for blocks of size 2^( 6) =       0.000418484975
  error estimate for blocks of size 2^( 7) =       0.000420909856

      target function =                  N/A
              le_mean =     -17.216567313161
             les_mean =     296.725863390221
             stat err =       0.000416529218
             autocorr =       1.159458857978
              std dev =       0.547057274996
             le_variance =       0.299271662126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219227720
                                         uncertainty =       0.002126459256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219227720
                                         uncertainty =       0.002126459256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386827909
  error estimate for blocks of size 2^( 2) =       0.000396515068
  error estimate for blocks of size 2^( 3) =       0.000405420505
  error estimate for blocks of size 2^( 4) =       0.000411303328
  error estimate for blocks of size 2^( 5) =       0.000415418715
  error estimate for blocks of size 2^( 6) =       0.000418484975
  error estimate for blocks of size 2^( 7) =       0.000420909856

      target function =                  N/A
              le_mean =     -17.216567313161
             les_mean =     296.725863390221
             stat err =       0.000416529218
             autocorr =       1.159458857978
              std dev =       0.547057274996
             le_variance =       0.299271662126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219227720
                                         uncertainty =       0.002126459256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219227720
                                         uncertainty =       0.002126459256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386827909
  error estimate for blocks of size 2^( 2) =       0.000396515068
  error estimate for blocks of size 2^( 3) =       0.000405420505
  error estimate for blocks of size 2^( 4) =       0.000411303328
  error estimate for blocks of size 2^( 5) =       0.000415418715
  error estimate for blocks of size 2^( 6) =       0.000418484975
  error estimate for blocks of size 2^( 7) =       0.000420909856

      target function =                  N/A
              le_mean =     -17.216567313161
             les_mean =     296.725863390221
             stat err =       0.000416529218
             autocorr =       1.159458857978
              std dev =       0.547057274996
             le_variance =       0.299271662126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219227720
                                         uncertainty =       0.002126459256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299219227720
                                         uncertainty =       0.002126459256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386827909
  error estimate for blocks of size 2^( 2) =       0.000396515068
  error estimate for blocks of size 2^( 3) =       0.000405420505
  error estimate for blocks of size 2^( 4) =       0.000411303328
  error estimate for blocks of size 2^( 5) =       0.000415418715
  error estimate for blocks of size 2^( 6) =       0.000418484975
  error estimate for blocks of size 2^( 7) =       0.000420909856

      target function =                  N/A
              le_mean =     -17.216567313161
             les_mean =     296.725863390221
             stat err =       0.000416529218
             autocorr =       1.159458857978
              std dev =       0.547057274996
             le_variance =       0.299271662126


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216567313161        initial  <--
     5.9605e+69     5.9605e+70             0.0000e+00       -17.216567313161
     2.3842e+70     2.3842e+71             0.0000e+00       -17.216567313161
     9.5367e+70     9.5367e+71             0.0000e+00       -17.216567313161

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8657
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6534e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.2253
    reference variance = 0.44111
====================================================
  Execution time = 2.0927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1034e-01
  Total weights = 1.956733621e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298726553814
                                         uncertainty =       0.002105146347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298726553814
                                         uncertainty =       0.002105146347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386469510
  error estimate for blocks of size 2^( 2) =       0.000396701697
  error estimate for blocks of size 2^( 3) =       0.000405518448
  error estimate for blocks of size 2^( 4) =       0.000412094558
  error estimate for blocks of size 2^( 5) =       0.000416799181
  error estimate for blocks of size 2^( 6) =       0.000419165385
  error estimate for blocks of size 2^( 7) =       0.000419862149

      target function =                  N/A
              le_mean =     -17.216401403986
             les_mean =     296.714821921578
             stat err =       0.000416980318
             autocorr =       1.164127747334
              std dev =       0.546550421925
             le_variance =       0.298717363707


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721640140399e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+70, overlap shift 5.9605e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216401404011       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216401404011       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216401404011       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+70 is 4.957086e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+71, overlap shift 2.3842e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216401404011       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216401404011       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216401404011       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216401404011       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+71 is 1.288412e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+71, overlap shift 9.5367e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216401404011       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216401404011       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216401404011       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216401404011       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+71 is 3.221030e-76

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.036262 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6999e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1684
    reference variance = 0.157793
====================================================
  Execution time = 2.0573e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1465e-01
  Total weights = 1.9562e+06
  Execution time = 1.8367e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300162497706
                                         uncertainty =       0.001980254983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300162497706
                                         uncertainty =       0.001980254983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387477406
  error estimate for blocks of size 2^( 2) =       0.000397701945
  error estimate for blocks of size 2^( 3) =       0.000406889511
  error estimate for blocks of size 2^( 4) =       0.000412886945
  error estimate for blocks of size 2^( 5) =       0.000417184834
  error estimate for blocks of size 2^( 6) =       0.000420184125
  error estimate for blocks of size 2^( 7) =       0.000420742281

      target function =                  N/A
              le_mean =     -17.216966245109
             les_mean =     296.738576921926
             stat err =       0.000417749546
             autocorr =       1.162356120452
              std dev =       0.547975802221
             le_variance =       0.300277479820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300162497706
                                         uncertainty =       0.001980254983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300162497706
                                         uncertainty =       0.001980254983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387477406
  error estimate for blocks of size 2^( 2) =       0.000397701945
  error estimate for blocks of size 2^( 3) =       0.000406889511
  error estimate for blocks of size 2^( 4) =       0.000412886945
  error estimate for blocks of size 2^( 5) =       0.000417184834
  error estimate for blocks of size 2^( 6) =       0.000420184125
  error estimate for blocks of size 2^( 7) =       0.000420742281

      target function =                  N/A
              le_mean =     -17.216966245109
             les_mean =     296.738576921926
             stat err =       0.000417749546
             autocorr =       1.162356120452
              std dev =       0.547975802221
             le_variance =       0.300277479820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300162497706
                                         uncertainty =       0.001980254983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300162497706
                                         uncertainty =       0.001980254983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387477406
  error estimate for blocks of size 2^( 2) =       0.000397701945
  error estimate for blocks of size 2^( 3) =       0.000406889511
  error estimate for blocks of size 2^( 4) =       0.000412886945
  error estimate for blocks of size 2^( 5) =       0.000417184834
  error estimate for blocks of size 2^( 6) =       0.000420184125
  error estimate for blocks of size 2^( 7) =       0.000420742281

      target function =                  N/A
              le_mean =     -17.216966245109
             les_mean =     296.738576921926
             stat err =       0.000417749546
             autocorr =       1.162356120452
              std dev =       0.547975802221
             le_variance =       0.300277479820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300162497706
                                         uncertainty =       0.001980254983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300162497706
                                         uncertainty =       0.001980254983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387477406
  error estimate for blocks of size 2^( 2) =       0.000397701945
  error estimate for blocks of size 2^( 3) =       0.000406889511
  error estimate for blocks of size 2^( 4) =       0.000412886945
  error estimate for blocks of size 2^( 5) =       0.000417184834
  error estimate for blocks of size 2^( 6) =       0.000420184125
  error estimate for blocks of size 2^( 7) =       0.000420742281

      target function =                  N/A
              le_mean =     -17.216966245109
             les_mean =     296.738576921926
             stat err =       0.000417749546
             autocorr =       1.162356120452
              std dev =       0.547975802221
             le_variance =       0.300277479820


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216966245109        initial  <--
     5.9605e+70     5.9605e+71             4.9571e-75       -17.216966245109
     2.3842e+71     2.3842e+72             1.2884e-75       -17.216966245109
     9.5367e+71     9.5367e+72             3.2210e-76       -17.216966245109

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8698
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6875e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2406
    reference variance = 0.203211
====================================================
  Execution time = 2.0855e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2183e-01
  Total weights = 1.956471248e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2134e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303948002083
                                         uncertainty =       0.002390007758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303948002083
                                         uncertainty =       0.002390007758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389810146
  error estimate for blocks of size 2^( 2) =       0.000399740719
  error estimate for blocks of size 2^( 3) =       0.000408745531
  error estimate for blocks of size 2^( 4) =       0.000415354095
  error estimate for blocks of size 2^( 5) =       0.000419181341
  error estimate for blocks of size 2^( 6) =       0.000422098753
  error estimate for blocks of size 2^( 7) =       0.000423636407

      target function =                  N/A
              le_mean =     -17.216015674002
             les_mean =     296.713022308573
             stat err =       0.000420067649
             autocorr =       1.161267295173
              std dev =       0.551274794977
             le_variance =       0.303903899577


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721601567400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+71, overlap shift 5.9605e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216015674039       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216015674039       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+71 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+72, overlap shift 2.3842e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216015674039       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216015674039       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+72, overlap shift 9.5367e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216015674039       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216015674039       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.037455 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7079e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2197
    reference variance = 0.184402
====================================================
  Execution time = 2.0770e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1456e-01
  Total weights = 1.9568e+06
  Execution time = 1.8342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296948792075
                                         uncertainty =       0.002300758105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296948792075
                                         uncertainty =       0.002300758105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385295966
  error estimate for blocks of size 2^( 2) =       0.000395615723
  error estimate for blocks of size 2^( 3) =       0.000404401169
  error estimate for blocks of size 2^( 4) =       0.000410982871
  error estimate for blocks of size 2^( 5) =       0.000414932937
  error estimate for blocks of size 2^( 6) =       0.000416604075
  error estimate for blocks of size 2^( 7) =       0.000418968332

      target function =                  N/A
              le_mean =     -17.215865169305
             les_mean =     296.700572309659
             stat err =       0.000415372054
             autocorr =       1.162212717638
              std dev =       0.544890780986
             le_variance =       0.296905963204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296948792075
                                         uncertainty =       0.002300758105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296948792075
                                         uncertainty =       0.002300758105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385295966
  error estimate for blocks of size 2^( 2) =       0.000395615723
  error estimate for blocks of size 2^( 3) =       0.000404401169
  error estimate for blocks of size 2^( 4) =       0.000410982871
  error estimate for blocks of size 2^( 5) =       0.000414932937
  error estimate for blocks of size 2^( 6) =       0.000416604075
  error estimate for blocks of size 2^( 7) =       0.000418968332

      target function =                  N/A
              le_mean =     -17.215865169305
             les_mean =     296.700572309659
             stat err =       0.000415372054
             autocorr =       1.162212717638
              std dev =       0.544890780986
             le_variance =       0.296905963204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296948792075
                                         uncertainty =       0.002300758105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296948792075
                                         uncertainty =       0.002300758105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385295966
  error estimate for blocks of size 2^( 2) =       0.000395615723
  error estimate for blocks of size 2^( 3) =       0.000404401169
  error estimate for blocks of size 2^( 4) =       0.000410982871
  error estimate for blocks of size 2^( 5) =       0.000414932937
  error estimate for blocks of size 2^( 6) =       0.000416604075
  error estimate for blocks of size 2^( 7) =       0.000418968332

      target function =                  N/A
              le_mean =     -17.215865169305
             les_mean =     296.700572309659
             stat err =       0.000415372054
             autocorr =       1.162212717638
              std dev =       0.544890780986
             le_variance =       0.296905963204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296948792075
                                         uncertainty =       0.002300758105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296948792075
                                         uncertainty =       0.002300758105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385295966
  error estimate for blocks of size 2^( 2) =       0.000395615723
  error estimate for blocks of size 2^( 3) =       0.000404401169
  error estimate for blocks of size 2^( 4) =       0.000410982871
  error estimate for blocks of size 2^( 5) =       0.000414932937
  error estimate for blocks of size 2^( 6) =       0.000416604075
  error estimate for blocks of size 2^( 7) =       0.000418968332

      target function =                  N/A
              le_mean =     -17.215865169305
             les_mean =     296.700572309659
             stat err =       0.000415372054
             autocorr =       1.162212717638
              std dev =       0.544890780986
             le_variance =       0.296905963204


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215865169305        initial  <--
     5.9605e+71     5.9605e+72             0.0000e+00       -17.215865169305
     2.3842e+72     2.3842e+73             0.0000e+00       -17.215865169305
     9.5367e+72     9.5367e+73             0.0000e+00       -17.215865169305

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0627
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7148e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.1549
    reference variance = 0.183804
====================================================
  Execution time = 2.0675e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1867e-01
  Total weights = 1.956483939e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302587754983
                                         uncertainty =       0.002011321857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302587754983
                                         uncertainty =       0.002011321857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388976110
  error estimate for blocks of size 2^( 2) =       0.000398999426
  error estimate for blocks of size 2^( 3) =       0.000407846149
  error estimate for blocks of size 2^( 4) =       0.000414105577
  error estimate for blocks of size 2^( 5) =       0.000418195900
  error estimate for blocks of size 2^( 6) =       0.000420868144
  error estimate for blocks of size 2^( 7) =       0.000421841983

      target function =                  N/A
              le_mean =     -17.216539666390
             les_mean =     296.727910511801
             stat err =       0.000418752901
             autocorr =       1.158963611181
              std dev =       0.550095290153
             le_variance =       0.302604828249


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653966639e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+72, overlap shift 5.9605e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216539666408       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216539666408       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+72 is 6.922361e-77

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+73, overlap shift 2.3842e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216539666408       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216539666408       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+73 is 1.730590e-77

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+73, overlap shift 9.5367e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216539666408       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216539666408       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+73 is 4.326475e-78

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.038697 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6795e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2164
    reference variance = 0.16077
====================================================
  Execution time = 2.0635e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1815e-01
  Total weights = 1.9566e+06
  Execution time = 1.8331e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301718192165
                                         uncertainty =       0.002156316421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301718192165
                                         uncertainty =       0.002156316421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388443503
  error estimate for blocks of size 2^( 2) =       0.000398391718
  error estimate for blocks of size 2^( 3) =       0.000407569157
  error estimate for blocks of size 2^( 4) =       0.000414111321
  error estimate for blocks of size 2^( 5) =       0.000417662874
  error estimate for blocks of size 2^( 6) =       0.000418844122
  error estimate for blocks of size 2^( 7) =       0.000417660850

      target function =                  N/A
              le_mean =     -17.216383189688
             les_mean =     296.722001492201
             stat err =       0.000417069792
             autocorr =       1.152820647001
              std dev =       0.549342070338
             le_variance =       0.301776710243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301718192165
                                         uncertainty =       0.002156316421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301718192165
                                         uncertainty =       0.002156316421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388443503
  error estimate for blocks of size 2^( 2) =       0.000398391718
  error estimate for blocks of size 2^( 3) =       0.000407569157
  error estimate for blocks of size 2^( 4) =       0.000414111321
  error estimate for blocks of size 2^( 5) =       0.000417662874
  error estimate for blocks of size 2^( 6) =       0.000418844122
  error estimate for blocks of size 2^( 7) =       0.000417660850

      target function =                  N/A
              le_mean =     -17.216383189688
             les_mean =     296.722001492201
             stat err =       0.000417069792
             autocorr =       1.152820647001
              std dev =       0.549342070338
             le_variance =       0.301776710243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301718192165
                                         uncertainty =       0.002156316421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301718192165
                                         uncertainty =       0.002156316421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388443503
  error estimate for blocks of size 2^( 2) =       0.000398391718
  error estimate for blocks of size 2^( 3) =       0.000407569157
  error estimate for blocks of size 2^( 4) =       0.000414111321
  error estimate for blocks of size 2^( 5) =       0.000417662874
  error estimate for blocks of size 2^( 6) =       0.000418844122
  error estimate for blocks of size 2^( 7) =       0.000417660850

      target function =                  N/A
              le_mean =     -17.216383189688
             les_mean =     296.722001492201
             stat err =       0.000417069792
             autocorr =       1.152820647001
              std dev =       0.549342070338
             le_variance =       0.301776710243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301718192165
                                         uncertainty =       0.002156316421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301718192165
                                         uncertainty =       0.002156316421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388443503
  error estimate for blocks of size 2^( 2) =       0.000398391718
  error estimate for blocks of size 2^( 3) =       0.000407569157
  error estimate for blocks of size 2^( 4) =       0.000414111321
  error estimate for blocks of size 2^( 5) =       0.000417662874
  error estimate for blocks of size 2^( 6) =       0.000418844122
  error estimate for blocks of size 2^( 7) =       0.000417660850

      target function =                  N/A
              le_mean =     -17.216383189688
             les_mean =     296.722001492201
             stat err =       0.000417069792
             autocorr =       1.152820647001
              std dev =       0.549342070338
             le_variance =       0.301776710243


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216383189688        initial  <--
     5.9605e+72     5.9605e+73             6.9224e-77       -17.216383189688
     2.3842e+73     2.3842e+74             1.7306e-77       -17.216383189688
     9.5367e+73     9.5367e+74             4.3265e-78       -17.216383189688

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9218
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6725e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1737
    reference variance = 0.254166
====================================================
  Execution time = 2.0684e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1174e-01
  Total weights = 1.956453672e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0489e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295944442412
                                         uncertainty =       0.001796295927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295944442412
                                         uncertainty =       0.001796295927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384688690
  error estimate for blocks of size 2^( 2) =       0.000394564136
  error estimate for blocks of size 2^( 3) =       0.000403166684
  error estimate for blocks of size 2^( 4) =       0.000409488041
  error estimate for blocks of size 2^( 5) =       0.000414568102
  error estimate for blocks of size 2^( 6) =       0.000416570179
  error estimate for blocks of size 2^( 7) =       0.000418377624

      target function =                  N/A
              le_mean =     -17.216479228424
             les_mean =     296.718899331075
             stat err =       0.000414750986
             autocorr =       1.162401116110
              std dev =       0.544031962903
             le_variance =       0.295970776661


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647922842e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+73, overlap shift 5.9605e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216479228473       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216479228473       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216479228473       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+73 is 5.804183e-78

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+74, overlap shift 2.3842e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216479228473       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216479228473       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216479228473       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+74 is 1.451046e-78

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+74, overlap shift 9.5367e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216479228473       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216479228473       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216479228473       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+74 is 3.627614e-79

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.040158 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6744e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2528
    reference variance = 0.296551
====================================================
  Execution time = 2.1413e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2038e-01
  Total weights = 1.9567e+06
  Execution time = 2.1816e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303142427479
                                         uncertainty =       0.005490020942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303142427479
                                         uncertainty =       0.005490020942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389353087
  error estimate for blocks of size 2^( 2) =       0.000399236374
  error estimate for blocks of size 2^( 3) =       0.000408060345
  error estimate for blocks of size 2^( 4) =       0.000414969106
  error estimate for blocks of size 2^( 5) =       0.000420338501
  error estimate for blocks of size 2^( 6) =       0.000423412711
  error estimate for blocks of size 2^( 7) =       0.000423506087

      target function =                  N/A
              le_mean =     -17.216254754133
             les_mean =     296.719806268735
             stat err =       0.000420556601
             autocorr =       1.166706625746
              std dev =       0.550628415925
             le_variance =       0.303191652424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303142427479
                                         uncertainty =       0.005490020942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303142427479
                                         uncertainty =       0.005490020942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389353087
  error estimate for blocks of size 2^( 2) =       0.000399236374
  error estimate for blocks of size 2^( 3) =       0.000408060345
  error estimate for blocks of size 2^( 4) =       0.000414969106
  error estimate for blocks of size 2^( 5) =       0.000420338501
  error estimate for blocks of size 2^( 6) =       0.000423412711
  error estimate for blocks of size 2^( 7) =       0.000423506087

      target function =                  N/A
              le_mean =     -17.216254754133
             les_mean =     296.719806268735
             stat err =       0.000420556601
             autocorr =       1.166706625746
              std dev =       0.550628415925
             le_variance =       0.303191652424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303142427479
                                         uncertainty =       0.005490020942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303142427479
                                         uncertainty =       0.005490020942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389353087
  error estimate for blocks of size 2^( 2) =       0.000399236374
  error estimate for blocks of size 2^( 3) =       0.000408060345
  error estimate for blocks of size 2^( 4) =       0.000414969106
  error estimate for blocks of size 2^( 5) =       0.000420338501
  error estimate for blocks of size 2^( 6) =       0.000423412711
  error estimate for blocks of size 2^( 7) =       0.000423506087

      target function =                  N/A
              le_mean =     -17.216254754133
             les_mean =     296.719806268735
             stat err =       0.000420556601
             autocorr =       1.166706625746
              std dev =       0.550628415925
             le_variance =       0.303191652424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303142427479
                                         uncertainty =       0.005490020942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303142427479
                                         uncertainty =       0.005490020942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389353087
  error estimate for blocks of size 2^( 2) =       0.000399236374
  error estimate for blocks of size 2^( 3) =       0.000408060345
  error estimate for blocks of size 2^( 4) =       0.000414969106
  error estimate for blocks of size 2^( 5) =       0.000420338501
  error estimate for blocks of size 2^( 6) =       0.000423412711
  error estimate for blocks of size 2^( 7) =       0.000423506087

      target function =                  N/A
              le_mean =     -17.216254754133
             les_mean =     296.719806268735
             stat err =       0.000420556601
             autocorr =       1.166706625746
              std dev =       0.550628415925
             le_variance =       0.303191652424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216254754133        initial  <--
     5.9605e+73     5.9605e+74             5.8042e-78       -17.216254754133
     2.3842e+74     2.3842e+75             1.4510e-78       -17.216254754133
     9.5367e+74     9.5367e+75             3.6276e-79       -17.216254754133

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.1333
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7883e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.1884
    reference variance = 0.297568
====================================================
  Execution time = 2.0716e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0894e-01
  Total weights = 1.956440252e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296402870886
                                         uncertainty =       0.001764532980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296402870886
                                         uncertainty =       0.001764532980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384952393
  error estimate for blocks of size 2^( 2) =       0.000395302373
  error estimate for blocks of size 2^( 3) =       0.000404500240
  error estimate for blocks of size 2^( 4) =       0.000411464857
  error estimate for blocks of size 2^( 5) =       0.000416251345
  error estimate for blocks of size 2^( 6) =       0.000419448061
  error estimate for blocks of size 2^( 7) =       0.000419741638

      target function =                  N/A
              le_mean =     -17.216579427672
             les_mean =     296.719544165185
             stat err =       0.000416726475
             autocorr =       1.171893479650
              std dev =       0.544404895092
             le_variance =       0.296376689800


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657942767e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+74, overlap shift 5.9605e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216579427711       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216579427711       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+74 is 5.851600e-79

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+75, overlap shift 2.3842e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216579427711       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216579427711       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+75 is 1.462900e-79

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+75, overlap shift 9.5367e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216579427711       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216579427711       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+75 is 3.657250e-80

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.041338 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6710e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.168
    reference variance = 0.149153
====================================================
  Execution time = 2.0633e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1726e-01
  Total weights = 1.9566e+06
  Execution time = 1.8305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301844686166
                                         uncertainty =       0.002018373330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301844686166
                                         uncertainty =       0.002018373330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388524592
  error estimate for blocks of size 2^( 2) =       0.000398507573
  error estimate for blocks of size 2^( 3) =       0.000407669701
  error estimate for blocks of size 2^( 4) =       0.000414778310
  error estimate for blocks of size 2^( 5) =       0.000419594971
  error estimate for blocks of size 2^( 6) =       0.000421628128
  error estimate for blocks of size 2^( 7) =       0.000423097845

      target function =                  N/A
              le_mean =     -17.216395478977
             les_mean =     296.721531422567
             stat err =       0.000419774814
             autocorr =       1.167335597043
              std dev =       0.549456747084
             le_variance =       0.301902716916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301844686166
                                         uncertainty =       0.002018373330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301844686166
                                         uncertainty =       0.002018373330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388524592
  error estimate for blocks of size 2^( 2) =       0.000398507573
  error estimate for blocks of size 2^( 3) =       0.000407669701
  error estimate for blocks of size 2^( 4) =       0.000414778310
  error estimate for blocks of size 2^( 5) =       0.000419594971
  error estimate for blocks of size 2^( 6) =       0.000421628128
  error estimate for blocks of size 2^( 7) =       0.000423097845

      target function =                  N/A
              le_mean =     -17.216395478977
             les_mean =     296.721531422567
             stat err =       0.000419774814
             autocorr =       1.167335597043
              std dev =       0.549456747084
             le_variance =       0.301902716916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301844686166
                                         uncertainty =       0.002018373330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301844686166
                                         uncertainty =       0.002018373330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388524592
  error estimate for blocks of size 2^( 2) =       0.000398507573
  error estimate for blocks of size 2^( 3) =       0.000407669701
  error estimate for blocks of size 2^( 4) =       0.000414778310
  error estimate for blocks of size 2^( 5) =       0.000419594971
  error estimate for blocks of size 2^( 6) =       0.000421628128
  error estimate for blocks of size 2^( 7) =       0.000423097845

      target function =                  N/A
              le_mean =     -17.216395478977
             les_mean =     296.721531422567
             stat err =       0.000419774814
             autocorr =       1.167335597043
              std dev =       0.549456747084
             le_variance =       0.301902716916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301844686166
                                         uncertainty =       0.002018373330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301844686166
                                         uncertainty =       0.002018373330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388524592
  error estimate for blocks of size 2^( 2) =       0.000398507573
  error estimate for blocks of size 2^( 3) =       0.000407669701
  error estimate for blocks of size 2^( 4) =       0.000414778310
  error estimate for blocks of size 2^( 5) =       0.000419594971
  error estimate for blocks of size 2^( 6) =       0.000421628128
  error estimate for blocks of size 2^( 7) =       0.000423097845

      target function =                  N/A
              le_mean =     -17.216395478977
             les_mean =     296.721531422567
             stat err =       0.000419774814
             autocorr =       1.167335597043
              std dev =       0.549456747084
             le_variance =       0.301902716916


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216395478977        initial  <--
     5.9605e+74     5.9605e+75             5.8516e-79       -17.216395478977
     2.3842e+75     2.3842e+76             1.4629e-79       -17.216395478977
     9.5367e+75     9.5367e+76             3.6572e-80       -17.216395478977

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9144
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6630e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.1431
    reference variance = 0.287993
====================================================
  Execution time = 2.0872e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1331e-01
  Total weights = 1.956360001e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0923e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300417003480
                                         uncertainty =       0.002332428854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300417003480
                                         uncertainty =       0.002332428854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387511602
  error estimate for blocks of size 2^( 2) =       0.000397532746
  error estimate for blocks of size 2^( 3) =       0.000406999440
  error estimate for blocks of size 2^( 4) =       0.000413790094
  error estimate for blocks of size 2^( 5) =       0.000419097721
  error estimate for blocks of size 2^( 6) =       0.000422354922
  error estimate for blocks of size 2^( 7) =       0.000422809306

      target function =                  N/A
              le_mean =     -17.216391789216
             les_mean =     296.717453375457
             stat err =       0.000419513011
             autocorr =       1.171983368763
              std dev =       0.548024163585
             le_variance =       0.300330483873


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639178922e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+75, overlap shift 5.9605e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216391789240       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216391789240       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216391789240       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+75 is 3.883285e-80

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+76, overlap shift 2.3842e+77 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216391789240       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216391789240       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216391789240       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+76 is 9.708213e-81

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+76, overlap shift 9.5367e+77 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216391789240       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216391789240       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216391789240       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+76 is 2.427053e-81

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.042864 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6975e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.1856
    reference variance = 0.196236
====================================================
  Execution time = 2.0680e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.5002e-01
  Total weights = 1.9567e+06
  Execution time = 1.8339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328736910890
                                         uncertainty =       0.027116216042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328736910890
                                         uncertainty =       0.027116216042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405452517
  error estimate for blocks of size 2^( 2) =       0.000415163066
  error estimate for blocks of size 2^( 3) =       0.000423576258
  error estimate for blocks of size 2^( 4) =       0.000430178499
  error estimate for blocks of size 2^( 5) =       0.000433372884
  error estimate for blocks of size 2^( 6) =       0.000433811889
  error estimate for blocks of size 2^( 7) =       0.000434157047

      target function =                  N/A
              le_mean =     -17.216788939634
             les_mean =     296.767842613176
             stat err =       0.000432880080
             autocorr =       1.139869674149
              std dev =       0.573396448759
             le_variance =       0.328783487449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328736910890
                                         uncertainty =       0.027116216042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328736910890
                                         uncertainty =       0.027116216042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405452517
  error estimate for blocks of size 2^( 2) =       0.000415163066
  error estimate for blocks of size 2^( 3) =       0.000423576258
  error estimate for blocks of size 2^( 4) =       0.000430178499
  error estimate for blocks of size 2^( 5) =       0.000433372884
  error estimate for blocks of size 2^( 6) =       0.000433811889
  error estimate for blocks of size 2^( 7) =       0.000434157047

      target function =                  N/A
              le_mean =     -17.216788939634
             les_mean =     296.767842613176
             stat err =       0.000432880080
             autocorr =       1.139869674149
              std dev =       0.573396448759
             le_variance =       0.328783487449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328736910890
                                         uncertainty =       0.027116216042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328736910890
                                         uncertainty =       0.027116216042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405452517
  error estimate for blocks of size 2^( 2) =       0.000415163066
  error estimate for blocks of size 2^( 3) =       0.000423576258
  error estimate for blocks of size 2^( 4) =       0.000430178499
  error estimate for blocks of size 2^( 5) =       0.000433372884
  error estimate for blocks of size 2^( 6) =       0.000433811889
  error estimate for blocks of size 2^( 7) =       0.000434157047

      target function =                  N/A
              le_mean =     -17.216788939634
             les_mean =     296.767842613176
             stat err =       0.000432880080
             autocorr =       1.139869674149
              std dev =       0.573396448759
             le_variance =       0.328783487449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328736910890
                                         uncertainty =       0.027116216042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328736910890
                                         uncertainty =       0.027116216042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405452517
  error estimate for blocks of size 2^( 2) =       0.000415163066
  error estimate for blocks of size 2^( 3) =       0.000423576258
  error estimate for blocks of size 2^( 4) =       0.000430178499
  error estimate for blocks of size 2^( 5) =       0.000433372884
  error estimate for blocks of size 2^( 6) =       0.000433811889
  error estimate for blocks of size 2^( 7) =       0.000434157047

      target function =                  N/A
              le_mean =     -17.216788939634
             les_mean =     296.767842613176
             stat err =       0.000432880080
             autocorr =       1.139869674149
              std dev =       0.573396448759
             le_variance =       0.328783487449


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216788939634        initial  <--
     5.9605e+75     5.9605e+76             3.8833e-80       -17.216788939634
     2.3842e+76     2.3842e+77             9.7082e-81       -17.216788939634
     9.5367e+76     9.5367e+77             2.4271e-81       -17.216788939634

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9558
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6937e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.1604
    reference variance = 0.251982
====================================================
  Execution time = 2.0701e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1271e-01
  Total weights = 1.956647563e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300835826261
                                         uncertainty =       0.001984865917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300835826261
                                         uncertainty =       0.001984865917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387825086
  error estimate for blocks of size 2^( 2) =       0.000397789875
  error estimate for blocks of size 2^( 3) =       0.000406254148
  error estimate for blocks of size 2^( 4) =       0.000412793170
  error estimate for blocks of size 2^( 5) =       0.000417486123
  error estimate for blocks of size 2^( 6) =       0.000419800437
  error estimate for blocks of size 2^( 7) =       0.000421348812

      target function =                  N/A
              le_mean =     -17.216857030280
             les_mean =     296.732880062154
             stat err =       0.000417857136
             autocorr =       1.160870701903
              std dev =       0.548467496686
             le_variance =       0.300816594921


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685703028e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+76, overlap shift 5.9605e+77 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216857030317       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216857030317       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+76 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+77, overlap shift 2.3842e+78 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216857030317       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216857030317       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+77 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+77, overlap shift 9.5367e+78 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216857030317       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216857030317       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+77 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.043989 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6817e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.1926
    reference variance = 0.622578
====================================================
  Execution time = 2.0615e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1702e-01
  Total weights = 1.9568e+06
  Execution time = 1.8372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301773040277
                                         uncertainty =       0.002763719257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301773040277
                                         uncertainty =       0.002763719257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388443954
  error estimate for blocks of size 2^( 2) =       0.000398012540
  error estimate for blocks of size 2^( 3) =       0.000406762431
  error estimate for blocks of size 2^( 4) =       0.000413858680
  error estimate for blocks of size 2^( 5) =       0.000416904162
  error estimate for blocks of size 2^( 6) =       0.000418213389
  error estimate for blocks of size 2^( 7) =       0.000418636812

      target function =                  N/A
              le_mean =     -17.216242303259
             les_mean =     296.716019185639
             stat err =       0.000416903261
             autocorr =       1.151897537938
              std dev =       0.549342708646
             le_variance =       0.301777411542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301773040277
                                         uncertainty =       0.002763719257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301773040277
                                         uncertainty =       0.002763719257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388443954
  error estimate for blocks of size 2^( 2) =       0.000398012540
  error estimate for blocks of size 2^( 3) =       0.000406762431
  error estimate for blocks of size 2^( 4) =       0.000413858680
  error estimate for blocks of size 2^( 5) =       0.000416904162
  error estimate for blocks of size 2^( 6) =       0.000418213389
  error estimate for blocks of size 2^( 7) =       0.000418636812

      target function =                  N/A
              le_mean =     -17.216242303259
             les_mean =     296.716019185639
             stat err =       0.000416903261
             autocorr =       1.151897537938
              std dev =       0.549342708646
             le_variance =       0.301777411542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301773040277
                                         uncertainty =       0.002763719257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301773040277
                                         uncertainty =       0.002763719257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388443954
  error estimate for blocks of size 2^( 2) =       0.000398012540
  error estimate for blocks of size 2^( 3) =       0.000406762431
  error estimate for blocks of size 2^( 4) =       0.000413858680
  error estimate for blocks of size 2^( 5) =       0.000416904162
  error estimate for blocks of size 2^( 6) =       0.000418213389
  error estimate for blocks of size 2^( 7) =       0.000418636812

      target function =                  N/A
              le_mean =     -17.216242303259
             les_mean =     296.716019185639
             stat err =       0.000416903261
             autocorr =       1.151897537938
              std dev =       0.549342708646
             le_variance =       0.301777411542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301773040277
                                         uncertainty =       0.002763719257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301773040277
                                         uncertainty =       0.002763719257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388443954
  error estimate for blocks of size 2^( 2) =       0.000398012540
  error estimate for blocks of size 2^( 3) =       0.000406762431
  error estimate for blocks of size 2^( 4) =       0.000413858680
  error estimate for blocks of size 2^( 5) =       0.000416904162
  error estimate for blocks of size 2^( 6) =       0.000418213389
  error estimate for blocks of size 2^( 7) =       0.000418636812

      target function =                  N/A
              le_mean =     -17.216242303259
             les_mean =     296.716019185639
             stat err =       0.000416903261
             autocorr =       1.151897537938
              std dev =       0.549342708646
             le_variance =       0.301777411542


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216242303259        initial  <--
     5.9605e+76     5.9605e+77             0.0000e+00       -17.216242303259
     2.3842e+77     2.3842e+78             0.0000e+00       -17.216242303259
     9.5367e+77     9.5367e+78             0.0000e+00       -17.216242303259

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9244
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6747e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.1432
    reference variance = 0.158271
====================================================
  Execution time = 2.0637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1783e-01
  Total weights = 1.956529638e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0530e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303135926057
                                         uncertainty =       0.004484047995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303135926057
                                         uncertainty =       0.004484047995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389258011
  error estimate for blocks of size 2^( 2) =       0.000398869580
  error estimate for blocks of size 2^( 3) =       0.000408166179
  error estimate for blocks of size 2^( 4) =       0.000414811923
  error estimate for blocks of size 2^( 5) =       0.000419613624
  error estimate for blocks of size 2^( 6) =       0.000422166513
  error estimate for blocks of size 2^( 7) =       0.000424062931

      target function =                  N/A
              le_mean =     -17.216452366628
             les_mean =     296.724063084122
             stat err =       0.000420163748
             autocorr =       1.165096877791
              std dev =       0.550493958149
             le_variance =       0.303043597958


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721645236663e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+77, overlap shift 5.9605e+78 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216452366646       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216452366646       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+77 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+78, overlap shift 2.3842e+79 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216452366646       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216452366646       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+78 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+78, overlap shift 9.5367e+79 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216452366646       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216452366646       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+78 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.045191 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6700e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.3111
    reference variance = 0.316778
====================================================
  Execution time = 2.0688e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1245e-01
  Total weights = 1.9567e+06
  Execution time = 1.8410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297960018822
                                         uncertainty =       0.001864845455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297960018822
                                         uncertainty =       0.001864845455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386085852
  error estimate for blocks of size 2^( 2) =       0.000395895799
  error estimate for blocks of size 2^( 3) =       0.000404679995
  error estimate for blocks of size 2^( 4) =       0.000411483408
  error estimate for blocks of size 2^( 5) =       0.000415838184
  error estimate for blocks of size 2^( 6) =       0.000417244770
  error estimate for blocks of size 2^( 7) =       0.000418445874

      target function =                  N/A
              le_mean =     -17.216741116594
             les_mean =     296.728625922415
             stat err =       0.000415753059
             autocorr =       1.159586451497
              std dev =       0.546007848098
             le_variance =       0.298124570185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297960018822
                                         uncertainty =       0.001864845455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297960018822
                                         uncertainty =       0.001864845455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386085852
  error estimate for blocks of size 2^( 2) =       0.000395895799
  error estimate for blocks of size 2^( 3) =       0.000404679995
  error estimate for blocks of size 2^( 4) =       0.000411483408
  error estimate for blocks of size 2^( 5) =       0.000415838184
  error estimate for blocks of size 2^( 6) =       0.000417244770
  error estimate for blocks of size 2^( 7) =       0.000418445874

      target function =                  N/A
              le_mean =     -17.216741116594
             les_mean =     296.728625922415
             stat err =       0.000415753059
             autocorr =       1.159586451497
              std dev =       0.546007848098
             le_variance =       0.298124570185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297960018822
                                         uncertainty =       0.001864845455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297960018822
                                         uncertainty =       0.001864845455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386085852
  error estimate for blocks of size 2^( 2) =       0.000395895799
  error estimate for blocks of size 2^( 3) =       0.000404679995
  error estimate for blocks of size 2^( 4) =       0.000411483408
  error estimate for blocks of size 2^( 5) =       0.000415838184
  error estimate for blocks of size 2^( 6) =       0.000417244770
  error estimate for blocks of size 2^( 7) =       0.000418445874

      target function =                  N/A
              le_mean =     -17.216741116594
             les_mean =     296.728625922415
             stat err =       0.000415753059
             autocorr =       1.159586451497
              std dev =       0.546007848098
             le_variance =       0.298124570185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297960018822
                                         uncertainty =       0.001864845455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297960018822
                                         uncertainty =       0.001864845455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386085852
  error estimate for blocks of size 2^( 2) =       0.000395895799
  error estimate for blocks of size 2^( 3) =       0.000404679995
  error estimate for blocks of size 2^( 4) =       0.000411483408
  error estimate for blocks of size 2^( 5) =       0.000415838184
  error estimate for blocks of size 2^( 6) =       0.000417244770
  error estimate for blocks of size 2^( 7) =       0.000418445874

      target function =                  N/A
              le_mean =     -17.216741116594
             les_mean =     296.728625922415
             stat err =       0.000415753059
             autocorr =       1.159586451497
              std dev =       0.546007848098
             le_variance =       0.298124570185


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216741116594        initial  <--
     5.9605e+77     5.9605e+78             0.0000e+00       -17.216741116594
     2.3842e+78     2.3842e+79             0.0000e+00       -17.216741116594
     9.5367e+78     9.5367e+79             0.0000e+00       -17.216741116594

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0240
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.052136e-01 1 1  ON 0
  uu_1                 4.496582e-02 1 1  ON 1
  uu_2                -4.694820e-02 1 1  ON 2
  uu_3                -9.928724e-02 1 1  ON 3
  uu_4                -1.300218e-01 1 1  ON 4
  uu_5                -1.354295e-01 1 1  ON 5
  uu_6                -1.124488e-01 1 1  ON 6
  uu_7                -3.914577e-02 1 1  ON 7
  uu_8                 1.001571e-01 1 1  ON 8
  uu_9                 1.206276e-01 1 1  ON 9
  ud_0                 3.487459e-01 1 1  ON 10
  ud_1                 9.116411e-02 1 1  ON 11
  ud_2                -1.671341e-02 1 1  ON 12
  ud_3                -7.581002e-02 1 1  ON 13
  ud_4                -1.214661e-01 1 1  ON 14
  ud_5                -1.518192e-01 1 1  ON 15
  ud_6                -1.542888e-01 1 1  ON 16
  ud_7                -1.096708e-01 1 1  ON 17
  ud_8                 4.959319e-03 1 1  ON 18
  ud_9                 9.253544e-02 1 1  ON 19
  eO_0                -7.473680e-01 1 1  ON 20
  eO_1                -4.334710e-01 1 1  ON 21
  eO_2                -3.549295e-02 1 1  ON 22
  eO_3                 2.067973e-01 1 1  ON 23
  eO_4                 2.862830e-01 1 1  ON 24
  eO_5                 3.046199e-01 1 1  ON 25
  eO_6                 2.500150e-01 1 1  ON 26
  eO_7                 1.117584e-01 1 1  ON 27
  eO_8                 2.784044e-02 1 1  ON 28
  eO_9                 1.841217e-02 1 1  ON 29
 eH1_0                -1.820127e-01 1 1  ON 30
 eH1_1                -1.025653e-01 1 1  ON 31
 eH1_2                -6.218795e-02 1 1  ON 32
 eH1_3                -2.596953e-02 1 1  ON 33
 eH1_4                 1.934744e-02 1 1  ON 34
 eH1_5                 3.564688e-02 1 1  ON 35
 eH1_6                 7.727447e-02 1 1  ON 36
 eH1_7                 1.104605e-01 1 1  ON 37
 eH1_8                 9.054904e-02 1 1  ON 38
 eH1_9                 2.423150e-02 1 1  ON 39
 eH2_0                -1.832679e-01 1 1  ON 40
 eH2_1                -1.036076e-01 1 1  ON 41
 eH2_2                -6.357570e-02 1 1  ON 42
 eH2_3                -2.732766e-02 1 1  ON 43
 eH2_4                 1.829809e-02 1 1  ON 44
 eH2_5                 3.518885e-02 1 1  ON 45
 eH2_6                 7.840011e-02 1 1  ON 46
 eH2_7                 1.136377e-01 1 1  ON 47
 eH2_8                 9.374952e-02 1 1  ON 48
 eH2_9                 2.630206e-02 1 1  ON 49
ci_001                -4.050561e-02 3 1  ON 50
ci_002                -2.987694e-02 3 1  ON 51
ci_003                -2.525596e-02 3 1  ON 52
ci_004                 2.101517e-02 3 1  ON 53
ci_005                 2.141931e-02 3 1  ON 54
ci_006                -1.922543e-02 3 1  ON 55
ci_007                -1.910951e-02 3 1  ON 56
ci_008                -1.768212e-02 3 1  ON 57
ci_009                -1.816674e-02 3 1  ON 58
ci_010                -1.748770e-02 3 1  ON 59
ci_011                -1.635485e-02 3 1  ON 60
ci_012                -1.634310e-02 3 1  ON 61
ci_013                -1.930119e-02 3 1  ON 62
ci_014                 1.396499e-02 3 1  ON 63
ci_015                 1.370288e-02 3 1  ON 64
ci_016                 1.648867e-02 3 1  ON 65
ci_017                 1.640788e-02 3 1  ON 66
ci_018                 1.287136e-02 3 1  ON 67
ci_019                 1.321365e-02 3 1  ON 68
ci_020                 1.354027e-02 3 1  ON 69
ci_021                 1.339107e-02 3 1  ON 70
ci_022                 1.106967e-02 3 1  ON 71
ci_023                 1.088370e-02 3 1  ON 72
ci_024                 1.198795e-02 3 1  ON 73
ci_025                 1.151592e-02 3 1  ON 74
ci_026                 1.099150e-02 3 1  ON 75
ci_027                 1.159257e-02 3 1  ON 76
ci_028                -1.458228e-02 3 1  ON 77
ci_029                -1.477979e-02 3 1  ON 78
ci_030                -1.119869e-02 3 1  ON 79
ci_031                -1.147594e-02 3 1  ON 80
ci_032                -1.353510e-02 3 1  ON 81
ci_033                 1.084522e-02 3 1  ON 82
ci_034                 1.028247e-02 3 1  ON 83
ci_035                -4.688646e-03 3 1  ON 84
ci_036                -1.036051e-02 3 1  ON 85
ci_037                -1.002293e-02 3 1  ON 86
ci_038                 1.583827e-03 3 1  ON 87
ci_039                 1.483456e-03 3 1  ON 88
ci_040                -4.170186e-03 3 1  ON 89
ci_041                 9.850131e-03 3 1  ON 90
ci_042                 1.014641e-02 3 1  ON 91
ci_043                -3.083328e-03 3 1  ON 92
ci_044                -1.569596e-02 3 1  ON 93
ci_045                -1.746836e-03 3 1  ON 94
ci_046                 5.500406e-03 3 1  ON 95
ci_047                 5.693172e-03 3 1  ON 96
ci_048                -1.194883e-02 3 1  ON 97
ci_049                -1.191350e-02 3 1  ON 98
ci_050                 7.404669e-03 3 1  ON 99
ci_051                 7.649814e-03 3 1  ON 100
ci_052                -6.651468e-03 3 1  ON 101
ci_053                -6.585031e-03 3 1  ON 102
ci_054                -3.294288e-03 3 1  ON 103
ci_055                -3.197702e-03 3 1  ON 104
ci_056                 5.120400e-03 3 1  ON 105
ci_057                 4.372924e-03 3 1  ON 106
ci_058                -6.801399e-03 3 1  ON 107
ci_059                -6.444636e-03 3 1  ON 108
ci_060                 8.329366e-03 3 1  ON 109
ci_061                 8.482190e-03 3 1  ON 110
ci_062                -3.028775e-03 3 1  ON 111
ci_063                -3.165729e-03 3 1  ON 112
ci_064                -2.916514e-03 3 1  ON 113
ci_065                -4.033106e-03 3 1  ON 114
ci_066                 5.782463e-03 3 1  ON 115
ci_067                 5.925063e-03 3 1  ON 116
ci_068                -4.948019e-03 3 1  ON 117
ci_069                -4.627829e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6730e+01 secs
  Total Execution time = 5.7117e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
