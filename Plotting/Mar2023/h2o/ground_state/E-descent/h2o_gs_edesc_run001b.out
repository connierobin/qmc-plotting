Rank =    0  Free Memory = 44010 MB
Rank =    1  Free Memory = 44009 MB
Rank =    2  Free Memory = 44002 MB
Rank =    3  Free Memory = 44002 MB
Rank =    4  Free Memory = 44002 MB
Rank =    5  Free Memory = 44002 MB
Rank =    6  Free Memory = 44001 MB
Rank =    7  Free Memory = 44001 MB
Rank =    8  Free Memory = 44001 MB
Rank =    9  Free Memory = 44001 MB
Rank =   10  Free Memory = 44001 MB
Rank =   11  Free Memory = 44001 MB
Rank =   12  Free Memory = 44001 MB
Rank =   13  Free Memory = 44001 MB
Rank =   14  Free Memory = 44001 MB
Rank =   15  Free Memory = 43995 MB
Rank =   16  Free Memory = 43992 MB
Rank =   17  Free Memory = 43992 MB
Rank =   18  Free Memory = 43992 MB
Rank =   19  Free Memory = 43992 MB
Rank =   20  Free Memory = 43992 MB
Rank =   21  Free Memory = 43992 MB
Rank =   22  Free Memory = 43992 MB
Rank =   23  Free Memory = 43992 MB
Rank =   24  Free Memory = 43992 MB
Rank =   25  Free Memory = 43992 MB
Rank =   26  Free Memory = 43992 MB
Rank =   27  Free Memory = 43992 MB
Rank =   28  Free Memory = 43992 MB
Rank =   29  Free Memory = 43992 MB
Rank =   30  Free Memory = 43992 MB
Rank =   31  Free Memory = 43992 MB
Rank =   32  Free Memory = 79703 MB
Rank =   33  Free Memory = 79703 MB
Rank =   34  Free Memory = 79702 MB
Rank =   35  Free Memory = 79702 MB
Rank =   36  Free Memory = 79702 MB
Rank =   37  Free Memory = 79702 MB
Rank =   38  Free Memory = 79702 MB
Rank =   39  Free Memory = 79702 MB
Rank =   40  Free Memory = 79702 MB
Rank =   41  Free Memory = 79702 MB
Rank =   42  Free Memory = 79702 MB
Rank =   43  Free Memory = 79701 MB
Rank =   44  Free Memory = 79701 MB
Rank =   45  Free Memory = 79701 MB
Rank =   46  Free Memory = 79701 MB
Rank =   47  Free Memory = 79701 MB
Rank =   48  Free Memory = 79701 MB
Rank =   49  Free Memory = 79701 MB
Rank =   50  Free Memory = 79701 MB
Rank =   51  Free Memory = 79701 MB
Rank =   52  Free Memory = 79701 MB
Rank =   53  Free Memory = 79701 MB
Rank =   54  Free Memory = 79701 MB
Rank =   55  Free Memory = 79701 MB
Rank =   56  Free Memory = 79701 MB
Rank =   57  Free Memory = 79701 MB
Rank =   58  Free Memory = 79701 MB
Rank =   59  Free Memory = 79701 MB
Rank =   60  Free Memory = 79701 MB
Rank =   61  Free Memory = 79701 MB
Rank =   62  Free Memory = 79701 MB
Rank =   63  Free Memory = 79701 MB
Rank =   64  Free Memory = 60702 MB
Rank =   65  Free Memory = 60702 MB
Rank =   66  Free Memory = 60702 MB
Rank =   67  Free Memory = 60702 MB
Rank =   68  Free Memory = 60702 MB
Rank =   69  Free Memory = 60702 MB
Rank =   70  Free Memory = 60702 MB
Rank =   71  Free Memory = 60702 MB
Rank =   72  Free Memory = 60702 MB
Rank =   73  Free Memory = 60702 MB
Rank =   74  Free Memory = 60702 MB
Rank =   75  Free Memory = 60702 MB
Rank =   76  Free Memory = 60702 MB
Rank =   77  Free Memory = 60702 MB
Rank =   78  Free Memory = 60702 MB
Rank =   79  Free Memory = 60702 MB
Rank =   80  Free Memory = 60702 MB
Rank =   81  Free Memory = 60702 MB
Rank =   82  Free Memory = 60702 MB
Rank =   83  Free Memory = 60702 MB
Rank =   84  Free Memory = 60702 MB
Rank =   85  Free Memory = 60702 MB
Rank =   86  Free Memory = 60702 MB
Rank =   87  Free Memory = 60702 MB
Rank =   88  Free Memory = 60702 MB
Rank =   89  Free Memory = 60702 MB
Rank =   90  Free Memory = 60702 MB
Rank =   91  Free Memory = 60702 MB
Rank =   92  Free Memory = 60702 MB
Rank =   93  Free Memory = 60702 MB
Rank =   94  Free Memory = 60702 MB
Rank =   95  Free Memory = 60702 MB
Rank =   96  Free Memory = 65332 MB
Rank =   97  Free Memory = 65332 MB
Rank =   98  Free Memory = 65332 MB
Rank =   99  Free Memory = 65332 MB
Rank =  100  Free Memory = 65332 MB
Rank =  101  Free Memory = 65332 MB
Rank =  102  Free Memory = 65332 MB
Rank =  103  Free Memory = 65332 MB
Rank =  104  Free Memory = 65332 MB
Rank =  105  Free Memory = 65332 MB
Rank =  106  Free Memory = 65332 MB
Rank =  107  Free Memory = 65332 MB
Rank =  108  Free Memory = 65332 MB
Rank =  109  Free Memory = 65332 MB
Rank =  110  Free Memory = 65332 MB
Rank =  111  Free Memory = 65332 MB
Rank =  112  Free Memory = 65332 MB
Rank =  113  Free Memory = 65332 MB
Rank =  114  Free Memory = 65332 MB
Rank =  115  Free Memory = 65332 MB
Rank =  116  Free Memory = 65332 MB
Rank =  117  Free Memory = 65332 MB
Rank =  118  Free Memory = 65332 MB
Rank =  119  Free Memory = 65332 MB
Rank =  120  Free Memory = 65332 MB
Rank =  121  Free Memory = 65332 MB
Rank =  122  Free Memory = 65332 MB
Rank =  123  Free Memory = 65332 MB
Rank =  124  Free Memory = 65332 MB
Rank =  125  Free Memory = 65332 MB
Rank =  126  Free Memory = 65332 MB
Rank =  127  Free Memory = 65332 MB
  Input file(s): opt_h2o_gs_edesc_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_edesc_run001b.xml

  Project = H2O
  date    = 2023-03-02 15:37:11 PST
  host    = n0046.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 807

  Range of prime numbers to use as seeds over processors and threads = 6217-7351


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.920054e-01    1         1  ON     0
     uu_1                 3.590195e-02    1         1  ON     1
     uu_2                -4.559320e-02    1         1  ON     2
     uu_3                -9.369633e-02    1         1  ON     3
     uu_4                -1.254424e-01    1         1  ON     4
     uu_5                -1.327025e-01    1         1  ON     5
     uu_6                -1.091659e-01    1         1  ON     6
     uu_7                -3.320891e-02    1         1  ON     7
     uu_8                 1.030981e-01    1         1  ON     8
     uu_9                 1.188130e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.150780e-01    1         1  ON     0
     ud_1                 7.590189e-02    1         1  ON     1
     ud_2                -7.338664e-03    1         1  ON     2
     ud_3                -5.544926e-02    1         1  ON     3
     ud_4                -1.064782e-01    1         1  ON     4
     ud_5                -1.490405e-01    1         1  ON     5
     ud_6                -1.574171e-01    1         1  ON     6
     ud_7                -1.077761e-01    1         1  ON     7
     ud_8                 9.772284e-03    1         1  ON     8
     ud_9                 9.249491e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.811694e-01    1         1  ON     0
     eO_1                -4.031104e-01    1         1  ON     1
     eO_2                -6.148616e-02    1         1  ON     2
     eO_3                 1.622033e-01    1         1  ON     3
     eO_4                 2.643764e-01    1         1  ON     4
     eO_5                 3.070668e-01    1         1  ON     5
     eO_6                 2.482256e-01    1         1  ON     6
     eO_7                 1.081366e-01    1         1  ON     7
     eO_8                 2.727328e-02    1         1  ON     8
     eO_9                 1.812982e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.758229e-01    1         1  ON     0
     eH1_1                -9.847470e-02    1         1  ON     1
     eH1_2                -6.212571e-02    1         1  ON     2
     eH1_3                -2.890051e-02    1         1  ON     3
     eH1_4                 1.766763e-02    1         1  ON     4
     eH1_5                 3.105966e-02    1         1  ON     5
     eH1_6                 7.793809e-02    1         1  ON     6
     eH1_7                 1.115220e-01    1         1  ON     7
     eH1_8                 8.853209e-02    1         1  ON     8
     eH1_9                 2.358450e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.775251e-01    1         1  ON     0
     eH2_1                -1.001865e-01    1         1  ON     1
     eH2_2                -6.424989e-02    1         1  ON     2
     eH2_3                -3.037191e-02    1         1  ON     3
     eH2_4                 1.621523e-02    1         1  ON     4
     eH2_5                 3.146665e-02    1         1  ON     5
     eH2_6                 8.031567e-02    1         1  ON     6
     eH2_7                 1.152651e-01    1         1  ON     7
     eH2_8                 9.158550e-02    1         1  ON     8
     eH2_9                 2.561491e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.728531e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.7544e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2062
    reference variance = 0.372457
====================================================
  Execution time = 3.4919e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1088e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311005378931
                                         uncertainty =       0.004446390652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311005378931
                                         uncertainty =       0.004446390652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394257682
  error estimate for blocks of size 2^( 2) =       0.000405761941
  error estimate for blocks of size 2^( 3) =       0.000416210347
  error estimate for blocks of size 2^( 4) =       0.000423278626
  error estimate for blocks of size 2^( 5) =       0.000427699663
  error estimate for blocks of size 2^( 6) =       0.000429556953
  error estimate for blocks of size 2^( 7) =       0.000431990735

      target function =                  N/A
              le_mean =     -17.215012391015
             les_mean =     296.667529706772
             stat err =       0.000428131494
             autocorr =       1.179217795495
              std dev =       0.557564560770
             le_variance =       0.310878239427


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721501239101e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215012391015       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215294067015       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215432230002       residual = 9.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215616195152       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215756880686       residual = 9.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215802508212       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215821725852       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215841482916       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215842039502       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215842278758       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215842674715       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215842404206       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215842512213       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.766419e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215012391015       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215135234448       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215192713292       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215269361476       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215330228933       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215344626284       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215347372252       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215350378233       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215350265965       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215350133097       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215350110638       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.706563e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215012391015       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215050124275       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215067915335       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215091896831       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215109833459       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215113545974       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215114327930       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215114711812       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215114656537       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215114644079       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215114629682       residual = 1.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.580733e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177240 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3652e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.927989e-01                 1 1 ON  0
uu_1  3.718281e-02                 1 1 ON  1
uu_2  -4.653371e-02                1 1 ON  2
uu_3  -9.445664e-02                1 1 ON  3
uu_4  -1.253191e-01                1 1 ON  4
uu_5  -1.326900e-01                1 1 ON  5
uu_6  -1.094175e-01                1 1 ON  6
uu_7  -3.347891e-02                1 1 ON  7
uu_8  1.029974e-01                 1 1 ON  8
uu_9  1.188659e-01                 1 1 ON  9
ud_0  3.200060e-01                 1 1 ON  10
ud_1  7.793654e-02                 1 1 ON  11
ud_2  -1.013508e-02                1 1 ON  12
ud_3  -5.817846e-02                1 1 ON  13
ud_4  -1.072481e-01                1 1 ON  14
ud_5  -1.487352e-01                1 1 ON  15
ud_6  -1.577733e-01                1 1 ON  16
ud_7  -1.081891e-01                1 1 ON  17
ud_8  9.550512e-03                 1 1 ON  18
ud_9  9.247495e-02                 1 1 ON  19
eO_0  -6.868760e-01                1 1 ON  20
eO_1  -4.051637e-01                1 1 ON  21
eO_2  -5.619917e-02                1 1 ON  22
eO_3  1.651898e-01                 1 1 ON  23
eO_4  2.643390e-01                 1 1 ON  24
eO_5  3.065290e-01                 1 1 ON  25
eO_6  2.481639e-01                 1 1 ON  26
eO_7  1.082312e-01                 1 1 ON  27
eO_8  2.729411e-02                 1 1 ON  28
eO_9  1.813593e-02                 1 1 ON  29
eH1_0 -1.760256e-01                1 1 ON  30
eH1_1 -9.852985e-02                1 1 ON  31
eH1_2 -6.247915e-02                1 1 ON  32
eH1_3 -2.837128e-02                1 1 ON  33
eH1_4 1.799380e-02                 1 1 ON  34
eH1_5 3.110162e-02                 1 1 ON  35
eH1_6 7.768973e-02                 1 1 ON  36
eH1_7 1.114044e-01                 1 1 ON  37
eH1_8 8.858607e-02                 1 1 ON  38
eH1_9 2.360712e-02                 1 1 ON  39
eH2_0 -1.777613e-01                1 1 ON  40
eH2_1 -1.001706e-01                1 1 ON  41
eH2_2 -6.448514e-02                1 1 ON  42
eH2_3 -2.995091e-02                1 1 ON  43
eH2_4 1.657125e-02                 1 1 ON  44
eH2_5 3.148866e-02                 1 1 ON  45
eH2_6 8.005138e-02                 1 1 ON  46
eH2_7 1.151266e-01                 1 1 ON  47
eH2_8 9.162344e-02                 1 1 ON  48
eH2_9 2.563036e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1436
    reference variance = 0.248537
====================================================
  Execution time = 3.1259e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0197e-01
  Total weights = 2.0000e+06
  Execution time = 2.9009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300472968052
                                         uncertainty =       0.003033571545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300472968052
                                         uncertainty =       0.003033571545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387769368
  error estimate for blocks of size 2^( 2) =       0.000399060896
  error estimate for blocks of size 2^( 3) =       0.000409231136
  error estimate for blocks of size 2^( 4) =       0.000417122451
  error estimate for blocks of size 2^( 5) =       0.000421443172
  error estimate for blocks of size 2^( 6) =       0.000423408317
  error estimate for blocks of size 2^( 7) =       0.000426687639

      target function =                  N/A
              le_mean =     -17.215204653462
             les_mean =     296.664001275222
             stat err =       0.000422165395
             autocorr =       1.185272654730
              std dev =       0.548388698825
             le_variance =       0.300730164999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305614050206
                                         uncertainty =       0.003143966640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305614050206
                                         uncertainty =       0.003143966640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391080257
  error estimate for blocks of size 2^( 2) =       0.000401255281
  error estimate for blocks of size 2^( 3) =       0.000410431934
  error estimate for blocks of size 2^( 4) =       0.000417770992
  error estimate for blocks of size 2^( 5) =       0.000421909543
  error estimate for blocks of size 2^( 6) =       0.000423803815
  error estimate for blocks of size 2^( 7) =       0.000426926907

      target function =                  N/A
              le_mean =     -17.215243502486
             les_mean =     296.670496231658
             stat err =       0.000422602814
             autocorr =       1.167704585688
              std dev =       0.553071003310
             le_variance =       0.305887534702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304153097425
                                         uncertainty =       0.003113975251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304153097425
                                         uncertainty =       0.003113975251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390143253
  error estimate for blocks of size 2^( 2) =       0.000400523537
  error estimate for blocks of size 2^( 3) =       0.000409885200
  error estimate for blocks of size 2^( 4) =       0.000417339129
  error estimate for blocks of size 2^( 5) =       0.000421515474
  error estimate for blocks of size 2^( 6) =       0.000423434447
  error estimate for blocks of size 2^( 7) =       0.000426560670

      target function =                  N/A
              le_mean =     -17.215168241343
             les_mean =     296.666440940732
             stat err =       0.000422212430
             autocorr =       1.171153521724
              std dev =       0.551745879172
             le_variance =       0.304423515183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300685266662
                                         uncertainty =       0.003044345536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300685266662
                                         uncertainty =       0.003044345536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387907477
  error estimate for blocks of size 2^( 2) =       0.000399044929
  error estimate for blocks of size 2^( 3) =       0.000409083018
  error estimate for blocks of size 2^( 4) =       0.000416905102
  error estimate for blocks of size 2^( 5) =       0.000421202088
  error estimate for blocks of size 2^( 6) =       0.000423159293
  error estimate for blocks of size 2^( 7) =       0.000426412455

      target function =                  N/A
              le_mean =     -17.215152779298
             les_mean =     296.662429486087
             stat err =       0.000421919735
             autocorr =       1.183050752049
              std dev =       0.548584015430
             le_variance =       0.300944421986


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215204653462        initial
     2.5000e-01     2.5000e+00             1.7664e-02       -17.215243502486  <--
     1.0000e+00     1.0000e+01             5.7066e-03       -17.215168241343
     4.0000e+00     4.0000e+01             1.5807e-03       -17.215152779298

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.5930e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.951418e-01 1 1  ON 0
 uu_1                 3.896849e-02 1 1  ON 1
 uu_2                -4.760769e-02 1 1  ON 2
 uu_3                -9.608512e-02 1 1  ON 3
 uu_4                -1.259043e-01 1 1  ON 4
 uu_5                -1.326938e-01 1 1  ON 5
 uu_6                -1.097443e-01 1 1  ON 6
 uu_7                -3.409103e-02 1 1  ON 7
 uu_8                 1.027432e-01 1 1  ON 8
 uu_9                 1.190378e-01 1 1  ON 9
 ud_0                 3.277863e-01 1 1  ON 10
 ud_1                 8.085847e-02 1 1  ON 11
 ud_2                -1.317375e-02 1 1  ON 12
 ud_3                -6.298735e-02 1 1  ON 13
 ud_4                -1.095267e-01 1 1  ON 14
 ud_5                -1.480972e-01 1 1  ON 15
 ud_6                -1.577516e-01 1 1  ON 16
 ud_7                -1.089431e-01 1 1  ON 17
 ud_8                 8.987363e-03 1 1  ON 18
 ud_9                 9.243513e-02 1 1  ON 19
 eO_0                -6.988336e-01 1 1  ON 20
 eO_1                -4.094274e-01 1 1  ON 21
 eO_2                -4.834109e-02 1 1  ON 22
 eO_3                 1.728529e-01 1 1  ON 23
 eO_4                 2.656666e-01 1 1  ON 24
 eO_5                 3.055329e-01 1 1  ON 25
 eO_6                 2.481179e-01 1 1  ON 26
 eO_7                 1.085501e-01 1 1  ON 27
 eO_8                 2.736434e-02 1 1  ON 28
 eO_9                 1.815560e-02 1 1  ON 29
eH1_0                -1.767407e-01 1 1  ON 30
eH1_1                -9.908044e-02 1 1  ON 31
eH1_2                -6.267210e-02 1 1  ON 32
eH1_3                -2.767574e-02 1 1  ON 33
eH1_4                 1.855785e-02 1 1  ON 34
eH1_5                 3.168317e-02 1 1  ON 35
eH1_6                 7.730263e-02 1 1  ON 36
eH1_7                 1.111431e-01 1 1  ON 37
eH1_8                 8.876784e-02 1 1  ON 38
eH1_9                 2.368005e-02 1 1  ON 39
eH2_0                -1.785085e-01 1 1  ON 40
eH2_1                -1.005798e-01 1 1  ON 41
eH2_2                -6.449557e-02 1 1  ON 42
eH2_3                -2.935509e-02 1 1  ON 43
eH2_4                 1.718055e-02 1 1  ON 44
eH2_5                 3.201726e-02 1 1  ON 45
eH2_6                 7.961234e-02 1 1  ON 46
eH2_7                 1.147982e-01 1 1  ON 47
eH2_8                 9.175506e-02 1 1  ON 48
eH2_9                 2.568065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9590e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7175e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.261
    reference variance = 0.455929
====================================================
  Execution time = 3.2061e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0754e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307572810703
                                         uncertainty =       0.003033040012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307572810703
                                         uncertainty =       0.003033040012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392136301
  error estimate for blocks of size 2^( 2) =       0.000402739724
  error estimate for blocks of size 2^( 3) =       0.000412106659
  error estimate for blocks of size 2^( 4) =       0.000419393705
  error estimate for blocks of size 2^( 5) =       0.000422636200
  error estimate for blocks of size 2^( 6) =       0.000426158874
  error estimate for blocks of size 2^( 7) =       0.000429490354

      target function =                  N/A
              le_mean =     -17.215094916051
             les_mean =     296.667034571446
             stat err =       0.000424419783
             autocorr =       1.171432161966
              std dev =       0.554564474681
             le_variance =       0.307541756578


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721509491605e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215094916051       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215183080632       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215282890097       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215359531009       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215419941578       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215496295163       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215529074845       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215546211676       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215558085672       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215564195835       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215561594006       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215564335215       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215566417331       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215567246346       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215567341235       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215567007089       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215566914318       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.917494e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215094916051       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215152643335       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215210121865       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215259583423       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215293266502       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215325746458       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215332132555       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215338269037       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215340802527       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215340939353       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215340383641       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215340313557       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215340509237       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.189266e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215094916051       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215119161575       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215141546757       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215162354215       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215174580487       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215183086879       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215183312007       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215185018263       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215185350294       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215185317638       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215185305398       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.725110e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183855 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0529e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.978814e-01 1 1  ON 0
 uu_1                 4.054130e-02 1 1  ON 1
 uu_2                -4.844101e-02 1 1  ON 2
 uu_3                -9.757866e-02 1 1  ON 3
 uu_4                -1.271221e-01 1 1  ON 4
 uu_5                -1.326148e-01 1 1  ON 5
 uu_6                -1.104272e-01 1 1  ON 6
 uu_7                -3.470744e-02 1 1  ON 7
 uu_8                 1.025317e-01 1 1  ON 8
 uu_9                 1.192887e-01 1 1  ON 9
 ud_0                 3.339319e-01 1 1  ON 10
 ud_1                 8.332723e-02 1 1  ON 11
 ud_2                -1.520997e-02 1 1  ON 12
 ud_3                -6.706802e-02 1 1  ON 13
 ud_4                -1.122879e-01 1 1  ON 14
 ud_5                -1.479716e-01 1 1  ON 15
 ud_6                -1.571633e-01 1 1  ON 16
 ud_7                -1.093288e-01 1 1  ON 17
 ud_8                 8.523150e-03 1 1  ON 18
 ud_9                 9.248315e-02 1 1  ON 19
 eO_0                -7.107262e-01 1 1  ON 20
 eO_1                -4.140465e-01 1 1  ON 21
 eO_2                -4.241482e-02 1 1  ON 22
 eO_3                 1.810939e-01 1 1  ON 23
 eO_4                 2.679130e-01 1 1  ON 24
 eO_5                 3.048425e-01 1 1  ON 25
 eO_6                 2.482345e-01 1 1  ON 26
 eO_7                 1.090412e-01 1 1  ON 27
 eO_8                 2.745981e-02 1 1  ON 28
 eO_9                 1.819349e-02 1 1  ON 29
eH1_0                -1.778258e-01 1 1  ON 30
eH1_1                -9.962948e-02 1 1  ON 31
eH1_2                -6.270077e-02 1 1  ON 32
eH1_3                -2.754613e-02 1 1  ON 33
eH1_4                 1.913954e-02 1 1  ON 34
eH1_5                 3.277184e-02 1 1  ON 35
eH1_6                 7.701311e-02 1 1  ON 36
eH1_7                 1.108592e-01 1 1  ON 37
eH1_8                 8.905411e-02 1 1  ON 38
eH1_9                 2.378024e-02 1 1  ON 39
eH2_0                -1.797460e-01 1 1  ON 40
eH2_1                -1.013901e-01 1 1  ON 41
eH2_2                -6.447363e-02 1 1  ON 42
eH2_3                -2.892306e-02 1 1  ON 43
eH2_4                 1.789775e-02 1 1  ON 44
eH2_5                 3.307209e-02 1 1  ON 45
eH2_6                 7.905802e-02 1 1  ON 46
eH2_7                 1.146127e-01 1 1  ON 47
eH2_8                 9.212480e-02 1 1  ON 48
eH2_9                 2.582823e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1806
    reference variance = 0.222371
====================================================
  Execution time = 3.1666e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1393e-01
  Total weights = 2.0000e+06
  Execution time = 2.8892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309563566531
                                         uncertainty =       0.004904224483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309563566531
                                         uncertainty =       0.004904224483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393388869
  error estimate for blocks of size 2^( 2) =       0.000404043657
  error estimate for blocks of size 2^( 3) =       0.000413226600
  error estimate for blocks of size 2^( 4) =       0.000420493257
  error estimate for blocks of size 2^( 5) =       0.000424562642
  error estimate for blocks of size 2^( 6) =       0.000427544662
  error estimate for blocks of size 2^( 7) =       0.000429874595

      target function =                  N/A
              le_mean =     -17.215196900232
             les_mean =     296.672513764166
             stat err =       0.000425618789
             autocorr =       1.170570156877
              std dev =       0.556335874416
             le_variance =       0.309509605163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318463086939
                                         uncertainty =       0.005065765336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318463086939
                                         uncertainty =       0.005065765336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399003757
  error estimate for blocks of size 2^( 2) =       0.000408920554
  error estimate for blocks of size 2^( 3) =       0.000417480770
  error estimate for blocks of size 2^( 4) =       0.000424257019
  error estimate for blocks of size 2^( 5) =       0.000428040054
  error estimate for blocks of size 2^( 6) =       0.000430862749
  error estimate for blocks of size 2^( 7) =       0.000433108786

      target function =                  N/A
              le_mean =     -17.215135325929
             les_mean =     296.679292127631
             stat err =       0.000429067152
             autocorr =       1.156369330751
              std dev =       0.564276525117
             le_variance =       0.318407996798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319631302259
                                         uncertainty =       0.005087113406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319631302259
                                         uncertainty =       0.005087113406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399735147
  error estimate for blocks of size 2^( 2) =       0.000409631501
  error estimate for blocks of size 2^( 3) =       0.000418200815
  error estimate for blocks of size 2^( 4) =       0.000424969646
  error estimate for blocks of size 2^( 5) =       0.000428765881
  error estimate for blocks of size 2^( 6) =       0.000431597518
  error estimate for blocks of size 2^( 7) =       0.000433851783

      target function =                  N/A
              le_mean =     -17.215165449870
             les_mean =     296.681497682203
             stat err =       0.000429796207
             autocorr =       1.156060295963
              std dev =       0.565310866339
             le_variance =       0.319576375601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311152525621
                                         uncertainty =       0.004940979092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311152525621
                                         uncertainty =       0.004940979092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394397257
  error estimate for blocks of size 2^( 2) =       0.000404879182
  error estimate for blocks of size 2^( 3) =       0.000413930305
  error estimate for blocks of size 2^( 4) =       0.000421092880
  error estimate for blocks of size 2^( 5) =       0.000425110209
  error estimate for blocks of size 2^( 6) =       0.000428066709
  error estimate for blocks of size 2^( 7) =       0.000430388442

      target function =                  N/A
              le_mean =     -17.215132667362
             les_mean =     296.671890991839
             stat err =       0.000426164560
             autocorr =       1.167580655005
              std dev =       0.557761949672
             le_variance =       0.311098392502


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215196900232        initial  <--
     6.2500e-02     6.2500e-01             2.9175e-02       -17.215135325929
     2.5000e-01     2.5000e+00             1.1893e-02       -17.215165449870
     1.0000e+00     1.0000e+01             3.7251e-03       -17.215132667362

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.2635
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.951418e-01 1 1  ON 0
 uu_1                 3.896849e-02 1 1  ON 1
 uu_2                -4.760769e-02 1 1  ON 2
 uu_3                -9.608512e-02 1 1  ON 3
 uu_4                -1.259043e-01 1 1  ON 4
 uu_5                -1.326938e-01 1 1  ON 5
 uu_6                -1.097443e-01 1 1  ON 6
 uu_7                -3.409103e-02 1 1  ON 7
 uu_8                 1.027432e-01 1 1  ON 8
 uu_9                 1.190378e-01 1 1  ON 9
 ud_0                 3.277863e-01 1 1  ON 10
 ud_1                 8.085847e-02 1 1  ON 11
 ud_2                -1.317375e-02 1 1  ON 12
 ud_3                -6.298735e-02 1 1  ON 13
 ud_4                -1.095267e-01 1 1  ON 14
 ud_5                -1.480972e-01 1 1  ON 15
 ud_6                -1.577516e-01 1 1  ON 16
 ud_7                -1.089431e-01 1 1  ON 17
 ud_8                 8.987363e-03 1 1  ON 18
 ud_9                 9.243513e-02 1 1  ON 19
 eO_0                -6.988336e-01 1 1  ON 20
 eO_1                -4.094274e-01 1 1  ON 21
 eO_2                -4.834109e-02 1 1  ON 22
 eO_3                 1.728529e-01 1 1  ON 23
 eO_4                 2.656666e-01 1 1  ON 24
 eO_5                 3.055329e-01 1 1  ON 25
 eO_6                 2.481179e-01 1 1  ON 26
 eO_7                 1.085501e-01 1 1  ON 27
 eO_8                 2.736434e-02 1 1  ON 28
 eO_9                 1.815560e-02 1 1  ON 29
eH1_0                -1.767407e-01 1 1  ON 30
eH1_1                -9.908044e-02 1 1  ON 31
eH1_2                -6.267210e-02 1 1  ON 32
eH1_3                -2.767574e-02 1 1  ON 33
eH1_4                 1.855785e-02 1 1  ON 34
eH1_5                 3.168317e-02 1 1  ON 35
eH1_6                 7.730263e-02 1 1  ON 36
eH1_7                 1.111431e-01 1 1  ON 37
eH1_8                 8.876784e-02 1 1  ON 38
eH1_9                 2.368005e-02 1 1  ON 39
eH2_0                -1.785085e-01 1 1  ON 40
eH2_1                -1.005798e-01 1 1  ON 41
eH2_2                -6.449557e-02 1 1  ON 42
eH2_3                -2.935509e-02 1 1  ON 43
eH2_4                 1.718055e-02 1 1  ON 44
eH2_5                 3.201726e-02 1 1  ON 45
eH2_6                 7.961234e-02 1 1  ON 46
eH2_7                 1.147982e-01 1 1  ON 47
eH2_8                 9.175506e-02 1 1  ON 48
eH2_9                 2.568065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6799e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1435
    reference variance = 0.174355
====================================================
  Execution time = 3.1859e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1253e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312618284309
                                         uncertainty =       0.004683973430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312618284309
                                         uncertainty =       0.004683973430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395301890
  error estimate for blocks of size 2^( 2) =       0.000406299065
  error estimate for blocks of size 2^( 3) =       0.000415084488
  error estimate for blocks of size 2^( 4) =       0.000421554836
  error estimate for blocks of size 2^( 5) =       0.000425720886
  error estimate for blocks of size 2^( 6) =       0.000427795378
  error estimate for blocks of size 2^( 7) =       0.000427806326

      target function =                  N/A
              le_mean =     -17.215241155717
             les_mean =     296.677055062117
             stat err =       0.000425719357
             autocorr =       1.159815776920
              std dev =       0.559041294441
             le_variance =       0.312527168890


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721524115572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215241155717       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215274829118       residual = 4.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215306841613       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215332542216       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215357905329       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215373445141       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215376712157       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215375471431       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215375562933       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215375449910       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215375519786       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.781403e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215241155717       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215252110948       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215262478346       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215270616512       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215278266687       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215282490528       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215282807253       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215282651480       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215282662429       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215282626928       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215282622874       residual = 6.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.625796e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215241155717       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215244117670       residual = 5.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215246932327       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215249131320       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215251132920       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215252193339       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215252243286       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215252228331       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215252232318       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215252223689       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 4.200829e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187897 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0564e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.954675e-01 1 1  ON 0
 uu_1                 3.922946e-02 1 1  ON 1
 uu_2                -4.778771e-02 1 1  ON 2
 uu_3                -9.629339e-02 1 1  ON 3
 uu_4                -1.259534e-01 1 1  ON 4
 uu_5                -1.326782e-01 1 1  ON 5
 uu_6                -1.098247e-01 1 1  ON 6
 uu_7                -3.418578e-02 1 1  ON 7
 uu_8                 1.027018e-01 1 1  ON 8
 uu_9                 1.190620e-01 1 1  ON 9
 ud_0                 3.288783e-01 1 1  ON 10
 ud_1                 8.126220e-02 1 1  ON 11
 ud_2                -1.362325e-02 1 1  ON 12
 ud_3                -6.366562e-02 1 1  ON 13
 ud_4                -1.098235e-01 1 1  ON 14
 ud_5                -1.480360e-01 1 1  ON 15
 ud_6                -1.577548e-01 1 1  ON 16
 ud_7                -1.090106e-01 1 1  ON 17
 ud_8                 8.923423e-03 1 1  ON 18
 ud_9                 9.242541e-02 1 1  ON 19
 eO_0                -7.004594e-01 1 1  ON 20
 eO_1                -4.100127e-01 1 1  ON 21
 eO_2                -4.722745e-02 1 1  ON 22
 eO_3                 1.738492e-01 1 1  ON 23
 eO_4                 2.658417e-01 1 1  ON 24
 eO_5                 3.054080e-01 1 1  ON 25
 eO_6                 2.481101e-01 1 1  ON 26
 eO_7                 1.085968e-01 1 1  ON 27
 eO_8                 2.737296e-02 1 1  ON 28
 eO_9                 1.815820e-02 1 1  ON 29
eH1_0                -1.768585e-01 1 1  ON 30
eH1_1                -9.913364e-02 1 1  ON 31
eH1_2                -6.270324e-02 1 1  ON 32
eH1_3                -2.757035e-02 1 1  ON 33
eH1_4                 1.864896e-02 1 1  ON 34
eH1_5                 3.173986e-02 1 1  ON 35
eH1_6                 7.724315e-02 1 1  ON 36
eH1_7                 1.111165e-01 1 1  ON 37
eH1_8                 8.879353e-02 1 1  ON 38
eH1_9                 2.368772e-02 1 1  ON 39
eH2_0                -1.785988e-01 1 1  ON 40
eH2_1                -1.006163e-01 1 1  ON 41
eH2_2                -6.449258e-02 1 1  ON 42
eH2_3                -2.924482e-02 1 1  ON 43
eH2_4                 1.725459e-02 1 1  ON 44
eH2_5                 3.204144e-02 1 1  ON 45
eH2_6                 7.953056e-02 1 1  ON 46
eH2_7                 1.147638e-01 1 1  ON 47
eH2_8                 9.177702e-02 1 1  ON 48
eH2_9                 2.568808e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1766
    reference variance = 0.236812
====================================================
  Execution time = 3.1214e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1133e-01
  Total weights = 2.0000e+06
  Execution time = 2.8981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310447578384
                                         uncertainty =       0.002831559038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310447578384
                                         uncertainty =       0.002831559038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394077846
  error estimate for blocks of size 2^( 2) =       0.000404510146
  error estimate for blocks of size 2^( 3) =       0.000413800203
  error estimate for blocks of size 2^( 4) =       0.000420460498
  error estimate for blocks of size 2^( 5) =       0.000425582362
  error estimate for blocks of size 2^( 6) =       0.000428861809
  error estimate for blocks of size 2^( 7) =       0.000429994022

      target function =                  N/A
              le_mean =     -17.215762564697
             les_mean =     296.693075226716
             stat err =       0.000426224673
             autocorr =       1.169804073839
              std dev =       0.557310234963
             le_variance =       0.310594697995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312878873914
                                         uncertainty =       0.002854446188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312878873914
                                         uncertainty =       0.002854446188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395617680
  error estimate for blocks of size 2^( 2) =       0.000405823976
  error estimate for blocks of size 2^( 3) =       0.000414912510
  error estimate for blocks of size 2^( 4) =       0.000421419868
  error estimate for blocks of size 2^( 5) =       0.000426462725
  error estimate for blocks of size 2^( 6) =       0.000429715662
  error estimate for blocks of size 2^( 7) =       0.000430893161

      target function =                  N/A
              le_mean =     -17.215782889967
             les_mean =     296.696207055134
             stat err =       0.000427122854
             autocorr =       1.165612607657
              std dev =       0.559487888311
             le_variance =       0.313026697167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311960678493
                                         uncertainty =       0.002846173142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311960678493
                                         uncertainty =       0.002846173142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395036859
  error estimate for blocks of size 2^( 2) =       0.000405324740
  error estimate for blocks of size 2^( 3) =       0.000414487908
  error estimate for blocks of size 2^( 4) =       0.000421051676
  error estimate for blocks of size 2^( 5) =       0.000426122787
  error estimate for blocks of size 2^( 6) =       0.000429381997
  error estimate for blocks of size 2^( 7) =       0.000430542891

      target function =                  N/A
              le_mean =     -17.215769509399
             les_mean =     296.694827884794
             stat err =       0.000426774838
             autocorr =       1.167138440131
              std dev =       0.558666483771
             le_variance =       0.312108240090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310642161147
                                         uncertainty =       0.002833519668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310642161147
                                         uncertainty =       0.002833519668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394201307
  error estimate for blocks of size 2^( 2) =       0.000404613538
  error estimate for blocks of size 2^( 3) =       0.000413886156
  error estimate for blocks of size 2^( 4) =       0.000420533262
  error estimate for blocks of size 2^( 5) =       0.000425648131
  error estimate for blocks of size 2^( 6) =       0.000428924653
  error estimate for blocks of size 2^( 7) =       0.000430060695

      target function =                  N/A
              le_mean =     -17.215762017172
             les_mean =     296.693251017992
             stat err =       0.000426291685
             autocorr =       1.169439081860
              std dev =       0.557484835211
             le_variance =       0.310789341491


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215762564697        initial
     6.2500e-01     6.2500e+00             5.7814e-03       -17.215782889967  <--
     2.5000e+00     2.5000e+01             1.6258e-03       -17.215769509399
     1.0000e+01     1.0000e+02             4.2008e-04       -17.215762017172

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.5893e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.964025e-01 1 1  ON 0
 uu_1                 3.979012e-02 1 1  ON 1
 uu_2                -4.809866e-02 1 1  ON 2
 uu_3                -9.683218e-02 1 1  ON 3
 uu_4                -1.262097e-01 1 1  ON 4
 uu_5                -1.326638e-01 1 1  ON 5
 uu_6                -1.100097e-01 1 1  ON 6
 uu_7                -3.444268e-02 1 1  ON 7
 uu_8                 1.025848e-01 1 1  ON 8
 uu_9                 1.191355e-01 1 1  ON 9
 ud_0                 3.312851e-01 1 1  ON 10
 ud_1                 8.214108e-02 1 1  ON 11
 ud_2                -1.441763e-02 1 1  ON 12
 ud_3                -6.522205e-02 1 1  ON 13
 ud_4                -1.106898e-01 1 1  ON 14
 ud_5                -1.479019e-01 1 1  ON 15
 ud_6                -1.576485e-01 1 1  ON 16
 ud_7                -1.091531e-01 1 1  ON 17
 ud_8                 8.746682e-03 1 1  ON 18
 ud_9                 9.239908e-02 1 1  ON 19
 eO_0                -7.046150e-01 1 1  ON 20
 eO_1                -4.115568e-01 1 1  ON 21
 eO_2                -4.486454e-02 1 1  ON 22
 eO_3                 1.766235e-01 1 1  ON 23
 eO_4                 2.665308e-01 1 1  ON 24
 eO_5                 3.051091e-01 1 1  ON 25
 eO_6                 2.481023e-01 1 1  ON 26
 eO_7                 1.087393e-01 1 1  ON 27
 eO_8                 2.739943e-02 1 1  ON 28
 eO_9                 1.816608e-02 1 1  ON 29
eH1_0                -1.772015e-01 1 1  ON 30
eH1_1                -9.934388e-02 1 1  ON 31
eH1_2                -6.271181e-02 1 1  ON 32
eH1_3                -2.734427e-02 1 1  ON 33
eH1_4                 1.885536e-02 1 1  ON 34
eH1_5                 3.196205e-02 1 1  ON 35
eH1_6                 7.711165e-02 1 1  ON 36
eH1_7                 1.110481e-01 1 1  ON 37
eH1_8                 8.887223e-02 1 1  ON 38
eH1_9                 2.371109e-02 1 1  ON 39
eH2_0                -1.788590e-01 1 1  ON 40
eH2_1                -1.007691e-01 1 1  ON 41
eH2_2                -6.441717e-02 1 1  ON 42
eH2_3                -2.900064e-02 1 1  ON 43
eH2_4                 1.742052e-02 1 1  ON 44
eH2_5                 3.216543e-02 1 1  ON 45
eH2_6                 7.933051e-02 1 1  ON 46
eH2_7                 1.146717e-01 1 1  ON 47
eH2_8                 9.184392e-02 1 1  ON 48
eH2_9                 2.571053e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6463e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7185e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2079
    reference variance = 0.177491
====================================================
  Execution time = 3.1876e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 4.0430e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.8830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.404505457504
                                         uncertainty =       0.091194690588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.404505457504
                                         uncertainty =       0.091194690588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000449612205
  error estimate for blocks of size 2^( 2) =       0.000459052690
  error estimate for blocks of size 2^( 3) =       0.000467168119
  error estimate for blocks of size 2^( 4) =       0.000472817566
  error estimate for blocks of size 2^( 5) =       0.000477638843
  error estimate for blocks of size 2^( 6) =       0.000480138090
  error estimate for blocks of size 2^( 7) =       0.000480134292

      target function =                  N/A
              le_mean =     -17.215267455210
             les_mean =     296.769735621334
             stat err =       0.000477682198
             autocorr =       1.128760828752
              std dev =       0.635847677571
             le_variance =       0.404302269072


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721526745521e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215267455210       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215298939915       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215336274322       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215398687019       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215421597545       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215433117493       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215450228886       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215457619082       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215455290920       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215457829914       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215457257165       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215457311859       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215457012814       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.458466e-02

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215267455210       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215281959143       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215297281122       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215320472933       residual = 8.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215332715802       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215335152170       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215339716584       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215340406104       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215339594535       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215339950413       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215339825496       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.910624e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215267455210       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215272048926       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215276777932       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215283243251       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215286900076       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215287611526       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215288726693       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215288710158       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215288543016       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215288587356       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.371398e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192469 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0768e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.974755e-01 1 1  ON 0
 uu_1                 4.042675e-02 1 1  ON 1
 uu_2                -4.844482e-02 1 1  ON 2
 uu_3                -9.746456e-02 1 1  ON 3
 uu_4                -1.265984e-01 1 1  ON 4
 uu_5                -1.326192e-01 1 1  ON 5
 uu_6                -1.101832e-01 1 1  ON 6
 uu_7                -3.474350e-02 1 1  ON 7
 uu_8                 1.024488e-01 1 1  ON 8
 uu_9                 1.192309e-01 1 1  ON 9
 ud_0                 3.338361e-01 1 1  ON 10
 ud_1                 8.317566e-02 1 1  ON 11
 ud_2                -1.517885e-02 1 1  ON 12
 ud_3                -6.690269e-02 1 1  ON 13
 ud_4                -1.118778e-01 1 1  ON 14
 ud_5                -1.478893e-01 1 1  ON 15
 ud_6                -1.572947e-01 1 1  ON 16
 ud_7                -1.093625e-01 1 1  ON 17
 ud_8                 8.512497e-03 1 1  ON 18
 ud_9                 9.242633e-02 1 1  ON 19
 eO_0                -7.095256e-01 1 1  ON 20
 eO_1                -4.134081e-01 1 1  ON 21
 eO_2                -4.245183e-02 1 1  ON 22
 eO_3                 1.800787e-01 1 1  ON 23
 eO_4                 2.674936e-01 1 1  ON 24
 eO_5                 3.047112e-01 1 1  ON 25
 eO_6                 2.481700e-01 1 1  ON 26
 eO_7                 1.089358e-01 1 1  ON 27
 eO_8                 2.743960e-02 1 1  ON 28
 eO_9                 1.818223e-02 1 1  ON 29
eH1_0                -1.774574e-01 1 1  ON 30
eH1_1                -9.963500e-02 1 1  ON 31
eH1_2                -6.271986e-02 1 1  ON 32
eH1_3                -2.712866e-02 1 1  ON 33
eH1_4                 1.912325e-02 1 1  ON 34
eH1_5                 3.214949e-02 1 1  ON 35
eH1_6                 7.693878e-02 1 1  ON 36
eH1_7                 1.109290e-01 1 1  ON 37
eH1_8                 8.897727e-02 1 1  ON 38
eH1_9                 2.375804e-02 1 1  ON 39
eH2_0                -1.791129e-01 1 1  ON 40
eH2_1                -1.011145e-01 1 1  ON 41
eH2_2                -6.428715e-02 1 1  ON 42
eH2_3                -2.875364e-02 1 1  ON 43
eH2_4                 1.763141e-02 1 1  ON 44
eH2_5                 3.246034e-02 1 1  ON 45
eH2_6                 7.901774e-02 1 1  ON 46
eH2_7                 1.145439e-01 1 1  ON 47
eH2_8                 9.194518e-02 1 1  ON 48
eH2_9                 2.575436e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2261
    reference variance = 0.207557
====================================================
  Execution time = 3.3007e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1915e-01
  Total weights = 2.0000e+06
  Execution time = 2.8817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316751430791
                                         uncertainty =       0.005000228210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316751430791
                                         uncertainty =       0.005000228210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398193603
  error estimate for blocks of size 2^( 2) =       0.000408462488
  error estimate for blocks of size 2^( 3) =       0.000418029434
  error estimate for blocks of size 2^( 4) =       0.000424833924
  error estimate for blocks of size 2^( 5) =       0.000428946050
  error estimate for blocks of size 2^( 6) =       0.000431452473
  error estimate for blocks of size 2^( 7) =       0.000435013384

      target function =                  N/A
              le_mean =     -17.215758278244
             les_mean =     296.699449226981
             stat err =       0.000430061458
             autocorr =       1.166467084606
              std dev =       0.563130793530
             le_variance =       0.317116290622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321766411092
                                         uncertainty =       0.005106108526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321766411092
                                         uncertainty =       0.005106108526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401334927
  error estimate for blocks of size 2^( 2) =       0.000411268496
  error estimate for blocks of size 2^( 3) =       0.000420554477
  error estimate for blocks of size 2^( 4) =       0.000427149392
  error estimate for blocks of size 2^( 5) =       0.000431170159
  error estimate for blocks of size 2^( 6) =       0.000433661309
  error estimate for blocks of size 2^( 7) =       0.000437157409

      target function =                  N/A
              le_mean =     -17.215759546621
             les_mean =     296.704516052554
             stat err =       0.000432284567
             autocorr =       1.160180468340
              std dev =       0.567573296190
             le_variance =       0.322139446548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321023307299
                                         uncertainty =       0.005092706408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321023307299
                                         uncertainty =       0.005092706408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400871171
  error estimate for blocks of size 2^( 2) =       0.000410863310
  error estimate for blocks of size 2^( 3) =       0.000420202188
  error estimate for blocks of size 2^( 4) =       0.000426841580
  error estimate for blocks of size 2^( 5) =       0.000430881429
  error estimate for blocks of size 2^( 6) =       0.000433383624
  error estimate for blocks of size 2^( 7) =       0.000436893823

      target function =                  N/A
              le_mean =     -17.215745828961
             les_mean =     296.703299677629
             stat err =       0.000432000114
             autocorr =       1.161336495273
              std dev =       0.566917446323
             le_variance =       0.321395390945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317371838351
                                         uncertainty =       0.005014636777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317371838351
                                         uncertainty =       0.005014636777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398583634
  error estimate for blocks of size 2^( 2) =       0.000408805998
  error estimate for blocks of size 2^( 3) =       0.000418335215
  error estimate for blocks of size 2^( 4) =       0.000425113263
  error estimate for blocks of size 2^( 5) =       0.000429213288
  error estimate for blocks of size 2^( 6) =       0.000431719393
  error estimate for blocks of size 2^( 7) =       0.000435272420

      target function =                  N/A
              le_mean =     -17.215747577349
             les_mean =     296.699702315381
             stat err =       0.000430329591
             autocorr =       1.165637461114
              std dev =       0.563682381544
             le_variance =       0.317737827263


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215758278244        initial
     1.5625e-01     1.5625e+00             1.4585e-02       -17.215759546621  <--
     6.2500e-01     6.2500e+00             4.9106e-03       -17.215745828961
     2.5000e+00     2.5000e+01             1.3714e-03       -17.215747577349

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 4.7537e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.998591e-01 1 1  ON 0
 uu_1                 4.166757e-02 1 1  ON 1
 uu_2                -4.857105e-02 1 1  ON 2
 uu_3                -9.852061e-02 1 1  ON 3
 uu_4                -1.278268e-01 1 1  ON 4
 uu_5                -1.330341e-01 1 1  ON 5
 uu_6                -1.105275e-01 1 1  ON 6
 uu_7                -3.549186e-02 1 1  ON 7
 uu_8                 1.020807e-01 1 1  ON 8
 uu_9                 1.195156e-01 1 1  ON 9
 ud_0                 3.374458e-01 1 1  ON 10
 ud_1                 8.486796e-02 1 1  ON 11
 ud_2                -1.572910e-02 1 1  ON 12
 ud_3                -6.923730e-02 1 1  ON 13
 ud_4                -1.142455e-01 1 1  ON 14
 ud_5                -1.484794e-01 1 1  ON 15
 ud_6                -1.562613e-01 1 1  ON 16
 ud_7                -1.096417e-01 1 1  ON 17
 ud_8                 7.926147e-03 1 1  ON 18
 ud_9                 9.251980e-02 1 1  ON 19
 eO_0                -7.191996e-01 1 1  ON 20
 eO_1                -4.177093e-01 1 1  ON 21
 eO_2                -3.973004e-02 1 1  ON 22
 eO_3                 1.871303e-01 1 1  ON 23
 eO_4                 2.712160e-01 1 1  ON 24
 eO_5                 3.041193e-01 1 1  ON 25
 eO_6                 2.484473e-01 1 1  ON 26
 eO_7                 1.095332e-01 1 1  ON 27
 eO_8                 2.756305e-02 1 1  ON 28
 eO_9                 1.823020e-02 1 1  ON 29
eH1_0                -1.781264e-01 1 1  ON 30
eH1_1                -1.003752e-01 1 1  ON 31
eH1_2                -6.253402e-02 1 1  ON 32
eH1_3                -2.685995e-02 1 1  ON 33
eH1_4                 1.943724e-02 1 1  ON 34
eH1_5                 3.273117e-02 1 1  ON 35
eH1_6                 7.675029e-02 1 1  ON 36
eH1_7                 1.106471e-01 1 1  ON 37
eH1_8                 8.929516e-02 1 1  ON 38
eH1_9                 2.389851e-02 1 1  ON 39
eH2_0                -1.797608e-01 1 1  ON 40
eH2_1                -1.018563e-01 1 1  ON 41
eH2_2                -6.392708e-02 1 1  ON 42
eH2_3                -2.835655e-02 1 1  ON 43
eH2_4                 1.788799e-02 1 1  ON 44
eH2_5                 3.325478e-02 1 1  ON 45
eH2_6                 7.843023e-02 1 1  ON 46
eH2_7                 1.142392e-01 1 1  ON 47
eH2_8                 9.225190e-02 1 1  ON 48
eH2_9                 2.588586e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8310e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2673
    reference variance = 0.382692
====================================================
  Execution time = 3.1976e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2144e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321197487642
                                         uncertainty =       0.004172662568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321197487642
                                         uncertainty =       0.004172662568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400898565
  error estimate for blocks of size 2^( 2) =       0.000410894679
  error estimate for blocks of size 2^( 3) =       0.000419582419
  error estimate for blocks of size 2^( 4) =       0.000426355377
  error estimate for blocks of size 2^( 5) =       0.000429813097
  error estimate for blocks of size 2^( 6) =       0.000431870032
  error estimate for blocks of size 2^( 7) =       0.000431544691

      target function =                  N/A
              le_mean =     -17.216057121900
             les_mean =     296.714061982272
             stat err =       0.000429895799
             autocorr =       1.149892918188
              std dev =       0.566956187421
             le_variance =       0.321439318455


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721605712190e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216057121900       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216062532295       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216089337757       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216120728254       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216137224982       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216154228928       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216158167212       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216166162668       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216175208100       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216176130687       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216179194375       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216179658925       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216179247308       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216178055022       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216178922093       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216179057123       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216178755492       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 2.294922e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216057121900       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216060649578       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216079037531       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216099582503       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216105587725       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216108420723       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216109209581       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216111321905       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216112536993       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216113212444       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216112925756       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216113010610       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216112879824       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 9.173763e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216057121900       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216058596726       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216066486166       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216073073508       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216074665407       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216075207554       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216075328005       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216075524510       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216075579082       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216075798342       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.879334e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198976 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1286e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.022367e-01 1 1  ON 0
 uu_1                 4.321171e-02 1 1  ON 1
 uu_2                -4.824523e-02 1 1  ON 2
 uu_3                -9.944511e-02 1 1  ON 3
 uu_4                -1.291256e-01 1 1  ON 4
 uu_5                -1.339460e-01 1 1  ON 5
 uu_6                -1.111070e-01 1 1  ON 6
 uu_7                -3.654177e-02 1 1  ON 7
 uu_8                 1.014629e-01 1 1  ON 8
 uu_9                 1.199124e-01 1 1  ON 9
 ud_0                 3.403963e-01 1 1  ON 10
 ud_1                 8.646037e-02 1 1  ON 11
 ud_2                -1.577829e-02 1 1  ON 12
 ud_3                -7.084479e-02 1 1  ON 13
 ud_4                -1.162619e-01 1 1  ON 14
 ud_5                -1.494514e-01 1 1  ON 15
 ud_6                -1.554158e-01 1 1  ON 16
 ud_7                -1.100033e-01 1 1  ON 17
 ud_8                 6.965851e-03 1 1  ON 18
 ud_9                 9.255062e-02 1 1  ON 19
 eO_0                -7.283734e-01 1 1  ON 20
 eO_1                -4.229422e-01 1 1  ON 21
 eO_2                -3.839265e-02 1 1  ON 22
 eO_3                 1.937715e-01 1 1  ON 23
 eO_4                 2.761303e-01 1 1  ON 24
 eO_5                 3.042003e-01 1 1  ON 25
 eO_6                 2.488225e-01 1 1  ON 26
 eO_7                 1.102924e-01 1 1  ON 27
 eO_8                 2.769198e-02 1 1  ON 28
 eO_9                 1.831662e-02 1 1  ON 29
eH1_0                -1.790578e-01 1 1  ON 30
eH1_1                -1.008922e-01 1 1  ON 31
eH1_2                -6.220873e-02 1 1  ON 32
eH1_3                -2.649054e-02 1 1  ON 33
eH1_4                 1.926532e-02 1 1  ON 34
eH1_5                 3.301821e-02 1 1  ON 35
eH1_6                 7.691584e-02 1 1  ON 36
eH1_7                 1.105756e-01 1 1  ON 37
eH1_8                 8.969034e-02 1 1  ON 38
eH1_9                 2.399901e-02 1 1  ON 39
eH2_0                -1.812783e-01 1 1  ON 40
eH2_1                -1.025912e-01 1 1  ON 41
eH2_2                -6.373760e-02 1 1  ON 42
eH2_3                -2.775187e-02 1 1  ON 43
eH2_4                 1.806801e-02 1 1  ON 44
eH2_5                 3.394801e-02 1 1  ON 45
eH2_6                 7.850562e-02 1 1  ON 46
eH2_7                 1.138990e-01 1 1  ON 47
eH2_8                 9.276455e-02 1 1  ON 48
eH2_9                 2.612338e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2225
    reference variance = 0.300172
====================================================
  Execution time = 3.1270e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1450e-01
  Total weights = 2.0000e+06
  Execution time = 2.8629e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312105858476
                                         uncertainty =       0.004645372567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312105858476
                                         uncertainty =       0.004645372567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395060755
  error estimate for blocks of size 2^( 2) =       0.000404944726
  error estimate for blocks of size 2^( 3) =       0.000414420027
  error estimate for blocks of size 2^( 4) =       0.000421360677
  error estimate for blocks of size 2^( 5) =       0.000424967493
  error estimate for blocks of size 2^( 6) =       0.000426042017
  error estimate for blocks of size 2^( 7) =       0.000426498184

      target function =                  N/A
              le_mean =     -17.215512455212
             les_mean =     296.686014939153
             stat err =       0.000424717093
             autocorr =       1.155770754074
              std dev =       0.558700277146
             le_variance =       0.312145999683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316717813842
                                         uncertainty =       0.004799712216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316717813842
                                         uncertainty =       0.004799712216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397967311
  error estimate for blocks of size 2^( 2) =       0.000407605159
  error estimate for blocks of size 2^( 3) =       0.000416831327
  error estimate for blocks of size 2^( 4) =       0.000423601319
  error estimate for blocks of size 2^( 5) =       0.000427094101
  error estimate for blocks of size 2^( 6) =       0.000428150205
  error estimate for blocks of size 2^( 7) =       0.000428611575

      target function =                  N/A
              le_mean =     -17.215504965531
             les_mean =     296.690367020864
             stat err =       0.000426864300
             autocorr =       1.150495353454
              std dev =       0.562810768391
             le_variance =       0.316755961017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317032275479
                                         uncertainty =       0.004805422240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317032275479
                                         uncertainty =       0.004805422240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398164864
  error estimate for blocks of size 2^( 2) =       0.000407805076
  error estimate for blocks of size 2^( 3) =       0.000417044841
  error estimate for blocks of size 2^( 4) =       0.000423828650
  error estimate for blocks of size 2^( 5) =       0.000427323247
  error estimate for blocks of size 2^( 6) =       0.000428376880
  error estimate for blocks of size 2^( 7) =       0.000428849405

      target function =                  N/A
              le_mean =     -17.215513189421
             les_mean =     296.690964734470
             stat err =       0.000427094545
             autocorr =       1.150594208405
              std dev =       0.563090150763
             le_variance =       0.317070517886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313009471470
                                         uncertainty =       0.004675418676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313009471470
                                         uncertainty =       0.004675418676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395631943
  error estimate for blocks of size 2^( 2) =       0.000405464360
  error estimate for blocks of size 2^( 3) =       0.000414892426
  error estimate for blocks of size 2^( 4) =       0.000421802888
  error estimate for blocks of size 2^( 5) =       0.000425388239
  error estimate for blocks of size 2^( 6) =       0.000426456562
  error estimate for blocks of size 2^( 7) =       0.000426916395

      target function =                  N/A
              le_mean =     -17.215501721715
             les_mean =     296.686548642985
             stat err =       0.000425141021
             autocorr =       1.154737643034
              std dev =       0.559508059948
             le_variance =       0.313049269147


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215512455212        initial
     3.9062e-02     3.9062e-01             2.2949e-02       -17.215504965531
     1.5625e-01     1.5625e+00             9.1738e-03       -17.215513189421  <--
     6.2500e-01     6.2500e+00             2.8793e-03       -17.215501721715

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 4.5701e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.022367e-01 1 1  ON 0
 uu_1                 4.321171e-02 1 1  ON 1
 uu_2                -4.824523e-02 1 1  ON 2
 uu_3                -9.944511e-02 1 1  ON 3
 uu_4                -1.291256e-01 1 1  ON 4
 uu_5                -1.339460e-01 1 1  ON 5
 uu_6                -1.111070e-01 1 1  ON 6
 uu_7                -3.654177e-02 1 1  ON 7
 uu_8                 1.014629e-01 1 1  ON 8
 uu_9                 1.199124e-01 1 1  ON 9
 ud_0                 3.403963e-01 1 1  ON 10
 ud_1                 8.646037e-02 1 1  ON 11
 ud_2                -1.577829e-02 1 1  ON 12
 ud_3                -7.084479e-02 1 1  ON 13
 ud_4                -1.162619e-01 1 1  ON 14
 ud_5                -1.494514e-01 1 1  ON 15
 ud_6                -1.554158e-01 1 1  ON 16
 ud_7                -1.100033e-01 1 1  ON 17
 ud_8                 6.965851e-03 1 1  ON 18
 ud_9                 9.255062e-02 1 1  ON 19
 eO_0                -7.283734e-01 1 1  ON 20
 eO_1                -4.229422e-01 1 1  ON 21
 eO_2                -3.839265e-02 1 1  ON 22
 eO_3                 1.937715e-01 1 1  ON 23
 eO_4                 2.761303e-01 1 1  ON 24
 eO_5                 3.042003e-01 1 1  ON 25
 eO_6                 2.488225e-01 1 1  ON 26
 eO_7                 1.102924e-01 1 1  ON 27
 eO_8                 2.769198e-02 1 1  ON 28
 eO_9                 1.831662e-02 1 1  ON 29
eH1_0                -1.790578e-01 1 1  ON 30
eH1_1                -1.008922e-01 1 1  ON 31
eH1_2                -6.220873e-02 1 1  ON 32
eH1_3                -2.649054e-02 1 1  ON 33
eH1_4                 1.926532e-02 1 1  ON 34
eH1_5                 3.301821e-02 1 1  ON 35
eH1_6                 7.691584e-02 1 1  ON 36
eH1_7                 1.105756e-01 1 1  ON 37
eH1_8                 8.969034e-02 1 1  ON 38
eH1_9                 2.399901e-02 1 1  ON 39
eH2_0                -1.812783e-01 1 1  ON 40
eH2_1                -1.025912e-01 1 1  ON 41
eH2_2                -6.373760e-02 1 1  ON 42
eH2_3                -2.775187e-02 1 1  ON 43
eH2_4                 1.806801e-02 1 1  ON 44
eH2_5                 3.394801e-02 1 1  ON 45
eH2_6                 7.850562e-02 1 1  ON 46
eH2_7                 1.138990e-01 1 1  ON 47
eH2_8                 9.276455e-02 1 1  ON 48
eH2_9                 2.612338e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6992e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2161
    reference variance = 0.194794
====================================================
  Execution time = 3.1548e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2116e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321213061827
                                         uncertainty =       0.004729668646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321213061827
                                         uncertainty =       0.004729668646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400723917
  error estimate for blocks of size 2^( 2) =       0.000410740754
  error estimate for blocks of size 2^( 3) =       0.000419397261
  error estimate for blocks of size 2^( 4) =       0.000425542824
  error estimate for blocks of size 2^( 5) =       0.000429580897
  error estimate for blocks of size 2^( 6) =       0.000432843577
  error estimate for blocks of size 2^( 7) =       0.000434197443

      target function =                  N/A
              le_mean =     -17.216321642021
             les_mean =     296.722890035892
             stat err =       0.000430541185
             autocorr =       1.154353640171
              std dev =       0.566709197860
             le_variance =       0.321159314939


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721632164202e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216321642021       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216323470882       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216326923518       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216341229112       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216361683099       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216377429123       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216376131364       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216382205910       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216389793594       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216391850166       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216393177427       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216391103377       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216392283001       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216394236235       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216393250358       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216393377424       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 1.774356e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216321642021       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216322823118       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216324802121       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216332283281       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216342204049       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216347555129       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216346458921       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216347696664       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216349532549       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216349339350       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216349553024       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216349292406       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 6.735865e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216321642021       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216322130732       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216322869766       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216325362004       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216328454207       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216329622853       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216329239472       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216329455684       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216329709847       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.100362e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204681 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0246e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.042745e-01 1 1  ON 0
 uu_1                 4.422518e-02 1 1  ON 1
 uu_2                -4.788039e-02 1 1  ON 2
 uu_3                -9.977678e-02 1 1  ON 3
 uu_4                -1.302004e-01 1 1  ON 4
 uu_5                -1.351013e-01 1 1  ON 5
 uu_6                -1.115468e-01 1 1  ON 6
 uu_7                -3.736520e-02 1 1  ON 7
 uu_8                 1.009793e-01 1 1  ON 8
 uu_9                 1.203516e-01 1 1  ON 9
 ud_0                 3.420199e-01 1 1  ON 10
 ud_1                 8.753044e-02 1 1  ON 11
 ud_2                -1.564182e-02 1 1  ON 12
 ud_3                -7.163655e-02 1 1  ON 13
 ud_4                -1.175077e-01 1 1  ON 14
 ud_5                -1.502427e-01 1 1  ON 15
 ud_6                -1.550982e-01 1 1  ON 16
 ud_7                -1.100280e-01 1 1  ON 17
 ud_8                 6.192275e-03 1 1  ON 18
 ud_9                 9.262056e-02 1 1  ON 19
 eO_0                -7.351093e-01 1 1  ON 20
 eO_1                -4.266791e-01 1 1  ON 21
 eO_2                -3.857975e-02 1 1  ON 22
 eO_3                 1.976635e-01 1 1  ON 23
 eO_4                 2.807647e-01 1 1  ON 24
 eO_5                 3.049341e-01 1 1  ON 25
 eO_6                 2.492322e-01 1 1  ON 26
 eO_7                 1.110256e-01 1 1  ON 27
 eO_8                 2.783376e-02 1 1  ON 28
 eO_9                 1.839315e-02 1 1  ON 29
eH1_0                -1.800714e-01 1 1  ON 30
eH1_1                -1.017692e-01 1 1  ON 31
eH1_2                -6.228617e-02 1 1  ON 32
eH1_3                -2.612318e-02 1 1  ON 33
eH1_4                 1.968770e-02 1 1  ON 34
eH1_5                 3.396416e-02 1 1  ON 35
eH1_6                 7.680065e-02 1 1  ON 36
eH1_7                 1.101766e-01 1 1  ON 37
eH1_8                 9.015268e-02 1 1  ON 38
eH1_9                 2.422522e-02 1 1  ON 39
eH2_0                -1.819345e-01 1 1  ON 40
eH2_1                -1.030975e-01 1 1  ON 41
eH2_2                -6.356590e-02 1 1  ON 42
eH2_3                -2.768389e-02 1 1  ON 43
eH2_4                 1.806726e-02 1 1  ON 44
eH2_5                 3.411784e-02 1 1  ON 45
eH2_6                 7.873924e-02 1 1  ON 46
eH2_7                 1.138274e-01 1 1  ON 47
eH2_8                 9.319346e-02 1 1  ON 48
eH2_9                 2.624208e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2247
    reference variance = 0.146515
====================================================
  Execution time = 3.1563e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2219e-01
  Total weights = 2.0000e+06
  Execution time = 2.8723e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320749425006
                                         uncertainty =       0.005215501832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320749425006
                                         uncertainty =       0.005215501832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400499955
  error estimate for blocks of size 2^( 2) =       0.000410342200
  error estimate for blocks of size 2^( 3) =       0.000419105302
  error estimate for blocks of size 2^( 4) =       0.000425952979
  error estimate for blocks of size 2^( 5) =       0.000429370861
  error estimate for blocks of size 2^( 6) =       0.000432312295
  error estimate for blocks of size 2^( 7) =       0.000433793476

      target function =                  N/A
              le_mean =     -17.215978638583
             les_mean =     296.710720751306
             stat err =       0.000430357403
             autocorr =       1.154658648674
              std dev =       0.566392467788
             le_variance =       0.320800427567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323704232256
                                         uncertainty =       0.005235062109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323704232256
                                         uncertainty =       0.005235062109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402341549
  error estimate for blocks of size 2^( 2) =       0.000412056864
  error estimate for blocks of size 2^( 3) =       0.000420654610
  error estimate for blocks of size 2^( 4) =       0.000427391388
  error estimate for blocks of size 2^( 5) =       0.000430758189
  error estimate for blocks of size 2^( 6) =       0.000433647116
  error estimate for blocks of size 2^( 7) =       0.000435083223

      target function =                  N/A
              le_mean =     -17.215971889526
             les_mean =     296.713445382920
             stat err =       0.000431719979
             autocorr =       1.151368987715
              std dev =       0.568996875081
             le_variance =       0.323757443852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323602150081
                                         uncertainty =       0.005226238750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323602150081
                                         uncertainty =       0.005226238750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402277778
  error estimate for blocks of size 2^( 2) =       0.000412002977
  error estimate for blocks of size 2^( 3) =       0.000420619548
  error estimate for blocks of size 2^( 4) =       0.000427373360
  error estimate for blocks of size 2^( 5) =       0.000430749287
  error estimate for blocks of size 2^( 6) =       0.000433648944
  error estimate for blocks of size 2^( 7) =       0.000435095058

      target function =                  N/A
              le_mean =     -17.215967854916
             les_mean =     296.713203840280
             stat err =       0.000431716662
             autocorr =       1.151716364293
              std dev =       0.568906688837
             le_variance =       0.323654820603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321238679282
                                         uncertainty =       0.005216351488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321238679282
                                         uncertainty =       0.005216351488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400805388
  error estimate for blocks of size 2^( 2) =       0.000410625529
  error estimate for blocks of size 2^( 3) =       0.000419362176
  error estimate for blocks of size 2^( 4) =       0.000426193050
  error estimate for blocks of size 2^( 5) =       0.000429602878
  error estimate for blocks of size 2^( 6) =       0.000432537544
  error estimate for blocks of size 2^( 7) =       0.000434013273

      target function =                  N/A
              le_mean =     -17.215972868839
             les_mean =     296.711011577240
             stat err =       0.000430586686
             autocorr =       1.154128308125
              std dev =       0.566824414878
             le_variance =       0.321289917302


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215978638583        initial  <--
     3.9062e-02     3.9062e-01             1.7744e-02       -17.215971889526
     1.5625e-01     1.5625e+00             6.7359e-03       -17.215967854916
     6.2500e-01     6.2500e+00             2.1004e-03       -17.215972868839

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.0182
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.022367e-01 1 1  ON 0
 uu_1                 4.321171e-02 1 1  ON 1
 uu_2                -4.824523e-02 1 1  ON 2
 uu_3                -9.944511e-02 1 1  ON 3
 uu_4                -1.291256e-01 1 1  ON 4
 uu_5                -1.339460e-01 1 1  ON 5
 uu_6                -1.111070e-01 1 1  ON 6
 uu_7                -3.654177e-02 1 1  ON 7
 uu_8                 1.014629e-01 1 1  ON 8
 uu_9                 1.199124e-01 1 1  ON 9
 ud_0                 3.403963e-01 1 1  ON 10
 ud_1                 8.646037e-02 1 1  ON 11
 ud_2                -1.577829e-02 1 1  ON 12
 ud_3                -7.084479e-02 1 1  ON 13
 ud_4                -1.162619e-01 1 1  ON 14
 ud_5                -1.494514e-01 1 1  ON 15
 ud_6                -1.554158e-01 1 1  ON 16
 ud_7                -1.100033e-01 1 1  ON 17
 ud_8                 6.965851e-03 1 1  ON 18
 ud_9                 9.255062e-02 1 1  ON 19
 eO_0                -7.283734e-01 1 1  ON 20
 eO_1                -4.229422e-01 1 1  ON 21
 eO_2                -3.839265e-02 1 1  ON 22
 eO_3                 1.937715e-01 1 1  ON 23
 eO_4                 2.761303e-01 1 1  ON 24
 eO_5                 3.042003e-01 1 1  ON 25
 eO_6                 2.488225e-01 1 1  ON 26
 eO_7                 1.102924e-01 1 1  ON 27
 eO_8                 2.769198e-02 1 1  ON 28
 eO_9                 1.831662e-02 1 1  ON 29
eH1_0                -1.790578e-01 1 1  ON 30
eH1_1                -1.008922e-01 1 1  ON 31
eH1_2                -6.220873e-02 1 1  ON 32
eH1_3                -2.649054e-02 1 1  ON 33
eH1_4                 1.926532e-02 1 1  ON 34
eH1_5                 3.301821e-02 1 1  ON 35
eH1_6                 7.691584e-02 1 1  ON 36
eH1_7                 1.105756e-01 1 1  ON 37
eH1_8                 8.969034e-02 1 1  ON 38
eH1_9                 2.399901e-02 1 1  ON 39
eH2_0                -1.812783e-01 1 1  ON 40
eH2_1                -1.025912e-01 1 1  ON 41
eH2_2                -6.373760e-02 1 1  ON 42
eH2_3                -2.775187e-02 1 1  ON 43
eH2_4                 1.806801e-02 1 1  ON 44
eH2_5                 3.394801e-02 1 1  ON 45
eH2_6                 7.850562e-02 1 1  ON 46
eH2_7                 1.138990e-01 1 1  ON 47
eH2_8                 9.276455e-02 1 1  ON 48
eH2_9                 2.612338e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6271e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2457
    reference variance = 0.16417
====================================================
  Execution time = 3.1605e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2953e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329345880412
                                         uncertainty =       0.013246311453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329345880412
                                         uncertainty =       0.013246311453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405911733
  error estimate for blocks of size 2^( 2) =       0.000415445872
  error estimate for blocks of size 2^( 3) =       0.000424093078
  error estimate for blocks of size 2^( 4) =       0.000430650391
  error estimate for blocks of size 2^( 5) =       0.000434472800
  error estimate for blocks of size 2^( 6) =       0.000436286668
  error estimate for blocks of size 2^( 7) =       0.000437931058

      target function =                  N/A
              le_mean =     -17.216444891795
             les_mean =     296.735503217930
             stat err =       0.000434835229
             autocorr =       1.147588622896
              std dev =       0.574045878388
             le_variance =       0.329528670494


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721644489179e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216444891795       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216448391933       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216454062459       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216459271221       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216459673772       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216461675751       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216462140388       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216462320741       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216462154308       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216462010889       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216462038030       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 3.226890e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216444891795       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216446064288       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216447977876       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216449328017       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216449339128       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216449831067       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216449900134       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216449916207       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216449886839       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 9.009728e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216444891795       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216445212143       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216445739920       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216446072335       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216446066286       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216446188950       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216446203315       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216446205398       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 2.333736e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208152 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0328e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.024786e-01 1 1  ON 0
 uu_1                 4.328979e-02 1 1  ON 1
 uu_2                -4.820132e-02 1 1  ON 2
 uu_3                -9.950957e-02 1 1  ON 3
 uu_4                -1.292972e-01 1 1  ON 4
 uu_5                -1.340046e-01 1 1  ON 5
 uu_6                -1.111805e-01 1 1  ON 6
 uu_7                -3.665106e-02 1 1  ON 7
 uu_8                 1.014332e-01 1 1  ON 8
 uu_9                 1.199685e-01 1 1  ON 9
 ud_0                 3.406195e-01 1 1  ON 10
 ud_1                 8.657764e-02 1 1  ON 11
 ud_2                -1.578945e-02 1 1  ON 12
 ud_3                -7.100390e-02 1 1  ON 13
 ud_4                -1.164499e-01 1 1  ON 14
 ud_5                -1.495195e-01 1 1  ON 15
 ud_6                -1.553207e-01 1 1  ON 16
 ud_7                -1.100382e-01 1 1  ON 17
 ud_8                 6.876063e-03 1 1  ON 18
 ud_9                 9.256402e-02 1 1  ON 19
 eO_0                -7.292744e-01 1 1  ON 20
 eO_1                -4.233643e-01 1 1  ON 21
 eO_2                -3.831773e-02 1 1  ON 22
 eO_3                 1.943636e-01 1 1  ON 23
 eO_4                 2.765822e-01 1 1  ON 24
 eO_5                 3.042453e-01 1 1  ON 25
 eO_6                 2.488651e-01 1 1  ON 26
 eO_7                 1.103648e-01 1 1  ON 27
 eO_8                 2.770929e-02 1 1  ON 28
 eO_9                 1.832582e-02 1 1  ON 29
eH1_0                -1.791777e-01 1 1  ON 30
eH1_1                -1.009593e-01 1 1  ON 31
eH1_2                -6.218669e-02 1 1  ON 32
eH1_3                -2.650206e-02 1 1  ON 33
eH1_4                 1.921757e-02 1 1  ON 34
eH1_5                 3.316113e-02 1 1  ON 35
eH1_6                 7.692987e-02 1 1  ON 36
eH1_7                 1.105645e-01 1 1  ON 37
eH1_8                 8.973252e-02 1 1  ON 38
eH1_9                 2.402042e-02 1 1  ON 39
eH2_0                -1.813320e-01 1 1  ON 40
eH2_1                -1.026388e-01 1 1  ON 41
eH2_2                -6.370938e-02 1 1  ON 42
eH2_3                -2.782938e-02 1 1  ON 43
eH2_4                 1.806771e-02 1 1  ON 44
eH2_5                 3.402991e-02 1 1  ON 45
eH2_6                 7.851655e-02 1 1  ON 46
eH2_7                 1.138785e-01 1 1  ON 47
eH2_8                 9.280488e-02 1 1  ON 48
eH2_9                 2.614617e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1286
    reference variance = 0.31697
====================================================
  Execution time = 3.1476e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0818e-01
  Total weights = 2.0000e+06
  Execution time = 2.8630e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307912485921
                                         uncertainty =       0.003071988362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307912485921
                                         uncertainty =       0.003071988362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392420642
  error estimate for blocks of size 2^( 2) =       0.000402408334
  error estimate for blocks of size 2^( 3) =       0.000410719647
  error estimate for blocks of size 2^( 4) =       0.000416511686
  error estimate for blocks of size 2^( 5) =       0.000419268239
  error estimate for blocks of size 2^( 6) =       0.000421029340
  error estimate for blocks of size 2^( 7) =       0.000421359005

      target function =                  N/A
              le_mean =     -17.216210565859
             les_mean =     296.705894014069
             stat err =       0.000419542068
             autocorr =       1.143002924384
              std dev =       0.554966593638
             le_variance =       0.307987920054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308563272756
                                         uncertainty =       0.003081201789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308563272756
                                         uncertainty =       0.003081201789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392834725
  error estimate for blocks of size 2^( 2) =       0.000402788755
  error estimate for blocks of size 2^( 3) =       0.000411068197
  error estimate for blocks of size 2^( 4) =       0.000416836736
  error estimate for blocks of size 2^( 5) =       0.000419583292
  error estimate for blocks of size 2^( 6) =       0.000421341158
  error estimate for blocks of size 2^( 7) =       0.000421665719

      target function =                  N/A
              le_mean =     -17.216207227084
             les_mean =     296.706429373465
             stat err =       0.000419856726
             autocorr =       1.142306082166
              std dev =       0.555552195471
             le_variance =       0.308638241892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308295109493
                                         uncertainty =       0.003077549395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308295109493
                                         uncertainty =       0.003077549395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392664150
  error estimate for blocks of size 2^( 2) =       0.000402632427
  error estimate for blocks of size 2^( 3) =       0.000410925944
  error estimate for blocks of size 2^( 4) =       0.000416704960
  error estimate for blocks of size 2^( 5) =       0.000419455838
  error estimate for blocks of size 2^( 6) =       0.000421214852
  error estimate for blocks of size 2^( 7) =       0.000421541687

      target function =                  N/A
              le_mean =     -17.216208518426
             les_mean =     296.706205864880
             stat err =       0.000419729334
             autocorr =       1.142605054766
              std dev =       0.555310966168
             le_variance =       0.308370269146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307962766044
                                         uncertainty =       0.003072722200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307962766044
                                         uncertainty =       0.003072722200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392452650
  error estimate for blocks of size 2^( 2) =       0.000402437737
  error estimate for blocks of size 2^( 3) =       0.000410746703
  error estimate for blocks of size 2^( 4) =       0.000416537035
  error estimate for blocks of size 2^( 5) =       0.000419292824
  error estimate for blocks of size 2^( 6) =       0.000421053640
  error estimate for blocks of size 2^( 7) =       0.000421382950

      target function =                  N/A
              le_mean =     -17.216210237340
             les_mean =     296.705932946828
             stat err =       0.000419566612
             autocorr =       1.142950207816
              std dev =       0.555011859834
             le_variance =       0.308038164557


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216210565859        initial  <--
     3.9062e-01     3.9062e+00             3.2269e-03       -17.216207227084
     1.5625e+00     1.5625e+01             9.0097e-04       -17.216208518426
     6.2500e+00     6.2500e+01             2.3337e-04       -17.216210237340

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.4248
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.022367e-01 1 1  ON 0
 uu_1                 4.321171e-02 1 1  ON 1
 uu_2                -4.824523e-02 1 1  ON 2
 uu_3                -9.944511e-02 1 1  ON 3
 uu_4                -1.291256e-01 1 1  ON 4
 uu_5                -1.339460e-01 1 1  ON 5
 uu_6                -1.111070e-01 1 1  ON 6
 uu_7                -3.654177e-02 1 1  ON 7
 uu_8                 1.014629e-01 1 1  ON 8
 uu_9                 1.199124e-01 1 1  ON 9
 ud_0                 3.403963e-01 1 1  ON 10
 ud_1                 8.646037e-02 1 1  ON 11
 ud_2                -1.577829e-02 1 1  ON 12
 ud_3                -7.084479e-02 1 1  ON 13
 ud_4                -1.162619e-01 1 1  ON 14
 ud_5                -1.494514e-01 1 1  ON 15
 ud_6                -1.554158e-01 1 1  ON 16
 ud_7                -1.100033e-01 1 1  ON 17
 ud_8                 6.965851e-03 1 1  ON 18
 ud_9                 9.255062e-02 1 1  ON 19
 eO_0                -7.283734e-01 1 1  ON 20
 eO_1                -4.229422e-01 1 1  ON 21
 eO_2                -3.839265e-02 1 1  ON 22
 eO_3                 1.937715e-01 1 1  ON 23
 eO_4                 2.761303e-01 1 1  ON 24
 eO_5                 3.042003e-01 1 1  ON 25
 eO_6                 2.488225e-01 1 1  ON 26
 eO_7                 1.102924e-01 1 1  ON 27
 eO_8                 2.769198e-02 1 1  ON 28
 eO_9                 1.831662e-02 1 1  ON 29
eH1_0                -1.790578e-01 1 1  ON 30
eH1_1                -1.008922e-01 1 1  ON 31
eH1_2                -6.220873e-02 1 1  ON 32
eH1_3                -2.649054e-02 1 1  ON 33
eH1_4                 1.926532e-02 1 1  ON 34
eH1_5                 3.301821e-02 1 1  ON 35
eH1_6                 7.691584e-02 1 1  ON 36
eH1_7                 1.105756e-01 1 1  ON 37
eH1_8                 8.969034e-02 1 1  ON 38
eH1_9                 2.399901e-02 1 1  ON 39
eH2_0                -1.812783e-01 1 1  ON 40
eH2_1                -1.025912e-01 1 1  ON 41
eH2_2                -6.373760e-02 1 1  ON 42
eH2_3                -2.775187e-02 1 1  ON 43
eH2_4                 1.806801e-02 1 1  ON 44
eH2_5                 3.394801e-02 1 1  ON 45
eH2_6                 7.850562e-02 1 1  ON 46
eH2_7                 1.138990e-01 1 1  ON 47
eH2_8                 9.276455e-02 1 1  ON 48
eH2_9                 2.612338e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.9769e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2159
    reference variance = 0.175138
====================================================
  Execution time = 3.2099e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2312e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323136271866
                                         uncertainty =       0.004943708520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323136271866
                                         uncertainty =       0.004943708520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401945551
  error estimate for blocks of size 2^( 2) =       0.000411892563
  error estimate for blocks of size 2^( 3) =       0.000420668656
  error estimate for blocks of size 2^( 4) =       0.000427344902
  error estimate for blocks of size 2^( 5) =       0.000431179910
  error estimate for blocks of size 2^( 6) =       0.000434866412
  error estimate for blocks of size 2^( 7) =       0.000437497263

      target function =                  N/A
              le_mean =     -17.215883310463
             les_mean =     296.709758449830
             stat err =       0.000432722122
             autocorr =       1.159000821541
              std dev =       0.568436849541
             le_variance =       0.323120451916


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721588331046e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215883310463       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215883496976       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215883624595       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215884160871       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215884705904       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215884784947       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215884795141       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215884740941       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 3.492073e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215883310463       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215883358913       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215883390859       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215883523635       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215883662233       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215883682548       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215883686004       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215883673977       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 8.821787e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215883310463       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215883322695       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215883330684       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215883363776       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215883398562       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215883403689       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215883404612       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215883401708       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 2.211155e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210839 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0730e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.022691e-01 1 1  ON 0
 uu_1                 4.321658e-02 1 1  ON 1
 uu_2                -4.823874e-02 1 1  ON 2
 uu_3                -9.945029e-02 1 1  ON 3
 uu_4                -1.291490e-01 1 1  ON 4
 uu_5                -1.339540e-01 1 1  ON 5
 uu_6                -1.111088e-01 1 1  ON 6
 uu_7                -3.655105e-02 1 1  ON 7
 uu_8                 1.014596e-01 1 1  ON 8
 uu_9                 1.199160e-01 1 1  ON 9
 ud_0                 3.404247e-01 1 1  ON 10
 ud_1                 8.647241e-02 1 1  ON 11
 ud_2                -1.578097e-02 1 1  ON 12
 ud_3                -7.085617e-02 1 1  ON 13
 ud_4                -1.162851e-01 1 1  ON 14
 ud_5                -1.494507e-01 1 1  ON 15
 ud_6                -1.554093e-01 1 1  ON 16
 ud_7                -1.100073e-01 1 1  ON 17
 ud_8                 6.956421e-03 1 1  ON 18
 ud_9                 9.254975e-02 1 1  ON 19
 eO_0                -7.284616e-01 1 1  ON 20
 eO_1                -4.229885e-01 1 1  ON 21
 eO_2                -3.838733e-02 1 1  ON 22
 eO_3                 1.938356e-01 1 1  ON 23
 eO_4                 2.761794e-01 1 1  ON 24
 eO_5                 3.042033e-01 1 1  ON 25
 eO_6                 2.488259e-01 1 1  ON 26
 eO_7                 1.102997e-01 1 1  ON 27
 eO_8                 2.769340e-02 1 1  ON 28
 eO_9                 1.831704e-02 1 1  ON 29
eH1_0                -1.790633e-01 1 1  ON 30
eH1_1                -1.008961e-01 1 1  ON 31
eH1_2                -6.220744e-02 1 1  ON 32
eH1_3                -2.649856e-02 1 1  ON 33
eH1_4                 1.925972e-02 1 1  ON 34
eH1_5                 3.303560e-02 1 1  ON 35
eH1_6                 7.691819e-02 1 1  ON 36
eH1_7                 1.105720e-01 1 1  ON 37
eH1_8                 8.969445e-02 1 1  ON 38
eH1_9                 2.400027e-02 1 1  ON 39
eH2_0                -1.812914e-01 1 1  ON 40
eH2_1                -1.025945e-01 1 1  ON 41
eH2_2                -6.373215e-02 1 1  ON 42
eH2_3                -2.775252e-02 1 1  ON 43
eH2_4                 1.807073e-02 1 1  ON 44
eH2_5                 3.395400e-02 1 1  ON 45
eH2_6                 7.850474e-02 1 1  ON 46
eH2_7                 1.138971e-01 1 1  ON 47
eH2_8                 9.276817e-02 1 1  ON 48
eH2_9                 2.612470e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2544
    reference variance = 0.276154
====================================================
  Execution time = 3.1368e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3741e-01
  Total weights = 2.0000e+06
  Execution time = 2.8739e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337495422552
                                         uncertainty =       0.010064786963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337495422552
                                         uncertainty =       0.010064786963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410722488
  error estimate for blocks of size 2^( 2) =       0.000420256458
  error estimate for blocks of size 2^( 3) =       0.000428780660
  error estimate for blocks of size 2^( 4) =       0.000434974754
  error estimate for blocks of size 2^( 5) =       0.000438612306
  error estimate for blocks of size 2^( 6) =       0.000440879329
  error estimate for blocks of size 2^( 7) =       0.000442599115

      target function =                  N/A
              le_mean =     -17.216349091453
             les_mean =     296.740061794283
             stat err =       0.000439266376
             autocorr =       1.143823349166
              std dev =       0.580849312821
             le_variance =       0.337385924204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337599381658
                                         uncertainty =       0.010068877991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337599381658
                                         uncertainty =       0.010068877991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410785746
  error estimate for blocks of size 2^( 2) =       0.000420315044
  error estimate for blocks of size 2^( 3) =       0.000428834715
  error estimate for blocks of size 2^( 4) =       0.000435025564
  error estimate for blocks of size 2^( 5) =       0.000438661385
  error estimate for blocks of size 2^( 6) =       0.000440926654
  error estimate for blocks of size 2^( 7) =       0.000442645636

      target function =                  N/A
              le_mean =     -17.216349826677
             les_mean =     296.740191043418
             stat err =       0.000439314810
             autocorr =       1.143723270630
              std dev =       0.580938772718
             le_variance =       0.337489857647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337549262155
                                         uncertainty =       0.010066876089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337549262155
                                         uncertainty =       0.010066876089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410755250
  error estimate for blocks of size 2^( 2) =       0.000420286813
  error estimate for blocks of size 2^( 3) =       0.000428808687
  error estimate for blocks of size 2^( 4) =       0.000435001121
  error estimate for blocks of size 2^( 5) =       0.000438637788
  error estimate for blocks of size 2^( 6) =       0.000440903885
  error estimate for blocks of size 2^( 7) =       0.000442623276

      target function =                  N/A
              le_mean =     -17.216349460468
             les_mean =     296.740128327055
             stat err =       0.000439291518
             autocorr =       1.143771810635
              std dev =       0.580895645385
             le_variance =       0.337439750828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337502212282
                                         uncertainty =       0.010065049762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337502212282
                                         uncertainty =       0.010065049762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410726620
  error estimate for blocks of size 2^( 2) =       0.000420260286
  error estimate for blocks of size 2^( 3) =       0.000428784194
  error estimate for blocks of size 2^( 4) =       0.000434978079
  error estimate for blocks of size 2^( 5) =       0.000438615520
  error estimate for blocks of size 2^( 6) =       0.000440882426
  error estimate for blocks of size 2^( 7) =       0.000442602163

      target function =                  N/A
              le_mean =     -17.216349136904
             les_mean =     296.740070147389
             stat err =       0.000439269547
             autocorr =       1.143816851481
              std dev =       0.580855156046
             le_variance =       0.337392712305


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216349091453        initial
     3.9062e+00     3.9062e+01             3.4921e-04       -17.216349826677  <--
     1.5625e+01     1.5625e+02             8.8218e-05       -17.216349460468
     6.2500e+01     6.2500e+02             2.2112e-05       -17.216349136904

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 4.5869e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.023632e-01 1 1  ON 0
 uu_1                 4.323333e-02 1 1  ON 1
 uu_2                -4.821950e-02 1 1  ON 2
 uu_3                -9.946597e-02 1 1  ON 3
 uu_4                -1.292166e-01 1 1  ON 4
 uu_5                -1.339797e-01 1 1  ON 5
 uu_6                -1.111141e-01 1 1  ON 6
 uu_7                -3.657855e-02 1 1  ON 7
 uu_8                 1.014499e-01 1 1  ON 8
 uu_9                 1.199265e-01 1 1  ON 9
 ud_0                 3.405060e-01 1 1  ON 10
 ud_1                 8.650782e-02 1 1  ON 11
 ud_2                -1.578735e-02 1 1  ON 12
 ud_3                -7.088943e-02 1 1  ON 13
 ud_4                -1.163510e-01 1 1  ON 14
 ud_5                -1.494512e-01 1 1  ON 15
 ud_6                -1.553898e-01 1 1  ON 16
 ud_7                -1.100188e-01 1 1  ON 17
 ud_8                 6.928350e-03 1 1  ON 18
 ud_9                 9.254719e-02 1 1  ON 19
 eO_0                -7.287226e-01 1 1  ON 20
 eO_1                -4.231260e-01 1 1  ON 21
 eO_2                -3.837323e-02 1 1  ON 22
 eO_3                 1.940248e-01 1 1  ON 23
 eO_4                 2.763266e-01 1 1  ON 24
 eO_5                 3.042128e-01 1 1  ON 25
 eO_6                 2.488362e-01 1 1  ON 26
 eO_7                 1.103216e-01 1 1  ON 27
 eO_8                 2.769766e-02 1 1  ON 28
 eO_9                 1.831831e-02 1 1  ON 29
eH1_0                -1.790793e-01 1 1  ON 30
eH1_1                -1.009085e-01 1 1  ON 31
eH1_2                -6.220406e-02 1 1  ON 32
eH1_3                -2.652106e-02 1 1  ON 33
eH1_4                 1.924251e-02 1 1  ON 34
eH1_5                 3.308699e-02 1 1  ON 35
eH1_6                 7.692554e-02 1 1  ON 36
eH1_7                 1.105616e-01 1 1  ON 37
eH1_8                 8.970676e-02 1 1  ON 38
eH1_9                 2.400403e-02 1 1  ON 39
eH2_0                -1.813296e-01 1 1  ON 40
eH2_1                -1.026041e-01 1 1  ON 41
eH2_2                -6.371645e-02 1 1  ON 42
eH2_3                -2.775413e-02 1 1  ON 43
eH2_4                 1.807794e-02 1 1  ON 44
eH2_5                 3.397180e-02 1 1  ON 45
eH2_6                 7.850238e-02 1 1  ON 46
eH2_7                 1.138916e-01 1 1  ON 47
eH2_8                 9.277902e-02 1 1  ON 48
eH2_9                 2.612866e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6604e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2062
    reference variance = 0.310577
====================================================
  Execution time = 3.1679e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1546e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7413e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315532178624
                                         uncertainty =       0.004197834396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315532178624
                                         uncertainty =       0.004197834396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397150372
  error estimate for blocks of size 2^( 2) =       0.000407365522
  error estimate for blocks of size 2^( 3) =       0.000416192291
  error estimate for blocks of size 2^( 4) =       0.000422456894
  error estimate for blocks of size 2^( 5) =       0.000426870215
  error estimate for blocks of size 2^( 6) =       0.000428805999
  error estimate for blocks of size 2^( 7) =       0.000431642335

      target function =                  N/A
              le_mean =     -17.216567098221
             les_mean =     296.725639325061
             stat err =       0.000427443861
             autocorr =       1.158372452498
              std dev =       0.561655441744
             le_variance =       0.315456835241


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656709822e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216567098221       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566906655       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216567383391       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216572150128       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216572669460       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216573595533       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216573008759       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216573058952       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216573097204       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.319623e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216567098221       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216567043915       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216567157409       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216568421426       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216568552663       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216568792301       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216568652670       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216568671640       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 3.479509e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216567098221       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216567084174       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216567111983       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216567432088       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216567464661       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216567525491       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216567491902       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216567496813       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 8.815587e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213695 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0427e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.024715e-01 1 1  ON 0
 uu_1                 4.326439e-02 1 1  ON 1
 uu_2                -4.819715e-02 1 1  ON 2
 uu_3                -9.948593e-02 1 1  ON 3
 uu_4                -1.292897e-01 1 1  ON 4
 uu_5                -1.340196e-01 1 1  ON 5
 uu_6                -1.111311e-01 1 1  ON 6
 uu_7                -3.660707e-02 1 1  ON 7
 uu_8                 1.014326e-01 1 1  ON 8
 uu_9                 1.199429e-01 1 1  ON 9
 ud_0                 3.405926e-01 1 1  ON 10
 ud_1                 8.656544e-02 1 1  ON 11
 ud_2                -1.577704e-02 1 1  ON 12
 ud_3                -7.094648e-02 1 1  ON 13
 ud_4                -1.164200e-01 1 1  ON 14
 ud_5                -1.494599e-01 1 1  ON 15
 ud_6                -1.553546e-01 1 1  ON 16
 ud_7                -1.100384e-01 1 1  ON 17
 ud_8                 6.882132e-03 1 1  ON 18
 ud_9                 9.254629e-02 1 1  ON 19
 eO_0                -7.290706e-01 1 1  ON 20
 eO_1                -4.232888e-01 1 1  ON 21
 eO_2                -3.835446e-02 1 1  ON 22
 eO_3                 1.942717e-01 1 1  ON 23
 eO_4                 2.765093e-01 1 1  ON 24
 eO_5                 3.042153e-01 1 1  ON 25
 eO_6                 2.488577e-01 1 1  ON 26
 eO_7                 1.103518e-01 1 1  ON 27
 eO_8                 2.770282e-02 1 1  ON 28
 eO_9                 1.832044e-02 1 1  ON 29
eH1_0                -1.791315e-01 1 1  ON 30
eH1_1                -1.009537e-01 1 1  ON 31
eH1_2                -6.218918e-02 1 1  ON 32
eH1_3                -2.650224e-02 1 1  ON 33
eH1_4                 1.924961e-02 1 1  ON 34
eH1_5                 3.312751e-02 1 1  ON 35
eH1_6                 7.693112e-02 1 1  ON 36
eH1_7                 1.105513e-01 1 1  ON 37
eH1_8                 8.972110e-02 1 1  ON 38
eH1_9                 2.400858e-02 1 1  ON 39
eH2_0                -1.813577e-01 1 1  ON 40
eH2_1                -1.026393e-01 1 1  ON 41
eH2_2                -6.371427e-02 1 1  ON 42
eH2_3                -2.775520e-02 1 1  ON 43
eH2_4                 1.809252e-02 1 1  ON 44
eH2_5                 3.400176e-02 1 1  ON 45
eH2_6                 7.849782e-02 1 1  ON 46
eH2_7                 1.138839e-01 1 1  ON 47
eH2_8                 9.280043e-02 1 1  ON 48
eH2_9                 2.613583e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.244
    reference variance = 0.246085
====================================================
  Execution time = 3.1218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1472e-01
  Total weights = 2.0000e+06
  Execution time = 2.8618e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314619800430
                                         uncertainty =       0.004469093544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314619800430
                                         uncertainty =       0.004469093544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396645561
  error estimate for blocks of size 2^( 2) =       0.000406275312
  error estimate for blocks of size 2^( 3) =       0.000414742397
  error estimate for blocks of size 2^( 4) =       0.000421518386
  error estimate for blocks of size 2^( 5) =       0.000425979775
  error estimate for blocks of size 2^( 6) =       0.000430471798
  error estimate for blocks of size 2^( 7) =       0.000432071136

      target function =                  N/A
              le_mean =     -17.216205566930
             les_mean =     296.712389367984
             stat err =       0.000427510274
             autocorr =       1.161683750675
              std dev =       0.560941532165
             le_variance =       0.314655402507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314869282633
                                         uncertainty =       0.004473342802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314869282633
                                         uncertainty =       0.004473342802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396802774
  error estimate for blocks of size 2^( 2) =       0.000406420058
  error estimate for blocks of size 2^( 3) =       0.000414874327
  error estimate for blocks of size 2^( 4) =       0.000421640886
  error estimate for blocks of size 2^( 5) =       0.000426098506
  error estimate for blocks of size 2^( 6) =       0.000430582828
  error estimate for blocks of size 2^( 7) =       0.000432184259

      target function =                  N/A
              le_mean =     -17.216203664242
             les_mean =     296.712573333744
             stat err =       0.000427626620
             autocorr =       1.161395303713
              std dev =       0.561163864242
             le_variance =       0.314904882531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314749621509
                                         uncertainty =       0.004471341929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314749621509
                                         uncertainty =       0.004471341929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396727376
  error estimate for blocks of size 2^( 2) =       0.000406350553
  error estimate for blocks of size 2^( 3) =       0.000414810819
  error estimate for blocks of size 2^( 4) =       0.000421581845
  error estimate for blocks of size 2^( 5) =       0.000426041171
  error estimate for blocks of size 2^( 6) =       0.000430528858
  error estimate for blocks of size 2^( 7) =       0.000432128948

      target function =                  N/A
              le_mean =     -17.216204392412
             les_mean =     296.712478746292
             stat err =       0.000427570206
             autocorr =       1.161530260508
              std dev =       0.561057236279
             le_variance =       0.314785222381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314636054543
                                         uncertainty =       0.004469375590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314636054543
                                         uncertainty =       0.004469375590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396655806
  error estimate for blocks of size 2^( 2) =       0.000406284723
  error estimate for blocks of size 2^( 3) =       0.000414750938
  error estimate for blocks of size 2^( 4) =       0.000421526297
  error estimate for blocks of size 2^( 5) =       0.000425987421
  error estimate for blocks of size 2^( 6) =       0.000430478888
  error estimate for blocks of size 2^( 7) =       0.000432078307

      target function =                  N/A
              le_mean =     -17.216205403930
             les_mean =     296.712400009430
             stat err =       0.000427517728
             autocorr =       1.161664256250
              std dev =       0.560956020071
             le_variance =       0.314671656454


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216205566930        initial  <--
     9.7656e-01     9.7656e+00             1.3196e-03       -17.216203664242
     3.9062e+00     3.9062e+01             3.4795e-04       -17.216204392412
     1.5625e+01     1.5625e+02             8.8156e-05       -17.216205403930

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6252
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.023632e-01 1 1  ON 0
 uu_1                 4.323333e-02 1 1  ON 1
 uu_2                -4.821950e-02 1 1  ON 2
 uu_3                -9.946597e-02 1 1  ON 3
 uu_4                -1.292166e-01 1 1  ON 4
 uu_5                -1.339797e-01 1 1  ON 5
 uu_6                -1.111141e-01 1 1  ON 6
 uu_7                -3.657855e-02 1 1  ON 7
 uu_8                 1.014499e-01 1 1  ON 8
 uu_9                 1.199265e-01 1 1  ON 9
 ud_0                 3.405060e-01 1 1  ON 10
 ud_1                 8.650782e-02 1 1  ON 11
 ud_2                -1.578735e-02 1 1  ON 12
 ud_3                -7.088943e-02 1 1  ON 13
 ud_4                -1.163510e-01 1 1  ON 14
 ud_5                -1.494512e-01 1 1  ON 15
 ud_6                -1.553898e-01 1 1  ON 16
 ud_7                -1.100188e-01 1 1  ON 17
 ud_8                 6.928350e-03 1 1  ON 18
 ud_9                 9.254719e-02 1 1  ON 19
 eO_0                -7.287226e-01 1 1  ON 20
 eO_1                -4.231260e-01 1 1  ON 21
 eO_2                -3.837323e-02 1 1  ON 22
 eO_3                 1.940248e-01 1 1  ON 23
 eO_4                 2.763266e-01 1 1  ON 24
 eO_5                 3.042128e-01 1 1  ON 25
 eO_6                 2.488362e-01 1 1  ON 26
 eO_7                 1.103216e-01 1 1  ON 27
 eO_8                 2.769766e-02 1 1  ON 28
 eO_9                 1.831831e-02 1 1  ON 29
eH1_0                -1.790793e-01 1 1  ON 30
eH1_1                -1.009085e-01 1 1  ON 31
eH1_2                -6.220406e-02 1 1  ON 32
eH1_3                -2.652106e-02 1 1  ON 33
eH1_4                 1.924251e-02 1 1  ON 34
eH1_5                 3.308699e-02 1 1  ON 35
eH1_6                 7.692554e-02 1 1  ON 36
eH1_7                 1.105616e-01 1 1  ON 37
eH1_8                 8.970676e-02 1 1  ON 38
eH1_9                 2.400403e-02 1 1  ON 39
eH2_0                -1.813296e-01 1 1  ON 40
eH2_1                -1.026041e-01 1 1  ON 41
eH2_2                -6.371645e-02 1 1  ON 42
eH2_3                -2.775413e-02 1 1  ON 43
eH2_4                 1.807794e-02 1 1  ON 44
eH2_5                 3.397180e-02 1 1  ON 45
eH2_6                 7.850238e-02 1 1  ON 46
eH2_7                 1.138916e-01 1 1  ON 47
eH2_8                 9.277902e-02 1 1  ON 48
eH2_9                 2.612866e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6086e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2112
    reference variance = 0.22343
====================================================
  Execution time = 3.1913e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3130e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5715e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331420285771
                                         uncertainty =       0.007156947450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331420285771
                                         uncertainty =       0.007156947450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407003360
  error estimate for blocks of size 2^( 2) =       0.000416385274
  error estimate for blocks of size 2^( 3) =       0.000425255391
  error estimate for blocks of size 2^( 4) =       0.000431667756
  error estimate for blocks of size 2^( 5) =       0.000435537720
  error estimate for blocks of size 2^( 6) =       0.000436821264
  error estimate for blocks of size 2^( 7) =       0.000438889080

      target function =                  N/A
              le_mean =     -17.216094830795
             les_mean =     296.725224527666
             stat err =       0.000435728955
             autocorr =       1.146137841425
              std dev =       0.575589671900
             le_variance =       0.331303470398


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721609483079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216094830795       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216094933937       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216095137146       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216095371666       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216095302691       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216095364117       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216095372023       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216095366343       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216095373222       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.519226e-04

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216094830795       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216094856920       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216094909079       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216094967049       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216094950084       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216094965475       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216094967000       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216094965697       residual = 8.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 3.821295e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216094830795       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216094837348       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216094850474       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216094864922       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216094860701       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216094864552       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216094864904       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216094864586       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 9.568798e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216523 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0491e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.023742e-01 1 1  ON 0
 uu_1                 4.323855e-02 1 1  ON 1
 uu_2                -4.821873e-02 1 1  ON 2
 uu_3                -9.946770e-02 1 1  ON 3
 uu_4                -1.292248e-01 1 1  ON 4
 uu_5                -1.339819e-01 1 1  ON 5
 uu_6                -1.111158e-01 1 1  ON 6
 uu_7                -3.658312e-02 1 1  ON 7
 uu_8                 1.014476e-01 1 1  ON 8
 uu_9                 1.199281e-01 1 1  ON 9
 ud_0                 3.405155e-01 1 1  ON 10
 ud_1                 8.651417e-02 1 1  ON 11
 ud_2                -1.578958e-02 1 1  ON 12
 ud_3                -7.089481e-02 1 1  ON 13
 ud_4                -1.163613e-01 1 1  ON 14
 ud_5                -1.494509e-01 1 1  ON 15
 ud_6                -1.553860e-01 1 1  ON 16
 ud_7                -1.100187e-01 1 1  ON 17
 ud_8                 6.924692e-03 1 1  ON 18
 ud_9                 9.254716e-02 1 1  ON 19
 eO_0                -7.287608e-01 1 1  ON 20
 eO_1                -4.231422e-01 1 1  ON 21
 eO_2                -3.836989e-02 1 1  ON 22
 eO_3                 1.940514e-01 1 1  ON 23
 eO_4                 2.763439e-01 1 1  ON 24
 eO_5                 3.042139e-01 1 1  ON 25
 eO_6                 2.488386e-01 1 1  ON 26
 eO_7                 1.103244e-01 1 1  ON 27
 eO_8                 2.769804e-02 1 1  ON 28
 eO_9                 1.831853e-02 1 1  ON 29
eH1_0                -1.790852e-01 1 1  ON 30
eH1_1                -1.009102e-01 1 1  ON 31
eH1_2                -6.220380e-02 1 1  ON 32
eH1_3                -2.652156e-02 1 1  ON 33
eH1_4                 1.924289e-02 1 1  ON 34
eH1_5                 3.309100e-02 1 1  ON 35
eH1_6                 7.692675e-02 1 1  ON 36
eH1_7                 1.105616e-01 1 1  ON 37
eH1_8                 8.970833e-02 1 1  ON 38
eH1_9                 2.400452e-02 1 1  ON 39
eH2_0                -1.813315e-01 1 1  ON 40
eH2_1                -1.026034e-01 1 1  ON 41
eH2_2                -6.371514e-02 1 1  ON 42
eH2_3                -2.775641e-02 1 1  ON 43
eH2_4                 1.807928e-02 1 1  ON 44
eH2_5                 3.397233e-02 1 1  ON 45
eH2_6                 7.850092e-02 1 1  ON 46
eH2_7                 1.138911e-01 1 1  ON 47
eH2_8                 9.278074e-02 1 1  ON 48
eH2_9                 2.612918e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1217
    reference variance = 0.392009
====================================================
  Execution time = 3.1393e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2060e-01
  Total weights = 2.0000e+06
  Execution time = 2.8689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320512221956
                                         uncertainty =       0.005282405103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320512221956
                                         uncertainty =       0.005282405103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400369799
  error estimate for blocks of size 2^( 2) =       0.000409925009
  error estimate for blocks of size 2^( 3) =       0.000418896815
  error estimate for blocks of size 2^( 4) =       0.000425025475
  error estimate for blocks of size 2^( 5) =       0.000429447931
  error estimate for blocks of size 2^( 6) =       0.000431507502
  error estimate for blocks of size 2^( 7) =       0.000432045191

      target function =                  N/A
              le_mean =     -17.215327461866
             les_mean =     296.688091410708
             stat err =       0.000429506525
             autocorr =       1.150845202709
              std dev =       0.566208399560
             le_variance =       0.320591951732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320550229641
                                         uncertainty =       0.005282503201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320550229641
                                         uncertainty =       0.005282503201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400393527
  error estimate for blocks of size 2^( 2) =       0.000409946899
  error estimate for blocks of size 2^( 3) =       0.000418916950
  error estimate for blocks of size 2^( 4) =       0.000425044256
  error estimate for blocks of size 2^( 5) =       0.000429466272
  error estimate for blocks of size 2^( 6) =       0.000431525056
  error estimate for blocks of size 2^( 7) =       0.000432062957

      target function =                  N/A
              le_mean =     -17.215327310806
             les_mean =     296.688124210239
             stat err =       0.000429524636
             autocorr =       1.150805851086
              std dev =       0.566241955683
             le_variance =       0.320629952375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320531386735
                                         uncertainty =       0.005282457234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320531386735
                                         uncertainty =       0.005282457234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400381763
  error estimate for blocks of size 2^( 2) =       0.000409936038
  error estimate for blocks of size 2^( 3) =       0.000418906960
  error estimate for blocks of size 2^( 4) =       0.000425034941
  error estimate for blocks of size 2^( 5) =       0.000429457184
  error estimate for blocks of size 2^( 6) =       0.000431516358
  error estimate for blocks of size 2^( 7) =       0.000432054161

      target function =                  N/A
              le_mean =     -17.215327383013
             les_mean =     296.688107856999
             stat err =       0.000429515661
             autocorr =       1.150825381742
              std dev =       0.566225319978
             le_variance =       0.320611112984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320514622617
                                         uncertainty =       0.005282411701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320514622617
                                         uncertainty =       0.005282411701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400371298
  error estimate for blocks of size 2^( 2) =       0.000409926391
  error estimate for blocks of size 2^( 3) =       0.000418898086
  error estimate for blocks of size 2^( 4) =       0.000425026660
  error estimate for blocks of size 2^( 5) =       0.000429449090
  error estimate for blocks of size 2^( 6) =       0.000431508612
  error estimate for blocks of size 2^( 7) =       0.000432046315

      target function =                  N/A
              le_mean =     -17.215327451735
             les_mean =     296.688093462098
             stat err =       0.000429507669
             autocorr =       1.150842719133
              std dev =       0.566210519106
             le_variance =       0.320594351946


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215327461866        initial  <--
     9.7656e+00     9.7656e+01             1.5192e-04       -17.215327310806
     3.9062e+01     3.9062e+02             3.8213e-05       -17.215327383013
     1.5625e+02     1.5625e+03             9.5688e-06       -17.215327451735

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.8526
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.023632e-01 1 1  ON 0
 uu_1                 4.323333e-02 1 1  ON 1
 uu_2                -4.821950e-02 1 1  ON 2
 uu_3                -9.946597e-02 1 1  ON 3
 uu_4                -1.292166e-01 1 1  ON 4
 uu_5                -1.339797e-01 1 1  ON 5
 uu_6                -1.111141e-01 1 1  ON 6
 uu_7                -3.657855e-02 1 1  ON 7
 uu_8                 1.014499e-01 1 1  ON 8
 uu_9                 1.199265e-01 1 1  ON 9
 ud_0                 3.405060e-01 1 1  ON 10
 ud_1                 8.650782e-02 1 1  ON 11
 ud_2                -1.578735e-02 1 1  ON 12
 ud_3                -7.088943e-02 1 1  ON 13
 ud_4                -1.163510e-01 1 1  ON 14
 ud_5                -1.494512e-01 1 1  ON 15
 ud_6                -1.553898e-01 1 1  ON 16
 ud_7                -1.100188e-01 1 1  ON 17
 ud_8                 6.928350e-03 1 1  ON 18
 ud_9                 9.254719e-02 1 1  ON 19
 eO_0                -7.287226e-01 1 1  ON 20
 eO_1                -4.231260e-01 1 1  ON 21
 eO_2                -3.837323e-02 1 1  ON 22
 eO_3                 1.940248e-01 1 1  ON 23
 eO_4                 2.763266e-01 1 1  ON 24
 eO_5                 3.042128e-01 1 1  ON 25
 eO_6                 2.488362e-01 1 1  ON 26
 eO_7                 1.103216e-01 1 1  ON 27
 eO_8                 2.769766e-02 1 1  ON 28
 eO_9                 1.831831e-02 1 1  ON 29
eH1_0                -1.790793e-01 1 1  ON 30
eH1_1                -1.009085e-01 1 1  ON 31
eH1_2                -6.220406e-02 1 1  ON 32
eH1_3                -2.652106e-02 1 1  ON 33
eH1_4                 1.924251e-02 1 1  ON 34
eH1_5                 3.308699e-02 1 1  ON 35
eH1_6                 7.692554e-02 1 1  ON 36
eH1_7                 1.105616e-01 1 1  ON 37
eH1_8                 8.970676e-02 1 1  ON 38
eH1_9                 2.400403e-02 1 1  ON 39
eH2_0                -1.813296e-01 1 1  ON 40
eH2_1                -1.026041e-01 1 1  ON 41
eH2_2                -6.371645e-02 1 1  ON 42
eH2_3                -2.775413e-02 1 1  ON 43
eH2_4                 1.807794e-02 1 1  ON 44
eH2_5                 3.397180e-02 1 1  ON 45
eH2_6                 7.850238e-02 1 1  ON 46
eH2_7                 1.138916e-01 1 1  ON 47
eH2_8                 9.277902e-02 1 1  ON 48
eH2_9                 2.612866e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6349e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.3445
    reference variance = 1.26559
====================================================
  Execution time = 3.1919e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1444e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7536e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314386274287
                                         uncertainty =       0.003359420039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314386274287
                                         uncertainty =       0.003359420039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396508817
  error estimate for blocks of size 2^( 2) =       0.000406469574
  error estimate for blocks of size 2^( 3) =       0.000415601642
  error estimate for blocks of size 2^( 4) =       0.000421949510
  error estimate for blocks of size 2^( 5) =       0.000425529021
  error estimate for blocks of size 2^( 6) =       0.000428315548
  error estimate for blocks of size 2^( 7) =       0.000430415982

      target function =                  N/A
              le_mean =     -17.216364182083
             les_mean =     296.717633977015
             stat err =       0.000426552515
             autocorr =       1.157282313551
              std dev =       0.560748146786
             le_variance =       0.314438484124


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721636418208e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216364182083       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216364193709       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216364218929       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216364251070       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216364267174       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216364267282       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216364266798       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216364265216       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 1.554306e-05

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216364182083       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216364184994       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216364191296       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216364199341       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216364203369       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216364203399       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216364203284       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216364202886       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 3.888494e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216364182083       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216364182811       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216364184386       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216364186398       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216364187405       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216364187413       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216364187385       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216364187284       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 9.722942e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219156 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1111e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.023644e-01 1 1  ON 0
 uu_1                 4.323380e-02 1 1  ON 1
 uu_2                -4.821958e-02 1 1  ON 2
 uu_3                -9.946628e-02 1 1  ON 3
 uu_4                -1.292174e-01 1 1  ON 4
 uu_5                -1.339799e-01 1 1  ON 5
 uu_6                -1.111142e-01 1 1  ON 6
 uu_7                -3.657887e-02 1 1  ON 7
 uu_8                 1.014497e-01 1 1  ON 8
 uu_9                 1.199267e-01 1 1  ON 9
 ud_0                 3.405070e-01 1 1  ON 10
 ud_1                 8.650827e-02 1 1  ON 11
 ud_2                -1.578731e-02 1 1  ON 12
 ud_3                -7.088999e-02 1 1  ON 13
 ud_4                -1.163519e-01 1 1  ON 14
 ud_5                -1.494511e-01 1 1  ON 15
 ud_6                -1.553895e-01 1 1  ON 16
 ud_7                -1.100189e-01 1 1  ON 17
 ud_8                 6.927956e-03 1 1  ON 18
 ud_9                 9.254718e-02 1 1  ON 19
 eO_0                -7.287265e-01 1 1  ON 20
 eO_1                -4.231274e-01 1 1  ON 21
 eO_2                -3.837311e-02 1 1  ON 22
 eO_3                 1.940273e-01 1 1  ON 23
 eO_4                 2.763284e-01 1 1  ON 24
 eO_5                 3.042130e-01 1 1  ON 25
 eO_6                 2.488363e-01 1 1  ON 26
 eO_7                 1.103219e-01 1 1  ON 27
 eO_8                 2.769769e-02 1 1  ON 28
 eO_9                 1.831833e-02 1 1  ON 29
eH1_0                -1.790799e-01 1 1  ON 30
eH1_1                -1.009087e-01 1 1  ON 31
eH1_2                -6.220373e-02 1 1  ON 32
eH1_3                -2.652098e-02 1 1  ON 33
eH1_4                 1.924252e-02 1 1  ON 34
eH1_5                 3.308734e-02 1 1  ON 35
eH1_6                 7.692545e-02 1 1  ON 36
eH1_7                 1.105615e-01 1 1  ON 37
eH1_8                 8.970692e-02 1 1  ON 38
eH1_9                 2.400408e-02 1 1  ON 39
eH2_0                -1.813300e-01 1 1  ON 40
eH2_1                -1.026042e-01 1 1  ON 41
eH2_2                -6.371628e-02 1 1  ON 42
eH2_3                -2.775439e-02 1 1  ON 43
eH2_4                 1.807810e-02 1 1  ON 44
eH2_5                 3.397206e-02 1 1  ON 45
eH2_6                 7.850235e-02 1 1  ON 46
eH2_7                 1.138916e-01 1 1  ON 47
eH2_8                 9.277917e-02 1 1  ON 48
eH2_9                 2.612872e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2449
    reference variance = 0.295499
====================================================
  Execution time = 3.1879e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1635e-01
  Total weights = 2.0000e+06
  Execution time = 2.8737e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316480820413
                                         uncertainty =       0.005009024277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316480820413
                                         uncertainty =       0.005009024277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397712917
  error estimate for blocks of size 2^( 2) =       0.000407456514
  error estimate for blocks of size 2^( 3) =       0.000416984260
  error estimate for blocks of size 2^( 4) =       0.000423247803
  error estimate for blocks of size 2^( 5) =       0.000427155232
  error estimate for blocks of size 2^( 6) =       0.000429735494
  error estimate for blocks of size 2^( 7) =       0.000430886860

      target function =                  N/A
              le_mean =     -17.215484985539
             les_mean =     296.689274258143
             stat err =       0.000427756347
             autocorr =       1.156787354584
              std dev =       0.562451001429
             le_variance =       0.316351129008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316484428435
                                         uncertainty =       0.005009061809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316484428435
                                         uncertainty =       0.005009061809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397715184
  error estimate for blocks of size 2^( 2) =       0.000407458602
  error estimate for blocks of size 2^( 3) =       0.000416986188
  error estimate for blocks of size 2^( 4) =       0.000423249635
  error estimate for blocks of size 2^( 5) =       0.000427157021
  error estimate for blocks of size 2^( 6) =       0.000429737279
  error estimate for blocks of size 2^( 7) =       0.000430888676

      target function =                  N/A
              le_mean =     -17.215484992988
             les_mean =     296.689278120094
             stat err =       0.000427758153
             autocorr =       1.156783934465
              std dev =       0.562454206545
             le_variance =       0.316354734460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316482626846
                                         uncertainty =       0.005009043091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316482626846
                                         uncertainty =       0.005009043091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397714052
  error estimate for blocks of size 2^( 2) =       0.000407457559
  error estimate for blocks of size 2^( 3) =       0.000416985226
  error estimate for blocks of size 2^( 4) =       0.000423248721
  error estimate for blocks of size 2^( 5) =       0.000427156128
  error estimate for blocks of size 2^( 6) =       0.000429736388
  error estimate for blocks of size 2^( 7) =       0.000430887769

      target function =                  N/A
              le_mean =     -17.215484989263
             les_mean =     296.689276191504
             stat err =       0.000427757251
             autocorr =       1.156785642770
              std dev =       0.562452606142
             le_variance =       0.316352934156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316481046285
                                         uncertainty =       0.005009026630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316481046285
                                         uncertainty =       0.005009026630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397713059
  error estimate for blocks of size 2^( 2) =       0.000407456644
  error estimate for blocks of size 2^( 3) =       0.000416984381
  error estimate for blocks of size 2^( 4) =       0.000423247918
  error estimate for blocks of size 2^( 5) =       0.000427155344
  error estimate for blocks of size 2^( 6) =       0.000429735606
  error estimate for blocks of size 2^( 7) =       0.000430886974

      target function =                  N/A
              le_mean =     -17.215484986003
             les_mean =     296.689274499840
             stat err =       0.000427756461
             autocorr =       1.156787140549
              std dev =       0.562451202079
             le_variance =       0.316351354720


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215484985539        initial
     9.7656e+01     9.7656e+02             1.5543e-05       -17.215484992988  <--
     3.9062e+02     3.9062e+03             3.8885e-06       -17.215484989263
     1.5625e+03     1.5625e+04             9.7229e-07       -17.215484986003

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 4.6335e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.023677e-01 1 1  ON 0
 uu_1                 4.323523e-02 1 1  ON 1
 uu_2                -4.821980e-02 1 1  ON 2
 uu_3                -9.946722e-02 1 1  ON 3
 uu_4                -1.292197e-01 1 1  ON 4
 uu_5                -1.339806e-01 1 1  ON 5
 uu_6                -1.111144e-01 1 1  ON 6
 uu_7                -3.657982e-02 1 1  ON 7
 uu_8                 1.014491e-01 1 1  ON 8
 uu_9                 1.199272e-01 1 1  ON 9
 ud_0                 3.405098e-01 1 1  ON 10
 ud_1                 8.650961e-02 1 1  ON 11
 ud_2                -1.578720e-02 1 1  ON 12
 ud_3                -7.089167e-02 1 1  ON 13
 ud_4                -1.163547e-01 1 1  ON 14
 ud_5                -1.494510e-01 1 1  ON 15
 ud_6                -1.553886e-01 1 1  ON 16
 ud_7                -1.100193e-01 1 1  ON 17
 ud_8                 6.926775e-03 1 1  ON 18
 ud_9                 9.254717e-02 1 1  ON 19
 eO_0                -7.287382e-01 1 1  ON 20
 eO_1                -4.231314e-01 1 1  ON 21
 eO_2                -3.837274e-02 1 1  ON 22
 eO_3                 1.940350e-01 1 1  ON 23
 eO_4                 2.763340e-01 1 1  ON 24
 eO_5                 3.042134e-01 1 1  ON 25
 eO_6                 2.488369e-01 1 1  ON 26
 eO_7                 1.103229e-01 1 1  ON 27
 eO_8                 2.769777e-02 1 1  ON 28
 eO_9                 1.831840e-02 1 1  ON 29
eH1_0                -1.790817e-01 1 1  ON 30
eH1_1                -1.009092e-01 1 1  ON 31
eH1_2                -6.220273e-02 1 1  ON 32
eH1_3                -2.652072e-02 1 1  ON 33
eH1_4                 1.924254e-02 1 1  ON 34
eH1_5                 3.308837e-02 1 1  ON 35
eH1_6                 7.692520e-02 1 1  ON 36
eH1_7                 1.105611e-01 1 1  ON 37
eH1_8                 8.970742e-02 1 1  ON 38
eH1_9                 2.400425e-02 1 1  ON 39
eH2_0                -1.813311e-01 1 1  ON 40
eH2_1                -1.026045e-01 1 1  ON 41
eH2_2                -6.371577e-02 1 1  ON 42
eH2_3                -2.775516e-02 1 1  ON 43
eH2_4                 1.807859e-02 1 1  ON 44
eH2_5                 3.397285e-02 1 1  ON 45
eH2_6                 7.850224e-02 1 1  ON 46
eH2_7                 1.138913e-01 1 1  ON 47
eH2_8                 9.277960e-02 1 1  ON 48
eH2_9                 2.612890e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.7451e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1975
    reference variance = 0.137921
====================================================
  Execution time = 3.1749e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2617e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326133912772
                                         uncertainty =       0.007077954901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326133912772
                                         uncertainty =       0.007077954901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403835750
  error estimate for blocks of size 2^( 2) =       0.000413581973
  error estimate for blocks of size 2^( 3) =       0.000422538278
  error estimate for blocks of size 2^( 4) =       0.000428490733
  error estimate for blocks of size 2^( 5) =       0.000432114915
  error estimate for blocks of size 2^( 6) =       0.000433938743
  error estimate for blocks of size 2^( 7) =       0.000436262951

      target function =                  N/A
              le_mean =     -17.217061186757
             les_mean =     296.753362371786
             stat err =       0.000432701835
             autocorr =       1.148068890717
              std dev =       0.571109994949
             le_variance =       0.326166626331


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721706118676e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217061186757       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217061219531       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217061237116       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217061397692       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217061437849       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217061448165       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217061454294       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217061450936       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 5.855520e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217061186757       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217061194991       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217061199416       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217061239691       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217061249790       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217061252281       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217061253776       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217061252933       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 1.467305e-05

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217061186757       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217061188818       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217061189926       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217061200003       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217061202532       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217061203149       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217061203520       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217061203309       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 3.670413e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221882 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0382e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.023727e-01 1 1  ON 0
 uu_1                 4.323616e-02 1 1  ON 1
 uu_2                -4.821982e-02 1 1  ON 2
 uu_3                -9.946816e-02 1 1  ON 3
 uu_4                -1.292228e-01 1 1  ON 4
 uu_5                -1.339815e-01 1 1  ON 5
 uu_6                -1.111152e-01 1 1  ON 6
 uu_7                -3.658099e-02 1 1  ON 7
 uu_8                 1.014486e-01 1 1  ON 8
 uu_9                 1.199279e-01 1 1  ON 9
 ud_0                 3.405142e-01 1 1  ON 10
 ud_1                 8.651156e-02 1 1  ON 11
 ud_2                -1.578691e-02 1 1  ON 12
 ud_3                -7.089424e-02 1 1  ON 13
 ud_4                -1.163583e-01 1 1  ON 14
 ud_5                -1.494525e-01 1 1  ON 15
 ud_6                -1.553875e-01 1 1  ON 16
 ud_7                -1.100190e-01 1 1  ON 17
 ud_8                 6.925605e-03 1 1  ON 18
 ud_9                 9.254718e-02 1 1  ON 19
 eO_0                -7.287528e-01 1 1  ON 20
 eO_1                -4.231378e-01 1 1  ON 21
 eO_2                -3.837077e-02 1 1  ON 22
 eO_3                 1.940443e-01 1 1  ON 23
 eO_4                 2.763407e-01 1 1  ON 24
 eO_5                 3.042138e-01 1 1  ON 25
 eO_6                 2.488377e-01 1 1  ON 26
 eO_7                 1.103242e-01 1 1  ON 27
 eO_8                 2.769801e-02 1 1  ON 28
 eO_9                 1.831851e-02 1 1  ON 29
eH1_0                -1.790836e-01 1 1  ON 30
eH1_1                -1.009107e-01 1 1  ON 31
eH1_2                -6.220242e-02 1 1  ON 32
eH1_3                -2.652119e-02 1 1  ON 33
eH1_4                 1.924271e-02 1 1  ON 34
eH1_5                 3.309038e-02 1 1  ON 35
eH1_6                 7.692541e-02 1 1  ON 36
eH1_7                 1.105611e-01 1 1  ON 37
eH1_8                 8.970830e-02 1 1  ON 38
eH1_9                 2.400448e-02 1 1  ON 39
eH2_0                -1.813320e-01 1 1  ON 40
eH2_1                -1.026059e-01 1 1  ON 41
eH2_2                -6.371521e-02 1 1  ON 42
eH2_3                -2.775462e-02 1 1  ON 43
eH2_4                 1.807965e-02 1 1  ON 44
eH2_5                 3.397342e-02 1 1  ON 45
eH2_6                 7.850129e-02 1 1  ON 46
eH2_7                 1.138908e-01 1 1  ON 47
eH2_8                 9.278032e-02 1 1  ON 48
eH2_9                 2.612910e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2531
    reference variance = 0.21449
====================================================
  Execution time = 3.0936e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1999e-01
  Total weights = 2.0000e+06
  Execution time = 2.8559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320097865924
                                         uncertainty =       0.004787816892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320097865924
                                         uncertainty =       0.004787816892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399991197
  error estimate for blocks of size 2^( 2) =       0.000409939758
  error estimate for blocks of size 2^( 3) =       0.000418543322
  error estimate for blocks of size 2^( 4) =       0.000424843653
  error estimate for blocks of size 2^( 5) =       0.000430351508
  error estimate for blocks of size 2^( 6) =       0.000432606378
  error estimate for blocks of size 2^( 7) =       0.000433386700

      target function =                  N/A
              le_mean =     -17.216655451705
             les_mean =     296.733210698608
             stat err =       0.000430297060
             autocorr =       1.157273182395
              std dev =       0.565672976091
             le_variance =       0.319985915880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320113378634
                                         uncertainty =       0.004788106056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320113378634
                                         uncertainty =       0.004788106056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400000890
  error estimate for blocks of size 2^( 2) =       0.000409948811
  error estimate for blocks of size 2^( 3) =       0.000418551762
  error estimate for blocks of size 2^( 4) =       0.000424851549
  error estimate for blocks of size 2^( 5) =       0.000430359339
  error estimate for blocks of size 2^( 6) =       0.000432613888
  error estimate for blocks of size 2^( 7) =       0.000433394196

      target function =                  N/A
              le_mean =     -17.216655512695
             les_mean =     296.733228306366
             stat err =       0.000430304743
             autocorr =       1.157258425057
              std dev =       0.565686683209
             le_variance =       0.320001423560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320105659413
                                         uncertainty =       0.004787962384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320105659413
                                         uncertainty =       0.004787962384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399996067
  error estimate for blocks of size 2^( 2) =       0.000409944306
  error estimate for blocks of size 2^( 3) =       0.000418547563
  error estimate for blocks of size 2^( 4) =       0.000424847621
  error estimate for blocks of size 2^( 5) =       0.000430355444
  error estimate for blocks of size 2^( 6) =       0.000432610152
  error estimate for blocks of size 2^( 7) =       0.000433390468

      target function =                  N/A
              le_mean =     -17.216655482239
             les_mean =     296.733219540969
             stat err =       0.000430300921
             autocorr =       1.157265775846
              std dev =       0.565679862509
             le_variance =       0.319993706848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320098841171
                                         uncertainty =       0.004787835107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320098841171
                                         uncertainty =       0.004787835107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399991807
  error estimate for blocks of size 2^( 2) =       0.000409940327
  error estimate for blocks of size 2^( 3) =       0.000418543852
  error estimate for blocks of size 2^( 4) =       0.000424844149
  error estimate for blocks of size 2^( 5) =       0.000430352000
  error estimate for blocks of size 2^( 6) =       0.000432606851
  error estimate for blocks of size 2^( 7) =       0.000433387171

      target function =                  N/A
              le_mean =     -17.216655455506
             les_mean =     296.733211804418
             stat err =       0.000430297543
             autocorr =       1.157272255593
              std dev =       0.565673837836
             le_variance =       0.319986890812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216655451705        initial
     2.4414e+01     2.4414e+02             5.8555e-05       -17.216655512695  <--
     9.7656e+01     9.7656e+02             1.4673e-05       -17.216655482239
     3.9062e+02     3.9062e+03             3.6704e-06       -17.216655455506

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 4.5347e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.023874e-01 1 1  ON 0
 uu_1                 4.323900e-02 1 1  ON 1
 uu_2                -4.821987e-02 1 1  ON 2
 uu_3                -9.947102e-02 1 1  ON 3
 uu_4                -1.292321e-01 1 1  ON 4
 uu_5                -1.339843e-01 1 1  ON 5
 uu_6                -1.111175e-01 1 1  ON 6
 uu_7                -3.658449e-02 1 1  ON 7
 uu_8                 1.014470e-01 1 1  ON 8
 uu_9                 1.199299e-01 1 1  ON 9
 ud_0                 3.405273e-01 1 1  ON 10
 ud_1                 8.651740e-02 1 1  ON 11
 ud_2                -1.578606e-02 1 1  ON 12
 ud_3                -7.090191e-02 1 1  ON 13
 ud_4                -1.163689e-01 1 1  ON 14
 ud_5                -1.494571e-01 1 1  ON 15
 ud_6                -1.553842e-01 1 1  ON 16
 ud_7                -1.100181e-01 1 1  ON 17
 ud_8                 6.922104e-03 1 1  ON 18
 ud_9                 9.254722e-02 1 1  ON 19
 eO_0                -7.287967e-01 1 1  ON 20
 eO_1                -4.231570e-01 1 1  ON 21
 eO_2                -3.836494e-02 1 1  ON 22
 eO_3                 1.940721e-01 1 1  ON 23
 eO_4                 2.763608e-01 1 1  ON 24
 eO_5                 3.042152e-01 1 1  ON 25
 eO_6                 2.488404e-01 1 1  ON 26
 eO_7                 1.103280e-01 1 1  ON 27
 eO_8                 2.769872e-02 1 1  ON 28
 eO_9                 1.831886e-02 1 1  ON 29
eH1_0                -1.790892e-01 1 1  ON 30
eH1_1                -1.009153e-01 1 1  ON 31
eH1_2                -6.220149e-02 1 1  ON 32
eH1_3                -2.652258e-02 1 1  ON 33
eH1_4                 1.924319e-02 1 1  ON 34
eH1_5                 3.309641e-02 1 1  ON 35
eH1_6                 7.692605e-02 1 1  ON 36
eH1_7                 1.105611e-01 1 1  ON 37
eH1_8                 8.971093e-02 1 1  ON 38
eH1_9                 2.400516e-02 1 1  ON 39
eH2_0                -1.813349e-01 1 1  ON 40
eH2_1                -1.026100e-01 1 1  ON 41
eH2_2                -6.371355e-02 1 1  ON 42
eH2_3                -2.775301e-02 1 1  ON 43
eH2_4                 1.808280e-02 1 1  ON 44
eH2_5                 3.397514e-02 1 1  ON 45
eH2_6                 7.849846e-02 1 1  ON 46
eH2_7                 1.138893e-01 1 1  ON 47
eH2_8                 9.278245e-02 1 1  ON 48
eH2_9                 2.612971e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5733e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2006
    reference variance = 0.137068
====================================================
  Execution time = 3.1735e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2913e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6725e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329162419118
                                         uncertainty =       0.007909963864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329162419118
                                         uncertainty =       0.007909963864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405668098
  error estimate for blocks of size 2^( 2) =       0.000415582559
  error estimate for blocks of size 2^( 3) =       0.000423856242
  error estimate for blocks of size 2^( 4) =       0.000430258564
  error estimate for blocks of size 2^( 5) =       0.000433405051
  error estimate for blocks of size 2^( 6) =       0.000435914728
  error estimate for blocks of size 2^( 7) =       0.000438590425

      target function =                  N/A
              le_mean =     -17.215938663721
             les_mean =     296.717677119350
             stat err =       0.000434542192
             autocorr =       1.147419404442
              std dev =       0.573701325519
             le_variance =       0.329133210902


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721593866372e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215938663721       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215939272552       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215939806656       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215939865850       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215939955164       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215939953315       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215940029164       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215940028300       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.376052e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215938663721       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215938819625       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215938955537       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215938968916       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215938989368       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215938989281       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215939008222       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215939008315       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 5.988313e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215938663721       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215938702935       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215938737068       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215938740320       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215938745308       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215938745309       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215938750042       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215938750088       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 1.500128e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0414e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.024058e-01 1 1  ON 0
 uu_1                 4.324673e-02 1 1  ON 1
 uu_2                -4.821627e-02 1 1  ON 2
 uu_3                -9.947874e-02 1 1  ON 3
 uu_4                -1.292436e-01 1 1  ON 4
 uu_5                -1.339937e-01 1 1  ON 5
 uu_6                -1.111186e-01 1 1  ON 6
 uu_7                -3.658768e-02 1 1  ON 7
 uu_8                 1.014452e-01 1 1  ON 8
 uu_9                 1.199325e-01 1 1  ON 9
 ud_0                 3.405405e-01 1 1  ON 10
 ud_1                 8.652516e-02 1 1  ON 11
 ud_2                -1.578728e-02 1 1  ON 12
 ud_3                -7.091187e-02 1 1  ON 13
 ud_4                -1.163815e-01 1 1  ON 14
 ud_5                -1.494588e-01 1 1  ON 15
 ud_6                -1.553797e-01 1 1  ON 16
 ud_7                -1.100181e-01 1 1  ON 17
 ud_8                 6.918977e-03 1 1  ON 18
 ud_9                 9.254783e-02 1 1  ON 19
 eO_0                -7.288566e-01 1 1  ON 20
 eO_1                -4.231882e-01 1 1  ON 21
 eO_2                -3.835725e-02 1 1  ON 22
 eO_3                 1.941130e-01 1 1  ON 23
 eO_4                 2.763920e-01 1 1  ON 24
 eO_5                 3.042155e-01 1 1  ON 25
 eO_6                 2.488441e-01 1 1  ON 26
 eO_7                 1.103335e-01 1 1  ON 27
 eO_8                 2.769981e-02 1 1  ON 28
 eO_9                 1.831922e-02 1 1  ON 29
eH1_0                -1.790964e-01 1 1  ON 30
eH1_1                -1.009237e-01 1 1  ON 31
eH1_2                -6.220015e-02 1 1  ON 32
eH1_3                -2.652305e-02 1 1  ON 33
eH1_4                 1.924412e-02 1 1  ON 34
eH1_5                 3.310531e-02 1 1  ON 35
eH1_6                 7.692785e-02 1 1  ON 36
eH1_7                 1.105605e-01 1 1  ON 37
eH1_8                 8.971344e-02 1 1  ON 38
eH1_9                 2.400594e-02 1 1  ON 39
eH2_0                -1.813379e-01 1 1  ON 40
eH2_1                -1.026104e-01 1 1  ON 41
eH2_2                -6.371442e-02 1 1  ON 42
eH2_3                -2.775636e-02 1 1  ON 43
eH2_4                 1.808433e-02 1 1  ON 44
eH2_5                 3.397810e-02 1 1  ON 45
eH2_6                 7.849776e-02 1 1  ON 46
eH2_7                 1.138885e-01 1 1  ON 47
eH2_8                 9.278557e-02 1 1  ON 48
eH2_9                 2.613088e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2284
    reference variance = 0.242263
====================================================
  Execution time = 3.1186e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1464e-01
  Total weights = 2.0000e+06
  Execution time = 2.8684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314603180174
                                         uncertainty =       0.003623783594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314603180174
                                         uncertainty =       0.003623783594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396627856
  error estimate for blocks of size 2^( 2) =       0.000406057587
  error estimate for blocks of size 2^( 3) =       0.000414536396
  error estimate for blocks of size 2^( 4) =       0.000421172339
  error estimate for blocks of size 2^( 5) =       0.000424799470
  error estimate for blocks of size 2^( 6) =       0.000426706851
  error estimate for blocks of size 2^( 7) =       0.000426057361

      target function =                  N/A
              le_mean =     -17.216747955500
             les_mean =     296.731037318020
             stat err =       0.000424684005
             autocorr =       1.146477101397
              std dev =       0.560916492985
             le_variance =       0.314627312103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314656078345
                                         uncertainty =       0.003624332475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314656078345
                                         uncertainty =       0.003624332475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396661187
  error estimate for blocks of size 2^( 2) =       0.000406088490
  error estimate for blocks of size 2^( 3) =       0.000414564585
  error estimate for blocks of size 2^( 4) =       0.000421198651
  error estimate for blocks of size 2^( 5) =       0.000424824053
  error estimate for blocks of size 2^( 6) =       0.000426731437
  error estimate for blocks of size 2^( 7) =       0.000426080785

      target function =                  N/A
              le_mean =     -17.216748091405
             les_mean =     296.731094880448
             stat err =       0.000424708731
             autocorr =       1.146417914840
              std dev =       0.560963630642
             le_variance =       0.314680194903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314629834097
                                         uncertainty =       0.003624058528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314629834097
                                         uncertainty =       0.003624058528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396644651
  error estimate for blocks of size 2^( 2) =       0.000406073156
  error estimate for blocks of size 2^( 3) =       0.000414550593
  error estimate for blocks of size 2^( 4) =       0.000421185587
  error estimate for blocks of size 2^( 5) =       0.000424811839
  error estimate for blocks of size 2^( 6) =       0.000426719220
  error estimate for blocks of size 2^( 7) =       0.000426069121

      target function =                  N/A
              le_mean =     -17.216748020717
             les_mean =     296.731066209729
             stat err =       0.000424696442
             autocorr =       1.146447155032
              std dev =       0.560940244748
             le_variance =       0.314653958178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314606516543
                                         uncertainty =       0.003623817964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314606516543
                                         uncertainty =       0.003623817964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396629958
  error estimate for blocks of size 2^( 2) =       0.000406059535
  error estimate for blocks of size 2^( 3) =       0.000414538172
  error estimate for blocks of size 2^( 4) =       0.000421173997
  error estimate for blocks of size 2^( 5) =       0.000424801017
  error estimate for blocks of size 2^( 6) =       0.000426708398
  error estimate for blocks of size 2^( 7) =       0.000426058831

      target function =                  N/A
              le_mean =     -17.216747963292
             les_mean =     296.731040921698
             stat err =       0.000424685561
             autocorr =       1.146473345100
              std dev =       0.560919466132
             le_variance =       0.314630647485


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216747955500        initial
     6.1035e+00     6.1035e+01             2.3761e-04       -17.216748091405  <--
     2.4414e+01     2.4414e+02             5.9883e-05       -17.216748020717
     9.7656e+01     9.7656e+02             1.5001e-05       -17.216747963292

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 4.5661e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.024604e-01 1 1  ON 0
 uu_1                 4.327013e-02 1 1  ON 1
 uu_2                -4.820584e-02 1 1  ON 2
 uu_3                -9.950117e-02 1 1  ON 3
 uu_4                -1.292781e-01 1 1  ON 4
 uu_5                -1.340221e-01 1 1  ON 5
 uu_6                -1.111221e-01 1 1  ON 6
 uu_7                -3.659718e-02 1 1  ON 7
 uu_8                 1.014397e-01 1 1  ON 8
 uu_9                 1.199402e-01 1 1  ON 9
 ud_0                 3.405794e-01 1 1  ON 10
 ud_1                 8.654802e-02 1 1  ON 11
 ud_2                -1.579081e-02 1 1  ON 12
 ud_3                -7.094089e-02 1 1  ON 13
 ud_4                -1.164188e-01 1 1  ON 14
 ud_5                -1.494644e-01 1 1  ON 15
 ud_6                -1.553662e-01 1 1  ON 16
 ud_7                -1.100180e-01 1 1  ON 17
 ud_8                 6.909673e-03 1 1  ON 18
 ud_9                 9.254967e-02 1 1  ON 19
 eO_0                -7.290343e-01 1 1  ON 20
 eO_1                -4.232808e-01 1 1  ON 21
 eO_2                -3.833538e-02 1 1  ON 22
 eO_3                 1.942347e-01 1 1  ON 23
 eO_4                 2.764850e-01 1 1  ON 24
 eO_5                 3.042166e-01 1 1  ON 25
 eO_6                 2.488552e-01 1 1  ON 26
 eO_7                 1.103500e-01 1 1  ON 27
 eO_8                 2.770305e-02 1 1  ON 28
 eO_9                 1.832030e-02 1 1  ON 29
eH1_0                -1.791180e-01 1 1  ON 30
eH1_1                -1.009487e-01 1 1  ON 31
eH1_2                -6.219636e-02 1 1  ON 32
eH1_3                -2.652410e-02 1 1  ON 33
eH1_4                 1.924664e-02 1 1  ON 34
eH1_5                 3.313186e-02 1 1  ON 35
eH1_6                 7.693328e-02 1 1  ON 36
eH1_7                 1.105587e-01 1 1  ON 37
eH1_8                 8.972092e-02 1 1  ON 38
eH1_9                 2.400825e-02 1 1  ON 39
eH2_0                -1.813468e-01 1 1  ON 40
eH2_1                -1.026121e-01 1 1  ON 41
eH2_2                -6.371671e-02 1 1  ON 42
eH2_3                -2.776607e-02 1 1  ON 43
eH2_4                 1.808845e-02 1 1  ON 44
eH2_5                 3.398702e-02 1 1  ON 45
eH2_6                 7.849576e-02 1 1  ON 46
eH2_7                 1.138862e-01 1 1  ON 47
eH2_8                 9.279489e-02 1 1  ON 48
eH2_9                 2.613440e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6080e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1055
    reference variance = 0.389933
====================================================
  Execution time = 3.1871e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1512e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315107171522
                                         uncertainty =       0.003130314511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315107171522
                                         uncertainty =       0.003130314511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396939593
  error estimate for blocks of size 2^( 2) =       0.000406849133
  error estimate for blocks of size 2^( 3) =       0.000415596413
  error estimate for blocks of size 2^( 4) =       0.000422369900
  error estimate for blocks of size 2^( 5) =       0.000426699145
  error estimate for blocks of size 2^( 6) =       0.000428482487
  error estimate for blocks of size 2^( 7) =       0.000429825424

      target function =                  N/A
              le_mean =     -17.216616809926
             les_mean =     296.727016303182
             stat err =       0.000426844239
             autocorr =       1.156351873722
              std dev =       0.561357355798
             le_variance =       0.315122080909


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721661680993e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216616809926       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216617582621       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216618037652       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216619699742       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216621731908       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216622000248       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216622127769       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216622023588       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216622008808       residual = 1.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 9.165317e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216616809926       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216617017641       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216617146292       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216617582067       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216618092292       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216618145754       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216618174897       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216618158988       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.385723e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216616809926       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216616862851       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216616896134       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216617006467       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216617134102       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216617146409       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216617153451       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216617150231       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 6.029849e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227258 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0457e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.025311e-01 1 1  ON 0
 uu_1                 4.329310e-02 1 1  ON 1
 uu_2                -4.819668e-02 1 1  ON 2
 uu_3                -9.951413e-02 1 1  ON 3
 uu_4                -1.293250e-01 1 1  ON 4
 uu_5                -1.340375e-01 1 1  ON 5
 uu_6                -1.111471e-01 1 1  ON 6
 uu_7                -3.661359e-02 1 1  ON 7
 uu_8                 1.014318e-01 1 1  ON 8
 uu_9                 1.199507e-01 1 1  ON 9
 ud_0                 3.406359e-01 1 1  ON 10
 ud_1                 8.658569e-02 1 1  ON 11
 ud_2                -1.578724e-02 1 1  ON 12
 ud_3                -7.097715e-02 1 1  ON 13
 ud_4                -1.164586e-01 1 1  ON 14
 ud_5                -1.494844e-01 1 1  ON 15
 ud_6                -1.553575e-01 1 1  ON 16
 ud_7                -1.100241e-01 1 1  ON 17
 ud_8                 6.894290e-03 1 1  ON 18
 ud_9                 9.255044e-02 1 1  ON 19
 eO_0                -7.292729e-01 1 1  ON 20
 eO_1                -4.233770e-01 1 1  ON 21
 eO_2                -3.831646e-02 1 1  ON 22
 eO_3                 1.943900e-01 1 1  ON 23
 eO_4                 2.766052e-01 1 1  ON 24
 eO_5                 3.042173e-01 1 1  ON 25
 eO_6                 2.488662e-01 1 1  ON 26
 eO_7                 1.103729e-01 1 1  ON 27
 eO_8                 2.770698e-02 1 1  ON 28
 eO_9                 1.832150e-02 1 1  ON 29
eH1_0                -1.791422e-01 1 1  ON 30
eH1_1                -1.009615e-01 1 1  ON 31
eH1_2                -6.218908e-02 1 1  ON 32
eH1_3                -2.652680e-02 1 1  ON 33
eH1_4                 1.924767e-02 1 1  ON 34
eH1_5                 3.315139e-02 1 1  ON 35
eH1_6                 7.692568e-02 1 1  ON 36
eH1_7                 1.105576e-01 1 1  ON 37
eH1_8                 8.973517e-02 1 1  ON 38
eH1_9                 2.401296e-02 1 1  ON 39
eH2_0                -1.813625e-01 1 1  ON 40
eH2_1                -1.026279e-01 1 1  ON 41
eH2_2                -6.371682e-02 1 1  ON 42
eH2_3                -2.776098e-02 1 1  ON 43
eH2_4                 1.809473e-02 1 1  ON 44
eH2_5                 3.399467e-02 1 1  ON 45
eH2_6                 7.849870e-02 1 1  ON 46
eH2_7                 1.138802e-01 1 1  ON 47
eH2_8                 9.280471e-02 1 1  ON 48
eH2_9                 2.613840e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2754
    reference variance = 0.392878
====================================================
  Execution time = 3.1054e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1688e-01
  Total weights = 2.0000e+06
  Execution time = 2.8700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316735563597
                                         uncertainty =       0.003578874465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316735563597
                                         uncertainty =       0.003578874465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398016696
  error estimate for blocks of size 2^( 2) =       0.000407509558
  error estimate for blocks of size 2^( 3) =       0.000416276684
  error estimate for blocks of size 2^( 4) =       0.000422601664
  error estimate for blocks of size 2^( 5) =       0.000426224446
  error estimate for blocks of size 2^( 6) =       0.000428215073
  error estimate for blocks of size 2^( 7) =       0.000431327321

      target function =                  N/A
              le_mean =     -17.216043790745
             les_mean =     296.708998227259
             stat err =       0.000427092126
             autocorr =       1.151437974291
              std dev =       0.562880609736
             le_variance =       0.316834580817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316927582167
                                         uncertainty =       0.003582645948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316927582167
                                         uncertainty =       0.003582645948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398137263
  error estimate for blocks of size 2^( 2) =       0.000407620618
  error estimate for blocks of size 2^( 3) =       0.000416377868
  error estimate for blocks of size 2^( 4) =       0.000422696731
  error estimate for blocks of size 2^( 5) =       0.000426315304
  error estimate for blocks of size 2^( 6) =       0.000428303715
  error estimate for blocks of size 2^( 7) =       0.000431415616

      target function =                  N/A
              le_mean =     -17.216044125388
             les_mean =     296.709201728470
             stat err =       0.000427182842
             autocorr =       1.151229602888
              std dev =       0.563051116397
             le_variance =       0.317026559675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316835687058
                                         uncertainty =       0.003580846422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316835687058
                                         uncertainty =       0.003580846422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398079569
  error estimate for blocks of size 2^( 2) =       0.000407567484
  error estimate for blocks of size 2^( 3) =       0.000416329477
  error estimate for blocks of size 2^( 4) =       0.000422651272
  error estimate for blocks of size 2^( 5) =       0.000426271789
  error estimate for blocks of size 2^( 6) =       0.000428261322
  error estimate for blocks of size 2^( 7) =       0.000431373495

      target function =                  N/A
              le_mean =     -17.216043872861
             les_mean =     296.709101160426
             stat err =       0.000427139470
             autocorr =       1.151329495392
              std dev =       0.562969525492
             le_variance =       0.316934686633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316748131551
                                         uncertainty =       0.003579124235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316748131551
                                         uncertainty =       0.003579124235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398024589
  error estimate for blocks of size 2^( 2) =       0.000407516826
  error estimate for blocks of size 2^( 3) =       0.000416283303
  error estimate for blocks of size 2^( 4) =       0.000422607880
  error estimate for blocks of size 2^( 5) =       0.000426230374
  error estimate for blocks of size 2^( 6) =       0.000428220864
  error estimate for blocks of size 2^( 7) =       0.000431333098

      target function =                  N/A
              le_mean =     -17.216043794640
             les_mean =     296.709010927007
             stat err =       0.000427098054
             autocorr =       1.151424273219
              std dev =       0.562891771555
             le_variance =       0.316847146484


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216043790745        initial
     1.5259e+00     1.5259e+01             9.1653e-04       -17.216044125388  <--
     6.1035e+00     6.1035e+01             2.3857e-04       -17.216043872861
     2.4414e+01     2.4414e+02             6.0298e-05       -17.216043794640

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 4.7599e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.027361e-01 1 1  ON 0
 uu_1                 4.336548e-02 1 1  ON 1
 uu_2                -4.816867e-02 1 1  ON 2
 uu_3                -9.955227e-02 1 1  ON 3
 uu_4                -1.294530e-01 1 1  ON 4
 uu_5                -1.340936e-01 1 1  ON 5
 uu_6                -1.112225e-01 1 1  ON 6
 uu_7                -3.666294e-02 1 1  ON 7
 uu_8                 1.014078e-01 1 1  ON 8
 uu_9                 1.199825e-01 1 1  ON 9
 ud_0                 3.407967e-01 1 1  ON 10
 ud_1                 8.669489e-02 1 1  ON 11
 ud_2                -1.577397e-02 1 1  ON 12
 ud_3                -7.107294e-02 1 1  ON 13
 ud_4                -1.165758e-01 1 1  ON 14
 ud_5                -1.495489e-01 1 1  ON 15
 ud_6                -1.553333e-01 1 1  ON 16
 ud_7                -1.100419e-01 1 1  ON 17
 ud_8                 6.847972e-03 1 1  ON 18
 ud_9                 9.255280e-02 1 1  ON 19
 eO_0                -7.299508e-01 1 1  ON 20
 eO_1                -4.236747e-01 1 1  ON 21
 eO_2                -3.827339e-02 1 1  ON 22
 eO_3                 1.948292e-01 1 1  ON 23
 eO_4                 2.769694e-01 1 1  ON 24
 eO_5                 3.042249e-01 1 1  ON 25
 eO_6                 2.489002e-01 1 1  ON 26
 eO_7                 1.104423e-01 1 1  ON 27
 eO_8                 2.771889e-02 1 1  ON 28
 eO_9                 1.832516e-02 1 1  ON 29
eH1_0                -1.792107e-01 1 1  ON 30
eH1_1                -1.010013e-01 1 1  ON 31
eH1_2                -6.217279e-02 1 1  ON 32
eH1_3                -2.653202e-02 1 1  ON 33
eH1_4                 1.925120e-02 1 1  ON 34
eH1_5                 3.320633e-02 1 1  ON 35
eH1_6                 7.690473e-02 1 1  ON 36
eH1_7                 1.105548e-01 1 1  ON 37
eH1_8                 8.977842e-02 1 1  ON 38
eH1_9                 2.402723e-02 1 1  ON 39
eH2_0                -1.814063e-01 1 1  ON 40
eH2_1                -1.026717e-01 1 1  ON 41
eH2_2                -6.371608e-02 1 1  ON 42
eH2_3                -2.775243e-02 1 1  ON 43
eH2_4                 1.811089e-02 1 1  ON 44
eH2_5                 3.401577e-02 1 1  ON 45
eH2_6                 7.850964e-02 1 1  ON 46
eH2_7                 1.138628e-01 1 1  ON 47
eH2_8                 9.283452e-02 1 1  ON 48
eH2_9                 2.615052e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8061e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2146
    reference variance = 0.151697
====================================================
  Execution time = 3.2194e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1470e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314769393167
                                         uncertainty =       0.005671240065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314769393167
                                         uncertainty =       0.005671240065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396676768
  error estimate for blocks of size 2^( 2) =       0.000406577694
  error estimate for blocks of size 2^( 3) =       0.000415008374
  error estimate for blocks of size 2^( 4) =       0.000421468255
  error estimate for blocks of size 2^( 5) =       0.000425586678
  error estimate for blocks of size 2^( 6) =       0.000427822391
  error estimate for blocks of size 2^( 7) =       0.000431808064

      target function =                  N/A
              le_mean =     -17.216618493961
             les_mean =     296.726657126010
             stat err =       0.000426671347
             autocorr =       1.156946896013
              std dev =       0.560985665366
             le_variance =       0.314704916746


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721661849396e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216618493961       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216619178003       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216622667573       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216628563009       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216632880276       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216633223576       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216632777883       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216632634107       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216632404325       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216632180818       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 3.157896e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216618493961       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216618714038       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216619644847       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216620705176       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216622457478       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216622515962       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216622393479       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216622350089       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216622329191       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 8.911059e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216618493961       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216618553232       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216618788491       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216618998522       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216619487385       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216619503966       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216619479675       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216619468210       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.317097e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230343 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0988e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.029999e-01 1 1  ON 0
 uu_1                 4.351139e-02 1 1  ON 1
 uu_2                -4.815902e-02 1 1  ON 2
 uu_3                -9.962252e-02 1 1  ON 3
 uu_4                -1.296189e-01 1 1  ON 4
 uu_5                -1.342054e-01 1 1  ON 5
 uu_6                -1.112403e-01 1 1  ON 6
 uu_7                -3.671605e-02 1 1  ON 7
 uu_8                 1.013574e-01 1 1  ON 8
 uu_9                 1.200040e-01 1 1  ON 9
 ud_0                 3.410176e-01 1 1  ON 10
 ud_1                 8.677531e-02 1 1  ON 11
 ud_2                -1.573527e-02 1 1  ON 12
 ud_3                -7.119799e-02 1 1  ON 13
 ud_4                -1.167139e-01 1 1  ON 14
 ud_5                -1.495902e-01 1 1  ON 15
 ud_6                -1.552953e-01 1 1  ON 16
 ud_7                -1.100420e-01 1 1  ON 17
 ud_8                 6.754601e-03 1 1  ON 18
 ud_9                 9.254678e-02 1 1  ON 19
 eO_0                -7.308420e-01 1 1  ON 20
 eO_1                -4.240692e-01 1 1  ON 21
 eO_2                -3.818724e-02 1 1  ON 22
 eO_3                 1.953734e-01 1 1  ON 23
 eO_4                 2.774029e-01 1 1  ON 24
 eO_5                 3.042836e-01 1 1  ON 25
 eO_6                 2.489704e-01 1 1  ON 26
 eO_7                 1.105208e-01 1 1  ON 27
 eO_8                 2.772897e-02 1 1  ON 28
 eO_9                 1.832816e-02 1 1  ON 29
eH1_0                -1.792936e-01 1 1  ON 30
eH1_1                -1.010564e-01 1 1  ON 31
eH1_2                -6.213241e-02 1 1  ON 32
eH1_3                -2.650580e-02 1 1  ON 33
eH1_4                 1.921847e-02 1 1  ON 34
eH1_5                 3.323933e-02 1 1  ON 35
eH1_6                 7.692118e-02 1 1  ON 36
eH1_7                 1.105556e-01 1 1  ON 37
eH1_8                 8.982043e-02 1 1  ON 38
eH1_9                 2.403631e-02 1 1  ON 39
eH2_0                -1.814426e-01 1 1  ON 40
eH2_1                -1.027299e-01 1 1  ON 41
eH2_2                -6.368317e-02 1 1  ON 42
eH2_3                -2.777855e-02 1 1  ON 43
eH2_4                 1.809256e-02 1 1  ON 44
eH2_5                 3.408133e-02 1 1  ON 45
eH2_6                 7.850990e-02 1 1  ON 46
eH2_7                 1.138473e-01 1 1  ON 47
eH2_8                 9.287645e-02 1 1  ON 48
eH2_9                 2.616119e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2461
    reference variance = 0.384272
====================================================
  Execution time = 3.1176e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1968e-01
  Total weights = 2.0000e+06
  Execution time = 2.8629e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319407330988
                                         uncertainty =       0.002953037200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319407330988
                                         uncertainty =       0.002953037200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399663126
  error estimate for blocks of size 2^( 2) =       0.000409368138
  error estimate for blocks of size 2^( 3) =       0.000418393284
  error estimate for blocks of size 2^( 4) =       0.000425089262
  error estimate for blocks of size 2^( 5) =       0.000430356460
  error estimate for blocks of size 2^( 6) =       0.000431693329
  error estimate for blocks of size 2^( 7) =       0.000432941485

      target function =                  N/A
              le_mean =     -17.216687130401
             les_mean =     296.733776814686
             stat err =       0.000430020134
             autocorr =       1.157682367696
              std dev =       0.565209012920
             le_variance =       0.319461228286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320105824462
                                         uncertainty =       0.002958840050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320105824462
                                         uncertainty =       0.002958840050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400100027
  error estimate for blocks of size 2^( 2) =       0.000409779191
  error estimate for blocks of size 2^( 3) =       0.000418777274
  error estimate for blocks of size 2^( 4) =       0.000425450161
  error estimate for blocks of size 2^( 5) =       0.000430707724
  error estimate for blocks of size 2^( 6) =       0.000432026990
  error estimate for blocks of size 2^( 7) =       0.000433271973

      target function =                  N/A
              le_mean =     -17.216683996831
             les_mean =     296.734367749530
             stat err =       0.000430364212
             autocorr =       1.157004738495
              std dev =       0.565826884195
             le_variance =       0.320160062877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319838156813
                                         uncertainty =       0.002956569874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319838156813
                                         uncertainty =       0.002956569874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399932668
  error estimate for blocks of size 2^( 2) =       0.000409622467
  error estimate for blocks of size 2^( 3) =       0.000418632116
  error estimate for blocks of size 2^( 4) =       0.000425314529
  error estimate for blocks of size 2^( 5) =       0.000430576436
  error estimate for blocks of size 2^( 6) =       0.000431902291
  error estimate for blocks of size 2^( 7) =       0.000433148659

      target function =                  N/A
              le_mean =     -17.216684868532
             les_mean =     296.734129980856
             stat err =       0.000430235479
             autocorr =       1.157280620311
              std dev =       0.565590203636
             le_variance =       0.319892278448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319465626934
                                         uncertainty =       0.002953517006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319465626934
                                         uncertainty =       0.002953517006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399699611
  error estimate for blocks of size 2^( 2) =       0.000409402584
  error estimate for blocks of size 2^( 3) =       0.000418425671
  error estimate for blocks of size 2^( 4) =       0.000425119840
  error estimate for blocks of size 2^( 5) =       0.000430386348
  error estimate for blocks of size 2^( 6) =       0.000431721732
  error estimate for blocks of size 2^( 7) =       0.000432969685

      target function =                  N/A
              le_mean =     -17.216686746049
             les_mean =     296.733821909725
             stat err =       0.000430049401
             autocorr =       1.157628589282
              std dev =       0.565260610612
             le_variance =       0.319519557909


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216687130401        initial  <--
     3.8147e-01     3.8147e+00             3.1579e-03       -17.216683996831
     1.5259e+00     1.5259e+01             8.9111e-04       -17.216684868532
     6.1035e+00     6.1035e+01             2.3171e-04       -17.216686746049

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6258
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.027361e-01 1 1  ON 0
 uu_1                 4.336548e-02 1 1  ON 1
 uu_2                -4.816867e-02 1 1  ON 2
 uu_3                -9.955227e-02 1 1  ON 3
 uu_4                -1.294530e-01 1 1  ON 4
 uu_5                -1.340936e-01 1 1  ON 5
 uu_6                -1.112225e-01 1 1  ON 6
 uu_7                -3.666294e-02 1 1  ON 7
 uu_8                 1.014078e-01 1 1  ON 8
 uu_9                 1.199825e-01 1 1  ON 9
 ud_0                 3.407967e-01 1 1  ON 10
 ud_1                 8.669489e-02 1 1  ON 11
 ud_2                -1.577397e-02 1 1  ON 12
 ud_3                -7.107294e-02 1 1  ON 13
 ud_4                -1.165758e-01 1 1  ON 14
 ud_5                -1.495489e-01 1 1  ON 15
 ud_6                -1.553333e-01 1 1  ON 16
 ud_7                -1.100419e-01 1 1  ON 17
 ud_8                 6.847972e-03 1 1  ON 18
 ud_9                 9.255280e-02 1 1  ON 19
 eO_0                -7.299508e-01 1 1  ON 20
 eO_1                -4.236747e-01 1 1  ON 21
 eO_2                -3.827339e-02 1 1  ON 22
 eO_3                 1.948292e-01 1 1  ON 23
 eO_4                 2.769694e-01 1 1  ON 24
 eO_5                 3.042249e-01 1 1  ON 25
 eO_6                 2.489002e-01 1 1  ON 26
 eO_7                 1.104423e-01 1 1  ON 27
 eO_8                 2.771889e-02 1 1  ON 28
 eO_9                 1.832516e-02 1 1  ON 29
eH1_0                -1.792107e-01 1 1  ON 30
eH1_1                -1.010013e-01 1 1  ON 31
eH1_2                -6.217279e-02 1 1  ON 32
eH1_3                -2.653202e-02 1 1  ON 33
eH1_4                 1.925120e-02 1 1  ON 34
eH1_5                 3.320633e-02 1 1  ON 35
eH1_6                 7.690473e-02 1 1  ON 36
eH1_7                 1.105548e-01 1 1  ON 37
eH1_8                 8.977842e-02 1 1  ON 38
eH1_9                 2.402723e-02 1 1  ON 39
eH2_0                -1.814063e-01 1 1  ON 40
eH2_1                -1.026717e-01 1 1  ON 41
eH2_2                -6.371608e-02 1 1  ON 42
eH2_3                -2.775243e-02 1 1  ON 43
eH2_4                 1.811089e-02 1 1  ON 44
eH2_5                 3.401577e-02 1 1  ON 45
eH2_6                 7.850964e-02 1 1  ON 46
eH2_7                 1.138628e-01 1 1  ON 47
eH2_8                 9.283452e-02 1 1  ON 48
eH2_9                 2.615052e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6619e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2413
    reference variance = 0.220999
====================================================
  Execution time = 3.2129e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1760e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317583176888
                                         uncertainty =       0.004314201377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317583176888
                                         uncertainty =       0.004314201377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398499799
  error estimate for blocks of size 2^( 2) =       0.000408438281
  error estimate for blocks of size 2^( 3) =       0.000416941895
  error estimate for blocks of size 2^( 4) =       0.000423677492
  error estimate for blocks of size 2^( 5) =       0.000428368079
  error estimate for blocks of size 2^( 6) =       0.000430978002
  error estimate for blocks of size 2^( 7) =       0.000432600783

      target function =                  N/A
              le_mean =     -17.217381686568
             les_mean =     296.755836162131
             stat err =       0.000428906089
             autocorr =       1.158425769274
              std dev =       0.563563820682
             le_variance =       0.317604179982


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721738168657e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217381686568       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217382284221       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217383195329       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217383636272       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217383847951       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217383744997       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217383755161       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217383718382       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 3.665792e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217381686568       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217381842271       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217382076425       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217382189131       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217382241116       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217382216019       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217382217320       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217382208323       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 9.342509e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217381686568       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217381725907       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217381784862       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217381813210       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217381826142       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217381819921       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217381820163       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217381817933       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 2.347314e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0815e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.027608e-01 1 1  ON 0
 uu_1                 4.337289e-02 1 1  ON 1
 uu_2                -4.816582e-02 1 1  ON 2
 uu_3                -9.955515e-02 1 1  ON 3
 uu_4                -1.294588e-01 1 1  ON 4
 uu_5                -1.341016e-01 1 1  ON 5
 uu_6                -1.112305e-01 1 1  ON 6
 uu_7                -3.667266e-02 1 1  ON 7
 uu_8                 1.014016e-01 1 1  ON 8
 uu_9                 1.199851e-01 1 1  ON 9
 ud_0                 3.408139e-01 1 1  ON 10
 ud_1                 8.671449e-02 1 1  ON 11
 ud_2                -1.577368e-02 1 1  ON 12
 ud_3                -7.108407e-02 1 1  ON 13
 ud_4                -1.165884e-01 1 1  ON 14
 ud_5                -1.495561e-01 1 1  ON 15
 ud_6                -1.553243e-01 1 1  ON 16
 ud_7                -1.100480e-01 1 1  ON 17
 ud_8                 6.837406e-03 1 1  ON 18
 ud_9                 9.255189e-02 1 1  ON 19
 eO_0                -7.300443e-01 1 1  ON 20
 eO_1                -4.237081e-01 1 1  ON 21
 eO_2                -3.826653e-02 1 1  ON 22
 eO_3                 1.948864e-01 1 1  ON 23
 eO_4                 2.770161e-01 1 1  ON 24
 eO_5                 3.042281e-01 1 1  ON 25
 eO_6                 2.489054e-01 1 1  ON 26
 eO_7                 1.104490e-01 1 1  ON 27
 eO_8                 2.771953e-02 1 1  ON 28
 eO_9                 1.832538e-02 1 1  ON 29
eH1_0                -1.792189e-01 1 1  ON 30
eH1_1                -1.010070e-01 1 1  ON 31
eH1_2                -6.216882e-02 1 1  ON 32
eH1_3                -2.653490e-02 1 1  ON 33
eH1_4                 1.925201e-02 1 1  ON 34
eH1_5                 3.321839e-02 1 1  ON 35
eH1_6                 7.690320e-02 1 1  ON 36
eH1_7                 1.105506e-01 1 1  ON 37
eH1_8                 8.978239e-02 1 1  ON 38
eH1_9                 2.402859e-02 1 1  ON 39
eH2_0                -1.814094e-01 1 1  ON 40
eH2_1                -1.026751e-01 1 1  ON 41
eH2_2                -6.370874e-02 1 1  ON 42
eH2_3                -2.775556e-02 1 1  ON 43
eH2_4                 1.810894e-02 1 1  ON 44
eH2_5                 3.401647e-02 1 1  ON 45
eH2_6                 7.850829e-02 1 1  ON 46
eH2_7                 1.138624e-01 1 1  ON 47
eH2_8                 9.283904e-02 1 1  ON 48
eH2_9                 2.615112e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2312
    reference variance = 0.409613
====================================================
  Execution time = 3.1097e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1194e-01
  Total weights = 2.0000e+06
  Execution time = 2.8677e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312011115746
                                         uncertainty =       0.002700289189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312011115746
                                         uncertainty =       0.002700289189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394921150
  error estimate for blocks of size 2^( 2) =       0.000404652197
  error estimate for blocks of size 2^( 3) =       0.000413348499
  error estimate for blocks of size 2^( 4) =       0.000420259751
  error estimate for blocks of size 2^( 5) =       0.000424326118
  error estimate for blocks of size 2^( 6) =       0.000426611636
  error estimate for blocks of size 2^( 7) =       0.000430135357

      target function =                  N/A
              le_mean =     -17.216913152731
             les_mean =     296.734023781522
             stat err =       0.000425333215
             autocorr =       1.159946111190
              std dev =       0.558502845839
             le_variance =       0.311925428810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312063490407
                                         uncertainty =       0.002700793681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312063490407
                                         uncertainty =       0.002700793681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394954299
  error estimate for blocks of size 2^( 2) =       0.000404682609
  error estimate for blocks of size 2^( 3) =       0.000413376010
  error estimate for blocks of size 2^( 4) =       0.000420285271
  error estimate for blocks of size 2^( 5) =       0.000424349749
  error estimate for blocks of size 2^( 6) =       0.000426634652
  error estimate for blocks of size 2^( 7) =       0.000430156818

      target function =                  N/A
              le_mean =     -17.216913333083
             les_mean =     296.734082359115
             stat err =       0.000425356623
             autocorr =       1.159879059665
              std dev =       0.558549725834
             le_variance =       0.311977796230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312036552576
                                         uncertainty =       0.002700535213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312036552576
                                         uncertainty =       0.002700535213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394937250
  error estimate for blocks of size 2^( 2) =       0.000404666931
  error estimate for blocks of size 2^( 3) =       0.000413361783
  error estimate for blocks of size 2^( 4) =       0.000420272032
  error estimate for blocks of size 2^( 5) =       0.000424337425
  error estimate for blocks of size 2^( 6) =       0.000426622635
  error estimate for blocks of size 2^( 7) =       0.000430145551

      target function =                  N/A
              le_mean =     -17.216913245375
             les_mean =     296.734052405948
             stat err =       0.000425344411
             autocorr =       1.159912596807
              std dev =       0.558525615476
             le_variance =       0.311950863142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312014260900
                                         uncertainty =       0.002700319681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312014260900
                                         uncertainty =       0.002700319681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394923140
  error estimate for blocks of size 2^( 2) =       0.000404654017
  error estimate for blocks of size 2^( 3) =       0.000413350137
  error estimate for blocks of size 2^( 4) =       0.000420261264
  error estimate for blocks of size 2^( 5) =       0.000424327508
  error estimate for blocks of size 2^( 6) =       0.000426612988
  error estimate for blocks of size 2^( 7) =       0.000430136607

      target function =                  N/A
              le_mean =     -17.216913163797
             les_mean =     296.734027307451
             stat err =       0.000425334591
             autocorr =       1.159941922427
              std dev =       0.558505661291
             le_variance =       0.311928573694


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216913152731        initial
     3.8147e+00     3.8147e+01             3.6658e-04       -17.216913333083  <--
     1.5259e+01     1.5259e+02             9.3425e-05       -17.216913245375
     6.1035e+01     6.1035e+02             2.3473e-05       -17.216913163797

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 4.5510e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.028335e-01 1 1  ON 0
 uu_1                 4.339631e-02 1 1  ON 1
 uu_2                -4.815678e-02 1 1  ON 2
 uu_3                -9.956346e-02 1 1  ON 3
 uu_4                -1.294773e-01 1 1  ON 4
 uu_5                -1.341251e-01 1 1  ON 5
 uu_6                -1.112545e-01 1 1  ON 6
 uu_7                -3.670177e-02 1 1  ON 7
 uu_8                 1.013832e-01 1 1  ON 8
 uu_9                 1.199928e-01 1 1  ON 9
 ud_0                 3.408671e-01 1 1  ON 10
 ud_1                 8.676959e-02 1 1  ON 11
 ud_2                -1.577176e-02 1 1  ON 12
 ud_3                -7.111635e-02 1 1  ON 13
 ud_4                -1.166258e-01 1 1  ON 14
 ud_5                -1.495776e-01 1 1  ON 15
 ud_6                -1.552978e-01 1 1  ON 16
 ud_7                -1.100662e-01 1 1  ON 17
 ud_8                 6.805947e-03 1 1  ON 18
 ud_9                 9.254919e-02 1 1  ON 19
 eO_0                -7.303174e-01 1 1  ON 20
 eO_1                -4.238096e-01 1 1  ON 21
 eO_2                -3.824801e-02 1 1  ON 22
 eO_3                 1.950549e-01 1 1  ON 23
 eO_4                 2.771555e-01 1 1  ON 24
 eO_5                 3.042377e-01 1 1  ON 25
 eO_6                 2.489205e-01 1 1  ON 26
 eO_7                 1.104689e-01 1 1  ON 27
 eO_8                 2.772142e-02 1 1  ON 28
 eO_9                 1.832604e-02 1 1  ON 29
eH1_0                -1.792427e-01 1 1  ON 30
eH1_1                -1.010242e-01 1 1  ON 31
eH1_2                -6.215745e-02 1 1  ON 32
eH1_3                -2.654277e-02 1 1  ON 33
eH1_4                 1.925405e-02 1 1  ON 34
eH1_5                 3.325416e-02 1 1  ON 35
eH1_6                 7.689882e-02 1 1  ON 36
eH1_7                 1.105383e-01 1 1  ON 37
eH1_8                 8.979419e-02 1 1  ON 38
eH1_9                 2.403266e-02 1 1  ON 39
eH2_0                -1.814184e-01 1 1  ON 40
eH2_1                -1.026852e-01 1 1  ON 41
eH2_2                -6.368725e-02 1 1  ON 42
eH2_3                -2.776446e-02 1 1  ON 43
eH2_4                 1.810278e-02 1 1  ON 44
eH2_5                 3.401846e-02 1 1  ON 45
eH2_6                 7.850435e-02 1 1  ON 46
eH2_7                 1.138612e-01 1 1  ON 47
eH2_8                 9.285248e-02 1 1  ON 48
eH2_9                 2.615290e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2213
    reference variance = 0.246074
====================================================
  Execution time = 3.1926e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1790e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317960700940
                                         uncertainty =       0.004363766302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317960700940
                                         uncertainty =       0.004363766302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398687366
  error estimate for blocks of size 2^( 2) =       0.000408443604
  error estimate for blocks of size 2^( 3) =       0.000416817825
  error estimate for blocks of size 2^( 4) =       0.000422846841
  error estimate for blocks of size 2^( 5) =       0.000426177232
  error estimate for blocks of size 2^( 6) =       0.000429076886
  error estimate for blocks of size 2^( 7) =       0.000430596487

      target function =                  N/A
              le_mean =     -17.215868761747
             les_mean =     296.704040294612
             stat err =       0.000427174361
             autocorr =       1.148009310900
              std dev =       0.563829080372
             le_variance =       0.317903231873


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721586876175e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215868761747       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215870861315       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215872167096       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215873907366       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215872998123       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215873096858       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215873145488       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215873287805       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215873241005       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.290095e-03

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215868761747       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215869362804       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215869688658       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215870131747       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215869843467       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215869890043       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215869877384       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215869912626       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 3.410339e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215868761747       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215868917667       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215868998721       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215869109730       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215869032216       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215869044966       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215869041470       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215869049106       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 8.652329e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.235819 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0437e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.029282e-01 1 1  ON 0
 uu_1                 4.343466e-02 1 1  ON 1
 uu_2                -4.816679e-02 1 1  ON 2
 uu_3                -9.959527e-02 1 1  ON 3
 uu_4                -1.295337e-01 1 1  ON 4
 uu_5                -1.341623e-01 1 1  ON 5
 uu_6                -1.112463e-01 1 1  ON 6
 uu_7                -3.672911e-02 1 1  ON 7
 uu_8                 1.013670e-01 1 1  ON 8
 uu_9                 1.200096e-01 1 1  ON 9
 ud_0                 3.409981e-01 1 1  ON 10
 ud_1                 8.679620e-02 1 1  ON 11
 ud_2                -1.577339e-02 1 1  ON 12
 ud_3                -7.117588e-02 1 1  ON 13
 ud_4                -1.167056e-01 1 1  ON 14
 ud_5                -1.496026e-01 1 1  ON 15
 ud_6                -1.552814e-01 1 1  ON 16
 ud_7                -1.100734e-01 1 1  ON 17
 ud_8                 6.781249e-03 1 1  ON 18
 ud_9                 9.255239e-02 1 1  ON 19
 eO_0                -7.306585e-01 1 1  ON 20
 eO_1                -4.239674e-01 1 1  ON 21
 eO_2                -3.821603e-02 1 1  ON 22
 eO_3                 1.952605e-01 1 1  ON 23
 eO_4                 2.773372e-01 1 1  ON 24
 eO_5                 3.042506e-01 1 1  ON 25
 eO_6                 2.489402e-01 1 1  ON 26
 eO_7                 1.105039e-01 1 1  ON 27
 eO_8                 2.772901e-02 1 1  ON 28
 eO_9                 1.832876e-02 1 1  ON 29
eH1_0                -1.792865e-01 1 1  ON 30
eH1_1                -1.010392e-01 1 1  ON 31
eH1_2                -6.215060e-02 1 1  ON 32
eH1_3                -2.655515e-02 1 1  ON 33
eH1_4                 1.923650e-02 1 1  ON 34
eH1_5                 3.330218e-02 1 1  ON 35
eH1_6                 7.691345e-02 1 1  ON 36
eH1_7                 1.105296e-01 1 1  ON 37
eH1_8                 8.981237e-02 1 1  ON 38
eH1_9                 2.403915e-02 1 1  ON 39
eH2_0                -1.814452e-01 1 1  ON 40
eH2_1                -1.026952e-01 1 1  ON 41
eH2_2                -6.371087e-02 1 1  ON 42
eH2_3                -2.776173e-02 1 1  ON 43
eH2_4                 1.807377e-02 1 1  ON 44
eH2_5                 3.406844e-02 1 1  ON 45
eH2_6                 7.851814e-02 1 1  ON 46
eH2_7                 1.138578e-01 1 1  ON 47
eH2_8                 9.287239e-02 1 1  ON 48
eH2_9                 2.615822e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2456
    reference variance = 0.262916
====================================================
  Execution time = 3.0911e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1579e-01
  Total weights = 2.0000e+06
  Execution time = 2.8578e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315666432860
                                         uncertainty =       0.003849680717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315666432860
                                         uncertainty =       0.003849680717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397278187
  error estimate for blocks of size 2^( 2) =       0.000407192189
  error estimate for blocks of size 2^( 3) =       0.000416383922
  error estimate for blocks of size 2^( 4) =       0.000423624848
  error estimate for blocks of size 2^( 5) =       0.000428034928
  error estimate for blocks of size 2^( 6) =       0.000431333961
  error estimate for blocks of size 2^( 7) =       0.000433315066

      target function =                  N/A
              le_mean =     -17.216428753180
             les_mean =     296.721078771882
             stat err =       0.000429077201
             autocorr =       1.166491116995
              std dev =       0.561836200666
             le_variance =       0.315659916378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316105108600
                                         uncertainty =       0.003856606767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316105108600
                                         uncertainty =       0.003856606767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397554109
  error estimate for blocks of size 2^( 2) =       0.000407452303
  error estimate for blocks of size 2^( 3) =       0.000416628919
  error estimate for blocks of size 2^( 4) =       0.000423857376
  error estimate for blocks of size 2^( 5) =       0.000428261304
  error estimate for blocks of size 2^( 6) =       0.000431552415
  error estimate for blocks of size 2^( 7) =       0.000433523243

      target function =                  N/A
              le_mean =     -17.216428392742
             les_mean =     296.721504983047
             stat err =       0.000429298585
             autocorr =       1.166074828948
              std dev =       0.562226412291
             le_variance =       0.316098538678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315928138166
                                         uncertainty =       0.003853790562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315928138166
                                         uncertainty =       0.003853790562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397442819
  error estimate for blocks of size 2^( 2) =       0.000407347710
  error estimate for blocks of size 2^( 3) =       0.000416530877
  error estimate for blocks of size 2^( 4) =       0.000423764813
  error estimate for blocks of size 2^( 5) =       0.000428171261
  error estimate for blocks of size 2^( 6) =       0.000431465546
  error estimate for blocks of size 2^( 7) =       0.000433441407

      target function =                  N/A
              le_mean =     -17.216428410752
             les_mean =     296.721328652978
             stat err =       0.000429210757
             autocorr =       1.166250616975
              std dev =       0.562069024590
             le_variance =       0.315921588403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315700908925
                                         uncertainty =       0.003850224467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315700908925
                                         uncertainty =       0.003850224467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397299879
  error estimate for blocks of size 2^( 2) =       0.000407212690
  error estimate for blocks of size 2^( 3) =       0.000416403307
  error estimate for blocks of size 2^( 4) =       0.000423643324
  error estimate for blocks of size 2^( 5) =       0.000428052922
  error estimate for blocks of size 2^( 6) =       0.000431351330
  error estimate for blocks of size 2^( 7) =       0.000433331772

      target function =                  N/A
              le_mean =     -17.216428693664
             les_mean =     296.721111194254
             stat err =       0.000429094837
             autocorr =       1.166459626839
              std dev =       0.561866877533
             le_variance =       0.315694388069


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216428753180        initial  <--
     9.5367e-01     9.5367e+00             1.2901e-03       -17.216428392742
     3.8147e+00     3.8147e+01             3.4103e-04       -17.216428410752
     1.5259e+01     1.5259e+02             8.6523e-05       -17.216428693664

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3179
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.028335e-01 1 1  ON 0
 uu_1                 4.339631e-02 1 1  ON 1
 uu_2                -4.815678e-02 1 1  ON 2
 uu_3                -9.956346e-02 1 1  ON 3
 uu_4                -1.294773e-01 1 1  ON 4
 uu_5                -1.341251e-01 1 1  ON 5
 uu_6                -1.112545e-01 1 1  ON 6
 uu_7                -3.670177e-02 1 1  ON 7
 uu_8                 1.013832e-01 1 1  ON 8
 uu_9                 1.199928e-01 1 1  ON 9
 ud_0                 3.408671e-01 1 1  ON 10
 ud_1                 8.676959e-02 1 1  ON 11
 ud_2                -1.577176e-02 1 1  ON 12
 ud_3                -7.111635e-02 1 1  ON 13
 ud_4                -1.166258e-01 1 1  ON 14
 ud_5                -1.495776e-01 1 1  ON 15
 ud_6                -1.552978e-01 1 1  ON 16
 ud_7                -1.100662e-01 1 1  ON 17
 ud_8                 6.805947e-03 1 1  ON 18
 ud_9                 9.254919e-02 1 1  ON 19
 eO_0                -7.303174e-01 1 1  ON 20
 eO_1                -4.238096e-01 1 1  ON 21
 eO_2                -3.824801e-02 1 1  ON 22
 eO_3                 1.950549e-01 1 1  ON 23
 eO_4                 2.771555e-01 1 1  ON 24
 eO_5                 3.042377e-01 1 1  ON 25
 eO_6                 2.489205e-01 1 1  ON 26
 eO_7                 1.104689e-01 1 1  ON 27
 eO_8                 2.772142e-02 1 1  ON 28
 eO_9                 1.832604e-02 1 1  ON 29
eH1_0                -1.792427e-01 1 1  ON 30
eH1_1                -1.010242e-01 1 1  ON 31
eH1_2                -6.215745e-02 1 1  ON 32
eH1_3                -2.654277e-02 1 1  ON 33
eH1_4                 1.925405e-02 1 1  ON 34
eH1_5                 3.325416e-02 1 1  ON 35
eH1_6                 7.689882e-02 1 1  ON 36
eH1_7                 1.105383e-01 1 1  ON 37
eH1_8                 8.979419e-02 1 1  ON 38
eH1_9                 2.403266e-02 1 1  ON 39
eH2_0                -1.814184e-01 1 1  ON 40
eH2_1                -1.026852e-01 1 1  ON 41
eH2_2                -6.368725e-02 1 1  ON 42
eH2_3                -2.776446e-02 1 1  ON 43
eH2_4                 1.810278e-02 1 1  ON 44
eH2_5                 3.401846e-02 1 1  ON 45
eH2_6                 7.850435e-02 1 1  ON 46
eH2_7                 1.138612e-01 1 1  ON 47
eH2_8                 9.285248e-02 1 1  ON 48
eH2_9                 2.615290e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5760e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1946
    reference variance = 0.234012
====================================================
  Execution time = 3.2157e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1945e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319427069712
                                         uncertainty =       0.004886237821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319427069712
                                         uncertainty =       0.004886237821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399654738
  error estimate for blocks of size 2^( 2) =       0.000409107613
  error estimate for blocks of size 2^( 3) =       0.000418271607
  error estimate for blocks of size 2^( 4) =       0.000424814542
  error estimate for blocks of size 2^( 5) =       0.000428459005
  error estimate for blocks of size 2^( 6) =       0.000431582191
  error estimate for blocks of size 2^( 7) =       0.000433087274

      target function =                  N/A
              le_mean =     -17.216180463349
             les_mean =     296.716317406323
             stat err =       0.000429485753
             autocorr =       1.154855353392
              std dev =       0.565197150944
             le_variance =       0.319447819435


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721618046335e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216180463349       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216180563409       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216180869752       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216181051246       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216181003409       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216180979208       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216180989661       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216180999717       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.289275e-04

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216180463349       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216180488664       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216180566524       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216180611367       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216180599378       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216180593385       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216180595864       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216180598359       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 3.237765e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216180463349       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216180469697       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216180489243       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216180500420       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216180497420       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216180495926       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216180496538       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216180497160       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 8.103594e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238445 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0933e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.028430e-01 1 1  ON 0
 uu_1                 4.340031e-02 1 1  ON 1
 uu_2                -4.815624e-02 1 1  ON 2
 uu_3                -9.956520e-02 1 1  ON 3
 uu_4                -1.294829e-01 1 1  ON 4
 uu_5                -1.341298e-01 1 1  ON 5
 uu_6                -1.112548e-01 1 1  ON 6
 uu_7                -3.670489e-02 1 1  ON 7
 uu_8                 1.013814e-01 1 1  ON 8
 uu_9                 1.199942e-01 1 1  ON 9
 ud_0                 3.408755e-01 1 1  ON 10
 ud_1                 8.677432e-02 1 1  ON 11
 ud_2                -1.577156e-02 1 1  ON 12
 ud_3                -7.112218e-02 1 1  ON 13
 ud_4                -1.166308e-01 1 1  ON 14
 ud_5                -1.495783e-01 1 1  ON 15
 ud_6                -1.552944e-01 1 1  ON 16
 ud_7                -1.100687e-01 1 1  ON 17
 ud_8                 6.801830e-03 1 1  ON 18
 ud_9                 9.254907e-02 1 1  ON 19
 eO_0                -7.303498e-01 1 1  ON 20
 eO_1                -4.238284e-01 1 1  ON 21
 eO_2                -3.824662e-02 1 1  ON 22
 eO_3                 1.950769e-01 1 1  ON 23
 eO_4                 2.771750e-01 1 1  ON 24
 eO_5                 3.042390e-01 1 1  ON 25
 eO_6                 2.489237e-01 1 1  ON 26
 eO_7                 1.104719e-01 1 1  ON 27
 eO_8                 2.772179e-02 1 1  ON 28
 eO_9                 1.832622e-02 1 1  ON 29
eH1_0                -1.792462e-01 1 1  ON 30
eH1_1                -1.010258e-01 1 1  ON 31
eH1_2                -6.215734e-02 1 1  ON 32
eH1_3                -2.654128e-02 1 1  ON 33
eH1_4                 1.925395e-02 1 1  ON 34
eH1_5                 3.325634e-02 1 1  ON 35
eH1_6                 7.689826e-02 1 1  ON 36
eH1_7                 1.105377e-01 1 1  ON 37
eH1_8                 8.979605e-02 1 1  ON 38
eH1_9                 2.403319e-02 1 1  ON 39
eH2_0                -1.814210e-01 1 1  ON 40
eH2_1                -1.026853e-01 1 1  ON 41
eH2_2                -6.368556e-02 1 1  ON 42
eH2_3                -2.776443e-02 1 1  ON 43
eH2_4                 1.810129e-02 1 1  ON 44
eH2_5                 3.401934e-02 1 1  ON 45
eH2_6                 7.850404e-02 1 1  ON 46
eH2_7                 1.138607e-01 1 1  ON 47
eH2_8                 9.285423e-02 1 1  ON 48
eH2_9                 2.615335e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1649
    reference variance = 0.230635
====================================================
  Execution time = 3.1377e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2289e-01
  Total weights = 2.0000e+06
  Execution time = 2.8633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322907041607
                                         uncertainty =       0.006140704684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322907041607
                                         uncertainty =       0.006140704684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401796569
  error estimate for blocks of size 2^( 2) =       0.000411774594
  error estimate for blocks of size 2^( 3) =       0.000420703139
  error estimate for blocks of size 2^( 4) =       0.000427600516
  error estimate for blocks of size 2^( 5) =       0.000431512898
  error estimate for blocks of size 2^( 6) =       0.000434128173
  error estimate for blocks of size 2^( 7) =       0.000436984018

      target function =                  N/A
              le_mean =     -17.215940730327
             les_mean =     296.711496034193
             stat err =       0.000432556401
             autocorr =       1.158972254762
              std dev =       0.568226156997
             le_variance =       0.322880965496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322935191175
                                         uncertainty =       0.006140905484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322935191175
                                         uncertainty =       0.006140905484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401814079
  error estimate for blocks of size 2^( 2) =       0.000411790902
  error estimate for blocks of size 2^( 3) =       0.000420718350
  error estimate for blocks of size 2^( 4) =       0.000427615011
  error estimate for blocks of size 2^( 5) =       0.000431527284
  error estimate for blocks of size 2^( 6) =       0.000434141900
  error estimate for blocks of size 2^( 7) =       0.000436997566

      target function =                  N/A
              le_mean =     -17.215940727917
             les_mean =     296.711524093769
             stat err =       0.000432570440
             autocorr =       1.158946471411
              std dev =       0.568250919981
             le_variance =       0.322909108060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322921257604
                                         uncertainty =       0.006140806425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322921257604
                                         uncertainty =       0.006140806425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401805412
  error estimate for blocks of size 2^( 2) =       0.000411782833
  error estimate for blocks of size 2^( 3) =       0.000420710825
  error estimate for blocks of size 2^( 4) =       0.000427607843
  error estimate for blocks of size 2^( 5) =       0.000431520170
  error estimate for blocks of size 2^( 6) =       0.000434135115
  error estimate for blocks of size 2^( 7) =       0.000436990868

      target function =                  N/A
              le_mean =     -17.215940727224
             les_mean =     296.711510139787
             stat err =       0.000432563499
             autocorr =       1.158959275592
              std dev =       0.568238662851
             le_variance =       0.322895177959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322908822653
                                         uncertainty =       0.006140717444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322908822653
                                         uncertainty =       0.006140717444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401797677
  error estimate for blocks of size 2^( 2) =       0.000411775627
  error estimate for blocks of size 2^( 3) =       0.000420704102
  error estimate for blocks of size 2^( 4) =       0.000427601434
  error estimate for blocks of size 2^( 5) =       0.000431513809
  error estimate for blocks of size 2^( 6) =       0.000434129042
  error estimate for blocks of size 2^( 7) =       0.000436984876

      target function =                  N/A
              le_mean =     -17.215940729804
             les_mean =     296.711497796780
             stat err =       0.000432557291
             autocorr =       1.158970629176
              std dev =       0.568227723804
             le_variance =       0.322882746099


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215940730327        initial  <--
     9.5367e+00     9.5367e+01             1.2893e-04       -17.215940727917
     3.8147e+01     3.8147e+02             3.2378e-05       -17.215940727224
     1.5259e+02     1.5259e+03             8.1036e-06       -17.215940729804

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.8034
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.028335e-01 1 1  ON 0
 uu_1                 4.339631e-02 1 1  ON 1
 uu_2                -4.815678e-02 1 1  ON 2
 uu_3                -9.956346e-02 1 1  ON 3
 uu_4                -1.294773e-01 1 1  ON 4
 uu_5                -1.341251e-01 1 1  ON 5
 uu_6                -1.112545e-01 1 1  ON 6
 uu_7                -3.670177e-02 1 1  ON 7
 uu_8                 1.013832e-01 1 1  ON 8
 uu_9                 1.199928e-01 1 1  ON 9
 ud_0                 3.408671e-01 1 1  ON 10
 ud_1                 8.676959e-02 1 1  ON 11
 ud_2                -1.577176e-02 1 1  ON 12
 ud_3                -7.111635e-02 1 1  ON 13
 ud_4                -1.166258e-01 1 1  ON 14
 ud_5                -1.495776e-01 1 1  ON 15
 ud_6                -1.552978e-01 1 1  ON 16
 ud_7                -1.100662e-01 1 1  ON 17
 ud_8                 6.805947e-03 1 1  ON 18
 ud_9                 9.254919e-02 1 1  ON 19
 eO_0                -7.303174e-01 1 1  ON 20
 eO_1                -4.238096e-01 1 1  ON 21
 eO_2                -3.824801e-02 1 1  ON 22
 eO_3                 1.950549e-01 1 1  ON 23
 eO_4                 2.771555e-01 1 1  ON 24
 eO_5                 3.042377e-01 1 1  ON 25
 eO_6                 2.489205e-01 1 1  ON 26
 eO_7                 1.104689e-01 1 1  ON 27
 eO_8                 2.772142e-02 1 1  ON 28
 eO_9                 1.832604e-02 1 1  ON 29
eH1_0                -1.792427e-01 1 1  ON 30
eH1_1                -1.010242e-01 1 1  ON 31
eH1_2                -6.215745e-02 1 1  ON 32
eH1_3                -2.654277e-02 1 1  ON 33
eH1_4                 1.925405e-02 1 1  ON 34
eH1_5                 3.325416e-02 1 1  ON 35
eH1_6                 7.689882e-02 1 1  ON 36
eH1_7                 1.105383e-01 1 1  ON 37
eH1_8                 8.979419e-02 1 1  ON 38
eH1_9                 2.403266e-02 1 1  ON 39
eH2_0                -1.814184e-01 1 1  ON 40
eH2_1                -1.026852e-01 1 1  ON 41
eH2_2                -6.368725e-02 1 1  ON 42
eH2_3                -2.776446e-02 1 1  ON 43
eH2_4                 1.810278e-02 1 1  ON 44
eH2_5                 3.401846e-02 1 1  ON 45
eH2_6                 7.850435e-02 1 1  ON 46
eH2_7                 1.138612e-01 1 1  ON 47
eH2_8                 9.285248e-02 1 1  ON 48
eH2_9                 2.615290e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6741e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1434
    reference variance = 0.155644
====================================================
  Execution time = 3.1653e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3494e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6090e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334924886011
                                         uncertainty =       0.018772760000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334924886011
                                         uncertainty =       0.018772760000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409230150
  error estimate for blocks of size 2^( 2) =       0.000419290776
  error estimate for blocks of size 2^( 3) =       0.000428169096
  error estimate for blocks of size 2^( 4) =       0.000435236597
  error estimate for blocks of size 2^( 5) =       0.000439790344
  error estimate for blocks of size 2^( 6) =       0.000441656717
  error estimate for blocks of size 2^( 7) =       0.000443873656

      target function =                  N/A
              le_mean =     -17.217387513669
             les_mean =     296.773371259407
             stat err =       0.000440139329
             autocorr =       1.156764915902
              std dev =       0.578738828007
             le_variance =       0.334938631043


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721738751367e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217387513669       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217387528888       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217387577393       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217387604077       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217387586933       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217387588983       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217387590006       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217387591199       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.443541e-05

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217387513669       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217387517478       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217387529628       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217387536298       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217387532006       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217387532518       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217387532773       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217387533069       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 3.610997e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217387513669       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217387514621       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217387517660       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217387519328       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217387518255       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217387518382       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217387518446       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217387518520       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 9.028834e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241053 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0270e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.028343e-01 1 1  ON 0
 uu_1                 4.339674e-02 1 1  ON 1
 uu_2                -4.815651e-02 1 1  ON 2
 uu_3                -9.956374e-02 1 1  ON 3
 uu_4                -1.294780e-01 1 1  ON 4
 uu_5                -1.341257e-01 1 1  ON 5
 uu_6                -1.112545e-01 1 1  ON 6
 uu_7                -3.670190e-02 1 1  ON 7
 uu_8                 1.013831e-01 1 1  ON 8
 uu_9                 1.199930e-01 1 1  ON 9
 ud_0                 3.408683e-01 1 1  ON 10
 ud_1                 8.676989e-02 1 1  ON 11
 ud_2                -1.577177e-02 1 1  ON 12
 ud_3                -7.111682e-02 1 1  ON 13
 ud_4                -1.166267e-01 1 1  ON 14
 ud_5                -1.495780e-01 1 1  ON 15
 ud_6                -1.552975e-01 1 1  ON 16
 ud_7                -1.100662e-01 1 1  ON 17
 ud_8                 6.805704e-03 1 1  ON 18
 ud_9                 9.254925e-02 1 1  ON 19
 eO_0                -7.303210e-01 1 1  ON 20
 eO_1                -4.238112e-01 1 1  ON 21
 eO_2                -3.824790e-02 1 1  ON 22
 eO_3                 1.950572e-01 1 1  ON 23
 eO_4                 2.771574e-01 1 1  ON 24
 eO_5                 3.042379e-01 1 1  ON 25
 eO_6                 2.489208e-01 1 1  ON 26
 eO_7                 1.104692e-01 1 1  ON 27
 eO_8                 2.772148e-02 1 1  ON 28
 eO_9                 1.832608e-02 1 1  ON 29
eH1_0                -1.792430e-01 1 1  ON 30
eH1_1                -1.010245e-01 1 1  ON 31
eH1_2                -6.215743e-02 1 1  ON 32
eH1_3                -2.654284e-02 1 1  ON 33
eH1_4                 1.925394e-02 1 1  ON 34
eH1_5                 3.325462e-02 1 1  ON 35
eH1_6                 7.689884e-02 1 1  ON 36
eH1_7                 1.105382e-01 1 1  ON 37
eH1_8                 8.979442e-02 1 1  ON 38
eH1_9                 2.403274e-02 1 1  ON 39
eH2_0                -1.814189e-01 1 1  ON 40
eH2_1                -1.026855e-01 1 1  ON 41
eH2_2                -6.368726e-02 1 1  ON 42
eH2_3                -2.776467e-02 1 1  ON 43
eH2_4                 1.810287e-02 1 1  ON 44
eH2_5                 3.401883e-02 1 1  ON 45
eH2_6                 7.850457e-02 1 1  ON 46
eH2_7                 1.138612e-01 1 1  ON 47
eH2_8                 9.285265e-02 1 1  ON 48
eH2_9                 2.615295e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1983
    reference variance = 0.148286
====================================================
  Execution time = 3.1140e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2214e-01
  Total weights = 2.0000e+06
  Execution time = 2.8664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322262331082
                                         uncertainty =       0.005130965175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322262331082
                                         uncertainty =       0.005130965175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401335358
  error estimate for blocks of size 2^( 2) =       0.000411030862
  error estimate for blocks of size 2^( 3) =       0.000419902710
  error estimate for blocks of size 2^( 4) =       0.000426100450
  error estimate for blocks of size 2^( 5) =       0.000430251880
  error estimate for blocks of size 2^( 6) =       0.000431764938
  error estimate for blocks of size 2^( 7) =       0.000434233134

      target function =                  N/A
              le_mean =     -17.216279705059
             les_mean =     296.722426861083
             stat err =       0.000430587600
             autocorr =       1.151087114167
              std dev =       0.567573906495
             le_variance =       0.322140139334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322266422974
                                         uncertainty =       0.005131025704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322266422974
                                         uncertainty =       0.005131025704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401337906
  error estimate for blocks of size 2^( 2) =       0.000411033229
  error estimate for blocks of size 2^( 3) =       0.000419904902
  error estimate for blocks of size 2^( 4) =       0.000426102501
  error estimate for blocks of size 2^( 5) =       0.000430253913
  error estimate for blocks of size 2^( 6) =       0.000431766966
  error estimate for blocks of size 2^( 7) =       0.000434235165

      target function =                  N/A
              le_mean =     -17.216279696551
             les_mean =     296.722430657834
             stat err =       0.000430589636
             autocorr =       1.151083384909
              std dev =       0.567577509266
             le_variance =       0.322144229024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322264381063
                                         uncertainty =       0.005130995509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322264381063
                                         uncertainty =       0.005130995509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401336634
  error estimate for blocks of size 2^( 2) =       0.000411032048
  error estimate for blocks of size 2^( 3) =       0.000419903808
  error estimate for blocks of size 2^( 4) =       0.000426101478
  error estimate for blocks of size 2^( 5) =       0.000430252898
  error estimate for blocks of size 2^( 6) =       0.000431765954
  error estimate for blocks of size 2^( 7) =       0.000434234152

      target function =                  N/A
              le_mean =     -17.216279700786
             les_mean =     296.722428762839
             stat err =       0.000430588620
             autocorr =       1.151085246495
              std dev =       0.567575711436
             le_variance =       0.322142188213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322262587451
                                         uncertainty =       0.005130968969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322262587451
                                         uncertainty =       0.005130968969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401335518
  error estimate for blocks of size 2^( 2) =       0.000411031011
  error estimate for blocks of size 2^( 3) =       0.000419902847
  error estimate for blocks of size 2^( 4) =       0.000426100578
  error estimate for blocks of size 2^( 5) =       0.000430252007
  error estimate for blocks of size 2^( 6) =       0.000431765065
  error estimate for blocks of size 2^( 7) =       0.000434233261

      target function =                  N/A
              le_mean =     -17.216279704523
             les_mean =     296.722427098871
             stat err =       0.000430587728
             autocorr =       1.151086880615
              std dev =       0.567574132219
             le_variance =       0.322140395564


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216279705059        initial  <--
     9.5367e+01     9.5367e+02             1.4435e-05       -17.216279696551
     3.8147e+02     3.8147e+03             3.6110e-06       -17.216279700786
     1.5259e+03     1.5259e+04             9.0288e-07       -17.216279704523

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6012
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.028335e-01 1 1  ON 0
 uu_1                 4.339631e-02 1 1  ON 1
 uu_2                -4.815678e-02 1 1  ON 2
 uu_3                -9.956346e-02 1 1  ON 3
 uu_4                -1.294773e-01 1 1  ON 4
 uu_5                -1.341251e-01 1 1  ON 5
 uu_6                -1.112545e-01 1 1  ON 6
 uu_7                -3.670177e-02 1 1  ON 7
 uu_8                 1.013832e-01 1 1  ON 8
 uu_9                 1.199928e-01 1 1  ON 9
 ud_0                 3.408671e-01 1 1  ON 10
 ud_1                 8.676959e-02 1 1  ON 11
 ud_2                -1.577176e-02 1 1  ON 12
 ud_3                -7.111635e-02 1 1  ON 13
 ud_4                -1.166258e-01 1 1  ON 14
 ud_5                -1.495776e-01 1 1  ON 15
 ud_6                -1.552978e-01 1 1  ON 16
 ud_7                -1.100662e-01 1 1  ON 17
 ud_8                 6.805947e-03 1 1  ON 18
 ud_9                 9.254919e-02 1 1  ON 19
 eO_0                -7.303174e-01 1 1  ON 20
 eO_1                -4.238096e-01 1 1  ON 21
 eO_2                -3.824801e-02 1 1  ON 22
 eO_3                 1.950549e-01 1 1  ON 23
 eO_4                 2.771555e-01 1 1  ON 24
 eO_5                 3.042377e-01 1 1  ON 25
 eO_6                 2.489205e-01 1 1  ON 26
 eO_7                 1.104689e-01 1 1  ON 27
 eO_8                 2.772142e-02 1 1  ON 28
 eO_9                 1.832604e-02 1 1  ON 29
eH1_0                -1.792427e-01 1 1  ON 30
eH1_1                -1.010242e-01 1 1  ON 31
eH1_2                -6.215745e-02 1 1  ON 32
eH1_3                -2.654277e-02 1 1  ON 33
eH1_4                 1.925405e-02 1 1  ON 34
eH1_5                 3.325416e-02 1 1  ON 35
eH1_6                 7.689882e-02 1 1  ON 36
eH1_7                 1.105383e-01 1 1  ON 37
eH1_8                 8.979419e-02 1 1  ON 38
eH1_9                 2.403266e-02 1 1  ON 39
eH2_0                -1.814184e-01 1 1  ON 40
eH2_1                -1.026852e-01 1 1  ON 41
eH2_2                -6.368725e-02 1 1  ON 42
eH2_3                -2.776446e-02 1 1  ON 43
eH2_4                 1.810278e-02 1 1  ON 44
eH2_5                 3.401846e-02 1 1  ON 45
eH2_6                 7.850435e-02 1 1  ON 46
eH2_7                 1.138612e-01 1 1  ON 47
eH2_8                 9.285248e-02 1 1  ON 48
eH2_9                 2.615290e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5876e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2176
    reference variance = 0.305746
====================================================
  Execution time = 3.1404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2421e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324306698022
                                         uncertainty =       0.007972478567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324306698022
                                         uncertainty =       0.007972478567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402624628
  error estimate for blocks of size 2^( 2) =       0.000412653097
  error estimate for blocks of size 2^( 3) =       0.000421638081
  error estimate for blocks of size 2^( 4) =       0.000427577257
  error estimate for blocks of size 2^( 5) =       0.000432323653
  error estimate for blocks of size 2^( 6) =       0.000433909417
  error estimate for blocks of size 2^( 7) =       0.000434581911

      target function =                  N/A
              le_mean =     -17.216182610808
             les_mean =     296.721156708997
             stat err =       0.000432098060
             autocorr =       1.151765215948
              std dev =       0.569397209701
             le_variance =       0.324213182416


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721618261081e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216182610808       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216182612386       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216182613080       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216182614861       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216182615784       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216182615863       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216182615554       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216182615577       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 1.366999e-06

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216182610808       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216182611203       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216182611376       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216182611822       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216182612052       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216182612073       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216182611993       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216182612003       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 3.417653e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216182610808       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216182610907       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216182610950       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216182611057       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216182611119       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216182611125       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216182611111       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216182611107       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 8.544228e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243618 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0201e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.028336e-01 1 1  ON 0
 uu_1                 4.339637e-02 1 1  ON 1
 uu_2                -4.815676e-02 1 1  ON 2
 uu_3                -9.956348e-02 1 1  ON 3
 uu_4                -1.294773e-01 1 1  ON 4
 uu_5                -1.341252e-01 1 1  ON 5
 uu_6                -1.112545e-01 1 1  ON 6
 uu_7                -3.670182e-02 1 1  ON 7
 uu_8                 1.013831e-01 1 1  ON 8
 uu_9                 1.199929e-01 1 1  ON 9
 ud_0                 3.408673e-01 1 1  ON 10
 ud_1                 8.676965e-02 1 1  ON 11
 ud_2                -1.577176e-02 1 1  ON 12
 ud_3                -7.111639e-02 1 1  ON 13
 ud_4                -1.166259e-01 1 1  ON 14
 ud_5                -1.495776e-01 1 1  ON 15
 ud_6                -1.552978e-01 1 1  ON 16
 ud_7                -1.100662e-01 1 1  ON 17
 ud_8                 6.805906e-03 1 1  ON 18
 ud_9                 9.254918e-02 1 1  ON 19
 eO_0                -7.303178e-01 1 1  ON 20
 eO_1                -4.238098e-01 1 1  ON 21
 eO_2                -3.824796e-02 1 1  ON 22
 eO_3                 1.950551e-01 1 1  ON 23
 eO_4                 2.771556e-01 1 1  ON 24
 eO_5                 3.042377e-01 1 1  ON 25
 eO_6                 2.489206e-01 1 1  ON 26
 eO_7                 1.104689e-01 1 1  ON 27
 eO_8                 2.772142e-02 1 1  ON 28
 eO_9                 1.832605e-02 1 1  ON 29
eH1_0                -1.792428e-01 1 1  ON 30
eH1_1                -1.010242e-01 1 1  ON 31
eH1_2                -6.215742e-02 1 1  ON 32
eH1_3                -2.654278e-02 1 1  ON 33
eH1_4                 1.925406e-02 1 1  ON 34
eH1_5                 3.325420e-02 1 1  ON 35
eH1_6                 7.689882e-02 1 1  ON 36
eH1_7                 1.105382e-01 1 1  ON 37
eH1_8                 8.979421e-02 1 1  ON 38
eH1_9                 2.403266e-02 1 1  ON 39
eH2_0                -1.814184e-01 1 1  ON 40
eH2_1                -1.026852e-01 1 1  ON 41
eH2_2                -6.368724e-02 1 1  ON 42
eH2_3                -2.776445e-02 1 1  ON 43
eH2_4                 1.810277e-02 1 1  ON 44
eH2_5                 3.401847e-02 1 1  ON 45
eH2_6                 7.850434e-02 1 1  ON 46
eH2_7                 1.138612e-01 1 1  ON 47
eH2_8                 9.285250e-02 1 1  ON 48
eH2_9                 2.615290e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2187
    reference variance = 0.288063
====================================================
  Execution time = 3.1143e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1479e-01
  Total weights = 2.0000e+06
  Execution time = 2.8567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314797892350
                                         uncertainty =       0.003114252914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314797892350
                                         uncertainty =       0.003114252914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396730337
  error estimate for blocks of size 2^( 2) =       0.000406625772
  error estimate for blocks of size 2^( 3) =       0.000415023832
  error estimate for blocks of size 2^( 4) =       0.000421378090
  error estimate for blocks of size 2^( 5) =       0.000426103101
  error estimate for blocks of size 2^( 6) =       0.000428732858
  error estimate for blocks of size 2^( 7) =       0.000429691325

      target function =                  N/A
              le_mean =     -17.216943926920
             les_mean =     296.737947945940
             stat err =       0.000426476344
             autocorr =       1.155577480411
              std dev =       0.561061423224
             le_variance =       0.314789920630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314798251873
                                         uncertainty =       0.003114256395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314798251873
                                         uncertainty =       0.003114256395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396730564
  error estimate for blocks of size 2^( 2) =       0.000406625982
  error estimate for blocks of size 2^( 3) =       0.000415024028
  error estimate for blocks of size 2^( 4) =       0.000421378275
  error estimate for blocks of size 2^( 5) =       0.000426103283
  error estimate for blocks of size 2^( 6) =       0.000428733034
  error estimate for blocks of size 2^( 7) =       0.000429691502

      target function =                  N/A
              le_mean =     -17.216943928413
             les_mean =     296.737948356990
             stat err =       0.000426476523
             autocorr =       1.155577134474
              std dev =       0.561061743708
             le_variance =       0.314790280252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314798072139
                                         uncertainty =       0.003114254655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314798072139
                                         uncertainty =       0.003114254655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396730450
  error estimate for blocks of size 2^( 2) =       0.000406625877
  error estimate for blocks of size 2^( 3) =       0.000415023930
  error estimate for blocks of size 2^( 4) =       0.000421378183
  error estimate for blocks of size 2^( 5) =       0.000426103192
  error estimate for blocks of size 2^( 6) =       0.000428732946
  error estimate for blocks of size 2^( 7) =       0.000429691414

      target function =                  N/A
              le_mean =     -17.216943927667
             les_mean =     296.737948151491
             stat err =       0.000426476434
             autocorr =       1.155577307423
              std dev =       0.561061583490
             le_variance =       0.314790100468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314797914825
                                         uncertainty =       0.003114253131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314797914825
                                         uncertainty =       0.003114253131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396730351
  error estimate for blocks of size 2^( 2) =       0.000406625785
  error estimate for blocks of size 2^( 3) =       0.000415023845
  error estimate for blocks of size 2^( 4) =       0.000421378102
  error estimate for blocks of size 2^( 5) =       0.000426103113
  error estimate for blocks of size 2^( 6) =       0.000428732869
  error estimate for blocks of size 2^( 7) =       0.000429691336

      target function =                  N/A
              le_mean =     -17.216943927013
             les_mean =     296.737947971635
             stat err =       0.000426476355
             autocorr =       1.155577458797
              std dev =       0.561061443258
             le_variance =       0.314789943111


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216943926920        initial
     9.5367e+02     9.5367e+03             1.3670e-06       -17.216943928413  <--
     3.8147e+03     3.8147e+04             3.4177e-07       -17.216943927667
     1.5259e+04     1.5259e+05             8.5442e-08       -17.216943927013

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 4.5558e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.028338e-01 1 1  ON 0
 uu_1                 4.339654e-02 1 1  ON 1
 uu_2                -4.815670e-02 1 1  ON 2
 uu_3                -9.956357e-02 1 1  ON 3
 uu_4                -1.294774e-01 1 1  ON 4
 uu_5                -1.341253e-01 1 1  ON 5
 uu_6                -1.112545e-01 1 1  ON 6
 uu_7                -3.670196e-02 1 1  ON 7
 uu_8                 1.013831e-01 1 1  ON 8
 uu_9                 1.199929e-01 1 1  ON 9
 ud_0                 3.408676e-01 1 1  ON 10
 ud_1                 8.676980e-02 1 1  ON 11
 ud_2                -1.577175e-02 1 1  ON 12
 ud_3                -7.111653e-02 1 1  ON 13
 ud_4                -1.166262e-01 1 1  ON 14
 ud_5                -1.495777e-01 1 1  ON 15
 ud_6                -1.552977e-01 1 1  ON 16
 ud_7                -1.100663e-01 1 1  ON 17
 ud_8                 6.805781e-03 1 1  ON 18
 ud_9                 9.254917e-02 1 1  ON 19
 eO_0                -7.303188e-01 1 1  ON 20
 eO_1                -4.238104e-01 1 1  ON 21
 eO_2                -3.824782e-02 1 1  ON 22
 eO_3                 1.950559e-01 1 1  ON 23
 eO_4                 2.771561e-01 1 1  ON 24
 eO_5                 3.042378e-01 1 1  ON 25
 eO_6                 2.489206e-01 1 1  ON 26
 eO_7                 1.104690e-01 1 1  ON 27
 eO_8                 2.772144e-02 1 1  ON 28
 eO_9                 1.832605e-02 1 1  ON 29
eH1_0                -1.792429e-01 1 1  ON 30
eH1_1                -1.010243e-01 1 1  ON 31
eH1_2                -6.215735e-02 1 1  ON 32
eH1_3                -2.654280e-02 1 1  ON 33
eH1_4                 1.925406e-02 1 1  ON 34
eH1_5                 3.325434e-02 1 1  ON 35
eH1_6                 7.689884e-02 1 1  ON 36
eH1_7                 1.105382e-01 1 1  ON 37
eH1_8                 8.979426e-02 1 1  ON 38
eH1_9                 2.403268e-02 1 1  ON 39
eH2_0                -1.814185e-01 1 1  ON 40
eH2_1                -1.026853e-01 1 1  ON 41
eH2_2                -6.368722e-02 1 1  ON 42
eH2_3                -2.776445e-02 1 1  ON 43
eH2_4                 1.810275e-02 1 1  ON 44
eH2_5                 3.401851e-02 1 1  ON 45
eH2_6                 7.850434e-02 1 1  ON 46
eH2_7                 1.138612e-01 1 1  ON 47
eH2_8                 9.285255e-02 1 1  ON 48
eH2_9                 2.615292e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5764e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2203
    reference variance = 0.180251
====================================================
  Execution time = 3.1327e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1814e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318154429949
                                         uncertainty =       0.004947093728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318154429949
                                         uncertainty =       0.004947093728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398835005
  error estimate for blocks of size 2^( 2) =       0.000408456827
  error estimate for blocks of size 2^( 3) =       0.000417028589
  error estimate for blocks of size 2^( 4) =       0.000422618770
  error estimate for blocks of size 2^( 5) =       0.000426444873
  error estimate for blocks of size 2^( 6) =       0.000427997048
  error estimate for blocks of size 2^( 7) =       0.000431556573

      target function =                  N/A
              le_mean =     -17.216520887419
             les_mean =     296.726730030048
             stat err =       0.000427154316
             autocorr =       1.147051881006
              std dev =       0.564037872995
             le_variance =       0.318138722173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652088742e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216520887419       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520894667       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520902176       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216520910383       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216520909760       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216520908888       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216520909164       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216520909261       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 5.511259e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216520887419       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520889232       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520891111       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216520893163       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216520893006       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216520892788       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216520892859       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216520892879       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 1.378131e-06

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216520887419       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520887873       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520888342       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216520888856       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216520888816       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216520888762       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216520888775       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216520888785       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 3.445527e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246216 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0054e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.028342e-01 1 1  ON 0
 uu_1                 4.339672e-02 1 1  ON 1
 uu_2                -4.815667e-02 1 1  ON 2
 uu_3                -9.956366e-02 1 1  ON 3
 uu_4                -1.294776e-01 1 1  ON 4
 uu_5                -1.341254e-01 1 1  ON 5
 uu_6                -1.112546e-01 1 1  ON 6
 uu_7                -3.670216e-02 1 1  ON 7
 uu_8                 1.013830e-01 1 1  ON 8
 uu_9                 1.199930e-01 1 1  ON 9
 ud_0                 3.408680e-01 1 1  ON 10
 ud_1                 8.677001e-02 1 1  ON 11
 ud_2                -1.577172e-02 1 1  ON 12
 ud_3                -7.111672e-02 1 1  ON 13
 ud_4                -1.166265e-01 1 1  ON 14
 ud_5                -1.495778e-01 1 1  ON 15
 ud_6                -1.552976e-01 1 1  ON 16
 ud_7                -1.100663e-01 1 1  ON 17
 ud_8                 6.805643e-03 1 1  ON 18
 ud_9                 9.254916e-02 1 1  ON 19
 eO_0                -7.303202e-01 1 1  ON 20
 eO_1                -4.238111e-01 1 1  ON 21
 eO_2                -3.824769e-02 1 1  ON 22
 eO_3                 1.950568e-01 1 1  ON 23
 eO_4                 2.771569e-01 1 1  ON 24
 eO_5                 3.042378e-01 1 1  ON 25
 eO_6                 2.489207e-01 1 1  ON 26
 eO_7                 1.104691e-01 1 1  ON 27
 eO_8                 2.772146e-02 1 1  ON 28
 eO_9                 1.832606e-02 1 1  ON 29
eH1_0                -1.792432e-01 1 1  ON 30
eH1_1                -1.010244e-01 1 1  ON 31
eH1_2                -6.215725e-02 1 1  ON 32
eH1_3                -2.654275e-02 1 1  ON 33
eH1_4                 1.925401e-02 1 1  ON 34
eH1_5                 3.325452e-02 1 1  ON 35
eH1_6                 7.689881e-02 1 1  ON 36
eH1_7                 1.105382e-01 1 1  ON 37
eH1_8                 8.979432e-02 1 1  ON 38
eH1_9                 2.403270e-02 1 1  ON 39
eH2_0                -1.814185e-01 1 1  ON 40
eH2_1                -1.026854e-01 1 1  ON 41
eH2_2                -6.368718e-02 1 1  ON 42
eH2_3                -2.776447e-02 1 1  ON 43
eH2_4                 1.810264e-02 1 1  ON 44
eH2_5                 3.401859e-02 1 1  ON 45
eH2_6                 7.850435e-02 1 1  ON 46
eH2_7                 1.138612e-01 1 1  ON 47
eH2_8                 9.285262e-02 1 1  ON 48
eH2_9                 2.615294e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2246
    reference variance = 0.125604
====================================================
  Execution time = 3.1178e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1512e-01
  Total weights = 2.0000e+06
  Execution time = 3.1439e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315105703632
                                         uncertainty =       0.003005428460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315105703632
                                         uncertainty =       0.003005428460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396938504
  error estimate for blocks of size 2^( 2) =       0.000406338574
  error estimate for blocks of size 2^( 3) =       0.000415550142
  error estimate for blocks of size 2^( 4) =       0.000422306769
  error estimate for blocks of size 2^( 5) =       0.000425666181
  error estimate for blocks of size 2^( 6) =       0.000429124297
  error estimate for blocks of size 2^( 7) =       0.000430785000

      target function =                  N/A
              le_mean =     -17.216274852230
             les_mean =     296.715239981181
             stat err =       0.000426970562
             autocorr =       1.157042760806
              std dev =       0.561355815163
             le_variance =       0.315120351217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315107088224
                                         uncertainty =       0.003005442279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315107088224
                                         uncertainty =       0.003005442279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396939375
  error estimate for blocks of size 2^( 2) =       0.000406339386
  error estimate for blocks of size 2^( 3) =       0.000415550887
  error estimate for blocks of size 2^( 4) =       0.000422307470
  error estimate for blocks of size 2^( 5) =       0.000425666855
  error estimate for blocks of size 2^( 6) =       0.000429124981
  error estimate for blocks of size 2^( 7) =       0.000430785656

      target function =                  N/A
              le_mean =     -17.216274858225
             les_mean =     296.715241572013
             stat err =       0.000426971241
             autocorr =       1.157041357440
              std dev =       0.561357048241
             le_variance =       0.315121735610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315106396251
                                         uncertainty =       0.003005435372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315106396251
                                         uncertainty =       0.003005435372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396938940
  error estimate for blocks of size 2^( 2) =       0.000406338980
  error estimate for blocks of size 2^( 3) =       0.000415550515
  error estimate for blocks of size 2^( 4) =       0.000422307120
  error estimate for blocks of size 2^( 5) =       0.000425666518
  error estimate for blocks of size 2^( 6) =       0.000429124639
  error estimate for blocks of size 2^( 7) =       0.000430785329

      target function =                  N/A
              le_mean =     -17.216274855227
             les_mean =     296.715240776909
             stat err =       0.000426970901
             autocorr =       1.157042058856
              std dev =       0.561356431990
             le_variance =       0.315121043737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315105790219
                                         uncertainty =       0.003005429324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315105790219
                                         uncertainty =       0.003005429324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396938558
  error estimate for blocks of size 2^( 2) =       0.000406338625
  error estimate for blocks of size 2^( 3) =       0.000415550189
  error estimate for blocks of size 2^( 4) =       0.000422306813
  error estimate for blocks of size 2^( 5) =       0.000425666223
  error estimate for blocks of size 2^( 6) =       0.000429124339
  error estimate for blocks of size 2^( 7) =       0.000430785041

      target function =                  N/A
              le_mean =     -17.216274852604
             les_mean =     296.715240080652
             stat err =       0.000426970604
             autocorr =       1.157042673050
              std dev =       0.561355892275
             le_variance =       0.315120437791


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216274852230        initial
     2.3842e+02     2.3842e+03             5.5113e-06       -17.216274858225  <--
     9.5367e+02     9.5367e+03             1.3781e-06       -17.216274855227
     3.8147e+03     3.8147e+04             3.4455e-07       -17.216274852604

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 4.6121e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.028356e-01 1 1  ON 0
 uu_1                 4.339723e-02 1 1  ON 1
 uu_2                -4.815657e-02 1 1  ON 2
 uu_3                -9.956392e-02 1 1  ON 3
 uu_4                -1.294783e-01 1 1  ON 4
 uu_5                -1.341259e-01 1 1  ON 5
 uu_6                -1.112549e-01 1 1  ON 6
 uu_7                -3.670275e-02 1 1  ON 7
 uu_8                 1.013827e-01 1 1  ON 8
 uu_9                 1.199932e-01 1 1  ON 9
 ud_0                 3.408692e-01 1 1  ON 10
 ud_1                 8.677063e-02 1 1  ON 11
 ud_2                -1.577161e-02 1 1  ON 12
 ud_3                -7.111729e-02 1 1  ON 13
 ud_4                -1.166273e-01 1 1  ON 14
 ud_5                -1.495780e-01 1 1  ON 15
 ud_6                -1.552975e-01 1 1  ON 16
 ud_7                -1.100664e-01 1 1  ON 17
 ud_8                 6.805230e-03 1 1  ON 18
 ud_9                 9.254911e-02 1 1  ON 19
 eO_0                -7.303243e-01 1 1  ON 20
 eO_1                -4.238131e-01 1 1  ON 21
 eO_2                -3.824732e-02 1 1  ON 22
 eO_3                 1.950593e-01 1 1  ON 23
 eO_4                 2.771592e-01 1 1  ON 24
 eO_5                 3.042381e-01 1 1  ON 25
 eO_6                 2.489209e-01 1 1  ON 26
 eO_7                 1.104695e-01 1 1  ON 27
 eO_8                 2.772152e-02 1 1  ON 28
 eO_9                 1.832608e-02 1 1  ON 29
eH1_0                -1.792438e-01 1 1  ON 30
eH1_1                -1.010245e-01 1 1  ON 31
eH1_2                -6.215696e-02 1 1  ON 32
eH1_3                -2.654263e-02 1 1  ON 33
eH1_4                 1.925385e-02 1 1  ON 34
eH1_5                 3.325505e-02 1 1  ON 35
eH1_6                 7.689874e-02 1 1  ON 36
eH1_7                 1.105380e-01 1 1  ON 37
eH1_8                 8.979448e-02 1 1  ON 38
eH1_9                 2.403276e-02 1 1  ON 39
eH2_0                -1.814185e-01 1 1  ON 40
eH2_1                -1.026857e-01 1 1  ON 41
eH2_2                -6.368708e-02 1 1  ON 42
eH2_3                -2.776456e-02 1 1  ON 43
eH2_4                 1.810230e-02 1 1  ON 44
eH2_5                 3.401882e-02 1 1  ON 45
eH2_6                 7.850440e-02 1 1  ON 46
eH2_7                 1.138612e-01 1 1  ON 47
eH2_8                 9.285285e-02 1 1  ON 48
eH2_9                 2.615301e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6185e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.3021
    reference variance = 0.506635
====================================================
  Execution time = 3.1711e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1766e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7649e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317709509057
                                         uncertainty =       0.003548946956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317709509057
                                         uncertainty =       0.003548946956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398537082
  error estimate for blocks of size 2^( 2) =       0.000408896362
  error estimate for blocks of size 2^( 3) =       0.000417904904
  error estimate for blocks of size 2^( 4) =       0.000424869045
  error estimate for blocks of size 2^( 5) =       0.000427660750
  error estimate for blocks of size 2^( 6) =       0.000429563630
  error estimate for blocks of size 2^( 7) =       0.000429602448

      target function =                  N/A
              le_mean =     -17.216106728543
             les_mean =     296.711994340449
             stat err =       0.000427923968
             autocorr =       1.152910918687
              std dev =       0.563616545808
             le_variance =       0.317663610709


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721610672854e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216106728543       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216106743009       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216106771285       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216106756522       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216106785352       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216106786231       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216106787803       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216106790789       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 2.139711e-05

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216106728543       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216106732165       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216106739253       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216106735551       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216106742751       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216106742974       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216106743366       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216106744108       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 5.353080e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216106728543       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216106729449       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216106731222       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216106730296       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216106732095       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216106732151       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216106732249       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216106732436       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 1.338508e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253068 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0490e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.028376e-01 1 1  ON 0
 uu_1                 4.339800e-02 1 1  ON 1
 uu_2                -4.815636e-02 1 1  ON 2
 uu_3                -9.956420e-02 1 1  ON 3
 uu_4                -1.294793e-01 1 1  ON 4
 uu_5                -1.341265e-01 1 1  ON 5
 uu_6                -1.112553e-01 1 1  ON 6
 uu_7                -3.670339e-02 1 1  ON 7
 uu_8                 1.013823e-01 1 1  ON 8
 uu_9                 1.199935e-01 1 1  ON 9
 ud_0                 3.408710e-01 1 1  ON 10
 ud_1                 8.677159e-02 1 1  ON 11
 ud_2                -1.577157e-02 1 1  ON 12
 ud_3                -7.111789e-02 1 1  ON 13
 ud_4                -1.166286e-01 1 1  ON 14
 ud_5                -1.495786e-01 1 1  ON 15
 ud_6                -1.552972e-01 1 1  ON 16
 ud_7                -1.100667e-01 1 1  ON 17
 ud_8                 6.804662e-03 1 1  ON 18
 ud_9                 9.254909e-02 1 1  ON 19
 eO_0                -7.303297e-01 1 1  ON 20
 eO_1                -4.238159e-01 1 1  ON 21
 eO_2                -3.824683e-02 1 1  ON 22
 eO_3                 1.950630e-01 1 1  ON 23
 eO_4                 2.771621e-01 1 1  ON 24
 eO_5                 3.042384e-01 1 1  ON 25
 eO_6                 2.489211e-01 1 1  ON 26
 eO_7                 1.104699e-01 1 1  ON 27
 eO_8                 2.772158e-02 1 1  ON 28
 eO_9                 1.832611e-02 1 1  ON 29
eH1_0                -1.792445e-01 1 1  ON 30
eH1_1                -1.010254e-01 1 1  ON 31
eH1_2                -6.215704e-02 1 1  ON 32
eH1_3                -2.654231e-02 1 1  ON 33
eH1_4                 1.925420e-02 1 1  ON 34
eH1_5                 3.325581e-02 1 1  ON 35
eH1_6                 7.689881e-02 1 1  ON 36
eH1_7                 1.105379e-01 1 1  ON 37
eH1_8                 8.979469e-02 1 1  ON 38
eH1_9                 2.403281e-02 1 1  ON 39
eH2_0                -1.814192e-01 1 1  ON 40
eH2_1                -1.026860e-01 1 1  ON 41
eH2_2                -6.368680e-02 1 1  ON 42
eH2_3                -2.776492e-02 1 1  ON 43
eH2_4                 1.810252e-02 1 1  ON 44
eH2_5                 3.401938e-02 1 1  ON 45
eH2_6                 7.850455e-02 1 1  ON 46
eH2_7                 1.138610e-01 1 1  ON 47
eH2_8                 9.285309e-02 1 1  ON 48
eH2_9                 2.615307e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1853
    reference variance = 0.141283
====================================================
  Execution time = 3.1164e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3709e-01
  Total weights = 2.0000e+06
  Execution time = 2.8719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337023129135
                                         uncertainty =       0.016767257152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337023129135
                                         uncertainty =       0.016767257152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410541965
  error estimate for blocks of size 2^( 2) =       0.000420109924
  error estimate for blocks of size 2^( 3) =       0.000428429656
  error estimate for blocks of size 2^( 4) =       0.000434874090
  error estimate for blocks of size 2^( 5) =       0.000439182610
  error estimate for blocks of size 2^( 6) =       0.000441060515
  error estimate for blocks of size 2^( 7) =       0.000442174366

      target function =                  N/A
              le_mean =     -17.216847105047
             les_mean =     296.756913480362
             stat err =       0.000439322895
             autocorr =       1.145124115727
              std dev =       0.580594015075
             le_variance =       0.337089410341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337029778461
                                         uncertainty =       0.016767526706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337029778461
                                         uncertainty =       0.016767526706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410546016
  error estimate for blocks of size 2^( 2) =       0.000420113690
  error estimate for blocks of size 2^( 3) =       0.000428433118
  error estimate for blocks of size 2^( 4) =       0.000434877349
  error estimate for blocks of size 2^( 5) =       0.000439185733
  error estimate for blocks of size 2^( 6) =       0.000441063578
  error estimate for blocks of size 2^( 7) =       0.000442177222

      target function =                  N/A
              le_mean =     -17.216847122209
             les_mean =     296.756920723158
             stat err =       0.000439325971
             autocorr =       1.145117550165
              std dev =       0.580599743521
             le_variance =       0.337096062177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337026461966
                                         uncertainty =       0.016767392158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337026461966
                                         uncertainty =       0.016767392158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410543995
  error estimate for blocks of size 2^( 2) =       0.000420111811
  error estimate for blocks of size 2^( 3) =       0.000428431391
  error estimate for blocks of size 2^( 4) =       0.000434875724
  error estimate for blocks of size 2^( 5) =       0.000439184176
  error estimate for blocks of size 2^( 6) =       0.000441062051
  error estimate for blocks of size 2^( 7) =       0.000442175798

      target function =                  N/A
              le_mean =     -17.216847113581
             les_mean =     296.756917108292
             stat err =       0.000439324437
             autocorr =       1.145120826493
              std dev =       0.580596886341
             le_variance =       0.337092744429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337023545981
                                         uncertainty =       0.016767274035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337023545981
                                         uncertainty =       0.016767274035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410542219
  error estimate for blocks of size 2^( 2) =       0.000420110160
  error estimate for blocks of size 2^( 3) =       0.000428429873
  error estimate for blocks of size 2^( 4) =       0.000434874294
  error estimate for blocks of size 2^( 5) =       0.000439182806
  error estimate for blocks of size 2^( 6) =       0.000441060707
  error estimate for blocks of size 2^( 7) =       0.000442174546

      target function =                  N/A
              le_mean =     -17.216847106110
             les_mean =     296.756913933965
             stat err =       0.000439323088
             autocorr =       1.145123704355
              std dev =       0.580594374193
             le_variance =       0.337089827345


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216847105047        initial
     5.9605e+01     5.9605e+02             2.1397e-05       -17.216847122209  <--
     2.3842e+02     2.3842e+03             5.3531e-06       -17.216847113581
     9.5367e+02     9.5367e+03             1.3385e-06       -17.216847106110

*****************************************************************************
Applying the update for shift_i =   5.9605e+01     and shift_s =   5.9605e+02
*****************************************************************************

  Execution time = 4.5631e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.028434e-01 1 1  ON 0
 uu_1                 4.340030e-02 1 1  ON 1
 uu_2                -4.815571e-02 1 1  ON 2
 uu_3                -9.956505e-02 1 1  ON 3
 uu_4                -1.294826e-01 1 1  ON 4
 uu_5                -1.341284e-01 1 1  ON 5
 uu_6                -1.112564e-01 1 1  ON 6
 uu_7                -3.670533e-02 1 1  ON 7
 uu_8                 1.013811e-01 1 1  ON 8
 uu_9                 1.199942e-01 1 1  ON 9
 ud_0                 3.408765e-01 1 1  ON 10
 ud_1                 8.677446e-02 1 1  ON 11
 ud_2                -1.577146e-02 1 1  ON 12
 ud_3                -7.111970e-02 1 1  ON 13
 ud_4                -1.166323e-01 1 1  ON 14
 ud_5                -1.495802e-01 1 1  ON 15
 ud_6                -1.552965e-01 1 1  ON 16
 ud_7                -1.100675e-01 1 1  ON 17
 ud_8                 6.802960e-03 1 1  ON 18
 ud_9                 9.254901e-02 1 1  ON 19
 eO_0                -7.303457e-01 1 1  ON 20
 eO_1                -4.238242e-01 1 1  ON 21
 eO_2                -3.824538e-02 1 1  ON 22
 eO_3                 1.950741e-01 1 1  ON 23
 eO_4                 2.771706e-01 1 1  ON 24
 eO_5                 3.042393e-01 1 1  ON 25
 eO_6                 2.489219e-01 1 1  ON 26
 eO_7                 1.104713e-01 1 1  ON 27
 eO_8                 2.772178e-02 1 1  ON 28
 eO_9                 1.832618e-02 1 1  ON 29
eH1_0                -1.792463e-01 1 1  ON 30
eH1_1                -1.010282e-01 1 1  ON 31
eH1_2                -6.215728e-02 1 1  ON 32
eH1_3                -2.654137e-02 1 1  ON 33
eH1_4                 1.925524e-02 1 1  ON 34
eH1_5                 3.325810e-02 1 1  ON 35
eH1_6                 7.689902e-02 1 1  ON 36
eH1_7                 1.105376e-01 1 1  ON 37
eH1_8                 8.979532e-02 1 1  ON 38
eH1_9                 2.403295e-02 1 1  ON 39
eH2_0                -1.814213e-01 1 1  ON 40
eH2_1                -1.026868e-01 1 1  ON 41
eH2_2                -6.368595e-02 1 1  ON 42
eH2_3                -2.776600e-02 1 1  ON 43
eH2_4                 1.810315e-02 1 1  ON 44
eH2_5                 3.402105e-02 1 1  ON 45
eH2_6                 7.850499e-02 1 1  ON 46
eH2_7                 1.138606e-01 1 1  ON 47
eH2_8                 9.285379e-02 1 1  ON 48
eH2_9                 2.615325e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6135e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2836
    reference variance = 0.369743
====================================================
  Execution time = 3.1973e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1118e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311033525125
                                         uncertainty =       0.002545233030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311033525125
                                         uncertainty =       0.002545233030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394451886
  error estimate for blocks of size 2^( 2) =       0.000404133803
  error estimate for blocks of size 2^( 3) =       0.000412861062
  error estimate for blocks of size 2^( 4) =       0.000419215654
  error estimate for blocks of size 2^( 5) =       0.000422185719
  error estimate for blocks of size 2^( 6) =       0.000425111405
  error estimate for blocks of size 2^( 7) =       0.000428208707

      target function =                  N/A
              le_mean =     -17.216070058102
             les_mean =     296.704252670420
             stat err =       0.000423680371
             autocorr =       1.153688635703
              std dev =       0.557839206696
             le_variance =       0.311184580527


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721607005810e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216070058102       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216070179844       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216070588734       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216070439057       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216070490497       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216070513908       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216070532929       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216070539083       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 9.002272e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216070058102       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216070088800       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216070191974       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216070154158       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216070166915       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216070172357       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216070177179       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216070178675       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 2.258510e-05

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216070058102       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216070065793       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216070091647       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216070082169       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216070085351       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216070086685       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216070087895       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216070088265       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 5.651276e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259983 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0523e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.028527e-01 1 1  ON 0
 uu_1                 4.340277e-02 1 1  ON 1
 uu_2                -4.815554e-02 1 1  ON 2
 uu_3                -9.956772e-02 1 1  ON 3
 uu_4                -1.294880e-01 1 1  ON 4
 uu_5                -1.341315e-01 1 1  ON 5
 uu_6                -1.112572e-01 1 1  ON 6
 uu_7                -3.670685e-02 1 1  ON 7
 uu_8                 1.013797e-01 1 1  ON 8
 uu_9                 1.199953e-01 1 1  ON 9
 ud_0                 3.408844e-01 1 1  ON 10
 ud_1                 8.677751e-02 1 1  ON 11
 ud_2                -1.577171e-02 1 1  ON 12
 ud_3                -7.112396e-02 1 1  ON 13
 ud_4                -1.166363e-01 1 1  ON 14
 ud_5                -1.495814e-01 1 1  ON 15
 ud_6                -1.552958e-01 1 1  ON 16
 ud_7                -1.100690e-01 1 1  ON 17
 ud_8                 6.800547e-03 1 1  ON 18
 ud_9                 9.254935e-02 1 1  ON 19
 eO_0                -7.303683e-01 1 1  ON 20
 eO_1                -4.238347e-01 1 1  ON 21
 eO_2                -3.824266e-02 1 1  ON 22
 eO_3                 1.950881e-01 1 1  ON 23
 eO_4                 2.771823e-01 1 1  ON 24
 eO_5                 3.042399e-01 1 1  ON 25
 eO_6                 2.489231e-01 1 1  ON 26
 eO_7                 1.104732e-01 1 1  ON 27
 eO_8                 2.772220e-02 1 1  ON 28
 eO_9                 1.832639e-02 1 1  ON 29
eH1_0                -1.792487e-01 1 1  ON 30
eH1_1                -1.010320e-01 1 1  ON 31
eH1_2                -6.215877e-02 1 1  ON 32
eH1_3                -2.654032e-02 1 1  ON 33
eH1_4                 1.925563e-02 1 1  ON 34
eH1_5                 3.326276e-02 1 1  ON 35
eH1_6                 7.689907e-02 1 1  ON 36
eH1_7                 1.105370e-01 1 1  ON 37
eH1_8                 8.979662e-02 1 1  ON 38
eH1_9                 2.403348e-02 1 1  ON 39
eH2_0                -1.814226e-01 1 1  ON 40
eH2_1                -1.026879e-01 1 1  ON 41
eH2_2                -6.368563e-02 1 1  ON 42
eH2_3                -2.776561e-02 1 1  ON 43
eH2_4                 1.810454e-02 1 1  ON 44
eH2_5                 3.402166e-02 1 1  ON 45
eH2_6                 7.850392e-02 1 1  ON 46
eH2_7                 1.138596e-01 1 1  ON 47
eH2_8                 9.285481e-02 1 1  ON 48
eH2_9                 2.615358e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1651
    reference variance = 0.230525
====================================================
  Execution time = 3.1330e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1969e-01
  Total weights = 2.0000e+06
  Execution time = 2.8686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319667546418
                                         uncertainty =       0.004243078771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319667546418
                                         uncertainty =       0.004243078771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399798112
  error estimate for blocks of size 2^( 2) =       0.000409350722
  error estimate for blocks of size 2^( 3) =       0.000418325330
  error estimate for blocks of size 2^( 4) =       0.000425178473
  error estimate for blocks of size 2^( 5) =       0.000429102524
  error estimate for blocks of size 2^( 6) =       0.000431079657
  error estimate for blocks of size 2^( 7) =       0.000433225488

      target function =                  N/A
              le_mean =     -17.216372504931
             les_mean =     296.723159128664
             stat err =       0.000429646536
             autocorr =       1.154891411982
              std dev =       0.565399911529
             le_variance =       0.319677059957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319699980893
                                         uncertainty =       0.004243655496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319699980893
                                         uncertainty =       0.004243655496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399818399
  error estimate for blocks of size 2^( 2) =       0.000409369681
  error estimate for blocks of size 2^( 3) =       0.000418343019
  error estimate for blocks of size 2^( 4) =       0.000425195445
  error estimate for blocks of size 2^( 5) =       0.000429119021
  error estimate for blocks of size 2^( 6) =       0.000431096011
  error estimate for blocks of size 2^( 7) =       0.000433241843

      target function =                  N/A
              le_mean =     -17.216372556121
             les_mean =     296.723193335027
             stat err =       0.000429663080
             autocorr =       1.154863150033
              std dev =       0.565428601806
             le_variance =       0.319709503740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319683931762
                                         uncertainty =       0.004243369572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319683931762
                                         uncertainty =       0.004243369572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399808360
  error estimate for blocks of size 2^( 2) =       0.000409360301
  error estimate for blocks of size 2^( 3) =       0.000418334269
  error estimate for blocks of size 2^( 4) =       0.000425187051
  error estimate for blocks of size 2^( 5) =       0.000429110863
  error estimate for blocks of size 2^( 6) =       0.000431087924
  error estimate for blocks of size 2^( 7) =       0.000433233755

      target function =                  N/A
              le_mean =     -17.216372529974
             les_mean =     296.723176380987
             stat err =       0.000429654898
             autocorr =       1.154877159259
              std dev =       0.565414405529
             le_variance =       0.319693449980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319669599612
                                         uncertainty =       0.004243115198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319669599612
                                         uncertainty =       0.004243115198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399799396
  error estimate for blocks of size 2^( 2) =       0.000409351922
  error estimate for blocks of size 2^( 3) =       0.000418326451
  error estimate for blocks of size 2^( 4) =       0.000425179548
  error estimate for blocks of size 2^( 5) =       0.000429103569
  error estimate for blocks of size 2^( 6) =       0.000431080693
  error estimate for blocks of size 2^( 7) =       0.000433226524

      target function =                  N/A
              le_mean =     -17.216372508000
             les_mean =     296.723161288131
             stat err =       0.000429647584
             autocorr =       1.154889626277
              std dev =       0.565401727745
             le_variance =       0.319679113737


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216372504931        initial
     1.4901e+01     1.4901e+02             9.0023e-05       -17.216372556121  <--
     5.9605e+01     5.9605e+02             2.2585e-05       -17.216372529974
     2.3842e+02     2.3842e+03             5.6513e-06       -17.216372508000

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 4.5791e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.028802e-01 1 1  ON 0
 uu_1                 4.341018e-02 1 1  ON 1
 uu_2                -4.815494e-02 1 1  ON 2
 uu_3                -9.957570e-02 1 1  ON 3
 uu_4                -1.295040e-01 1 1  ON 4
 uu_5                -1.341407e-01 1 1  ON 5
 uu_6                -1.112595e-01 1 1  ON 6
 uu_7                -3.671138e-02 1 1  ON 7
 uu_8                 1.013757e-01 1 1  ON 8
 uu_9                 1.199983e-01 1 1  ON 9
 ud_0                 3.409075e-01 1 1  ON 10
 ud_1                 8.678666e-02 1 1  ON 11
 ud_2                -1.577240e-02 1 1  ON 12
 ud_3                -7.113654e-02 1 1  ON 13
 ud_4                -1.166481e-01 1 1  ON 14
 ud_5                -1.495850e-01 1 1  ON 15
 ud_6                -1.552934e-01 1 1  ON 16
 ud_7                -1.100736e-01 1 1  ON 17
 ud_8                 6.793329e-03 1 1  ON 18
 ud_9                 9.255035e-02 1 1  ON 19
 eO_0                -7.304357e-01 1 1  ON 20
 eO_1                -4.238661e-01 1 1  ON 21
 eO_2                -3.823467e-02 1 1  ON 22
 eO_3                 1.951299e-01 1 1  ON 23
 eO_4                 2.772175e-01 1 1  ON 24
 eO_5                 3.042418e-01 1 1  ON 25
 eO_6                 2.489266e-01 1 1  ON 26
 eO_7                 1.104791e-01 1 1  ON 27
 eO_8                 2.772346e-02 1 1  ON 28
 eO_9                 1.832703e-02 1 1  ON 29
eH1_0                -1.792560e-01 1 1  ON 30
eH1_1                -1.010434e-01 1 1  ON 31
eH1_2                -6.216318e-02 1 1  ON 32
eH1_3                -2.653721e-02 1 1  ON 33
eH1_4                 1.925678e-02 1 1  ON 34
eH1_5                 3.327670e-02 1 1  ON 35
eH1_6                 7.689924e-02 1 1  ON 36
eH1_7                 1.105353e-01 1 1  ON 37
eH1_8                 8.980051e-02 1 1  ON 38
eH1_9                 2.403509e-02 1 1  ON 39
eH2_0                -1.814263e-01 1 1  ON 40
eH2_1                -1.026909e-01 1 1  ON 41
eH2_2                -6.368461e-02 1 1  ON 42
eH2_3                -2.776446e-02 1 1  ON 43
eH2_4                 1.810867e-02 1 1  ON 44
eH2_5                 3.402351e-02 1 1  ON 45
eH2_6                 7.850073e-02 1 1  ON 46
eH2_7                 1.138568e-01 1 1  ON 47
eH2_8                 9.285787e-02 1 1  ON 48
eH2_9                 2.615454e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6327e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1899
    reference variance = 0.167991
====================================================
  Execution time = 3.2422e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2047e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320497464423
                                         uncertainty =       0.005386955296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320497464423
                                         uncertainty =       0.005386955296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400295644
  error estimate for blocks of size 2^( 2) =       0.000409815062
  error estimate for blocks of size 2^( 3) =       0.000418319530
  error estimate for blocks of size 2^( 4) =       0.000424645330
  error estimate for blocks of size 2^( 5) =       0.000429260117
  error estimate for blocks of size 2^( 6) =       0.000431822178
  error estimate for blocks of size 2^( 7) =       0.000435275994

      target function =                  N/A
              le_mean =     -17.216939730073
             les_mean =     296.743486713960
             stat err =       0.000430250905
             autocorr =       1.155265638555
              std dev =       0.566103528721
             le_variance =       0.320473205230


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693973007e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216939730073       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216939763550       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216940082015       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216940763039       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216941517620       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216941470040       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216941346303       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216941361062       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 3.392933e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216939730073       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216939738702       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216939820170       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216939987057       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216940181667       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216940171399       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216940142509       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216940145223       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 8.604841e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216939730073       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216939732247       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216939752734       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216939794213       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216939843236       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216939840794       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216939833732       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216939834327       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 2.159183e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266950 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1082e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.029056e-01 1 1  ON 0
 uu_1                 4.341986e-02 1 1  ON 1
 uu_2                -4.814926e-02 1 1  ON 2
 uu_3                -9.958067e-02 1 1  ON 3
 uu_4                -1.295235e-01 1 1  ON 4
 uu_5                -1.341472e-01 1 1  ON 5
 uu_6                -1.112630e-01 1 1  ON 6
 uu_7                -3.672185e-02 1 1  ON 7
 uu_8                 1.013711e-01 1 1  ON 8
 uu_9                 1.200026e-01 1 1  ON 9
 ud_0                 3.409391e-01 1 1  ON 10
 ud_1                 8.679701e-02 1 1  ON 11
 ud_2                -1.577255e-02 1 1  ON 12
 ud_3                -7.115170e-02 1 1  ON 13
 ud_4                -1.166644e-01 1 1  ON 14
 ud_5                -1.495945e-01 1 1  ON 15
 ud_6                -1.552854e-01 1 1  ON 16
 ud_7                -1.100754e-01 1 1  ON 17
 ud_8                 6.782425e-03 1 1  ON 18
 ud_9                 9.255043e-02 1 1  ON 19
 eO_0                -7.305218e-01 1 1  ON 20
 eO_1                -4.239054e-01 1 1  ON 21
 eO_2                -3.822764e-02 1 1  ON 22
 eO_3                 1.951843e-01 1 1  ON 23
 eO_4                 2.772657e-01 1 1  ON 24
 eO_5                 3.042428e-01 1 1  ON 25
 eO_6                 2.489313e-01 1 1  ON 26
 eO_7                 1.104869e-01 1 1  ON 27
 eO_8                 2.772473e-02 1 1  ON 28
 eO_9                 1.832771e-02 1 1  ON 29
eH1_0                -1.792670e-01 1 1  ON 30
eH1_1                -1.010517e-01 1 1  ON 31
eH1_2                -6.216675e-02 1 1  ON 32
eH1_3                -2.653307e-02 1 1  ON 33
eH1_4                 1.925440e-02 1 1  ON 34
eH1_5                 3.329109e-02 1 1  ON 35
eH1_6                 7.689866e-02 1 1  ON 36
eH1_7                 1.105353e-01 1 1  ON 37
eH1_8                 8.980626e-02 1 1  ON 38
eH1_9                 2.403637e-02 1 1  ON 39
eH2_0                -1.814310e-01 1 1  ON 40
eH2_1                -1.026994e-01 1 1  ON 41
eH2_2                -6.367726e-02 1 1  ON 42
eH2_3                -2.776072e-02 1 1  ON 43
eH2_4                 1.811413e-02 1 1  ON 44
eH2_5                 3.402735e-02 1 1  ON 45
eH2_6                 7.849559e-02 1 1  ON 46
eH2_7                 1.138498e-01 1 1  ON 47
eH2_8                 9.286082e-02 1 1  ON 48
eH2_9                 2.615597e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1951
    reference variance = 0.300683
====================================================
  Execution time = 3.1197e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1680e-01
  Total weights = 2.0000e+06
  Execution time = 2.8654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316845096513
                                         uncertainty =       0.003529506468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316845096513
                                         uncertainty =       0.003529506468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397980288
  error estimate for blocks of size 2^( 2) =       0.000408026694
  error estimate for blocks of size 2^( 3) =       0.000416831881
  error estimate for blocks of size 2^( 4) =       0.000424070390
  error estimate for blocks of size 2^( 5) =       0.000428051298
  error estimate for blocks of size 2^( 6) =       0.000430823224
  error estimate for blocks of size 2^( 7) =       0.000433359194

      target function =                  N/A
              le_mean =     -17.215793194190
             les_mean =     296.700311766663
             stat err =       0.000429076026
             autocorr =       1.162372630180
              std dev =       0.562829121426
             le_variance =       0.316776619925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316948048758
                                         uncertainty =       0.003530389937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316948048758
                                         uncertainty =       0.003530389937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398044935
  error estimate for blocks of size 2^( 2) =       0.000408087001
  error estimate for blocks of size 2^( 3) =       0.000416887526
  error estimate for blocks of size 2^( 4) =       0.000424123655
  error estimate for blocks of size 2^( 5) =       0.000428103794
  error estimate for blocks of size 2^( 6) =       0.000430874409
  error estimate for blocks of size 2^( 7) =       0.000433411539

      target function =                  N/A
              le_mean =     -17.215792736136
             les_mean =     296.700398915654
             stat err =       0.000429128349
             autocorr =       1.162278509587
              std dev =       0.562920545468
             le_variance =       0.316879540510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316898829406
                                         uncertainty =       0.003529974843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316898829406
                                         uncertainty =       0.003529974843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398014030
  error estimate for blocks of size 2^( 2) =       0.000408058187
  error estimate for blocks of size 2^( 3) =       0.000416860967
  error estimate for blocks of size 2^( 4) =       0.000424098254
  error estimate for blocks of size 2^( 5) =       0.000428078756
  error estimate for blocks of size 2^( 6) =       0.000430849990
  error estimate for blocks of size 2^( 7) =       0.000433386546

      target function =                  N/A
              le_mean =     -17.215792942822
             les_mean =     296.700356827483
             stat err =       0.000429103386
             autocorr =       1.162323776031
              std dev =       0.562876838903
             le_variance =       0.316830335773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316851884893
                                         uncertainty =       0.003529565946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316851884893
                                         uncertainty =       0.003529565946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397984551
  error estimate for blocks of size 2^( 2) =       0.000408030673
  error estimate for blocks of size 2^( 3) =       0.000416835556
  error estimate for blocks of size 2^( 4) =       0.000424073911
  error estimate for blocks of size 2^( 5) =       0.000428054768
  error estimate for blocks of size 2^( 6) =       0.000430826606
  error estimate for blocks of size 2^( 7) =       0.000433362649

      target function =                  N/A
              le_mean =     -17.215793161408
             les_mean =     296.700317424129
             stat err =       0.000429079484
             autocorr =       1.162366459891
              std dev =       0.562835150049
             le_variance =       0.316783406131


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215793194190        initial  <--
     3.7253e+00     3.7253e+01             3.3929e-04       -17.215792736136
     1.4901e+01     1.4901e+02             8.6048e-05       -17.215792942822
     5.9605e+01     5.9605e+02             2.1592e-05       -17.215793161408

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6332
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.028802e-01 1 1  ON 0
 uu_1                 4.341018e-02 1 1  ON 1
 uu_2                -4.815494e-02 1 1  ON 2
 uu_3                -9.957570e-02 1 1  ON 3
 uu_4                -1.295040e-01 1 1  ON 4
 uu_5                -1.341407e-01 1 1  ON 5
 uu_6                -1.112595e-01 1 1  ON 6
 uu_7                -3.671138e-02 1 1  ON 7
 uu_8                 1.013757e-01 1 1  ON 8
 uu_9                 1.199983e-01 1 1  ON 9
 ud_0                 3.409075e-01 1 1  ON 10
 ud_1                 8.678666e-02 1 1  ON 11
 ud_2                -1.577240e-02 1 1  ON 12
 ud_3                -7.113654e-02 1 1  ON 13
 ud_4                -1.166481e-01 1 1  ON 14
 ud_5                -1.495850e-01 1 1  ON 15
 ud_6                -1.552934e-01 1 1  ON 16
 ud_7                -1.100736e-01 1 1  ON 17
 ud_8                 6.793329e-03 1 1  ON 18
 ud_9                 9.255035e-02 1 1  ON 19
 eO_0                -7.304357e-01 1 1  ON 20
 eO_1                -4.238661e-01 1 1  ON 21
 eO_2                -3.823467e-02 1 1  ON 22
 eO_3                 1.951299e-01 1 1  ON 23
 eO_4                 2.772175e-01 1 1  ON 24
 eO_5                 3.042418e-01 1 1  ON 25
 eO_6                 2.489266e-01 1 1  ON 26
 eO_7                 1.104791e-01 1 1  ON 27
 eO_8                 2.772346e-02 1 1  ON 28
 eO_9                 1.832703e-02 1 1  ON 29
eH1_0                -1.792560e-01 1 1  ON 30
eH1_1                -1.010434e-01 1 1  ON 31
eH1_2                -6.216318e-02 1 1  ON 32
eH1_3                -2.653721e-02 1 1  ON 33
eH1_4                 1.925678e-02 1 1  ON 34
eH1_5                 3.327670e-02 1 1  ON 35
eH1_6                 7.689924e-02 1 1  ON 36
eH1_7                 1.105353e-01 1 1  ON 37
eH1_8                 8.980051e-02 1 1  ON 38
eH1_9                 2.403509e-02 1 1  ON 39
eH2_0                -1.814263e-01 1 1  ON 40
eH2_1                -1.026909e-01 1 1  ON 41
eH2_2                -6.368461e-02 1 1  ON 42
eH2_3                -2.776446e-02 1 1  ON 43
eH2_4                 1.810867e-02 1 1  ON 44
eH2_5                 3.402351e-02 1 1  ON 45
eH2_6                 7.850073e-02 1 1  ON 46
eH2_7                 1.138568e-01 1 1  ON 47
eH2_8                 9.285787e-02 1 1  ON 48
eH2_9                 2.615454e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6729e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2287
    reference variance = 0.138915
====================================================
  Execution time = 3.3762e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2727e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327179696188
                                         uncertainty =       0.006015455176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327179696188
                                         uncertainty =       0.006015455176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404519461
  error estimate for blocks of size 2^( 2) =       0.000414213919
  error estimate for blocks of size 2^( 3) =       0.000423075300
  error estimate for blocks of size 2^( 4) =       0.000428846852
  error estimate for blocks of size 2^( 5) =       0.000432423645
  error estimate for blocks of size 2^( 6) =       0.000434845868
  error estimate for blocks of size 2^( 7) =       0.000436540143

      target function =                  N/A
              le_mean =     -17.217316433761
             les_mean =     296.763257005478
             stat err =       0.000433164127
             autocorr =       1.146637458533
              std dev =       0.572076908177
             le_variance =       0.327271988869


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721731643376e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217316433761       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217316453568       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217316469295       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217316501675       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217316520488       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217316524502       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217316523847       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217316523998       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 3.414104e-05

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217316433761       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217316438732       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217316442671       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217316450754       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217316455466       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217316456466       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217316456306       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217316456339       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 8.548150e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217316433761       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217316435005       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217316435990       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217316438010       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217316439189       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217316439438       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217316439399       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217316439406       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 2.137847e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.269541 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.2373e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.028822e-01 1 1  ON 0
 uu_1                 4.341084e-02 1 1  ON 1
 uu_2                -4.815483e-02 1 1  ON 2
 uu_3                -9.957624e-02 1 1  ON 3
 uu_4                -1.295049e-01 1 1  ON 4
 uu_5                -1.341422e-01 1 1  ON 5
 uu_6                -1.112595e-01 1 1  ON 6
 uu_7                -3.671174e-02 1 1  ON 7
 uu_8                 1.013754e-01 1 1  ON 8
 uu_9                 1.199987e-01 1 1  ON 9
 ud_0                 3.409096e-01 1 1  ON 10
 ud_1                 8.678802e-02 1 1  ON 11
 ud_2                -1.577269e-02 1 1  ON 12
 ud_3                -7.113802e-02 1 1  ON 13
 ud_4                -1.166500e-01 1 1  ON 14
 ud_5                -1.495861e-01 1 1  ON 15
 ud_6                -1.552920e-01 1 1  ON 16
 ud_7                -1.100735e-01 1 1  ON 17
 ud_8                 6.792789e-03 1 1  ON 18
 ud_9                 9.255042e-02 1 1  ON 19
 eO_0                -7.304443e-01 1 1  ON 20
 eO_1                -4.238705e-01 1 1  ON 21
 eO_2                -3.823411e-02 1 1  ON 22
 eO_3                 1.951353e-01 1 1  ON 23
 eO_4                 2.772222e-01 1 1  ON 24
 eO_5                 3.042422e-01 1 1  ON 25
 eO_6                 2.489273e-01 1 1  ON 26
 eO_7                 1.104800e-01 1 1  ON 27
 eO_8                 2.772363e-02 1 1  ON 28
 eO_9                 1.832707e-02 1 1  ON 29
eH1_0                -1.792565e-01 1 1  ON 30
eH1_1                -1.010442e-01 1 1  ON 31
eH1_2                -6.216337e-02 1 1  ON 32
eH1_3                -2.653708e-02 1 1  ON 33
eH1_4                 1.925649e-02 1 1  ON 34
eH1_5                 3.327750e-02 1 1  ON 35
eH1_6                 7.689917e-02 1 1  ON 36
eH1_7                 1.105355e-01 1 1  ON 37
eH1_8                 8.980105e-02 1 1  ON 38
eH1_9                 2.403525e-02 1 1  ON 39
eH2_0                -1.814269e-01 1 1  ON 40
eH2_1                -1.026911e-01 1 1  ON 41
eH2_2                -6.368442e-02 1 1  ON 42
eH2_3                -2.776492e-02 1 1  ON 43
eH2_4                 1.810833e-02 1 1  ON 44
eH2_5                 3.402398e-02 1 1  ON 45
eH2_6                 7.850094e-02 1 1  ON 46
eH2_7                 1.138568e-01 1 1  ON 47
eH2_8                 9.285835e-02 1 1  ON 48
eH2_9                 2.615471e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1657
    reference variance = 0.196799
====================================================
  Execution time = 3.1208e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2837e-01
  Total weights = 2.0000e+06
  Execution time = 2.8721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328447782168
                                         uncertainty =       0.012940869067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328447782168
                                         uncertainty =       0.012940869067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405193286
  error estimate for blocks of size 2^( 2) =       0.000414984573
  error estimate for blocks of size 2^( 3) =       0.000423773765
  error estimate for blocks of size 2^( 4) =       0.000430678601
  error estimate for blocks of size 2^( 5) =       0.000435031758
  error estimate for blocks of size 2^( 6) =       0.000436610182
  error estimate for blocks of size 2^( 7) =       0.000437578330

      target function =                  N/A
              le_mean =     -17.216646888343
             les_mean =     296.741293112297
             stat err =       0.000434974718
             autocorr =       1.152400793800
              std dev =       0.573029840924
             le_variance =       0.328363198589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328456753859
                                         uncertainty =       0.012942047359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328456753859
                                         uncertainty =       0.012942047359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405198819
  error estimate for blocks of size 2^( 2) =       0.000414989778
  error estimate for blocks of size 2^( 3) =       0.000423778609
  error estimate for blocks of size 2^( 4) =       0.000430683214
  error estimate for blocks of size 2^( 5) =       0.000435036127
  error estimate for blocks of size 2^( 6) =       0.000436614539
  error estimate for blocks of size 2^( 7) =       0.000437582427

      target function =                  N/A
              le_mean =     -17.216646874111
             les_mean =     296.741301589153
             stat err =       0.000434979077
             autocorr =       1.152392419418
              std dev =       0.573037664996
             le_variance =       0.328372165504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328452277629
                                         uncertainty =       0.012941460984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328452277629
                                         uncertainty =       0.012941460984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405196059
  error estimate for blocks of size 2^( 2) =       0.000414987181
  error estimate for blocks of size 2^( 3) =       0.000423776192
  error estimate for blocks of size 2^( 4) =       0.000430680913
  error estimate for blocks of size 2^( 5) =       0.000435033947
  error estimate for blocks of size 2^( 6) =       0.000436612365
  error estimate for blocks of size 2^( 7) =       0.000437580383

      target function =                  N/A
              le_mean =     -17.216646881159
             les_mean =     296.741297357987
             stat err =       0.000434976902
             autocorr =       1.152396597597
              std dev =       0.573033761357
             le_variance =       0.328367691655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328448344373
                                         uncertainty =       0.012940943143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328448344373
                                         uncertainty =       0.012940943143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405193633
  error estimate for blocks of size 2^( 2) =       0.000414984899
  error estimate for blocks of size 2^( 3) =       0.000423774069
  error estimate for blocks of size 2^( 4) =       0.000430678891
  error estimate for blocks of size 2^( 5) =       0.000435032032
  error estimate for blocks of size 2^( 6) =       0.000436610455
  error estimate for blocks of size 2^( 7) =       0.000437578587

      target function =                  N/A
              le_mean =     -17.216646887438
             les_mean =     296.741293643031
             stat err =       0.000434974991
             autocorr =       1.152400268955
              std dev =       0.573030331216
             le_variance =       0.328363760494


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216646888343        initial  <--
     3.7253e+01     3.7253e+02             3.4141e-05       -17.216646874111
     1.4901e+02     1.4901e+03             8.5482e-06       -17.216646881159
     5.9605e+02     5.9605e+03             2.1378e-06       -17.216646887438

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6641
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.028802e-01 1 1  ON 0
 uu_1                 4.341018e-02 1 1  ON 1
 uu_2                -4.815494e-02 1 1  ON 2
 uu_3                -9.957570e-02 1 1  ON 3
 uu_4                -1.295040e-01 1 1  ON 4
 uu_5                -1.341407e-01 1 1  ON 5
 uu_6                -1.112595e-01 1 1  ON 6
 uu_7                -3.671138e-02 1 1  ON 7
 uu_8                 1.013757e-01 1 1  ON 8
 uu_9                 1.199983e-01 1 1  ON 9
 ud_0                 3.409075e-01 1 1  ON 10
 ud_1                 8.678666e-02 1 1  ON 11
 ud_2                -1.577240e-02 1 1  ON 12
 ud_3                -7.113654e-02 1 1  ON 13
 ud_4                -1.166481e-01 1 1  ON 14
 ud_5                -1.495850e-01 1 1  ON 15
 ud_6                -1.552934e-01 1 1  ON 16
 ud_7                -1.100736e-01 1 1  ON 17
 ud_8                 6.793329e-03 1 1  ON 18
 ud_9                 9.255035e-02 1 1  ON 19
 eO_0                -7.304357e-01 1 1  ON 20
 eO_1                -4.238661e-01 1 1  ON 21
 eO_2                -3.823467e-02 1 1  ON 22
 eO_3                 1.951299e-01 1 1  ON 23
 eO_4                 2.772175e-01 1 1  ON 24
 eO_5                 3.042418e-01 1 1  ON 25
 eO_6                 2.489266e-01 1 1  ON 26
 eO_7                 1.104791e-01 1 1  ON 27
 eO_8                 2.772346e-02 1 1  ON 28
 eO_9                 1.832703e-02 1 1  ON 29
eH1_0                -1.792560e-01 1 1  ON 30
eH1_1                -1.010434e-01 1 1  ON 31
eH1_2                -6.216318e-02 1 1  ON 32
eH1_3                -2.653721e-02 1 1  ON 33
eH1_4                 1.925678e-02 1 1  ON 34
eH1_5                 3.327670e-02 1 1  ON 35
eH1_6                 7.689924e-02 1 1  ON 36
eH1_7                 1.105353e-01 1 1  ON 37
eH1_8                 8.980051e-02 1 1  ON 38
eH1_9                 2.403509e-02 1 1  ON 39
eH2_0                -1.814263e-01 1 1  ON 40
eH2_1                -1.026909e-01 1 1  ON 41
eH2_2                -6.368461e-02 1 1  ON 42
eH2_3                -2.776446e-02 1 1  ON 43
eH2_4                 1.810867e-02 1 1  ON 44
eH2_5                 3.402351e-02 1 1  ON 45
eH2_6                 7.850073e-02 1 1  ON 46
eH2_7                 1.138568e-01 1 1  ON 47
eH2_8                 9.285787e-02 1 1  ON 48
eH2_9                 2.615454e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8042e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1756
    reference variance = 0.190545
====================================================
  Execution time = 3.2194e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1155e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6334e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311479388691
                                         uncertainty =       0.002478186348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311479388691
                                         uncertainty =       0.002478186348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394681714
  error estimate for blocks of size 2^( 2) =       0.000404758511
  error estimate for blocks of size 2^( 3) =       0.000413725131
  error estimate for blocks of size 2^( 4) =       0.000420309220
  error estimate for blocks of size 2^( 5) =       0.000425584277
  error estimate for blocks of size 2^( 6) =       0.000427440181
  error estimate for blocks of size 2^( 7) =       0.000427095164

      target function =                  N/A
              le_mean =     -17.215978148087
             les_mean =     296.701450751031
             stat err =       0.000425107210
             autocorr =       1.160120044259
              std dev =       0.558164233344
             le_variance =       0.311547311385


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721597814809e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215978148087       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215978152915       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215978155235       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215978159017       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215978160621       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215978161537       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215978161951       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215978161608       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 3.447663e-06

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215978148087       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215978149295       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215978149875       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215978150820       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215978151221       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215978151451       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215978151554       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215978151468       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 8.620420e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215978148087       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215978148389       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215978148534       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215978148770       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215978148871       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215978148928       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215978148948       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215978148936       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 2.155184e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0834e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.028804e-01 1 1  ON 0
 uu_1                 4.341032e-02 1 1  ON 1
 uu_2                -4.815492e-02 1 1  ON 2
 uu_3                -9.957577e-02 1 1  ON 3
 uu_4                -1.295042e-01 1 1  ON 4
 uu_5                -1.341408e-01 1 1  ON 5
 uu_6                -1.112595e-01 1 1  ON 6
 uu_7                -3.671147e-02 1 1  ON 7
 uu_8                 1.013756e-01 1 1  ON 8
 uu_9                 1.199984e-01 1 1  ON 9
 ud_0                 3.409078e-01 1 1  ON 10
 ud_1                 8.678674e-02 1 1  ON 11
 ud_2                -1.577240e-02 1 1  ON 12
 ud_3                -7.113666e-02 1 1  ON 13
 ud_4                -1.166482e-01 1 1  ON 14
 ud_5                -1.495850e-01 1 1  ON 15
 ud_6                -1.552934e-01 1 1  ON 16
 ud_7                -1.100736e-01 1 1  ON 17
 ud_8                 6.793246e-03 1 1  ON 18
 ud_9                 9.255035e-02 1 1  ON 19
 eO_0                -7.304366e-01 1 1  ON 20
 eO_1                -4.238666e-01 1 1  ON 21
 eO_2                -3.823462e-02 1 1  ON 22
 eO_3                 1.951305e-01 1 1  ON 23
 eO_4                 2.772180e-01 1 1  ON 24
 eO_5                 3.042418e-01 1 1  ON 25
 eO_6                 2.489266e-01 1 1  ON 26
 eO_7                 1.104792e-01 1 1  ON 27
 eO_8                 2.772348e-02 1 1  ON 28
 eO_9                 1.832704e-02 1 1  ON 29
eH1_0                -1.792560e-01 1 1  ON 30
eH1_1                -1.010435e-01 1 1  ON 31
eH1_2                -6.216321e-02 1 1  ON 32
eH1_3                -2.653714e-02 1 1  ON 33
eH1_4                 1.925678e-02 1 1  ON 34
eH1_5                 3.327675e-02 1 1  ON 35
eH1_6                 7.689923e-02 1 1  ON 36
eH1_7                 1.105353e-01 1 1  ON 37
eH1_8                 8.980056e-02 1 1  ON 38
eH1_9                 2.403511e-02 1 1  ON 39
eH2_0                -1.814263e-01 1 1  ON 40
eH2_1                -1.026910e-01 1 1  ON 41
eH2_2                -6.368458e-02 1 1  ON 42
eH2_3                -2.776447e-02 1 1  ON 43
eH2_4                 1.810868e-02 1 1  ON 44
eH2_5                 3.402352e-02 1 1  ON 45
eH2_6                 7.850069e-02 1 1  ON 46
eH2_7                 1.138568e-01 1 1  ON 47
eH2_8                 9.285791e-02 1 1  ON 48
eH2_9                 2.615455e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2315
    reference variance = 0.242406
====================================================
  Execution time = 3.1087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1796e-01
  Total weights = 2.0000e+06
  Execution time = 2.8567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318044452268
                                         uncertainty =       0.004024202933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318044452268
                                         uncertainty =       0.004024202933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398723726
  error estimate for blocks of size 2^( 2) =       0.000408258251
  error estimate for blocks of size 2^( 3) =       0.000417105429
  error estimate for blocks of size 2^( 4) =       0.000423241400
  error estimate for blocks of size 2^( 5) =       0.000426670922
  error estimate for blocks of size 2^( 6) =       0.000429380549
  error estimate for blocks of size 2^( 7) =       0.000433009291

      target function =                  N/A
              le_mean =     -17.216489614136
             les_mean =     296.725475694245
             stat err =       0.000428075541
             autocorr =       1.152647915106
              std dev =       0.563880501152
             le_variance =       0.317961219580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318045455787
                                         uncertainty =       0.004024216056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318045455787
                                         uncertainty =       0.004024216056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398724355
  error estimate for blocks of size 2^( 2) =       0.000408258836
  error estimate for blocks of size 2^( 3) =       0.000417105976
  error estimate for blocks of size 2^( 4) =       0.000423241916
  error estimate for blocks of size 2^( 5) =       0.000426671430
  error estimate for blocks of size 2^( 6) =       0.000429381065
  error estimate for blocks of size 2^( 7) =       0.000433009827

      target function =                  N/A
              le_mean =     -17.216489615884
             les_mean =     296.725476757967
             stat err =       0.000428076059
             autocorr =       1.152647070126
              std dev =       0.563881390981
             le_variance =       0.317962223095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318044954264
                                         uncertainty =       0.004024209498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318044954264
                                         uncertainty =       0.004024209498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398724041
  error estimate for blocks of size 2^( 2) =       0.000408258544
  error estimate for blocks of size 2^( 3) =       0.000417105703
  error estimate for blocks of size 2^( 4) =       0.000423241658
  error estimate for blocks of size 2^( 5) =       0.000426671176
  error estimate for blocks of size 2^( 6) =       0.000429380807
  error estimate for blocks of size 2^( 7) =       0.000433009559

      target function =                  N/A
              le_mean =     -17.216489615010
             les_mean =     296.725476226348
             stat err =       0.000428075800
             autocorr =       1.152647492457
              std dev =       0.563880946277
             le_variance =       0.317961721574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318044515024
                                         uncertainty =       0.004024203754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318044515024
                                         uncertainty =       0.004024203754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398723765
  error estimate for blocks of size 2^( 2) =       0.000408258287
  error estimate for blocks of size 2^( 3) =       0.000417105463
  error estimate for blocks of size 2^( 4) =       0.000423241432
  error estimate for blocks of size 2^( 5) =       0.000426670954
  error estimate for blocks of size 2^( 6) =       0.000429380581
  error estimate for blocks of size 2^( 7) =       0.000433009325

      target function =                  N/A
              le_mean =     -17.216489614245
             les_mean =     296.725475760764
             stat err =       0.000428075573
             autocorr =       1.152647862266
              std dev =       0.563880556799
             le_variance =       0.317961282336


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216489614136        initial
     3.7253e+02     3.7253e+03             3.4477e-06       -17.216489615884  <--
     1.4901e+03     1.4901e+04             8.6204e-07       -17.216489615010
     5.9605e+03     5.9605e+04             2.1552e-07       -17.216489614245

*****************************************************************************
Applying the update for shift_i =   3.7253e+02     and shift_s =   3.7253e+03
*****************************************************************************

  Execution time = 4.5516e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.028811e-01 1 1  ON 0
 uu_1                 4.341072e-02 1 1  ON 1
 uu_2                -4.815487e-02 1 1  ON 2
 uu_3                -9.957598e-02 1 1  ON 3
 uu_4                -1.295046e-01 1 1  ON 4
 uu_5                -1.341411e-01 1 1  ON 5
 uu_6                -1.112596e-01 1 1  ON 6
 uu_7                -3.671171e-02 1 1  ON 7
 uu_8                 1.013755e-01 1 1  ON 8
 uu_9                 1.199985e-01 1 1  ON 9
 ud_0                 3.409086e-01 1 1  ON 10
 ud_1                 8.678700e-02 1 1  ON 11
 ud_2                -1.577238e-02 1 1  ON 12
 ud_3                -7.113703e-02 1 1  ON 13
 ud_4                -1.166487e-01 1 1  ON 14
 ud_5                -1.495851e-01 1 1  ON 15
 ud_6                -1.552933e-01 1 1  ON 16
 ud_7                -1.100736e-01 1 1  ON 17
 ud_8                 6.792995e-03 1 1  ON 18
 ud_9                 9.255034e-02 1 1  ON 19
 eO_0                -7.304392e-01 1 1  ON 20
 eO_1                -4.238679e-01 1 1  ON 21
 eO_2                -3.823447e-02 1 1  ON 22
 eO_3                 1.951321e-01 1 1  ON 23
 eO_4                 2.772194e-01 1 1  ON 24
 eO_5                 3.042420e-01 1 1  ON 25
 eO_6                 2.489268e-01 1 1  ON 26
 eO_7                 1.104794e-01 1 1  ON 27
 eO_8                 2.772351e-02 1 1  ON 28
 eO_9                 1.832706e-02 1 1  ON 29
eH1_0                -1.792562e-01 1 1  ON 30
eH1_1                -1.010437e-01 1 1  ON 31
eH1_2                -6.216329e-02 1 1  ON 32
eH1_3                -2.653694e-02 1 1  ON 33
eH1_4                 1.925676e-02 1 1  ON 34
eH1_5                 3.327691e-02 1 1  ON 35
eH1_6                 7.689921e-02 1 1  ON 36
eH1_7                 1.105353e-01 1 1  ON 37
eH1_8                 8.980072e-02 1 1  ON 38
eH1_9                 2.403515e-02 1 1  ON 39
eH2_0                -1.814263e-01 1 1  ON 40
eH2_1                -1.026911e-01 1 1  ON 41
eH2_2                -6.368452e-02 1 1  ON 42
eH2_3                -2.776448e-02 1 1  ON 43
eH2_4                 1.810868e-02 1 1  ON 44
eH2_5                 3.402357e-02 1 1  ON 45
eH2_6                 7.850057e-02 1 1  ON 46
eH2_7                 1.138567e-01 1 1  ON 47
eH2_8                 9.285805e-02 1 1  ON 48
eH2_9                 2.615460e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6355e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.18
    reference variance = 0.318129
====================================================
  Execution time = 3.1941e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1628e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316332400557
                                         uncertainty =       0.003545767495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316332400557
                                         uncertainty =       0.003545767495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397665701
  error estimate for blocks of size 2^( 2) =       0.000407351216
  error estimate for blocks of size 2^( 3) =       0.000415738642
  error estimate for blocks of size 2^( 4) =       0.000421810408
  error estimate for blocks of size 2^( 5) =       0.000425596547
  error estimate for blocks of size 2^( 6) =       0.000428552969
  error estimate for blocks of size 2^( 7) =       0.000430364077

      target function =                  N/A
              le_mean =     -17.216193480181
             les_mean =     296.713593808144
             stat err =       0.000426581000
             autocorr =       1.150712282114
              std dev =       0.562384227421
             le_variance =       0.316276019251


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721619348018e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216193480181       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216193484983       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216193495185       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216193502548       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216193525701       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216193530864       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216193527400       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216193527762       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 1.352199e-05

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216193480181       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216193481384       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216193483927       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216193485763       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216193491554       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216193492848       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216193491983       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216193492074       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 3.382330e-06

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216193480181       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216193480482       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216193481117       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216193481576       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216193483024       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216193483347       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216193483132       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216193483154       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 8.456972e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274715 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0580e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.028822e-01 1 1  ON 0
 uu_1                 4.341099e-02 1 1  ON 1
 uu_2                -4.815463e-02 1 1  ON 2
 uu_3                -9.957613e-02 1 1  ON 3
 uu_4                -1.295051e-01 1 1  ON 4
 uu_5                -1.341415e-01 1 1  ON 5
 uu_6                -1.112598e-01 1 1  ON 6
 uu_7                -3.671216e-02 1 1  ON 7
 uu_8                 1.013752e-01 1 1  ON 8
 uu_9                 1.199986e-01 1 1  ON 9
 ud_0                 3.409097e-01 1 1  ON 10
 ud_1                 8.678760e-02 1 1  ON 11
 ud_2                -1.577215e-02 1 1  ON 12
 ud_3                -7.113758e-02 1 1  ON 13
 ud_4                -1.166494e-01 1 1  ON 14
 ud_5                -1.495856e-01 1 1  ON 15
 ud_6                -1.552930e-01 1 1  ON 16
 ud_7                -1.100739e-01 1 1  ON 17
 ud_8                 6.792575e-03 1 1  ON 18
 ud_9                 9.255035e-02 1 1  ON 19
 eO_0                -7.304426e-01 1 1  ON 20
 eO_1                -4.238697e-01 1 1  ON 21
 eO_2                -3.823416e-02 1 1  ON 22
 eO_3                 1.951346e-01 1 1  ON 23
 eO_4                 2.772213e-01 1 1  ON 24
 eO_5                 3.042420e-01 1 1  ON 25
 eO_6                 2.489270e-01 1 1  ON 26
 eO_7                 1.104797e-01 1 1  ON 27
 eO_8                 2.772355e-02 1 1  ON 28
 eO_9                 1.832707e-02 1 1  ON 29
eH1_0                -1.792566e-01 1 1  ON 30
eH1_1                -1.010436e-01 1 1  ON 31
eH1_2                -6.216353e-02 1 1  ON 32
eH1_3                -2.653685e-02 1 1  ON 33
eH1_4                 1.925676e-02 1 1  ON 34
eH1_5                 3.327730e-02 1 1  ON 35
eH1_6                 7.689922e-02 1 1  ON 36
eH1_7                 1.105352e-01 1 1  ON 37
eH1_8                 8.980086e-02 1 1  ON 38
eH1_9                 2.403520e-02 1 1  ON 39
eH2_0                -1.814268e-01 1 1  ON 40
eH2_1                -1.026913e-01 1 1  ON 41
eH2_2                -6.368443e-02 1 1  ON 42
eH2_3                -2.776439e-02 1 1  ON 43
eH2_4                 1.810869e-02 1 1  ON 44
eH2_5                 3.402388e-02 1 1  ON 45
eH2_6                 7.850055e-02 1 1  ON 46
eH2_7                 1.138566e-01 1 1  ON 47
eH2_8                 9.285820e-02 1 1  ON 48
eH2_9                 2.615464e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2375
    reference variance = 0.406996
====================================================
  Execution time = 3.1293e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2035e-01
  Total weights = 2.0000e+06
  Execution time = 2.8667e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320274559718
                                         uncertainty =       0.003235427567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320274559718
                                         uncertainty =       0.003235427567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400220221
  error estimate for blocks of size 2^( 2) =       0.000409846154
  error estimate for blocks of size 2^( 3) =       0.000418364729
  error estimate for blocks of size 2^( 4) =       0.000425130979
  error estimate for blocks of size 2^( 5) =       0.000428860077
  error estimate for blocks of size 2^( 6) =       0.000430859661
  error estimate for blocks of size 2^( 7) =       0.000433743398

      target function =                  N/A
              le_mean =     -17.217065479313
             les_mean =     296.747696009759
             stat err =       0.000429648529
             autocorr =       1.152467276909
              std dev =       0.565996864808
             le_variance =       0.320352450972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320277764764
                                         uncertainty =       0.003235454098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320277764764
                                         uncertainty =       0.003235454098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400222225
  error estimate for blocks of size 2^( 2) =       0.000409848030
  error estimate for blocks of size 2^( 3) =       0.000418366453
  error estimate for blocks of size 2^( 4) =       0.000425132603
  error estimate for blocks of size 2^( 5) =       0.000428861656
  error estimate for blocks of size 2^( 6) =       0.000430861276
  error estimate for blocks of size 2^( 7) =       0.000433745053

      target function =                  N/A
              le_mean =     -17.217065502083
             les_mean =     296.747700001116
             stat err =       0.000429650147
             autocorr =       1.152464418605
              std dev =       0.565999698117
             le_variance =       0.320355658269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320276163595
                                         uncertainty =       0.003235440847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320276163595
                                         uncertainty =       0.003235440847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400221224
  error estimate for blocks of size 2^( 2) =       0.000409847093
  error estimate for blocks of size 2^( 3) =       0.000418365592
  error estimate for blocks of size 2^( 4) =       0.000425131792
  error estimate for blocks of size 2^( 5) =       0.000428860868
  error estimate for blocks of size 2^( 6) =       0.000430860469
  error estimate for blocks of size 2^( 7) =       0.000433744226

      target function =                  N/A
              le_mean =     -17.217065490686
             les_mean =     296.747698006367
             stat err =       0.000429649339
             autocorr =       1.152465846980
              std dev =       0.565998282663
             le_variance =       0.320354055977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320274760239
                                         uncertainty =       0.003235429228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320274760239
                                         uncertainty =       0.003235429228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400220347
  error estimate for blocks of size 2^( 2) =       0.000409846272
  error estimate for blocks of size 2^( 3) =       0.000418364837
  error estimate for blocks of size 2^( 4) =       0.000425131080
  error estimate for blocks of size 2^( 5) =       0.000428860176
  error estimate for blocks of size 2^( 6) =       0.000430859762
  error estimate for blocks of size 2^( 7) =       0.000433743502

      target function =                  N/A
              le_mean =     -17.217065480734
             les_mean =     296.747696259326
             stat err =       0.000429648630
             autocorr =       1.152467098138
              std dev =       0.565997042072
             le_variance =       0.320352651635


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217065479313        initial
     9.3132e+01     9.3132e+02             1.3522e-05       -17.217065502083  <--
     3.7253e+02     3.7253e+03             3.3823e-06       -17.217065490686
     1.4901e+03     1.4901e+04             8.4570e-07       -17.217065480734

*****************************************************************************
Applying the update for shift_i =   9.3132e+01     and shift_s =   9.3132e+02
*****************************************************************************

  Execution time = 4.5759e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.028854e-01 1 1  ON 0
 uu_1                 4.341178e-02 1 1  ON 1
 uu_2                -4.815394e-02 1 1  ON 2
 uu_3                -9.957657e-02 1 1  ON 3
 uu_4                -1.295065e-01 1 1  ON 4
 uu_5                -1.341427e-01 1 1  ON 5
 uu_6                -1.112601e-01 1 1  ON 6
 uu_7                -3.671350e-02 1 1  ON 7
 uu_8                 1.013745e-01 1 1  ON 8
 uu_9                 1.199990e-01 1 1  ON 9
 ud_0                 3.409131e-01 1 1  ON 10
 ud_1                 8.678939e-02 1 1  ON 11
 ud_2                -1.577148e-02 1 1  ON 12
 ud_3                -7.113926e-02 1 1  ON 13
 ud_4                -1.166514e-01 1 1  ON 14
 ud_5                -1.495869e-01 1 1  ON 15
 ud_6                -1.552922e-01 1 1  ON 16
 ud_7                -1.100748e-01 1 1  ON 17
 ud_8                 6.791317e-03 1 1  ON 18
 ud_9                 9.255038e-02 1 1  ON 19
 eO_0                -7.304527e-01 1 1  ON 20
 eO_1                -4.238751e-01 1 1  ON 21
 eO_2                -3.823322e-02 1 1  ON 22
 eO_3                 1.951420e-01 1 1  ON 23
 eO_4                 2.772269e-01 1 1  ON 24
 eO_5                 3.042420e-01 1 1  ON 25
 eO_6                 2.489275e-01 1 1  ON 26
 eO_7                 1.104805e-01 1 1  ON 27
 eO_8                 2.772368e-02 1 1  ON 28
 eO_9                 1.832712e-02 1 1  ON 29
eH1_0                -1.792578e-01 1 1  ON 30
eH1_1                -1.010435e-01 1 1  ON 31
eH1_2                -6.216427e-02 1 1  ON 32
eH1_3                -2.653658e-02 1 1  ON 33
eH1_4                 1.925677e-02 1 1  ON 34
eH1_5                 3.327845e-02 1 1  ON 35
eH1_6                 7.689926e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980128e-02 1 1  ON 38
eH1_9                 2.403534e-02 1 1  ON 39
eH2_0                -1.814280e-01 1 1  ON 40
eH2_1                -1.026918e-01 1 1  ON 41
eH2_2                -6.368418e-02 1 1  ON 42
eH2_3                -2.776410e-02 1 1  ON 43
eH2_4                 1.810870e-02 1 1  ON 44
eH2_5                 3.402482e-02 1 1  ON 45
eH2_6                 7.850049e-02 1 1  ON 46
eH2_7                 1.138564e-01 1 1  ON 47
eH2_8                 9.285864e-02 1 1  ON 48
eH2_9                 2.615478e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6348e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1942
    reference variance = 0.169891
====================================================
  Execution time = 3.1560e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2318e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6388e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323258929369
                                         uncertainty =       0.005979156711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323258929369
                                         uncertainty =       0.005979156711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401981417
  error estimate for blocks of size 2^( 2) =       0.000411659587
  error estimate for blocks of size 2^( 3) =       0.000420470547
  error estimate for blocks of size 2^( 4) =       0.000426108057
  error estimate for blocks of size 2^( 5) =       0.000430085459
  error estimate for blocks of size 2^( 6) =       0.000432370073
  error estimate for blocks of size 2^( 7) =       0.000433172599

      target function =                  N/A
              le_mean =     -17.216390586863
             les_mean =     296.727282796476
             stat err =       0.000430434047
             autocorr =       1.146571862425
              std dev =       0.568487571215
             le_variance =       0.323178118626


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639058686e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216390586863       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216390628081       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216390872589       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216390899168       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216390897183       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216390915830       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216390909695       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216390913495       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 5.419991e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216390586863       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216390597219       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216390658824       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216390665233       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216390664572       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216390669278       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216390667782       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216390668697       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 1.357749e-05

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216390586863       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216390589456       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216390604887       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216390606474       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216390606298       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216390607478       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216390607106       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216390607333       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 3.396096e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.281603 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0213e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.028908e-01 1 1  ON 0
 uu_1                 4.341339e-02 1 1  ON 1
 uu_2                -4.815360e-02 1 1  ON 2
 uu_3                -9.957784e-02 1 1  ON 3
 uu_4                -1.295083e-01 1 1  ON 4
 uu_5                -1.341438e-01 1 1  ON 5
 uu_6                -1.112620e-01 1 1  ON 6
 uu_7                -3.671525e-02 1 1  ON 7
 uu_8                 1.013738e-01 1 1  ON 8
 uu_9                 1.199995e-01 1 1  ON 9
 ud_0                 3.409179e-01 1 1  ON 10
 ud_1                 8.679183e-02 1 1  ON 11
 ud_2                -1.577026e-02 1 1  ON 12
 ud_3                -7.114169e-02 1 1  ON 13
 ud_4                -1.166537e-01 1 1  ON 14
 ud_5                -1.495877e-01 1 1  ON 15
 ud_6                -1.552927e-01 1 1  ON 16
 ud_7                -1.100764e-01 1 1  ON 17
 ud_8                 6.789707e-03 1 1  ON 18
 ud_9                 9.255041e-02 1 1  ON 19
 eO_0                -7.304663e-01 1 1  ON 20
 eO_1                -4.238818e-01 1 1  ON 21
 eO_2                -3.823196e-02 1 1  ON 22
 eO_3                 1.951510e-01 1 1  ON 23
 eO_4                 2.772348e-01 1 1  ON 24
 eO_5                 3.042425e-01 1 1  ON 25
 eO_6                 2.489277e-01 1 1  ON 26
 eO_7                 1.104816e-01 1 1  ON 27
 eO_8                 2.772384e-02 1 1  ON 28
 eO_9                 1.832727e-02 1 1  ON 29
eH1_0                -1.792589e-01 1 1  ON 30
eH1_1                -1.010450e-01 1 1  ON 31
eH1_2                -6.216406e-02 1 1  ON 32
eH1_3                -2.653618e-02 1 1  ON 33
eH1_4                 1.925708e-02 1 1  ON 34
eH1_5                 3.327941e-02 1 1  ON 35
eH1_6                 7.689945e-02 1 1  ON 36
eH1_7                 1.105344e-01 1 1  ON 37
eH1_8                 8.980188e-02 1 1  ON 38
eH1_9                 2.403561e-02 1 1  ON 39
eH2_0                -1.814290e-01 1 1  ON 40
eH2_1                -1.026929e-01 1 1  ON 41
eH2_2                -6.368362e-02 1 1  ON 42
eH2_3                -2.776333e-02 1 1  ON 43
eH2_4                 1.810879e-02 1 1  ON 44
eH2_5                 3.402597e-02 1 1  ON 45
eH2_6                 7.850003e-02 1 1  ON 46
eH2_7                 1.138557e-01 1 1  ON 47
eH2_8                 9.285911e-02 1 1  ON 48
eH2_9                 2.615495e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1814
    reference variance = 0.177139
====================================================
  Execution time = 3.2619e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1539e-01
  Total weights = 2.0000e+06
  Execution time = 2.8730e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315504788474
                                         uncertainty =       0.003654996413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315504788474
                                         uncertainty =       0.003654996413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397105193
  error estimate for blocks of size 2^( 2) =       0.000407135136
  error estimate for blocks of size 2^( 3) =       0.000415860310
  error estimate for blocks of size 2^( 4) =       0.000421949383
  error estimate for blocks of size 2^( 5) =       0.000425869835
  error estimate for blocks of size 2^( 6) =       0.000428494957
  error estimate for blocks of size 2^( 7) =       0.000429671245

      target function =                  N/A
              le_mean =     -17.216177742337
             les_mean =     296.712160967176
             stat err =       0.000426496355
             autocorr =       1.153505086506
              std dev =       0.561591550101
             le_variance =       0.315385069145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315520444816
                                         uncertainty =       0.003655339841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315520444816
                                         uncertainty =       0.003655339841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397115046
  error estimate for blocks of size 2^( 2) =       0.000407144341
  error estimate for blocks of size 2^( 3) =       0.000415868884
  error estimate for blocks of size 2^( 4) =       0.000421957639
  error estimate for blocks of size 2^( 5) =       0.000425877707
  error estimate for blocks of size 2^( 6) =       0.000428502791
  error estimate for blocks of size 2^( 7) =       0.000429678913

      target function =                  N/A
              le_mean =     -17.216177676696
             les_mean =     296.712174357392
             stat err =       0.000426504262
             autocorr =       1.153490620829
              std dev =       0.561605483886
             le_variance =       0.315400719531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315512653501
                                         uncertainty =       0.003655168922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315512653501
                                         uncertainty =       0.003655168922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397110143
  error estimate for blocks of size 2^( 2) =       0.000407139761
  error estimate for blocks of size 2^( 3) =       0.000415864618
  error estimate for blocks of size 2^( 4) =       0.000421953531
  error estimate for blocks of size 2^( 5) =       0.000425873790
  error estimate for blocks of size 2^( 6) =       0.000428498893
  error estimate for blocks of size 2^( 7) =       0.000429675099

      target function =                  N/A
              le_mean =     -17.216177708956
             les_mean =     296.712167679833
             stat err =       0.000426500328
             autocorr =       1.153497825036
              std dev =       0.561598549845
             le_variance =       0.315392931188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315505772658
                                         uncertainty =       0.003655018002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315505772658
                                         uncertainty =       0.003655018002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397105813
  error estimate for blocks of size 2^( 2) =       0.000407135714
  error estimate for blocks of size 2^( 3) =       0.000415860849
  error estimate for blocks of size 2^( 4) =       0.000421949902
  error estimate for blocks of size 2^( 5) =       0.000425870330
  error estimate for blocks of size 2^( 6) =       0.000428495449
  error estimate for blocks of size 2^( 7) =       0.000429671727

      target function =                  N/A
              le_mean =     -17.216177738131
             les_mean =     296.712161806174
             stat err =       0.000426496852
             autocorr =       1.153504177843
              std dev =       0.561592426013
             le_variance =       0.315386052955


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216177742337        initial  <--
     2.3283e+01     2.3283e+02             5.4200e-05       -17.216177676696
     9.3132e+01     9.3132e+02             1.3577e-05       -17.216177708956
     3.7253e+02     3.7253e+03             3.3961e-06       -17.216177738131

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.0674
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.028854e-01 1 1  ON 0
 uu_1                 4.341178e-02 1 1  ON 1
 uu_2                -4.815394e-02 1 1  ON 2
 uu_3                -9.957657e-02 1 1  ON 3
 uu_4                -1.295065e-01 1 1  ON 4
 uu_5                -1.341427e-01 1 1  ON 5
 uu_6                -1.112601e-01 1 1  ON 6
 uu_7                -3.671350e-02 1 1  ON 7
 uu_8                 1.013745e-01 1 1  ON 8
 uu_9                 1.199990e-01 1 1  ON 9
 ud_0                 3.409131e-01 1 1  ON 10
 ud_1                 8.678939e-02 1 1  ON 11
 ud_2                -1.577148e-02 1 1  ON 12
 ud_3                -7.113926e-02 1 1  ON 13
 ud_4                -1.166514e-01 1 1  ON 14
 ud_5                -1.495869e-01 1 1  ON 15
 ud_6                -1.552922e-01 1 1  ON 16
 ud_7                -1.100748e-01 1 1  ON 17
 ud_8                 6.791317e-03 1 1  ON 18
 ud_9                 9.255038e-02 1 1  ON 19
 eO_0                -7.304527e-01 1 1  ON 20
 eO_1                -4.238751e-01 1 1  ON 21
 eO_2                -3.823322e-02 1 1  ON 22
 eO_3                 1.951420e-01 1 1  ON 23
 eO_4                 2.772269e-01 1 1  ON 24
 eO_5                 3.042420e-01 1 1  ON 25
 eO_6                 2.489275e-01 1 1  ON 26
 eO_7                 1.104805e-01 1 1  ON 27
 eO_8                 2.772368e-02 1 1  ON 28
 eO_9                 1.832712e-02 1 1  ON 29
eH1_0                -1.792578e-01 1 1  ON 30
eH1_1                -1.010435e-01 1 1  ON 31
eH1_2                -6.216427e-02 1 1  ON 32
eH1_3                -2.653658e-02 1 1  ON 33
eH1_4                 1.925677e-02 1 1  ON 34
eH1_5                 3.327845e-02 1 1  ON 35
eH1_6                 7.689926e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980128e-02 1 1  ON 38
eH1_9                 2.403534e-02 1 1  ON 39
eH2_0                -1.814280e-01 1 1  ON 40
eH2_1                -1.026918e-01 1 1  ON 41
eH2_2                -6.368418e-02 1 1  ON 42
eH2_3                -2.776410e-02 1 1  ON 43
eH2_4                 1.810870e-02 1 1  ON 44
eH2_5                 3.402482e-02 1 1  ON 45
eH2_6                 7.850049e-02 1 1  ON 46
eH2_7                 1.138564e-01 1 1  ON 47
eH2_8                 9.285864e-02 1 1  ON 48
eH2_9                 2.615478e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.7295e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2042
    reference variance = 0.228258
====================================================
  Execution time = 3.1787e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3514e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335173379367
                                         uncertainty =       0.015162333042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335173379367
                                         uncertainty =       0.015162333042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409354909
  error estimate for blocks of size 2^( 2) =       0.000418988456
  error estimate for blocks of size 2^( 3) =       0.000427788466
  error estimate for blocks of size 2^( 4) =       0.000434263157
  error estimate for blocks of size 2^( 5) =       0.000438423367
  error estimate for blocks of size 2^( 6) =       0.000440766786
  error estimate for blocks of size 2^( 7) =       0.000442118526

      target function =                  N/A
              le_mean =     -17.216293175751
             les_mean =     296.735893429414
             stat err =       0.000438892959
             autocorr =       1.149521824688
              std dev =       0.578915264600
             le_variance =       0.335142883587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629317575e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216293175751       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216293182407       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216293192137       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216293192988       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216293194515       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216293195829       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216293196015       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216293196343       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 5.522083e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216293175751       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216293177416       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216293179850       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216293180063       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216293180444       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216293180772       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216293180818       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216293180900       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 1.380826e-06

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216293175751       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216293176167       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216293176776       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216293176832       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216293176924       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216293177007       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216293177019       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216293177035       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 3.452255e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288480 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0499e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.028858e-01 1 1  ON 0
 uu_1                 4.341201e-02 1 1  ON 1
 uu_2                -4.815385e-02 1 1  ON 2
 uu_3                -9.957660e-02 1 1  ON 3
 uu_4                -1.295067e-01 1 1  ON 4
 uu_5                -1.341428e-01 1 1  ON 5
 uu_6                -1.112603e-01 1 1  ON 6
 uu_7                -3.671371e-02 1 1  ON 7
 uu_8                 1.013744e-01 1 1  ON 8
 uu_9                 1.199990e-01 1 1  ON 9
 ud_0                 3.409135e-01 1 1  ON 10
 ud_1                 8.678959e-02 1 1  ON 11
 ud_2                -1.577154e-02 1 1  ON 12
 ud_3                -7.113935e-02 1 1  ON 13
 ud_4                -1.166517e-01 1 1  ON 14
 ud_5                -1.495870e-01 1 1  ON 15
 ud_6                -1.552921e-01 1 1  ON 16
 ud_7                -1.100748e-01 1 1  ON 17
 ud_8                 6.791173e-03 1 1  ON 18
 ud_9                 9.255039e-02 1 1  ON 19
 eO_0                -7.304541e-01 1 1  ON 20
 eO_1                -4.238758e-01 1 1  ON 21
 eO_2                -3.823328e-02 1 1  ON 22
 eO_3                 1.951430e-01 1 1  ON 23
 eO_4                 2.772278e-01 1 1  ON 24
 eO_5                 3.042421e-01 1 1  ON 25
 eO_6                 2.489276e-01 1 1  ON 26
 eO_7                 1.104806e-01 1 1  ON 27
 eO_8                 2.772370e-02 1 1  ON 28
 eO_9                 1.832713e-02 1 1  ON 29
eH1_0                -1.792580e-01 1 1  ON 30
eH1_1                -1.010436e-01 1 1  ON 31
eH1_2                -6.216424e-02 1 1  ON 32
eH1_3                -2.653659e-02 1 1  ON 33
eH1_4                 1.925671e-02 1 1  ON 34
eH1_5                 3.327860e-02 1 1  ON 35
eH1_6                 7.689930e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980134e-02 1 1  ON 38
eH1_9                 2.403536e-02 1 1  ON 39
eH2_0                -1.814280e-01 1 1  ON 40
eH2_1                -1.026919e-01 1 1  ON 41
eH2_2                -6.368415e-02 1 1  ON 42
eH2_3                -2.776400e-02 1 1  ON 43
eH2_4                 1.810874e-02 1 1  ON 44
eH2_5                 3.402483e-02 1 1  ON 45
eH2_6                 7.850040e-02 1 1  ON 46
eH2_7                 1.138563e-01 1 1  ON 47
eH2_8                 9.285872e-02 1 1  ON 48
eH2_9                 2.615480e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2777
    reference variance = 0.178366
====================================================
  Execution time = 3.1458e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1702e-01
  Total weights = 2.0000e+06
  Execution time = 2.8718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316963593798
                                         uncertainty =       0.005596793018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316963593798
                                         uncertainty =       0.005596793018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398135859
  error estimate for blocks of size 2^( 2) =       0.000407932198
  error estimate for blocks of size 2^( 3) =       0.000417002231
  error estimate for blocks of size 2^( 4) =       0.000423797521
  error estimate for blocks of size 2^( 5) =       0.000428554450
  error estimate for blocks of size 2^( 6) =       0.000431628325
  error estimate for blocks of size 2^( 7) =       0.000432496104

      target function =                  N/A
              le_mean =     -17.216860283688
             les_mean =     296.737302193500
             stat err =       0.000429119100
             autocorr =       1.161697624144
              std dev =       0.563049131047
             le_variance =       0.317024323973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316965450588
                                         uncertainty =       0.005596877897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316965450588
                                         uncertainty =       0.005596877897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398137025
  error estimate for blocks of size 2^( 2) =       0.000407933278
  error estimate for blocks of size 2^( 3) =       0.000417003234
  error estimate for blocks of size 2^( 4) =       0.000423798454
  error estimate for blocks of size 2^( 5) =       0.000428555326
  error estimate for blocks of size 2^( 6) =       0.000431629197
  error estimate for blocks of size 2^( 7) =       0.000432496990

      target function =                  N/A
              le_mean =     -17.216860282324
             les_mean =     296.737304003974
             stat err =       0.000429119992
             autocorr =       1.161695645815
              std dev =       0.563050780509
             le_variance =       0.317026181431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316964522963
                                         uncertainty =       0.005596835486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316964522963
                                         uncertainty =       0.005596835486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398136442
  error estimate for blocks of size 2^( 2) =       0.000407932739
  error estimate for blocks of size 2^( 3) =       0.000417002733
  error estimate for blocks of size 2^( 4) =       0.000423797988
  error estimate for blocks of size 2^( 5) =       0.000428554888
  error estimate for blocks of size 2^( 6) =       0.000431628762
  error estimate for blocks of size 2^( 7) =       0.000432496547

      target function =                  N/A
              le_mean =     -17.216860283000
             les_mean =     296.737303099301
             stat err =       0.000429119546
             autocorr =       1.161696634333
              std dev =       0.563049956462
             le_variance =       0.317025253472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316963709967
                                         uncertainty =       0.005596798327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316963709967
                                         uncertainty =       0.005596798327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398135932
  error estimate for blocks of size 2^( 2) =       0.000407932266
  error estimate for blocks of size 2^( 3) =       0.000417002294
  error estimate for blocks of size 2^( 4) =       0.000423797579
  error estimate for blocks of size 2^( 5) =       0.000428554505
  error estimate for blocks of size 2^( 6) =       0.000431628380
  error estimate for blocks of size 2^( 7) =       0.000432496159

      target function =                  N/A
              le_mean =     -17.216860283602
             les_mean =     296.737302306737
             stat err =       0.000429119156
             autocorr =       1.161697500393
              std dev =       0.563049234244
             le_variance =       0.317024440183


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216860283688        initial  <--
     2.3283e+02     2.3283e+03             5.5221e-06       -17.216860282324
     9.3132e+02     9.3132e+03             1.3808e-06       -17.216860283000
     3.7253e+03     3.7253e+04             3.4523e-07       -17.216860283602

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.9310
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.028854e-01 1 1  ON 0
 uu_1                 4.341178e-02 1 1  ON 1
 uu_2                -4.815394e-02 1 1  ON 2
 uu_3                -9.957657e-02 1 1  ON 3
 uu_4                -1.295065e-01 1 1  ON 4
 uu_5                -1.341427e-01 1 1  ON 5
 uu_6                -1.112601e-01 1 1  ON 6
 uu_7                -3.671350e-02 1 1  ON 7
 uu_8                 1.013745e-01 1 1  ON 8
 uu_9                 1.199990e-01 1 1  ON 9
 ud_0                 3.409131e-01 1 1  ON 10
 ud_1                 8.678939e-02 1 1  ON 11
 ud_2                -1.577148e-02 1 1  ON 12
 ud_3                -7.113926e-02 1 1  ON 13
 ud_4                -1.166514e-01 1 1  ON 14
 ud_5                -1.495869e-01 1 1  ON 15
 ud_6                -1.552922e-01 1 1  ON 16
 ud_7                -1.100748e-01 1 1  ON 17
 ud_8                 6.791317e-03 1 1  ON 18
 ud_9                 9.255038e-02 1 1  ON 19
 eO_0                -7.304527e-01 1 1  ON 20
 eO_1                -4.238751e-01 1 1  ON 21
 eO_2                -3.823322e-02 1 1  ON 22
 eO_3                 1.951420e-01 1 1  ON 23
 eO_4                 2.772269e-01 1 1  ON 24
 eO_5                 3.042420e-01 1 1  ON 25
 eO_6                 2.489275e-01 1 1  ON 26
 eO_7                 1.104805e-01 1 1  ON 27
 eO_8                 2.772368e-02 1 1  ON 28
 eO_9                 1.832712e-02 1 1  ON 29
eH1_0                -1.792578e-01 1 1  ON 30
eH1_1                -1.010435e-01 1 1  ON 31
eH1_2                -6.216427e-02 1 1  ON 32
eH1_3                -2.653658e-02 1 1  ON 33
eH1_4                 1.925677e-02 1 1  ON 34
eH1_5                 3.327845e-02 1 1  ON 35
eH1_6                 7.689926e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980128e-02 1 1  ON 38
eH1_9                 2.403534e-02 1 1  ON 39
eH2_0                -1.814280e-01 1 1  ON 40
eH2_1                -1.026918e-01 1 1  ON 41
eH2_2                -6.368418e-02 1 1  ON 42
eH2_3                -2.776410e-02 1 1  ON 43
eH2_4                 1.810870e-02 1 1  ON 44
eH2_5                 3.402482e-02 1 1  ON 45
eH2_6                 7.850049e-02 1 1  ON 46
eH2_7                 1.138564e-01 1 1  ON 47
eH2_8                 9.285864e-02 1 1  ON 48
eH2_9                 2.615478e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6443e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2521
    reference variance = 0.21912
====================================================
  Execution time = 3.2049e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2006e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320160494381
                                         uncertainty =       0.003995621403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320160494381
                                         uncertainty =       0.003995621403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400036644
  error estimate for blocks of size 2^( 2) =       0.000410151507
  error estimate for blocks of size 2^( 3) =       0.000419078597
  error estimate for blocks of size 2^( 4) =       0.000426041851
  error estimate for blocks of size 2^( 5) =       0.000429359558
  error estimate for blocks of size 2^( 6) =       0.000430177185
  error estimate for blocks of size 2^( 7) =       0.000429800857

      target function =                  N/A
              le_mean =     -17.216723839859
             les_mean =     296.735638251298
             stat err =       0.000428844863
             autocorr =       1.149213908346
              std dev =       0.565737247646
             le_variance =       0.320058633374


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672383986e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216723839859       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216723840293       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216723841583       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216723841537       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216723841530       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216723841657       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216723841626       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216723841617       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 5.784041e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216723839859       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216723839967       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216723840290       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216723840281       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216723840276       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216723840307       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216723840300       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216723840293       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 1.446045e-07

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216723839859       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216723839886       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216723839966       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216723839963       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216723839928       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216723839979       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216723840003       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216723839975       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 3.615135e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295337 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0681e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.028854e-01 1 1  ON 0
 uu_1                 4.341180e-02 1 1  ON 1
 uu_2                -4.815393e-02 1 1  ON 2
 uu_3                -9.957659e-02 1 1  ON 3
 uu_4                -1.295065e-01 1 1  ON 4
 uu_5                -1.341427e-01 1 1  ON 5
 uu_6                -1.112602e-01 1 1  ON 6
 uu_7                -3.671352e-02 1 1  ON 7
 uu_8                 1.013745e-01 1 1  ON 8
 uu_9                 1.199990e-01 1 1  ON 9
 ud_0                 3.409131e-01 1 1  ON 10
 ud_1                 8.678941e-02 1 1  ON 11
 ud_2                -1.577147e-02 1 1  ON 12
 ud_3                -7.113928e-02 1 1  ON 13
 ud_4                -1.166514e-01 1 1  ON 14
 ud_5                -1.495869e-01 1 1  ON 15
 ud_6                -1.552922e-01 1 1  ON 16
 ud_7                -1.100748e-01 1 1  ON 17
 ud_8                 6.791301e-03 1 1  ON 18
 ud_9                 9.255038e-02 1 1  ON 19
 eO_0                -7.304528e-01 1 1  ON 20
 eO_1                -4.238752e-01 1 1  ON 21
 eO_2                -3.823321e-02 1 1  ON 22
 eO_3                 1.951421e-01 1 1  ON 23
 eO_4                 2.772270e-01 1 1  ON 24
 eO_5                 3.042421e-01 1 1  ON 25
 eO_6                 2.489275e-01 1 1  ON 26
 eO_7                 1.104805e-01 1 1  ON 27
 eO_8                 2.772368e-02 1 1  ON 28
 eO_9                 1.832712e-02 1 1  ON 29
eH1_0                -1.792578e-01 1 1  ON 30
eH1_1                -1.010436e-01 1 1  ON 31
eH1_2                -6.216426e-02 1 1  ON 32
eH1_3                -2.653658e-02 1 1  ON 33
eH1_4                 1.925677e-02 1 1  ON 34
eH1_5                 3.327845e-02 1 1  ON 35
eH1_6                 7.689927e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980128e-02 1 1  ON 38
eH1_9                 2.403534e-02 1 1  ON 39
eH2_0                -1.814280e-01 1 1  ON 40
eH2_1                -1.026918e-01 1 1  ON 41
eH2_2                -6.368417e-02 1 1  ON 42
eH2_3                -2.776410e-02 1 1  ON 43
eH2_4                 1.810870e-02 1 1  ON 44
eH2_5                 3.402483e-02 1 1  ON 45
eH2_6                 7.850049e-02 1 1  ON 46
eH2_7                 1.138564e-01 1 1  ON 47
eH2_8                 9.285865e-02 1 1  ON 48
eH2_9                 2.615478e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2644
    reference variance = 0.228467
====================================================
  Execution time = 3.0989e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1966e-01
  Total weights = 2.0000e+06
  Execution time = 2.8660e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720263192
                                         uncertainty =       0.004090039212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720263192
                                         uncertainty =       0.004090039212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399790212
  error estimate for blocks of size 2^( 2) =       0.000409226473
  error estimate for blocks of size 2^( 3) =       0.000417982216
  error estimate for blocks of size 2^( 4) =       0.000423420405
  error estimate for blocks of size 2^( 5) =       0.000427651599
  error estimate for blocks of size 2^( 6) =       0.000430000318
  error estimate for blocks of size 2^( 7) =       0.000432026288

      target function =                  N/A
              le_mean =     -17.216926992441
             les_mean =     296.742239331220
             stat err =       0.000428274652
             autocorr =       1.147573278797
              std dev =       0.565388740599
             le_variance =       0.319664427996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720387130
                                         uncertainty =       0.004090040889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720387130
                                         uncertainty =       0.004090040889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399790290
  error estimate for blocks of size 2^( 2) =       0.000409226545
  error estimate for blocks of size 2^( 3) =       0.000417982282
  error estimate for blocks of size 2^( 4) =       0.000423420465
  error estimate for blocks of size 2^( 5) =       0.000427651656
  error estimate for blocks of size 2^( 6) =       0.000430000374
  error estimate for blocks of size 2^( 7) =       0.000432026342

      target function =                  N/A
              le_mean =     -17.216926992258
             les_mean =     296.742239448790
             stat err =       0.000428274709
             autocorr =       1.147573138613
              std dev =       0.565388850146
             le_variance =       0.319664551869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720325163
                                         uncertainty =       0.004090040051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720325163
                                         uncertainty =       0.004090040051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399790251
  error estimate for blocks of size 2^( 2) =       0.000409226509
  error estimate for blocks of size 2^( 3) =       0.000417982249
  error estimate for blocks of size 2^( 4) =       0.000423420435
  error estimate for blocks of size 2^( 5) =       0.000427651628
  error estimate for blocks of size 2^( 6) =       0.000430000346
  error estimate for blocks of size 2^( 7) =       0.000432026315

      target function =                  N/A
              le_mean =     -17.216926992350
             les_mean =     296.742239390007
             stat err =       0.000428274681
             autocorr =       1.147573208706
              std dev =       0.565388795374
             le_variance =       0.319664489935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720270939
                                         uncertainty =       0.004090039317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319720270939
                                         uncertainty =       0.004090039317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399790217
  error estimate for blocks of size 2^( 2) =       0.000409226478
  error estimate for blocks of size 2^( 3) =       0.000417982221
  error estimate for blocks of size 2^( 4) =       0.000423420409
  error estimate for blocks of size 2^( 5) =       0.000427651603
  error estimate for blocks of size 2^( 6) =       0.000430000321
  error estimate for blocks of size 2^( 7) =       0.000432026291

      target function =                  N/A
              le_mean =     -17.216926992430
             les_mean =     296.742239338568
             stat err =       0.000428274656
             autocorr =       1.147573270034
              std dev =       0.565388747446
             le_variance =       0.319664435739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216926992441        initial  <--
     2.3283e+03     2.3283e+04             5.7840e-07       -17.216926992258
     9.3132e+03     9.3132e+04             1.4460e-07       -17.216926992350
     3.7253e+04     3.7253e+05             3.6151e-08       -17.216926992430

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4663
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.028854e-01 1 1  ON 0
 uu_1                 4.341178e-02 1 1  ON 1
 uu_2                -4.815394e-02 1 1  ON 2
 uu_3                -9.957657e-02 1 1  ON 3
 uu_4                -1.295065e-01 1 1  ON 4
 uu_5                -1.341427e-01 1 1  ON 5
 uu_6                -1.112601e-01 1 1  ON 6
 uu_7                -3.671350e-02 1 1  ON 7
 uu_8                 1.013745e-01 1 1  ON 8
 uu_9                 1.199990e-01 1 1  ON 9
 ud_0                 3.409131e-01 1 1  ON 10
 ud_1                 8.678939e-02 1 1  ON 11
 ud_2                -1.577148e-02 1 1  ON 12
 ud_3                -7.113926e-02 1 1  ON 13
 ud_4                -1.166514e-01 1 1  ON 14
 ud_5                -1.495869e-01 1 1  ON 15
 ud_6                -1.552922e-01 1 1  ON 16
 ud_7                -1.100748e-01 1 1  ON 17
 ud_8                 6.791317e-03 1 1  ON 18
 ud_9                 9.255038e-02 1 1  ON 19
 eO_0                -7.304527e-01 1 1  ON 20
 eO_1                -4.238751e-01 1 1  ON 21
 eO_2                -3.823322e-02 1 1  ON 22
 eO_3                 1.951420e-01 1 1  ON 23
 eO_4                 2.772269e-01 1 1  ON 24
 eO_5                 3.042420e-01 1 1  ON 25
 eO_6                 2.489275e-01 1 1  ON 26
 eO_7                 1.104805e-01 1 1  ON 27
 eO_8                 2.772368e-02 1 1  ON 28
 eO_9                 1.832712e-02 1 1  ON 29
eH1_0                -1.792578e-01 1 1  ON 30
eH1_1                -1.010435e-01 1 1  ON 31
eH1_2                -6.216427e-02 1 1  ON 32
eH1_3                -2.653658e-02 1 1  ON 33
eH1_4                 1.925677e-02 1 1  ON 34
eH1_5                 3.327845e-02 1 1  ON 35
eH1_6                 7.689926e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980128e-02 1 1  ON 38
eH1_9                 2.403534e-02 1 1  ON 39
eH2_0                -1.814280e-01 1 1  ON 40
eH2_1                -1.026918e-01 1 1  ON 41
eH2_2                -6.368418e-02 1 1  ON 42
eH2_3                -2.776410e-02 1 1  ON 43
eH2_4                 1.810870e-02 1 1  ON 44
eH2_5                 3.402482e-02 1 1  ON 45
eH2_6                 7.850049e-02 1 1  ON 46
eH2_7                 1.138564e-01 1 1  ON 47
eH2_8                 9.285864e-02 1 1  ON 48
eH2_9                 2.615478e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6160e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2177
    reference variance = 0.293198
====================================================
  Execution time = 3.1759e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1418e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314161354481
                                         uncertainty =       0.003241355085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314161354481
                                         uncertainty =       0.003241355085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396345608
  error estimate for blocks of size 2^( 2) =       0.000405995975
  error estimate for blocks of size 2^( 3) =       0.000415023412
  error estimate for blocks of size 2^( 4) =       0.000420970714
  error estimate for blocks of size 2^( 5) =       0.000424826198
  error estimate for blocks of size 2^( 6) =       0.000425907970
  error estimate for blocks of size 2^( 7) =       0.000426358844

      target function =                  N/A
              le_mean =     -17.216265050067
             les_mean =     296.713961799628
             stat err =       0.000424515932
             autocorr =       1.147201974579
              std dev =       0.560517334754
             le_variance =       0.314179682560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721626505007e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216265050067       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216265050058       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216265050212       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216265050243       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216265050211       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216265050248       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216265050265       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216265050258       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 5.332778e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216265050067       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216265050065       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216265050103       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216265050114       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216265050115       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216265050069       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216265050189       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216265050027       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 1.333196e-08

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216265050067       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216265050066       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216265050076       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216265050083       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216265050106       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216265050066       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216265050187       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216265050181       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 3.332991e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.302143 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0505e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.028854e-01 1 1  ON 0
 uu_1                 4.341178e-02 1 1  ON 1
 uu_2                -4.815394e-02 1 1  ON 2
 uu_3                -9.957658e-02 1 1  ON 3
 uu_4                -1.295065e-01 1 1  ON 4
 uu_5                -1.341427e-01 1 1  ON 5
 uu_6                -1.112601e-01 1 1  ON 6
 uu_7                -3.671350e-02 1 1  ON 7
 uu_8                 1.013745e-01 1 1  ON 8
 uu_9                 1.199990e-01 1 1  ON 9
 ud_0                 3.409131e-01 1 1  ON 10
 ud_1                 8.678939e-02 1 1  ON 11
 ud_2                -1.577148e-02 1 1  ON 12
 ud_3                -7.113926e-02 1 1  ON 13
 ud_4                -1.166514e-01 1 1  ON 14
 ud_5                -1.495869e-01 1 1  ON 15
 ud_6                -1.552922e-01 1 1  ON 16
 ud_7                -1.100748e-01 1 1  ON 17
 ud_8                 6.791315e-03 1 1  ON 18
 ud_9                 9.255038e-02 1 1  ON 19
 eO_0                -7.304527e-01 1 1  ON 20
 eO_1                -4.238751e-01 1 1  ON 21
 eO_2                -3.823322e-02 1 1  ON 22
 eO_3                 1.951420e-01 1 1  ON 23
 eO_4                 2.772269e-01 1 1  ON 24
 eO_5                 3.042420e-01 1 1  ON 25
 eO_6                 2.489275e-01 1 1  ON 26
 eO_7                 1.104805e-01 1 1  ON 27
 eO_8                 2.772368e-02 1 1  ON 28
 eO_9                 1.832712e-02 1 1  ON 29
eH1_0                -1.792578e-01 1 1  ON 30
eH1_1                -1.010435e-01 1 1  ON 31
eH1_2                -6.216427e-02 1 1  ON 32
eH1_3                -2.653658e-02 1 1  ON 33
eH1_4                 1.925677e-02 1 1  ON 34
eH1_5                 3.327845e-02 1 1  ON 35
eH1_6                 7.689926e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980128e-02 1 1  ON 38
eH1_9                 2.403534e-02 1 1  ON 39
eH2_0                -1.814280e-01 1 1  ON 40
eH2_1                -1.026918e-01 1 1  ON 41
eH2_2                -6.368418e-02 1 1  ON 42
eH2_3                -2.776409e-02 1 1  ON 43
eH2_4                 1.810870e-02 1 1  ON 44
eH2_5                 3.402482e-02 1 1  ON 45
eH2_6                 7.850049e-02 1 1  ON 46
eH2_7                 1.138564e-01 1 1  ON 47
eH2_8                 9.285864e-02 1 1  ON 48
eH2_9                 2.615478e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2227
    reference variance = 0.298494
====================================================
  Execution time = 3.1139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1761e-01
  Total weights = 2.0000e+06
  Execution time = 2.8743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317614927940
                                         uncertainty =       0.003909803773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317614927940
                                         uncertainty =       0.003909803773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398504644
  error estimate for blocks of size 2^( 2) =       0.000408380176
  error estimate for blocks of size 2^( 3) =       0.000416933641
  error estimate for blocks of size 2^( 4) =       0.000422523424
  error estimate for blocks of size 2^( 5) =       0.000426702613
  error estimate for blocks of size 2^( 6) =       0.000428027048
  error estimate for blocks of size 2^( 7) =       0.000429012249

      target function =                  N/A
              le_mean =     -17.217107841898
             les_mean =     296.746414183440
             stat err =       0.000426566333
             autocorr =       1.145793561203
              std dev =       0.563570672319
             le_variance =       0.317611902698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317614945315
                                         uncertainty =       0.003909804023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317614945315
                                         uncertainty =       0.003909804023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398504655
  error estimate for blocks of size 2^( 2) =       0.000408380186
  error estimate for blocks of size 2^( 3) =       0.000416933651
  error estimate for blocks of size 2^( 4) =       0.000422523433
  error estimate for blocks of size 2^( 5) =       0.000426702621
  error estimate for blocks of size 2^( 6) =       0.000428027056
  error estimate for blocks of size 2^( 7) =       0.000429012257

      target function =                  N/A
              le_mean =     -17.217107841986
             les_mean =     296.746414203829
             stat err =       0.000426566342
             autocorr =       1.145793544825
              std dev =       0.563570687733
             le_variance =       0.317611920072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317614936627
                                         uncertainty =       0.003909803898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317614936627
                                         uncertainty =       0.003909803898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398504650
  error estimate for blocks of size 2^( 2) =       0.000408380181
  error estimate for blocks of size 2^( 3) =       0.000416933646
  error estimate for blocks of size 2^( 4) =       0.000422523428
  error estimate for blocks of size 2^( 5) =       0.000426702617
  error estimate for blocks of size 2^( 6) =       0.000428027052
  error estimate for blocks of size 2^( 7) =       0.000429012253

      target function =                  N/A
              le_mean =     -17.217107841942
             les_mean =     296.746414193635
             stat err =       0.000426566337
             autocorr =       1.145793553011
              std dev =       0.563570680026
             le_variance =       0.317611911385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317614929026
                                         uncertainty =       0.003909803789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317614929026
                                         uncertainty =       0.003909803789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398504645
  error estimate for blocks of size 2^( 2) =       0.000408380177
  error estimate for blocks of size 2^( 3) =       0.000416933642
  error estimate for blocks of size 2^( 4) =       0.000422523424
  error estimate for blocks of size 2^( 5) =       0.000426702613
  error estimate for blocks of size 2^( 6) =       0.000428027048
  error estimate for blocks of size 2^( 7) =       0.000429012249

      target function =                  N/A
              le_mean =     -17.217107841904
             les_mean =     296.746414184715
             stat err =       0.000426566334
             autocorr =       1.145793560176
              std dev =       0.563570673282
             le_variance =       0.317611903784


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217107841898        initial
     2.3283e+04     2.3283e+05             5.3328e-08       -17.217107841986  <--
     9.3132e+04     9.3132e+05             1.3332e-08       -17.217107841942
     3.7253e+05     3.7253e+06             3.3330e-09       -17.217107841904

*****************************************************************************
Applying the update for shift_i =   2.3283e+04     and shift_s =   2.3283e+05
*****************************************************************************

  Execution time = 4.5620e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.028854e-01 1 1  ON 0
 uu_1                 4.341179e-02 1 1  ON 1
 uu_2                -4.815394e-02 1 1  ON 2
 uu_3                -9.957658e-02 1 1  ON 3
 uu_4                -1.295065e-01 1 1  ON 4
 uu_5                -1.341427e-01 1 1  ON 5
 uu_6                -1.112601e-01 1 1  ON 6
 uu_7                -3.671350e-02 1 1  ON 7
 uu_8                 1.013745e-01 1 1  ON 8
 uu_9                 1.199990e-01 1 1  ON 9
 ud_0                 3.409131e-01 1 1  ON 10
 ud_1                 8.678940e-02 1 1  ON 11
 ud_2                -1.577148e-02 1 1  ON 12
 ud_3                -7.113927e-02 1 1  ON 13
 ud_4                -1.166514e-01 1 1  ON 14
 ud_5                -1.495869e-01 1 1  ON 15
 ud_6                -1.552922e-01 1 1  ON 16
 ud_7                -1.100748e-01 1 1  ON 17
 ud_8                 6.791310e-03 1 1  ON 18
 ud_9                 9.255038e-02 1 1  ON 19
 eO_0                -7.304527e-01 1 1  ON 20
 eO_1                -4.238751e-01 1 1  ON 21
 eO_2                -3.823321e-02 1 1  ON 22
 eO_3                 1.951420e-01 1 1  ON 23
 eO_4                 2.772270e-01 1 1  ON 24
 eO_5                 3.042420e-01 1 1  ON 25
 eO_6                 2.489275e-01 1 1  ON 26
 eO_7                 1.104805e-01 1 1  ON 27
 eO_8                 2.772368e-02 1 1  ON 28
 eO_9                 1.832712e-02 1 1  ON 29
eH1_0                -1.792578e-01 1 1  ON 30
eH1_1                -1.010435e-01 1 1  ON 31
eH1_2                -6.216427e-02 1 1  ON 32
eH1_3                -2.653657e-02 1 1  ON 33
eH1_4                 1.925677e-02 1 1  ON 34
eH1_5                 3.327846e-02 1 1  ON 35
eH1_6                 7.689926e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980128e-02 1 1  ON 38
eH1_9                 2.403534e-02 1 1  ON 39
eH2_0                -1.814280e-01 1 1  ON 40
eH2_1                -1.026918e-01 1 1  ON 41
eH2_2                -6.368417e-02 1 1  ON 42
eH2_3                -2.776409e-02 1 1  ON 43
eH2_4                 1.810870e-02 1 1  ON 44
eH2_5                 3.402483e-02 1 1  ON 45
eH2_6                 7.850049e-02 1 1  ON 46
eH2_7                 1.138564e-01 1 1  ON 47
eH2_8                 9.285864e-02 1 1  ON 48
eH2_9                 2.615478e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6139e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1061
    reference variance = 0.292098
====================================================
  Execution time = 3.3152e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2731e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.3450e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327316462891
                                         uncertainty =       0.012482194004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327316462891
                                         uncertainty =       0.012482194004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404541399
  error estimate for blocks of size 2^( 2) =       0.000414287310
  error estimate for blocks of size 2^( 3) =       0.000423168415
  error estimate for blocks of size 2^( 4) =       0.000429357528
  error estimate for blocks of size 2^( 5) =       0.000432310208
  error estimate for blocks of size 2^( 6) =       0.000434490499
  error estimate for blocks of size 2^( 7) =       0.000435609465

      target function =                  N/A
              le_mean =     -17.215950219882
             les_mean =     296.716249296904
             stat err =       0.000432941925
             autocorr =       1.145337139722
              std dev =       0.572107933100
             le_variance =       0.327307487116


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721595021988e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215950219882       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215950220109       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215950220420       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215950220901       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215950220951       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215950220960       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215950220966       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215950220950       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 2.163822e-07

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215950219882       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215950219939       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215950220016       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215950220136       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215950220146       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215950220152       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215950220131       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215950220147       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 5.409600e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215950219882       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215950219896       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215950219915       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215950219920       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215950219949       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215950219933       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215950219933       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215950220034       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 1.352403e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304709 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1504e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.028854e-01 1 1  ON 0
 uu_1                 4.341180e-02 1 1  ON 1
 uu_2                -4.815393e-02 1 1  ON 2
 uu_3                -9.957658e-02 1 1  ON 3
 uu_4                -1.295065e-01 1 1  ON 4
 uu_5                -1.341427e-01 1 1  ON 5
 uu_6                -1.112601e-01 1 1  ON 6
 uu_7                -3.671351e-02 1 1  ON 7
 uu_8                 1.013745e-01 1 1  ON 8
 uu_9                 1.199990e-01 1 1  ON 9
 ud_0                 3.409131e-01 1 1  ON 10
 ud_1                 8.678940e-02 1 1  ON 11
 ud_2                -1.577147e-02 1 1  ON 12
 ud_3                -7.113928e-02 1 1  ON 13
 ud_4                -1.166514e-01 1 1  ON 14
 ud_5                -1.495869e-01 1 1  ON 15
 ud_6                -1.552922e-01 1 1  ON 16
 ud_7                -1.100748e-01 1 1  ON 17
 ud_8                 6.791304e-03 1 1  ON 18
 ud_9                 9.255038e-02 1 1  ON 19
 eO_0                -7.304528e-01 1 1  ON 20
 eO_1                -4.238752e-01 1 1  ON 21
 eO_2                -3.823321e-02 1 1  ON 22
 eO_3                 1.951421e-01 1 1  ON 23
 eO_4                 2.772270e-01 1 1  ON 24
 eO_5                 3.042420e-01 1 1  ON 25
 eO_6                 2.489275e-01 1 1  ON 26
 eO_7                 1.104805e-01 1 1  ON 27
 eO_8                 2.772368e-02 1 1  ON 28
 eO_9                 1.832712e-02 1 1  ON 29
eH1_0                -1.792578e-01 1 1  ON 30
eH1_1                -1.010436e-01 1 1  ON 31
eH1_2                -6.216427e-02 1 1  ON 32
eH1_3                -2.653657e-02 1 1  ON 33
eH1_4                 1.925677e-02 1 1  ON 34
eH1_5                 3.327846e-02 1 1  ON 35
eH1_6                 7.689926e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980128e-02 1 1  ON 38
eH1_9                 2.403534e-02 1 1  ON 39
eH2_0                -1.814280e-01 1 1  ON 40
eH2_1                -1.026918e-01 1 1  ON 41
eH2_2                -6.368417e-02 1 1  ON 42
eH2_3                -2.776409e-02 1 1  ON 43
eH2_4                 1.810869e-02 1 1  ON 44
eH2_5                 3.402482e-02 1 1  ON 45
eH2_6                 7.850048e-02 1 1  ON 46
eH2_7                 1.138564e-01 1 1  ON 47
eH2_8                 9.285865e-02 1 1  ON 48
eH2_9                 2.615478e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2051
    reference variance = 0.191333
====================================================
  Execution time = 3.0830e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1570e-01
  Total weights = 2.0000e+06
  Execution time = 2.8738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315682930871
                                         uncertainty =       0.003257396051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315682930871
                                         uncertainty =       0.003257396051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397300947
  error estimate for blocks of size 2^( 2) =       0.000407258892
  error estimate for blocks of size 2^( 3) =       0.000416251977
  error estimate for blocks of size 2^( 4) =       0.000422998245
  error estimate for blocks of size 2^( 5) =       0.000426396933
  error estimate for blocks of size 2^( 6) =       0.000427514254
  error estimate for blocks of size 2^( 7) =       0.000429579881

      target function =                  N/A
              le_mean =     -17.216245476731
             les_mean =     296.714804241903
             stat err =       0.000426622328
             autocorr =       1.153049528289
              std dev =       0.561868387332
             le_variance =       0.315696084683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315682997254
                                         uncertainty =       0.003257396517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315682997254
                                         uncertainty =       0.003257396517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397300989
  error estimate for blocks of size 2^( 2) =       0.000407258932
  error estimate for blocks of size 2^( 3) =       0.000416252013
  error estimate for blocks of size 2^( 4) =       0.000422998279
  error estimate for blocks of size 2^( 5) =       0.000426396965
  error estimate for blocks of size 2^( 6) =       0.000427514286
  error estimate for blocks of size 2^( 7) =       0.000429579912

      target function =                  N/A
              le_mean =     -17.216245477060
             les_mean =     296.714804319635
             stat err =       0.000426622360
             autocorr =       1.153049461001
              std dev =       0.561868446431
             le_variance =       0.315696151095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315682964064
                                         uncertainty =       0.003257396284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315682964064
                                         uncertainty =       0.003257396284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397300968
  error estimate for blocks of size 2^( 2) =       0.000407258912
  error estimate for blocks of size 2^( 3) =       0.000416251995
  error estimate for blocks of size 2^( 4) =       0.000422998262
  error estimate for blocks of size 2^( 5) =       0.000426396949
  error estimate for blocks of size 2^( 6) =       0.000427514270
  error estimate for blocks of size 2^( 7) =       0.000429579897

      target function =                  N/A
              le_mean =     -17.216245476896
             les_mean =     296.714804280770
             stat err =       0.000426622344
             autocorr =       1.153049494642
              std dev =       0.561868416882
             le_variance =       0.315696117890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315682935020
                                         uncertainty =       0.003257396080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315682935020
                                         uncertainty =       0.003257396080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397300949
  error estimate for blocks of size 2^( 2) =       0.000407258895
  error estimate for blocks of size 2^( 3) =       0.000416251979
  error estimate for blocks of size 2^( 4) =       0.000422998247
  error estimate for blocks of size 2^( 5) =       0.000426396935
  error estimate for blocks of size 2^( 6) =       0.000427514256
  error estimate for blocks of size 2^( 7) =       0.000429579883

      target function =                  N/A
              le_mean =     -17.216245476752
             les_mean =     296.714804246762
             stat err =       0.000426622330
             autocorr =       1.153049524080
              std dev =       0.561868391026
             le_variance =       0.315696088834


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216245476731        initial
     5.8208e+03     5.8208e+04             2.1638e-07       -17.216245477060  <--
     2.3283e+04     2.3283e+05             5.4096e-08       -17.216245476896
     9.3132e+04     9.3132e+05             1.3524e-08       -17.216245476752

*****************************************************************************
Applying the update for shift_i =   5.8208e+03     and shift_s =   5.8208e+04
*****************************************************************************

  Execution time = 4.5300e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.028855e-01 1 1  ON 0
 uu_1                 4.341183e-02 1 1  ON 1
 uu_2                -4.815393e-02 1 1  ON 2
 uu_3                -9.957659e-02 1 1  ON 3
 uu_4                -1.295065e-01 1 1  ON 4
 uu_5                -1.341427e-01 1 1  ON 5
 uu_6                -1.112602e-01 1 1  ON 6
 uu_7                -3.671353e-02 1 1  ON 7
 uu_8                 1.013745e-01 1 1  ON 8
 uu_9                 1.199990e-01 1 1  ON 9
 ud_0                 3.409132e-01 1 1  ON 10
 ud_1                 8.678942e-02 1 1  ON 11
 ud_2                -1.577147e-02 1 1  ON 12
 ud_3                -7.113931e-02 1 1  ON 13
 ud_4                -1.166514e-01 1 1  ON 14
 ud_5                -1.495869e-01 1 1  ON 15
 ud_6                -1.552921e-01 1 1  ON 16
 ud_7                -1.100748e-01 1 1  ON 17
 ud_8                 6.791289e-03 1 1  ON 18
 ud_9                 9.255038e-02 1 1  ON 19
 eO_0                -7.304530e-01 1 1  ON 20
 eO_1                -4.238753e-01 1 1  ON 21
 eO_2                -3.823319e-02 1 1  ON 22
 eO_3                 1.951422e-01 1 1  ON 23
 eO_4                 2.772271e-01 1 1  ON 24
 eO_5                 3.042420e-01 1 1  ON 25
 eO_6                 2.489276e-01 1 1  ON 26
 eO_7                 1.104806e-01 1 1  ON 27
 eO_8                 2.772368e-02 1 1  ON 28
 eO_9                 1.832713e-02 1 1  ON 29
eH1_0                -1.792578e-01 1 1  ON 30
eH1_1                -1.010436e-01 1 1  ON 31
eH1_2                -6.216427e-02 1 1  ON 32
eH1_3                -2.653657e-02 1 1  ON 33
eH1_4                 1.925678e-02 1 1  ON 34
eH1_5                 3.327847e-02 1 1  ON 35
eH1_6                 7.689926e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980129e-02 1 1  ON 38
eH1_9                 2.403535e-02 1 1  ON 39
eH2_0                -1.814280e-01 1 1  ON 40
eH2_1                -1.026919e-01 1 1  ON 41
eH2_2                -6.368416e-02 1 1  ON 42
eH2_3                -2.776408e-02 1 1  ON 43
eH2_4                 1.810868e-02 1 1  ON 44
eH2_5                 3.402482e-02 1 1  ON 45
eH2_6                 7.850048e-02 1 1  ON 46
eH2_7                 1.138564e-01 1 1  ON 47
eH2_8                 9.285866e-02 1 1  ON 48
eH2_9                 2.615479e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6810e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1848
    reference variance = 0.254728
====================================================
  Execution time = 3.1402e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1638e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.4068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316358190824
                                         uncertainty =       0.004331174192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316358190824
                                         uncertainty =       0.004331174192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397731784
  error estimate for blocks of size 2^( 2) =       0.000407728321
  error estimate for blocks of size 2^( 3) =       0.000416336246
  error estimate for blocks of size 2^( 4) =       0.000423278320
  error estimate for blocks of size 2^( 5) =       0.000427917196
  error estimate for blocks of size 2^( 6) =       0.000429812479
  error estimate for blocks of size 2^( 7) =       0.000430121036

      target function =                  N/A
              le_mean =     -17.216032312280
             les_mean =     296.708149563978
             stat err =       0.000427782258
             autocorr =       1.156817737973
              std dev =       0.562477683736
             le_variance =       0.316381144701


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721603231228e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216032312280       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216032312873       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216032314927       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216032315177       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216032315175       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216032315628       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216032315703       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216032315645       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 8.715303e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216032312280       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216032312428       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216032312942       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216032313004       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216032313006       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216032313117       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216032313138       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216032313120       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 2.178885e-07

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216032312280       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216032312317       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216032312445       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216032312459       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216032312463       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216032312482       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216032312451       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216032312479       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 5.447251e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.307256 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9816e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.028855e-01 1 1  ON 0
 uu_1                 4.341186e-02 1 1  ON 1
 uu_2                -4.815393e-02 1 1  ON 2
 uu_3                -9.957662e-02 1 1  ON 3
 uu_4                -1.295065e-01 1 1  ON 4
 uu_5                -1.341427e-01 1 1  ON 5
 uu_6                -1.112602e-01 1 1  ON 6
 uu_7                -3.671355e-02 1 1  ON 7
 uu_8                 1.013744e-01 1 1  ON 8
 uu_9                 1.199990e-01 1 1  ON 9
 ud_0                 3.409132e-01 1 1  ON 10
 ud_1                 8.678946e-02 1 1  ON 11
 ud_2                -1.577147e-02 1 1  ON 12
 ud_3                -7.113933e-02 1 1  ON 13
 ud_4                -1.166515e-01 1 1  ON 14
 ud_5                -1.495869e-01 1 1  ON 15
 ud_6                -1.552921e-01 1 1  ON 16
 ud_7                -1.100748e-01 1 1  ON 17
 ud_8                 6.791257e-03 1 1  ON 18
 ud_9                 9.255038e-02 1 1  ON 19
 eO_0                -7.304532e-01 1 1  ON 20
 eO_1                -4.238754e-01 1 1  ON 21
 eO_2                -3.823317e-02 1 1  ON 22
 eO_3                 1.951423e-01 1 1  ON 23
 eO_4                 2.772272e-01 1 1  ON 24
 eO_5                 3.042421e-01 1 1  ON 25
 eO_6                 2.489276e-01 1 1  ON 26
 eO_7                 1.104806e-01 1 1  ON 27
 eO_8                 2.772368e-02 1 1  ON 28
 eO_9                 1.832713e-02 1 1  ON 29
eH1_0                -1.792579e-01 1 1  ON 30
eH1_1                -1.010436e-01 1 1  ON 31
eH1_2                -6.216427e-02 1 1  ON 32
eH1_3                -2.653657e-02 1 1  ON 33
eH1_4                 1.925680e-02 1 1  ON 34
eH1_5                 3.327849e-02 1 1  ON 35
eH1_6                 7.689927e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980130e-02 1 1  ON 38
eH1_9                 2.403535e-02 1 1  ON 39
eH2_0                -1.814280e-01 1 1  ON 40
eH2_1                -1.026919e-01 1 1  ON 41
eH2_2                -6.368414e-02 1 1  ON 42
eH2_3                -2.776409e-02 1 1  ON 43
eH2_4                 1.810869e-02 1 1  ON 44
eH2_5                 3.402484e-02 1 1  ON 45
eH2_6                 7.850047e-02 1 1  ON 46
eH2_7                 1.138564e-01 1 1  ON 47
eH2_8                 9.285867e-02 1 1  ON 48
eH2_9                 2.615479e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2624
    reference variance = 0.318666
====================================================
  Execution time = 3.0916e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3157e-01
  Total weights = 2.0000e+06
  Execution time = 2.8632e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331605138283
                                         uncertainty =       0.010402768811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331605138283
                                         uncertainty =       0.010402768811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407164712
  error estimate for blocks of size 2^( 2) =       0.000416843242
  error estimate for blocks of size 2^( 3) =       0.000425740011
  error estimate for blocks of size 2^( 4) =       0.000432414306
  error estimate for blocks of size 2^( 5) =       0.000436594875
  error estimate for blocks of size 2^( 6) =       0.000438941737
  error estimate for blocks of size 2^( 7) =       0.000439448510

      target function =                  N/A
              le_mean =     -17.216235281434
             les_mean =     296.730323304853
             stat err =       0.000436849857
             autocorr =       1.151129365691
              std dev =       0.575817857441
             le_variance =       0.331566204948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331605330905
                                         uncertainty =       0.010402771938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331605330905
                                         uncertainty =       0.010402771938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407164830
  error estimate for blocks of size 2^( 2) =       0.000416843352
  error estimate for blocks of size 2^( 3) =       0.000425740110
  error estimate for blocks of size 2^( 4) =       0.000432414398
  error estimate for blocks of size 2^( 5) =       0.000436594967
  error estimate for blocks of size 2^( 6) =       0.000438941830
  error estimate for blocks of size 2^( 7) =       0.000439448602

      target function =                  N/A
              le_mean =     -17.216235282791
             les_mean =     296.730323544188
             stat err =       0.000436849949
             autocorr =       1.151129181850
              std dev =       0.575818024691
             le_variance =       0.331566397560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331605234596
                                         uncertainty =       0.010402770374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331605234596
                                         uncertainty =       0.010402770374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407164771
  error estimate for blocks of size 2^( 2) =       0.000416843297
  error estimate for blocks of size 2^( 3) =       0.000425740061
  error estimate for blocks of size 2^( 4) =       0.000432414352
  error estimate for blocks of size 2^( 5) =       0.000436594921
  error estimate for blocks of size 2^( 6) =       0.000438941783
  error estimate for blocks of size 2^( 7) =       0.000439448556

      target function =                  N/A
              le_mean =     -17.216235282112
             les_mean =     296.730323424523
             stat err =       0.000436849903
             autocorr =       1.151129273766
              std dev =       0.575817941068
             le_variance =       0.331566301256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331605150322
                                         uncertainty =       0.010402769006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331605150322
                                         uncertainty =       0.010402769006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407164719
  error estimate for blocks of size 2^( 2) =       0.000416843249
  error estimate for blocks of size 2^( 3) =       0.000425740017
  error estimate for blocks of size 2^( 4) =       0.000432414312
  error estimate for blocks of size 2^( 5) =       0.000436594881
  error estimate for blocks of size 2^( 6) =       0.000438941743
  error estimate for blocks of size 2^( 7) =       0.000439448516

      target function =                  N/A
              le_mean =     -17.216235281519
             les_mean =     296.730323319811
             stat err =       0.000436849863
             autocorr =       1.151129354209
              std dev =       0.575817867894
             le_variance =       0.331566216987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216235281434        initial
     1.4552e+03     1.4552e+04             8.7153e-07       -17.216235282791  <--
     5.8208e+03     5.8208e+04             2.1789e-07       -17.216235282112
     2.3283e+04     2.3283e+05             5.4473e-08       -17.216235281519

*****************************************************************************
Applying the update for shift_i =   1.4552e+03     and shift_s =   1.4552e+04
*****************************************************************************

  Execution time = 4.5328e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.028858e-01 1 1  ON 0
 uu_1                 4.341196e-02 1 1  ON 1
 uu_2                -4.815392e-02 1 1  ON 2
 uu_3                -9.957670e-02 1 1  ON 3
 uu_4                -1.295066e-01 1 1  ON 4
 uu_5                -1.341428e-01 1 1  ON 5
 uu_6                -1.112602e-01 1 1  ON 6
 uu_7                -3.671362e-02 1 1  ON 7
 uu_8                 1.013744e-01 1 1  ON 8
 uu_9                 1.199990e-01 1 1  ON 9
 ud_0                 3.409134e-01 1 1  ON 10
 ud_1                 8.678960e-02 1 1  ON 11
 ud_2                -1.577145e-02 1 1  ON 12
 ud_3                -7.113940e-02 1 1  ON 13
 ud_4                -1.166516e-01 1 1  ON 14
 ud_5                -1.495870e-01 1 1  ON 15
 ud_6                -1.552921e-01 1 1  ON 16
 ud_7                -1.100749e-01 1 1  ON 17
 ud_8                 6.791162e-03 1 1  ON 18
 ud_9                 9.255038e-02 1 1  ON 19
 eO_0                -7.304538e-01 1 1  ON 20
 eO_1                -4.238758e-01 1 1  ON 21
 eO_2                -3.823309e-02 1 1  ON 22
 eO_3                 1.951428e-01 1 1  ON 23
 eO_4                 2.772276e-01 1 1  ON 24
 eO_5                 3.042421e-01 1 1  ON 25
 eO_6                 2.489276e-01 1 1  ON 26
 eO_7                 1.104806e-01 1 1  ON 27
 eO_8                 2.772369e-02 1 1  ON 28
 eO_9                 1.832713e-02 1 1  ON 29
eH1_0                -1.792580e-01 1 1  ON 30
eH1_1                -1.010436e-01 1 1  ON 31
eH1_2                -6.216426e-02 1 1  ON 32
eH1_3                -2.653657e-02 1 1  ON 33
eH1_4                 1.925686e-02 1 1  ON 34
eH1_5                 3.327856e-02 1 1  ON 35
eH1_6                 7.689929e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980133e-02 1 1  ON 38
eH1_9                 2.403536e-02 1 1  ON 39
eH2_0                -1.814281e-01 1 1  ON 40
eH2_1                -1.026920e-01 1 1  ON 41
eH2_2                -6.368408e-02 1 1  ON 42
eH2_3                -2.776410e-02 1 1  ON 43
eH2_4                 1.810873e-02 1 1  ON 44
eH2_5                 3.402489e-02 1 1  ON 45
eH2_6                 7.850044e-02 1 1  ON 46
eH2_7                 1.138563e-01 1 1  ON 47
eH2_8                 9.285871e-02 1 1  ON 48
eH2_9                 2.615480e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5149e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1539
    reference variance = 0.228302
====================================================
  Execution time = 3.1452e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2049e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320444743117
                                         uncertainty =       0.003950660292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320444743117
                                         uncertainty =       0.003950660292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400307229
  error estimate for blocks of size 2^( 2) =       0.000410163851
  error estimate for blocks of size 2^( 3) =       0.000418870543
  error estimate for blocks of size 2^( 4) =       0.000425274075
  error estimate for blocks of size 2^( 5) =       0.000430464115
  error estimate for blocks of size 2^( 6) =       0.000432652485
  error estimate for blocks of size 2^( 7) =       0.000432936452

      target function =                  N/A
              le_mean =     -17.216542763160
             les_mean =     296.729836311102
             stat err =       0.000430331782
             autocorr =       1.155633110691
              std dev =       0.566119912774
             le_variance =       0.320491755640


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654276316e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216542763160       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216542766226       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216542774781       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216542782846       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216542784752       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216542783804       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216542783941       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216542783885       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 3.855143e-06

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216542763160       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216542763927       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216542766066       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216542768082       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216542768557       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216542768322       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216542768363       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216542768342       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 9.639345e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216542763160       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216542763351       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216542763886       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216542764391       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216542764512       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216542764481       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216542764462       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216542764457       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 2.409929e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.309871 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0089e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.028860e-01 1 1  ON 0
 uu_1                 4.341206e-02 1 1  ON 1
 uu_2                -4.815387e-02 1 1  ON 2
 uu_3                -9.957672e-02 1 1  ON 3
 uu_4                -1.295068e-01 1 1  ON 4
 uu_5                -1.341429e-01 1 1  ON 5
 uu_6                -1.112603e-01 1 1  ON 6
 uu_7                -3.671371e-02 1 1  ON 7
 uu_8                 1.013743e-01 1 1  ON 8
 uu_9                 1.199991e-01 1 1  ON 9
 ud_0                 3.409136e-01 1 1  ON 10
 ud_1                 8.678980e-02 1 1  ON 11
 ud_2                -1.577149e-02 1 1  ON 12
 ud_3                -7.113953e-02 1 1  ON 13
 ud_4                -1.166518e-01 1 1  ON 14
 ud_5                -1.495870e-01 1 1  ON 15
 ud_6                -1.552920e-01 1 1  ON 16
 ud_7                -1.100749e-01 1 1  ON 17
 ud_8                 6.791049e-03 1 1  ON 18
 ud_9                 9.255038e-02 1 1  ON 19
 eO_0                -7.304548e-01 1 1  ON 20
 eO_1                -4.238762e-01 1 1  ON 21
 eO_2                -3.823297e-02 1 1  ON 22
 eO_3                 1.951434e-01 1 1  ON 23
 eO_4                 2.772281e-01 1 1  ON 24
 eO_5                 3.042421e-01 1 1  ON 25
 eO_6                 2.489276e-01 1 1  ON 26
 eO_7                 1.104807e-01 1 1  ON 27
 eO_8                 2.772370e-02 1 1  ON 28
 eO_9                 1.832714e-02 1 1  ON 29
eH1_0                -1.792582e-01 1 1  ON 30
eH1_1                -1.010437e-01 1 1  ON 31
eH1_2                -6.216427e-02 1 1  ON 32
eH1_3                -2.653662e-02 1 1  ON 33
eH1_4                 1.925687e-02 1 1  ON 34
eH1_5                 3.327875e-02 1 1  ON 35
eH1_6                 7.689933e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980137e-02 1 1  ON 38
eH1_9                 2.403538e-02 1 1  ON 39
eH2_0                -1.814281e-01 1 1  ON 40
eH2_1                -1.026920e-01 1 1  ON 41
eH2_2                -6.368404e-02 1 1  ON 42
eH2_3                -2.776415e-02 1 1  ON 43
eH2_4                 1.810881e-02 1 1  ON 44
eH2_5                 3.402492e-02 1 1  ON 45
eH2_6                 7.850043e-02 1 1  ON 46
eH2_7                 1.138563e-01 1 1  ON 47
eH2_8                 9.285875e-02 1 1  ON 48
eH2_9                 2.615482e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2353
    reference variance = 0.198689
====================================================
  Execution time = 3.1479e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1745e-01
  Total weights = 2.0000e+06
  Execution time = 2.8627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317528567098
                                         uncertainty =       0.004256692521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317528567098
                                         uncertainty =       0.004256692521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398403897
  error estimate for blocks of size 2^( 2) =       0.000408608015
  error estimate for blocks of size 2^( 3) =       0.000417478022
  error estimate for blocks of size 2^( 4) =       0.000423619709
  error estimate for blocks of size 2^( 5) =       0.000427090167
  error estimate for blocks of size 2^( 6) =       0.000430009514
  error estimate for blocks of size 2^( 7) =       0.000431327542

      target function =                  N/A
              le_mean =     -17.215795070450
             les_mean =     296.701051078813
             stat err =       0.000428011733
             autocorr =       1.154155150139
              std dev =       0.563428194001
             le_variance =       0.317451329795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317529228414
                                         uncertainty =       0.004256696452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317529228414
                                         uncertainty =       0.004256696452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398404312
  error estimate for blocks of size 2^( 2) =       0.000408608395
  error estimate for blocks of size 2^( 3) =       0.000417478360
  error estimate for blocks of size 2^( 4) =       0.000423620015
  error estimate for blocks of size 2^( 5) =       0.000427090448
  error estimate for blocks of size 2^( 6) =       0.000430009807
  error estimate for blocks of size 2^( 7) =       0.000431327803

      target function =                  N/A
              le_mean =     -17.215795068238
             les_mean =     296.701051663787
             stat err =       0.000428012018
             autocorr =       1.154154284317
              std dev =       0.563428780731
             le_variance =       0.317451990955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317528897740
                                         uncertainty =       0.004256694483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317528897740
                                         uncertainty =       0.004256694483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398404104
  error estimate for blocks of size 2^( 2) =       0.000408608205
  error estimate for blocks of size 2^( 3) =       0.000417478191
  error estimate for blocks of size 2^( 4) =       0.000423619862
  error estimate for blocks of size 2^( 5) =       0.000427090307
  error estimate for blocks of size 2^( 6) =       0.000430009661
  error estimate for blocks of size 2^( 7) =       0.000431327672

      target function =                  N/A
              le_mean =     -17.215795069343
             les_mean =     296.701051371261
             stat err =       0.000428011876
             autocorr =       1.154154717174
              std dev =       0.563428487351
             le_variance =       0.317451660359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317528608428
                                         uncertainty =       0.004256692766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317528608428
                                         uncertainty =       0.004256692766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398403923
  error estimate for blocks of size 2^( 2) =       0.000408608039
  error estimate for blocks of size 2^( 3) =       0.000417478043
  error estimate for blocks of size 2^( 4) =       0.000423619729
  error estimate for blocks of size 2^( 5) =       0.000427090184
  error estimate for blocks of size 2^( 6) =       0.000430009533
  error estimate for blocks of size 2^( 7) =       0.000431327558

      target function =                  N/A
              le_mean =     -17.215795070312
             les_mean =     296.701051115365
             stat err =       0.000428011751
             autocorr =       1.154155096022
              std dev =       0.563428230669
             le_variance =       0.317451371115


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215795070450        initial  <--
     3.6380e+02     3.6380e+03             3.8551e-06       -17.215795068238
     1.4552e+03     1.4552e+04             9.6393e-07       -17.215795069343
     5.8208e+03     5.8208e+04             2.4099e-07       -17.215795070312

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.9072
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.028858e-01 1 1  ON 0
 uu_1                 4.341196e-02 1 1  ON 1
 uu_2                -4.815392e-02 1 1  ON 2
 uu_3                -9.957670e-02 1 1  ON 3
 uu_4                -1.295066e-01 1 1  ON 4
 uu_5                -1.341428e-01 1 1  ON 5
 uu_6                -1.112602e-01 1 1  ON 6
 uu_7                -3.671362e-02 1 1  ON 7
 uu_8                 1.013744e-01 1 1  ON 8
 uu_9                 1.199990e-01 1 1  ON 9
 ud_0                 3.409134e-01 1 1  ON 10
 ud_1                 8.678960e-02 1 1  ON 11
 ud_2                -1.577145e-02 1 1  ON 12
 ud_3                -7.113940e-02 1 1  ON 13
 ud_4                -1.166516e-01 1 1  ON 14
 ud_5                -1.495870e-01 1 1  ON 15
 ud_6                -1.552921e-01 1 1  ON 16
 ud_7                -1.100749e-01 1 1  ON 17
 ud_8                 6.791162e-03 1 1  ON 18
 ud_9                 9.255038e-02 1 1  ON 19
 eO_0                -7.304538e-01 1 1  ON 20
 eO_1                -4.238758e-01 1 1  ON 21
 eO_2                -3.823309e-02 1 1  ON 22
 eO_3                 1.951428e-01 1 1  ON 23
 eO_4                 2.772276e-01 1 1  ON 24
 eO_5                 3.042421e-01 1 1  ON 25
 eO_6                 2.489276e-01 1 1  ON 26
 eO_7                 1.104806e-01 1 1  ON 27
 eO_8                 2.772369e-02 1 1  ON 28
 eO_9                 1.832713e-02 1 1  ON 29
eH1_0                -1.792580e-01 1 1  ON 30
eH1_1                -1.010436e-01 1 1  ON 31
eH1_2                -6.216426e-02 1 1  ON 32
eH1_3                -2.653657e-02 1 1  ON 33
eH1_4                 1.925686e-02 1 1  ON 34
eH1_5                 3.327856e-02 1 1  ON 35
eH1_6                 7.689929e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980133e-02 1 1  ON 38
eH1_9                 2.403536e-02 1 1  ON 39
eH2_0                -1.814281e-01 1 1  ON 40
eH2_1                -1.026920e-01 1 1  ON 41
eH2_2                -6.368408e-02 1 1  ON 42
eH2_3                -2.776410e-02 1 1  ON 43
eH2_4                 1.810873e-02 1 1  ON 44
eH2_5                 3.402489e-02 1 1  ON 45
eH2_6                 7.850044e-02 1 1  ON 46
eH2_7                 1.138563e-01 1 1  ON 47
eH2_8                 9.285871e-02 1 1  ON 48
eH2_9                 2.615480e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6001e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2098
    reference variance = 0.311532
====================================================
  Execution time = 3.1338e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1311e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313123456942
                                         uncertainty =       0.002803538657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313123456942
                                         uncertainty =       0.002803538657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395670444
  error estimate for blocks of size 2^( 2) =       0.000405640369
  error estimate for blocks of size 2^( 3) =       0.000414336301
  error estimate for blocks of size 2^( 4) =       0.000420697219
  error estimate for blocks of size 2^( 5) =       0.000424544072
  error estimate for blocks of size 2^( 6) =       0.000425672583
  error estimate for blocks of size 2^( 7) =       0.000425545263

      target function =                  N/A
              le_mean =     -17.216535154228
             les_mean =     296.722192760030
             stat err =       0.000424114784
             autocorr =       1.148945964152
              std dev =       0.559562507515
             le_variance =       0.313110199817


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653515423e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216535154228       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216535154331       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216535154819       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216535154989       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216535155029       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216535155147       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216535155139       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216535155167       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 3.513636e-07

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216535154228       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216535154254       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216535154376       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216535154414       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216535154430       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216535154455       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216535154462       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216535154460       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 8.784208e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216535154228       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216535154234       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216535154265       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216535154276       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216535154278       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216535154284       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216535154294       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216535154325       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 2.196059e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.312454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0107e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.028858e-01 1 1  ON 0
 uu_1                 4.341198e-02 1 1  ON 1
 uu_2                -4.815392e-02 1 1  ON 2
 uu_3                -9.957671e-02 1 1  ON 3
 uu_4                -1.295066e-01 1 1  ON 4
 uu_5                -1.341428e-01 1 1  ON 5
 uu_6                -1.112603e-01 1 1  ON 6
 uu_7                -3.671364e-02 1 1  ON 7
 uu_8                 1.013744e-01 1 1  ON 8
 uu_9                 1.199990e-01 1 1  ON 9
 ud_0                 3.409134e-01 1 1  ON 10
 ud_1                 8.678962e-02 1 1  ON 11
 ud_2                -1.577145e-02 1 1  ON 12
 ud_3                -7.113942e-02 1 1  ON 13
 ud_4                -1.166517e-01 1 1  ON 14
 ud_5                -1.495870e-01 1 1  ON 15
 ud_6                -1.552921e-01 1 1  ON 16
 ud_7                -1.100749e-01 1 1  ON 17
 ud_8                 6.791150e-03 1 1  ON 18
 ud_9                 9.255038e-02 1 1  ON 19
 eO_0                -7.304539e-01 1 1  ON 20
 eO_1                -4.238758e-01 1 1  ON 21
 eO_2                -3.823307e-02 1 1  ON 22
 eO_3                 1.951428e-01 1 1  ON 23
 eO_4                 2.772276e-01 1 1  ON 24
 eO_5                 3.042421e-01 1 1  ON 25
 eO_6                 2.489276e-01 1 1  ON 26
 eO_7                 1.104806e-01 1 1  ON 27
 eO_8                 2.772369e-02 1 1  ON 28
 eO_9                 1.832713e-02 1 1  ON 29
eH1_0                -1.792580e-01 1 1  ON 30
eH1_1                -1.010436e-01 1 1  ON 31
eH1_2                -6.216426e-02 1 1  ON 32
eH1_3                -2.653657e-02 1 1  ON 33
eH1_4                 1.925686e-02 1 1  ON 34
eH1_5                 3.327857e-02 1 1  ON 35
eH1_6                 7.689929e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980133e-02 1 1  ON 38
eH1_9                 2.403536e-02 1 1  ON 39
eH2_0                -1.814281e-01 1 1  ON 40
eH2_1                -1.026920e-01 1 1  ON 41
eH2_2                -6.368408e-02 1 1  ON 42
eH2_3                -2.776410e-02 1 1  ON 43
eH2_4                 1.810874e-02 1 1  ON 44
eH2_5                 3.402489e-02 1 1  ON 45
eH2_6                 7.850044e-02 1 1  ON 46
eH2_7                 1.138563e-01 1 1  ON 47
eH2_8                 9.285871e-02 1 1  ON 48
eH2_9                 2.615481e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2378
    reference variance = 0.374698
====================================================
  Execution time = 3.2738e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2180e-01
  Total weights = 2.0000e+06
  Execution time = 2.8652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321756842914
                                         uncertainty =       0.008850814967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321756842914
                                         uncertainty =       0.008850814967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401123108
  error estimate for blocks of size 2^( 2) =       0.000411016841
  error estimate for blocks of size 2^( 3) =       0.000419743698
  error estimate for blocks of size 2^( 4) =       0.000425960736
  error estimate for blocks of size 2^( 5) =       0.000429468694
  error estimate for blocks of size 2^( 6) =       0.000432387794
  error estimate for blocks of size 2^( 7) =       0.000433112418

      target function =                  N/A
              le_mean =     -17.215927167943
             les_mean =     296.709947585981
             stat err =       0.000430232410
             autocorr =       1.150405329330
              std dev =       0.567273739008
             le_variance =       0.321799494968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321756961368
                                         uncertainty =       0.008850819335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321756961368
                                         uncertainty =       0.008850819335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401123181
  error estimate for blocks of size 2^( 2) =       0.000411016910
  error estimate for blocks of size 2^( 3) =       0.000419743762
  error estimate for blocks of size 2^( 4) =       0.000425960797
  error estimate for blocks of size 2^( 5) =       0.000429468754
  error estimate for blocks of size 2^( 6) =       0.000432387856
  error estimate for blocks of size 2^( 7) =       0.000433112482

      target function =                  N/A
              le_mean =     -17.215927168616
             les_mean =     296.709947727616
             stat err =       0.000430232472
             autocorr =       1.150405236580
              std dev =       0.567273843413
             le_variance =       0.321799613421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321756902144
                                         uncertainty =       0.008850817151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321756902144
                                         uncertainty =       0.008850817151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401123145
  error estimate for blocks of size 2^( 2) =       0.000411016875
  error estimate for blocks of size 2^( 3) =       0.000419743730
  error estimate for blocks of size 2^( 4) =       0.000425960767
  error estimate for blocks of size 2^( 5) =       0.000429468724
  error estimate for blocks of size 2^( 6) =       0.000432387825
  error estimate for blocks of size 2^( 7) =       0.000433112450

      target function =                  N/A
              le_mean =     -17.215927168279
             les_mean =     296.709947656801
             stat err =       0.000430232441
             autocorr =       1.150405282957
              std dev =       0.567273791213
             le_variance =       0.321799554197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321756850318
                                         uncertainty =       0.008850815240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321756850318
                                         uncertainty =       0.008850815240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401123112
  error estimate for blocks of size 2^( 2) =       0.000411016845
  error estimate for blocks of size 2^( 3) =       0.000419743702
  error estimate for blocks of size 2^( 4) =       0.000425960740
  error estimate for blocks of size 2^( 5) =       0.000429468698
  error estimate for blocks of size 2^( 6) =       0.000432387798
  error estimate for blocks of size 2^( 7) =       0.000433112422

      target function =                  N/A
              le_mean =     -17.215927167985
             les_mean =     296.709947594833
             stat err =       0.000430232414
             autocorr =       1.150405323534
              std dev =       0.567273745534
             le_variance =       0.321799502372


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215927167943        initial
     3.6380e+03     3.6380e+04             3.5136e-07       -17.215927168616  <--
     1.4552e+04     1.4552e+05             8.7842e-08       -17.215927168279
     5.8208e+04     5.8208e+05             2.1961e-08       -17.215927167985

*****************************************************************************
Applying the update for shift_i =   3.6380e+03     and shift_s =   3.6380e+04
*****************************************************************************

  Execution time = 4.7162e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.028859e-01 1 1  ON 0
 uu_1                 4.341202e-02 1 1  ON 1
 uu_2                -4.815390e-02 1 1  ON 2
 uu_3                -9.957673e-02 1 1  ON 3
 uu_4                -1.295067e-01 1 1  ON 4
 uu_5                -1.341428e-01 1 1  ON 5
 uu_6                -1.112603e-01 1 1  ON 6
 uu_7                -3.671368e-02 1 1  ON 7
 uu_8                 1.013744e-01 1 1  ON 8
 uu_9                 1.199991e-01 1 1  ON 9
 ud_0                 3.409135e-01 1 1  ON 10
 ud_1                 8.678966e-02 1 1  ON 11
 ud_2                -1.577146e-02 1 1  ON 12
 ud_3                -7.113946e-02 1 1  ON 13
 ud_4                -1.166517e-01 1 1  ON 14
 ud_5                -1.495870e-01 1 1  ON 15
 ud_6                -1.552921e-01 1 1  ON 16
 ud_7                -1.100749e-01 1 1  ON 17
 ud_8                 6.791114e-03 1 1  ON 18
 ud_9                 9.255039e-02 1 1  ON 19
 eO_0                -7.304542e-01 1 1  ON 20
 eO_1                -4.238759e-01 1 1  ON 21
 eO_2                -3.823304e-02 1 1  ON 22
 eO_3                 1.951430e-01 1 1  ON 23
 eO_4                 2.772278e-01 1 1  ON 24
 eO_5                 3.042421e-01 1 1  ON 25
 eO_6                 2.489276e-01 1 1  ON 26
 eO_7                 1.104807e-01 1 1  ON 27
 eO_8                 2.772369e-02 1 1  ON 28
 eO_9                 1.832714e-02 1 1  ON 29
eH1_0                -1.792581e-01 1 1  ON 30
eH1_1                -1.010436e-01 1 1  ON 31
eH1_2                -6.216425e-02 1 1  ON 32
eH1_3                -2.653658e-02 1 1  ON 33
eH1_4                 1.925687e-02 1 1  ON 34
eH1_5                 3.327859e-02 1 1  ON 35
eH1_6                 7.689928e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980135e-02 1 1  ON 38
eH1_9                 2.403537e-02 1 1  ON 39
eH2_0                -1.814281e-01 1 1  ON 40
eH2_1                -1.026920e-01 1 1  ON 41
eH2_2                -6.368407e-02 1 1  ON 42
eH2_3                -2.776408e-02 1 1  ON 43
eH2_4                 1.810876e-02 1 1  ON 44
eH2_5                 3.402488e-02 1 1  ON 45
eH2_6                 7.850042e-02 1 1  ON 46
eH2_7                 1.138563e-01 1 1  ON 47
eH2_8                 9.285872e-02 1 1  ON 48
eH2_9                 2.615481e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.7274e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1689
    reference variance = 0.180515
====================================================
  Execution time = 3.1840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2849e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0573e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328514046587
                                         uncertainty =       0.009548044263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328514046587
                                         uncertainty =       0.009548044263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405272388
  error estimate for blocks of size 2^( 2) =       0.000414698279
  error estimate for blocks of size 2^( 3) =       0.000423563933
  error estimate for blocks of size 2^( 4) =       0.000429403750
  error estimate for blocks of size 2^( 5) =       0.000432559018
  error estimate for blocks of size 2^( 6) =       0.000434841858
  error estimate for blocks of size 2^( 7) =       0.000435304899

      target function =                  N/A
              le_mean =     -17.216426857333
             les_mean =     296.733844986589
             stat err =       0.000433027381
             autocorr =       1.141659739570
              std dev =       0.573141707540
             le_variance =       0.328491416922


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642685733e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216426857333       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216426858344       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216426858969       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216426862199       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216426862640       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216426862753       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216426862803       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216426862952       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 1.361020e-06

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216426857333       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216426857586       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216426857742       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216426858550       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216426858660       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216426858688       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216426858699       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216426858737       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 3.402690e-07

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216426857333       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216426857397       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216426857436       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216426857638       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216426857662       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216426857674       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216426857684       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216426857678       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 8.506812e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.315062 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0904e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.028860e-01 1 1  ON 0
 uu_1                 4.341207e-02 1 1  ON 1
 uu_2                -4.815388e-02 1 1  ON 2
 uu_3                -9.957673e-02 1 1  ON 3
 uu_4                -1.295068e-01 1 1  ON 4
 uu_5                -1.341429e-01 1 1  ON 5
 uu_6                -1.112603e-01 1 1  ON 6
 uu_7                -3.671372e-02 1 1  ON 7
 uu_8                 1.013743e-01 1 1  ON 8
 uu_9                 1.199991e-01 1 1  ON 9
 ud_0                 3.409136e-01 1 1  ON 10
 ud_1                 8.678973e-02 1 1  ON 11
 ud_2                -1.577147e-02 1 1  ON 12
 ud_3                -7.113952e-02 1 1  ON 13
 ud_4                -1.166518e-01 1 1  ON 14
 ud_5                -1.495870e-01 1 1  ON 15
 ud_6                -1.552920e-01 1 1  ON 16
 ud_7                -1.100749e-01 1 1  ON 17
 ud_8                 6.791080e-03 1 1  ON 18
 ud_9                 9.255039e-02 1 1  ON 19
 eO_0                -7.304545e-01 1 1  ON 20
 eO_1                -4.238761e-01 1 1  ON 21
 eO_2                -3.823301e-02 1 1  ON 22
 eO_3                 1.951432e-01 1 1  ON 23
 eO_4                 2.772280e-01 1 1  ON 24
 eO_5                 3.042421e-01 1 1  ON 25
 eO_6                 2.489276e-01 1 1  ON 26
 eO_7                 1.104807e-01 1 1  ON 27
 eO_8                 2.772369e-02 1 1  ON 28
 eO_9                 1.832714e-02 1 1  ON 29
eH1_0                -1.792581e-01 1 1  ON 30
eH1_1                -1.010437e-01 1 1  ON 31
eH1_2                -6.216425e-02 1 1  ON 32
eH1_3                -2.653658e-02 1 1  ON 33
eH1_4                 1.925687e-02 1 1  ON 34
eH1_5                 3.327862e-02 1 1  ON 35
eH1_6                 7.689930e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980137e-02 1 1  ON 38
eH1_9                 2.403537e-02 1 1  ON 39
eH2_0                -1.814281e-01 1 1  ON 40
eH2_1                -1.026920e-01 1 1  ON 41
eH2_2                -6.368407e-02 1 1  ON 42
eH2_3                -2.776409e-02 1 1  ON 43
eH2_4                 1.810878e-02 1 1  ON 44
eH2_5                 3.402493e-02 1 1  ON 45
eH2_6                 7.850040e-02 1 1  ON 46
eH2_7                 1.138563e-01 1 1  ON 47
eH2_8                 9.285874e-02 1 1  ON 48
eH2_9                 2.615482e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.179
    reference variance = 0.217631
====================================================
  Execution time = 3.1147e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2846e-01
  Total weights = 2.0000e+06
  Execution time = 2.8623e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328518402985
                                         uncertainty =       0.008276085553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328518402985
                                         uncertainty =       0.008276085553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405251068
  error estimate for blocks of size 2^( 2) =       0.000414516811
  error estimate for blocks of size 2^( 3) =       0.000423224419
  error estimate for blocks of size 2^( 4) =       0.000428891614
  error estimate for blocks of size 2^( 5) =       0.000432916319
  error estimate for blocks of size 2^( 6) =       0.000433182126
  error estimate for blocks of size 2^( 7) =       0.000434558292

      target function =                  N/A
              le_mean =     -17.216950855293
             les_mean =     296.751853445281
             stat err =       0.000432387088
             autocorr =       1.138405791769
              std dev =       0.573111556263
             le_variance =       0.328456855922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328518763141
                                         uncertainty =       0.008276090849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328518763141
                                         uncertainty =       0.008276090849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405251290
  error estimate for blocks of size 2^( 2) =       0.000414517017
  error estimate for blocks of size 2^( 3) =       0.000423224606
  error estimate for blocks of size 2^( 4) =       0.000428891792
  error estimate for blocks of size 2^( 5) =       0.000432916490
  error estimate for blocks of size 2^( 6) =       0.000433182296
  error estimate for blocks of size 2^( 7) =       0.000434558464

      target function =                  N/A
              le_mean =     -17.216950855966
             les_mean =     296.751853828420
             stat err =       0.000432387261
             autocorr =       1.138405454860
              std dev =       0.573111870331
             le_variance =       0.328457215914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328518583079
                                         uncertainty =       0.008276088202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328518583079
                                         uncertainty =       0.008276088202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405251179
  error estimate for blocks of size 2^( 2) =       0.000414516914
  error estimate for blocks of size 2^( 3) =       0.000423224513
  error estimate for blocks of size 2^( 4) =       0.000428891703
  error estimate for blocks of size 2^( 5) =       0.000432916405
  error estimate for blocks of size 2^( 6) =       0.000433182211
  error estimate for blocks of size 2^( 7) =       0.000434558378

      target function =                  N/A
              le_mean =     -17.216950855629
             les_mean =     296.751853636863
             stat err =       0.000432387174
             autocorr =       1.138405623306
              std dev =       0.573111713311
             le_variance =       0.328457035934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328518425498
                                         uncertainty =       0.008276085884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328518425498
                                         uncertainty =       0.008276085884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405251082
  error estimate for blocks of size 2^( 2) =       0.000414516824
  error estimate for blocks of size 2^( 3) =       0.000423224430
  error estimate for blocks of size 2^( 4) =       0.000428891625
  error estimate for blocks of size 2^( 5) =       0.000432916329
  error estimate for blocks of size 2^( 6) =       0.000433182137
  error estimate for blocks of size 2^( 7) =       0.000434558303

      target function =                  N/A
              le_mean =     -17.216950855335
             les_mean =     296.751853469229
             stat err =       0.000432387098
             autocorr =       1.138405770708
              std dev =       0.573111575895
             le_variance =       0.328456878424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216950855293        initial
     9.0949e+02     9.0949e+03             1.3610e-06       -17.216950855966  <--
     3.6380e+03     3.6380e+04             3.4027e-07       -17.216950855629
     1.4552e+04     1.4552e+05             8.5068e-08       -17.216950855335

*****************************************************************************
Applying the update for shift_i =   9.0949e+02     and shift_s =   9.0949e+03
*****************************************************************************

  Execution time = 4.5532e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.028863e-01 1 1  ON 0
 uu_1                 4.341219e-02 1 1  ON 1
 uu_2                -4.815380e-02 1 1  ON 2
 uu_3                -9.957675e-02 1 1  ON 3
 uu_4                -1.295070e-01 1 1  ON 4
 uu_5                -1.341430e-01 1 1  ON 5
 uu_6                -1.112603e-01 1 1  ON 6
 uu_7                -3.671384e-02 1 1  ON 7
 uu_8                 1.013743e-01 1 1  ON 8
 uu_9                 1.199991e-01 1 1  ON 9
 ud_0                 3.409139e-01 1 1  ON 10
 ud_1                 8.678993e-02 1 1  ON 11
 ud_2                -1.577150e-02 1 1  ON 12
 ud_3                -7.113971e-02 1 1  ON 13
 ud_4                -1.166521e-01 1 1  ON 14
 ud_5                -1.495870e-01 1 1  ON 15
 ud_6                -1.552919e-01 1 1  ON 16
 ud_7                -1.100749e-01 1 1  ON 17
 ud_8                 6.790979e-03 1 1  ON 18
 ud_9                 9.255039e-02 1 1  ON 19
 eO_0                -7.304556e-01 1 1  ON 20
 eO_1                -4.238768e-01 1 1  ON 21
 eO_2                -3.823291e-02 1 1  ON 22
 eO_3                 1.951440e-01 1 1  ON 23
 eO_4                 2.772286e-01 1 1  ON 24
 eO_5                 3.042422e-01 1 1  ON 25
 eO_6                 2.489277e-01 1 1  ON 26
 eO_7                 1.104808e-01 1 1  ON 27
 eO_8                 2.772370e-02 1 1  ON 28
 eO_9                 1.832714e-02 1 1  ON 29
eH1_0                -1.792583e-01 1 1  ON 30
eH1_1                -1.010438e-01 1 1  ON 31
eH1_2                -6.216425e-02 1 1  ON 32
eH1_3                -2.653656e-02 1 1  ON 33
eH1_4                 1.925687e-02 1 1  ON 34
eH1_5                 3.327872e-02 1 1  ON 35
eH1_6                 7.689935e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980144e-02 1 1  ON 38
eH1_9                 2.403539e-02 1 1  ON 39
eH2_0                -1.814281e-01 1 1  ON 40
eH2_1                -1.026921e-01 1 1  ON 41
eH2_2                -6.368409e-02 1 1  ON 42
eH2_3                -2.776411e-02 1 1  ON 43
eH2_4                 1.810884e-02 1 1  ON 44
eH2_5                 3.402509e-02 1 1  ON 45
eH2_6                 7.850033e-02 1 1  ON 46
eH2_7                 1.138562e-01 1 1  ON 47
eH2_8                 9.285877e-02 1 1  ON 48
eH2_9                 2.615483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6441e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2671
    reference variance = 0.166349
====================================================
  Execution time = 3.1313e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1939e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319383937380
                                         uncertainty =       0.004153235058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319383937380
                                         uncertainty =       0.004153235058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399617001
  error estimate for blocks of size 2^( 2) =       0.000409169068
  error estimate for blocks of size 2^( 3) =       0.000418016203
  error estimate for blocks of size 2^( 4) =       0.000424923843
  error estimate for blocks of size 2^( 5) =       0.000428465350
  error estimate for blocks of size 2^( 6) =       0.000430413881
  error estimate for blocks of size 2^( 7) =       0.000432401916

      target function =                  N/A
              le_mean =     -17.216052135009
             les_mean =     296.711838450590
             stat err =       0.000429051247
             autocorr =       1.152737510558
              std dev =       0.565143782540
             le_variance =       0.319387494943


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721605213501e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216052135009       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216052138206       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216052154886       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216052159907       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216052160816       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216052161041       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216052160627       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216052160995       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+02 is 5.237876e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216052135009       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216052135809       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216052139981       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216052141235       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216052141462       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216052141518       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216052141415       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216052141505       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 1.309670e-06

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216052135009       residual = 9.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216052135209       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216052136252       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216052136565       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216052136626       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216052136632       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216052136611       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216052136631       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 3.274300e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.317623 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.9962e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.028869e-01 1 1  ON 0
 uu_1                 4.341233e-02 1 1  ON 1
 uu_2                -4.815374e-02 1 1  ON 2
 uu_3                -9.957685e-02 1 1  ON 3
 uu_4                -1.295072e-01 1 1  ON 4
 uu_5                -1.341432e-01 1 1  ON 5
 uu_6                -1.112604e-01 1 1  ON 6
 uu_7                -3.671404e-02 1 1  ON 7
 uu_8                 1.013741e-01 1 1  ON 8
 uu_9                 1.199991e-01 1 1  ON 9
 ud_0                 3.409145e-01 1 1  ON 10
 ud_1                 8.679011e-02 1 1  ON 11
 ud_2                -1.577146e-02 1 1  ON 12
 ud_3                -7.113988e-02 1 1  ON 13
 ud_4                -1.166524e-01 1 1  ON 14
 ud_5                -1.495871e-01 1 1  ON 15
 ud_6                -1.552919e-01 1 1  ON 16
 ud_7                -1.100750e-01 1 1  ON 17
 ud_8                 6.790803e-03 1 1  ON 18
 ud_9                 9.255037e-02 1 1  ON 19
 eO_0                -7.304569e-01 1 1  ON 20
 eO_1                -4.238774e-01 1 1  ON 21
 eO_2                -3.823288e-02 1 1  ON 22
 eO_3                 1.951449e-01 1 1  ON 23
 eO_4                 2.772294e-01 1 1  ON 24
 eO_5                 3.042422e-01 1 1  ON 25
 eO_6                 2.489278e-01 1 1  ON 26
 eO_7                 1.104809e-01 1 1  ON 27
 eO_8                 2.772372e-02 1 1  ON 28
 eO_9                 1.832715e-02 1 1  ON 29
eH1_0                -1.792584e-01 1 1  ON 30
eH1_1                -1.010439e-01 1 1  ON 31
eH1_2                -6.216418e-02 1 1  ON 32
eH1_3                -2.653657e-02 1 1  ON 33
eH1_4                 1.925686e-02 1 1  ON 34
eH1_5                 3.327891e-02 1 1  ON 35
eH1_6                 7.689934e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980150e-02 1 1  ON 38
eH1_9                 2.403540e-02 1 1  ON 39
eH2_0                -1.814282e-01 1 1  ON 40
eH2_1                -1.026921e-01 1 1  ON 41
eH2_2                -6.368405e-02 1 1  ON 42
eH2_3                -2.776410e-02 1 1  ON 43
eH2_4                 1.810885e-02 1 1  ON 44
eH2_5                 3.402511e-02 1 1  ON 45
eH2_6                 7.850031e-02 1 1  ON 46
eH2_7                 1.138562e-01 1 1  ON 47
eH2_8                 9.285885e-02 1 1  ON 48
eH2_9                 2.615484e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1934
    reference variance = 0.209749
====================================================
  Execution time = 3.0975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2057e-01
  Total weights = 2.0000e+06
  Execution time = 2.8590e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320669528808
                                         uncertainty =       0.004249650340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320669528808
                                         uncertainty =       0.004249650340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400357533
  error estimate for blocks of size 2^( 2) =       0.000410436415
  error estimate for blocks of size 2^( 3) =       0.000419743630
  error estimate for blocks of size 2^( 4) =       0.000426203665
  error estimate for blocks of size 2^( 5) =       0.000429927690
  error estimate for blocks of size 2^( 6) =       0.000430837729
  error estimate for blocks of size 2^( 7) =       0.000432869621

      target function =                  N/A
              le_mean =     -17.216619663726
             les_mean =     296.732564792972
             stat err =       0.000429959676
             autocorr =       1.153345556094
              std dev =       0.566191052437
             le_variance =       0.320572307859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320671418208
                                         uncertainty =       0.004249674823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320671418208
                                         uncertainty =       0.004249674823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400358712
  error estimate for blocks of size 2^( 2) =       0.000410437529
  error estimate for blocks of size 2^( 3) =       0.000419744672
  error estimate for blocks of size 2^( 4) =       0.000426204647
  error estimate for blocks of size 2^( 5) =       0.000429928656
  error estimate for blocks of size 2^( 6) =       0.000430838661
  error estimate for blocks of size 2^( 7) =       0.000432870555

      target function =                  N/A
              le_mean =     -17.216619655898
             les_mean =     296.732566411970
             stat err =       0.000429960630
             autocorr =       1.153343875084
              std dev =       0.566192720193
             le_variance =       0.320574196400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320670474301
                                         uncertainty =       0.004249662587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320670474301
                                         uncertainty =       0.004249662587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400358123
  error estimate for blocks of size 2^( 2) =       0.000410436973
  error estimate for blocks of size 2^( 3) =       0.000419744152
  error estimate for blocks of size 2^( 4) =       0.000426204156
  error estimate for blocks of size 2^( 5) =       0.000429928173
  error estimate for blocks of size 2^( 6) =       0.000430838195
  error estimate for blocks of size 2^( 7) =       0.000432870089

      target function =                  N/A
              le_mean =     -17.216619659809
             les_mean =     296.732565603144
             stat err =       0.000429960153
             autocorr =       1.153344715072
              std dev =       0.566191887016
             le_variance =       0.320573252923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320669647018
                                         uncertainty =       0.004249651871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320669647018
                                         uncertainty =       0.004249651871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400357606
  error estimate for blocks of size 2^( 2) =       0.000410436485
  error estimate for blocks of size 2^( 3) =       0.000419743696
  error estimate for blocks of size 2^( 4) =       0.000426203727
  error estimate for blocks of size 2^( 5) =       0.000429927751
  error estimate for blocks of size 2^( 6) =       0.000430837787
  error estimate for blocks of size 2^( 7) =       0.000432869680

      target function =                  N/A
              le_mean =     -17.216619663236
             les_mean =     296.732564894258
             stat err =       0.000429959736
             autocorr =       1.153345450944
              std dev =       0.566191156780
             le_variance =       0.320572426016


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216619663726        initial  <--
     2.2737e+02     2.2737e+03             5.2379e-06       -17.216619655898
     9.0949e+02     9.0949e+03             1.3097e-06       -17.216619659809
     3.6380e+03     3.6380e+04             3.2743e-07       -17.216619663236

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3911
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.028863e-01 1 1  ON 0
 uu_1                 4.341219e-02 1 1  ON 1
 uu_2                -4.815380e-02 1 1  ON 2
 uu_3                -9.957675e-02 1 1  ON 3
 uu_4                -1.295070e-01 1 1  ON 4
 uu_5                -1.341430e-01 1 1  ON 5
 uu_6                -1.112603e-01 1 1  ON 6
 uu_7                -3.671384e-02 1 1  ON 7
 uu_8                 1.013743e-01 1 1  ON 8
 uu_9                 1.199991e-01 1 1  ON 9
 ud_0                 3.409139e-01 1 1  ON 10
 ud_1                 8.678993e-02 1 1  ON 11
 ud_2                -1.577150e-02 1 1  ON 12
 ud_3                -7.113971e-02 1 1  ON 13
 ud_4                -1.166521e-01 1 1  ON 14
 ud_5                -1.495870e-01 1 1  ON 15
 ud_6                -1.552919e-01 1 1  ON 16
 ud_7                -1.100749e-01 1 1  ON 17
 ud_8                 6.790979e-03 1 1  ON 18
 ud_9                 9.255039e-02 1 1  ON 19
 eO_0                -7.304556e-01 1 1  ON 20
 eO_1                -4.238768e-01 1 1  ON 21
 eO_2                -3.823291e-02 1 1  ON 22
 eO_3                 1.951440e-01 1 1  ON 23
 eO_4                 2.772286e-01 1 1  ON 24
 eO_5                 3.042422e-01 1 1  ON 25
 eO_6                 2.489277e-01 1 1  ON 26
 eO_7                 1.104808e-01 1 1  ON 27
 eO_8                 2.772370e-02 1 1  ON 28
 eO_9                 1.832714e-02 1 1  ON 29
eH1_0                -1.792583e-01 1 1  ON 30
eH1_1                -1.010438e-01 1 1  ON 31
eH1_2                -6.216425e-02 1 1  ON 32
eH1_3                -2.653656e-02 1 1  ON 33
eH1_4                 1.925687e-02 1 1  ON 34
eH1_5                 3.327872e-02 1 1  ON 35
eH1_6                 7.689935e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980144e-02 1 1  ON 38
eH1_9                 2.403539e-02 1 1  ON 39
eH2_0                -1.814281e-01 1 1  ON 40
eH2_1                -1.026921e-01 1 1  ON 41
eH2_2                -6.368409e-02 1 1  ON 42
eH2_3                -2.776411e-02 1 1  ON 43
eH2_4                 1.810884e-02 1 1  ON 44
eH2_5                 3.402509e-02 1 1  ON 45
eH2_6                 7.850033e-02 1 1  ON 46
eH2_7                 1.138562e-01 1 1  ON 47
eH2_8                 9.285877e-02 1 1  ON 48
eH2_9                 2.615483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5358e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2016
    reference variance = 0.186022
====================================================
  Execution time = 3.1548e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2451e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.7742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324481224189
                                         uncertainty =       0.005110256532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324481224189
                                         uncertainty =       0.005110256532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402806738
  error estimate for blocks of size 2^( 2) =       0.000412281089
  error estimate for blocks of size 2^( 3) =       0.000421029565
  error estimate for blocks of size 2^( 4) =       0.000426505776
  error estimate for blocks of size 2^( 5) =       0.000430022901
  error estimate for blocks of size 2^( 6) =       0.000432429894
  error estimate for blocks of size 2^( 7) =       0.000433362955

      target function =                  N/A
              le_mean =     -17.217044039006
             les_mean =     296.751111815443
             stat err =       0.000430580382
             autocorr =       1.142654733831
              std dev =       0.569654752119
             le_variance =       0.324506536611


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704403901e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217044039006       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217044039506       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217044040789       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217044042053       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217044042501       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217044042406       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217044042313       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217044042301       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 5.975944e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217044039006       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217044039131       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217044039452       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217044039763       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217044039869       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217044039857       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217044039839       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217044039823       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 1.494027e-07

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217044039006       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217044039038       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217044039118       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217044039197       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217044039220       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217044039198       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217044039205       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217044039186       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 3.735092e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.320213 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0330e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.028864e-01 1 1  ON 0
 uu_1                 4.341221e-02 1 1  ON 1
 uu_2                -4.815380e-02 1 1  ON 2
 uu_3                -9.957677e-02 1 1  ON 3
 uu_4                -1.295070e-01 1 1  ON 4
 uu_5                -1.341431e-01 1 1  ON 5
 uu_6                -1.112603e-01 1 1  ON 6
 uu_7                -3.671386e-02 1 1  ON 7
 uu_8                 1.013743e-01 1 1  ON 8
 uu_9                 1.199991e-01 1 1  ON 9
 ud_0                 3.409140e-01 1 1  ON 10
 ud_1                 8.678996e-02 1 1  ON 11
 ud_2                -1.577150e-02 1 1  ON 12
 ud_3                -7.113973e-02 1 1  ON 13
 ud_4                -1.166522e-01 1 1  ON 14
 ud_5                -1.495870e-01 1 1  ON 15
 ud_6                -1.552919e-01 1 1  ON 16
 ud_7                -1.100749e-01 1 1  ON 17
 ud_8                 6.790966e-03 1 1  ON 18
 ud_9                 9.255039e-02 1 1  ON 19
 eO_0                -7.304557e-01 1 1  ON 20
 eO_1                -4.238768e-01 1 1  ON 21
 eO_2                -3.823289e-02 1 1  ON 22
 eO_3                 1.951440e-01 1 1  ON 23
 eO_4                 2.772287e-01 1 1  ON 24
 eO_5                 3.042422e-01 1 1  ON 25
 eO_6                 2.489277e-01 1 1  ON 26
 eO_7                 1.104808e-01 1 1  ON 27
 eO_8                 2.772371e-02 1 1  ON 28
 eO_9                 1.832715e-02 1 1  ON 29
eH1_0                -1.792583e-01 1 1  ON 30
eH1_1                -1.010438e-01 1 1  ON 31
eH1_2                -6.216425e-02 1 1  ON 32
eH1_3                -2.653656e-02 1 1  ON 33
eH1_4                 1.925685e-02 1 1  ON 34
eH1_5                 3.327874e-02 1 1  ON 35
eH1_6                 7.689936e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980145e-02 1 1  ON 38
eH1_9                 2.403539e-02 1 1  ON 39
eH2_0                -1.814281e-01 1 1  ON 40
eH2_1                -1.026921e-01 1 1  ON 41
eH2_2                -6.368409e-02 1 1  ON 42
eH2_3                -2.776411e-02 1 1  ON 43
eH2_4                 1.810884e-02 1 1  ON 44
eH2_5                 3.402510e-02 1 1  ON 45
eH2_6                 7.850033e-02 1 1  ON 46
eH2_7                 1.138562e-01 1 1  ON 47
eH2_8                 9.285878e-02 1 1  ON 48
eH2_9                 2.615483e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.3156
    reference variance = 0.195164
====================================================
  Execution time = 3.1112e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1993e-01
  Total weights = 2.0000e+06
  Execution time = 2.8671e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319997580107
                                         uncertainty =       0.003153200902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319997580107
                                         uncertainty =       0.003153200902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399955138
  error estimate for blocks of size 2^( 2) =       0.000409478508
  error estimate for blocks of size 2^( 3) =       0.000418193715
  error estimate for blocks of size 2^( 4) =       0.000424736618
  error estimate for blocks of size 2^( 5) =       0.000428276508
  error estimate for blocks of size 2^( 6) =       0.000430313487
  error estimate for blocks of size 2^( 7) =       0.000430304833

      target function =                  N/A
              le_mean =     -17.216589255388
             les_mean =     296.730873653648
             stat err =       0.000428407861
             autocorr =       1.147340442670
              std dev =       0.565621980529
             le_variance =       0.319928224857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319997733619
                                         uncertainty =       0.003153203095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319997733619
                                         uncertainty =       0.003153203095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399955234
  error estimate for blocks of size 2^( 2) =       0.000409478597
  error estimate for blocks of size 2^( 3) =       0.000418193798
  error estimate for blocks of size 2^( 4) =       0.000424736696
  error estimate for blocks of size 2^( 5) =       0.000428276583
  error estimate for blocks of size 2^( 6) =       0.000430313560
  error estimate for blocks of size 2^( 7) =       0.000430304907

      target function =                  N/A
              le_mean =     -17.216589255483
             les_mean =     296.730873810347
             stat err =       0.000428407936
             autocorr =       1.147340295211
              std dev =       0.565622116165
             le_variance =       0.319928378295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319997656865
                                         uncertainty =       0.003153201999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319997656865
                                         uncertainty =       0.003153201999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399955186
  error estimate for blocks of size 2^( 2) =       0.000409478553
  error estimate for blocks of size 2^( 3) =       0.000418193757
  error estimate for blocks of size 2^( 4) =       0.000424736657
  error estimate for blocks of size 2^( 5) =       0.000428276545
  error estimate for blocks of size 2^( 6) =       0.000430313523
  error estimate for blocks of size 2^( 7) =       0.000430304870

      target function =                  N/A
              le_mean =     -17.216589255436
             les_mean =     296.730873731999
             stat err =       0.000428407899
             autocorr =       1.147340368938
              std dev =       0.565622048348
             le_variance =       0.319928301578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319997589702
                                         uncertainty =       0.003153201039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319997589702
                                         uncertainty =       0.003153201039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399955144
  error estimate for blocks of size 2^( 2) =       0.000409478514
  error estimate for blocks of size 2^( 3) =       0.000418193720
  error estimate for blocks of size 2^( 4) =       0.000424736623
  error estimate for blocks of size 2^( 5) =       0.000428276512
  error estimate for blocks of size 2^( 6) =       0.000430313491
  error estimate for blocks of size 2^( 7) =       0.000430304838

      target function =                  N/A
              le_mean =     -17.216589255394
             les_mean =     296.730873663442
             stat err =       0.000428407866
             autocorr =       1.147340433456
              std dev =       0.565621989006
             le_variance =       0.319928234448


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216589255388        initial
     2.2737e+03     2.2737e+04             5.9759e-07       -17.216589255483  <--
     9.0949e+03     9.0949e+04             1.4940e-07       -17.216589255436
     3.6380e+04     3.6380e+05             3.7351e-08       -17.216589255394

*****************************************************************************
Applying the update for shift_i =   2.2737e+03     and shift_s =   2.2737e+04
*****************************************************************************

  Execution time = 4.5565e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.028865e-01 1 1  ON 0
 uu_1                 4.341226e-02 1 1  ON 1
 uu_2                -4.815379e-02 1 1  ON 2
 uu_3                -9.957681e-02 1 1  ON 3
 uu_4                -1.295071e-01 1 1  ON 4
 uu_5                -1.341431e-01 1 1  ON 5
 uu_6                -1.112603e-01 1 1  ON 6
 uu_7                -3.671392e-02 1 1  ON 7
 uu_8                 1.013742e-01 1 1  ON 8
 uu_9                 1.199991e-01 1 1  ON 9
 ud_0                 3.409141e-01 1 1  ON 10
 ud_1                 8.679005e-02 1 1  ON 11
 ud_2                -1.577149e-02 1 1  ON 12
 ud_3                -7.113979e-02 1 1  ON 13
 ud_4                -1.166522e-01 1 1  ON 14
 ud_5                -1.495871e-01 1 1  ON 15
 ud_6                -1.552919e-01 1 1  ON 16
 ud_7                -1.100750e-01 1 1  ON 17
 ud_8                 6.790927e-03 1 1  ON 18
 ud_9                 9.255039e-02 1 1  ON 19
 eO_0                -7.304561e-01 1 1  ON 20
 eO_1                -4.238770e-01 1 1  ON 21
 eO_2                -3.823282e-02 1 1  ON 22
 eO_3                 1.951443e-01 1 1  ON 23
 eO_4                 2.772289e-01 1 1  ON 24
 eO_5                 3.042422e-01 1 1  ON 25
 eO_6                 2.489277e-01 1 1  ON 26
 eO_7                 1.104808e-01 1 1  ON 27
 eO_8                 2.772371e-02 1 1  ON 28
 eO_9                 1.832715e-02 1 1  ON 29
eH1_0                -1.792584e-01 1 1  ON 30
eH1_1                -1.010438e-01 1 1  ON 31
eH1_2                -6.216424e-02 1 1  ON 32
eH1_3                -2.653657e-02 1 1  ON 33
eH1_4                 1.925680e-02 1 1  ON 34
eH1_5                 3.327877e-02 1 1  ON 35
eH1_6                 7.689937e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980147e-02 1 1  ON 38
eH1_9                 2.403540e-02 1 1  ON 39
eH2_0                -1.814281e-01 1 1  ON 40
eH2_1                -1.026921e-01 1 1  ON 41
eH2_2                -6.368410e-02 1 1  ON 42
eH2_3                -2.776411e-02 1 1  ON 43
eH2_4                 1.810884e-02 1 1  ON 44
eH2_5                 3.402513e-02 1 1  ON 45
eH2_6                 7.850032e-02 1 1  ON 46
eH2_7                 1.138562e-01 1 1  ON 47
eH2_8                 9.285880e-02 1 1  ON 48
eH2_9                 2.615484e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.5901e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2908
    reference variance = 0.871606
====================================================
  Execution time = 3.3380e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1965e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.6050e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319642416294
                                         uncertainty =       0.005157614772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319642416294
                                         uncertainty =       0.005157614772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399782865
  error estimate for blocks of size 2^( 2) =       0.000409752148
  error estimate for blocks of size 2^( 3) =       0.000418473142
  error estimate for blocks of size 2^( 4) =       0.000424642208
  error estimate for blocks of size 2^( 5) =       0.000428605783
  error estimate for blocks of size 2^( 6) =       0.000429688138
  error estimate for blocks of size 2^( 7) =       0.000431330523

      target function =                  N/A
              le_mean =     -17.216886317141
             les_mean =     296.740826976573
             stat err =       0.000428566663
             autocorr =       1.149180948594
              std dev =       0.565378350361
             le_variance =       0.319652679056


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721688631714e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216886317141       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216886318466       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216886318072       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216886320720       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216886325213       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216886325478       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216886325606       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216886325437       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+02 is 2.336908e-06

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216886317141       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216886317472       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216886317373       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216886318036       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216886319158       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216886319225       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216886319258       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216886319211       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 5.842997e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216886317141       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216886317223       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216886317199       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216886317364       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216886317645       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216886317659       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216886317668       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216886317658       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 1.460795e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.322790 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.1991e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.028866e-01 1 1  ON 0
 uu_1                 4.341233e-02 1 1  ON 1
 uu_2                -4.815380e-02 1 1  ON 2
 uu_3                -9.957680e-02 1 1  ON 3
 uu_4                -1.295072e-01 1 1  ON 4
 uu_5                -1.341432e-01 1 1  ON 5
 uu_6                -1.112604e-01 1 1  ON 6
 uu_7                -3.671396e-02 1 1  ON 7
 uu_8                 1.013742e-01 1 1  ON 8
 uu_9                 1.199992e-01 1 1  ON 9
 ud_0                 3.409142e-01 1 1  ON 10
 ud_1                 8.679019e-02 1 1  ON 11
 ud_2                -1.577148e-02 1 1  ON 12
 ud_3                -7.113986e-02 1 1  ON 13
 ud_4                -1.166523e-01 1 1  ON 14
 ud_5                -1.495871e-01 1 1  ON 15
 ud_6                -1.552919e-01 1 1  ON 16
 ud_7                -1.100750e-01 1 1  ON 17
 ud_8                 6.790845e-03 1 1  ON 18
 ud_9                 9.255038e-02 1 1  ON 19
 eO_0                -7.304567e-01 1 1  ON 20
 eO_1                -4.238773e-01 1 1  ON 21
 eO_2                -3.823280e-02 1 1  ON 22
 eO_3                 1.951447e-01 1 1  ON 23
 eO_4                 2.772292e-01 1 1  ON 24
 eO_5                 3.042422e-01 1 1  ON 25
 eO_6                 2.489278e-01 1 1  ON 26
 eO_7                 1.104809e-01 1 1  ON 27
 eO_8                 2.772372e-02 1 1  ON 28
 eO_9                 1.832715e-02 1 1  ON 29
eH1_0                -1.792584e-01 1 1  ON 30
eH1_1                -1.010438e-01 1 1  ON 31
eH1_2                -6.216428e-02 1 1  ON 32
eH1_3                -2.653657e-02 1 1  ON 33
eH1_4                 1.925681e-02 1 1  ON 34
eH1_5                 3.327884e-02 1 1  ON 35
eH1_6                 7.689935e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980150e-02 1 1  ON 38
eH1_9                 2.403541e-02 1 1  ON 39
eH2_0                -1.814282e-01 1 1  ON 40
eH2_1                -1.026922e-01 1 1  ON 41
eH2_2                -6.368409e-02 1 1  ON 42
eH2_3                -2.776412e-02 1 1  ON 43
eH2_4                 1.810887e-02 1 1  ON 44
eH2_5                 3.402517e-02 1 1  ON 45
eH2_6                 7.850034e-02 1 1  ON 46
eH2_7                 1.138562e-01 1 1  ON 47
eH2_8                 9.285883e-02 1 1  ON 48
eH2_9                 2.615485e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1725
    reference variance = 0.205676
====================================================
  Execution time = 3.1597e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3474e-01
  Total weights = 2.0000e+06
  Execution time = 2.8895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334800618011
                                         uncertainty =       0.016270080029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334800618011
                                         uncertainty =       0.016270080029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409110012
  error estimate for blocks of size 2^( 2) =       0.000418768293
  error estimate for blocks of size 2^( 3) =       0.000427172486
  error estimate for blocks of size 2^( 4) =       0.000434052744
  error estimate for blocks of size 2^( 5) =       0.000438189718
  error estimate for blocks of size 2^( 6) =       0.000440579626
  error estimate for blocks of size 2^( 7) =       0.000441528029

      target function =                  N/A
              le_mean =     -17.216008909359
             les_mean =     296.725704602774
             stat err =       0.000438587529
             autocorr =       1.149297184742
              std dev =       0.578568926775
             le_variance =       0.334742003029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334801125493
                                         uncertainty =       0.016270149343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334801125493
                                         uncertainty =       0.016270149343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409110321
  error estimate for blocks of size 2^( 2) =       0.000418768583
  error estimate for blocks of size 2^( 3) =       0.000427172744
  error estimate for blocks of size 2^( 4) =       0.000434052988
  error estimate for blocks of size 2^( 5) =       0.000438189958
  error estimate for blocks of size 2^( 6) =       0.000440579864
  error estimate for blocks of size 2^( 7) =       0.000441528254

      target function =                  N/A
              le_mean =     -17.216008908148
             les_mean =     296.725705068177
             stat err =       0.000438587766
             autocorr =       1.149296685163
              std dev =       0.578569365006
             le_variance =       0.334742510123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334800871751
                                         uncertainty =       0.016270114695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334800871751
                                         uncertainty =       0.016270114695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409110166
  error estimate for blocks of size 2^( 2) =       0.000418768438
  error estimate for blocks of size 2^( 3) =       0.000427172615
  error estimate for blocks of size 2^( 4) =       0.000434052866
  error estimate for blocks of size 2^( 5) =       0.000438189838
  error estimate for blocks of size 2^( 6) =       0.000440579745
  error estimate for blocks of size 2^( 7) =       0.000441528142

      target function =                  N/A
              le_mean =     -17.216008908753
             les_mean =     296.725704835469
             stat err =       0.000438587648
             autocorr =       1.149296934943
              std dev =       0.578569145889
             le_variance =       0.334742256575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334800649728
                                         uncertainty =       0.016270084362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334800649728
                                         uncertainty =       0.016270084362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409110031
  error estimate for blocks of size 2^( 2) =       0.000418768312
  error estimate for blocks of size 2^( 3) =       0.000427172502
  error estimate for blocks of size 2^( 4) =       0.000434052760
  error estimate for blocks of size 2^( 5) =       0.000438189733
  error estimate for blocks of size 2^( 6) =       0.000440579641
  error estimate for blocks of size 2^( 7) =       0.000441528043

      target function =                  N/A
              le_mean =     -17.216008909283
             les_mean =     296.725704631860
             stat err =       0.000438587544
             autocorr =       1.149297153517
              std dev =       0.578568954164
             le_variance =       0.334742034722


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216008909359        initial  <--
     5.6843e+02     5.6843e+03             2.3369e-06       -17.216008908148
     2.2737e+03     2.2737e+04             5.8430e-07       -17.216008908753
     9.0949e+03     9.0949e+04             1.4608e-07       -17.216008909283

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.1969
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.028865e-01 1 1  ON 0
 uu_1                 4.341226e-02 1 1  ON 1
 uu_2                -4.815379e-02 1 1  ON 2
 uu_3                -9.957681e-02 1 1  ON 3
 uu_4                -1.295071e-01 1 1  ON 4
 uu_5                -1.341431e-01 1 1  ON 5
 uu_6                -1.112603e-01 1 1  ON 6
 uu_7                -3.671392e-02 1 1  ON 7
 uu_8                 1.013742e-01 1 1  ON 8
 uu_9                 1.199991e-01 1 1  ON 9
 ud_0                 3.409141e-01 1 1  ON 10
 ud_1                 8.679005e-02 1 1  ON 11
 ud_2                -1.577149e-02 1 1  ON 12
 ud_3                -7.113979e-02 1 1  ON 13
 ud_4                -1.166522e-01 1 1  ON 14
 ud_5                -1.495871e-01 1 1  ON 15
 ud_6                -1.552919e-01 1 1  ON 16
 ud_7                -1.100750e-01 1 1  ON 17
 ud_8                 6.790927e-03 1 1  ON 18
 ud_9                 9.255039e-02 1 1  ON 19
 eO_0                -7.304561e-01 1 1  ON 20
 eO_1                -4.238770e-01 1 1  ON 21
 eO_2                -3.823282e-02 1 1  ON 22
 eO_3                 1.951443e-01 1 1  ON 23
 eO_4                 2.772289e-01 1 1  ON 24
 eO_5                 3.042422e-01 1 1  ON 25
 eO_6                 2.489277e-01 1 1  ON 26
 eO_7                 1.104808e-01 1 1  ON 27
 eO_8                 2.772371e-02 1 1  ON 28
 eO_9                 1.832715e-02 1 1  ON 29
eH1_0                -1.792584e-01 1 1  ON 30
eH1_1                -1.010438e-01 1 1  ON 31
eH1_2                -6.216424e-02 1 1  ON 32
eH1_3                -2.653657e-02 1 1  ON 33
eH1_4                 1.925680e-02 1 1  ON 34
eH1_5                 3.327877e-02 1 1  ON 35
eH1_6                 7.689937e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980147e-02 1 1  ON 38
eH1_9                 2.403540e-02 1 1  ON 39
eH2_0                -1.814281e-01 1 1  ON 40
eH2_1                -1.026921e-01 1 1  ON 41
eH2_2                -6.368410e-02 1 1  ON 42
eH2_3                -2.776411e-02 1 1  ON 43
eH2_4                 1.810884e-02 1 1  ON 44
eH2_5                 3.402513e-02 1 1  ON 45
eH2_6                 7.850032e-02 1 1  ON 46
eH2_7                 1.138562e-01 1 1  ON 47
eH2_8                 9.285880e-02 1 1  ON 48
eH2_9                 2.615484e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.8193e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1781
    reference variance = 0.334375
====================================================
  Execution time = 3.2172e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1683e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.5522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316836115071
                                         uncertainty =       0.003408751708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316836115071
                                         uncertainty =       0.003408751708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398011366
  error estimate for blocks of size 2^( 2) =       0.000407994408
  error estimate for blocks of size 2^( 3) =       0.000416787149
  error estimate for blocks of size 2^( 4) =       0.000422196583
  error estimate for blocks of size 2^( 5) =       0.000426377399
  error estimate for blocks of size 2^( 6) =       0.000429112892
  error estimate for blocks of size 2^( 7) =       0.000428443274

      target function =                  N/A
              le_mean =     -17.216829724036
             les_mean =     296.736051683416
             stat err =       0.000426532537
             autocorr =       1.148453411892
              std dev =       0.562873072163
             le_variance =       0.316826095366


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682972404e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216829724036       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216829724230       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216829724639       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216829725008       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216829725089       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216829725012       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216829725019       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216829725022       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+03 is 2.306956e-07

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216829724036       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216829724085       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216829724187       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216829724280       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216829724292       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216829724290       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216829724276       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216829724296       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 5.767450e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216829724036       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216829724049       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216829724074       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216829724085       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216829724118       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216829724173       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216829724123       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216829724088       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 1.441866e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.325396 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.0731e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.028865e-01 1 1  ON 0
 uu_1                 4.341227e-02 1 1  ON 1
 uu_2                -4.815379e-02 1 1  ON 2
 uu_3                -9.957681e-02 1 1  ON 3
 uu_4                -1.295071e-01 1 1  ON 4
 uu_5                -1.341431e-01 1 1  ON 5
 uu_6                -1.112603e-01 1 1  ON 6
 uu_7                -3.671393e-02 1 1  ON 7
 uu_8                 1.013742e-01 1 1  ON 8
 uu_9                 1.199991e-01 1 1  ON 9
 ud_0                 3.409141e-01 1 1  ON 10
 ud_1                 8.679006e-02 1 1  ON 11
 ud_2                -1.577149e-02 1 1  ON 12
 ud_3                -7.113980e-02 1 1  ON 13
 ud_4                -1.166522e-01 1 1  ON 14
 ud_5                -1.495871e-01 1 1  ON 15
 ud_6                -1.552919e-01 1 1  ON 16
 ud_7                -1.100750e-01 1 1  ON 17
 ud_8                 6.790921e-03 1 1  ON 18
 ud_9                 9.255039e-02 1 1  ON 19
 eO_0                -7.304562e-01 1 1  ON 20
 eO_1                -4.238771e-01 1 1  ON 21
 eO_2                -3.823281e-02 1 1  ON 22
 eO_3                 1.951443e-01 1 1  ON 23
 eO_4                 2.772289e-01 1 1  ON 24
 eO_5                 3.042422e-01 1 1  ON 25
 eO_6                 2.489277e-01 1 1  ON 26
 eO_7                 1.104808e-01 1 1  ON 27
 eO_8                 2.772371e-02 1 1  ON 28
 eO_9                 1.832715e-02 1 1  ON 29
eH1_0                -1.792584e-01 1 1  ON 30
eH1_1                -1.010438e-01 1 1  ON 31
eH1_2                -6.216424e-02 1 1  ON 32
eH1_3                -2.653657e-02 1 1  ON 33
eH1_4                 1.925680e-02 1 1  ON 34
eH1_5                 3.327878e-02 1 1  ON 35
eH1_6                 7.689938e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980147e-02 1 1  ON 38
eH1_9                 2.403540e-02 1 1  ON 39
eH2_0                -1.814281e-01 1 1  ON 40
eH2_1                -1.026921e-01 1 1  ON 41
eH2_2                -6.368409e-02 1 1  ON 42
eH2_3                -2.776411e-02 1 1  ON 43
eH2_4                 1.810884e-02 1 1  ON 44
eH2_5                 3.402513e-02 1 1  ON 45
eH2_6                 7.850032e-02 1 1  ON 46
eH2_7                 1.138562e-01 1 1  ON 47
eH2_8                 9.285881e-02 1 1  ON 48
eH2_9                 2.615484e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1873
    reference variance = 0.204043
====================================================
  Execution time = 3.1651e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2107e-01
  Total weights = 2.0000e+06
  Execution time = 2.8889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321098704155
                                         uncertainty =       0.004538263685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321098704155
                                         uncertainty =       0.004538263685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400665202
  error estimate for blocks of size 2^( 2) =       0.000410521930
  error estimate for blocks of size 2^( 3) =       0.000419693347
  error estimate for blocks of size 2^( 4) =       0.000426130382
  error estimate for blocks of size 2^( 5) =       0.000430082544
  error estimate for blocks of size 2^( 6) =       0.000432174169
  error estimate for blocks of size 2^( 7) =       0.000433652916

      target function =                  N/A
              le_mean =     -17.216724880666
             les_mean =     296.736680663560
             stat err =       0.000430510003
             autocorr =       1.154524738119
              std dev =       0.566626162084
             le_variance =       0.321065207558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321098750939
                                         uncertainty =       0.004538264309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321098750939
                                         uncertainty =       0.004538264309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400665231
  error estimate for blocks of size 2^( 2) =       0.000410521957
  error estimate for blocks of size 2^( 3) =       0.000419693372
  error estimate for blocks of size 2^( 4) =       0.000426130405
  error estimate for blocks of size 2^( 5) =       0.000430082565
  error estimate for blocks of size 2^( 6) =       0.000432174190
  error estimate for blocks of size 2^( 7) =       0.000433652938

      target function =                  N/A
              le_mean =     -17.216724880198
             les_mean =     296.736680694230
             stat err =       0.000430510025
             autocorr =       1.154524688711
              std dev =       0.566626203347
             le_variance =       0.321065254319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321098727547
                                         uncertainty =       0.004538263997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321098727547
                                         uncertainty =       0.004538263997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400665216
  error estimate for blocks of size 2^( 2) =       0.000410521944
  error estimate for blocks of size 2^( 3) =       0.000419693360
  error estimate for blocks of size 2^( 4) =       0.000426130393
  error estimate for blocks of size 2^( 5) =       0.000430082554
  error estimate for blocks of size 2^( 6) =       0.000432174179
  error estimate for blocks of size 2^( 7) =       0.000433652927

      target function =                  N/A
              le_mean =     -17.216724880432
             les_mean =     296.736680678895
             stat err =       0.000430510014
             autocorr =       1.154524713415
              std dev =       0.566626182715
             le_variance =       0.321065230939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321098707079
                                         uncertainty =       0.004538263724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321098707079
                                         uncertainty =       0.004538263724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400665203
  error estimate for blocks of size 2^( 2) =       0.000410521932
  error estimate for blocks of size 2^( 3) =       0.000419693349
  error estimate for blocks of size 2^( 4) =       0.000426130383
  error estimate for blocks of size 2^( 5) =       0.000430082545
  error estimate for blocks of size 2^( 6) =       0.000432174170
  error estimate for blocks of size 2^( 7) =       0.000433652918

      target function =                  N/A
              le_mean =     -17.216724880637
             les_mean =     296.736680665477
             stat err =       0.000430510004
             autocorr =       1.154524735026
              std dev =       0.566626164663
             le_variance =       0.321065210480


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216724880666        initial  <--
     5.6843e+03     5.6843e+04             2.3070e-07       -17.216724880198
     2.2737e+04     2.2737e+05             5.7674e-08       -17.216724880432
     9.0949e+04     9.0949e+05             1.4419e-08       -17.216724880637

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.2604
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.028865e-01 1 1  ON 0
 uu_1                 4.341226e-02 1 1  ON 1
 uu_2                -4.815379e-02 1 1  ON 2
 uu_3                -9.957681e-02 1 1  ON 3
 uu_4                -1.295071e-01 1 1  ON 4
 uu_5                -1.341431e-01 1 1  ON 5
 uu_6                -1.112603e-01 1 1  ON 6
 uu_7                -3.671392e-02 1 1  ON 7
 uu_8                 1.013742e-01 1 1  ON 8
 uu_9                 1.199991e-01 1 1  ON 9
 ud_0                 3.409141e-01 1 1  ON 10
 ud_1                 8.679005e-02 1 1  ON 11
 ud_2                -1.577149e-02 1 1  ON 12
 ud_3                -7.113979e-02 1 1  ON 13
 ud_4                -1.166522e-01 1 1  ON 14
 ud_5                -1.495871e-01 1 1  ON 15
 ud_6                -1.552919e-01 1 1  ON 16
 ud_7                -1.100750e-01 1 1  ON 17
 ud_8                 6.790927e-03 1 1  ON 18
 ud_9                 9.255039e-02 1 1  ON 19
 eO_0                -7.304561e-01 1 1  ON 20
 eO_1                -4.238770e-01 1 1  ON 21
 eO_2                -3.823282e-02 1 1  ON 22
 eO_3                 1.951443e-01 1 1  ON 23
 eO_4                 2.772289e-01 1 1  ON 24
 eO_5                 3.042422e-01 1 1  ON 25
 eO_6                 2.489277e-01 1 1  ON 26
 eO_7                 1.104808e-01 1 1  ON 27
 eO_8                 2.772371e-02 1 1  ON 28
 eO_9                 1.832715e-02 1 1  ON 29
eH1_0                -1.792584e-01 1 1  ON 30
eH1_1                -1.010438e-01 1 1  ON 31
eH1_2                -6.216424e-02 1 1  ON 32
eH1_3                -2.653657e-02 1 1  ON 33
eH1_4                 1.925680e-02 1 1  ON 34
eH1_5                 3.327877e-02 1 1  ON 35
eH1_6                 7.689937e-02 1 1  ON 36
eH1_7                 1.105349e-01 1 1  ON 37
eH1_8                 8.980147e-02 1 1  ON 38
eH1_9                 2.403540e-02 1 1  ON 39
eH2_0                -1.814281e-01 1 1  ON 40
eH2_1                -1.026921e-01 1 1  ON 41
eH2_2                -6.368410e-02 1 1  ON 42
eH2_3                -2.776411e-02 1 1  ON 43
eH2_4                 1.810884e-02 1 1  ON 44
eH2_5                 3.402513e-02 1 1  ON 45
eH2_6                 7.850032e-02 1 1  ON 46
eH2_7                 1.138562e-01 1 1  ON 47
eH2_8                 9.285880e-02 1 1  ON 48
eH2_9                 2.615484e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.6995e+01 secs
  Total Execution time = 3.4683e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
