Rank =    0  Free Memory = 89988 MB
Rank =    1  Free Memory = 89988 MB
Rank =    2  Free Memory = 89988 MB
Rank =    3  Free Memory = 89987 MB
Rank =    4  Free Memory = 89987 MB
Rank =    5  Free Memory = 89987 MB
Rank =    6  Free Memory = 89987 MB
Rank =    7  Free Memory = 89986 MB
Rank =    8  Free Memory = 89986 MB
Rank =    9  Free Memory = 89986 MB
Rank =   10  Free Memory = 89986 MB
Rank =   11  Free Memory = 89986 MB
Rank =   12  Free Memory = 89986 MB
Rank =   13  Free Memory = 89986 MB
Rank =   14  Free Memory = 89986 MB
Rank =   15  Free Memory = 89972 MB
Rank =   16  Free Memory = 89972 MB
Rank =   17  Free Memory = 89972 MB
Rank =   18  Free Memory = 89972 MB
Rank =   19  Free Memory = 89972 MB
Rank =   20  Free Memory = 89972 MB
Rank =   21  Free Memory = 89972 MB
Rank =   22  Free Memory = 89972 MB
Rank =   23  Free Memory = 89972 MB
Rank =   24  Free Memory = 89972 MB
Rank =   25  Free Memory = 89972 MB
Rank =   26  Free Memory = 89972 MB
Rank =   27  Free Memory = 89972 MB
Rank =   28  Free Memory = 89972 MB
Rank =   29  Free Memory = 89972 MB
Rank =   30  Free Memory = 89972 MB
Rank =   31  Free Memory = 89972 MB
Rank =   32  Free Memory = 87640 MB
Rank =   33  Free Memory = 87640 MB
Rank =   34  Free Memory = 87640 MB
Rank =   35  Free Memory = 87640 MB
Rank =   36  Free Memory = 87640 MB
Rank =   37  Free Memory = 87640 MB
Rank =   38  Free Memory = 87640 MB
Rank =   39  Free Memory = 87640 MB
Rank =   40  Free Memory = 87640 MB
Rank =   41  Free Memory = 87640 MB
Rank =   42  Free Memory = 87640 MB
Rank =   43  Free Memory = 87640 MB
Rank =   44  Free Memory = 87640 MB
Rank =   45  Free Memory = 87640 MB
Rank =   46  Free Memory = 87640 MB
Rank =   47  Free Memory = 87640 MB
Rank =   48  Free Memory = 87640 MB
Rank =   49  Free Memory = 87640 MB
Rank =   50  Free Memory = 87640 MB
Rank =   51  Free Memory = 87640 MB
Rank =   52  Free Memory = 87640 MB
Rank =   53  Free Memory = 87640 MB
Rank =   54  Free Memory = 87640 MB
Rank =   55  Free Memory = 87640 MB
Rank =   56  Free Memory = 87640 MB
Rank =   57  Free Memory = 87640 MB
Rank =   58  Free Memory = 87640 MB
Rank =   59  Free Memory = 87640 MB
Rank =   60  Free Memory = 87640 MB
Rank =   61  Free Memory = 87640 MB
Rank =   62  Free Memory = 87640 MB
Rank =   63  Free Memory = 87640 MB
Rank =   64  Free Memory = 90380 MB
Rank =   65  Free Memory = 90379 MB
Rank =   66  Free Memory = 90379 MB
Rank =   67  Free Memory = 90379 MB
Rank =   68  Free Memory = 90379 MB
Rank =   69  Free Memory = 90379 MB
Rank =   70  Free Memory = 90379 MB
Rank =   71  Free Memory = 90379 MB
Rank =   72  Free Memory = 90379 MB
Rank =   73  Free Memory = 90379 MB
Rank =   74  Free Memory = 90379 MB
Rank =   75  Free Memory = 90379 MB
Rank =   76  Free Memory = 90379 MB
Rank =   77  Free Memory = 90379 MB
Rank =   78  Free Memory = 90379 MB
Rank =   79  Free Memory = 90379 MB
Rank =   80  Free Memory = 90379 MB
Rank =   81  Free Memory = 90379 MB
Rank =   82  Free Memory = 90379 MB
Rank =   83  Free Memory = 90379 MB
Rank =   84  Free Memory = 90379 MB
Rank =   85  Free Memory = 90379 MB
Rank =   86  Free Memory = 90379 MB
Rank =   87  Free Memory = 90379 MB
Rank =   88  Free Memory = 90379 MB
Rank =   89  Free Memory = 90379 MB
Rank =   90  Free Memory = 90379 MB
Rank =   91  Free Memory = 90379 MB
Rank =   92  Free Memory = 90379 MB
Rank =   93  Free Memory = 90379 MB
Rank =   94  Free Memory = 90379 MB
Rank =   95  Free Memory = 90379 MB
Rank =   96  Free Memory = 86585 MB
Rank =   97  Free Memory = 86584 MB
Rank =   98  Free Memory = 86584 MB
Rank =   99  Free Memory = 86584 MB
Rank =  100  Free Memory = 86584 MB
Rank =  101  Free Memory = 86584 MB
Rank =  102  Free Memory = 86584 MB
Rank =  103  Free Memory = 86584 MB
Rank =  104  Free Memory = 86584 MB
Rank =  105  Free Memory = 86584 MB
Rank =  106  Free Memory = 86584 MB
Rank =  107  Free Memory = 86584 MB
Rank =  108  Free Memory = 86584 MB
Rank =  109  Free Memory = 86584 MB
Rank =  110  Free Memory = 86584 MB
Rank =  111  Free Memory = 86584 MB
Rank =  112  Free Memory = 86584 MB
Rank =  113  Free Memory = 86584 MB
Rank =  114  Free Memory = 86584 MB
Rank =  115  Free Memory = 86584 MB
Rank =  116  Free Memory = 86584 MB
Rank =  117  Free Memory = 86584 MB
Rank =  118  Free Memory = 86584 MB
Rank =  119  Free Memory = 86584 MB
Rank =  120  Free Memory = 86584 MB
Rank =  121  Free Memory = 86584 MB
Rank =  122  Free Memory = 86584 MB
Rank =  123  Free Memory = 86584 MB
Rank =  124  Free Memory = 86584 MB
Rank =  125  Free Memory = 86584 MB
Rank =  126  Free Memory = 86584 MB
Rank =  127  Free Memory = 86584 MB
  Input file(s): opt_h2o_gs_tett_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_tett_run001f.xml

  Project = H2O
  date    = 2023-03-10 23:44:50 PST
  host    = n0059.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 370

  Range of prime numbers to use as seeds over processors and threads = 2543-3571


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.977335e-01    1         1  ON     0
     uu_1                 4.330275e-02    1         1  ON     1
     uu_2                -4.189267e-02    1         1  ON     2
     uu_3                -9.235608e-02    1         1  ON     3
     uu_4                -1.237610e-01    1         1  ON     4
     uu_5                -1.319011e-01    1         1  ON     5
     uu_6                -1.107245e-01    1         1  ON     6
     uu_7                -4.250637e-02    1         1  ON     7
     uu_8                 8.649074e-02    1         1  ON     8
     uu_9                 1.220586e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.027539e-01    1         1  ON     0
     ud_1                 7.594091e-02    1         1  ON     1
     ud_2                -1.844949e-02    1         1  ON     2
     ud_3                -6.887856e-02    1         1  ON     3
     ud_4                -1.085322e-01    1         1  ON     4
     ud_5                -1.357271e-01    1         1  ON     5
     ud_6                -1.369140e-01    1         1  ON     6
     ud_7                -9.606118e-02    1         1  ON     7
     ud_8                 1.393232e-03    1         1  ON     8
     ud_9                 9.066699e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.845925e-01    1         1  ON     0
     eO_1                -4.098450e-01    1         1  ON     1
     eO_2                -4.963899e-02    1         1  ON     2
     eO_3                 1.714430e-01    1         1  ON     3
     eO_4                 2.548074e-01    1         1  ON     4
     eO_5                 2.930546e-01    1         1  ON     5
     eO_6                 2.514179e-01    1         1  ON     6
     eO_7                 1.164920e-01    1         1  ON     7
     eO_8                 2.796077e-02    1         1  ON     8
     eO_9                 1.837741e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.951983e-01    1         1  ON     0
     eH1_1                -9.632854e-02    1         1  ON     1
     eH1_2                -4.928336e-02    1         1  ON     2
     eH1_3                -1.897920e-02    1         1  ON     3
     eH1_4                 1.663156e-02    1         1  ON     4
     eH1_5                 2.420856e-02    1         1  ON     5
     eH1_6                 7.670269e-02    1         1  ON     6
     eH1_7                 1.107286e-01    1         1  ON     7
     eH1_8                 9.201372e-02    1         1  ON     8
     eH1_9                 2.427304e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.961719e-01    1         1  ON     0
     eH2_1                -9.716667e-02    1         1  ON     1
     eH2_2                -5.030255e-02    1         1  ON     2
     eH2_3                -2.015281e-02    1         1  ON     3
     eH2_4                 1.553497e-02    1         1  ON     4
     eH2_5                 2.428197e-02    1         1  ON     5
     eH2_6                 7.651160e-02    1         1  ON     6
     eH2_7                 1.129216e-01    1         1  ON     7
     eH2_8                 9.607113e-02    1         1  ON     8
     eH2_9                 2.646776e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.697866e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.2096e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1749
    reference variance = 0.22921
====================================================
  Execution time = 3.8054e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8074e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280688879082
                                         uncertainty =       0.003886121971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280688879082
                                         uncertainty =       0.003886121971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374657769
  error estimate for blocks of size 2^( 2) =       0.000388570120
  error estimate for blocks of size 2^( 3) =       0.000401275518
  error estimate for blocks of size 2^( 4) =       0.000410008304
  error estimate for blocks of size 2^( 5) =       0.000415219457
  error estimate for blocks of size 2^( 6) =       0.000418556109
  error estimate for blocks of size 2^( 7) =       0.000421171794

      target function =      -0.943350484950
              le_mean =     -17.212212548102
             les_mean =     296.540997549119
             stat err =       0.000416238916
             autocorr =       1.234286210210
   target nu stat err =       0.000416238916
   target dn stat err =       0.003264247742
      target stat err =       0.005670700390
              std dev =       0.529846098832
             le_variance =       0.280736888447


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721221254810e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943383594327       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943450881204       residual = 7.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943476471742       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943491726880       residual = 6.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943511393345       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943523303599       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943527251843       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943530917976       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943533995387       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943537291108       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943539786789       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943541155935       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943543375572       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943544018540       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943543934402       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943544129972       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943545549136       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943545632633       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943545511258       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943545832567       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943545702203       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943545793748       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943545894051       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943545927570       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943545987933       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.194088e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943383594327       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943403961616       residual = 7.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943412440571       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943416337450       residual = 6.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943421894269       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943425689059       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943426813515       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943427884052       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943428822443       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943429781204       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943430435463       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943430691624       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943431389446       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943431556952       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943431473495       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943431516769       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943431854217       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943431860235       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943431821290       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943431896986       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943431874487       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943431887149       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943431908580       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943431913125       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.586860e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943383594327       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943388969356       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943391267144       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943392239331       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943393675006       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943394691005       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943394981715       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943395261153       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943395508040       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943395757741       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943395921670       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943395986003       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943396164708       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943396207175       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943396180890       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943396191754       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943396274494       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943396274836       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943396265093       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943396283298       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943396278211       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943396280884       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943396285960       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943396286893       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.407243e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118374 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8167e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.980487e-01                 1 1 ON  0
uu_1  4.356845e-02                 1 1 ON  1
uu_2  -4.172218e-02                1 1 ON  2
uu_3  -9.231217e-02                1 1 ON  3
uu_4  -1.237073e-01                1 1 ON  4
uu_5  -1.319303e-01                1 1 ON  5
uu_6  -1.108176e-01                1 1 ON  6
uu_7  -4.285074e-02                1 1 ON  7
uu_8  8.593206e-02                 1 1 ON  8
uu_9  1.221184e-01                 1 1 ON  9
ud_0  3.025490e-01                 1 1 ON  10
ud_1  7.586449e-02                 1 1 ON  11
ud_2  -1.866274e-02                1 1 ON  12
ud_3  -6.908706e-02                1 1 ON  13
ud_4  -1.085368e-01                1 1 ON  14
ud_5  -1.353790e-01                1 1 ON  15
ud_6  -1.365236e-01                1 1 ON  16
ud_7  -9.583226e-02                1 1 ON  17
ud_8  1.101542e-03                 1 1 ON  18
ud_9  9.052208e-02                 1 1 ON  19
eO_0  -6.847943e-01                1 1 ON  20
eO_1  -4.099742e-01                1 1 ON  21
eO_2  -4.937154e-02                1 1 ON  22
eO_3  1.715816e-01                 1 1 ON  23
eO_4  2.546922e-01                 1 1 ON  24
eO_5  2.927702e-01                 1 1 ON  25
eO_6  2.515175e-01                 1 1 ON  26
eO_7  1.167087e-01                 1 1 ON  27
eO_8  2.795959e-02                 1 1 ON  28
eO_9  1.837482e-02                 1 1 ON  29
eH1_0 -1.954663e-01                1 1 ON  30
eH1_1 -9.608971e-02                1 1 ON  31
eH1_2 -4.890993e-02                1 1 ON  32
eH1_3 -1.874566e-02                1 1 ON  33
eH1_4 1.665483e-02                 1 1 ON  34
eH1_5 2.394323e-02                 1 1 ON  35
eH1_6 7.631361e-02                 1 1 ON  36
eH1_7 1.106310e-01                 1 1 ON  37
eH1_8 9.212756e-02                 1 1 ON  38
eH1_9 2.430626e-02                 1 1 ON  39
eH2_0 -1.964730e-01                1 1 ON  40
eH2_1 -9.702961e-02                1 1 ON  41
eH2_2 -5.006274e-02                1 1 ON  42
eH2_3 -2.004952e-02                1 1 ON  43
eH2_4 1.546776e-02                 1 1 ON  44
eH2_5 2.419380e-02                 1 1 ON  45
eH2_6 7.646594e-02                 1 1 ON  46
eH2_7 1.127941e-01                 1 1 ON  47
eH2_8 9.619237e-02                 1 1 ON  48
eH2_9 2.650487e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2353
    reference variance = 0.159699
====================================================
  Execution time = 3.6591e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8360e-01
  Total weights = 2.0000e+06
  Execution time = 3.3775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283465136184
                                         uncertainty =       0.003972632584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283465136184
                                         uncertainty =       0.003972632584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376548055
  error estimate for blocks of size 2^( 2) =       0.000389890248
  error estimate for blocks of size 2^( 3) =       0.000402696821
  error estimate for blocks of size 2^( 4) =       0.000411697426
  error estimate for blocks of size 2^( 5) =       0.000416528039
  error estimate for blocks of size 2^( 6) =       0.000418677867
  error estimate for blocks of size 2^( 7) =       0.000419831167

      target function =      -0.938456300077
              le_mean =     -17.212600864306
             les_mean =     296.557205246926
             stat err =       0.000416683625
             autocorr =       1.224537390788
   target nu stat err =       0.000416683625
   target dn stat err =       0.003692235497
      target stat err =       0.006340761255
              std dev =       0.532519365656
             le_variance =       0.283576874798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283551953969
                                         uncertainty =       0.003973750496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283551953969
                                         uncertainty =       0.003973750496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376605203
  error estimate for blocks of size 2^( 2) =       0.000389960016
  error estimate for blocks of size 2^( 3) =       0.000402795262
  error estimate for blocks of size 2^( 4) =       0.000411828765
  error estimate for blocks of size 2^( 5) =       0.000416683440
  error estimate for blocks of size 2^( 6) =       0.000418825923
  error estimate for blocks of size 2^( 7) =       0.000419967782

      target function =      -0.938309115227
              le_mean =     -17.212608393213
             les_mean =     296.557550514440
             stat err =       0.000416826478
             autocorr =       1.225005291383
   target nu stat err =       0.000416826478
   target dn stat err =       0.003693293870
      target stat err =       0.006340701240
              std dev =       0.532600186025
             le_variance =       0.283662958154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283513482593
                                         uncertainty =       0.003973351842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283513482593
                                         uncertainty =       0.003973351842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376579847
  error estimate for blocks of size 2^( 2) =       0.000389928499
  error estimate for blocks of size 2^( 3) =       0.000402750942
  error estimate for blocks of size 2^( 4) =       0.000411770161
  error estimate for blocks of size 2^( 5) =       0.000416614439
  error estimate for blocks of size 2^( 6) =       0.000418760162
  error estimate for blocks of size 2^( 7) =       0.000419905823

      target function =      -0.938374457207
              le_mean =     -17.212604312053
             les_mean =     296.557371823517
             stat err =       0.000416762646
             autocorr =       1.224795058571
   target nu stat err =       0.000416762646
   target dn stat err =       0.003692889796
      target stat err =       0.006340830183
              std dev =       0.532564326664
             le_variance =       0.283624762035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283470687711
                                         uncertainty =       0.003972727730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283470687711
                                         uncertainty =       0.003972727730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376551700
  error estimate for blocks of size 2^( 2) =       0.000389894646
  error estimate for blocks of size 2^( 3) =       0.000402703209
  error estimate for blocks of size 2^( 4) =       0.000411706189
  error estimate for blocks of size 2^( 5) =       0.000416538556
  error estimate for blocks of size 2^( 6) =       0.000418687847
  error estimate for blocks of size 2^( 7) =       0.000419840107

      target function =      -0.938446922074
              le_mean =     -17.212601144007
             les_mean =     296.557220366062
             stat err =       0.000416693175
             autocorr =       1.224569813188
   target nu stat err =       0.000416693175
   target dn stat err =       0.003692320973
      target stat err =       0.006340785640
              std dev =       0.532524520740
             le_variance =       0.283582365190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938456300077        initial  <--
     2.5000e-01     2.5000e+00             2.1941e-03        -0.938309115227
     1.0000e+00     1.0000e+01             5.5869e-04        -0.938374457207
     4.0000e+00     4.0000e+01             1.4072e-04        -0.938446922074

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.6306
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0180e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1992
    reference variance = 0.262527
====================================================
  Execution time = 3.7362e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9311e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293071850776
                                         uncertainty =       0.009065021424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293071850776
                                         uncertainty =       0.009065021424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382825649
  error estimate for blocks of size 2^( 2) =       0.000396241959
  error estimate for blocks of size 2^( 3) =       0.000408733957
  error estimate for blocks of size 2^( 4) =       0.000417537294
  error estimate for blocks of size 2^( 5) =       0.000422408835
  error estimate for blocks of size 2^( 6) =       0.000425325753
  error estimate for blocks of size 2^( 7) =       0.000427343325

      target function =      -0.922338155789
              le_mean =     -17.211902409123
             les_mean =     296.542695350006
             stat err =       0.000423153802
             autocorr =       1.221784014271
   target nu stat err =       0.000423153802
   target dn stat err =       0.009024367735
      target stat err =       0.014865158110
              std dev =       0.541397225139
             le_variance =       0.293110955388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721190240912e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922576007400       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922605005698       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922607942323       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922611558854       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922614443368       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922615894611       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922617420449       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922618185125       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922618517321       residual = 9.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922618959403       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922619199117       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922619477724       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922619987483       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922620187611       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922620255416       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922620329088       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922620349975       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922620353062       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922620372199       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922620377201       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922620381155       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922620387486       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922620387018       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922620396678       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.471914e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922576007400       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922583411673       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922584168413       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922585087713       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922585812650       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922586190461       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922586581673       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922586774801       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922586855550       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922586966478       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922587026617       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922587096107       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922587224232       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922587274124       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922587289712       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922587307787       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922587312625       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922587313244       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922587318083       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922587319241       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922587320286       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922587321786       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922587321617       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922587323955       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 6.290202e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922576007400       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922577868396       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922578059050       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922578289844       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922578471306       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922578566725       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922578665143       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922578713568       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922578733621       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922578761358       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.922578776403       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.922578793763       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.922578825836       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.922578838298       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.922578842110       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.922578846607       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.922578847792       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.922578847938       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.922578849151       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.922578849434       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.922578849699       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.922578850069       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.922578850024       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.922578850603       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 1.579627e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137114 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7349e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.977964e-01 1 1  ON 0
 uu_1                 4.334492e-02 1 1  ON 1
 uu_2                -4.187660e-02 1 1  ON 2
 uu_3                -9.235400e-02 1 1  ON 3
 uu_4                -1.237576e-01 1 1  ON 4
 uu_5                -1.319055e-01 1 1  ON 5
 uu_6                -1.107645e-01 1 1  ON 6
 uu_7                -4.255455e-02 1 1  ON 7
 uu_8                 8.643735e-02 1 1  ON 8
 uu_9                 1.220624e-01 1 1  ON 9
 ud_0                 3.027285e-01 1 1  ON 10
 ud_1                 7.593318e-02 1 1  ON 11
 ud_2                -1.847442e-02 1 1  ON 12
 ud_3                -6.890414e-02 1 1  ON 13
 ud_4                -1.085299e-01 1 1  ON 14
 ud_5                -1.356937e-01 1 1  ON 15
 ud_6                -1.368753e-01 1 1  ON 16
 ud_7                -9.601675e-02 1 1  ON 17
 ud_8                 1.356959e-03 1 1  ON 18
 ud_9                 9.065708e-02 1 1  ON 19
 eO_0                -6.846052e-01 1 1  ON 20
 eO_1                -4.098470e-01 1 1  ON 21
 eO_2                -4.960721e-02 1 1  ON 22
 eO_3                 1.714536e-01 1 1  ON 23
 eO_4                 2.547927e-01 1 1  ON 24
 eO_5                 2.930126e-01 1 1  ON 25
 eO_6                 2.514237e-01 1 1  ON 26
 eO_7                 1.165150e-01 1 1  ON 27
 eO_8                 2.796083e-02 1 1  ON 28
 eO_9                 1.837775e-02 1 1  ON 29
eH1_0                -1.952079e-01 1 1  ON 30
eH1_1                -9.629982e-02 1 1  ON 31
eH1_2                -4.923324e-02 1 1  ON 32
eH1_3                -1.894077e-02 1 1  ON 33
eH1_4                 1.662793e-02 1 1  ON 34
eH1_5                 2.416202e-02 1 1  ON 35
eH1_6                 7.664223e-02 1 1  ON 36
eH1_7                 1.107193e-01 1 1  ON 37
eH1_8                 9.202190e-02 1 1  ON 38
eH1_9                 2.427703e-02 1 1  ON 39
eH2_0                -1.962074e-01 1 1  ON 40
eH2_1                -9.714692e-02 1 1  ON 41
eH2_2                -5.027046e-02 1 1  ON 42
eH2_3                -2.014310e-02 1 1  ON 43
eH2_4                 1.552970e-02 1 1  ON 44
eH2_5                 2.427326e-02 1 1  ON 45
eH2_6                 7.649553e-02 1 1  ON 46
eH2_7                 1.129133e-01 1 1  ON 47
eH2_8                 9.608192e-02 1 1  ON 48
eH2_9                 2.646924e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.183
    reference variance = 0.172395
====================================================
  Execution time = 3.6626e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7835e-01
  Total weights = 2.0000e+06
  Execution time = 3.3756e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278360166298
                                         uncertainty =       0.002312165991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278360166298
                                         uncertainty =       0.002312165991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373053215
  error estimate for blocks of size 2^( 2) =       0.000386505016
  error estimate for blocks of size 2^( 3) =       0.000399105701
  error estimate for blocks of size 2^( 4) =       0.000408200230
  error estimate for blocks of size 2^( 5) =       0.000413610998
  error estimate for blocks of size 2^( 6) =       0.000417758033
  error estimate for blocks of size 2^( 7) =       0.000418027581

      target function =      -0.947539952478
              le_mean =     -17.211474593525
             les_mean =     296.513194947007
             stat err =       0.000414399211
             autocorr =       1.233946311620
   target nu stat err =       0.000414399211
   target dn stat err =       0.002496399905
      target stat err =       0.004395651759
              std dev =       0.527576916292
             le_variance =       0.278337402604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278410674435
                                         uncertainty =       0.002312717708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278410674435
                                         uncertainty =       0.002312717708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373087049
  error estimate for blocks of size 2^( 2) =       0.000386542301
  error estimate for blocks of size 2^( 3) =       0.000399147934
  error estimate for blocks of size 2^( 4) =       0.000408248193
  error estimate for blocks of size 2^( 5) =       0.000413663331
  error estimate for blocks of size 2^( 6) =       0.000417811553
  error estimate for blocks of size 2^( 7) =       0.000418083793

      target function =      -0.947452366535
              le_mean =     -17.211475154117
             les_mean =     296.513264733137
             stat err =       0.000414451717
             autocorr =       1.234035181193
   target nu stat err =       0.000414451717
   target dn stat err =       0.002497031199
      target stat err =       0.004395950927
              std dev =       0.527624763968
             le_variance =       0.278387891552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278385811934
                                         uncertainty =       0.002312447604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278385811934
                                         uncertainty =       0.002312447604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373070394
  error estimate for blocks of size 2^( 2) =       0.000386523928
  error estimate for blocks of size 2^( 3) =       0.000399127109
  error estimate for blocks of size 2^( 4) =       0.000408224538
  error estimate for blocks of size 2^( 5) =       0.000413637520
  error estimate for blocks of size 2^( 6) =       0.000417785153
  error estimate for blocks of size 2^( 7) =       0.000418056074

      target function =      -0.947495480098
              le_mean =     -17.211474833455
             les_mean =     296.513228841922
             stat err =       0.000414425821
             autocorr =       1.233991138540
   target nu stat err =       0.000414425821
   target dn stat err =       0.002496722524
      target stat err =       0.004395806854
              std dev =       0.527601211567
             le_variance =       0.278363038447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278363369943
                                         uncertainty =       0.002312201359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278363369943
                                         uncertainty =       0.002312201359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373055361
  error estimate for blocks of size 2^( 2) =       0.000386507377
  error estimate for blocks of size 2^( 3) =       0.000399108373
  error estimate for blocks of size 2^( 4) =       0.000408203265
  error estimate for blocks of size 2^( 5) =       0.000413614310
  error estimate for blocks of size 2^( 6) =       0.000417761419
  error estimate for blocks of size 2^( 7) =       0.000418031139

      target function =      -0.947534396950
              le_mean =     -17.211474618712
             les_mean =     296.513199016404
             stat err =       0.000414402533
             autocorr =       1.233951903283
   target nu stat err =       0.000414402533
   target dn stat err =       0.002496440433
      target stat err =       0.004395671483
              std dev =       0.527579951305
             le_variance =       0.278340605019


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947539952478        initial  <--
     2.5000e+00     2.5000e+01             2.4719e-04        -0.947452366535
     1.0000e+01     1.0000e+02             6.2902e-05        -0.947495480098
     4.0000e+01     4.0000e+02             1.5796e-05        -0.947534396950

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.6736
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0103e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2026
    reference variance = 0.17505
====================================================
  Execution time = 3.7316e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8032e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280376046656
                                         uncertainty =       0.002756790747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280376046656
                                         uncertainty =       0.002756790747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374378198
  error estimate for blocks of size 2^( 2) =       0.000388297783
  error estimate for blocks of size 2^( 3) =       0.000400903160
  error estimate for blocks of size 2^( 4) =       0.000409620277
  error estimate for blocks of size 2^( 5) =       0.000415869054
  error estimate for blocks of size 2^( 6) =       0.000420211389
  error estimate for blocks of size 2^( 7) =       0.000420988459

      target function =      -0.944101574998
              le_mean =     -17.211819266900
             les_mean =     296.527040406568
             stat err =       0.000416672295
             autocorr =       1.238705737659
   target nu stat err =       0.000416672295
   target dn stat err =       0.002584375665
      target stat err =       0.004517257604
              std dev =       0.529450725084
             le_variance =       0.280318070292


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721181926690e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944122085971       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944123335029       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944123805842       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944124115159       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944124338460       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944124531029       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944124678780       residual = 4.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944124864489       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944124921353       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944124955518       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944124983424       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944125000443       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944125014359       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944125021817       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944125022834       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944125026055       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944125034442       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944125043115       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944125045324       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944125048513       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944125047019       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944125046856       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944125048167       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944125048364       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.534278e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944122085971       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944122398962       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944122516995       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944122594472       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944122650375       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944122698587       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944122735605       residual = 4.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944122782107       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944122796352       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944122804895       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944122811879       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944122816133       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944122819608       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944122821469       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944122821722       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944122822525       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944122824626       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944122826784       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944122827338       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944122828131       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944122827755       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944122827718       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944122828044       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944122828093       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 6.344355e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944122085971       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944122164264       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944122193793       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944122213172       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944122227152       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944122239210       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944122248468       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944122260098       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944122263663       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944122265799       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944122267545       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944122268609       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944122269477       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944122269943       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944122270005       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944122270206       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944122270732       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944122271269       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944122271409       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944122271606       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944122271514       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944122271506       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944122271586       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944122271598       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+02 is 1.586631e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155719 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7230e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.977374e-01 1 1  ON 0
 uu_1                 4.330601e-02 1 1  ON 1
 uu_2                -4.189080e-02 1 1  ON 2
 uu_3                -9.235508e-02 1 1  ON 3
 uu_4                -1.237603e-01 1 1  ON 4
 uu_5                -1.319020e-01 1 1  ON 5
 uu_6                -1.107279e-01 1 1  ON 6
 uu_7                -4.251020e-02 1 1  ON 7
 uu_8                 8.648520e-02 1 1  ON 8
 uu_9                 1.220601e-01 1 1  ON 9
 ud_0                 3.027510e-01 1 1  ON 10
 ud_1                 7.593986e-02 1 1  ON 11
 ud_2                -1.845261e-02 1 1  ON 12
 ud_3                -6.888217e-02 1 1  ON 13
 ud_4                -1.085334e-01 1 1  ON 14
 ud_5                -1.357238e-01 1 1  ON 15
 ud_6                -1.369077e-01 1 1  ON 16
 ud_7                -9.605686e-02 1 1  ON 17
 ud_8                 1.389983e-03 1 1  ON 18
 ud_9                 9.066696e-02 1 1  ON 19
 eO_0                -6.845959e-01 1 1  ON 20
 eO_1                -4.098479e-01 1 1  ON 21
 eO_2                -4.963767e-02 1 1  ON 22
 eO_3                 1.714453e-01 1 1  ON 23
 eO_4                 2.548078e-01 1 1  ON 24
 eO_5                 2.930525e-01 1 1  ON 25
 eO_6                 2.514190e-01 1 1  ON 26
 eO_7                 1.164949e-01 1 1  ON 27
 eO_8                 2.796095e-02 1 1  ON 28
 eO_9                 1.837750e-02 1 1  ON 29
eH1_0                -1.952016e-01 1 1  ON 30
eH1_1                -9.632814e-02 1 1  ON 31
eH1_2                -4.927958e-02 1 1  ON 32
eH1_3                -1.897528e-02 1 1  ON 33
eH1_4                 1.663217e-02 1 1  ON 34
eH1_5                 2.420542e-02 1 1  ON 35
eH1_6                 7.669958e-02 1 1  ON 36
eH1_7                 1.107279e-01 1 1  ON 37
eH1_8                 9.201498e-02 1 1  ON 38
eH1_9                 2.427329e-02 1 1  ON 39
eH2_0                -1.961762e-01 1 1  ON 40
eH2_1                -9.716680e-02 1 1  ON 41
eH2_2                -5.029932e-02 1 1  ON 42
eH2_3                -2.015000e-02 1 1  ON 43
eH2_4                 1.553562e-02 1 1  ON 44
eH2_5                 2.428061e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129193e-01 1 1  ON 47
eH2_8                 9.607214e-02 1 1  ON 48
eH2_9                 2.646797e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.225
    reference variance = 0.298163
====================================================
  Execution time = 3.6893e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8483e-01
  Total weights = 2.0000e+06
  Execution time = 3.5002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284848377203
                                         uncertainty =       0.004575019143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284848377203
                                         uncertainty =       0.004575019143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377381969
  error estimate for blocks of size 2^( 2) =       0.000391316867
  error estimate for blocks of size 2^( 3) =       0.000403296766
  error estimate for blocks of size 2^( 4) =       0.000412007351
  error estimate for blocks of size 2^( 5) =       0.000417813350
  error estimate for blocks of size 2^( 6) =       0.000420948107
  error estimate for blocks of size 2^( 7) =       0.000423830421

      target function =      -0.936343983208
              le_mean =     -17.211741338257
             les_mean =     296.528874054247
             stat err =       0.000418649807
             autocorr =       1.230664003913
   target nu stat err =       0.000418649807
   target dn stat err =       0.004594387185
      target stat err =       0.007822398569
              std dev =       0.533698699272
             le_variance =       0.284834301604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284849607634
                                         uncertainty =       0.004575368350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284849607634
                                         uncertainty =       0.004575368350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377382788
  error estimate for blocks of size 2^( 2) =       0.000391317881
  error estimate for blocks of size 2^( 3) =       0.000403298145
  error estimate for blocks of size 2^( 4) =       0.000412009329
  error estimate for blocks of size 2^( 5) =       0.000417815676
  error estimate for blocks of size 2^( 6) =       0.000420950574
  error estimate for blocks of size 2^( 7) =       0.000423833218

      target function =      -0.936341880286
              le_mean =     -17.211741340980
             les_mean =     296.528875383134
             stat err =       0.000418652199
             autocorr =       1.230672731643
   target nu stat err =       0.000418652199
   target dn stat err =       0.004594736912
      target stat err =       0.007822953994
              std dev =       0.533699856434
             le_variance =       0.284835536758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284848992471
                                         uncertainty =       0.004575194137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284848992471
                                         uncertainty =       0.004575194137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377382379
  error estimate for blocks of size 2^( 2) =       0.000391317374
  error estimate for blocks of size 2^( 3) =       0.000403297456
  error estimate for blocks of size 2^( 4) =       0.000412008341
  error estimate for blocks of size 2^( 5) =       0.000417814514
  error estimate for blocks of size 2^( 6) =       0.000420949342
  error estimate for blocks of size 2^( 7) =       0.000423831821

      target function =      -0.936342931654
              le_mean =     -17.211741339361
             les_mean =     296.528874709888
             stat err =       0.000418651004
             autocorr =       1.230668373641
   target nu stat err =       0.000418651004
   target dn stat err =       0.004594562437
      target stat err =       0.007822676932
              std dev =       0.533699277906
             le_variance =       0.284834919237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284848454019
                                         uncertainty =       0.004575041029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284848454019
                                         uncertainty =       0.004575041029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377382020
  error estimate for blocks of size 2^( 2) =       0.000391316930
  error estimate for blocks of size 2^( 3) =       0.000403296852
  error estimate for blocks of size 2^( 4) =       0.000412007475
  error estimate for blocks of size 2^( 5) =       0.000417813495
  error estimate for blocks of size 2^( 6) =       0.000420948261
  error estimate for blocks of size 2^( 7) =       0.000423830596

      target function =      -0.936343851922
              le_mean =     -17.211741338367
             les_mean =     296.528874135134
             stat err =       0.000418649957
             autocorr =       1.230664550184
   target nu stat err =       0.000418649957
   target dn stat err =       0.004594409104
      target stat err =       0.007822433386
              std dev =       0.533698771514
             le_variance =       0.284834378716


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936343983208        initial  <--
     2.5000e+01     2.5000e+02             2.5343e-05        -0.936341880286
     1.0000e+02     1.0000e+03             6.3444e-06        -0.936342931654
     4.0000e+02     4.0000e+03             1.5866e-06        -0.936343851922

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1391
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0138e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2295
    reference variance = 0.441898
====================================================
  Execution time = 3.7412e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.0383e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0240e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303784443123
                                         uncertainty =       0.021717759139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303784443123
                                         uncertainty =       0.021717759139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389761838
  error estimate for blocks of size 2^( 2) =       0.000402497181
  error estimate for blocks of size 2^( 3) =       0.000414394933
  error estimate for blocks of size 2^( 4) =       0.000423520906
  error estimate for blocks of size 2^( 5) =       0.000428436344
  error estimate for blocks of size 2^( 6) =       0.000432122169
  error estimate for blocks of size 2^( 7) =       0.000433429488

      target function =      -0.903943827643
              le_mean =     -17.211729685264
             les_mean =     296.547467187662
             stat err =       0.000429377227
             autocorr =       1.213610663853
   target nu stat err =       0.000429377227
   target dn stat err =       0.022126629739
      target stat err =       0.035002520739
              std dev =       0.551206477615
             le_variance =       0.303828580964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721172968526e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905289847216       residual = 2.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905290122337       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905290254931       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905290334656       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905290387123       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905290453538       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905290504006       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905290522771       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905290539636       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905290547718       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905290564541       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905290567576       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905290576629       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905290580430       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905290585575       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.905290586471       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905290587234       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905290587781       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.905290588074       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905290588178       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905290588275       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.905290588443       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.905290588453       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905290588511       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905290588527       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.905290588463       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 5.120996e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905289847216       residual = 2.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905289916013       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905289949168       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905289969104       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905289982223       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905289998830       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905290011456       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905290016140       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905290020355       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905290022377       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905290026581       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905290027344       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905290029605       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905290030555       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905290031842       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.905290032070       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905290032253       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905290032392       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.905290032464       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905290032495       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905290032516       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.905290032557       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.905290032556       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905290032574       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905290032579       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.905290032561       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 1.280397e-06

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905289847216       residual = 2.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905289864417       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905289872706       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905289877690       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905289880970       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905289885122       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905289888279       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905289889449       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905289890504       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905289891009       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905289892060       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905289892250       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.905289892812       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.905289893053       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.905289893383       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.905289893425       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.905289893485       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.905289893515       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.905289893535       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.905289893542       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905289893541       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.905289893551       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.905289893541       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.905289893560       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.905289893545       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.905289893557       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+03 is 3.201084e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177227 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7679e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.977339e-01 1 1  ON 0
 uu_1                 4.330286e-02 1 1  ON 1
 uu_2                -4.189254e-02 1 1  ON 2
 uu_3                -9.235570e-02 1 1  ON 3
 uu_4                -1.237608e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107247e-01 1 1  ON 6
 uu_7                -4.250700e-02 1 1  ON 7
 uu_8                 8.649020e-02 1 1  ON 8
 uu_9                 1.220587e-01 1 1  ON 9
 ud_0                 3.027536e-01 1 1  ON 10
 ud_1                 7.594086e-02 1 1  ON 11
 ud_2                -1.844972e-02 1 1  ON 12
 ud_3                -6.887872e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357266e-01 1 1  ON 15
 ud_6                -1.369137e-01 1 1  ON 16
 ud_7                -9.606109e-02 1 1  ON 17
 ud_8                 1.393023e-03 1 1  ON 18
 ud_9                 9.066689e-02 1 1  ON 19
 eO_0                -6.845913e-01 1 1  ON 20
 eO_1                -4.098442e-01 1 1  ON 21
 eO_2                -4.963852e-02 1 1  ON 22
 eO_3                 1.714426e-01 1 1  ON 23
 eO_4                 2.548062e-01 1 1  ON 24
 eO_5                 2.930536e-01 1 1  ON 25
 eO_6                 2.514178e-01 1 1  ON 26
 eO_7                 1.164923e-01 1 1  ON 27
 eO_8                 2.796078e-02 1 1  ON 28
 eO_9                 1.837742e-02 1 1  ON 29
eH1_0                -1.951986e-01 1 1  ON 30
eH1_1                -9.632884e-02 1 1  ON 31
eH1_2                -4.928295e-02 1 1  ON 32
eH1_3                -1.897887e-02 1 1  ON 33
eH1_4                 1.663165e-02 1 1  ON 34
eH1_5                 2.420845e-02 1 1  ON 35
eH1_6                 7.670270e-02 1 1  ON 36
eH1_7                 1.107284e-01 1 1  ON 37
eH1_8                 9.201387e-02 1 1  ON 38
eH1_9                 2.427306e-02 1 1  ON 39
eH2_0                -1.961730e-01 1 1  ON 40
eH2_1                -9.716681e-02 1 1  ON 41
eH2_2                -5.030234e-02 1 1  ON 42
eH2_3                -2.015252e-02 1 1  ON 43
eH2_4                 1.553607e-02 1 1  ON 44
eH2_5                 2.428203e-02 1 1  ON 45
eH2_6                 7.651119e-02 1 1  ON 46
eH2_7                 1.129214e-01 1 1  ON 47
eH2_8                 9.607125e-02 1 1  ON 48
eH2_9                 2.646781e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2032
    reference variance = 0.288606
====================================================
  Execution time = 3.6973e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8416e-01
  Total weights = 2.0000e+06
  Execution time = 3.3775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284160158736
                                         uncertainty =       0.005082530529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284160158736
                                         uncertainty =       0.005082530529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376936619
  error estimate for blocks of size 2^( 2) =       0.000390641530
  error estimate for blocks of size 2^( 3) =       0.000403206429
  error estimate for blocks of size 2^( 4) =       0.000412301947
  error estimate for blocks of size 2^( 5) =       0.000417321790
  error estimate for blocks of size 2^( 6) =       0.000418971319
  error estimate for blocks of size 2^( 7) =       0.000421673383

      target function =      -0.937432031257
              le_mean =     -17.212533810653
             les_mean =     296.555482469713
             stat err =       0.000417567110
             autocorr =       1.227201581409
   target nu stat err =       0.000417567110
   target dn stat err =       0.004841631017
      target stat err =       0.008271143646
              std dev =       0.533068878207
             le_variance =       0.284162428913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284159954327
                                         uncertainty =       0.005082481212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284159954327
                                         uncertainty =       0.005082481212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376936483
  error estimate for blocks of size 2^( 2) =       0.000390641495
  error estimate for blocks of size 2^( 3) =       0.000403206521
  error estimate for blocks of size 2^( 4) =       0.000412302155
  error estimate for blocks of size 2^( 5) =       0.000417322106
  error estimate for blocks of size 2^( 6) =       0.000418971648
  error estimate for blocks of size 2^( 7) =       0.000421673694

      target function =      -0.937432381573
              le_mean =     -17.212533791333
             les_mean =     296.555481600103
             stat err =       0.000417567401
             autocorr =       1.227204176641
   target nu stat err =       0.000417567401
   target dn stat err =       0.004841585019
      target stat err =       0.008271071609
              std dev =       0.533068686398
             le_variance =       0.284162224418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284160056486
                                         uncertainty =       0.005082505865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284160056486
                                         uncertainty =       0.005082505865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376936551
  error estimate for blocks of size 2^( 2) =       0.000390641512
  error estimate for blocks of size 2^( 3) =       0.000403206475
  error estimate for blocks of size 2^( 4) =       0.000412302051
  error estimate for blocks of size 2^( 5) =       0.000417321948
  error estimate for blocks of size 2^( 6) =       0.000418971483
  error estimate for blocks of size 2^( 7) =       0.000421673539

      target function =      -0.937432206493
              le_mean =     -17.212533800984
             les_mean =     296.555482034564
             stat err =       0.000417567255
             autocorr =       1.227202879231
   target nu stat err =       0.000417567255
   target dn stat err =       0.004841608013
      target stat err =       0.008271107620
              std dev =       0.533068782260
             le_variance =       0.284162326620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284160145951
                                         uncertainty =       0.005082527446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284160145951
                                         uncertainty =       0.005082527446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376936610
  error estimate for blocks of size 2^( 2) =       0.000390641527
  error estimate for blocks of size 2^( 3) =       0.000403206435
  error estimate for blocks of size 2^( 4) =       0.000412301960
  error estimate for blocks of size 2^( 5) =       0.000417321809
  error estimate for blocks of size 2^( 6) =       0.000418971339
  error estimate for blocks of size 2^( 7) =       0.000421673403

      target function =      -0.937432053168
              le_mean =     -17.212533809444
             les_mean =     296.555482415288
             stat err =       0.000417567128
             autocorr =       1.227201743630
   target nu stat err =       0.000417567128
   target dn stat err =       0.004841628141
      target stat err =       0.008271139142
              std dev =       0.533068866210
             le_variance =       0.284162416123


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937432031257        initial
     2.5000e+02     2.5000e+03             5.1210e-06        -0.937432381573  <--
     1.0000e+03     1.0000e+04             1.2804e-06        -0.937432206493
     4.0000e+03     4.0000e+04             3.2011e-07        -0.937432053168

*****************************************************************************
Applying the update for shift_i =   2.5000e+02     and shift_s =   2.5000e+03
*****************************************************************************

  Execution time = 5.3991e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.977349e-01 1 1  ON 0
 uu_1                 4.330320e-02 1 1  ON 1
 uu_2                -4.189214e-02 1 1  ON 2
 uu_3                -9.235458e-02 1 1  ON 3
 uu_4                -1.237600e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.250890e-02 1 1  ON 7
 uu_8                 8.648858e-02 1 1  ON 8
 uu_9                 1.220589e-01 1 1  ON 9
 ud_0                 3.027528e-01 1 1  ON 10
 ud_1                 7.594071e-02 1 1  ON 11
 ud_2                -1.845043e-02 1 1  ON 12
 ud_3                -6.887919e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357252e-01 1 1  ON 15
 ud_6                -1.369129e-01 1 1  ON 16
 ud_7                -9.606082e-02 1 1  ON 17
 ud_8                 1.392395e-03 1 1  ON 18
 ud_9                 9.066657e-02 1 1  ON 19
 eO_0                -6.845875e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963714e-02 1 1  ON 22
 eO_3                 1.714413e-01 1 1  ON 23
 eO_4                 2.548023e-01 1 1  ON 24
 eO_5                 2.930505e-01 1 1  ON 25
 eO_6                 2.514175e-01 1 1  ON 26
 eO_7                 1.164931e-01 1 1  ON 27
 eO_8                 2.796081e-02 1 1  ON 28
 eO_9                 1.837747e-02 1 1  ON 29
eH1_0                -1.951998e-01 1 1  ON 30
eH1_1                -9.632975e-02 1 1  ON 31
eH1_2                -4.928173e-02 1 1  ON 32
eH1_3                -1.897788e-02 1 1  ON 33
eH1_4                 1.663191e-02 1 1  ON 34
eH1_5                 2.420813e-02 1 1  ON 35
eH1_6                 7.670272e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201433e-02 1 1  ON 38
eH1_9                 2.427313e-02 1 1  ON 39
eH2_0                -1.961763e-01 1 1  ON 40
eH2_1                -9.716722e-02 1 1  ON 41
eH2_2                -5.030172e-02 1 1  ON 42
eH2_3                -2.015166e-02 1 1  ON 43
eH2_4                 1.553939e-02 1 1  ON 44
eH2_5                 2.428222e-02 1 1  ON 45
eH2_6                 7.650995e-02 1 1  ON 46
eH2_7                 1.129208e-01 1 1  ON 47
eH2_8                 9.607162e-02 1 1  ON 48
eH2_9                 2.646794e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0169e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2188
    reference variance = 0.158134
====================================================
  Execution time = 3.7497e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8695e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0245e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287034079842
                                         uncertainty =       0.007426922675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287034079842
                                         uncertainty =       0.007426922675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378778253
  error estimate for blocks of size 2^( 2) =       0.000392049484
  error estimate for blocks of size 2^( 3) =       0.000404168578
  error estimate for blocks of size 2^( 4) =       0.000412767623
  error estimate for blocks of size 2^( 5) =       0.000418457385
  error estimate for blocks of size 2^( 6) =       0.000421202795
  error estimate for blocks of size 2^( 7) =       0.000422014754

      target function =      -0.932662876559
              le_mean =     -17.211999722624
             les_mean =     296.539880238620
             stat err =       0.000418610639
             autocorr =       1.221379003498
   target nu stat err =       0.000418610639
   target dn stat err =       0.007348476485
      target stat err =       0.012385498160
              std dev =       0.535673343078
             le_variance =       0.286945930484


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721199972262e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932827340666       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932827937590       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932828248403       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932828388255       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932828476916       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932828606980       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932828651994       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932828729791       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932828762915       residual = 5.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932828780042       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932828804845       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932828813851       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932828829098       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932828834267       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932828839866       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932828845454       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932828843624       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932828846750       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932828847029       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932828848500       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932828849296       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932828849698       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932828850681       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932828850590       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932828850531       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 1.267543e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932827340666       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932827490031       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932827567819       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932827602810       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932827624986       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932827657523       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932827668785       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932827688246       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932827696532       residual = 5.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932827700817       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932827707031       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932827709282       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932827713083       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932827714376       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932827715774       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932827717170       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932827716712       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932827717494       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932827717563       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932827717931       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932827718130       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932827718229       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932827718475       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932827718453       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932827718437       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 3.170169e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932827340666       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932827378016       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932827397468       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932827406218       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932827411763       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932827419898       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932827422715       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932827427579       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932827429654       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932827430723       residual = 3.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932827432278       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932827432840       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932827433785       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932827434113       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932827434466       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932827434812       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932827434697       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932827434890       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932827434914       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932827435003       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932827435049       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932827435079       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932827435139       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932827435126       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932827435125       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 7.926241e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7768e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.977364e-01 1 1  ON 0
 uu_1                 4.330437e-02 1 1  ON 1
 uu_2                -4.189151e-02 1 1  ON 2
 uu_3                -9.235448e-02 1 1  ON 3
 uu_4                -1.237602e-01 1 1  ON 4
 uu_5                -1.319018e-01 1 1  ON 5
 uu_6                -1.107260e-01 1 1  ON 6
 uu_7                -4.251033e-02 1 1  ON 7
 uu_8                 8.648703e-02 1 1  ON 8
 uu_9                 1.220593e-01 1 1  ON 9
 ud_0                 3.027508e-01 1 1  ON 10
 ud_1                 7.593999e-02 1 1  ON 11
 ud_2                -1.845149e-02 1 1  ON 12
 ud_3                -6.888025e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357238e-01 1 1  ON 15
 ud_6                -1.369109e-01 1 1  ON 16
 ud_7                -9.605926e-02 1 1  ON 17
 ud_8                 1.392052e-03 1 1  ON 18
 ud_9                 9.066613e-02 1 1  ON 19
 eO_0                -6.845864e-01 1 1  ON 20
 eO_1                -4.098410e-01 1 1  ON 21
 eO_2                -4.963597e-02 1 1  ON 22
 eO_3                 1.714411e-01 1 1  ON 23
 eO_4                 2.547991e-01 1 1  ON 24
 eO_5                 2.930490e-01 1 1  ON 25
 eO_6                 2.514178e-01 1 1  ON 26
 eO_7                 1.164944e-01 1 1  ON 27
 eO_8                 2.796088e-02 1 1  ON 28
 eO_9                 1.837748e-02 1 1  ON 29
eH1_0                -1.952029e-01 1 1  ON 30
eH1_1                -9.633020e-02 1 1  ON 31
eH1_2                -4.928129e-02 1 1  ON 32
eH1_3                -1.897776e-02 1 1  ON 33
eH1_4                 1.663234e-02 1 1  ON 34
eH1_5                 2.420989e-02 1 1  ON 35
eH1_6                 7.670271e-02 1 1  ON 36
eH1_7                 1.107279e-01 1 1  ON 37
eH1_8                 9.201490e-02 1 1  ON 38
eH1_9                 2.427316e-02 1 1  ON 39
eH2_0                -1.961780e-01 1 1  ON 40
eH2_1                -9.716801e-02 1 1  ON 41
eH2_2                -5.030075e-02 1 1  ON 42
eH2_3                -2.014990e-02 1 1  ON 43
eH2_4                 1.554030e-02 1 1  ON 44
eH2_5                 2.428207e-02 1 1  ON 45
eH2_6                 7.650914e-02 1 1  ON 46
eH2_7                 1.129199e-01 1 1  ON 47
eH2_8                 9.607225e-02 1 1  ON 48
eH2_9                 2.646808e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2507
    reference variance = 0.255564
====================================================
  Execution time = 3.6667e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8106e-01
  Total weights = 2.0000e+06
  Execution time = 3.3723e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281112715984
                                         uncertainty =       0.002480850788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281112715984
                                         uncertainty =       0.002480850788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374871698
  error estimate for blocks of size 2^( 2) =       0.000388601636
  error estimate for blocks of size 2^( 3) =       0.000401290082
  error estimate for blocks of size 2^( 4) =       0.000410796158
  error estimate for blocks of size 2^( 5) =       0.000415931174
  error estimate for blocks of size 2^( 6) =       0.000418483367
  error estimate for blocks of size 2^( 7) =       0.000420235205

      target function =      -0.942796591789
              le_mean =     -17.212627509544
             les_mean =     296.555603221552
             stat err =       0.000416361476
             autocorr =       1.233604009239
   target nu stat err =       0.000416361476
   target dn stat err =       0.002273675094
      target stat err =       0.003985862939
              std dev =       0.530148639310
             le_variance =       0.281057579763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281112956860
                                         uncertainty =       0.002480849605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281112956860
                                         uncertainty =       0.002480849605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374871858
  error estimate for blocks of size 2^( 2) =       0.000388602090
  error estimate for blocks of size 2^( 3) =       0.000401290877
  error estimate for blocks of size 2^( 4) =       0.000410797252
  error estimate for blocks of size 2^( 5) =       0.000415932495
  error estimate for blocks of size 2^( 6) =       0.000418484659
  error estimate for blocks of size 2^( 7) =       0.000420236521

      target function =      -0.942796178175
              le_mean =     -17.212627508002
             les_mean =     296.555603408890
             stat err =       0.000416362732
             autocorr =       1.233610396873
   target nu stat err =       0.000416362732
   target dn stat err =       0.002273673394
      target stat err =       0.003985857058
              std dev =       0.530148866053
             le_variance =       0.281057820177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281112836268
                                         uncertainty =       0.002480850194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281112836268
                                         uncertainty =       0.002480850194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374871778
  error estimate for blocks of size 2^( 2) =       0.000388601863
  error estimate for blocks of size 2^( 3) =       0.000401290480
  error estimate for blocks of size 2^( 4) =       0.000410796705
  error estimate for blocks of size 2^( 5) =       0.000415931835
  error estimate for blocks of size 2^( 6) =       0.000418484013
  error estimate for blocks of size 2^( 7) =       0.000420235863

      target function =      -0.942796385250
              le_mean =     -17.212627508726
             les_mean =     296.555603313431
             stat err =       0.000416362104
             autocorr =       1.233607205202
   target nu stat err =       0.000416362104
   target dn stat err =       0.002273674242
      target stat err =       0.003985859997
              std dev =       0.530148752536
             le_variance =       0.281057699815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281112730996
                                         uncertainty =       0.002480850714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281112730996
                                         uncertainty =       0.002480850714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374871708
  error estimate for blocks of size 2^( 2) =       0.000388601665
  error estimate for blocks of size 2^( 3) =       0.000401290132
  error estimate for blocks of size 2^( 4) =       0.000410796226
  error estimate for blocks of size 2^( 5) =       0.000415931256
  error estimate for blocks of size 2^( 6) =       0.000418483448
  error estimate for blocks of size 2^( 7) =       0.000420235287

      target function =      -0.942796566012
              le_mean =     -17.212627509437
             les_mean =     296.555603232831
             stat err =       0.000416361554
             autocorr =       1.233604408768
   target nu stat err =       0.000416361554
   target dn stat err =       0.002273674987
      target stat err =       0.003985862572
              std dev =       0.530148653442
             le_variance =       0.281057594746


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942796591789        initial  <--
     6.2500e+01     6.2500e+02             1.2675e-05        -0.942796178175
     2.5000e+02     2.5000e+03             3.1702e-06        -0.942796385250
     1.0000e+03     1.0000e+04             7.9262e-07        -0.942796566012

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7081
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.977349e-01 1 1  ON 0
 uu_1                 4.330320e-02 1 1  ON 1
 uu_2                -4.189214e-02 1 1  ON 2
 uu_3                -9.235458e-02 1 1  ON 3
 uu_4                -1.237600e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.250890e-02 1 1  ON 7
 uu_8                 8.648858e-02 1 1  ON 8
 uu_9                 1.220589e-01 1 1  ON 9
 ud_0                 3.027528e-01 1 1  ON 10
 ud_1                 7.594071e-02 1 1  ON 11
 ud_2                -1.845043e-02 1 1  ON 12
 ud_3                -6.887919e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357252e-01 1 1  ON 15
 ud_6                -1.369129e-01 1 1  ON 16
 ud_7                -9.606082e-02 1 1  ON 17
 ud_8                 1.392395e-03 1 1  ON 18
 ud_9                 9.066657e-02 1 1  ON 19
 eO_0                -6.845875e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963714e-02 1 1  ON 22
 eO_3                 1.714413e-01 1 1  ON 23
 eO_4                 2.548023e-01 1 1  ON 24
 eO_5                 2.930505e-01 1 1  ON 25
 eO_6                 2.514175e-01 1 1  ON 26
 eO_7                 1.164931e-01 1 1  ON 27
 eO_8                 2.796081e-02 1 1  ON 28
 eO_9                 1.837747e-02 1 1  ON 29
eH1_0                -1.951998e-01 1 1  ON 30
eH1_1                -9.632975e-02 1 1  ON 31
eH1_2                -4.928173e-02 1 1  ON 32
eH1_3                -1.897788e-02 1 1  ON 33
eH1_4                 1.663191e-02 1 1  ON 34
eH1_5                 2.420813e-02 1 1  ON 35
eH1_6                 7.670272e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201433e-02 1 1  ON 38
eH1_9                 2.427313e-02 1 1  ON 39
eH2_0                -1.961763e-01 1 1  ON 40
eH2_1                -9.716722e-02 1 1  ON 41
eH2_2                -5.030172e-02 1 1  ON 42
eH2_3                -2.015166e-02 1 1  ON 43
eH2_4                 1.553939e-02 1 1  ON 44
eH2_5                 2.428222e-02 1 1  ON 45
eH2_6                 7.650995e-02 1 1  ON 46
eH2_7                 1.129208e-01 1 1  ON 47
eH2_8                 9.607162e-02 1 1  ON 48
eH2_9                 2.646794e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0148e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1739
    reference variance = 0.455107
====================================================
  Execution time = 3.7370e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7949e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0023e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279453914285
                                         uncertainty =       0.002209881437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279453914285
                                         uncertainty =       0.002209881437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373825674
  error estimate for blocks of size 2^( 2) =       0.000387114413
  error estimate for blocks of size 2^( 3) =       0.000399148005
  error estimate for blocks of size 2^( 4) =       0.000408128501
  error estimate for blocks of size 2^( 5) =       0.000413432941
  error estimate for blocks of size 2^( 6) =       0.000417041273
  error estimate for blocks of size 2^( 7) =       0.000420578232

      target function =      -0.945525840371
              le_mean =     -17.211998995451
             les_mean =     296.532400549428
             stat err =       0.000414795237
             autocorr =       1.231201881298
   target nu stat err =       0.000414795237
   target dn stat err =       0.002274174050
      target stat err =       0.004003984640
              std dev =       0.528669338791
             le_variance =       0.279491269778


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721199899545e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945541641917       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945541686594       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945541697065       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945541702962       residual = 6.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945541708933       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945541716035       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945541720343       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945541723292       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945541725299       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945541726423       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945541727467       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945541728216       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945541729406       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945541729580       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945541730271       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945541730670       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945541731288       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945541731295       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945541731301       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945541731384       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945541731379       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945541731379       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945541731433       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945541731417       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 8.313015e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945541641917       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945541653087       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945541655705       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945541657182       residual = 6.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945541658673       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945541660452       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945541661526       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945541662263       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945541662765       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945541663045       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945541663312       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945541663488       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945541663792       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945541663833       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945541664005       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945541664113       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945541664261       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945541664265       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945541664265       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945541664282       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945541664277       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945541664280       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945541664296       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945541664286       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 2.078295e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945541641917       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945541644710       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945541645364       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945541645733       residual = 6.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945541646106       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945541646577       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945541646818       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945541647008       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945541647144       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945541647182       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945541647277       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945541647337       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945541647386       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945541647396       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945541647433       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945541647473       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945541647517       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945541647521       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945541647479       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945541647564       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945541647472       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945541647524       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945541647504       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945541647527       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 5.195763e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214899 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7417e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.977349e-01 1 1  ON 0
 uu_1                 4.330324e-02 1 1  ON 1
 uu_2                -4.189213e-02 1 1  ON 2
 uu_3                -9.235459e-02 1 1  ON 3
 uu_4                -1.237601e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.250882e-02 1 1  ON 7
 uu_8                 8.648837e-02 1 1  ON 8
 uu_9                 1.220589e-01 1 1  ON 9
 ud_0                 3.027527e-01 1 1  ON 10
 ud_1                 7.594069e-02 1 1  ON 11
 ud_2                -1.845053e-02 1 1  ON 12
 ud_3                -6.887930e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357251e-01 1 1  ON 15
 ud_6                -1.369127e-01 1 1  ON 16
 ud_7                -9.606069e-02 1 1  ON 17
 ud_8                 1.392335e-03 1 1  ON 18
 ud_9                 9.066651e-02 1 1  ON 19
 eO_0                -6.845876e-01 1 1  ON 20
 eO_1                -4.098418e-01 1 1  ON 21
 eO_2                -4.963705e-02 1 1  ON 22
 eO_3                 1.714413e-01 1 1  ON 23
 eO_4                 2.548023e-01 1 1  ON 24
 eO_5                 2.930503e-01 1 1  ON 25
 eO_6                 2.514175e-01 1 1  ON 26
 eO_7                 1.164932e-01 1 1  ON 27
 eO_8                 2.796081e-02 1 1  ON 28
 eO_9                 1.837748e-02 1 1  ON 29
eH1_0                -1.951999e-01 1 1  ON 30
eH1_1                -9.632967e-02 1 1  ON 31
eH1_2                -4.928158e-02 1 1  ON 32
eH1_3                -1.897780e-02 1 1  ON 33
eH1_4                 1.663190e-02 1 1  ON 34
eH1_5                 2.420793e-02 1 1  ON 35
eH1_6                 7.670255e-02 1 1  ON 36
eH1_7                 1.107278e-01 1 1  ON 37
eH1_8                 9.201442e-02 1 1  ON 38
eH1_9                 2.427314e-02 1 1  ON 39
eH2_0                -1.961764e-01 1 1  ON 40
eH2_1                -9.716722e-02 1 1  ON 41
eH2_2                -5.030161e-02 1 1  ON 42
eH2_3                -2.015160e-02 1 1  ON 43
eH2_4                 1.553942e-02 1 1  ON 44
eH2_5                 2.428214e-02 1 1  ON 45
eH2_6                 7.650986e-02 1 1  ON 46
eH2_7                 1.129208e-01 1 1  ON 47
eH2_8                 9.607173e-02 1 1  ON 48
eH2_9                 2.646797e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2022
    reference variance = 0.89653
====================================================
  Execution time = 3.7151e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7787e-01
  Total weights = 2.0000e+06
  Execution time = 3.3600e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277759725370
                                         uncertainty =       0.002481652246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277759725370
                                         uncertainty =       0.002481652246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372739955
  error estimate for blocks of size 2^( 2) =       0.000387036311
  error estimate for blocks of size 2^( 3) =       0.000399032050
  error estimate for blocks of size 2^( 4) =       0.000408101171
  error estimate for blocks of size 2^( 5) =       0.000414113627
  error estimate for blocks of size 2^( 6) =       0.000419667122
  error estimate for blocks of size 2^( 7) =       0.000421105720

      target function =      -0.948337444010
              le_mean =     -17.211939091537
             les_mean =     296.528717299309
             stat err =       0.000415746910
             autocorr =       1.244073856537
   target nu stat err =       0.000415746910
   target dn stat err =       0.002359003796
      target stat err =       0.004172207612
              std dev =       0.527133899002
             le_variance =       0.277870147478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277759722582
                                         uncertainty =       0.002481650271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277759722582
                                         uncertainty =       0.002481650271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372739953
  error estimate for blocks of size 2^( 2) =       0.000387036314
  error estimate for blocks of size 2^( 3) =       0.000399032066
  error estimate for blocks of size 2^( 4) =       0.000408101198
  error estimate for blocks of size 2^( 5) =       0.000414113666
  error estimate for blocks of size 2^( 6) =       0.000419667173
  error estimate for blocks of size 2^( 7) =       0.000421105782

      target function =      -0.948337449144
              le_mean =     -17.211939092359
             les_mean =     296.528717324671
             stat err =       0.000415746955
             autocorr =       1.244074139734
   target nu stat err =       0.000415746955
   target dn stat err =       0.002359002204
      target stat err =       0.004172204956
              std dev =       0.527133896199
             le_variance =       0.277870144521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277759723974
                                         uncertainty =       0.002481651258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277759723974
                                         uncertainty =       0.002481651258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372739954
  error estimate for blocks of size 2^( 2) =       0.000387036312
  error estimate for blocks of size 2^( 3) =       0.000399032058
  error estimate for blocks of size 2^( 4) =       0.000408101184
  error estimate for blocks of size 2^( 5) =       0.000414113647
  error estimate for blocks of size 2^( 6) =       0.000419667148
  error estimate for blocks of size 2^( 7) =       0.000421105751

      target function =      -0.948337446579
              le_mean =     -17.211939091948
             les_mean =     296.528717311980
             stat err =       0.000415746932
             autocorr =       1.244073998146
   target nu stat err =       0.000415746932
   target dn stat err =       0.002359003000
      target stat err =       0.004172206284
              std dev =       0.527133897599
             le_variance =       0.277870145998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277759725195
                                         uncertainty =       0.002481652123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277759725195
                                         uncertainty =       0.002481652123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372739954
  error estimate for blocks of size 2^( 2) =       0.000387036311
  error estimate for blocks of size 2^( 3) =       0.000399032051
  error estimate for blocks of size 2^( 4) =       0.000408101172
  error estimate for blocks of size 2^( 5) =       0.000414113629
  error estimate for blocks of size 2^( 6) =       0.000419667126
  error estimate for blocks of size 2^( 7) =       0.000421105723

      target function =      -0.948337444331
              le_mean =     -17.211939091588
             les_mean =     296.528717300892
             stat err =       0.000415746913
             autocorr =       1.244073874247
   target nu stat err =       0.000415746913
   target dn stat err =       0.002359003697
      target stat err =       0.004172207446
              std dev =       0.527133898827
             le_variance =       0.277870147292


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948337444010        initial
     6.2500e+02     6.2500e+03             8.3130e-07        -0.948337449144  <--
     2.5000e+03     2.5000e+04             2.0783e-07        -0.948337446579
     1.0000e+04     1.0000e+05             5.1958e-08        -0.948337444331

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 5.4125e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.977351e-01 1 1  ON 0
 uu_1                 4.330335e-02 1 1  ON 1
 uu_2                -4.189211e-02 1 1  ON 2
 uu_3                -9.235461e-02 1 1  ON 3
 uu_4                -1.237601e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.250857e-02 1 1  ON 7
 uu_8                 8.648775e-02 1 1  ON 8
 uu_9                 1.220589e-01 1 1  ON 9
 ud_0                 3.027524e-01 1 1  ON 10
 ud_1                 7.594063e-02 1 1  ON 11
 ud_2                -1.845085e-02 1 1  ON 12
 ud_3                -6.887966e-02 1 1  ON 13
 ud_4                -1.085323e-01 1 1  ON 14
 ud_5                -1.357249e-01 1 1  ON 15
 ud_6                -1.369121e-01 1 1  ON 16
 ud_7                -9.606031e-02 1 1  ON 17
 ud_8                 1.392154e-03 1 1  ON 18
 ud_9                 9.066632e-02 1 1  ON 19
 eO_0                -6.845879e-01 1 1  ON 20
 eO_1                -4.098421e-01 1 1  ON 21
 eO_2                -4.963681e-02 1 1  ON 22
 eO_3                 1.714416e-01 1 1  ON 23
 eO_4                 2.548022e-01 1 1  ON 24
 eO_5                 2.930497e-01 1 1  ON 25
 eO_6                 2.514177e-01 1 1  ON 26
 eO_7                 1.164937e-01 1 1  ON 27
 eO_8                 2.796081e-02 1 1  ON 28
 eO_9                 1.837751e-02 1 1  ON 29
eH1_0                -1.952001e-01 1 1  ON 30
eH1_1                -9.632944e-02 1 1  ON 31
eH1_2                -4.928111e-02 1 1  ON 32
eH1_3                -1.897756e-02 1 1  ON 33
eH1_4                 1.663186e-02 1 1  ON 34
eH1_5                 2.420733e-02 1 1  ON 35
eH1_6                 7.670204e-02 1 1  ON 36
eH1_7                 1.107279e-01 1 1  ON 37
eH1_8                 9.201469e-02 1 1  ON 38
eH1_9                 2.427315e-02 1 1  ON 39
eH2_0                -1.961767e-01 1 1  ON 40
eH2_1                -9.716721e-02 1 1  ON 41
eH2_2                -5.030131e-02 1 1  ON 42
eH2_3                -2.015141e-02 1 1  ON 43
eH2_4                 1.553949e-02 1 1  ON 44
eH2_5                 2.428189e-02 1 1  ON 45
eH2_6                 7.650962e-02 1 1  ON 46
eH2_7                 1.129206e-01 1 1  ON 47
eH2_8                 9.607206e-02 1 1  ON 48
eH2_9                 2.646803e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0164e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2059
    reference variance = 0.290824
====================================================
  Execution time = 3.7095e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8247e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0041e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282403569760
                                         uncertainty =       0.002853983698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282403569760
                                         uncertainty =       0.002853983698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375813606
  error estimate for blocks of size 2^( 2) =       0.000389437977
  error estimate for blocks of size 2^( 3) =       0.000401483949
  error estimate for blocks of size 2^( 4) =       0.000410490400
  error estimate for blocks of size 2^( 5) =       0.000415765353
  error estimate for blocks of size 2^( 6) =       0.000417310368
  error estimate for blocks of size 2^( 7) =       0.000420687067

      target function =      -0.940392989507
              le_mean =     -17.212028905169
             les_mean =     296.536410623512
             stat err =       0.000416063297
             autocorr =       1.225670729826
   target nu stat err =       0.000416063297
   target dn stat err =       0.002695579823
      target stat err =       0.004671539395
              std dev =       0.531480698031
             le_variance =       0.282471732379


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721202890517e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940415484490       residual = 9.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940415621860       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940415668516       residual = 9.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940415703587       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940415723749       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940415737103       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940415751550       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940415772943       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940415778542       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940415782077       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940415786267       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940415789759       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940415794609       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940415796832       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940415799234       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940415799847       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940415800037       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940415800306       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940415800159       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940415800391       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940415800768       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940415800468       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940415800657       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940415800768       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940415800825       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 3.642783e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940415484490       residual = 9.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940415518845       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940415530514       residual = 9.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940415539286       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940415544327       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940415547665       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940415551278       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940415556627       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940415558029       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940415558913       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940415559960       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940415560829       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940415562043       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940415562600       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940415563202       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940415563357       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940415563400       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940415563470       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940415563433       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940415563492       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940415563584       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940415563511       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940415563557       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940415563583       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940415563595       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 9.108618e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940415484490       residual = 9.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940415493079       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940415495997       residual = 9.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940415498191       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940415499451       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940415500287       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940415501192       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940415502524       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940415502878       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940415503094       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940415503356       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940415503571       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940415503882       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940415504027       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940415504168       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940415504208       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940415504220       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940415504233       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940415504221       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940415504250       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940415504266       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940415504238       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940415504251       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940415504276       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940415504263       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 2.277258e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234713 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7163e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.977353e-01 1 1  ON 0
 uu_1                 4.330356e-02 1 1  ON 1
 uu_2                -4.189196e-02 1 1  ON 2
 uu_3                -9.235450e-02 1 1  ON 3
 uu_4                -1.237599e-01 1 1  ON 4
 uu_5                -1.319009e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.250924e-02 1 1  ON 7
 uu_8                 8.648706e-02 1 1  ON 8
 uu_9                 1.220590e-01 1 1  ON 9
 ud_0                 3.027520e-01 1 1  ON 10
 ud_1                 7.594044e-02 1 1  ON 11
 ud_2                -1.845127e-02 1 1  ON 12
 ud_3                -6.888016e-02 1 1  ON 13
 ud_4                -1.085324e-01 1 1  ON 14
 ud_5                -1.357244e-01 1 1  ON 15
 ud_6                -1.369113e-01 1 1  ON 16
 ud_7                -9.605970e-02 1 1  ON 17
 ud_8                 1.391855e-03 1 1  ON 18
 ud_9                 9.066628e-02 1 1  ON 19
 eO_0                -6.845875e-01 1 1  ON 20
 eO_1                -4.098420e-01 1 1  ON 21
 eO_2                -4.963625e-02 1 1  ON 22
 eO_3                 1.714416e-01 1 1  ON 23
 eO_4                 2.548013e-01 1 1  ON 24
 eO_5                 2.930490e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164941e-01 1 1  ON 27
 eO_8                 2.796083e-02 1 1  ON 28
 eO_9                 1.837750e-02 1 1  ON 29
eH1_0                -1.952007e-01 1 1  ON 30
eH1_1                -9.632949e-02 1 1  ON 31
eH1_2                -4.928077e-02 1 1  ON 32
eH1_3                -1.897730e-02 1 1  ON 33
eH1_4                 1.663186e-02 1 1  ON 34
eH1_5                 2.420724e-02 1 1  ON 35
eH1_6                 7.670200e-02 1 1  ON 36
eH1_7                 1.107279e-01 1 1  ON 37
eH1_8                 9.201490e-02 1 1  ON 38
eH1_9                 2.427319e-02 1 1  ON 39
eH2_0                -1.961771e-01 1 1  ON 40
eH2_1                -9.716706e-02 1 1  ON 41
eH2_2                -5.030088e-02 1 1  ON 42
eH2_3                -2.015093e-02 1 1  ON 43
eH2_4                 1.553958e-02 1 1  ON 44
eH2_5                 2.428158e-02 1 1  ON 45
eH2_6                 7.650922e-02 1 1  ON 46
eH2_7                 1.129204e-01 1 1  ON 47
eH2_8                 9.607222e-02 1 1  ON 48
eH2_9                 2.646806e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1512
    reference variance = 0.169707
====================================================
  Execution time = 3.6796e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7876e-01
  Total weights = 2.0000e+06
  Execution time = 3.3509e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278778352546
                                         uncertainty =       0.002884491588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278778352546
                                         uncertainty =       0.002884491588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373335322
  error estimate for blocks of size 2^( 2) =       0.000387173545
  error estimate for blocks of size 2^( 3) =       0.000399786127
  error estimate for blocks of size 2^( 4) =       0.000408876446
  error estimate for blocks of size 2^( 5) =       0.000414100792
  error estimate for blocks of size 2^( 6) =       0.000418111601
  error estimate for blocks of size 2^( 7) =       0.000418340228

      target function =      -0.946776997199
              le_mean =     -17.212276548136
             les_mean =     296.541222355429
             stat err =       0.000414857267
             autocorr =       1.234807450118
   target nu stat err =       0.000414857267
   target dn stat err =       0.002673958101
      target stat err =       0.004699250670
              std dev =       0.527975875683
             le_variance =       0.278758525303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278778221609
                                         uncertainty =       0.002884481520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278778221609
                                         uncertainty =       0.002884481520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373335235
  error estimate for blocks of size 2^( 2) =       0.000387173498
  error estimate for blocks of size 2^( 3) =       0.000399786142
  error estimate for blocks of size 2^( 4) =       0.000408876536
  error estimate for blocks of size 2^( 5) =       0.000414100928
  error estimate for blocks of size 2^( 6) =       0.000418111736
  error estimate for blocks of size 2^( 7) =       0.000418340332

      target function =      -0.946777223677
              le_mean =     -17.212276539137
             les_mean =     296.541221915305
             stat err =       0.000414857383
             autocorr =       1.234808717260
   target nu stat err =       0.000414857383
   target dn stat err =       0.002673951766
      target stat err =       0.004699241998
              std dev =       0.527975752258
             le_variance =       0.278758394972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278778287037
                                         uncertainty =       0.002884486552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278778287037
                                         uncertainty =       0.002884486552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373335278
  error estimate for blocks of size 2^( 2) =       0.000387173521
  error estimate for blocks of size 2^( 3) =       0.000399786134
  error estimate for blocks of size 2^( 4) =       0.000408876491
  error estimate for blocks of size 2^( 5) =       0.000414100860
  error estimate for blocks of size 2^( 6) =       0.000418111669
  error estimate for blocks of size 2^( 7) =       0.000418340280

      target function =      -0.946777110508
              le_mean =     -17.212276543630
             les_mean =     296.541222135129
             stat err =       0.000414857325
             autocorr =       1.234808083805
   target nu stat err =       0.000414857325
   target dn stat err =       0.002673954932
      target stat err =       0.004699246332
              std dev =       0.527975813932
             le_variance =       0.278758460098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278778344354
                                         uncertainty =       0.002884490958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278778344354
                                         uncertainty =       0.002884490958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373335317
  error estimate for blocks of size 2^( 2) =       0.000387173542
  error estimate for blocks of size 2^( 3) =       0.000399786127
  error estimate for blocks of size 2^( 4) =       0.000408876452
  error estimate for blocks of size 2^( 5) =       0.000414100800
  error estimate for blocks of size 2^( 6) =       0.000418111610
  error estimate for blocks of size 2^( 7) =       0.000418340235

      target function =      -0.946777011367
              le_mean =     -17.212276547572
             les_mean =     296.541222327871
             stat err =       0.000414857274
             autocorr =       1.234807529327
   target nu stat err =       0.000414857274
   target dn stat err =       0.002673957705
      target stat err =       0.004699250127
              std dev =       0.527975867961
             le_variance =       0.278758517150


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946776997199        initial
     1.5625e+02     1.5625e+03             3.6428e-06        -0.946777223677  <--
     6.2500e+02     6.2500e+03             9.1086e-07        -0.946777110508
     2.5000e+03     2.5000e+04             2.2773e-07        -0.946777011367

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 5.3711e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648502e-02 1 1  ON 8
 uu_9                 1.220594e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845254e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605789e-02 1 1  ON 17
 ud_8                 1.390960e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963459e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927975e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646813e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0088e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2889
    reference variance = 0.238693
====================================================
  Execution time = 3.7943e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8008e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0029e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280131247613
                                         uncertainty =       0.003320531656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280131247613
                                         uncertainty =       0.003320531656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374222031
  error estimate for blocks of size 2^( 2) =       0.000387897754
  error estimate for blocks of size 2^( 3) =       0.000400226423
  error estimate for blocks of size 2^( 4) =       0.000409561618
  error estimate for blocks of size 2^( 5) =       0.000415239916
  error estimate for blocks of size 2^( 6) =       0.000418413458
  error estimate for blocks of size 2^( 7) =       0.000421324291

      target function =      -0.944461522909
              le_mean =     -17.212550940500
             les_mean =     296.551993996484
             stat err =       0.000416134821
             autocorr =       1.236543536561
   target nu stat err =       0.000416134821
   target dn stat err =       0.003203620552
      target stat err =       0.005583908834
              std dev =       0.529229871822
             le_variance =       0.280084257229


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721255094050e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944493784000       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944494530591       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944494810399       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944494974004       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944495158150       residual = 6.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944495283586       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944495331932       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944495426185       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944495460408       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944495496081       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944495531411       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944495548664       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944495552895       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944495560512       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944495569334       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944495576197       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944495587606       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944495587158       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944495586075       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944495584988       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944495583465       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944495583980       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944495585253       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944495587331       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.446210e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944493784000       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944493970933       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944494041008       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944494081977       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944494128051       residual = 6.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944494159440       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944494171546       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944494195134       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944494203699       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944494212627       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944494221467       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944494225797       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944494227096       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944494228769       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944494230943       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944494232657       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944494235509       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944494235394       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944494235123       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944494234851       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944494234471       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944494234599       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944494234918       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944494235436       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 3.618466e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944493784000       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944493830751       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944493848278       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944493858524       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944493870044       residual = 6.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944493877894       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944493880922       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944493886820       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944493888962       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944493891195       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944493893405       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944493894488       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944493894834       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944493895233       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944493895774       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944493896203       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944493896916       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944493896888       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944493896818       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944493896751       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944493896654       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944493896688       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944493896765       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944493896899       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 9.048005e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.252746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7996e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.977384e-01 1 1  ON 0
 uu_1                 4.330604e-02 1 1  ON 1
 uu_2                -4.189085e-02 1 1  ON 2
 uu_3                -9.235421e-02 1 1  ON 3
 uu_4                -1.237599e-01 1 1  ON 4
 uu_5                -1.319007e-01 1 1  ON 5
 uu_6                -1.107264e-01 1 1  ON 6
 uu_7                -4.251356e-02 1 1  ON 7
 uu_8                 8.648206e-02 1 1  ON 8
 uu_9                 1.220602e-01 1 1  ON 9
 ud_0                 3.027475e-01 1 1  ON 10
 ud_1                 7.593846e-02 1 1  ON 11
 ud_2                -1.845497e-02 1 1  ON 12
 ud_3                -6.888373e-02 1 1  ON 13
 ud_4                -1.085334e-01 1 1  ON 14
 ud_5                -1.357206e-01 1 1  ON 15
 ud_6                -1.369055e-01 1 1  ON 16
 ud_7                -9.605437e-02 1 1  ON 17
 ud_8                 1.391081e-03 1 1  ON 18
 ud_9                 9.066543e-02 1 1  ON 19
 eO_0                -6.845883e-01 1 1  ON 20
 eO_1                -4.098428e-01 1 1  ON 21
 eO_2                -4.963282e-02 1 1  ON 22
 eO_3                 1.714433e-01 1 1  ON 23
 eO_4                 2.547974e-01 1 1  ON 24
 eO_5                 2.930445e-01 1 1  ON 25
 eO_6                 2.514191e-01 1 1  ON 26
 eO_7                 1.164973e-01 1 1  ON 27
 eO_8                 2.796118e-02 1 1  ON 28
 eO_9                 1.837764e-02 1 1  ON 29
eH1_0                -1.952047e-01 1 1  ON 30
eH1_1                -9.632848e-02 1 1  ON 31
eH1_2                -4.927771e-02 1 1  ON 32
eH1_3                -1.897499e-02 1 1  ON 33
eH1_4                 1.663110e-02 1 1  ON 34
eH1_5                 2.420559e-02 1 1  ON 35
eH1_6                 7.670092e-02 1 1  ON 36
eH1_7                 1.107273e-01 1 1  ON 37
eH1_8                 9.201612e-02 1 1  ON 38
eH1_9                 2.427339e-02 1 1  ON 39
eH2_0                -1.961799e-01 1 1  ON 40
eH2_1                -9.716575e-02 1 1  ON 41
eH2_2                -5.029698e-02 1 1  ON 42
eH2_3                -2.014765e-02 1 1  ON 43
eH2_4                 1.553969e-02 1 1  ON 44
eH2_5                 2.427796e-02 1 1  ON 45
eH2_6                 7.650566e-02 1 1  ON 46
eH2_7                 1.129194e-01 1 1  ON 47
eH2_8                 9.607390e-02 1 1  ON 48
eH2_9                 2.646862e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2098
    reference variance = 0.304145
====================================================
  Execution time = 3.6924e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8044e-01
  Total weights = 2.0000e+06
  Execution time = 3.3775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280515252435
                                         uncertainty =       0.002871254725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280515252435
                                         uncertainty =       0.002871254725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374456608
  error estimate for blocks of size 2^( 2) =       0.000388308461
  error estimate for blocks of size 2^( 3) =       0.000400667655
  error estimate for blocks of size 2^( 4) =       0.000410585810
  error estimate for blocks of size 2^( 5) =       0.000416299542
  error estimate for blocks of size 2^( 6) =       0.000418684800
  error estimate for blocks of size 2^( 7) =       0.000420669006

      target function =      -0.943845293278
              le_mean =     -17.212976466145
             les_mean =     296.566994187076
             stat err =       0.000416559789
             autocorr =       1.237518473996
   target nu stat err =       0.000416559789
   target dn stat err =       0.002721824445
      target stat err =       0.004758942728
              std dev =       0.529561614185
             le_variance =       0.280435503218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280515964871
                                         uncertainty =       0.002871277539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280515964871
                                         uncertainty =       0.002871277539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374457084
  error estimate for blocks of size 2^( 2) =       0.000388309175
  error estimate for blocks of size 2^( 3) =       0.000400668693
  error estimate for blocks of size 2^( 4) =       0.000410587199
  error estimate for blocks of size 2^( 5) =       0.000416301206
  error estimate for blocks of size 2^( 6) =       0.000418686609
  error estimate for blocks of size 2^( 7) =       0.000420670920

      target function =      -0.943844065551
              le_mean =     -17.212976405855
             les_mean =     296.566992824235
             stat err =       0.000416561484
             autocorr =       1.237525396831
   target nu stat err =       0.000416561484
   target dn stat err =       0.002721855260
      target stat err =       0.004758982946
              std dev =       0.529562287119
             le_variance =       0.280436215939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280515608697
                                         uncertainty =       0.002871266148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280515608697
                                         uncertainty =       0.002871266148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374456846
  error estimate for blocks of size 2^( 2) =       0.000388308818
  error estimate for blocks of size 2^( 3) =       0.000400668174
  error estimate for blocks of size 2^( 4) =       0.000410586505
  error estimate for blocks of size 2^( 5) =       0.000416300374
  error estimate for blocks of size 2^( 6) =       0.000418685705
  error estimate for blocks of size 2^( 7) =       0.000420669964

      target function =      -0.943844679343
              le_mean =     -17.212976435860
             les_mean =     296.566993500891
             stat err =       0.000416560637
             autocorr =       1.237521938690
   target nu stat err =       0.000416560637
   target dn stat err =       0.002721839874
      target stat err =       0.004758962871
              std dev =       0.529561950694
             le_variance =       0.280435859623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280515296933
                                         uncertainty =       0.002871256153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280515296933
                                         uncertainty =       0.002871256153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374456638
  error estimate for blocks of size 2^( 2) =       0.000388308505
  error estimate for blocks of size 2^( 3) =       0.000400667720
  error estimate for blocks of size 2^( 4) =       0.000410585896
  error estimate for blocks of size 2^( 5) =       0.000416299646
  error estimate for blocks of size 2^( 6) =       0.000418684913
  error estimate for blocks of size 2^( 7) =       0.000420669126

      target function =      -0.943845216596
              le_mean =     -17.212976462349
             les_mean =     296.566994100884
             stat err =       0.000416559895
             autocorr =       1.237518907148
   target nu stat err =       0.000416559895
   target dn stat err =       0.002721826374
      target stat err =       0.004758945247
              std dev =       0.529561656217
             le_variance =       0.280435547735


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943845293278        initial  <--
     3.9062e+01     3.9062e+02             1.4462e-05        -0.943844065551
     1.5625e+02     1.5625e+03             3.6185e-06        -0.943844679343
     6.2500e+02     6.2500e+03             9.0480e-07        -0.943845216596

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9818
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648502e-02 1 1  ON 8
 uu_9                 1.220594e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845254e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605789e-02 1 1  ON 17
 ud_8                 1.390960e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963459e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927975e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646813e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0198e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.3844
    reference variance = 1.13651
====================================================
  Execution time = 3.7595e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7934e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0097e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279289097935
                                         uncertainty =       0.002978999889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279289097935
                                         uncertainty =       0.002978999889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373727385
  error estimate for blocks of size 2^( 2) =       0.000387308204
  error estimate for blocks of size 2^( 3) =       0.000399674585
  error estimate for blocks of size 2^( 4) =       0.000408293211
  error estimate for blocks of size 2^( 5) =       0.000414550010
  error estimate for blocks of size 2^( 6) =       0.000415995717
  error estimate for blocks of size 2^( 7) =       0.000417882000

      target function =      -0.945734007561
              le_mean =     -17.212799527889
             les_mean =     296.559811764287
             stat err =       0.000414180235
             autocorr =       1.228199441591
   target nu stat err =       0.000414180235
   target dn stat err =       0.003037642738
      target stat err =       0.005316294763
              std dev =       0.528530336547
             le_variance =       0.279344316651


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721279952789e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945762747176       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945762854476       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945762885644       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945762908005       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945762932894       residual = 7.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945762944359       residual = 7.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945762958158       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945762965683       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945762970695       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945762971462       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945762972422       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945762973816       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945762974837       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945762976310       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945762976708       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945762977111       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945762977557       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945762978200       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945762978083       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945762978022       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945762978050       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945762978224       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945762978288       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945762978248       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 2.121223e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945762747176       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945762774005       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945762781798       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945762787389       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945762793611       residual = 7.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945762796478       residual = 7.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945762799927       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945762801809       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945762803063       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945762803256       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945762803493       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945762803847       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945762804103       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945762804468       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945762804563       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945762804670       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945762804774       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945762804941       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945762804908       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945762804893       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945762804902       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945762804941       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945762804964       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945762804954       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 5.303606e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945762747176       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945762753883       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945762755832       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945762757236       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945762758781       residual = 7.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945762759492       residual = 7.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945762760385       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945762760843       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945762761142       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945762761177       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945762761257       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945762761349       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945762761383       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945762761497       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945762761504       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945762761564       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945762761572       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945762761597       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945762761600       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945762761588       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945762761591       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945762761617       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945762761620       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945762761620       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 1.325936e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270921 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7717e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.977362e-01 1 1  ON 0
 uu_1                 4.330440e-02 1 1  ON 1
 uu_2                -4.189146e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107256e-01 1 1  ON 6
 uu_7                -4.251157e-02 1 1  ON 7
 uu_8                 8.648469e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027505e-01 1 1  ON 10
 ud_1                 7.593983e-02 1 1  ON 11
 ud_2                -1.845273e-02 1 1  ON 12
 ud_3                -6.888191e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357226e-01 1 1  ON 15
 ud_6                -1.369086e-01 1 1  ON 16
 ud_7                -9.605785e-02 1 1  ON 17
 ud_8                 1.390825e-03 1 1  ON 18
 ud_9                 9.066609e-02 1 1  ON 19
 eO_0                -6.845866e-01 1 1  ON 20
 eO_1                -4.098418e-01 1 1  ON 21
 eO_2                -4.963440e-02 1 1  ON 22
 eO_3                 1.714419e-01 1 1  ON 23
 eO_4                 2.547983e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514185e-01 1 1  ON 26
 eO_7                 1.164956e-01 1 1  ON 27
 eO_8                 2.796093e-02 1 1  ON 28
 eO_9                 1.837750e-02 1 1  ON 29
eH1_0                -1.952030e-01 1 1  ON 30
eH1_1                -9.632961e-02 1 1  ON 31
eH1_2                -4.927965e-02 1 1  ON 32
eH1_3                -1.897642e-02 1 1  ON 33
eH1_4                 1.663177e-02 1 1  ON 34
eH1_5                 2.420680e-02 1 1  ON 35
eH1_6                 7.670209e-02 1 1  ON 36
eH1_7                 1.107278e-01 1 1  ON 37
eH1_8                 9.201563e-02 1 1  ON 38
eH1_9                 2.427334e-02 1 1  ON 39
eH2_0                -1.961789e-01 1 1  ON 40
eH2_1                -9.716671e-02 1 1  ON 41
eH2_2                -5.029945e-02 1 1  ON 42
eH2_3                -2.014928e-02 1 1  ON 43
eH2_4                 1.553997e-02 1 1  ON 44
eH2_5                 2.428059e-02 1 1  ON 45
eH2_6                 7.650796e-02 1 1  ON 46
eH2_7                 1.129199e-01 1 1  ON 47
eH2_8                 9.607281e-02 1 1  ON 48
eH2_9                 2.646815e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.259
    reference variance = 0.257709
====================================================
  Execution time = 3.6881e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8726e-01
  Total weights = 2.0000e+06
  Execution time = 3.3913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287299589410
                                         uncertainty =       0.005032509213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287299589410
                                         uncertainty =       0.005032509213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378983036
  error estimate for blocks of size 2^( 2) =       0.000392151550
  error estimate for blocks of size 2^( 3) =       0.000404235351
  error estimate for blocks of size 2^( 4) =       0.000412821866
  error estimate for blocks of size 2^( 5) =       0.000417852634
  error estimate for blocks of size 2^( 6) =       0.000420146362
  error estimate for blocks of size 2^( 7) =       0.000421007959

      target function =      -0.932204952151
              le_mean =     -17.212218849401
             les_mean =     296.547733859424
             stat err =       0.000417957205
             autocorr =       1.216253466977
   target nu stat err =       0.000417957205
   target dn stat err =       0.005335373066
      target stat err =       0.009001637937
              std dev =       0.535962949618
             le_variance =       0.287256283363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287299770299
                                         uncertainty =       0.005032522814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287299770299
                                         uncertainty =       0.005032522814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378983155
  error estimate for blocks of size 2^( 2) =       0.000392151668
  error estimate for blocks of size 2^( 3) =       0.000404235488
  error estimate for blocks of size 2^( 4) =       0.000412822042
  error estimate for blocks of size 2^( 5) =       0.000417852840
  error estimate for blocks of size 2^( 6) =       0.000420146591
  error estimate for blocks of size 2^( 7) =       0.000421008184

      target function =      -0.932204647978
              le_mean =     -17.212218848464
             les_mean =     296.547734007844
             stat err =       0.000417957414
             autocorr =       1.216253919277
   target nu stat err =       0.000417957414
   target dn stat err =       0.005335388115
      target stat err =       0.009001657314
              std dev =       0.535963118193
             le_variance =       0.287256464063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287299679861
                                         uncertainty =       0.005032516014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287299679861
                                         uncertainty =       0.005032516014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378983096
  error estimate for blocks of size 2^( 2) =       0.000392151609
  error estimate for blocks of size 2^( 3) =       0.000404235420
  error estimate for blocks of size 2^( 4) =       0.000412821954
  error estimate for blocks of size 2^( 5) =       0.000417852737
  error estimate for blocks of size 2^( 6) =       0.000420146476
  error estimate for blocks of size 2^( 7) =       0.000421008071

      target function =      -0.932204800054
              le_mean =     -17.212218848931
             les_mean =     296.547733933593
             stat err =       0.000417957310
             autocorr =       1.216253693133
   target nu stat err =       0.000417957310
   target dn stat err =       0.005335380592
      target stat err =       0.009001647627
              std dev =       0.535963033911
             le_variance =       0.287256373720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287299600716
                                         uncertainty =       0.005032510063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287299600716
                                         uncertainty =       0.005032510063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378983044
  error estimate for blocks of size 2^( 2) =       0.000392151557
  error estimate for blocks of size 2^( 3) =       0.000404235360
  error estimate for blocks of size 2^( 4) =       0.000412821877
  error estimate for blocks of size 2^( 5) =       0.000417852647
  error estimate for blocks of size 2^( 6) =       0.000420146376
  error estimate for blocks of size 2^( 7) =       0.000421007973

      target function =      -0.932204933139
              le_mean =     -17.212218849342
             les_mean =     296.547733868689
             stat err =       0.000417957218
             autocorr =       1.216253495245
   target nu stat err =       0.000417957218
   target dn stat err =       0.005335374007
      target stat err =       0.009001639148
              std dev =       0.535962960154
             le_variance =       0.287256294657


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932204952151        initial  <--
     3.9062e+02     3.9062e+03             2.1212e-06        -0.932204647978
     1.5625e+03     1.5625e+04             5.3036e-07        -0.932204800054
     6.2500e+03     6.2500e+04             1.3259e-07        -0.932204933139

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9820
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648502e-02 1 1  ON 8
 uu_9                 1.220594e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845254e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605789e-02 1 1  ON 17
 ud_8                 1.390960e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963459e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927975e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646813e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0170e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1753
    reference variance = 0.136709
====================================================
  Execution time = 3.7433e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8126e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0022e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281317849843
                                         uncertainty =       0.002659203758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281317849843
                                         uncertainty =       0.002659203758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375004162
  error estimate for blocks of size 2^( 2) =       0.000388512076
  error estimate for blocks of size 2^( 3) =       0.000400480498
  error estimate for blocks of size 2^( 4) =       0.000409914818
  error estimate for blocks of size 2^( 5) =       0.000415054737
  error estimate for blocks of size 2^( 6) =       0.000417455542
  error estimate for blocks of size 2^( 7) =       0.000419372066

      target function =      -0.942478029598
              le_mean =     -17.212113029613
             les_mean =     296.538091046708
             stat err =       0.000415449291
             autocorr =       1.227337115643
   target nu stat err =       0.000415449291
   target dn stat err =       0.002378768761
      target stat err =       0.004156337302
              std dev =       0.530335971957
             le_variance =       0.281256243152


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721211302961e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942494933359       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942494942275       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942494944343       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942494946140       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942494948048       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942494949203       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942494949763       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942494950340       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942494950429       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942494950598       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942494950622       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942494950821       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942494951041       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942494951175       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942494951255       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942494951251       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942494951259       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942494951251       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942494951232       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942494951228       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942494951226       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942494951243       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942494951261       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942494951259       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.436425e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942494933359       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942494935588       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942494936105       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942494936565       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942494937032       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942494937311       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942494937496       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942494937586       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942494937626       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942494937677       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942494937707       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942494937725       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942494937796       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942494937813       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942494937834       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942494937825       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942494937686       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942494937779       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942494937888       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942494937822       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942494937852       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942494937855       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942494937749       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942494937791       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 3.591109e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942494933359       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942494933917       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942494934046       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942494934158       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942494934277       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942494934350       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942494934319       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942494934421       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942494934427       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942494934505       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942494934323       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942494934430       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942494934464       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942494934268       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942494934373       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942494934381       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942494934231       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942494934542       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942494934465       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942494934473       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942494934637       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942494934550       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942494934223       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942494934553       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 8.977802e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.289002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7479e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.977360e-01 1 1  ON 0
 uu_1                 4.330423e-02 1 1  ON 1
 uu_2                -4.189152e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107255e-01 1 1  ON 6
 uu_7                -4.251131e-02 1 1  ON 7
 uu_8                 8.648499e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845256e-02 1 1  ON 12
 ud_3                -6.888171e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605786e-02 1 1  ON 17
 ud_8                 1.390938e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963457e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927973e-02 1 1  ON 32
eH1_3                -1.897649e-02 1 1  ON 33
eH1_4                 1.663185e-02 1 1  ON 34
eH1_5                 2.420694e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201554e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029957e-02 1 1  ON 42
eH2_3                -2.014946e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428060e-02 1 1  ON 45
eH2_6                 7.650802e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607273e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1623
    reference variance = 0.144314
====================================================
  Execution time = 3.7000e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8881e-01
  Total weights = 2.0000e+06
  Execution time = 3.3826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908478641
                                         uncertainty =       0.007000933903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908478641
                                         uncertainty =       0.007000933903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380007375
  error estimate for blocks of size 2^( 2) =       0.000393480217
  error estimate for blocks of size 2^( 3) =       0.000405898211
  error estimate for blocks of size 2^( 4) =       0.000414547677
  error estimate for blocks of size 2^( 5) =       0.000419657987
  error estimate for blocks of size 2^( 6) =       0.000422994012
  error estimate for blocks of size 2^( 7) =       0.000425019837

      target function =      -0.929524096854
              le_mean =     -17.212248333325
             les_mean =     296.550303753855
             stat err =       0.000420554878
             autocorr =       1.224789062081
   target nu stat err =       0.000420554878
   target dn stat err =       0.007251113690
      target stat err =       0.012146021460
              std dev =       0.537411583613
             le_variance =       0.288811210201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908479498
                                         uncertainty =       0.007000932500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908479498
                                         uncertainty =       0.007000932500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380007376
  error estimate for blocks of size 2^( 2) =       0.000393480219
  error estimate for blocks of size 2^( 3) =       0.000405898215
  error estimate for blocks of size 2^( 4) =       0.000414547683
  error estimate for blocks of size 2^( 5) =       0.000419657994
  error estimate for blocks of size 2^( 6) =       0.000422994021
  error estimate for blocks of size 2^( 7) =       0.000425019846

      target function =      -0.929524095458
              le_mean =     -17.212248333093
             les_mean =     296.550303746737
             stat err =       0.000420554886
             autocorr =       1.224789104379
   target nu stat err =       0.000420554886
   target dn stat err =       0.007251112228
      target stat err =       0.012146018978
              std dev =       0.537411584435
             le_variance =       0.288811211085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908479069
                                         uncertainty =       0.007000933201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908479069
                                         uncertainty =       0.007000933201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380007375
  error estimate for blocks of size 2^( 2) =       0.000393480218
  error estimate for blocks of size 2^( 3) =       0.000405898213
  error estimate for blocks of size 2^( 4) =       0.000414547680
  error estimate for blocks of size 2^( 5) =       0.000419657991
  error estimate for blocks of size 2^( 6) =       0.000422994017
  error estimate for blocks of size 2^( 7) =       0.000425019841

      target function =      -0.929524096156
              le_mean =     -17.212248333209
             les_mean =     296.550303750296
             stat err =       0.000420554882
             autocorr =       1.224789083222
   target nu stat err =       0.000420554882
   target dn stat err =       0.007251112959
      target stat err =       0.012146020219
              std dev =       0.537411584024
             le_variance =       0.288811210643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908478694
                                         uncertainty =       0.007000933815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908478694
                                         uncertainty =       0.007000933815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380007375
  error estimate for blocks of size 2^( 2) =       0.000393480217
  error estimate for blocks of size 2^( 3) =       0.000405898211
  error estimate for blocks of size 2^( 4) =       0.000414547678
  error estimate for blocks of size 2^( 5) =       0.000419657987
  error estimate for blocks of size 2^( 6) =       0.000422994013
  error estimate for blocks of size 2^( 7) =       0.000425019837

      target function =      -0.929524096767
              le_mean =     -17.212248333311
             les_mean =     296.550303753410
             stat err =       0.000420554879
             autocorr =       1.224789064724
   target nu stat err =       0.000420554879
   target dn stat err =       0.007251113599
      target stat err =       0.012146021305
              std dev =       0.537411583664
             le_variance =       0.288811210256


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.929524096854        initial  <--
     3.9062e+03     3.9062e+04             1.4364e-07        -0.929524095458
     1.5625e+04     1.5625e+05             3.5911e-08        -0.929524096156
     6.2500e+04     6.2500e+05             8.9778e-09        -0.929524096767

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0943
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648502e-02 1 1  ON 8
 uu_9                 1.220594e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845254e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605789e-02 1 1  ON 17
 ud_8                 1.390960e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963459e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927975e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646813e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0161e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2366
    reference variance = 0.25891
====================================================
  Execution time = 3.7644e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7730e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0165e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277321675644
                                         uncertainty =       0.002898784938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277321675644
                                         uncertainty =       0.002898784938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372359951
  error estimate for blocks of size 2^( 2) =       0.000386082735
  error estimate for blocks of size 2^( 3) =       0.000398137099
  error estimate for blocks of size 2^( 4) =       0.000407114278
  error estimate for blocks of size 2^( 5) =       0.000413421718
  error estimate for blocks of size 2^( 6) =       0.000417093961
  error estimate for blocks of size 2^( 7) =       0.000418072988

      target function =      -0.949314194516
              le_mean =     -17.212009337136
             les_mean =     296.530569148524
             stat err =       0.000413925736
             autocorr =       1.235716745468
   target nu stat err =       0.000413925736
   target dn stat err =       0.002775956105
      target stat err =       0.004896948824
              std dev =       0.526596492137
             le_variance =       0.277303865531


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721200933714e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949338046859       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949338047766       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949338047999       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949338048207       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949338048426       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949338048510       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949338048575       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949338048702       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949338048801       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949338048660       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949338048799       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949338048764       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949338048748       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949338048814       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949338048827       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949338048722       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949338048882       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949338048863       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949338048962       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949338048930       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949338048839       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949338048922       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949338048814       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949338049036       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 1.340291e-08

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949338046859       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949338047086       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949338047144       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949338047155       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949338047247       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949338047868       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949338047550       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949338046936       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949338047459       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949338047650       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949338047318       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949338047392       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949338047306       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949338046982       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949338047190       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949338047668       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949338047234       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949338047493       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949338047564       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949338047227       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949338046971       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949338046858       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949338047167       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949338047050       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 3.350730e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949338046859       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949338046915       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949338046930       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949338046943       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949338046956       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949338047649       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949338046966       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949338046972       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949338046241       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949338046723       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949338048311       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949338046363       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949338048435       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949338046237       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949338046589       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949338048099       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949338046927       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949338046867       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949338045903       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949338051847       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949338047672       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949338044741       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949338047244       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949338045613       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 8.376838e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.307130 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7834e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648502e-02 1 1  ON 8
 uu_9                 1.220594e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845254e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390959e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1451
    reference variance = 0.241534
====================================================
  Execution time = 3.6611e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7811e-01
  Total weights = 2.0000e+06
  Execution time = 3.3781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278131358196
                                         uncertainty =       0.002793229832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278131358196
                                         uncertainty =       0.002793229832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372898824
  error estimate for blocks of size 2^( 2) =       0.000386577135
  error estimate for blocks of size 2^( 3) =       0.000399134118
  error estimate for blocks of size 2^( 4) =       0.000407345752
  error estimate for blocks of size 2^( 5) =       0.000413674808
  error estimate for blocks of size 2^( 6) =       0.000417459522
  error estimate for blocks of size 2^( 7) =       0.000419474872

      target function =      -0.947896441168
              le_mean =     -17.212613205955
             les_mean =     296.552160304126
             stat err =       0.000414488739
             autocorr =       1.235501977016
   target nu stat err =       0.000414488739
   target dn stat err =       0.002636889639
      target stat err =       0.004649556466
              std dev =       0.527358573810
             le_variance =       0.278107065371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278131359260
                                         uncertainty =       0.002793229849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278131359260
                                         uncertainty =       0.002793229849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372898824
  error estimate for blocks of size 2^( 2) =       0.000386577136
  error estimate for blocks of size 2^( 3) =       0.000399134119
  error estimate for blocks of size 2^( 4) =       0.000407345753
  error estimate for blocks of size 2^( 5) =       0.000413674809
  error estimate for blocks of size 2^( 6) =       0.000417459524
  error estimate for blocks of size 2^( 7) =       0.000419474874

      target function =      -0.947896439316
              le_mean =     -17.212613206026
             les_mean =     296.552160307625
             stat err =       0.000414488740
             autocorr =       1.235501980295
   target nu stat err =       0.000414488740
   target dn stat err =       0.002636889646
      target stat err =       0.004649556463
              std dev =       0.527358574818
             le_variance =       0.278107066434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278131358728
                                         uncertainty =       0.002793229840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278131358728
                                         uncertainty =       0.002793229840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372898824
  error estimate for blocks of size 2^( 2) =       0.000386577136
  error estimate for blocks of size 2^( 3) =       0.000399134118
  error estimate for blocks of size 2^( 4) =       0.000407345753
  error estimate for blocks of size 2^( 5) =       0.000413674809
  error estimate for blocks of size 2^( 6) =       0.000417459523
  error estimate for blocks of size 2^( 7) =       0.000419474873

      target function =      -0.947896440242
              le_mean =     -17.212613205990
             les_mean =     296.552160305875
             stat err =       0.000414488739
             autocorr =       1.235501978656
   target nu stat err =       0.000414488739
   target dn stat err =       0.002636889643
      target stat err =       0.004649556465
              std dev =       0.527358574314
             le_variance =       0.278107065903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278131358262
                                         uncertainty =       0.002793229833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278131358262
                                         uncertainty =       0.002793229833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372898824
  error estimate for blocks of size 2^( 2) =       0.000386577135
  error estimate for blocks of size 2^( 3) =       0.000399134118
  error estimate for blocks of size 2^( 4) =       0.000407345752
  error estimate for blocks of size 2^( 5) =       0.000413674808
  error estimate for blocks of size 2^( 6) =       0.000417459522
  error estimate for blocks of size 2^( 7) =       0.000419474872

      target function =      -0.947896441052
              le_mean =     -17.212613205959
             les_mean =     296.552160304344
             stat err =       0.000414488739
             autocorr =       1.235501977224
   target nu stat err =       0.000414488739
   target dn stat err =       0.002636889639
      target stat err =       0.004649556466
              std dev =       0.527358573873
             le_variance =       0.278107065438


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947896441168        initial  <--
     3.9062e+04     3.9062e+05             1.3403e-08        -0.947896439316
     1.5625e+05     1.5625e+06             3.3507e-09        -0.947896440242
     6.2500e+05     6.2500e+06             8.3768e-10        -0.947896441052

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7051
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648502e-02 1 1  ON 8
 uu_9                 1.220594e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845254e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605789e-02 1 1  ON 17
 ud_8                 1.390960e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963459e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927975e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646813e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0154e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1952
    reference variance = 0.241766
====================================================
  Execution time = 3.7980e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9157e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291509902298
                                         uncertainty =       0.010848994555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291509902298
                                         uncertainty =       0.010848994555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381819182
  error estimate for blocks of size 2^( 2) =       0.000395404334
  error estimate for blocks of size 2^( 3) =       0.000407680100
  error estimate for blocks of size 2^( 4) =       0.000416323440
  error estimate for blocks of size 2^( 5) =       0.000421727050
  error estimate for blocks of size 2^( 6) =       0.000422081823
  error estimate for blocks of size 2^( 7) =       0.000424817470

      target function =      -0.924716758076
              le_mean =     -17.212387211736
             les_mean =     296.557845157061
             stat err =       0.000421237446
             autocorr =       1.217134169565
   target nu stat err =       0.000421237446
   target dn stat err =       0.011019608207
      target stat err =       0.018257073962
              std dev =       0.539973866142
             le_variance =       0.291571776116


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721238721174e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925078055952       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925078056082       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925078056115       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925078056132       residual = 8.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925078056092       residual = 6.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925078056246       residual = 5.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925078055959       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925078056067       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925078055876       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925078055999       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925078055654       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925078054961       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925078056399       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925078054762       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925078056258       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925078055876       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925078056687       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925078056920       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925078056155       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925078055779       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.925078058314       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.925078053984       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925078054815       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.925078055879       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.925078057150       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 1.353948e-09

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925078055952       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925078055984       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925078055993       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925078055997       residual = 8.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925078055951       residual = 6.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925078053582       residual = 5.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925078057057       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925078051676       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925078056222       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925078055665       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925078055212       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925078054756       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925078055004       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925078055147       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925078059217       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925078054310       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925078051655       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925078055287       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925078060163       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925078062151       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.925078054997       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.925078054399       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925078050426       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.925078051425       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.925078057537       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 3.384874e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925078055952       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925078055960       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925078055962       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925078055963       residual = 8.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925078055961       residual = 6.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925078072919       residual = 5.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925078055984       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925078057192       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925078054803       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925078064762       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925078072700       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925078056254       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925078040364       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925078087396       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925078049162       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925078056664       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925078061024       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925078047065       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925078066094       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925078058053       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.925078065339       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.925078028649       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925078045896       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.925078057297       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.925078059878       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 8.462254e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.326842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7997e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648502e-02 1 1  ON 8
 uu_9                 1.220594e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845254e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605789e-02 1 1  ON 17
 ud_8                 1.390960e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963459e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927975e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1147
    reference variance = 0.38087
====================================================
  Execution time = 3.6674e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9365e-01
  Total weights = 2.0000e+06
  Execution time = 3.3679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293696527821
                                         uncertainty =       0.012921603318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293696527821
                                         uncertainty =       0.012921603318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383179692
  error estimate for blocks of size 2^( 2) =       0.000396651976
  error estimate for blocks of size 2^( 3) =       0.000408844815
  error estimate for blocks of size 2^( 4) =       0.000418446414
  error estimate for blocks of size 2^( 5) =       0.000424255600
  error estimate for blocks of size 2^( 6) =       0.000426590785
  error estimate for blocks of size 2^( 7) =       0.000426565963

      target function =      -0.921172461262
              le_mean =     -17.212112270525
             les_mean =     296.550462019174
             stat err =       0.000423964690
             autocorr =       1.224205731174
   target nu stat err =       0.000423964690
   target dn stat err =       0.012973167592
      target stat err =       0.021316221815
              std dev =       0.541897917352
             le_variance =       0.293653352831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293696527605
                                         uncertainty =       0.012921603208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293696527605
                                         uncertainty =       0.012921603208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383179692
  error estimate for blocks of size 2^( 2) =       0.000396651976
  error estimate for blocks of size 2^( 3) =       0.000408844815
  error estimate for blocks of size 2^( 4) =       0.000418446414
  error estimate for blocks of size 2^( 5) =       0.000424255600
  error estimate for blocks of size 2^( 6) =       0.000426590785
  error estimate for blocks of size 2^( 7) =       0.000426565963

      target function =      -0.921172461625
              le_mean =     -17.212112270523
             les_mean =     296.550462018874
             stat err =       0.000423964690
             autocorr =       1.224205732295
   target nu stat err =       0.000423964690
   target dn stat err =       0.012973167481
      target stat err =       0.021316221650
              std dev =       0.541897917153
             le_variance =       0.293653352615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293696527713
                                         uncertainty =       0.012921603263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293696527713
                                         uncertainty =       0.012921603263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383179692
  error estimate for blocks of size 2^( 2) =       0.000396651976
  error estimate for blocks of size 2^( 3) =       0.000408844815
  error estimate for blocks of size 2^( 4) =       0.000418446414
  error estimate for blocks of size 2^( 5) =       0.000424255600
  error estimate for blocks of size 2^( 6) =       0.000426590785
  error estimate for blocks of size 2^( 7) =       0.000426565963

      target function =      -0.921172461443
              le_mean =     -17.212112270524
             les_mean =     296.550462019024
             stat err =       0.000423964690
             autocorr =       1.224205731744
   target nu stat err =       0.000423964690
   target dn stat err =       0.012973167536
      target stat err =       0.021316221733
              std dev =       0.541897917252
             le_variance =       0.293653352722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293696527807
                                         uncertainty =       0.012921603311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293696527807
                                         uncertainty =       0.012921603311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383179692
  error estimate for blocks of size 2^( 2) =       0.000396651976
  error estimate for blocks of size 2^( 3) =       0.000408844815
  error estimate for blocks of size 2^( 4) =       0.000418446414
  error estimate for blocks of size 2^( 5) =       0.000424255600
  error estimate for blocks of size 2^( 6) =       0.000426590785
  error estimate for blocks of size 2^( 7) =       0.000426565963

      target function =      -0.921172461284
              le_mean =     -17.212112270525
             les_mean =     296.550462019155
             stat err =       0.000423964690
             autocorr =       1.224205731242
   target nu stat err =       0.000423964690
   target dn stat err =       0.012973167585
      target stat err =       0.021316221805
              std dev =       0.541897917340
             le_variance =       0.293653352817


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921172461262        initial
     3.9062e+05     3.9062e+06             1.3539e-09        -0.921172461625  <--
     1.5625e+06     1.5625e+07             3.3849e-10        -0.921172461443
     6.2500e+06     6.2500e+07             8.4623e-11        -0.921172461284

*****************************************************************************
Applying the update for shift_i =   3.9062e+05     and shift_s =   3.9062e+06
*****************************************************************************

  Execution time = 5.3682e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648502e-02 1 1  ON 8
 uu_9                 1.220594e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845254e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390959e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963459e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927975e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670188e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0169e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1272
    reference variance = 0.235936
====================================================
  Execution time = 3.7625e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8294e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0019e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283014879196
                                         uncertainty =       0.002653637854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283014879196
                                         uncertainty =       0.002653637854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376125519
  error estimate for blocks of size 2^( 2) =       0.000389709995
  error estimate for blocks of size 2^( 3) =       0.000402465381
  error estimate for blocks of size 2^( 4) =       0.000411263662
  error estimate for blocks of size 2^( 5) =       0.000416386967
  error estimate for blocks of size 2^( 6) =       0.000418993980
  error estimate for blocks of size 2^( 7) =       0.000421530574

      target function =      -0.939603758384
              le_mean =     -17.211802509330
             les_mean =     296.529086290516
             stat err =       0.000417043796
             autocorr =       1.229412797530
   target nu stat err =       0.000417043796
   target dn stat err =       0.002666281529
      target stat err =       0.004612721383
              std dev =       0.531921809865
             le_variance =       0.282940811810


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721180250933e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939625462284       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939625462589       residual = 8.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939625462660       residual = 9.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939625462713       residual = 5.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939625462730       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939625462911       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939625462797       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939625462563       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939625462913       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939625462814       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939625462899       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939625462745       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939625462915       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939625462572       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939625463218       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939625462992       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939625462936       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939625463045       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939625463158       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939625463208       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939625462776       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939625462691       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939625462862       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939625462804       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939625462642       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 6.252499e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939625462284       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939625462360       residual = 8.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939625462378       residual = 9.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939625462379       residual = 5.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939625462312       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939625462944       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939625463515       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939625463145       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939625462142       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939625462869       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939625461740       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939625461538       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939625463042       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939625462706       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939625462927       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939625461913       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939625462517       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939625462935       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939625462761       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939625462246       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939625461496       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939625460923       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939625461834       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939625462413       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939625462385       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 1.563124e-09

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939625462284       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939625462303       residual = 8.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939625462307       residual = 9.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939625462310       residual = 5.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939625462648       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939625463054       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939625465230       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939625454402       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939625458725       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939625462152       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939625459183       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939625465535       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939625462325       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939625461467       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939625462343       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939625463741       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939625458434       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939625465032       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939625466758       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939625466870       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939625462698       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939625462829       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939625462637       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939625460365       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939625463578       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 3.907820e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.346730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7670e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648502e-02 1 1  ON 8
 uu_9                 1.220594e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845254e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390959e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2546
    reference variance = 0.191874
====================================================
  Execution time = 3.7084e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8950e-01
  Total weights = 2.0000e+06
  Execution time = 3.3825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289359418219
                                         uncertainty =       0.014140667680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289359418219
                                         uncertainty =       0.014140667680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380457631
  error estimate for blocks of size 2^( 2) =       0.000393992923
  error estimate for blocks of size 2^( 3) =       0.000406375829
  error estimate for blocks of size 2^( 4) =       0.000416256183
  error estimate for blocks of size 2^( 5) =       0.000421574613
  error estimate for blocks of size 2^( 6) =       0.000425359109
  error estimate for blocks of size 2^( 7) =       0.000427276862

      target function =      -0.927931560677
              le_mean =     -17.212297526877
             les_mean =     296.552682027336
             stat err =       0.000422616692
             autocorr =       1.233902070220
   target nu stat err =       0.000422616692
   target dn stat err =       0.014160852525
      target stat err =       0.023618909470
              std dev =       0.538048342023
             le_variance =       0.289496018354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289359418092
                                         uncertainty =       0.014140667562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289359418092
                                         uncertainty =       0.014140667562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380457631
  error estimate for blocks of size 2^( 2) =       0.000393992923
  error estimate for blocks of size 2^( 3) =       0.000406375830
  error estimate for blocks of size 2^( 4) =       0.000416256184
  error estimate for blocks of size 2^( 5) =       0.000421574613
  error estimate for blocks of size 2^( 6) =       0.000425359110
  error estimate for blocks of size 2^( 7) =       0.000427276862

      target function =      -0.927931560901
              le_mean =     -17.212297526889
             les_mean =     296.552682027616
             stat err =       0.000422616692
             autocorr =       1.233902073392
   target nu stat err =       0.000422616692
   target dn stat err =       0.014160852407
      target stat err =       0.023618909285
              std dev =       0.538048341903
             le_variance =       0.289496018225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289359418155
                                         uncertainty =       0.014140667621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289359418155
                                         uncertainty =       0.014140667621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380457631
  error estimate for blocks of size 2^( 2) =       0.000393992923
  error estimate for blocks of size 2^( 3) =       0.000406375829
  error estimate for blocks of size 2^( 4) =       0.000416256184
  error estimate for blocks of size 2^( 5) =       0.000421574613
  error estimate for blocks of size 2^( 6) =       0.000425359110
  error estimate for blocks of size 2^( 7) =       0.000427276862

      target function =      -0.927931560789
              le_mean =     -17.212297526883
             les_mean =     296.552682027476
             stat err =       0.000422616692
             autocorr =       1.233902071806
   target nu stat err =       0.000422616692
   target dn stat err =       0.014160852466
      target stat err =       0.023618909378
              std dev =       0.538048341963
             le_variance =       0.289496018289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289359418211
                                         uncertainty =       0.014140667673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289359418211
                                         uncertainty =       0.014140667673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380457631
  error estimate for blocks of size 2^( 2) =       0.000393992923
  error estimate for blocks of size 2^( 3) =       0.000406375829
  error estimate for blocks of size 2^( 4) =       0.000416256183
  error estimate for blocks of size 2^( 5) =       0.000421574613
  error estimate for blocks of size 2^( 6) =       0.000425359109
  error estimate for blocks of size 2^( 7) =       0.000427276862

      target function =      -0.927931560691
              le_mean =     -17.212297526878
             les_mean =     296.552682027353
             stat err =       0.000422616692
             autocorr =       1.233902070423
   target nu stat err =       0.000422616692
   target dn stat err =       0.014160852517
      target stat err =       0.023618909459
              std dev =       0.538048342016
             le_variance =       0.289496018346


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.927931560677        initial
     9.7656e+04     9.7656e+05             6.2525e-09        -0.927931560901  <--
     3.9062e+05     3.9062e+06             1.5631e-09        -0.927931560789
     1.5625e+06     1.5625e+07             3.9078e-10        -0.927931560691

*****************************************************************************
Applying the update for shift_i =   9.7656e+04     and shift_s =   9.7656e+05
*****************************************************************************

  Execution time = 5.4136e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0193e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1792
    reference variance = 0.202041
====================================================
  Execution time = 3.7884e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8082e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0049e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280881187033
                                         uncertainty =       0.002455176251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280881187033
                                         uncertainty =       0.002455176251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374711046
  error estimate for blocks of size 2^( 2) =       0.000388449709
  error estimate for blocks of size 2^( 3) =       0.000400635581
  error estimate for blocks of size 2^( 4) =       0.000409814045
  error estimate for blocks of size 2^( 5) =       0.000415188435
  error estimate for blocks of size 2^( 6) =       0.000418866006
  error estimate for blocks of size 2^( 7) =       0.000418752552

      target function =      -0.943208878185
              le_mean =     -17.212578586369
             les_mean =     296.553678187929
             stat err =       0.000415655259
             autocorr =       1.230477192408
   target nu stat err =       0.000415655259
   target dn stat err =       0.002581533683
      target stat err =       0.004510330135
              std dev =       0.529921443614
             le_variance =       0.280816736402


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721257858637e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943229341419       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943229342630       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943229342915       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943229343151       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943229343374       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943229343528       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943229343665       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943229343800       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943229343811       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943229343912       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943229343833       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943229343813       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943229343848       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943229343801       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943229343847       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943229343878       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943229343921       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943229343918       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943229344031       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943229343914       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943229344018       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943229344020       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943229343886       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943229343873       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943229343957       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 2.005042e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943229341419       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943229341722       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943229341793       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943229341752       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943229342067       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943229341780       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943229342069       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943229342132       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943229341885       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943229342005       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943229342069       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943229342084       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943229341801       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943229342330       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943229342031       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943229342175       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943229342150       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943229342169       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943229342071       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943229341877       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943229341445       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943229341907       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943229341922       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943229342071       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943229342273       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 5.012606e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943229341419       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943229341495       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943229341512       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943229341690       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943229341623       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943229341572       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943229342199       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943229341215       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943229340800       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943229342311       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943229341294       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943229340941       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943229341607       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943229340218       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943229342485       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943229342618       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943229341478       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943229341275       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943229341923       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943229341592       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943229341111       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943229341107       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943229341165       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943229338978       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943229341809       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 1.253151e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.366605 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7959e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251129e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390955e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201554e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029958e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2423
    reference variance = 0.257915
====================================================
  Execution time = 3.6746e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8243e-01
  Total weights = 2.0000e+06
  Execution time = 3.3624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282416899231
                                         uncertainty =       0.003363478981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282416899231
                                         uncertainty =       0.003363478981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375783871
  error estimate for blocks of size 2^( 2) =       0.000389322341
  error estimate for blocks of size 2^( 3) =       0.000402219129
  error estimate for blocks of size 2^( 4) =       0.000410462578
  error estimate for blocks of size 2^( 5) =       0.000415815500
  error estimate for blocks of size 2^( 6) =       0.000418279450
  error estimate for blocks of size 2^( 7) =       0.000420125573

      target function =      -0.940442811621
              le_mean =     -17.212291296487
             les_mean =     296.545398569508
             stat err =       0.000416170775
             autocorr =       1.226498121840
   target nu stat err =       0.000416170775
   target dn stat err =       0.003418937911
      target stat err =       0.005899387691
              std dev =       0.531438647079
             le_variance =       0.282427035609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282416899864
                                         uncertainty =       0.003363478917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282416899864
                                         uncertainty =       0.003363478917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375783872
  error estimate for blocks of size 2^( 2) =       0.000389322341
  error estimate for blocks of size 2^( 3) =       0.000402219130
  error estimate for blocks of size 2^( 4) =       0.000410462579
  error estimate for blocks of size 2^( 5) =       0.000415815502
  error estimate for blocks of size 2^( 6) =       0.000418279452
  error estimate for blocks of size 2^( 7) =       0.000420125575

      target function =      -0.940442810539
              le_mean =     -17.212291296429
             les_mean =     296.545398568142
             stat err =       0.000416170777
             autocorr =       1.226498127043
   target nu stat err =       0.000416170777
   target dn stat err =       0.003418937856
      target stat err =       0.005899387584
              std dev =       0.531438647676
             le_variance =       0.282427036244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282416899548
                                         uncertainty =       0.003363478949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282416899548
                                         uncertainty =       0.003363478949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375783871
  error estimate for blocks of size 2^( 2) =       0.000389322341
  error estimate for blocks of size 2^( 3) =       0.000402219129
  error estimate for blocks of size 2^( 4) =       0.000410462578
  error estimate for blocks of size 2^( 5) =       0.000415815501
  error estimate for blocks of size 2^( 6) =       0.000418279451
  error estimate for blocks of size 2^( 7) =       0.000420125574

      target function =      -0.940442811080
              le_mean =     -17.212291296458
             les_mean =     296.545398568825
             stat err =       0.000416170776
             autocorr =       1.226498124438
   target nu stat err =       0.000416170776
   target dn stat err =       0.003418937884
      target stat err =       0.005899387638
              std dev =       0.531438647378
             le_variance =       0.282427035926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282416899271
                                         uncertainty =       0.003363478977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282416899271
                                         uncertainty =       0.003363478977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375783871
  error estimate for blocks of size 2^( 2) =       0.000389322341
  error estimate for blocks of size 2^( 3) =       0.000402219129
  error estimate for blocks of size 2^( 4) =       0.000410462578
  error estimate for blocks of size 2^( 5) =       0.000415815500
  error estimate for blocks of size 2^( 6) =       0.000418279450
  error estimate for blocks of size 2^( 7) =       0.000420125574

      target function =      -0.940442811553
              le_mean =     -17.212291296483
             les_mean =     296.545398569423
             stat err =       0.000416170776
             autocorr =       1.226498122155
   target nu stat err =       0.000416170776
   target dn stat err =       0.003418937908
      target stat err =       0.005899387684
              std dev =       0.531438647116
             le_variance =       0.282427035649


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940442811621        initial  <--
     2.4414e+04     2.4414e+05             2.0050e-08        -0.940442810539
     9.7656e+04     9.7656e+05             5.0126e-09        -0.940442811080
     3.9062e+05     3.9062e+06             1.2532e-09        -0.940442811553

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.6964
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0166e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1915
    reference variance = 0.237811
====================================================
  Execution time = 3.7731e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7891e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0134e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278937639774
                                         uncertainty =       0.003295990589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278937639774
                                         uncertainty =       0.003295990589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373437003
  error estimate for blocks of size 2^( 2) =       0.000387042616
  error estimate for blocks of size 2^( 3) =       0.000399835309
  error estimate for blocks of size 2^( 4) =       0.000408702779
  error estimate for blocks of size 2^( 5) =       0.000413897648
  error estimate for blocks of size 2^( 6) =       0.000416601790
  error estimate for blocks of size 2^( 7) =       0.000418778806

      target function =      -0.946513492455
              le_mean =     -17.212002409081
             les_mean =     296.531937181674
             stat err =       0.000414495256
             autocorr =       1.231982188406
   target nu stat err =       0.000414495256
   target dn stat err =       0.003238797952
      target stat err =       0.005662010061
              std dev =       0.528119674817
             le_variance =       0.278910390929


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721200240908e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946546796410       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946546796508       residual = 8.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946546796525       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946546796554       residual = 8.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946546796513       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946546796560       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946546796332       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946546796801       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946546796251       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946546796607       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946546796609       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946546796612       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946546796050       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946546797335       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946546796667       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946546796618       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946546796602       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946546796098       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946546796959       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946546796248       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946546795602       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946546797004       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946546796466       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946546798007       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 2.314686e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946546796410       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946546796434       residual = 8.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946546796439       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946546796746       residual = 8.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946546795902       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946546796453       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946546796456       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946546796457       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946546796458       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946546796767       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946546796150       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946546795657       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946546795624       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946546796956       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946546795064       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946546797060       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946546795613       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946546796339       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946546796882       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946546798446       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946546800575       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946546792441       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946546794271       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946546797967       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 5.786716e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946546796410       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946546796416       residual = 8.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946546796417       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946546796419       residual = 8.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946546794923       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946546796421       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946546790312       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946546800339       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946546787724       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946546801412       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946546786631       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946546803816       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946546794153       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946546796953       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946546810509       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946546800129       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946546814107       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946546801201       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946546792099       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946546815585       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946546781004       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946546778828       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946546803067       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946546787716       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 1.446672e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.384725 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7890e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2089
    reference variance = 0.150391
====================================================
  Execution time = 3.7297e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8120e-01
  Total weights = 2.0000e+06
  Execution time = 3.3728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281225875784
                                         uncertainty =       0.003014076437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281225875784
                                         uncertainty =       0.003014076437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374968700
  error estimate for blocks of size 2^( 2) =       0.000388265150
  error estimate for blocks of size 2^( 3) =       0.000400551222
  error estimate for blocks of size 2^( 4) =       0.000409206077
  error estimate for blocks of size 2^( 5) =       0.000414804036
  error estimate for blocks of size 2^( 6) =       0.000416929545
  error estimate for blocks of size 2^( 7) =       0.000418537695

      target function =      -0.942553990804
              le_mean =     -17.212214724352
             les_mean =     296.541538629263
             stat err =       0.000414869338
             autocorr =       1.224144375494
   target nu stat err =       0.000414869338
   target dn stat err =       0.003025439023
      target stat err =       0.005254410173
              std dev =       0.530285821662
             le_variance =       0.281203052656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281225875841
                                         uncertainty =       0.003014076434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281225875841
                                         uncertainty =       0.003014076434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374968701
  error estimate for blocks of size 2^( 2) =       0.000388265150
  error estimate for blocks of size 2^( 3) =       0.000400551222
  error estimate for blocks of size 2^( 4) =       0.000409206077
  error estimate for blocks of size 2^( 5) =       0.000414804036
  error estimate for blocks of size 2^( 6) =       0.000416929545
  error estimate for blocks of size 2^( 7) =       0.000418537695

      target function =      -0.942553990707
              le_mean =     -17.212214724352
             les_mean =     296.541538629295
             stat err =       0.000414869338
             autocorr =       1.224144375714
   target nu stat err =       0.000414869338
   target dn stat err =       0.003025439019
      target stat err =       0.005254410164
              std dev =       0.530285821716
             le_variance =       0.281203052713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281225875812
                                         uncertainty =       0.003014076436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281225875812
                                         uncertainty =       0.003014076436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374968700
  error estimate for blocks of size 2^( 2) =       0.000388265150
  error estimate for blocks of size 2^( 3) =       0.000400551222
  error estimate for blocks of size 2^( 4) =       0.000409206077
  error estimate for blocks of size 2^( 5) =       0.000414804036
  error estimate for blocks of size 2^( 6) =       0.000416929545
  error estimate for blocks of size 2^( 7) =       0.000418537695

      target function =      -0.942553990755
              le_mean =     -17.212214724352
             les_mean =     296.541538629279
             stat err =       0.000414869338
             autocorr =       1.224144375606
   target nu stat err =       0.000414869338
   target dn stat err =       0.003025439021
      target stat err =       0.005254410169
              std dev =       0.530285821689
             le_variance =       0.281203052684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281225875787
                                         uncertainty =       0.003014076437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281225875787
                                         uncertainty =       0.003014076437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374968700
  error estimate for blocks of size 2^( 2) =       0.000388265150
  error estimate for blocks of size 2^( 3) =       0.000400551222
  error estimate for blocks of size 2^( 4) =       0.000409206077
  error estimate for blocks of size 2^( 5) =       0.000414804036
  error estimate for blocks of size 2^( 6) =       0.000416929545
  error estimate for blocks of size 2^( 7) =       0.000418537695

      target function =      -0.942553990798
              le_mean =     -17.212214724352
             les_mean =     296.541538629265
             stat err =       0.000414869338
             autocorr =       1.224144375504
   target nu stat err =       0.000414869338
   target dn stat err =       0.003025439023
      target stat err =       0.005254410173
              std dev =       0.530285821666
             le_variance =       0.281203052660


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942553990804        initial  <--
     2.4414e+05     2.4414e+06             2.3147e-09        -0.942553990707
     9.7656e+05     9.7656e+06             5.7867e-10        -0.942553990755
     3.9062e+06     3.9062e+07             1.4467e-10        -0.942553990798

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.2943
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0219e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2314
    reference variance = 0.344764
====================================================
  Execution time = 3.7868e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.1395e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9158e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313973429430
                                         uncertainty =       0.032986432103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313973429430
                                         uncertainty =       0.032986432103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396200412
  error estimate for blocks of size 2^( 2) =       0.000409268285
  error estimate for blocks of size 2^( 3) =       0.000420942327
  error estimate for blocks of size 2^( 4) =       0.000428977079
  error estimate for blocks of size 2^( 5) =       0.000434835957
  error estimate for blocks of size 2^( 6) =       0.000436334225
  error estimate for blocks of size 2^( 7) =       0.000437450731

      target function =      -0.886551920227
              le_mean =     -17.212346609009
             les_mean =     296.578825164859
             stat err =       0.000434399498
             autocorr =       1.202122659931
   target nu stat err =       0.000434399498
   target dn stat err =       0.033327158494
      target stat err =       0.050856385674
              std dev =       0.560311996265
             le_variance =       0.313949533159


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721234660901e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.889453148061       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.889453148119       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.889453148137       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.889453148156       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.889453148163       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.889453148175       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.889453148182       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.889453148188       residual = 6.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.889453142807       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.889453147454       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.889453134952       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.889453143127       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.889453151861       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.889453144985       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.889453148276       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.889453145127       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.889453148816       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.889453151799       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.889453150631       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.889453140767       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.889453146822       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.889453143185       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.889453144787       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.889453149088       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.889453148553       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.889453155997       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.026324e-09

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.889453148061       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.889453148076       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.889453148080       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.889453145653       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.889453147757       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.889453156194       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.889453136955       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.889453147386       residual = 6.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.889453150883       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.889453157120       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.889453132635       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.889453145164       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.889453145774       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.889453173994       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.889453136531       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.889453110775       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.889453142981       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.889453145444       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.889453144299       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.889453153688       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.889453121531       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.889453174712       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.889453088081       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.889453151330       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.889453112591       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.889453154794       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 2.565801e-10

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.889453148061       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.889453148065       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.889453148066       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.889453148067       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.889453148068       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.889453148068       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.889453131678       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.889453148069       residual = 6.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.889453103543       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.889453077283       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.889453136824       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.889453010464       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.889453142242       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.889453179773       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.889453118581       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.889453205460       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.889453090881       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.889453160928       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.889453226350       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.889453290674       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.889453263157       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.889452970015       residual = 9.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.889453015924       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.889453080023       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.889453106787       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.889452955733       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 6.414465e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.406196 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7812e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.162
    reference variance = 0.225969
====================================================
  Execution time = 3.6952e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8168e-01
  Total weights = 2.0000e+06
  Execution time = 3.3678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281728486623
                                         uncertainty =       0.002943563000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281728486623
                                         uncertainty =       0.002943563000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375287500
  error estimate for blocks of size 2^( 2) =       0.000388920201
  error estimate for blocks of size 2^( 3) =       0.000401562385
  error estimate for blocks of size 2^( 4) =       0.000410243243
  error estimate for blocks of size 2^( 5) =       0.000416424147
  error estimate for blocks of size 2^( 6) =       0.000420847541
  error estimate for blocks of size 2^( 7) =       0.000421366658

      target function =      -0.941701825192
              le_mean =     -17.212824238463
             les_mean =     296.562999538409
             stat err =       0.000417220398
             autocorr =       1.235955592584
   target nu stat err =       0.000417220398
   target dn stat err =       0.003045399196
      target stat err =       0.005285751137
              std dev =       0.530736672010
             le_variance =       0.281681415016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281728486536
                                         uncertainty =       0.002943562997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281728486536
                                         uncertainty =       0.002943562997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375287500
  error estimate for blocks of size 2^( 2) =       0.000388920200
  error estimate for blocks of size 2^( 3) =       0.000401562385
  error estimate for blocks of size 2^( 4) =       0.000410243243
  error estimate for blocks of size 2^( 5) =       0.000416424147
  error estimate for blocks of size 2^( 6) =       0.000420847541
  error estimate for blocks of size 2^( 7) =       0.000421366658

      target function =      -0.941701825340
              le_mean =     -17.212824238462
             les_mean =     296.562999538284
             stat err =       0.000417220397
             autocorr =       1.235955592682
   target nu stat err =       0.000417220397
   target dn stat err =       0.003045399193
      target stat err =       0.005285751134
              std dev =       0.530736671928
             le_variance =       0.281681414930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281728486580
                                         uncertainty =       0.002943562998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281728486580
                                         uncertainty =       0.002943562998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375287500
  error estimate for blocks of size 2^( 2) =       0.000388920201
  error estimate for blocks of size 2^( 3) =       0.000401562385
  error estimate for blocks of size 2^( 4) =       0.000410243243
  error estimate for blocks of size 2^( 5) =       0.000416424147
  error estimate for blocks of size 2^( 6) =       0.000420847541
  error estimate for blocks of size 2^( 7) =       0.000421366658

      target function =      -0.941701825266
              le_mean =     -17.212824238463
             les_mean =     296.562999538346
             stat err =       0.000417220397
             autocorr =       1.235955592633
   target nu stat err =       0.000417220397
   target dn stat err =       0.003045399195
      target stat err =       0.005285751135
              std dev =       0.530736671969
             le_variance =       0.281681414973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281728486617
                                         uncertainty =       0.002943563000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281728486617
                                         uncertainty =       0.002943563000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375287500
  error estimate for blocks of size 2^( 2) =       0.000388920201
  error estimate for blocks of size 2^( 3) =       0.000401562385
  error estimate for blocks of size 2^( 4) =       0.000410243243
  error estimate for blocks of size 2^( 5) =       0.000416424147
  error estimate for blocks of size 2^( 6) =       0.000420847541
  error estimate for blocks of size 2^( 7) =       0.000421366658

      target function =      -0.941701825201
              le_mean =     -17.212824238463
             les_mean =     296.562999538401
             stat err =       0.000417220398
             autocorr =       1.235955592588
   target nu stat err =       0.000417220398
   target dn stat err =       0.003045399196
      target stat err =       0.005285751136
              std dev =       0.530736672004
             le_variance =       0.281681415010


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941701825192        initial
     2.4414e+06     2.4414e+07             1.0263e-09        -0.941701825340  <--
     9.7656e+06     9.7656e+07             2.5658e-10        -0.941701825266
     3.9062e+07     3.9062e+08             6.4145e-11        -0.941701825201

*****************************************************************************
Applying the update for shift_i =   2.4414e+06     and shift_s =   2.4414e+07
*****************************************************************************

  Execution time = 5.3940e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0176e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1788
    reference variance = 0.221802
====================================================
  Execution time = 3.7852e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8320e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0144e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283198527034
                                         uncertainty =       0.003435416462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283198527034
                                         uncertainty =       0.003435416462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376300458
  error estimate for blocks of size 2^( 2) =       0.000390006501
  error estimate for blocks of size 2^( 3) =       0.000402521451
  error estimate for blocks of size 2^( 4) =       0.000411732338
  error estimate for blocks of size 2^( 5) =       0.000416742575
  error estimate for blocks of size 2^( 6) =       0.000419786170
  error estimate for blocks of size 2^( 7) =       0.000422118946

      target function =      -0.939112888240
              le_mean =     -17.212181307075
             les_mean =     296.542389274763
             stat err =       0.000417595007
             autocorr =       1.231518959600
   target nu stat err =       0.000417595007
   target dn stat err =       0.003785096278
      target stat err =       0.006501946616
              std dev =       0.532169210625
             le_variance =       0.283204068737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721218130708e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939156733773       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939156733827       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939156733845       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939156733858       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939156733858       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939156733252       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939156734218       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939156734222       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939156734538       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939156733500       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939156733954       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939156731628       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939156733260       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939156735009       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939156734886       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939156734784       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939156733818       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939156735700       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939156733380       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939156734815       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939156734173       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939156732773       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939156733457       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939156732767       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 1.162625e-09

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939156733773       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939156733787       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939156733791       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939156734711       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939156733225       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939156734026       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939156736732       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939156728711       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939156737258       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939156729772       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939156727977       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939156732901       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939156739429       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939156731184       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939156731067       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939156733469       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939156726986       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939156725544       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939156736141       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939156735438       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939156734245       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939156736574       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939156720860       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939156738216       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 2.906564e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939156733773       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939156733777       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939156733778       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939156733779       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939156733768       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939156757938       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939156727620       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939156725267       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939156744073       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939156729173       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939156747488       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939156730493       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939156760091       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939156728431       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939156764445       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939156740546       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939156689710       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939156752603       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939156707230       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939156742854       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939156734762       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939156726033       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939156708865       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939156787026       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 7.266433e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.424238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8020e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2113
    reference variance = 0.177087
====================================================
  Execution time = 3.6640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8495e-01
  Total weights = 2.0000e+06
  Execution time = 3.3787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285034509017
                                         uncertainty =       0.003693413033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285034509017
                                         uncertainty =       0.003693413033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377461928
  error estimate for blocks of size 2^( 2) =       0.000391085588
  error estimate for blocks of size 2^( 3) =       0.000403847131
  error estimate for blocks of size 2^( 4) =       0.000412450081
  error estimate for blocks of size 2^( 5) =       0.000417634142
  error estimate for blocks of size 2^( 6) =       0.000420192492
  error estimate for blocks of size 2^( 7) =       0.000422661878

      target function =      -0.936140511044
              le_mean =     -17.212122380587
             les_mean =     296.542111716539
             stat err =       0.000418234648
             autocorr =       1.227704106633
   target nu stat err =       0.000418234648
   target dn stat err =       0.003711732627
      target stat err =       0.006337036894
              std dev =       0.533811778345
             le_variance =       0.284955014700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285034509075
                                         uncertainty =       0.003693413041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285034509075
                                         uncertainty =       0.003693413041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377461928
  error estimate for blocks of size 2^( 2) =       0.000391085588
  error estimate for blocks of size 2^( 3) =       0.000403847131
  error estimate for blocks of size 2^( 4) =       0.000412450081
  error estimate for blocks of size 2^( 5) =       0.000417634142
  error estimate for blocks of size 2^( 6) =       0.000420192492
  error estimate for blocks of size 2^( 7) =       0.000422661878

      target function =      -0.936140510945
              le_mean =     -17.212122380588
             les_mean =     296.542111716628
             stat err =       0.000418234648
             autocorr =       1.227704107153
   target nu stat err =       0.000418234648
   target dn stat err =       0.003711732635
      target stat err =       0.006337036906
              std dev =       0.533811778400
             le_variance =       0.284955014758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285034509046
                                         uncertainty =       0.003693413037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285034509046
                                         uncertainty =       0.003693413037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377461928
  error estimate for blocks of size 2^( 2) =       0.000391085588
  error estimate for blocks of size 2^( 3) =       0.000403847131
  error estimate for blocks of size 2^( 4) =       0.000412450081
  error estimate for blocks of size 2^( 5) =       0.000417634142
  error estimate for blocks of size 2^( 6) =       0.000420192492
  error estimate for blocks of size 2^( 7) =       0.000422661878

      target function =      -0.936140510994
              le_mean =     -17.212122380588
             les_mean =     296.542111716583
             stat err =       0.000418234648
             autocorr =       1.227704106888
   target nu stat err =       0.000418234648
   target dn stat err =       0.003711732631
      target stat err =       0.006337036900
              std dev =       0.533811778373
             le_variance =       0.284955014729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285034509020
                                         uncertainty =       0.003693413034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285034509020
                                         uncertainty =       0.003693413034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377461928
  error estimate for blocks of size 2^( 2) =       0.000391085588
  error estimate for blocks of size 2^( 3) =       0.000403847131
  error estimate for blocks of size 2^( 4) =       0.000412450081
  error estimate for blocks of size 2^( 5) =       0.000417634142
  error estimate for blocks of size 2^( 6) =       0.000420192492
  error estimate for blocks of size 2^( 7) =       0.000422661878

      target function =      -0.936140511038
              le_mean =     -17.212122380587
             les_mean =     296.542111716544
             stat err =       0.000418234648
             autocorr =       1.227704106672
   target nu stat err =       0.000418234648
   target dn stat err =       0.003711732628
      target stat err =       0.006337036895
              std dev =       0.533811778349
             le_variance =       0.284955014704


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936140511044        initial  <--
     6.1035e+05     6.1035e+06             1.1626e-09        -0.936140510945
     2.4414e+06     2.4414e+07             2.9066e-10        -0.936140510994
     9.7656e+06     9.7656e+07             7.2664e-11        -0.936140511038

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.6919
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0172e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2461
    reference variance = 0.430684
====================================================
  Execution time = 3.7436e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7811e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0071e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278001231585
                                         uncertainty =       0.002529322671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278001231585
                                         uncertainty =       0.002529322671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372902580
  error estimate for blocks of size 2^( 2) =       0.000386651059
  error estimate for blocks of size 2^( 3) =       0.000399750533
  error estimate for blocks of size 2^( 4) =       0.000408629610
  error estimate for blocks of size 2^( 5) =       0.000414222186
  error estimate for blocks of size 2^( 6) =       0.000417380207
  error estimate for blocks of size 2^( 7) =       0.000419615298

      target function =      -0.947903540141
              le_mean =     -17.212305644929
             les_mean =     296.541578144410
             stat err =       0.000414961825
             autocorr =       1.238298973341
   target nu stat err =       0.000414961825
   target dn stat err =       0.002299932320
      target stat err =       0.004070214951
              std dev =       0.527363886717
             le_variance =       0.278112669013


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721230564493e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947919817920       residual = 9.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947919817923       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947919817924       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947919817925       residual = 9.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947919817926       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947919812359       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947919817333       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947919818406       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947919817928       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947919817928       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947919835108       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947919817928       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947919808801       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947919822318       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947919807118       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947919817880       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947919794561       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947919800344       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947919825472       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947919817350       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947919827295       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947919815492       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947919837108       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947919815560       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 8.218770e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947919817920       residual = 9.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947919817921       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947919817921       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947919813538       residual = 9.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947919845359       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947919817921       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947919817922       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947919817922       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947919759256       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947919845392       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947919847515       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947919806100       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947919817360       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947919785286       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947919799900       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947919823218       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947919805577       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947919733151       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947919887673       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947919860504       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947919824932       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947919731821       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947919823870       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947919824461       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 2.054736e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947919817920       residual = 9.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947919817920       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947919817920       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947919817920       residual = 9.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947919866578       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947919817920       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947919695881       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947919817920       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947919689881       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947919817920       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947919817920       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947919899601       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947919967714       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947919765395       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947919757257       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947919756129       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947919355175       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947919718528       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947919821862       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947919845125       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947919803316       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947919765528       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947919463768       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947919666716       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 5.137397e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.442328 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7532e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2139
    reference variance = 0.241011
====================================================
  Execution time = 3.6780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8674e-01
  Total weights = 2.0000e+06
  Execution time = 3.3695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286819948580
                                         uncertainty =       0.004839529355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286819948580
                                         uncertainty =       0.004839529355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378644557
  error estimate for blocks of size 2^( 2) =       0.000392130184
  error estimate for blocks of size 2^( 3) =       0.000404460490
  error estimate for blocks of size 2^( 4) =       0.000413393050
  error estimate for blocks of size 2^( 5) =       0.000418754186
  error estimate for blocks of size 2^( 6) =       0.000419957732
  error estimate for blocks of size 2^( 7) =       0.000420613371

      target function =      -0.933146927943
              le_mean =     -17.211199665580
             les_mean =     296.512137186352
             stat err =       0.000418179585
             autocorr =       1.219725820341
   target nu stat err =       0.000418179585
   target dn stat err =       0.004833018239
      target stat err =       0.008160571512
              std dev =       0.535484267976
             le_variance =       0.286743401250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286819948580
                                         uncertainty =       0.004839529355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286819948580
                                         uncertainty =       0.004839529355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378644557
  error estimate for blocks of size 2^( 2) =       0.000392130184
  error estimate for blocks of size 2^( 3) =       0.000404460490
  error estimate for blocks of size 2^( 4) =       0.000413393050
  error estimate for blocks of size 2^( 5) =       0.000418754186
  error estimate for blocks of size 2^( 6) =       0.000419957732
  error estimate for blocks of size 2^( 7) =       0.000420613371

      target function =      -0.933146927942
              le_mean =     -17.211199665580
             les_mean =     296.512137186345
             stat err =       0.000418179585
             autocorr =       1.219725820362
   target nu stat err =       0.000418179585
   target dn stat err =       0.004833018239
      target stat err =       0.008160571512
              std dev =       0.535484267977
             le_variance =       0.286743401250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286819948580
                                         uncertainty =       0.004839529355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286819948580
                                         uncertainty =       0.004839529355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378644557
  error estimate for blocks of size 2^( 2) =       0.000392130184
  error estimate for blocks of size 2^( 3) =       0.000404460490
  error estimate for blocks of size 2^( 4) =       0.000413393050
  error estimate for blocks of size 2^( 5) =       0.000418754186
  error estimate for blocks of size 2^( 6) =       0.000419957732
  error estimate for blocks of size 2^( 7) =       0.000420613371

      target function =      -0.933146927943
              le_mean =     -17.211199665580
             les_mean =     296.512137186348
             stat err =       0.000418179585
             autocorr =       1.219725820353
   target nu stat err =       0.000418179585
   target dn stat err =       0.004833018239
      target stat err =       0.008160571512
              std dev =       0.535484267976
             le_variance =       0.286743401250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286819948580
                                         uncertainty =       0.004839529355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286819948580
                                         uncertainty =       0.004839529355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378644557
  error estimate for blocks of size 2^( 2) =       0.000392130184
  error estimate for blocks of size 2^( 3) =       0.000404460490
  error estimate for blocks of size 2^( 4) =       0.000413393050
  error estimate for blocks of size 2^( 5) =       0.000418754186
  error estimate for blocks of size 2^( 6) =       0.000419957732
  error estimate for blocks of size 2^( 7) =       0.000420613371

      target function =      -0.933146927943
              le_mean =     -17.211199665580
             les_mean =     296.512137186351
             stat err =       0.000418179585
             autocorr =       1.219725820344
   target nu stat err =       0.000418179585
   target dn stat err =       0.004833018239
      target stat err =       0.008160571512
              std dev =       0.535484267976
             le_variance =       0.286743401250


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933146927943        initial  <--
     6.1035e+06     6.1035e+07             8.2188e-11        -0.933146927942
     2.4414e+07     2.4414e+08             2.0547e-11        -0.933146927943
     9.7656e+07     9.7656e+08             5.1374e-12        -0.933146927943

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7780
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0132e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2117
    reference variance = 0.675794
====================================================
  Execution time = 3.7494e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8754e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9812e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287300485722
                                         uncertainty =       0.005514700648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287300485722
                                         uncertainty =       0.005514700648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379173118
  error estimate for blocks of size 2^( 2) =       0.000392521914
  error estimate for blocks of size 2^( 3) =       0.000404837494
  error estimate for blocks of size 2^( 4) =       0.000413630623
  error estimate for blocks of size 2^( 5) =       0.000419305747
  error estimate for blocks of size 2^( 6) =       0.000422060029
  error estimate for blocks of size 2^( 7) =       0.000425031649

      target function =      -0.931710694588
              le_mean =     -17.212190892892
             les_mean =     296.547059696439
             stat err =       0.000420007012
             autocorr =       1.226981464591
   target nu stat err =       0.000420007012
   target dn stat err =       0.005691908645
      target stat err =       0.009588833106
              std dev =       0.536231765977
             le_variance =       0.287544506843


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721219089289e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931808714652       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931808714652       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931808714652       residual = 7.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931808714651       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931808714804       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931808573234       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931808789001       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931808750502       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931808582993       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931808761880       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931808931988       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931808648611       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931808656966       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931808720447       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931808792061       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931808800949       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931808720354       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931808626527       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931808723512       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931808856165       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931808972748       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931808669093       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931808754456       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931808671697       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 8.527875e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931808714652       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931808714652       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931808714652       residual = 7.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931808714652       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931808714102       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931809021021       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931808724339       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931808671815       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931808601692       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931809165011       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931809450610       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931808929089       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931808728840       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931808283251       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931808538665       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931808647919       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931809130813       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931808625500       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931808413138       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931808673585       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931808858271       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931808235403       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931810061057       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931810281439       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 2.131171e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931808714652       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931808714652       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931808714652       residual = 7.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931808714652       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931808703474       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931808785019       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931807522836       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931810202626       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931809133355       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931807187475       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.931808899145       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931808941765       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931806533161       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931810970350       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931810252286       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.931810522009       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931809753231       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.931806337708       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931806681409       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.931807414927       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931809349170       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.931807624204       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.931803404795       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931805582513       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+08 is 5.337415e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.460496 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7502e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1711
    reference variance = 0.180126
====================================================
  Execution time = 3.6959e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8046e-01
  Total weights = 2.0000e+06
  Execution time = 3.3569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280346469851
                                         uncertainty =       0.002456123790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280346469851
                                         uncertainty =       0.002456123790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374473558
  error estimate for blocks of size 2^( 2) =       0.000388082931
  error estimate for blocks of size 2^( 3) =       0.000400897827
  error estimate for blocks of size 2^( 4) =       0.000409787759
  error estimate for blocks of size 2^( 5) =       0.000414362189
  error estimate for blocks of size 2^( 6) =       0.000416583972
  error estimate for blocks of size 2^( 7) =       0.000417440902

      target function =      -0.943828327520
              le_mean =     -17.212401096154
             les_mean =     296.547212245430
             stat err =       0.000414543705
             autocorr =       1.225457733215
   target nu stat err =       0.000414543705
   target dn stat err =       0.002686607303
      target stat err =       0.004692958898
              std dev =       0.529585583994
             le_variance =       0.280460890775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280346469852
                                         uncertainty =       0.002456123790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280346469852
                                         uncertainty =       0.002456123790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374473558
  error estimate for blocks of size 2^( 2) =       0.000388082931
  error estimate for blocks of size 2^( 3) =       0.000400897827
  error estimate for blocks of size 2^( 4) =       0.000409787759
  error estimate for blocks of size 2^( 5) =       0.000414362189
  error estimate for blocks of size 2^( 6) =       0.000416583972
  error estimate for blocks of size 2^( 7) =       0.000417440902

      target function =      -0.943828327519
              le_mean =     -17.212401096154
             les_mean =     296.547212245431
             stat err =       0.000414543705
             autocorr =       1.225457733218
   target nu stat err =       0.000414543705
   target dn stat err =       0.002686607303
      target stat err =       0.004692958898
              std dev =       0.529585583995
             le_variance =       0.280460890775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280346469851
                                         uncertainty =       0.002456123790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280346469851
                                         uncertainty =       0.002456123790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374473558
  error estimate for blocks of size 2^( 2) =       0.000388082931
  error estimate for blocks of size 2^( 3) =       0.000400897827
  error estimate for blocks of size 2^( 4) =       0.000409787759
  error estimate for blocks of size 2^( 5) =       0.000414362189
  error estimate for blocks of size 2^( 6) =       0.000416583972
  error estimate for blocks of size 2^( 7) =       0.000417440902

      target function =      -0.943828327519
              le_mean =     -17.212401096154
             les_mean =     296.547212245431
             stat err =       0.000414543705
             autocorr =       1.225457733218
   target nu stat err =       0.000414543705
   target dn stat err =       0.002686607303
      target stat err =       0.004692958898
              std dev =       0.529585583995
             le_variance =       0.280460890775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280346469851
                                         uncertainty =       0.002456123790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280346469851
                                         uncertainty =       0.002456123790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374473558
  error estimate for blocks of size 2^( 2) =       0.000388082931
  error estimate for blocks of size 2^( 3) =       0.000400897827
  error estimate for blocks of size 2^( 4) =       0.000409787759
  error estimate for blocks of size 2^( 5) =       0.000414362189
  error estimate for blocks of size 2^( 6) =       0.000416583972
  error estimate for blocks of size 2^( 7) =       0.000417440902

      target function =      -0.943828327520
              le_mean =     -17.212401096154
             les_mean =     296.547212245430
             stat err =       0.000414543705
             autocorr =       1.225457733218
   target nu stat err =       0.000414543705
   target dn stat err =       0.002686607303
      target stat err =       0.004692958898
              std dev =       0.529585583994
             le_variance =       0.280460890775


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943828327520        initial  <--
     6.1035e+07     6.1035e+08             8.5279e-12        -0.943828327519
     2.4414e+08     2.4414e+09             2.1312e-12        -0.943828327519
     9.7656e+08     9.7656e+09             5.3374e-13        -0.943828327520

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0242
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0153e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2065
    reference variance = 0.260207
====================================================
  Execution time = 3.7295e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8178e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0026e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281829000963
                                         uncertainty =       0.003857603256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281829000963
                                         uncertainty =       0.003857603256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375349951
  error estimate for blocks of size 2^( 2) =       0.000388647472
  error estimate for blocks of size 2^( 3) =       0.000401499209
  error estimate for blocks of size 2^( 4) =       0.000411443727
  error estimate for blocks of size 2^( 5) =       0.000417776595
  error estimate for blocks of size 2^( 6) =       0.000420336961
  error estimate for blocks of size 2^( 7) =       0.000420770676

      target function =      -0.941565847207
              le_mean =     -17.211836672659
             les_mean =     296.529096677204
             stat err =       0.000417581990
             autocorr =       1.237686891253
   target nu stat err =       0.000417581990
   target dn stat err =       0.004102216550
      target stat err =       0.007071504016
              std dev =       0.530824991691
             le_variance =       0.281775171804


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721183667266e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941617335372       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941617335372       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941617335372       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941617372921       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941617410768       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941617498221       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941618054491       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941615705168       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941617335372       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941616878967       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941618876865       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941615043316       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941614284373       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941617748536       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941616670293       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941617361624       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941614902473       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941619468101       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941616250966       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941615437231       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941618412668       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941620144266       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941618688959       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941616964405       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+08 is 8.827938e-13

solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941617335372       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941617335372       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941617335372       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941617335372       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941617335372       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941617335372       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941619157129       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941616395443       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941622463200       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941612128249       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941612984991       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941618765258       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941625940654       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941611556192       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941609886672       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941621334317       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941613504960       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941620269937       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941614946342       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941617999730       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941615386294       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941611633899       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941620700632       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941614412104       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+09 is 2.210026e-13

solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941617335372       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941617335372       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941617335372       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941620575659       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941617335632       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941610159440       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941604092652       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941619196095       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941607434146       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941596202288       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941607363356       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941635485998       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941612019886       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941604167351       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941627168685       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941625972626       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941624009300       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941580141675       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941612240997       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941549507073       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941626717220       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941598175434       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941586320076       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941531820129       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941621167175       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941575417049       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941579848978       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941647199277       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941693341005       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941557273720       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941566055448       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941621572308       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941568751175       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941694042366       residual = 9.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.942089211268       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.941859790949       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.940928973911       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941488796355       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.941113928445       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943401858247       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944352311248       residual = 2.56e-03           smallest_sin_value = 9.99e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.37e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+09 is 5.568237e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.500662 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7368e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1378
    reference variance = 0.226103
====================================================
  Execution time = 3.6487e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7823e-01
  Total weights = 2.0000e+06
  Execution time = 3.3572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278271713566
                                         uncertainty =       0.003489812008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278271713566
                                         uncertainty =       0.003489812008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372983098
  error estimate for blocks of size 2^( 2) =       0.000386514181
  error estimate for blocks of size 2^( 3) =       0.000398444403
  error estimate for blocks of size 2^( 4) =       0.000407103960
  error estimate for blocks of size 2^( 5) =       0.000412090950
  error estimate for blocks of size 2^( 6) =       0.000415790917
  error estimate for blocks of size 2^( 7) =       0.000417429799

      target function =      -0.947676211354
              le_mean =     -17.212311948603
             les_mean =     296.541915259597
             stat err =       0.000413103907
             autocorr =       1.226705465698
   target nu stat err =       0.000413103907
   target dn stat err =       0.003323714058
      target stat err =       0.005825145368
              std dev =       0.527477755628
             le_variance =       0.278232782682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278271713566
                                         uncertainty =       0.003489812008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278271713566
                                         uncertainty =       0.003489812008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372983098
  error estimate for blocks of size 2^( 2) =       0.000386514181
  error estimate for blocks of size 2^( 3) =       0.000398444403
  error estimate for blocks of size 2^( 4) =       0.000407103960
  error estimate for blocks of size 2^( 5) =       0.000412090950
  error estimate for blocks of size 2^( 6) =       0.000415790917
  error estimate for blocks of size 2^( 7) =       0.000417429799

      target function =      -0.947676211354
              le_mean =     -17.212311948603
             les_mean =     296.541915259597
             stat err =       0.000413103907
             autocorr =       1.226705465688
   target nu stat err =       0.000413103907
   target dn stat err =       0.003323714058
      target stat err =       0.005825145368
              std dev =       0.527477755628
             le_variance =       0.278232782682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278271713566
                                         uncertainty =       0.003489812008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278271713566
                                         uncertainty =       0.003489812008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372983098
  error estimate for blocks of size 2^( 2) =       0.000386514181
  error estimate for blocks of size 2^( 3) =       0.000398444403
  error estimate for blocks of size 2^( 4) =       0.000407103960
  error estimate for blocks of size 2^( 5) =       0.000412090950
  error estimate for blocks of size 2^( 6) =       0.000415790917
  error estimate for blocks of size 2^( 7) =       0.000417429799

      target function =      -0.947676211354
              le_mean =     -17.212311948603
             les_mean =     296.541915259597
             stat err =       0.000413103907
             autocorr =       1.226705465685
   target nu stat err =       0.000413103907
   target dn stat err =       0.003323714058
      target stat err =       0.005825145368
              std dev =       0.527477755628
             le_variance =       0.278232782682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278271713566
                                         uncertainty =       0.003489812008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278271713566
                                         uncertainty =       0.003489812008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372983098
  error estimate for blocks of size 2^( 2) =       0.000386514181
  error estimate for blocks of size 2^( 3) =       0.000398444403
  error estimate for blocks of size 2^( 4) =       0.000407103960
  error estimate for blocks of size 2^( 5) =       0.000412090950
  error estimate for blocks of size 2^( 6) =       0.000415790917
  error estimate for blocks of size 2^( 7) =       0.000417429799

      target function =      -0.947676211354
              le_mean =     -17.212311948603
             les_mean =     296.541915259597
             stat err =       0.000413103907
             autocorr =       1.226705465698
   target nu stat err =       0.000413103907
   target dn stat err =       0.003323714058
      target stat err =       0.005825145368
              std dev =       0.527477755628
             le_variance =       0.278232782682


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947676211354        initial
     6.1035e+08     6.1035e+09             8.8279e-13        -0.947676211354  <--
     2.4414e+09     2.4414e+10             2.2100e-13        -0.947676211354
     9.7656e+09     9.7656e+10             5.5682e-14        -0.947676211354

*****************************************************************************
Applying the update for shift_i =   6.1035e+08     and shift_s =   6.1035e+09
*****************************************************************************

  Execution time = 5.3419e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0079e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2677
    reference variance = 0.391108
====================================================
  Execution time = 3.7265e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7879e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0113e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278765575491
                                         uncertainty =       0.002231319904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278765575491
                                         uncertainty =       0.002231319904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373353531
  error estimate for blocks of size 2^( 2) =       0.000387231606
  error estimate for blocks of size 2^( 3) =       0.000399425597
  error estimate for blocks of size 2^( 4) =       0.000408410353
  error estimate for blocks of size 2^( 5) =       0.000414336237
  error estimate for blocks of size 2^( 6) =       0.000417905276
  error estimate for blocks of size 2^( 7) =       0.000418649244

      target function =      -0.946738850620
              le_mean =     -17.212259585419
             les_mean =     296.540665614730
             stat err =       0.000414825277
             autocorr =       1.234496600816
   target nu stat err =       0.000414825277
   target dn stat err =       0.002139334096
      target stat err =       0.003786766021
              std dev =       0.528001627160
             le_variance =       0.278785718283


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721225958542e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946752942564       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946752942564       residual = 8.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946752942564       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946752942564       residual = 8.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946753035841       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946753178676       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946752818954       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946752899804       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946752647502       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946752942565       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946753211230       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946753567844       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946752979940       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946753106245       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946753454079       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946753460437       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946752946142       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946753005520       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946752350953       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946753084313       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946753298670       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946752824977       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946752984559       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946752690235       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+08 is 3.411978e-12

solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946752942564       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946752942564       residual = 8.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946752942564       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946752942564       residual = 8.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946752942564       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946753057862       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946753187620       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946753572624       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946752772021       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946754079891       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946755223923       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946753735619       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946752608725       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946753287190       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946753354026       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946753402889       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946754536215       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946752224267       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946753372268       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946753033798       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946752320401       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946751959629       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946751323243       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946752626511       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+08 is 8.525402e-13

solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946752942564       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946752942564       residual = 8.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946752942564       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946752942564       residual = 8.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946752942297       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946752011262       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946753739518       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946753208474       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946749782099       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946759737374       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946752156155       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946741958346       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946756063210       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946749588166       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946746488767       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946759288339       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946750320159       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946747848534       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946759426572       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946762973908       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946748869239       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946748700388       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946755628570       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946749141784       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.946748705021       residual = 5.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+09 is 2.133529e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.519554 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7403e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1361
    reference variance = 0.533484
====================================================
  Execution time = 3.6768e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8229e-01
  Total weights = 2.0000e+06
  Execution time = 3.3687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282293310757
                                         uncertainty =       0.002910184182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282293310757
                                         uncertainty =       0.002910184182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375691941
  error estimate for blocks of size 2^( 2) =       0.000389196850
  error estimate for blocks of size 2^( 3) =       0.000401701643
  error estimate for blocks of size 2^( 4) =       0.000410585857
  error estimate for blocks of size 2^( 5) =       0.000416333274
  error estimate for blocks of size 2^( 6) =       0.000419623163
  error estimate for blocks of size 2^( 7) =       0.000420630646

      target function =      -0.940701225382
              le_mean =     -17.211969717595
             les_mean =     296.534190287126
             stat err =       0.000416793235
             autocorr =       1.230771878931
   target nu stat err =       0.000416793235
   target dn stat err =       0.003135870269
      target stat err =       0.005419060238
              std dev =       0.531308638031
             le_variance =       0.282288868847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282293310757
                                         uncertainty =       0.002910184182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282293310757
                                         uncertainty =       0.002910184182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375691941
  error estimate for blocks of size 2^( 2) =       0.000389196850
  error estimate for blocks of size 2^( 3) =       0.000401701643
  error estimate for blocks of size 2^( 4) =       0.000410585857
  error estimate for blocks of size 2^( 5) =       0.000416333274
  error estimate for blocks of size 2^( 6) =       0.000419623163
  error estimate for blocks of size 2^( 7) =       0.000420630646

      target function =      -0.940701225381
              le_mean =     -17.211969717595
             les_mean =     296.534190287126
             stat err =       0.000416793235
             autocorr =       1.230771878933
   target nu stat err =       0.000416793235
   target dn stat err =       0.003135870269
      target stat err =       0.005419060238
              std dev =       0.531308638032
             le_variance =       0.282288868847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282293310757
                                         uncertainty =       0.002910184182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282293310757
                                         uncertainty =       0.002910184182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375691941
  error estimate for blocks of size 2^( 2) =       0.000389196850
  error estimate for blocks of size 2^( 3) =       0.000401701643
  error estimate for blocks of size 2^( 4) =       0.000410585857
  error estimate for blocks of size 2^( 5) =       0.000416333274
  error estimate for blocks of size 2^( 6) =       0.000419623163
  error estimate for blocks of size 2^( 7) =       0.000420630646

      target function =      -0.940701225382
              le_mean =     -17.211969717595
             les_mean =     296.534190287126
             stat err =       0.000416793235
             autocorr =       1.230771878935
   target nu stat err =       0.000416793235
   target dn stat err =       0.003135870269
      target stat err =       0.005419060238
              std dev =       0.531308638031
             le_variance =       0.282288868847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282293310757
                                         uncertainty =       0.002910184182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282293310757
                                         uncertainty =       0.002910184182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375691941
  error estimate for blocks of size 2^( 2) =       0.000389196850
  error estimate for blocks of size 2^( 3) =       0.000401701643
  error estimate for blocks of size 2^( 4) =       0.000410585857
  error estimate for blocks of size 2^( 5) =       0.000416333274
  error estimate for blocks of size 2^( 6) =       0.000419623163
  error estimate for blocks of size 2^( 7) =       0.000420630646

      target function =      -0.940701225382
              le_mean =     -17.211969717595
             les_mean =     296.534190287126
             stat err =       0.000416793235
             autocorr =       1.230771878929
   target nu stat err =       0.000416793235
   target dn stat err =       0.003135870269
      target stat err =       0.005419060238
              std dev =       0.531308638031
             le_variance =       0.282288868847


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940701225382        initial  <--
     1.5259e+08     1.5259e+09             3.4120e-12        -0.940701225381
     6.1035e+08     6.1035e+09             8.5254e-13        -0.940701225382
     2.4414e+09     2.4414e+10             2.1335e-13        -0.940701225382

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7926
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0127e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2182
    reference variance = 0.205713
====================================================
  Execution time = 3.7254e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7860e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0053e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277921235861
                                         uncertainty =       0.002188534317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277921235861
                                         uncertainty =       0.002188534317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373227516
  error estimate for blocks of size 2^( 2) =       0.000387006911
  error estimate for blocks of size 2^( 3) =       0.000399875718
  error estimate for blocks of size 2^( 4) =       0.000409222768
  error estimate for blocks of size 2^( 5) =       0.000415112420
  error estimate for blocks of size 2^( 6) =       0.000419436508
  error estimate for blocks of size 2^( 7) =       0.000422263551

      target function =      -0.947036503281
              le_mean =     -17.212983021328
             les_mean =     296.565381909902
             stat err =       0.000416508812
             autocorr =       1.245377685237
   target nu stat err =       0.000416508812
   target dn stat err =       0.002130023502
      target stat err =       0.003779185949
              std dev =       0.527823414280
             le_variance =       0.278597556662


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721298302133e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947050662104       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947050662104       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947050662104       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947050662104       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947050662381       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947049951379       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947046964534       residual = 5.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947049678362       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947048466011       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947050400175       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947053030469       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947050161541       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947049773277       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947049757064       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947048888533       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947045113005       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947051906694       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947047440787       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947052499353       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947052101971       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947057623137       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947050166458       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947054710105       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947048913193       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947047208394       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+09 is 5.413867e-13

solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947050662104       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947050662104       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947050662104       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947050662104       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947050662104       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947049056954       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947052200187       residual = 5.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947071894834       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947050128466       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947051544052       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947040495718       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947049718869       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947069487957       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947054697858       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947063979997       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947053585956       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947052821326       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947053646329       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947041032044       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947049049042       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947040546601       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947030090788       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947031697819       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947023028396       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947035537097       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947043676721       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+09 is 1.346962e-13

solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947050662104       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947050662104       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947050662104       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947050662104       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947050662104       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947059032488       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947053785515       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947017663167       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947065139676       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947032892888       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947082559960       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946962478979       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947054614217       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947024173775       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947071818681       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946980065536       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947017305998       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947017541271       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947121514718       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946972618537       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947007828220       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946971040604       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947133300483       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947049849317       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947069129799       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.946995932919       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947013976385       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947202652091       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947111411547       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947007950572       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.946869832231       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.948130391362       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.946547229738       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947119820512       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947219121418       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947761359213       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.946866008151       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.948172332179       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.945174686925       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.942199087040       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.948284379404       residual = 4.07e-04           smallest_sin_value = 9.96e-01
davidson iteration   41 stopping due to small subspace S singular value of 7.70e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+10 is 3.417323e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.559831 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7354e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1566
    reference variance = 0.24443
====================================================
  Execution time = 3.6658e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8359e-01
  Total weights = 2.0000e+06
  Execution time = 3.3941e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283661449456
                                         uncertainty =       0.003603277531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283661449456
                                         uncertainty =       0.003603277531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376558239
  error estimate for blocks of size 2^( 2) =       0.000389870231
  error estimate for blocks of size 2^( 3) =       0.000402186950
  error estimate for blocks of size 2^( 4) =       0.000411421083
  error estimate for blocks of size 2^( 5) =       0.000416592094
  error estimate for blocks of size 2^( 6) =       0.000419313453
  error estimate for blocks of size 2^( 7) =       0.000421984627

      target function =      -0.938436952458
              le_mean =     -17.212410419909
             les_mean =     296.550664535767
             stat err =       0.000417327814
             autocorr =       1.228260127268
   target nu stat err =       0.000417327814
   target dn stat err =       0.003869489124
      target stat err =       0.006638361756
              std dev =       0.532533768104
             le_variance =       0.283592214171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283661449456
                                         uncertainty =       0.003603277531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283661449456
                                         uncertainty =       0.003603277531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376558239
  error estimate for blocks of size 2^( 2) =       0.000389870231
  error estimate for blocks of size 2^( 3) =       0.000402186950
  error estimate for blocks of size 2^( 4) =       0.000411421083
  error estimate for blocks of size 2^( 5) =       0.000416592094
  error estimate for blocks of size 2^( 6) =       0.000419313453
  error estimate for blocks of size 2^( 7) =       0.000421984627

      target function =      -0.938436952458
              le_mean =     -17.212410419909
             les_mean =     296.550664535768
             stat err =       0.000417327814
             autocorr =       1.228260127262
   target nu stat err =       0.000417327814
   target dn stat err =       0.003869489124
      target stat err =       0.006638361756
              std dev =       0.532533768104
             le_variance =       0.283592214171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283661449456
                                         uncertainty =       0.003603277531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283661449456
                                         uncertainty =       0.003603277531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376558239
  error estimate for blocks of size 2^( 2) =       0.000389870231
  error estimate for blocks of size 2^( 3) =       0.000402186950
  error estimate for blocks of size 2^( 4) =       0.000411421083
  error estimate for blocks of size 2^( 5) =       0.000416592094
  error estimate for blocks of size 2^( 6) =       0.000419313453
  error estimate for blocks of size 2^( 7) =       0.000421984627

      target function =      -0.938436952458
              le_mean =     -17.212410419909
             les_mean =     296.550664535767
             stat err =       0.000417327814
             autocorr =       1.228260127270
   target nu stat err =       0.000417327814
   target dn stat err =       0.003869489124
      target stat err =       0.006638361756
              std dev =       0.532533768104
             le_variance =       0.283592214171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283661449456
                                         uncertainty =       0.003603277531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283661449456
                                         uncertainty =       0.003603277531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376558239
  error estimate for blocks of size 2^( 2) =       0.000389870231
  error estimate for blocks of size 2^( 3) =       0.000402186950
  error estimate for blocks of size 2^( 4) =       0.000411421083
  error estimate for blocks of size 2^( 5) =       0.000416592094
  error estimate for blocks of size 2^( 6) =       0.000419313453
  error estimate for blocks of size 2^( 7) =       0.000421984627

      target function =      -0.938436952458
              le_mean =     -17.212410419909
             les_mean =     296.550664535767
             stat err =       0.000417327814
             autocorr =       1.228260127264
   target nu stat err =       0.000417327814
   target dn stat err =       0.003869489124
      target stat err =       0.006638361756
              std dev =       0.532533768104
             le_variance =       0.283592214171


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938436952458        initial  <--
     1.5259e+09     1.5259e+10             5.4139e-13        -0.938436952458
     6.1035e+09     6.1035e+10             1.3470e-13        -0.938436952458
     2.4414e+10     2.4414e+11             3.4173e-14        -0.938436952458

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7071
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0108e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2281
    reference variance = 0.267031
====================================================
  Execution time = 3.8168e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7555e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0123e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275581801778
                                         uncertainty =       0.001817968434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275581801778
                                         uncertainty =       0.001817968434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371178345
  error estimate for blocks of size 2^( 2) =       0.000385043466
  error estimate for blocks of size 2^( 3) =       0.000397394974
  error estimate for blocks of size 2^( 4) =       0.000406671109
  error estimate for blocks of size 2^( 5) =       0.000411642044
  error estimate for blocks of size 2^( 6) =       0.000414710060
  error estimate for blocks of size 2^( 7) =       0.000419024036

      target function =      -0.952390823779
              le_mean =     -17.212232572069
             les_mean =     296.536496704781
             stat err =       0.000413011813
             autocorr =       1.238111290816
   target nu stat err =       0.000413011813
   target dn stat err =       0.002048302200
      target stat err =       0.003673915419
              std dev =       0.524925449530
             le_variance =       0.275546727564


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721223257207e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+10, overlap shift 1.5259e+11 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952403952658       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952403952658       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952403952658       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952406013246       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952395564900       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952403952658       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952404829345       residual = 8.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952403952658       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952370277456       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952387267914       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.952403952658       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.952388029508       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.952389059359       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.952366785422       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.952401190228       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.952375589592       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.952367985912       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.952468089795       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.952349637035       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.952340360195       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.952465912032       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.952452878533       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.952415899332       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.952410856124       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.952285383364       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.952358413696       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.952496873817       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.952526872417       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.952460393841       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.952301114499       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.952265667864       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.951833869869       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.952660769713       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.951838997079       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.952238536623       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.951160893071       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.952453794265       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.951691783584       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.957724260586       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.953378447307       residual = 7.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.956086858903       residual = 1.23e-03           smallest_sin_value = 9.99e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.45e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+10 is 3.386422e-14

solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952403952658       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952403952658       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952403952658       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952412190131       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952404339190       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952400202879       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952403952658       residual = 8.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952374578511       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952336236469       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952512582363       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.952291249473       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.952403952658       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.952372982583       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.952409878168       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.952189641339       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.952193512177       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.952429930093       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.952318762002       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.952310840001       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.952130845516       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.952076468634       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.952708650508       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.952440390195       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.952476266165       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.952199626510       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951514918948       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.951992909076       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951752404988       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.952130945038       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.952297355897       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951756057674       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.952447089669       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.956523734612       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.958914293723       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.952416370940       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.953931974034       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938412376642       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.955939446917       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.954116354114       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.955428516288       residual = 2.21e-03           smallest_sin_value = 9.96e-01
davidson iteration   40 stopping due to small subspace S singular value of 7.62e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+10 is 8.850887e-15

solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952403952658       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952403952658       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952403952658       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952403952658       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952352912462       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952407265448       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952487522008       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951719742396       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952517398153       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952451806186       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.952584189077       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.952540065474       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951711293776       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.952153550696       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951342459181       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.952263181633       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.954070490001       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951400069435       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.953230937122       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.952102264711       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.950998174980       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.952730834672       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951375738830       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.952217389553       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.952297225377       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.955659809327       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.956510859796       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.959899771472       residual = 6.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.951754092968       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.951831941912       residual = 7.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.955772275054       residual = 8.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.935999197143       residual = 3.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.920353619319       residual = 9.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.963852175200       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.995310647978       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.956711936636       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.949889947687       residual = 4.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.963487247473       residual = 4.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.915126896747       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.867319948077       residual = 7.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.937588100542       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.883913559659       residual = 7.78e-01           smallest_sin_value = 9.91e-01
davidson iteration   42 stopping due to small subspace S singular value of 6.94e-01
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+11 is 2.691244e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.638320 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8376e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2569
    reference variance = 0.191031
====================================================
  Execution time = 3.7037e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7938e-01
  Total weights = 2.0000e+06
  Execution time = 3.3717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279299187421
                                         uncertainty =       0.001981227886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279299187421
                                         uncertainty =       0.001981227886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373750119
  error estimate for blocks of size 2^( 2) =       0.000387388480
  error estimate for blocks of size 2^( 3) =       0.000399824831
  error estimate for blocks of size 2^( 4) =       0.000408700536
  error estimate for blocks of size 2^( 5) =       0.000413812344
  error estimate for blocks of size 2^( 6) =       0.000415926919
  error estimate for blocks of size 2^( 7) =       0.000417567718

      target function =      -0.945727401407
              le_mean =     -17.211903254843
             les_mean =     296.528991816635
             stat err =       0.000414001879
             autocorr =       1.226992608037
   target nu stat err =       0.000414001879
   target dn stat err =       0.002102684185
      target stat err =       0.003713868037
              std dev =       0.528562486618
             le_variance =       0.279378302259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279299187421
                                         uncertainty =       0.001981227886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279299187421
                                         uncertainty =       0.001981227886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373750119
  error estimate for blocks of size 2^( 2) =       0.000387388480
  error estimate for blocks of size 2^( 3) =       0.000399824831
  error estimate for blocks of size 2^( 4) =       0.000408700536
  error estimate for blocks of size 2^( 5) =       0.000413812344
  error estimate for blocks of size 2^( 6) =       0.000415926919
  error estimate for blocks of size 2^( 7) =       0.000417567718

      target function =      -0.945727401407
              le_mean =     -17.211903254843
             les_mean =     296.528991816635
             stat err =       0.000414001879
             autocorr =       1.226992608038
   target nu stat err =       0.000414001879
   target dn stat err =       0.002102684185
      target stat err =       0.003713868037
              std dev =       0.528562486618
             le_variance =       0.279378302259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279299187421
                                         uncertainty =       0.001981227886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279299187421
                                         uncertainty =       0.001981227886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373750119
  error estimate for blocks of size 2^( 2) =       0.000387388480
  error estimate for blocks of size 2^( 3) =       0.000399824831
  error estimate for blocks of size 2^( 4) =       0.000408700536
  error estimate for blocks of size 2^( 5) =       0.000413812344
  error estimate for blocks of size 2^( 6) =       0.000415926919
  error estimate for blocks of size 2^( 7) =       0.000417567718

      target function =      -0.945727401407
              le_mean =     -17.211903254843
             les_mean =     296.528991816635
             stat err =       0.000414001879
             autocorr =       1.226992608040
   target nu stat err =       0.000414001879
   target dn stat err =       0.002102684185
      target stat err =       0.003713868037
              std dev =       0.528562486618
             le_variance =       0.279378302259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279299187421
                                         uncertainty =       0.001981227886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279299187421
                                         uncertainty =       0.001981227886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373750119
  error estimate for blocks of size 2^( 2) =       0.000387388480
  error estimate for blocks of size 2^( 3) =       0.000399824831
  error estimate for blocks of size 2^( 4) =       0.000408700536
  error estimate for blocks of size 2^( 5) =       0.000413812344
  error estimate for blocks of size 2^( 6) =       0.000415926919
  error estimate for blocks of size 2^( 7) =       0.000417567718

      target function =      -0.945727401407
              le_mean =     -17.211903254843
             les_mean =     296.528991816635
             stat err =       0.000414001879
             autocorr =       1.226992608029
   target nu stat err =       0.000414001879
   target dn stat err =       0.002102684185
      target stat err =       0.003713868037
              std dev =       0.528562486618
             le_variance =       0.279378302259


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945727401407        initial
     1.5259e+10     1.5259e+11             3.3864e-14        -0.945727401407  <--
     6.1035e+10     6.1035e+11             8.8509e-15        -0.945727401407
     2.4414e+11     2.4414e+12             2.6912e-15        -0.945727401407

*****************************************************************************
Applying the update for shift_i =   1.5259e+10     and shift_s =   1.5259e+11
*****************************************************************************

  Execution time = 5.4060e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0249e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1539
    reference variance = 0.147398
====================================================
  Execution time = 3.7703e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8112e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0271e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281135490303
                                         uncertainty =       0.004496972197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281135490303
                                         uncertainty =       0.004496972197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374912536
  error estimate for blocks of size 2^( 2) =       0.000388433380
  error estimate for blocks of size 2^( 3) =       0.000400644492
  error estimate for blocks of size 2^( 4) =       0.000409433915
  error estimate for blocks of size 2^( 5) =       0.000414837054
  error estimate for blocks of size 2^( 6) =       0.000418385927
  error estimate for blocks of size 2^( 7) =       0.000419983954

      target function =      -0.942641162734
              le_mean =     -17.212592473622
             les_mean =     296.554458341792
             stat err =       0.000415660213
             autocorr =       1.229184248934
   target nu stat err =       0.000415660213
   target dn stat err =       0.004627283499
      target stat err =       0.007996367315
              std dev =       0.530206393184
             le_variance =       0.281118819373


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721259247362e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942708697664       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942708697664       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942708697664       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942708697664       residual = 7.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942708668339       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942708723225       residual = 6.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942707962044       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942710420175       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942713655270       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942709144638       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942705100803       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942711506707       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942702757630       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942694554696       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942707395641       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942699671545       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942707606211       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942703290920       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942718132376       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942707502678       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942705235068       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942698956668       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942709089962       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942701988333       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.942676141796       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.942700384214       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+09 is 1.773952e-13

solving harmonic davidson linear method for identity shift 1.5259e+10, overlap shift 1.5259e+11 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942708697664       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942708697664       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942708697664       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942708697664       residual = 7.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942708697664       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942708947544       residual = 6.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942705846206       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942739819014       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942767106996       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942688746234       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942666768494       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942730717104       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942723357001       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942728368309       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942704665306       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942692490394       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942754717869       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942736943085       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942709581009       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942715138955       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942760556472       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942741725836       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942692533847       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942688366257       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.942689785254       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.942718122539       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.942634723920       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.942675575393       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.942720132771       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942922762578       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.942413202216       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.942589304524       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.942639459140       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.942482884138       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.942962256412       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.942445582167       residual = 8.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.943747303808       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944703622323       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.943310558166       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941694862767       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944878034252       residual = 4.58e-04           smallest_sin_value = 9.99e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+10 is 4.413436e-14

solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942708697664       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942708697664       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942708697664       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942708697664       residual = 7.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942721079631       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942708554230       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942771026391       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942690038687       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942678793470       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942728980869       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942825743530       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942495172915       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942658709912       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942637473411       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942497697826       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942634348690       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942491250733       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942831791277       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942761479775       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942675291480       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942769490002       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942687230843       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942589547405       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942466747177       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.942797848013       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.942354305713       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.942790096689       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.942741266583       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941130526792       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942608907724       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.942450439021       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.942575395661       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941578464930       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944090354094       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.942528367445       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.943324039854       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.942020582834       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.940680454260       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.943772392588       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.936996224726       residual = 3.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.942980224468       residual = 9.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.952941221271       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   42 stopping due to small subspace S singular value of 9.57e-01
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+10 is 1.083501e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.699159 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.1012e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1523
    reference variance = 0.274997
====================================================
  Execution time = 3.6667e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8274e-01
  Total weights = 2.0000e+06
  Execution time = 3.3636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282739965061
                                         uncertainty =       0.003822458450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282739965061
                                         uncertainty =       0.003822458450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375993016
  error estimate for blocks of size 2^( 2) =       0.000389303706
  error estimate for blocks of size 2^( 3) =       0.000401834419
  error estimate for blocks of size 2^( 4) =       0.000410020107
  error estimate for blocks of size 2^( 5) =       0.000415403521
  error estimate for blocks of size 2^( 6) =       0.000416390948
  error estimate for blocks of size 2^( 7) =       0.000417440967

      target function =      -0.939888931171
              le_mean =     -17.212461875073
             les_mean =     296.551585155867
             stat err =       0.000414813886
             autocorr =       1.217158159743
   target nu stat err =       0.000414813886
   target dn stat err =       0.003728295548
      target stat err =       0.006419113382
              std dev =       0.531734422802
             le_variance =       0.282741496393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282739965061
                                         uncertainty =       0.003822458450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282739965061
                                         uncertainty =       0.003822458450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375993016
  error estimate for blocks of size 2^( 2) =       0.000389303706
  error estimate for blocks of size 2^( 3) =       0.000401834419
  error estimate for blocks of size 2^( 4) =       0.000410020107
  error estimate for blocks of size 2^( 5) =       0.000415403521
  error estimate for blocks of size 2^( 6) =       0.000416390948
  error estimate for blocks of size 2^( 7) =       0.000417440967

      target function =      -0.939888931171
              le_mean =     -17.212461875073
             les_mean =     296.551585155867
             stat err =       0.000414813886
             autocorr =       1.217158159733
   target nu stat err =       0.000414813886
   target dn stat err =       0.003728295548
      target stat err =       0.006419113382
              std dev =       0.531734422802
             le_variance =       0.282741496393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282739965061
                                         uncertainty =       0.003822458450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282739965061
                                         uncertainty =       0.003822458450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375993016
  error estimate for blocks of size 2^( 2) =       0.000389303706
  error estimate for blocks of size 2^( 3) =       0.000401834419
  error estimate for blocks of size 2^( 4) =       0.000410020107
  error estimate for blocks of size 2^( 5) =       0.000415403521
  error estimate for blocks of size 2^( 6) =       0.000416390948
  error estimate for blocks of size 2^( 7) =       0.000417440967

      target function =      -0.939888931171
              le_mean =     -17.212461875073
             les_mean =     296.551585155867
             stat err =       0.000414813886
             autocorr =       1.217158159738
   target nu stat err =       0.000414813886
   target dn stat err =       0.003728295548
      target stat err =       0.006419113382
              std dev =       0.531734422802
             le_variance =       0.282741496393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282739965061
                                         uncertainty =       0.003822458450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282739965061
                                         uncertainty =       0.003822458450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375993016
  error estimate for blocks of size 2^( 2) =       0.000389303706
  error estimate for blocks of size 2^( 3) =       0.000401834419
  error estimate for blocks of size 2^( 4) =       0.000410020107
  error estimate for blocks of size 2^( 5) =       0.000415403521
  error estimate for blocks of size 2^( 6) =       0.000416390948
  error estimate for blocks of size 2^( 7) =       0.000417440967

      target function =      -0.939888931171
              le_mean =     -17.212461875073
             les_mean =     296.551585155867
             stat err =       0.000414813886
             autocorr =       1.217158159743
   target nu stat err =       0.000414813886
   target dn stat err =       0.003728295548
      target stat err =       0.006419113382
              std dev =       0.531734422802
             le_variance =       0.282741496393


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939888931171        initial  <--
     3.8147e+09     3.8147e+10             1.7740e-13        -0.939888931171
     1.5259e+10     1.5259e+11             4.4134e-14        -0.939888931171
     6.1035e+10     6.1035e+11             1.0835e-14        -0.939888931171

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.6352
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0465e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2696
    reference variance = 0.200672
====================================================
  Execution time = 3.7306e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8302e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0164e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283039999189
                                         uncertainty =       0.002935768293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283039999189
                                         uncertainty =       0.002935768293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376180302
  error estimate for blocks of size 2^( 2) =       0.000389869653
  error estimate for blocks of size 2^( 3) =       0.000402098183
  error estimate for blocks of size 2^( 4) =       0.000411062339
  error estimate for blocks of size 2^( 5) =       0.000416252720
  error estimate for blocks of size 2^( 6) =       0.000418870671
  error estimate for blocks of size 2^( 7) =       0.000420050277

      target function =      -0.939414576237
              le_mean =     -17.212583683810
             les_mean =     296.556060169327
             stat err =       0.000416559002
             autocorr =       1.226198971017
   target nu stat err =       0.000416559002
   target dn stat err =       0.003118140854
      target stat err =       0.005380763053
              std dev =       0.531999284458
             le_variance =       0.283023238664


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721258368381e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939444112560       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939444112560       residual = 9.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939444112560       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939444112560       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939444110777       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939444087577       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939394317727       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939489428708       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939458060275       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939426171705       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939369226560       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939413765491       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939471719552       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939482308939       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939386889039       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939485254059       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939348174871       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939418204550       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939323746517       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939401626006       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939527593604       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939382491114       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939540562161       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939345507942       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939409838633       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939724357296       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939399403105       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939021925934       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939396608870       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938526224779       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939474727585       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.938380372017       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.939855748077       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941220422260       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939741396907       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939343913543       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.953088779700       residual = 3.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.945112590836       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.937617038230       residual = 8.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941320784757       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.936449648628       residual = 2.03e-03           smallest_sin_value = 9.97e-01
davidson iteration   41 stopping due to small subspace S singular value of 8.42e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+10 is 1.409273e-14

solving harmonic davidson linear method for identity shift 1.5259e+11, overlap shift 1.5259e+12 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939444112560       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939444112560       residual = 9.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939444112560       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939444112560       residual = 8.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939444112498       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939474162101       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939391917552       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939322970818       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939416038383       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939337167070       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939417032545       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939821864637       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939298171468       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939597421407       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939575954973       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939435329436       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939145757156       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939899360049       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939699348464       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939279733115       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939418621042       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939200419640       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939614516400       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939367823316       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939292748804       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.939182054277       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939897130884       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939656891556       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939086159811       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938879025805       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939225228990       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941616047178       residual = 7.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.929194565523       residual = 3.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934810997539       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.940033131141       residual = 5.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.931194124002       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.953084422448       residual = 2.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.936846077172       residual = 4.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947840339482       residual = 1.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.914824257732       residual = 1.10e-01           smallest_sin_value = 9.99e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.59e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+11 is 3.678705e-15

solving harmonic davidson linear method for identity shift 6.1035e+11, overlap shift 6.1035e+12 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939444112560       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939444112560       residual = 9.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939444112560       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939444112560       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939067254136       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939471788418       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939643727374       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939928704623       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937264433197       residual = 5.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939041163635       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938225046614       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938045188975       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939349698806       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940016082106       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938620413539       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939113067452       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939619888809       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939482272726       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939121611719       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941424149235       residual = 6.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940788854115       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944790354470       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940022450744       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937660746655       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.946804139656       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951560091447       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.940881935122       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947849425616       residual = 9.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.943073283599       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.935432451425       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.909156606857       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.943906551133       residual = 3.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.902858086442       residual = 1.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.906883100175       residual = 4.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.871304312422       residual = 1.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.868015485176       residual = 1.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.715815056850       residual = 6.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.875401811820       residual = 3.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.853167602928       residual = 2.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.074580269536       residual = 2.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.750901701974       residual = 5.74e+00           smallest_sin_value = 9.95e-01
davidson iteration   41 stopping due to small subspace S singular value of 8.35e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+11 is 8.923112e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.775979 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7553e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.0965
    reference variance = 1.34439
====================================================
  Execution time = 3.6686e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8142e-01
  Total weights = 2.0000e+06
  Execution time = 3.3909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281347442411
                                         uncertainty =       0.003166885215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281347442411
                                         uncertainty =       0.003166885215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375116489
  error estimate for blocks of size 2^( 2) =       0.000388263598
  error estimate for blocks of size 2^( 3) =       0.000400758965
  error estimate for blocks of size 2^( 4) =       0.000410168054
  error estimate for blocks of size 2^( 5) =       0.000415647530
  error estimate for blocks of size 2^( 6) =       0.000418825480
  error estimate for blocks of size 2^( 7) =       0.000421571109

      target function =      -0.942147493516
              le_mean =     -17.212775540699
             les_mean =     296.561066434514
             stat err =       0.000416553043
             autocorr =       1.233128437443
   target nu stat err =       0.000416553043
   target dn stat err =       0.002922778300
      target stat err =       0.005081505057
              std dev =       0.530494826307
             le_variance =       0.281424760738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281347442411
                                         uncertainty =       0.003166885215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281347442411
                                         uncertainty =       0.003166885215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375116489
  error estimate for blocks of size 2^( 2) =       0.000388263598
  error estimate for blocks of size 2^( 3) =       0.000400758965
  error estimate for blocks of size 2^( 4) =       0.000410168054
  error estimate for blocks of size 2^( 5) =       0.000415647530
  error estimate for blocks of size 2^( 6) =       0.000418825480
  error estimate for blocks of size 2^( 7) =       0.000421571109

      target function =      -0.942147493516
              le_mean =     -17.212775540699
             les_mean =     296.561066434514
             stat err =       0.000416553043
             autocorr =       1.233128437442
   target nu stat err =       0.000416553043
   target dn stat err =       0.002922778300
      target stat err =       0.005081505057
              std dev =       0.530494826307
             le_variance =       0.281424760738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281347442411
                                         uncertainty =       0.003166885215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281347442411
                                         uncertainty =       0.003166885215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375116489
  error estimate for blocks of size 2^( 2) =       0.000388263598
  error estimate for blocks of size 2^( 3) =       0.000400758965
  error estimate for blocks of size 2^( 4) =       0.000410168054
  error estimate for blocks of size 2^( 5) =       0.000415647530
  error estimate for blocks of size 2^( 6) =       0.000418825480
  error estimate for blocks of size 2^( 7) =       0.000421571109

      target function =      -0.942147493516
              le_mean =     -17.212775540699
             les_mean =     296.561066434514
             stat err =       0.000416553043
             autocorr =       1.233128437439
   target nu stat err =       0.000416553043
   target dn stat err =       0.002922778300
      target stat err =       0.005081505057
              std dev =       0.530494826307
             le_variance =       0.281424760738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281347442411
                                         uncertainty =       0.003166885215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281347442411
                                         uncertainty =       0.003166885215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375116489
  error estimate for blocks of size 2^( 2) =       0.000388263598
  error estimate for blocks of size 2^( 3) =       0.000400758965
  error estimate for blocks of size 2^( 4) =       0.000410168054
  error estimate for blocks of size 2^( 5) =       0.000415647530
  error estimate for blocks of size 2^( 6) =       0.000418825480
  error estimate for blocks of size 2^( 7) =       0.000421571109

      target function =      -0.942147493516
              le_mean =     -17.212775540699
             les_mean =     296.561066434514
             stat err =       0.000416553043
             autocorr =       1.233128437443
   target nu stat err =       0.000416553043
   target dn stat err =       0.002922778300
      target stat err =       0.005081505057
              std dev =       0.530494826307
             le_variance =       0.281424760738


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942147493516        initial  <--
     3.8147e+10     3.8147e+11             1.4093e-14        -0.942147493516
     1.5259e+11     1.5259e+12             3.6787e-15        -0.942147493516
     6.1035e+11     6.1035e+12             8.9231e-16        -0.942147493516

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.2648
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0482e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1914
    reference variance = 0.193683
====================================================
  Execution time = 3.7501e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7694e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0142e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276966889159
                                         uncertainty =       0.002147886478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276966889159
                                         uncertainty =       0.002147886478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372117472
  error estimate for blocks of size 2^( 2) =       0.000385386637
  error estimate for blocks of size 2^( 3) =       0.000397978509
  error estimate for blocks of size 2^( 4) =       0.000407081768
  error estimate for blocks of size 2^( 5) =       0.000411993708
  error estimate for blocks of size 2^( 6) =       0.000415402784
  error estimate for blocks of size 2^( 7) =       0.000417062706

      target function =      -0.949946795188
              le_mean =     -17.212200709724
             les_mean =     296.536795959586
             stat err =       0.000412885242
             autocorr =       1.231114920647
   target nu stat err =       0.000412885242
   target dn stat err =       0.002174314272
      target stat err =       0.003870670379
              std dev =       0.526253575985
             le_variance =       0.276942826237


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721220070972e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949961455014       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949961455014       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949961455014       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949961455014       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949961454857       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949997139169       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949523531410       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950515324811       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949217423128       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949974000987       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949969771619       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951137347689       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949336240552       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.950447601809       residual = 4.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949552638363       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948916615246       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949168912744       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949963704742       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949677274246       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.952562127988       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.950303125558       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948626747273       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.950148315169       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951431778054       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948524364646       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.952036578275       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.935074792084       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.953640156397       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.959800851788       residual = 8.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.950421459320       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941008049482       residual = 7.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.952183169365       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.950812929215       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941555650826       residual = 8.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.968816671832       residual = 6.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.938066818508       residual = 2.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.899594866948       residual = 1.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.188816145608       residual = 5.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.946016324733       residual = 3.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916698157531       residual = 1.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.079488603459       residual = 2.59e+00           smallest_sin_value = 9.98e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.50e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+11 is 1.165121e-15

solving harmonic davidson linear method for identity shift 1.5259e+12, overlap shift 1.5259e+13 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949961455014       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949961455014       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949961455014       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949961455014       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950793999744       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949980886948       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950847708956       residual = 7.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950487040852       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.955073589268       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951554640234       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947622640738       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.950552086295       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943447991656       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951498644768       residual = 6.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948322070360       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.952149658902       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947453858630       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946936890695       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947531991355       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946791418470       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943404520760       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951134686905       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942525933403       residual = 6.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951899719798       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.962721255989       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.921586205750       residual = 9.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.943991194300       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.856191701511       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.980474774667       residual = 4.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.806899802858       residual = 2.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.003439928746       residual = 4.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.962814469735       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915564030448       residual = 2.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.026509395922       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.945799571053       residual = 2.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.097971371815       residual = 3.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.648537593833       residual = 7.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.984438777405       residual = 3.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.789496501451       residual = 6.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.047950739227       residual = 5.64e+01           smallest_sin_value = 9.97e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+12 is 2.225677e-16

solving harmonic davidson linear method for identity shift 6.1035e+12, overlap shift 6.1035e+13 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949961455014       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949961455014       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949961455014       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949961455014       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949961455014       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949961455014       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949961455014       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948641009162       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.965236895563       residual = 3.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950916877680       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.953494813107       residual = 6.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.950091028876       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.954659792096       residual = 3.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.955722466476       residual = 7.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947066460250       residual = 5.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.952191135291       residual = 9.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.983541211840       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927565009067       residual = 1.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.967468140897       residual = 4.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.953188532867       residual = 7.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.919870392266       residual = 9.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.968510400136       residual = 5.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.113538754215       residual = 2.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.857258740696       residual = 9.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.143914738858       residual = 4.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.051229796338       residual = 8.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.021455115084       residual = 2.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904485625808       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.970196454624       residual = 3.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.957472367420       residual = 1.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.598013379615       residual = 1.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.077739471225       residual = 1.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.584368773665       residual = 1.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       0.104629356967       residual = 9.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       0.046972652166       residual = 1.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.261901947966       residual = 3.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -2.318724465063       residual = 2.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.695734809526       residual = 7.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -3.296821654752       residual = 6.59e+02           smallest_sin_value = 1.00e+00
davidson iteration   39 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         39 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+12 is 6.828563e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.849941 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7725e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1587
    reference variance = 0.169201
====================================================
  Execution time = 3.6634e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9051e-01
  Total weights = 2.0000e+06
  Execution time = 3.3668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290548730130
                                         uncertainty =       0.009039821301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290548730130
                                         uncertainty =       0.009039821301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381120985
  error estimate for blocks of size 2^( 2) =       0.000394352859
  error estimate for blocks of size 2^( 3) =       0.000406610617
  error estimate for blocks of size 2^( 4) =       0.000415015924
  error estimate for blocks of size 2^( 5) =       0.000420205734
  error estimate for blocks of size 2^( 6) =       0.000423776149
  error estimate for blocks of size 2^( 7) =       0.000423560493

      target function =      -0.926665118935
              le_mean =     -17.211577338019
             les_mean =     296.528900727243
             stat err =       0.000420639575
             autocorr =       1.218132516978
   target nu stat err =       0.000420639575
   target dn stat err =       0.008585953166
      target stat err =       0.014268554953
              std dev =       0.538986465410
             le_variance =       0.290506409895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290548730130
                                         uncertainty =       0.009039821301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290548730130
                                         uncertainty =       0.009039821301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381120985
  error estimate for blocks of size 2^( 2) =       0.000394352859
  error estimate for blocks of size 2^( 3) =       0.000406610617
  error estimate for blocks of size 2^( 4) =       0.000415015924
  error estimate for blocks of size 2^( 5) =       0.000420205734
  error estimate for blocks of size 2^( 6) =       0.000423776149
  error estimate for blocks of size 2^( 7) =       0.000423560493

      target function =      -0.926665118935
              le_mean =     -17.211577338019
             les_mean =     296.528900727243
             stat err =       0.000420639575
             autocorr =       1.218132516978
   target nu stat err =       0.000420639575
   target dn stat err =       0.008585953166
      target stat err =       0.014268554953
              std dev =       0.538986465410
             le_variance =       0.290506409895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290548730130
                                         uncertainty =       0.009039821301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290548730130
                                         uncertainty =       0.009039821301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381120985
  error estimate for blocks of size 2^( 2) =       0.000394352859
  error estimate for blocks of size 2^( 3) =       0.000406610617
  error estimate for blocks of size 2^( 4) =       0.000415015924
  error estimate for blocks of size 2^( 5) =       0.000420205734
  error estimate for blocks of size 2^( 6) =       0.000423776149
  error estimate for blocks of size 2^( 7) =       0.000423560493

      target function =      -0.926665118935
              le_mean =     -17.211577338019
             les_mean =     296.528900727243
             stat err =       0.000420639575
             autocorr =       1.218132516978
   target nu stat err =       0.000420639575
   target dn stat err =       0.008585953166
      target stat err =       0.014268554953
              std dev =       0.538986465410
             le_variance =       0.290506409895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290548730130
                                         uncertainty =       0.009039821301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290548730130
                                         uncertainty =       0.009039821301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381120985
  error estimate for blocks of size 2^( 2) =       0.000394352859
  error estimate for blocks of size 2^( 3) =       0.000406610617
  error estimate for blocks of size 2^( 4) =       0.000415015924
  error estimate for blocks of size 2^( 5) =       0.000420205734
  error estimate for blocks of size 2^( 6) =       0.000423776149
  error estimate for blocks of size 2^( 7) =       0.000423560493

      target function =      -0.926665118935
              le_mean =     -17.211577338019
             les_mean =     296.528900727243
             stat err =       0.000420639575
             autocorr =       1.218132516977
   target nu stat err =       0.000420639575
   target dn stat err =       0.008585953166
      target stat err =       0.014268554953
              std dev =       0.538986465410
             le_variance =       0.290506409895


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926665118935        initial  <--
     3.8147e+11     3.8147e+12             1.1651e-15        -0.926665118935
     1.5259e+12     1.5259e+13             2.2257e-16        -0.926665118935
     6.1035e+12     6.1035e+13             6.8286e-17        -0.926665118935

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.6729
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0141e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2053
    reference variance = 0.172973
====================================================
  Execution time = 3.7414e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7524e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0260e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275125690729
                                         uncertainty =       0.001788783045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275125690729
                                         uncertainty =       0.001788783045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370974779
  error estimate for blocks of size 2^( 2) =       0.000384333848
  error estimate for blocks of size 2^( 3) =       0.000396679622
  error estimate for blocks of size 2^( 4) =       0.000405246223
  error estimate for blocks of size 2^( 5) =       0.000410251253
  error estimate for blocks of size 2^( 6) =       0.000413770036
  error estimate for blocks of size 2^( 7) =       0.000415626794

      target function =      -0.952921823471
              le_mean =     -17.212258504736
             les_mean =     296.537087269481
             stat err =       0.000411223577
             autocorr =       1.228760502014
   target nu stat err =       0.000411223577
   target dn stat err =       0.001966323508
      target stat err =       0.003536623458
              std dev =       0.524637563703
             le_variance =       0.275244573248


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721225850474e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952933748955       residual = 8.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952933748955       residual = 9.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952933748955       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952933748955       residual = 9.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952933748955       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.954727648900       residual = 6.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953535048644       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.958785544497       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939136286276       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952350044276       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.966091466019       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.953036029016       residual = 9.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.960479097401       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.954817276544       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934547670474       residual = 3.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935333916930       residual = 3.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.954596314115       residual = 6.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949948315845       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.964354225988       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.916605180413       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948176744069       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.025885136465       residual = 4.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933618111409       residual = 5.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947731734584       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.875598874245       residual = 5.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.928387679969       residual = 5.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.902486219663       residual = 2.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.950988670318       residual = 3.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914662709989       residual = 1.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.128610704846       residual = 2.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.081498249173       residual = 1.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.858222000541       residual = 3.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.851037534319       residual = 2.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.527084361847       residual = 2.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.899613489166       residual = 1.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.224973907004       residual = 1.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =       2.570385778540       residual = 1.09e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.650840684705       residual = 4.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.433971893061       residual = 1.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -2.251989482509       residual = 4.04e+02           smallest_sin_value = 9.90e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.62e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+12 is 5.874526e-17

solving harmonic davidson linear method for identity shift 1.5259e+13, overlap shift 1.5259e+14 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952933748955       residual = 8.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952933748955       residual = 8.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+13, overlap shift 6.1035e+14 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952933748955       residual = 8.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952933748955       residual = 8.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.875727 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7706e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2129
    reference variance = 0.219822
====================================================
  Execution time = 3.6609e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7954e-01
  Total weights = 2.0000e+06
  Execution time = 3.3693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635692430
                                         uncertainty =       0.002895174375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635692430
                                         uncertainty =       0.002895174375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373861280
  error estimate for blocks of size 2^( 2) =       0.000387147136
  error estimate for blocks of size 2^( 3) =       0.000399130298
  error estimate for blocks of size 2^( 4) =       0.000408090592
  error estimate for blocks of size 2^( 5) =       0.000413728527
  error estimate for blocks of size 2^( 6) =       0.000415594999
  error estimate for blocks of size 2^( 7) =       0.000414746333

      target function =      -0.945404673018
              le_mean =     -17.212401089904
             les_mean =     296.546295653772
             stat err =       0.000413040113
             autocorr =       1.220572227073
   target nu stat err =       0.000413040113
   target dn stat err =       0.003008759182
      target stat err =       0.005258789053
              std dev =       0.528719693058
             le_variance =       0.279544513827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635692430
                                         uncertainty =       0.002895174375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635692430
                                         uncertainty =       0.002895174375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373861280
  error estimate for blocks of size 2^( 2) =       0.000387147136
  error estimate for blocks of size 2^( 3) =       0.000399130298
  error estimate for blocks of size 2^( 4) =       0.000408090592
  error estimate for blocks of size 2^( 5) =       0.000413728527
  error estimate for blocks of size 2^( 6) =       0.000415594999
  error estimate for blocks of size 2^( 7) =       0.000414746333

      target function =      -0.945404673018
              le_mean =     -17.212401089904
             les_mean =     296.546295653772
             stat err =       0.000413040113
             autocorr =       1.220572227073
   target nu stat err =       0.000413040113
   target dn stat err =       0.003008759182
      target stat err =       0.005258789053
              std dev =       0.528719693058
             le_variance =       0.279544513827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635692430
                                         uncertainty =       0.002895174375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635692430
                                         uncertainty =       0.002895174375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373861280
  error estimate for blocks of size 2^( 2) =       0.000387147136
  error estimate for blocks of size 2^( 3) =       0.000399130298
  error estimate for blocks of size 2^( 4) =       0.000408090592
  error estimate for blocks of size 2^( 5) =       0.000413728527
  error estimate for blocks of size 2^( 6) =       0.000415594999
  error estimate for blocks of size 2^( 7) =       0.000414746333

      target function =      -0.945404673018
              le_mean =     -17.212401089904
             les_mean =     296.546295653772
             stat err =       0.000413040113
             autocorr =       1.220572227073
   target nu stat err =       0.000413040113
   target dn stat err =       0.003008759182
      target stat err =       0.005258789053
              std dev =       0.528719693058
             le_variance =       0.279544513827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635692430
                                         uncertainty =       0.002895174375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635692430
                                         uncertainty =       0.002895174375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373861280
  error estimate for blocks of size 2^( 2) =       0.000387147136
  error estimate for blocks of size 2^( 3) =       0.000399130298
  error estimate for blocks of size 2^( 4) =       0.000408090592
  error estimate for blocks of size 2^( 5) =       0.000413728527
  error estimate for blocks of size 2^( 6) =       0.000415594999
  error estimate for blocks of size 2^( 7) =       0.000414746333

      target function =      -0.945404673018
              le_mean =     -17.212401089904
             les_mean =     296.546295653772
             stat err =       0.000413040113
             autocorr =       1.220572227073
   target nu stat err =       0.000413040113
   target dn stat err =       0.003008759182
      target stat err =       0.005258789053
              std dev =       0.528719693058
             le_variance =       0.279544513827


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945404673018        initial  <--
     3.8147e+12     3.8147e+13             5.8745e-17        -0.945404673018
     1.5259e+13     1.5259e+14             0.0000e+00        -0.945404673018
     6.1035e+13     6.1035e+14             0.0000e+00        -0.945404673018

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.6677
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0138e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2183
    reference variance = 0.239945
====================================================
  Execution time = 3.7439e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7484e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0084e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274867882969
                                         uncertainty =       0.001949027138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274867882969
                                         uncertainty =       0.001949027138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370703900
  error estimate for blocks of size 2^( 2) =       0.000384144953
  error estimate for blocks of size 2^( 3) =       0.000396071084
  error estimate for blocks of size 2^( 4) =       0.000404772894
  error estimate for blocks of size 2^( 5) =       0.000411031919
  error estimate for blocks of size 2^( 6) =       0.000414875463
  error estimate for blocks of size 2^( 7) =       0.000416323211

      target function =      -0.953631009974
              le_mean =     -17.212151912485
             les_mean =     296.533016084533
             stat err =       0.000411750872
             autocorr =       1.233714711101
   target nu stat err =       0.000411750872
   target dn stat err =       0.001967047597
      target stat err =       0.003542490791
              std dev =       0.524254483523
             le_variance =       0.274842763494


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721215191248e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953642935338       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953642935338       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953642935338       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953642935338       residual = 7.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953642935338       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953642935338       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953642958070       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950754260971       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913963978496       residual = 4.97e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.976796747743       residual = 3.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951840279230       residual = 1.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.969922662231       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.889583881282       residual = 3.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.963419597469       residual = 9.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.992900202378       residual = 1.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.028681149063       residual = 7.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.953545462663       residual = 9.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.796277207390       residual = 3.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.990950019535       residual = 4.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.976430670190       residual = 4.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930642146981       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.093194594183       residual = 2.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.091602265745       residual = 2.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.422524821257       residual = 2.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.778552337063       residual = 4.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.522739886632       residual = 2.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.733087563408       residual = 4.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.913272147141       residual = 2.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.107000341346       residual = 9.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.679489736305       residual = 2.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       0.429538133445       residual = 1.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.011520060137       residual = 1.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       0.466725917899       residual = 5.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -2.616030693408       residual = 6.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -4.412506217586       residual = 1.23e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       2.991725102660       residual = 3.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   36 stopping due to too large eigenvalue change
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+13 is 8.470775e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+14, overlap shift 1.5259e+15 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953642935338       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953642935338       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953642935338       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+14 is 7.942122e-19

solving harmonic davidson linear method for identity shift 6.1035e+14, overlap shift 6.1035e+15 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953642935338       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953642935338       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953642935338       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953642935338       residual = 7.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.404589864209       residual = 3.19e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.616368546580       residual = 9.66e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.864578280578       residual = 6.75e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.510352572466       residual = 1.71e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.131975619103       residual = 6.55e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.576089154311       residual = 3.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -2.092675659824       residual = 1.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.237815250791       residual = 6.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.897064099395       residual = 2.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -3.755142127894       residual = 8.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -2.306973800807       residual = 1.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =       4.895717074186       residual = 2.61e+03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.215493065215       residual = 9.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =       1.656756266694       residual = 6.17e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -3.753490428804       residual = 1.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =       5.750493361668       residual = 3.75e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.926855531090       residual = 1.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -4.158897334329       residual = 1.20e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       4.558731427375       residual = 2.25e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.694515059432       residual = 1.48e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =       1.284617761359       residual = 2.61e+03           smallest_sin_value = 1.00e+00
davidson iteration   25 stopping due to too large eigenvalue change
davidson solver did not converge after         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+14 is 3.007771e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.902289 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7557e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2563
    reference variance = 0.418617
====================================================
  Execution time = 3.6798e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.0462e-01
  Total weights = 2.0000e+06
  Execution time = 3.3656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304661431925
                                         uncertainty =       0.017750614744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304661431925
                                         uncertainty =       0.017750614744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390270656
  error estimate for blocks of size 2^( 2) =       0.000403292649
  error estimate for blocks of size 2^( 3) =       0.000415180335
  error estimate for blocks of size 2^( 4) =       0.000424450084
  error estimate for blocks of size 2^( 5) =       0.000429556404
  error estimate for blocks of size 2^( 6) =       0.000432809358
  error estimate for blocks of size 2^( 7) =       0.000435080590

      target function =      -0.903164406129
              le_mean =     -17.211884586077
             les_mean =     296.553593221342
             stat err =       0.000430474109
             autocorr =       1.216640518240
   target nu stat err =       0.000430474109
   target dn stat err =       0.017537042200
      target stat err =       0.027691402146
              std dev =       0.551926054135
             le_variance =       0.304622369234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304661431925
                                         uncertainty =       0.017750614744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304661431925
                                         uncertainty =       0.017750614744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390270656
  error estimate for blocks of size 2^( 2) =       0.000403292649
  error estimate for blocks of size 2^( 3) =       0.000415180335
  error estimate for blocks of size 2^( 4) =       0.000424450084
  error estimate for blocks of size 2^( 5) =       0.000429556404
  error estimate for blocks of size 2^( 6) =       0.000432809358
  error estimate for blocks of size 2^( 7) =       0.000435080590

      target function =      -0.903164406129
              le_mean =     -17.211884586077
             les_mean =     296.553593221342
             stat err =       0.000430474109
             autocorr =       1.216640518245
   target nu stat err =       0.000430474109
   target dn stat err =       0.017537042200
      target stat err =       0.027691402146
              std dev =       0.551926054135
             le_variance =       0.304622369234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304661431925
                                         uncertainty =       0.017750614744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304661431925
                                         uncertainty =       0.017750614744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390270656
  error estimate for blocks of size 2^( 2) =       0.000403292649
  error estimate for blocks of size 2^( 3) =       0.000415180335
  error estimate for blocks of size 2^( 4) =       0.000424450084
  error estimate for blocks of size 2^( 5) =       0.000429556404
  error estimate for blocks of size 2^( 6) =       0.000432809358
  error estimate for blocks of size 2^( 7) =       0.000435080590

      target function =      -0.903164406129
              le_mean =     -17.211884586077
             les_mean =     296.553593221342
             stat err =       0.000430474109
             autocorr =       1.216640518240
   target nu stat err =       0.000430474109
   target dn stat err =       0.017537042200
      target stat err =       0.027691402146
              std dev =       0.551926054135
             le_variance =       0.304622369234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304661431925
                                         uncertainty =       0.017750614744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304661431925
                                         uncertainty =       0.017750614744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390270656
  error estimate for blocks of size 2^( 2) =       0.000403292649
  error estimate for blocks of size 2^( 3) =       0.000415180335
  error estimate for blocks of size 2^( 4) =       0.000424450084
  error estimate for blocks of size 2^( 5) =       0.000429556404
  error estimate for blocks of size 2^( 6) =       0.000432809358
  error estimate for blocks of size 2^( 7) =       0.000435080590

      target function =      -0.903164406129
              le_mean =     -17.211884586077
             les_mean =     296.553593221342
             stat err =       0.000430474109
             autocorr =       1.216640518240
   target nu stat err =       0.000430474109
   target dn stat err =       0.017537042200
      target stat err =       0.027691402146
              std dev =       0.551926054135
             le_variance =       0.304622369234


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.903164406129        initial
     3.8147e+13     3.8147e+14             8.4708e-18        -0.903164406129  <--
     1.5259e+14     1.5259e+15             7.9421e-19        -0.903164406129
     6.1035e+14     6.1035e+15             3.0078e-19        -0.903164406129

*****************************************************************************
Applying the update for shift_i =   3.8147e+13     and shift_s =   3.8147e+14
*****************************************************************************

  Execution time = 5.5757e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0332e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2146
    reference variance = 0.241005
====================================================
  Execution time = 3.7761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8051e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0079e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280511370781
                                         uncertainty =       0.003327129040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280511370781
                                         uncertainty =       0.003327129040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374508966
  error estimate for blocks of size 2^( 2) =       0.000388263109
  error estimate for blocks of size 2^( 3) =       0.000400802675
  error estimate for blocks of size 2^( 4) =       0.000409422714
  error estimate for blocks of size 2^( 5) =       0.000414802918
  error estimate for blocks of size 2^( 6) =       0.000417432681
  error estimate for blocks of size 2^( 7) =       0.000420743277

      target function =      -0.943762547004
              le_mean =     -17.211481028342
             les_mean =     296.515592979388
             stat err =       0.000415600397
             autocorr =       1.231480303420
   target nu stat err =       0.000415600397
   target dn stat err =       0.003420636092
      target stat err =       0.005934235728
              std dev =       0.529635658410
             le_variance =       0.280513930660


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721148102834e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943799032549       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943799032549       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.43e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943799032549       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943799032549       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.43e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+14, overlap shift 1.5259e+15 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943799032549       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943799032549       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.43e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.903330 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7847e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1726
    reference variance = 0.397039
====================================================
  Execution time = 3.6678e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7943e-01
  Total weights = 2.0000e+06
  Execution time = 3.3875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279454425271
                                         uncertainty =       0.002305394950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279454425271
                                         uncertainty =       0.002305394950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373786911
  error estimate for blocks of size 2^( 2) =       0.000387445707
  error estimate for blocks of size 2^( 3) =       0.000399751058
  error estimate for blocks of size 2^( 4) =       0.000408830384
  error estimate for blocks of size 2^( 5) =       0.000413394425
  error estimate for blocks of size 2^( 6) =       0.000415082287
  error estimate for blocks of size 2^( 7) =       0.000417539214

      target function =      -0.945604917693
              le_mean =     -17.212486689055
             les_mean =     296.549131190953
             stat err =       0.000413711577
             autocorr =       1.225031256120
   target nu stat err =       0.000413711577
   target dn stat err =       0.002342293990
      target stat err =       0.004123883569
              std dev =       0.528614519081
             le_variance =       0.279433309783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279454425271
                                         uncertainty =       0.002305394950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279454425271
                                         uncertainty =       0.002305394950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373786911
  error estimate for blocks of size 2^( 2) =       0.000387445707
  error estimate for blocks of size 2^( 3) =       0.000399751058
  error estimate for blocks of size 2^( 4) =       0.000408830384
  error estimate for blocks of size 2^( 5) =       0.000413394425
  error estimate for blocks of size 2^( 6) =       0.000415082287
  error estimate for blocks of size 2^( 7) =       0.000417539214

      target function =      -0.945604917693
              le_mean =     -17.212486689055
             les_mean =     296.549131190953
             stat err =       0.000413711577
             autocorr =       1.225031256120
   target nu stat err =       0.000413711577
   target dn stat err =       0.002342293990
      target stat err =       0.004123883569
              std dev =       0.528614519081
             le_variance =       0.279433309783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279454425271
                                         uncertainty =       0.002305394950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279454425271
                                         uncertainty =       0.002305394950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373786911
  error estimate for blocks of size 2^( 2) =       0.000387445707
  error estimate for blocks of size 2^( 3) =       0.000399751058
  error estimate for blocks of size 2^( 4) =       0.000408830384
  error estimate for blocks of size 2^( 5) =       0.000413394425
  error estimate for blocks of size 2^( 6) =       0.000415082287
  error estimate for blocks of size 2^( 7) =       0.000417539214

      target function =      -0.945604917693
              le_mean =     -17.212486689055
             les_mean =     296.549131190953
             stat err =       0.000413711577
             autocorr =       1.225031256120
   target nu stat err =       0.000413711577
   target dn stat err =       0.002342293990
      target stat err =       0.004123883569
              std dev =       0.528614519081
             le_variance =       0.279433309783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279454425271
                                         uncertainty =       0.002305394950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279454425271
                                         uncertainty =       0.002305394950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373786911
  error estimate for blocks of size 2^( 2) =       0.000387445707
  error estimate for blocks of size 2^( 3) =       0.000399751058
  error estimate for blocks of size 2^( 4) =       0.000408830384
  error estimate for blocks of size 2^( 5) =       0.000413394425
  error estimate for blocks of size 2^( 6) =       0.000415082287
  error estimate for blocks of size 2^( 7) =       0.000417539214

      target function =      -0.945604917693
              le_mean =     -17.212486689055
             les_mean =     296.549131190953
             stat err =       0.000413711577
             autocorr =       1.225031256120
   target nu stat err =       0.000413711577
   target dn stat err =       0.002342293990
      target stat err =       0.004123883569
              std dev =       0.528614519081
             le_variance =       0.279433309783


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945604917693        initial  <--
     9.5367e+12     9.5367e+13             0.0000e+00        -0.945604917693
     3.8147e+13     3.8147e+14             0.0000e+00        -0.945604917693
     1.5259e+14     1.5259e+15             0.0000e+00        -0.945604917693

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7649
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0162e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1474
    reference variance = 0.14716
====================================================
  Execution time = 3.7870e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7623e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276169921583
                                         uncertainty =       0.002266585270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276169921583
                                         uncertainty =       0.002266585270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371640812
  error estimate for blocks of size 2^( 2) =       0.000385758438
  error estimate for blocks of size 2^( 3) =       0.000398270932
  error estimate for blocks of size 2^( 4) =       0.000408035810
  error estimate for blocks of size 2^( 5) =       0.000413989032
  error estimate for blocks of size 2^( 6) =       0.000417227403
  error estimate for blocks of size 2^( 7) =       0.000419811433

      target function =      -0.951188806690
              le_mean =     -17.212043687867
             les_mean =     296.530681561914
             stat err =       0.000414765920
             autocorr =       1.245544725203
   target nu stat err =       0.000414765920
   target dn stat err =       0.002307974701
      target stat err =       0.004109667891
              std dev =       0.525579477318
             le_variance =       0.276233786978


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721204368787e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951205557021       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951205557021       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951205557021       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951205557021       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+15, overlap shift 1.5259e+16 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951205557021       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951205557021       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.34e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.905707 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7814e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2286
    reference variance = 0.204826
====================================================
  Execution time = 3.6874e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7697e-01
  Total weights = 2.0000e+06
  Execution time = 3.3692e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277018571192
                                         uncertainty =       0.002771100094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277018571192
                                         uncertainty =       0.002771100094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372139147
  error estimate for blocks of size 2^( 2) =       0.000386207401
  error estimate for blocks of size 2^( 3) =       0.000398874268
  error estimate for blocks of size 2^( 4) =       0.000408409804
  error estimate for blocks of size 2^( 5) =       0.000413726041
  error estimate for blocks of size 2^( 6) =       0.000416342198
  error estimate for blocks of size 2^( 7) =       0.000417347907

      target function =      -0.949899668209
              le_mean =     -17.211582685277
             les_mean =     296.515553482398
             stat err =       0.000413956488
             autocorr =       1.237367407555
   target nu stat err =       0.000413956488
   target dn stat err =       0.002809573346
      target stat err =       0.004956799243
              std dev =       0.526284228125
             le_variance =       0.276975088774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277018571192
                                         uncertainty =       0.002771100094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277018571192
                                         uncertainty =       0.002771100094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372139147
  error estimate for blocks of size 2^( 2) =       0.000386207401
  error estimate for blocks of size 2^( 3) =       0.000398874268
  error estimate for blocks of size 2^( 4) =       0.000408409804
  error estimate for blocks of size 2^( 5) =       0.000413726041
  error estimate for blocks of size 2^( 6) =       0.000416342198
  error estimate for blocks of size 2^( 7) =       0.000417347907

      target function =      -0.949899668209
              le_mean =     -17.211582685277
             les_mean =     296.515553482398
             stat err =       0.000413956488
             autocorr =       1.237367407555
   target nu stat err =       0.000413956488
   target dn stat err =       0.002809573346
      target stat err =       0.004956799243
              std dev =       0.526284228125
             le_variance =       0.276975088774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277018571192
                                         uncertainty =       0.002771100094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277018571192
                                         uncertainty =       0.002771100094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372139147
  error estimate for blocks of size 2^( 2) =       0.000386207401
  error estimate for blocks of size 2^( 3) =       0.000398874268
  error estimate for blocks of size 2^( 4) =       0.000408409804
  error estimate for blocks of size 2^( 5) =       0.000413726041
  error estimate for blocks of size 2^( 6) =       0.000416342198
  error estimate for blocks of size 2^( 7) =       0.000417347907

      target function =      -0.949899668209
              le_mean =     -17.211582685277
             les_mean =     296.515553482398
             stat err =       0.000413956488
             autocorr =       1.237367407555
   target nu stat err =       0.000413956488
   target dn stat err =       0.002809573346
      target stat err =       0.004956799243
              std dev =       0.526284228125
             le_variance =       0.276975088774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277018571192
                                         uncertainty =       0.002771100094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277018571192
                                         uncertainty =       0.002771100094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372139147
  error estimate for blocks of size 2^( 2) =       0.000386207401
  error estimate for blocks of size 2^( 3) =       0.000398874268
  error estimate for blocks of size 2^( 4) =       0.000408409804
  error estimate for blocks of size 2^( 5) =       0.000413726041
  error estimate for blocks of size 2^( 6) =       0.000416342198
  error estimate for blocks of size 2^( 7) =       0.000417347907

      target function =      -0.949899668209
              le_mean =     -17.211582685277
             les_mean =     296.515553482398
             stat err =       0.000413956488
             autocorr =       1.237367407555
   target nu stat err =       0.000413956488
   target dn stat err =       0.002809573346
      target stat err =       0.004956799243
              std dev =       0.526284228125
             le_variance =       0.276975088774


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949899668209        initial  <--
     9.5367e+13     9.5367e+14             0.0000e+00        -0.949899668209
     3.8147e+14     3.8147e+15             0.0000e+00        -0.949899668209
     1.5259e+15     1.5259e+16             0.0000e+00        -0.949899668209

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.8978
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0173e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.191
    reference variance = 0.145744
====================================================
  Execution time = 3.7271e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8124e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.8305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281303513484
                                         uncertainty =       0.002289141353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281303513484
                                         uncertainty =       0.002289141353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374993982
  error estimate for blocks of size 2^( 2) =       0.000388662481
  error estimate for blocks of size 2^( 3) =       0.000401248389
  error estimate for blocks of size 2^( 4) =       0.000410708822
  error estimate for blocks of size 2^( 5) =       0.000416287169
  error estimate for blocks of size 2^( 6) =       0.000419730840
  error estimate for blocks of size 2^( 7) =       0.000421511043

      target function =      -0.942518143659
              le_mean =     -17.211836894137
             les_mean =     296.528570102092
             stat err =       0.000417059469
             autocorr =       1.236936416952
   target nu stat err =       0.000417059469
   target dn stat err =       0.002278601774
      target stat err =       0.003986010541
              std dev =       0.530321574474
             le_variance =       0.281240972353


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721183689414e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942533798233       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942533798233       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942533798233       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942533798233       residual = 6.29e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.957266971592       residual = 1.94e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942533798654       residual = 6.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.962422914108       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.462133984845       residual = 3.88e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.659021505283       residual = 1.75e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -1.121235178865       residual = 7.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       0.180094481577       residual = 4.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =       3.287639903730       residual = 1.64e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -3.137491815884       residual = 3.94e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       2.462556618005       residual = 1.30e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.002022842141       residual = 3.02e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =       1.276077977471       residual = 8.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -1.353961074413       residual = 4.49e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -8.583365122816       residual = 7.52e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =       2.647816708191       residual = 1.26e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -5.324709574121       residual = 2.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =       0.482790169183       residual = 2.27e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       3.809887526088       residual = 4.97e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -3.125557728255       residual = 1.36e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -5.892280309430       residual = 3.26e+03           smallest_sin_value = 1.00e+00
davidson iteration   24 stopping due to too large eigenvalue change
davidson solver did not converge after         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+14 is 1.697804e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942533798233       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942533798233       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942533798233       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.981031354927       residual = 2.23e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942533798144       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -4.094310072743       residual = 8.38e+02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -2.433457494276       residual = 1.84e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -2.669860581883       residual = 1.62e+04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.732326696149       residual = 5.31e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -6.596977279242       residual = 1.17e+04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -5.379731927810       residual = 2.55e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =       6.377141621548       residual = 1.28e+04           smallest_sin_value = 1.00e+00
davidson iteration   12 stopping due to too large eigenvalue change
davidson solver did not converge after         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+15 is 4.244509e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+16, overlap shift 1.5259e+17 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942533798233       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942533798233       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942533798233       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942533798184       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942533798233       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942533806318       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+16 is 1.700069e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.915125 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7117e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2811
    reference variance = 0.24423
====================================================
  Execution time = 3.6602e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8271e-01
  Total weights = 2.0000e+06
  Execution time = 3.3670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282461495620
                                         uncertainty =       0.002873022951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282461495620
                                         uncertainty =       0.002873022951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375971247
  error estimate for blocks of size 2^( 2) =       0.000389840077
  error estimate for blocks of size 2^( 3) =       0.000402620827
  error estimate for blocks of size 2^( 4) =       0.000411843931
  error estimate for blocks of size 2^( 5) =       0.000417243161
  error estimate for blocks of size 2^( 6) =       0.000420190778
  error estimate for blocks of size 2^( 7) =       0.000420366019

      target function =      -0.940011416448
              le_mean =     -17.211460520696
             les_mean =     296.517081871129
             stat err =       0.000417410972
             autocorr =       1.232589480484
   target nu stat err =       0.000417410972
   target dn stat err =       0.003001045090
      target stat err =       0.005178251859
              std dev =       0.531703636429
             le_variance =       0.282708756992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282461495620
                                         uncertainty =       0.002873022951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282461495620
                                         uncertainty =       0.002873022951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375971247
  error estimate for blocks of size 2^( 2) =       0.000389840077
  error estimate for blocks of size 2^( 3) =       0.000402620827
  error estimate for blocks of size 2^( 4) =       0.000411843931
  error estimate for blocks of size 2^( 5) =       0.000417243161
  error estimate for blocks of size 2^( 6) =       0.000420190778
  error estimate for blocks of size 2^( 7) =       0.000420366019

      target function =      -0.940011416448
              le_mean =     -17.211460520696
             les_mean =     296.517081871129
             stat err =       0.000417410972
             autocorr =       1.232589480484
   target nu stat err =       0.000417410972
   target dn stat err =       0.003001045090
      target stat err =       0.005178251859
              std dev =       0.531703636429
             le_variance =       0.282708756992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282461495620
                                         uncertainty =       0.002873022951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282461495620
                                         uncertainty =       0.002873022951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375971247
  error estimate for blocks of size 2^( 2) =       0.000389840077
  error estimate for blocks of size 2^( 3) =       0.000402620827
  error estimate for blocks of size 2^( 4) =       0.000411843931
  error estimate for blocks of size 2^( 5) =       0.000417243161
  error estimate for blocks of size 2^( 6) =       0.000420190778
  error estimate for blocks of size 2^( 7) =       0.000420366019

      target function =      -0.940011416448
              le_mean =     -17.211460520696
             les_mean =     296.517081871129
             stat err =       0.000417410972
             autocorr =       1.232589480484
   target nu stat err =       0.000417410972
   target dn stat err =       0.003001045090
      target stat err =       0.005178251859
              std dev =       0.531703636429
             le_variance =       0.282708756992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282461495620
                                         uncertainty =       0.002873022951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282461495620
                                         uncertainty =       0.002873022951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375971247
  error estimate for blocks of size 2^( 2) =       0.000389840077
  error estimate for blocks of size 2^( 3) =       0.000402620827
  error estimate for blocks of size 2^( 4) =       0.000411843931
  error estimate for blocks of size 2^( 5) =       0.000417243161
  error estimate for blocks of size 2^( 6) =       0.000420190778
  error estimate for blocks of size 2^( 7) =       0.000420366019

      target function =      -0.940011416448
              le_mean =     -17.211460520696
             les_mean =     296.517081871129
             stat err =       0.000417410972
             autocorr =       1.232589480484
   target nu stat err =       0.000417410972
   target dn stat err =       0.003001045090
      target stat err =       0.005178251859
              std dev =       0.531703636429
             le_variance =       0.282708756992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940011416448        initial  <--
     9.5367e+14     9.5367e+15             1.6978e-19        -0.940011416448
     3.8147e+15     3.8147e+16             4.2445e-20        -0.940011416448
     1.5259e+16     1.5259e+17             1.7001e-20        -0.940011416448

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7649
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0089e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2387
    reference variance = 0.176789
====================================================
  Execution time = 3.7415e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.0003e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0267e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300124281408
                                         uncertainty =       0.013399884400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300124281408
                                         uncertainty =       0.013399884400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387317377
  error estimate for blocks of size 2^( 2) =       0.000400839945
  error estimate for blocks of size 2^( 3) =       0.000412902134
  error estimate for blocks of size 2^( 4) =       0.000421811653
  error estimate for blocks of size 2^( 5) =       0.000426536609
  error estimate for blocks of size 2^( 6) =       0.000428952866
  error estimate for blocks of size 2^( 7) =       0.000432177717

      target function =      -0.910853758044
              le_mean =     -17.211622663208
             les_mean =     296.539984052217
             stat err =       0.000427369711
             autocorr =       1.217512737758
   target nu stat err =       0.000427369711
   target dn stat err =       0.013428660837
      target stat err =       0.021552641150
              std dev =       0.547749487968
             le_variance =       0.300029501570


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721162266321e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911358213743       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911358213743       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.38e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911358213743       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911358213743       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.38e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+17, overlap shift 1.5259e+18 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911358213743       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911358213743       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.916192 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7690e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.0774
    reference variance = 2.8034
====================================================
  Execution time = 3.6989e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.0494e-01
  Total weights = 2.0000e+06
  Execution time = 3.3830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304823555131
                                         uncertainty =       0.021732324635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304823555131
                                         uncertainty =       0.021732324635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390472595
  error estimate for blocks of size 2^( 2) =       0.000403696609
  error estimate for blocks of size 2^( 3) =       0.000415488518
  error estimate for blocks of size 2^( 4) =       0.000424529067
  error estimate for blocks of size 2^( 5) =       0.000430238500
  error estimate for blocks of size 2^( 6) =       0.000433188851
  error estimate for blocks of size 2^( 7) =       0.000434721281

      target function =      -0.902190018774
              le_mean =     -17.211786019314
             les_mean =     296.550515516518
             stat err =       0.000430669425
             autocorr =       1.216485575118
   target nu stat err =       0.000430669425
   target dn stat err =       0.022142871932
      target stat err =       0.034896164048
              std dev =       0.552211639071
             le_variance =       0.304937694325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304823555131
                                         uncertainty =       0.021732324635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304823555131
                                         uncertainty =       0.021732324635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390472595
  error estimate for blocks of size 2^( 2) =       0.000403696609
  error estimate for blocks of size 2^( 3) =       0.000415488518
  error estimate for blocks of size 2^( 4) =       0.000424529067
  error estimate for blocks of size 2^( 5) =       0.000430238500
  error estimate for blocks of size 2^( 6) =       0.000433188851
  error estimate for blocks of size 2^( 7) =       0.000434721281

      target function =      -0.902190018774
              le_mean =     -17.211786019314
             les_mean =     296.550515516518
             stat err =       0.000430669425
             autocorr =       1.216485575118
   target nu stat err =       0.000430669425
   target dn stat err =       0.022142871932
      target stat err =       0.034896164048
              std dev =       0.552211639071
             le_variance =       0.304937694325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304823555131
                                         uncertainty =       0.021732324635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304823555131
                                         uncertainty =       0.021732324635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390472595
  error estimate for blocks of size 2^( 2) =       0.000403696609
  error estimate for blocks of size 2^( 3) =       0.000415488518
  error estimate for blocks of size 2^( 4) =       0.000424529067
  error estimate for blocks of size 2^( 5) =       0.000430238500
  error estimate for blocks of size 2^( 6) =       0.000433188851
  error estimate for blocks of size 2^( 7) =       0.000434721281

      target function =      -0.902190018774
              le_mean =     -17.211786019314
             les_mean =     296.550515516518
             stat err =       0.000430669425
             autocorr =       1.216485575118
   target nu stat err =       0.000430669425
   target dn stat err =       0.022142871932
      target stat err =       0.034896164048
              std dev =       0.552211639071
             le_variance =       0.304937694325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304823555131
                                         uncertainty =       0.021732324635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304823555131
                                         uncertainty =       0.021732324635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390472595
  error estimate for blocks of size 2^( 2) =       0.000403696609
  error estimate for blocks of size 2^( 3) =       0.000415488518
  error estimate for blocks of size 2^( 4) =       0.000424529067
  error estimate for blocks of size 2^( 5) =       0.000430238500
  error estimate for blocks of size 2^( 6) =       0.000433188851
  error estimate for blocks of size 2^( 7) =       0.000434721281

      target function =      -0.902190018774
              le_mean =     -17.211786019314
             les_mean =     296.550515516518
             stat err =       0.000430669425
             autocorr =       1.216485575118
   target nu stat err =       0.000430669425
   target dn stat err =       0.022142871932
      target stat err =       0.034896164048
              std dev =       0.552211639071
             le_variance =       0.304937694325


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.902190018774        initial  <--
     9.5367e+15     9.5367e+16             0.0000e+00        -0.902190018774
     3.8147e+16     3.8147e+17             0.0000e+00        -0.902190018774
     1.5259e+17     1.5259e+18             0.0000e+00        -0.902190018774

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0237
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0172e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1912
    reference variance = 0.357981
====================================================
  Execution time = 3.7367e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7666e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0043e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276667302065
                                         uncertainty =       0.002076435323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276667302065
                                         uncertainty =       0.002076435323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371928737
  error estimate for blocks of size 2^( 2) =       0.000385496399
  error estimate for blocks of size 2^( 3) =       0.000398252618
  error estimate for blocks of size 2^( 4) =       0.000407036369
  error estimate for blocks of size 2^( 5) =       0.000412025657
  error estimate for blocks of size 2^( 6) =       0.000413982546
  error estimate for blocks of size 2^( 7) =       0.000414981503

      target function =      -0.950435055584
              le_mean =     -17.212294966097
             les_mean =     296.539759831846
             stat err =       0.000412006519
             autocorr =       1.227124721412
   target nu stat err =       0.000412006519
   target dn stat err =       0.002120948835
      target stat err =       0.003783535494
              std dev =       0.525986663572
             le_variance =       0.276661970255


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721229496610e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950448971806       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950448971806       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950448971806       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950448971806       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+18, overlap shift 1.5259e+19 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950448971806       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950448971806       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.917292 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7418e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.3443
    reference variance = 0.54729
====================================================
  Execution time = 3.6766e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7774e-01
  Total weights = 2.0000e+06
  Execution time = 3.3645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277619516300
                                         uncertainty =       0.002537864541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277619516300
                                         uncertainty =       0.002537864541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372650111
  error estimate for blocks of size 2^( 2) =       0.000386252639
  error estimate for blocks of size 2^( 3) =       0.000399019844
  error estimate for blocks of size 2^( 4) =       0.000408318849
  error estimate for blocks of size 2^( 5) =       0.000412874909
  error estimate for blocks of size 2^( 6) =       0.000415749911
  error estimate for blocks of size 2^( 7) =       0.000417541177

      target function =      -0.948544609912
              le_mean =     -17.212525665933
             les_mean =     296.548775872122
             stat err =       0.000413621211
             autocorr =       1.231978401768
   target nu stat err =       0.000413621211
   target dn stat err =       0.002688630349
      target stat err =       0.004743713266
              std dev =       0.527006841136
             le_variance =       0.277736210604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277619516300
                                         uncertainty =       0.002537864541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277619516300
                                         uncertainty =       0.002537864541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372650111
  error estimate for blocks of size 2^( 2) =       0.000386252639
  error estimate for blocks of size 2^( 3) =       0.000399019844
  error estimate for blocks of size 2^( 4) =       0.000408318849
  error estimate for blocks of size 2^( 5) =       0.000412874909
  error estimate for blocks of size 2^( 6) =       0.000415749911
  error estimate for blocks of size 2^( 7) =       0.000417541177

      target function =      -0.948544609912
              le_mean =     -17.212525665933
             les_mean =     296.548775872122
             stat err =       0.000413621211
             autocorr =       1.231978401768
   target nu stat err =       0.000413621211
   target dn stat err =       0.002688630349
      target stat err =       0.004743713266
              std dev =       0.527006841136
             le_variance =       0.277736210604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277619516300
                                         uncertainty =       0.002537864541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277619516300
                                         uncertainty =       0.002537864541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372650111
  error estimate for blocks of size 2^( 2) =       0.000386252639
  error estimate for blocks of size 2^( 3) =       0.000399019844
  error estimate for blocks of size 2^( 4) =       0.000408318849
  error estimate for blocks of size 2^( 5) =       0.000412874909
  error estimate for blocks of size 2^( 6) =       0.000415749911
  error estimate for blocks of size 2^( 7) =       0.000417541177

      target function =      -0.948544609912
              le_mean =     -17.212525665933
             les_mean =     296.548775872122
             stat err =       0.000413621211
             autocorr =       1.231978401768
   target nu stat err =       0.000413621211
   target dn stat err =       0.002688630349
      target stat err =       0.004743713266
              std dev =       0.527006841136
             le_variance =       0.277736210604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277619516300
                                         uncertainty =       0.002537864541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277619516300
                                         uncertainty =       0.002537864541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372650111
  error estimate for blocks of size 2^( 2) =       0.000386252639
  error estimate for blocks of size 2^( 3) =       0.000399019844
  error estimate for blocks of size 2^( 4) =       0.000408318849
  error estimate for blocks of size 2^( 5) =       0.000412874909
  error estimate for blocks of size 2^( 6) =       0.000415749911
  error estimate for blocks of size 2^( 7) =       0.000417541177

      target function =      -0.948544609912
              le_mean =     -17.212525665933
             les_mean =     296.548775872122
             stat err =       0.000413621211
             autocorr =       1.231978401768
   target nu stat err =       0.000413621211
   target dn stat err =       0.002688630349
      target stat err =       0.004743713266
              std dev =       0.527006841136
             le_variance =       0.277736210604


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948544609912        initial  <--
     9.5367e+16     9.5367e+17             0.0000e+00        -0.948544609912
     3.8147e+17     3.8147e+18             0.0000e+00        -0.948544609912
     1.5259e+18     1.5259e+19             0.0000e+00        -0.948544609912

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7450
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0117e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.195
    reference variance = 0.257546
====================================================
  Execution time = 3.7489e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7963e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0283e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279686824560
                                         uncertainty =       0.002890479174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279686824560
                                         uncertainty =       0.002890479174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373917586
  error estimate for blocks of size 2^( 2) =       0.000387475279
  error estimate for blocks of size 2^( 3) =       0.000399771643
  error estimate for blocks of size 2^( 4) =       0.000408411377
  error estimate for blocks of size 2^( 5) =       0.000413747792
  error estimate for blocks of size 2^( 6) =       0.000416116048
  error estimate for blocks of size 2^( 7) =       0.000417228065

      target function =      -0.945287562940
              le_mean =     -17.211712415618
             les_mean =     296.522672860779
             stat err =       0.000413875821
             autocorr =       1.225147354814
   target nu stat err =       0.000413875821
   target dn stat err =       0.003015303607
      target stat err =       0.005261904518
              std dev =       0.528799321725
             le_variance =       0.279628722656


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721171241562e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945315590621       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945315590621       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945315590621       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945315590621       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+19, overlap shift 1.5259e+20 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945315590621       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945315590621       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.918394 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7780e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2506
    reference variance = 0.216177
====================================================
  Execution time = 3.6929e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7816e-01
  Total weights = 2.0000e+06
  Execution time = 3.4223e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278107265272
                                         uncertainty =       0.002436648103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278107265272
                                         uncertainty =       0.002436648103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372933193
  error estimate for blocks of size 2^( 2) =       0.000386646502
  error estimate for blocks of size 2^( 3) =       0.000398924828
  error estimate for blocks of size 2^( 4) =       0.000408356288
  error estimate for blocks of size 2^( 5) =       0.000412931227
  error estimate for blocks of size 2^( 6) =       0.000417305248
  error estimate for blocks of size 2^( 7) =       0.000418705186

      target function =      -0.947836715007
              le_mean =     -17.211843497859
             les_mean =     296.525714787853
             stat err =       0.000414324487
             autocorr =       1.234295440837
   target nu stat err =       0.000414324487
   target dn stat err =       0.002566398238
      target stat err =       0.004521276031
              std dev =       0.527407178701
             le_variance =       0.278158332146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278107265272
                                         uncertainty =       0.002436648103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278107265272
                                         uncertainty =       0.002436648103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372933193
  error estimate for blocks of size 2^( 2) =       0.000386646502
  error estimate for blocks of size 2^( 3) =       0.000398924828
  error estimate for blocks of size 2^( 4) =       0.000408356288
  error estimate for blocks of size 2^( 5) =       0.000412931227
  error estimate for blocks of size 2^( 6) =       0.000417305248
  error estimate for blocks of size 2^( 7) =       0.000418705186

      target function =      -0.947836715007
              le_mean =     -17.211843497859
             les_mean =     296.525714787853
             stat err =       0.000414324487
             autocorr =       1.234295440837
   target nu stat err =       0.000414324487
   target dn stat err =       0.002566398238
      target stat err =       0.004521276031
              std dev =       0.527407178701
             le_variance =       0.278158332146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278107265272
                                         uncertainty =       0.002436648103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278107265272
                                         uncertainty =       0.002436648103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372933193
  error estimate for blocks of size 2^( 2) =       0.000386646502
  error estimate for blocks of size 2^( 3) =       0.000398924828
  error estimate for blocks of size 2^( 4) =       0.000408356288
  error estimate for blocks of size 2^( 5) =       0.000412931227
  error estimate for blocks of size 2^( 6) =       0.000417305248
  error estimate for blocks of size 2^( 7) =       0.000418705186

      target function =      -0.947836715007
              le_mean =     -17.211843497859
             les_mean =     296.525714787853
             stat err =       0.000414324487
             autocorr =       1.234295440837
   target nu stat err =       0.000414324487
   target dn stat err =       0.002566398238
      target stat err =       0.004521276031
              std dev =       0.527407178701
             le_variance =       0.278158332146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278107265272
                                         uncertainty =       0.002436648103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278107265272
                                         uncertainty =       0.002436648103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372933193
  error estimate for blocks of size 2^( 2) =       0.000386646502
  error estimate for blocks of size 2^( 3) =       0.000398924828
  error estimate for blocks of size 2^( 4) =       0.000408356288
  error estimate for blocks of size 2^( 5) =       0.000412931227
  error estimate for blocks of size 2^( 6) =       0.000417305248
  error estimate for blocks of size 2^( 7) =       0.000418705186

      target function =      -0.947836715007
              le_mean =     -17.211843497859
             les_mean =     296.525714787853
             stat err =       0.000414324487
             autocorr =       1.234295440837
   target nu stat err =       0.000414324487
   target dn stat err =       0.002566398238
      target stat err =       0.004521276031
              std dev =       0.527407178701
             le_variance =       0.278158332146


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947836715007        initial  <--
     9.5367e+17     9.5367e+18             0.0000e+00        -0.947836715007
     3.8147e+18     3.8147e+19             0.0000e+00        -0.947836715007
     1.5259e+19     1.5259e+20             0.0000e+00        -0.947836715007

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1098
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0189e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.3805
    reference variance = 0.627778
====================================================
  Execution time = 3.7277e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8961e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9423e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289648937426
                                         uncertainty =       0.004866008138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289648937426
                                         uncertainty =       0.004866008138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380535380
  error estimate for blocks of size 2^( 2) =       0.000394328164
  error estimate for blocks of size 2^( 3) =       0.000406128392
  error estimate for blocks of size 2^( 4) =       0.000415365885
  error estimate for blocks of size 2^( 5) =       0.000420966194
  error estimate for blocks of size 2^( 6) =       0.000423129023
  error estimate for blocks of size 2^( 7) =       0.000424082564

      target function =      -0.928316393952
              le_mean =     -17.211522993997
             les_mean =     296.526137979069
             stat err =       0.000420885917
             autocorr =       1.223316139469
   target nu stat err =       0.000420885917
   target dn stat err =       0.005092050072
      target stat err =       0.008511704303
              std dev =       0.538158295479
             le_variance =       0.289614350993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721152299400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928392576896       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928392576896       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928392576896       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928392576896       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+20, overlap shift 1.5259e+21 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.928392576896       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928392576896       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.919481 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7226e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1513
    reference variance = 0.206696
====================================================
  Execution time = 3.6794e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8581e-01
  Total weights = 2.0000e+06
  Execution time = 3.3894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285832606125
                                         uncertainty =       0.003827382907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285832606125
                                         uncertainty =       0.003827382907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378030745
  error estimate for blocks of size 2^( 2) =       0.000391529135
  error estimate for blocks of size 2^( 3) =       0.000403990902
  error estimate for blocks of size 2^( 4) =       0.000413083819
  error estimate for blocks of size 2^( 5) =       0.000418349368
  error estimate for blocks of size 2^( 6) =       0.000421074917
  error estimate for blocks of size 2^( 7) =       0.000424348128

      target function =      -0.934688773499
              le_mean =     -17.212016571283
             les_mean =     296.539328796155
             stat err =       0.000419214058
             autocorr =       1.229751695957
   target nu stat err =       0.000419214058
   target dn stat err =       0.003879860039
      target stat err =       0.006598564248
              std dev =       0.534616207146
             le_variance =       0.285814488943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285832606125
                                         uncertainty =       0.003827382907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285832606125
                                         uncertainty =       0.003827382907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378030745
  error estimate for blocks of size 2^( 2) =       0.000391529135
  error estimate for blocks of size 2^( 3) =       0.000403990902
  error estimate for blocks of size 2^( 4) =       0.000413083819
  error estimate for blocks of size 2^( 5) =       0.000418349368
  error estimate for blocks of size 2^( 6) =       0.000421074917
  error estimate for blocks of size 2^( 7) =       0.000424348128

      target function =      -0.934688773499
              le_mean =     -17.212016571283
             les_mean =     296.539328796155
             stat err =       0.000419214058
             autocorr =       1.229751695957
   target nu stat err =       0.000419214058
   target dn stat err =       0.003879860039
      target stat err =       0.006598564248
              std dev =       0.534616207146
             le_variance =       0.285814488943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285832606125
                                         uncertainty =       0.003827382907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285832606125
                                         uncertainty =       0.003827382907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378030745
  error estimate for blocks of size 2^( 2) =       0.000391529135
  error estimate for blocks of size 2^( 3) =       0.000403990902
  error estimate for blocks of size 2^( 4) =       0.000413083819
  error estimate for blocks of size 2^( 5) =       0.000418349368
  error estimate for blocks of size 2^( 6) =       0.000421074917
  error estimate for blocks of size 2^( 7) =       0.000424348128

      target function =      -0.934688773499
              le_mean =     -17.212016571283
             les_mean =     296.539328796155
             stat err =       0.000419214058
             autocorr =       1.229751695957
   target nu stat err =       0.000419214058
   target dn stat err =       0.003879860039
      target stat err =       0.006598564248
              std dev =       0.534616207146
             le_variance =       0.285814488943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285832606125
                                         uncertainty =       0.003827382907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285832606125
                                         uncertainty =       0.003827382907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378030745
  error estimate for blocks of size 2^( 2) =       0.000391529135
  error estimate for blocks of size 2^( 3) =       0.000403990902
  error estimate for blocks of size 2^( 4) =       0.000413083819
  error estimate for blocks of size 2^( 5) =       0.000418349368
  error estimate for blocks of size 2^( 6) =       0.000421074917
  error estimate for blocks of size 2^( 7) =       0.000424348128

      target function =      -0.934688773499
              le_mean =     -17.212016571283
             les_mean =     296.539328796155
             stat err =       0.000419214058
             autocorr =       1.229751695957
   target nu stat err =       0.000419214058
   target dn stat err =       0.003879860039
      target stat err =       0.006598564248
              std dev =       0.534616207146
             le_variance =       0.285814488943


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934688773499        initial  <--
     9.5367e+18     9.5367e+19             0.0000e+00        -0.934688773499
     3.8147e+19     3.8147e+20             0.0000e+00        -0.934688773499
     1.5259e+20     1.5259e+21             0.0000e+00        -0.934688773499

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.8736
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0111e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2356
    reference variance = 0.339829
====================================================
  Execution time = 3.7780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7815e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0204e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278217043294
                                         uncertainty =       0.002052892524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278217043294
                                         uncertainty =       0.002052892524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372930536
  error estimate for blocks of size 2^( 2) =       0.000386650747
  error estimate for blocks of size 2^( 3) =       0.000399295142
  error estimate for blocks of size 2^( 4) =       0.000408298908
  error estimate for blocks of size 2^( 5) =       0.000414117657
  error estimate for blocks of size 2^( 6) =       0.000417605706
  error estimate for blocks of size 2^( 7) =       0.000419523036

      target function =      -0.947841475703
              le_mean =     -17.212025882651
             les_mean =     296.531989215229
             stat err =       0.000414886327
             autocorr =       1.237662845977
   target nu stat err =       0.000414886327
   target dn stat err =       0.002267043930
      target stat err =       0.004011346586
              std dev =       0.527403421725
             le_variance =       0.278154369247


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721202588265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947857557907       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947857557907       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947857557907       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947857557907       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+21, overlap shift 1.5259e+22 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947857557907       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947857557907       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.920595 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7991e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.225
    reference variance = 0.210939
====================================================
  Execution time = 3.6605e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8017e-01
  Total weights = 2.0000e+06
  Execution time = 3.3712e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280159971924
                                         uncertainty =       0.003559077003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280159971924
                                         uncertainty =       0.003559077003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374280815
  error estimate for blocks of size 2^( 2) =       0.000387629024
  error estimate for blocks of size 2^( 3) =       0.000399930474
  error estimate for blocks of size 2^( 4) =       0.000409023591
  error estimate for blocks of size 2^( 5) =       0.000415633581
  error estimate for blocks of size 2^( 6) =       0.000420241542
  error estimate for blocks of size 2^( 7) =       0.000421163447

      target function =      -0.944334455223
              le_mean =     -17.211669090063
             les_mean =     296.521724982406
             stat err =       0.000416515540
             autocorr =       1.238418089239
   target nu stat err =       0.000416515540
   target dn stat err =       0.003798195317
      target stat err =       0.006589652431
              std dev =       0.529313004436
             le_variance =       0.280172256665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280159971924
                                         uncertainty =       0.003559077003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280159971924
                                         uncertainty =       0.003559077003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374280815
  error estimate for blocks of size 2^( 2) =       0.000387629024
  error estimate for blocks of size 2^( 3) =       0.000399930474
  error estimate for blocks of size 2^( 4) =       0.000409023591
  error estimate for blocks of size 2^( 5) =       0.000415633581
  error estimate for blocks of size 2^( 6) =       0.000420241542
  error estimate for blocks of size 2^( 7) =       0.000421163447

      target function =      -0.944334455223
              le_mean =     -17.211669090063
             les_mean =     296.521724982406
             stat err =       0.000416515540
             autocorr =       1.238418089239
   target nu stat err =       0.000416515540
   target dn stat err =       0.003798195317
      target stat err =       0.006589652431
              std dev =       0.529313004436
             le_variance =       0.280172256665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280159971924
                                         uncertainty =       0.003559077003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280159971924
                                         uncertainty =       0.003559077003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374280815
  error estimate for blocks of size 2^( 2) =       0.000387629024
  error estimate for blocks of size 2^( 3) =       0.000399930474
  error estimate for blocks of size 2^( 4) =       0.000409023591
  error estimate for blocks of size 2^( 5) =       0.000415633581
  error estimate for blocks of size 2^( 6) =       0.000420241542
  error estimate for blocks of size 2^( 7) =       0.000421163447

      target function =      -0.944334455223
              le_mean =     -17.211669090063
             les_mean =     296.521724982406
             stat err =       0.000416515540
             autocorr =       1.238418089239
   target nu stat err =       0.000416515540
   target dn stat err =       0.003798195317
      target stat err =       0.006589652431
              std dev =       0.529313004436
             le_variance =       0.280172256665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280159971924
                                         uncertainty =       0.003559077003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280159971924
                                         uncertainty =       0.003559077003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374280815
  error estimate for blocks of size 2^( 2) =       0.000387629024
  error estimate for blocks of size 2^( 3) =       0.000399930474
  error estimate for blocks of size 2^( 4) =       0.000409023591
  error estimate for blocks of size 2^( 5) =       0.000415633581
  error estimate for blocks of size 2^( 6) =       0.000420241542
  error estimate for blocks of size 2^( 7) =       0.000421163447

      target function =      -0.944334455223
              le_mean =     -17.211669090063
             les_mean =     296.521724982406
             stat err =       0.000416515540
             autocorr =       1.238418089239
   target nu stat err =       0.000416515540
   target dn stat err =       0.003798195317
      target stat err =       0.006589652431
              std dev =       0.529313004436
             le_variance =       0.280172256665


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944334455223        initial  <--
     9.5367e+19     9.5367e+20             0.0000e+00        -0.944334455223
     3.8147e+20     3.8147e+21             0.0000e+00        -0.944334455223
     1.5259e+21     1.5259e+22             0.0000e+00        -0.944334455223

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.6250
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0162e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2231
    reference variance = 0.174397
====================================================
  Execution time = 3.7517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7725e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0042e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277313564920
                                         uncertainty =       0.003769735495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277313564920
                                         uncertainty =       0.003769735495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372320757
  error estimate for blocks of size 2^( 2) =       0.000386391827
  error estimate for blocks of size 2^( 3) =       0.000398765287
  error estimate for blocks of size 2^( 4) =       0.000407682518
  error estimate for blocks of size 2^( 5) =       0.000413981529
  error estimate for blocks of size 2^( 6) =       0.000417797522
  error estimate for blocks of size 2^( 7) =       0.000418664266

      target function =      -0.949417051279
              le_mean =     -17.211424587608
             les_mean =     296.510381689144
             stat err =       0.000414531459
             autocorr =       1.239596924543
   target nu stat err =       0.000414531459
   target dn stat err =       0.003611293877
      target stat err =       0.006333531927
              std dev =       0.526541064744
             le_variance =       0.277245492861


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721142458761e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949458503059       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949458503059       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+21, overlap shift 3.8147e+22 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949458503059       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949458503059       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+22, overlap shift 1.5259e+23 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949458503059       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949458503059       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.921655 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7567e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2119
    reference variance = 0.409843
====================================================
  Execution time = 3.6847e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7699e-01
  Total weights = 2.0000e+06
  Execution time = 3.3718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276976796838
                                         uncertainty =       0.004765888882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276976796838
                                         uncertainty =       0.004765888882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372148524
  error estimate for blocks of size 2^( 2) =       0.000386059590
  error estimate for blocks of size 2^( 3) =       0.000398385406
  error estimate for blocks of size 2^( 4) =       0.000407171162
  error estimate for blocks of size 2^( 5) =       0.000412573888
  error estimate for blocks of size 2^( 6) =       0.000416440349
  error estimate for blocks of size 2^( 7) =       0.000418321606

      target function =      -0.949813083582
              le_mean =     -17.212234482623
             les_mean =     296.538004793692
             stat err =       0.000413626751
             autocorr =       1.235334688228
   target nu stat err =       0.000413626751
   target dn stat err =       0.004552790390
      target stat err =       0.007982536795
              std dev =       0.526297489440
             le_variance =       0.276989047391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276976796838
                                         uncertainty =       0.004765888882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276976796838
                                         uncertainty =       0.004765888882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372148524
  error estimate for blocks of size 2^( 2) =       0.000386059590
  error estimate for blocks of size 2^( 3) =       0.000398385406
  error estimate for blocks of size 2^( 4) =       0.000407171162
  error estimate for blocks of size 2^( 5) =       0.000412573888
  error estimate for blocks of size 2^( 6) =       0.000416440349
  error estimate for blocks of size 2^( 7) =       0.000418321606

      target function =      -0.949813083582
              le_mean =     -17.212234482623
             les_mean =     296.538004793692
             stat err =       0.000413626751
             autocorr =       1.235334688228
   target nu stat err =       0.000413626751
   target dn stat err =       0.004552790390
      target stat err =       0.007982536795
              std dev =       0.526297489440
             le_variance =       0.276989047391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276976796838
                                         uncertainty =       0.004765888882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276976796838
                                         uncertainty =       0.004765888882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372148524
  error estimate for blocks of size 2^( 2) =       0.000386059590
  error estimate for blocks of size 2^( 3) =       0.000398385406
  error estimate for blocks of size 2^( 4) =       0.000407171162
  error estimate for blocks of size 2^( 5) =       0.000412573888
  error estimate for blocks of size 2^( 6) =       0.000416440349
  error estimate for blocks of size 2^( 7) =       0.000418321606

      target function =      -0.949813083582
              le_mean =     -17.212234482623
             les_mean =     296.538004793692
             stat err =       0.000413626751
             autocorr =       1.235334688228
   target nu stat err =       0.000413626751
   target dn stat err =       0.004552790390
      target stat err =       0.007982536795
              std dev =       0.526297489440
             le_variance =       0.276989047391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276976796838
                                         uncertainty =       0.004765888882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276976796838
                                         uncertainty =       0.004765888882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372148524
  error estimate for blocks of size 2^( 2) =       0.000386059590
  error estimate for blocks of size 2^( 3) =       0.000398385406
  error estimate for blocks of size 2^( 4) =       0.000407171162
  error estimate for blocks of size 2^( 5) =       0.000412573888
  error estimate for blocks of size 2^( 6) =       0.000416440349
  error estimate for blocks of size 2^( 7) =       0.000418321606

      target function =      -0.949813083582
              le_mean =     -17.212234482623
             les_mean =     296.538004793692
             stat err =       0.000413626751
             autocorr =       1.235334688228
   target nu stat err =       0.000413626751
   target dn stat err =       0.004552790390
      target stat err =       0.007982536795
              std dev =       0.526297489440
             le_variance =       0.276989047391


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949813083582        initial  <--
     9.5367e+20     9.5367e+21             0.0000e+00        -0.949813083582
     3.8147e+21     3.8147e+22             0.0000e+00        -0.949813083582
     1.5259e+22     1.5259e+23             0.0000e+00        -0.949813083582

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.8149
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0139e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.222
    reference variance = 0.145623
====================================================
  Execution time = 3.7548e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7827e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278292241617
                                         uncertainty =       0.002100375269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278292241617
                                         uncertainty =       0.002100375269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373008343
  error estimate for blocks of size 2^( 2) =       0.000386898725
  error estimate for blocks of size 2^( 3) =       0.000399819755
  error estimate for blocks of size 2^( 4) =       0.000408901568
  error estimate for blocks of size 2^( 5) =       0.000414805001
  error estimate for blocks of size 2^( 6) =       0.000417277330
  error estimate for blocks of size 2^( 7) =       0.000418980613

      target function =      -0.947619804189
              le_mean =     -17.212525442133
             les_mean =     296.549302404379
             stat err =       0.000414991128
             autocorr =       1.237771655047
   target nu stat err =       0.000414991128
   target dn stat err =       0.002380875969
      target stat err =       0.004207862362
              std dev =       0.527513457118
             le_variance =       0.278270447441


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721252544213e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+21, overlap shift 9.5367e+22 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947637275619       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947637275619       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+22, overlap shift 3.8147e+23 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947637275619       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947637275619       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+23, overlap shift 1.5259e+24 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947637275619       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947637275619       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.922706 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7533e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2442
    reference variance = 0.15264
====================================================
  Execution time = 3.6720e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7840e-01
  Total weights = 2.0000e+06
  Execution time = 3.3527e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278433003156
                                         uncertainty =       0.002898873158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278433003156
                                         uncertainty =       0.002898873158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373092653
  error estimate for blocks of size 2^( 2) =       0.000386502990
  error estimate for blocks of size 2^( 3) =       0.000399164445
  error estimate for blocks of size 2^( 4) =       0.000408839664
  error estimate for blocks of size 2^( 5) =       0.000414361106
  error estimate for blocks of size 2^( 6) =       0.000417586714
  error estimate for blocks of size 2^( 7) =       0.000420104619

      target function =      -0.947388861003
              le_mean =     -17.212732927920
             les_mean =     296.556570964418
             stat err =       0.000415223026
             autocorr =       1.238595402120
   target nu stat err =       0.000415223026
   target dn stat err =       0.002631794003
      target stat err =       0.004637206424
              std dev =       0.527632690166
             le_variance =       0.278396255732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278433003156
                                         uncertainty =       0.002898873158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278433003156
                                         uncertainty =       0.002898873158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373092653
  error estimate for blocks of size 2^( 2) =       0.000386502990
  error estimate for blocks of size 2^( 3) =       0.000399164445
  error estimate for blocks of size 2^( 4) =       0.000408839664
  error estimate for blocks of size 2^( 5) =       0.000414361106
  error estimate for blocks of size 2^( 6) =       0.000417586714
  error estimate for blocks of size 2^( 7) =       0.000420104619

      target function =      -0.947388861003
              le_mean =     -17.212732927920
             les_mean =     296.556570964418
             stat err =       0.000415223026
             autocorr =       1.238595402120
   target nu stat err =       0.000415223026
   target dn stat err =       0.002631794003
      target stat err =       0.004637206424
              std dev =       0.527632690166
             le_variance =       0.278396255732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278433003156
                                         uncertainty =       0.002898873158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278433003156
                                         uncertainty =       0.002898873158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373092653
  error estimate for blocks of size 2^( 2) =       0.000386502990
  error estimate for blocks of size 2^( 3) =       0.000399164445
  error estimate for blocks of size 2^( 4) =       0.000408839664
  error estimate for blocks of size 2^( 5) =       0.000414361106
  error estimate for blocks of size 2^( 6) =       0.000417586714
  error estimate for blocks of size 2^( 7) =       0.000420104619

      target function =      -0.947388861003
              le_mean =     -17.212732927920
             les_mean =     296.556570964418
             stat err =       0.000415223026
             autocorr =       1.238595402120
   target nu stat err =       0.000415223026
   target dn stat err =       0.002631794003
      target stat err =       0.004637206424
              std dev =       0.527632690166
             le_variance =       0.278396255732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278433003156
                                         uncertainty =       0.002898873158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278433003156
                                         uncertainty =       0.002898873158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373092653
  error estimate for blocks of size 2^( 2) =       0.000386502990
  error estimate for blocks of size 2^( 3) =       0.000399164445
  error estimate for blocks of size 2^( 4) =       0.000408839664
  error estimate for blocks of size 2^( 5) =       0.000414361106
  error estimate for blocks of size 2^( 6) =       0.000417586714
  error estimate for blocks of size 2^( 7) =       0.000420104619

      target function =      -0.947388861003
              le_mean =     -17.212732927920
             les_mean =     296.556570964418
             stat err =       0.000415223026
             autocorr =       1.238595402120
   target nu stat err =       0.000415223026
   target dn stat err =       0.002631794003
      target stat err =       0.004637206424
              std dev =       0.527632690166
             le_variance =       0.278396255732


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947388861003        initial  <--
     9.5367e+21     9.5367e+22             0.0000e+00        -0.947388861003
     3.8147e+22     3.8147e+23             0.0000e+00        -0.947388861003
     1.5259e+23     1.5259e+24             0.0000e+00        -0.947388861003

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.6434
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0118e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2568
    reference variance = 0.520817
====================================================
  Execution time = 3.7675e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7801e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0212e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278040057951
                                         uncertainty =       0.002813599817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278040057951
                                         uncertainty =       0.002813599817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372831394
  error estimate for blocks of size 2^( 2) =       0.000386727298
  error estimate for blocks of size 2^( 3) =       0.000398876927
  error estimate for blocks of size 2^( 4) =       0.000407741213
  error estimate for blocks of size 2^( 5) =       0.000414200951
  error estimate for blocks of size 2^( 6) =       0.000417922617
  error estimate for blocks of size 2^( 7) =       0.000419359624

      target function =      -0.948103915196
              le_mean =     -17.211693741238
             les_mean =     296.520407799696
             stat err =       0.000414806101
             autocorr =       1.237842308588
   target nu stat err =       0.000414806101
   target dn stat err =       0.002674113289
      target stat err =       0.004707202079
              std dev =       0.527263213695
             le_variance =       0.278006496516


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721169374124e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+22, overlap shift 9.5367e+23 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948126157282       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948126157282       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+23, overlap shift 3.8147e+24 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948126157282       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948126157282       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+24, overlap shift 1.5259e+25 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948126157282       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948126157282       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.923917 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7934e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2239
    reference variance = 0.200825
====================================================
  Execution time = 3.6852e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9350e-01
  Total weights = 2.0000e+06
  Execution time = 3.3644e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293599377966
                                         uncertainty =       0.012726984459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293599377966
                                         uncertainty =       0.012726984459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383082757
  error estimate for blocks of size 2^( 2) =       0.000396197411
  error estimate for blocks of size 2^( 3) =       0.000408483361
  error estimate for blocks of size 2^( 4) =       0.000417246710
  error estimate for blocks of size 2^( 5) =       0.000423566285
  error estimate for blocks of size 2^( 6) =       0.000425638786
  error estimate for blocks of size 2^( 7) =       0.000427448075

      target function =      -0.921434923540
              le_mean =     -17.212028984768
             les_mean =     296.547446422611
             stat err =       0.000423474964
             autocorr =       1.221997371413
   target nu stat err =       0.000423474964
   target dn stat err =       0.012899771951
      target stat err =       0.021204137534
              std dev =       0.541760829945
             le_variance =       0.293504796863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293599377966
                                         uncertainty =       0.012726984459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293599377966
                                         uncertainty =       0.012726984459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383082757
  error estimate for blocks of size 2^( 2) =       0.000396197411
  error estimate for blocks of size 2^( 3) =       0.000408483361
  error estimate for blocks of size 2^( 4) =       0.000417246710
  error estimate for blocks of size 2^( 5) =       0.000423566285
  error estimate for blocks of size 2^( 6) =       0.000425638786
  error estimate for blocks of size 2^( 7) =       0.000427448075

      target function =      -0.921434923540
              le_mean =     -17.212028984768
             les_mean =     296.547446422611
             stat err =       0.000423474964
             autocorr =       1.221997371413
   target nu stat err =       0.000423474964
   target dn stat err =       0.012899771951
      target stat err =       0.021204137534
              std dev =       0.541760829945
             le_variance =       0.293504796863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293599377966
                                         uncertainty =       0.012726984459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293599377966
                                         uncertainty =       0.012726984459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383082757
  error estimate for blocks of size 2^( 2) =       0.000396197411
  error estimate for blocks of size 2^( 3) =       0.000408483361
  error estimate for blocks of size 2^( 4) =       0.000417246710
  error estimate for blocks of size 2^( 5) =       0.000423566285
  error estimate for blocks of size 2^( 6) =       0.000425638786
  error estimate for blocks of size 2^( 7) =       0.000427448075

      target function =      -0.921434923540
              le_mean =     -17.212028984768
             les_mean =     296.547446422611
             stat err =       0.000423474964
             autocorr =       1.221997371413
   target nu stat err =       0.000423474964
   target dn stat err =       0.012899771951
      target stat err =       0.021204137534
              std dev =       0.541760829945
             le_variance =       0.293504796863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293599377966
                                         uncertainty =       0.012726984459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293599377966
                                         uncertainty =       0.012726984459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383082757
  error estimate for blocks of size 2^( 2) =       0.000396197411
  error estimate for blocks of size 2^( 3) =       0.000408483361
  error estimate for blocks of size 2^( 4) =       0.000417246710
  error estimate for blocks of size 2^( 5) =       0.000423566285
  error estimate for blocks of size 2^( 6) =       0.000425638786
  error estimate for blocks of size 2^( 7) =       0.000427448075

      target function =      -0.921434923540
              le_mean =     -17.212028984768
             les_mean =     296.547446422611
             stat err =       0.000423474964
             autocorr =       1.221997371413
   target nu stat err =       0.000423474964
   target dn stat err =       0.012899771951
      target stat err =       0.021204137534
              std dev =       0.541760829945
             le_variance =       0.293504796863


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.921434923540        initial  <--
     9.5367e+22     9.5367e+23             0.0000e+00        -0.921434923540
     3.8147e+23     3.8147e+24             0.0000e+00        -0.921434923540
     1.5259e+24     1.5259e+25             0.0000e+00        -0.921434923540

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.8443
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0178e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1054
    reference variance = 0.223482
====================================================
  Execution time = 3.7165e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8293e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0027e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283001462211
                                         uncertainty =       0.003433521302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283001462211
                                         uncertainty =       0.003433521302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376121364
  error estimate for blocks of size 2^( 2) =       0.000389797453
  error estimate for blocks of size 2^( 3) =       0.000401976980
  error estimate for blocks of size 2^( 4) =       0.000411546485
  error estimate for blocks of size 2^( 5) =       0.000416332248
  error estimate for blocks of size 2^( 6) =       0.000418712604
  error estimate for blocks of size 2^( 7) =       0.000421023057

      target function =      -0.939576617815
              le_mean =     -17.212158057173
             les_mean =     296.541319404182
             stat err =       0.000416903599
             autocorr =       1.228613501113
   target nu stat err =       0.000416903599
   target dn stat err =       0.003686842314
      target stat err =       0.006341257382
              std dev =       0.531915933727
             le_variance =       0.282934560552


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721215805717e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+23, overlap shift 9.5367e+24 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939617976198       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939617976198       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939617976198       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939617976198       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939619064331       residual = 3.02e+05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939617965633       residual = 7.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939617976546       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+23 is 4.022644e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+24, overlap shift 3.8147e+25 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939617976198       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939617976198       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939617976198       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939617976198       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939617976197       residual = 6.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939617976198       residual = 7.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.967375387229       residual = 2.09e+07           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+24 is 6.529168e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+25, overlap shift 1.5259e+26 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939617976198       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939617976198       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939617976198       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939617976198       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939617976198       residual = 6.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939617874740       residual = 7.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939617976478       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+25 is 2.514080e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.926530 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7201e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.3222
    reference variance = 0.319163
====================================================
  Execution time = 3.6776e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8216e-01
  Total weights = 2.0000e+06
  Execution time = 3.3591e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282173167181
                                         uncertainty =       0.003437362155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282173167181
                                         uncertainty =       0.003437362155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375607540
  error estimate for blocks of size 2^( 2) =       0.000389037824
  error estimate for blocks of size 2^( 3) =       0.000401440446
  error estimate for blocks of size 2^( 4) =       0.000410632979
  error estimate for blocks of size 2^( 5) =       0.000415707451
  error estimate for blocks of size 2^( 6) =       0.000418675597
  error estimate for blocks of size 2^( 7) =       0.000420749447

      target function =      -0.940889469405
              le_mean =     -17.212205556561
             les_mean =     296.542182027794
             stat err =       0.000416441369
             autocorr =       1.229246916710
   target nu stat err =       0.000416441369
   target dn stat err =       0.003893834526
      target stat err =       0.006711486266
              std dev =       0.531189276594
             le_variance =       0.282162047569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282173167181
                                         uncertainty =       0.003437362155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282173167181
                                         uncertainty =       0.003437362155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375607540
  error estimate for blocks of size 2^( 2) =       0.000389037824
  error estimate for blocks of size 2^( 3) =       0.000401440446
  error estimate for blocks of size 2^( 4) =       0.000410632979
  error estimate for blocks of size 2^( 5) =       0.000415707451
  error estimate for blocks of size 2^( 6) =       0.000418675597
  error estimate for blocks of size 2^( 7) =       0.000420749447

      target function =      -0.940889469405
              le_mean =     -17.212205556561
             les_mean =     296.542182027794
             stat err =       0.000416441369
             autocorr =       1.229246916710
   target nu stat err =       0.000416441369
   target dn stat err =       0.003893834526
      target stat err =       0.006711486266
              std dev =       0.531189276594
             le_variance =       0.282162047569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282173167181
                                         uncertainty =       0.003437362155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282173167181
                                         uncertainty =       0.003437362155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375607540
  error estimate for blocks of size 2^( 2) =       0.000389037824
  error estimate for blocks of size 2^( 3) =       0.000401440446
  error estimate for blocks of size 2^( 4) =       0.000410632979
  error estimate for blocks of size 2^( 5) =       0.000415707451
  error estimate for blocks of size 2^( 6) =       0.000418675597
  error estimate for blocks of size 2^( 7) =       0.000420749447

      target function =      -0.940889469405
              le_mean =     -17.212205556561
             les_mean =     296.542182027794
             stat err =       0.000416441369
             autocorr =       1.229246916710
   target nu stat err =       0.000416441369
   target dn stat err =       0.003893834526
      target stat err =       0.006711486266
              std dev =       0.531189276594
             le_variance =       0.282162047569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282173167181
                                         uncertainty =       0.003437362155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282173167181
                                         uncertainty =       0.003437362155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375607540
  error estimate for blocks of size 2^( 2) =       0.000389037824
  error estimate for blocks of size 2^( 3) =       0.000401440446
  error estimate for blocks of size 2^( 4) =       0.000410632979
  error estimate for blocks of size 2^( 5) =       0.000415707451
  error estimate for blocks of size 2^( 6) =       0.000418675597
  error estimate for blocks of size 2^( 7) =       0.000420749447

      target function =      -0.940889469405
              le_mean =     -17.212205556561
             les_mean =     296.542182027794
             stat err =       0.000416441369
             autocorr =       1.229246916710
   target nu stat err =       0.000416441369
   target dn stat err =       0.003893834526
      target stat err =       0.006711486266
              std dev =       0.531189276594
             le_variance =       0.282162047569


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940889469405        initial  <--
     9.5367e+23     9.5367e+24             4.0226e-28        -0.940889469405
     3.8147e+24     3.8147e+25             6.5292e-29        -0.940889469405
     1.5259e+25     1.5259e+26             2.5141e-29        -0.940889469405

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7976
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0100e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2058
    reference variance = 0.166636
====================================================
  Execution time = 3.7328e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8365e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0204e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283693566594
                                         uncertainty =       0.004486392115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283693566594
                                         uncertainty =       0.004486392115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376595482
  error estimate for blocks of size 2^( 2) =       0.000390256994
  error estimate for blocks of size 2^( 3) =       0.000402071978
  error estimate for blocks of size 2^( 4) =       0.000410699590
  error estimate for blocks of size 2^( 5) =       0.000416608488
  error estimate for blocks of size 2^( 6) =       0.000418569821
  error estimate for blocks of size 2^( 7) =       0.000421329698

      target function =      -0.938330194357
              le_mean =     -17.212344818366
             les_mean =     296.548462318738
             stat err =       0.000416801900
             autocorr =       1.224924068107
   target nu stat err =       0.000416801900
   target dn stat err =       0.004452375172
      target stat err =       0.007623479546
              std dev =       0.532586438278
             le_variance =       0.283648314238


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721234481837e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+24, overlap shift 9.5367e+25 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938390529004       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938390529004       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+25, overlap shift 3.8147e+26 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938390529004       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938390529004       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+26, overlap shift 1.5259e+27 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938390529004       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938390529004       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.927613 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7540e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1789
    reference variance = 0.235799
====================================================
  Execution time = 3.7213e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7836e-01
  Total weights = 2.0000e+06
  Execution time = 3.3827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278361641366
                                         uncertainty =       0.002823760861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278361641366
                                         uncertainty =       0.002823760861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373065963
  error estimate for blocks of size 2^( 2) =       0.000386926520
  error estimate for blocks of size 2^( 3) =       0.000399766037
  error estimate for blocks of size 2^( 4) =       0.000409567077
  error estimate for blocks of size 2^( 5) =       0.000416618231
  error estimate for blocks of size 2^( 6) =       0.000419292349
  error estimate for blocks of size 2^( 7) =       0.000423115832

      target function =      -0.947479204808
              le_mean =     -17.212155790479
             les_mean =     296.536663242740
             stat err =       0.000417148372
             autocorr =       1.250287386782
   target nu stat err =       0.000417148372
   target dn stat err =       0.002701382402
      target stat err =       0.004752709349
              std dev =       0.527594945211
             le_variance =       0.278356426212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278361641366
                                         uncertainty =       0.002823760861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278361641366
                                         uncertainty =       0.002823760861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373065963
  error estimate for blocks of size 2^( 2) =       0.000386926520
  error estimate for blocks of size 2^( 3) =       0.000399766037
  error estimate for blocks of size 2^( 4) =       0.000409567077
  error estimate for blocks of size 2^( 5) =       0.000416618231
  error estimate for blocks of size 2^( 6) =       0.000419292349
  error estimate for blocks of size 2^( 7) =       0.000423115832

      target function =      -0.947479204808
              le_mean =     -17.212155790479
             les_mean =     296.536663242740
             stat err =       0.000417148372
             autocorr =       1.250287386782
   target nu stat err =       0.000417148372
   target dn stat err =       0.002701382402
      target stat err =       0.004752709349
              std dev =       0.527594945211
             le_variance =       0.278356426212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278361641366
                                         uncertainty =       0.002823760861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278361641366
                                         uncertainty =       0.002823760861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373065963
  error estimate for blocks of size 2^( 2) =       0.000386926520
  error estimate for blocks of size 2^( 3) =       0.000399766037
  error estimate for blocks of size 2^( 4) =       0.000409567077
  error estimate for blocks of size 2^( 5) =       0.000416618231
  error estimate for blocks of size 2^( 6) =       0.000419292349
  error estimate for blocks of size 2^( 7) =       0.000423115832

      target function =      -0.947479204808
              le_mean =     -17.212155790479
             les_mean =     296.536663242740
             stat err =       0.000417148372
             autocorr =       1.250287386782
   target nu stat err =       0.000417148372
   target dn stat err =       0.002701382402
      target stat err =       0.004752709349
              std dev =       0.527594945211
             le_variance =       0.278356426212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278361641366
                                         uncertainty =       0.002823760861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278361641366
                                         uncertainty =       0.002823760861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373065963
  error estimate for blocks of size 2^( 2) =       0.000386926520
  error estimate for blocks of size 2^( 3) =       0.000399766037
  error estimate for blocks of size 2^( 4) =       0.000409567077
  error estimate for blocks of size 2^( 5) =       0.000416618231
  error estimate for blocks of size 2^( 6) =       0.000419292349
  error estimate for blocks of size 2^( 7) =       0.000423115832

      target function =      -0.947479204808
              le_mean =     -17.212155790479
             les_mean =     296.536663242740
             stat err =       0.000417148372
             autocorr =       1.250287386782
   target nu stat err =       0.000417148372
   target dn stat err =       0.002701382402
      target stat err =       0.004752709349
              std dev =       0.527594945211
             le_variance =       0.278356426212


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947479204808        initial  <--
     9.5367e+24     9.5367e+25             0.0000e+00        -0.947479204808
     3.8147e+25     3.8147e+26             0.0000e+00        -0.947479204808
     1.5259e+26     1.5259e+27             0.0000e+00        -0.947479204808

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.2755
  </log>
  <optVariables href="H2O.s040.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0182e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1083
    reference variance = 0.20091
====================================================
  Execution time = 3.7518e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8078e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0065e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280769003699
                                         uncertainty =       0.004366808450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280769003699
                                         uncertainty =       0.004366808450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374684463
  error estimate for blocks of size 2^( 2) =       0.000388047056
  error estimate for blocks of size 2^( 3) =       0.000400156310
  error estimate for blocks of size 2^( 4) =       0.000409726037
  error estimate for blocks of size 2^( 5) =       0.000415157606
  error estimate for blocks of size 2^( 6) =       0.000419121742
  error estimate for blocks of size 2^( 7) =       0.000419810854

      target function =      -0.943299300043
              le_mean =     -17.211506431348
             les_mean =     296.516730389610
             stat err =       0.000415954060
             autocorr =       1.232421783124
   target nu stat err =       0.000415954060
   target dn stat err =       0.003856925456
      target stat err =       0.006673430704
              std dev =       0.529883849230
             le_variance =       0.280776893675


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721150643135e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+25, overlap shift 9.5367e+26 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943345688257       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943345688257       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943345688257       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943345688254       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+25 is 1.715544e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+26, overlap shift 3.8147e+27 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943345688257       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943345688257       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943345688257       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943345688254       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+26 is 4.288859e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+27, overlap shift 1.5259e+28 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943345688257       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943345688257       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943345688257       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943345688283       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+27 is 1.072215e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.929204 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7592e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2158
    reference variance = 0.284294
====================================================
  Execution time = 3.7170e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9772e-01
  Total weights = 2.0000e+06
  Execution time = 3.3656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297600857456
                                         uncertainty =       0.013653986083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297600857456
                                         uncertainty =       0.013653986083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385820867
  error estimate for blocks of size 2^( 2) =       0.000399159941
  error estimate for blocks of size 2^( 3) =       0.000411283536
  error estimate for blocks of size 2^( 4) =       0.000420800584
  error estimate for blocks of size 2^( 5) =       0.000426152193
  error estimate for blocks of size 2^( 6) =       0.000428116022
  error estimate for blocks of size 2^( 7) =       0.000432285130

      target function =      -0.914521553590
              le_mean =     -17.211893079829
             les_mean =     296.546978725780
             stat err =       0.000426838482
             autocorr =       1.223927543104
   target nu stat err =       0.000426838482
   target dn stat err =       0.013783405419
      target stat err =       0.022312169527
              std dev =       0.545633103089
             le_variance =       0.297715483187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297600857456
                                         uncertainty =       0.013653986083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297600857456
                                         uncertainty =       0.013653986083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385820867
  error estimate for blocks of size 2^( 2) =       0.000399159941
  error estimate for blocks of size 2^( 3) =       0.000411283536
  error estimate for blocks of size 2^( 4) =       0.000420800584
  error estimate for blocks of size 2^( 5) =       0.000426152193
  error estimate for blocks of size 2^( 6) =       0.000428116022
  error estimate for blocks of size 2^( 7) =       0.000432285130

      target function =      -0.914521553590
              le_mean =     -17.211893079829
             les_mean =     296.546978725780
             stat err =       0.000426838482
             autocorr =       1.223927543104
   target nu stat err =       0.000426838482
   target dn stat err =       0.013783405419
      target stat err =       0.022312169527
              std dev =       0.545633103089
             le_variance =       0.297715483187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297600857456
                                         uncertainty =       0.013653986083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297600857456
                                         uncertainty =       0.013653986083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385820867
  error estimate for blocks of size 2^( 2) =       0.000399159941
  error estimate for blocks of size 2^( 3) =       0.000411283536
  error estimate for blocks of size 2^( 4) =       0.000420800584
  error estimate for blocks of size 2^( 5) =       0.000426152193
  error estimate for blocks of size 2^( 6) =       0.000428116022
  error estimate for blocks of size 2^( 7) =       0.000432285130

      target function =      -0.914521553590
              le_mean =     -17.211893079829
             les_mean =     296.546978725780
             stat err =       0.000426838482
             autocorr =       1.223927543104
   target nu stat err =       0.000426838482
   target dn stat err =       0.013783405419
      target stat err =       0.022312169527
              std dev =       0.545633103089
             le_variance =       0.297715483187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297600857456
                                         uncertainty =       0.013653986083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297600857456
                                         uncertainty =       0.013653986083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385820867
  error estimate for blocks of size 2^( 2) =       0.000399159941
  error estimate for blocks of size 2^( 3) =       0.000411283536
  error estimate for blocks of size 2^( 4) =       0.000420800584
  error estimate for blocks of size 2^( 5) =       0.000426152193
  error estimate for blocks of size 2^( 6) =       0.000428116022
  error estimate for blocks of size 2^( 7) =       0.000432285130

      target function =      -0.914521553590
              le_mean =     -17.211893079829
             les_mean =     296.546978725780
             stat err =       0.000426838482
             autocorr =       1.223927543104
   target nu stat err =       0.000426838482
   target dn stat err =       0.013783405419
      target stat err =       0.022312169527
              std dev =       0.545633103089
             le_variance =       0.297715483187


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914521553590        initial  <--
     9.5367e+25     9.5367e+26             1.7155e-30        -0.914521553590
     3.8147e+26     3.8147e+27             4.2889e-31        -0.914521553590
     1.5259e+27     1.5259e+28             1.0722e-31        -0.914521553590

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1552
  </log>
  <optVariables href="H2O.s041.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0176e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2269
    reference variance = 0.257389
====================================================
  Execution time = 3.7716e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8860e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0212e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288615956833
                                         uncertainty =       0.006069655240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288615956833
                                         uncertainty =       0.006069655240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379866361
  error estimate for blocks of size 2^( 2) =       0.000393382162
  error estimate for blocks of size 2^( 3) =       0.000405700179
  error estimate for blocks of size 2^( 4) =       0.000414750054
  error estimate for blocks of size 2^( 5) =       0.000419807274
  error estimate for blocks of size 2^( 6) =       0.000420979674
  error estimate for blocks of size 2^( 7) =       0.000422645617

      target function =      -0.929931177079
              le_mean =     -17.212272142004
             les_mean =     296.550909050999
             stat err =       0.000419545655
             autocorr =       1.219822898769
   target nu stat err =       0.000419545655
   target dn stat err =       0.006017851389
      target stat err =       0.010097663492
              std dev =       0.537212160044
             le_variance =       0.288596904899


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721227214200e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+26, overlap shift 9.5367e+27 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930038868441       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930038868441       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+27, overlap shift 3.8147e+28 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930038868441       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930038868441       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+28, overlap shift 1.5259e+29 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930038868441       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930038868441       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.930304 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7937e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2193
    reference variance = 0.36406
====================================================
  Execution time = 3.7213e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8141e-01
  Total weights = 2.0000e+06
  Execution time = 3.3702e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281422139558
                                         uncertainty =       0.002458740654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281422139558
                                         uncertainty =       0.002458740654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375107742
  error estimate for blocks of size 2^( 2) =       0.000388624025
  error estimate for blocks of size 2^( 3) =       0.000400984909
  error estimate for blocks of size 2^( 4) =       0.000409866026
  error estimate for blocks of size 2^( 5) =       0.000415183316
  error estimate for blocks of size 2^( 6) =       0.000417819655
  error estimate for blocks of size 2^( 7) =       0.000419871294

      target function =      -0.942175878353
              le_mean =     -17.212726678713
             les_mean =     296.559371211036
             stat err =       0.000415685073
             autocorr =       1.228052132064
   target nu stat err =       0.000415685073
   target dn stat err =       0.002729782067
      target stat err =       0.004753292459
              std dev =       0.530482455558
             le_variance =       0.281411635655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281422139558
                                         uncertainty =       0.002458740654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281422139558
                                         uncertainty =       0.002458740654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375107742
  error estimate for blocks of size 2^( 2) =       0.000388624025
  error estimate for blocks of size 2^( 3) =       0.000400984909
  error estimate for blocks of size 2^( 4) =       0.000409866026
  error estimate for blocks of size 2^( 5) =       0.000415183316
  error estimate for blocks of size 2^( 6) =       0.000417819655
  error estimate for blocks of size 2^( 7) =       0.000419871294

      target function =      -0.942175878353
              le_mean =     -17.212726678713
             les_mean =     296.559371211036
             stat err =       0.000415685073
             autocorr =       1.228052132067
   target nu stat err =       0.000415685073
   target dn stat err =       0.002729782067
      target stat err =       0.004753292459
              std dev =       0.530482455558
             le_variance =       0.281411635655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281422139558
                                         uncertainty =       0.002458740654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281422139558
                                         uncertainty =       0.002458740654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375107742
  error estimate for blocks of size 2^( 2) =       0.000388624025
  error estimate for blocks of size 2^( 3) =       0.000400984909
  error estimate for blocks of size 2^( 4) =       0.000409866026
  error estimate for blocks of size 2^( 5) =       0.000415183316
  error estimate for blocks of size 2^( 6) =       0.000417819655
  error estimate for blocks of size 2^( 7) =       0.000419871294

      target function =      -0.942175878353
              le_mean =     -17.212726678713
             les_mean =     296.559371211036
             stat err =       0.000415685073
             autocorr =       1.228052132067
   target nu stat err =       0.000415685073
   target dn stat err =       0.002729782067
      target stat err =       0.004753292459
              std dev =       0.530482455558
             le_variance =       0.281411635655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281422139558
                                         uncertainty =       0.002458740654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281422139558
                                         uncertainty =       0.002458740654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375107742
  error estimate for blocks of size 2^( 2) =       0.000388624025
  error estimate for blocks of size 2^( 3) =       0.000400984909
  error estimate for blocks of size 2^( 4) =       0.000409866026
  error estimate for blocks of size 2^( 5) =       0.000415183316
  error estimate for blocks of size 2^( 6) =       0.000417819655
  error estimate for blocks of size 2^( 7) =       0.000419871294

      target function =      -0.942175878353
              le_mean =     -17.212726678713
             les_mean =     296.559371211036
             stat err =       0.000415685073
             autocorr =       1.228052132067
   target nu stat err =       0.000415685073
   target dn stat err =       0.002729782067
      target stat err =       0.004753292459
              std dev =       0.530482455558
             le_variance =       0.281411635655


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942175878353        initial  <--
     9.5367e+26     9.5367e+27             0.0000e+00        -0.942175878353
     3.8147e+27     3.8147e+28             0.0000e+00        -0.942175878353
     1.5259e+28     1.5259e+29             0.0000e+00        -0.942175878353

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.2530
  </log>
  <optVariables href="H2O.s042.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0219e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2584
    reference variance = 0.2098
====================================================
  Execution time = 3.7266e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7967e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0016e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279451994158
                                         uncertainty =       0.002364630907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279451994158
                                         uncertainty =       0.002364630907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373947653
  error estimate for blocks of size 2^( 2) =       0.000387384143
  error estimate for blocks of size 2^( 3) =       0.000399531071
  error estimate for blocks of size 2^( 4) =       0.000407954040
  error estimate for blocks of size 2^( 5) =       0.000412414364
  error estimate for blocks of size 2^( 6) =       0.000414460642
  error estimate for blocks of size 2^( 7) =       0.000416833056

      target function =      -0.945210869527
              le_mean =     -17.211920573612
             les_mean =     296.529883386667
             stat err =       0.000412915525
             autocorr =       1.219272563863
   target nu stat err =       0.000412915525
   target dn stat err =       0.002470918557
      target stat err =       0.004334341236
              std dev =       0.528841842315
             le_variance =       0.279673694183


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721192057361e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+27, overlap shift 9.5367e+28 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945229565553       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945229565553       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+28, overlap shift 3.8147e+29 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945229565553       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945229565553       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+29, overlap shift 1.5259e+30 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945229565553       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945229565553       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.931395 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7290e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2344
    reference variance = 0.264423
====================================================
  Execution time = 3.6690e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8518e-01
  Total weights = 2.0000e+06
  Execution time = 3.3884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285160133463
                                         uncertainty =       0.004660111971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285160133463
                                         uncertainty =       0.004660111971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377611618
  error estimate for blocks of size 2^( 2) =       0.000391296011
  error estimate for blocks of size 2^( 3) =       0.000403519270
  error estimate for blocks of size 2^( 4) =       0.000412920859
  error estimate for blocks of size 2^( 5) =       0.000418003912
  error estimate for blocks of size 2^( 6) =       0.000419668865
  error estimate for blocks of size 2^( 7) =       0.000420147890

      target function =      -0.935701073541
              le_mean =     -17.212695315633
             les_mean =     296.562060953790
             stat err =       0.000417685382
             autocorr =       1.223510939367
   target nu stat err =       0.000417685382
   target dn stat err =       0.004579763493
      target stat err =       0.007801290488
              std dev =       0.534023470978
             le_variance =       0.285181067555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285160133463
                                         uncertainty =       0.004660111971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285160133463
                                         uncertainty =       0.004660111971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377611618
  error estimate for blocks of size 2^( 2) =       0.000391296011
  error estimate for blocks of size 2^( 3) =       0.000403519270
  error estimate for blocks of size 2^( 4) =       0.000412920859
  error estimate for blocks of size 2^( 5) =       0.000418003912
  error estimate for blocks of size 2^( 6) =       0.000419668865
  error estimate for blocks of size 2^( 7) =       0.000420147890

      target function =      -0.935701073541
              le_mean =     -17.212695315633
             les_mean =     296.562060953790
             stat err =       0.000417685382
             autocorr =       1.223510939367
   target nu stat err =       0.000417685382
   target dn stat err =       0.004579763493
      target stat err =       0.007801290488
              std dev =       0.534023470978
             le_variance =       0.285181067555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285160133463
                                         uncertainty =       0.004660111971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285160133463
                                         uncertainty =       0.004660111971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377611618
  error estimate for blocks of size 2^( 2) =       0.000391296011
  error estimate for blocks of size 2^( 3) =       0.000403519270
  error estimate for blocks of size 2^( 4) =       0.000412920859
  error estimate for blocks of size 2^( 5) =       0.000418003912
  error estimate for blocks of size 2^( 6) =       0.000419668865
  error estimate for blocks of size 2^( 7) =       0.000420147890

      target function =      -0.935701073541
              le_mean =     -17.212695315633
             les_mean =     296.562060953790
             stat err =       0.000417685382
             autocorr =       1.223510939367
   target nu stat err =       0.000417685382
   target dn stat err =       0.004579763493
      target stat err =       0.007801290488
              std dev =       0.534023470978
             le_variance =       0.285181067555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285160133463
                                         uncertainty =       0.004660111971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285160133463
                                         uncertainty =       0.004660111971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377611618
  error estimate for blocks of size 2^( 2) =       0.000391296011
  error estimate for blocks of size 2^( 3) =       0.000403519270
  error estimate for blocks of size 2^( 4) =       0.000412920859
  error estimate for blocks of size 2^( 5) =       0.000418003912
  error estimate for blocks of size 2^( 6) =       0.000419668865
  error estimate for blocks of size 2^( 7) =       0.000420147890

      target function =      -0.935701073541
              le_mean =     -17.212695315633
             les_mean =     296.562060953790
             stat err =       0.000417685382
             autocorr =       1.223510939367
   target nu stat err =       0.000417685382
   target dn stat err =       0.004579763493
      target stat err =       0.007801290488
              std dev =       0.534023470978
             le_variance =       0.285181067555


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935701073541        initial  <--
     9.5367e+27     9.5367e+28             0.0000e+00        -0.935701073541
     3.8147e+28     3.8147e+29             0.0000e+00        -0.935701073541
     1.5259e+29     1.5259e+30             0.0000e+00        -0.935701073541

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7818
  </log>
  <optVariables href="H2O.s043.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0108e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1726
    reference variance = 0.60795
====================================================
  Execution time = 3.7586e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8444e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0072e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284441824301
                                         uncertainty =       0.003564209103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284441824301
                                         uncertainty =       0.003564209103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377122474
  error estimate for blocks of size 2^( 2) =       0.000390471651
  error estimate for blocks of size 2^( 3) =       0.000402589075
  error estimate for blocks of size 2^( 4) =       0.000411380285
  error estimate for blocks of size 2^( 5) =       0.000417260180
  error estimate for blocks of size 2^( 6) =       0.000420022056
  error estimate for blocks of size 2^( 7) =       0.000423103044

      target function =      -0.936959505237
              le_mean =     -17.213077295596
             les_mean =     296.574472562670
             stat err =       0.000417941391
             autocorr =       1.228191082727
   target nu stat err =       0.000417941391
   target dn stat err =       0.003461848949
      target stat err =       0.005937858384
              std dev =       0.533331717334
             le_variance =       0.284442720714


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721307729560e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+28, overlap shift 9.5367e+29 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936996149113       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936996149113       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+29, overlap shift 3.8147e+30 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936996149113       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936996149113       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+30, overlap shift 1.5259e+31 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936996149113       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936996149113       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.932511 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7666e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2317
    reference variance = 0.191737
====================================================
  Execution time = 3.6944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8163e-01
  Total weights = 2.0000e+06
  Execution time = 3.3589e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281526658683
                                         uncertainty =       0.002754849194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281526658683
                                         uncertainty =       0.002754849194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375251906
  error estimate for blocks of size 2^( 2) =       0.000388847389
  error estimate for blocks of size 2^( 3) =       0.000401429257
  error estimate for blocks of size 2^( 4) =       0.000410308073
  error estimate for blocks of size 2^( 5) =       0.000415339708
  error estimate for blocks of size 2^( 6) =       0.000418835600
  error estimate for blocks of size 2^( 7) =       0.000421380089

      target function =      -0.941832632362
              le_mean =     -17.212173528386
             les_mean =     296.540545416151
             stat err =       0.000416465868
             autocorr =       1.231722894963
   target nu stat err =       0.000416465868
   target dn stat err =       0.002632518395
      target stat err =       0.004580343987
              std dev =       0.530686334574
             le_variance =       0.281627985704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281526658683
                                         uncertainty =       0.002754849194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281526658683
                                         uncertainty =       0.002754849194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375251906
  error estimate for blocks of size 2^( 2) =       0.000388847389
  error estimate for blocks of size 2^( 3) =       0.000401429257
  error estimate for blocks of size 2^( 4) =       0.000410308073
  error estimate for blocks of size 2^( 5) =       0.000415339708
  error estimate for blocks of size 2^( 6) =       0.000418835600
  error estimate for blocks of size 2^( 7) =       0.000421380089

      target function =      -0.941832632362
              le_mean =     -17.212173528386
             les_mean =     296.540545416151
             stat err =       0.000416465868
             autocorr =       1.231722894963
   target nu stat err =       0.000416465868
   target dn stat err =       0.002632518395
      target stat err =       0.004580343987
              std dev =       0.530686334574
             le_variance =       0.281627985704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281526658683
                                         uncertainty =       0.002754849194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281526658683
                                         uncertainty =       0.002754849194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375251906
  error estimate for blocks of size 2^( 2) =       0.000388847389
  error estimate for blocks of size 2^( 3) =       0.000401429257
  error estimate for blocks of size 2^( 4) =       0.000410308073
  error estimate for blocks of size 2^( 5) =       0.000415339708
  error estimate for blocks of size 2^( 6) =       0.000418835600
  error estimate for blocks of size 2^( 7) =       0.000421380089

      target function =      -0.941832632362
              le_mean =     -17.212173528386
             les_mean =     296.540545416151
             stat err =       0.000416465868
             autocorr =       1.231722894963
   target nu stat err =       0.000416465868
   target dn stat err =       0.002632518395
      target stat err =       0.004580343987
              std dev =       0.530686334574
             le_variance =       0.281627985704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281526658683
                                         uncertainty =       0.002754849194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281526658683
                                         uncertainty =       0.002754849194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375251906
  error estimate for blocks of size 2^( 2) =       0.000388847389
  error estimate for blocks of size 2^( 3) =       0.000401429257
  error estimate for blocks of size 2^( 4) =       0.000410308073
  error estimate for blocks of size 2^( 5) =       0.000415339708
  error estimate for blocks of size 2^( 6) =       0.000418835600
  error estimate for blocks of size 2^( 7) =       0.000421380089

      target function =      -0.941832632362
              le_mean =     -17.212173528386
             les_mean =     296.540545416151
             stat err =       0.000416465868
             autocorr =       1.231722894963
   target nu stat err =       0.000416465868
   target dn stat err =       0.002632518395
      target stat err =       0.004580343987
              std dev =       0.530686334574
             le_variance =       0.281627985704


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941832632362        initial  <--
     9.5367e+28     9.5367e+29             0.0000e+00        -0.941832632362
     3.8147e+29     3.8147e+30             0.0000e+00        -0.941832632362
     1.5259e+30     1.5259e+31             0.0000e+00        -0.941832632362

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9390
  </log>
  <optVariables href="H2O.s044.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0161e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2225
    reference variance = 0.172677
====================================================
  Execution time = 3.7376e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8801e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287589126202
                                         uncertainty =       0.005738154145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287589126202
                                         uncertainty =       0.005738154145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379477859
  error estimate for blocks of size 2^( 2) =       0.000392932929
  error estimate for blocks of size 2^( 3) =       0.000405607461
  error estimate for blocks of size 2^( 4) =       0.000413882153
  error estimate for blocks of size 2^( 5) =       0.000419889547
  error estimate for blocks of size 2^( 6) =       0.000422991232
  error estimate for blocks of size 2^( 7) =       0.000425915982

      target function =      -0.930952652146
              le_mean =     -17.211802434874
             les_mean =     296.534149803952
             stat err =       0.000420669729
             autocorr =       1.228880463037
   target nu stat err =       0.000420669729
   target dn stat err =       0.005898261510
      target stat err =       0.009910952470
              std dev =       0.536662734689
             le_variance =       0.288006890804


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721180243487e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+29, overlap shift 9.5367e+30 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931058642386       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931058642386       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+30, overlap shift 3.8147e+31 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931058642386       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931058642386       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+31, overlap shift 1.5259e+32 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931058642386       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931058642386       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.933627 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7369e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2037
    reference variance = 0.209588
====================================================
  Execution time = 3.7060e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8948e-01
  Total weights = 2.0000e+06
  Execution time = 3.3705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289496249640
                                         uncertainty =       0.009249042114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289496249640
                                         uncertainty =       0.009249042114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380450383
  error estimate for blocks of size 2^( 2) =       0.000393761621
  error estimate for blocks of size 2^( 3) =       0.000405853120
  error estimate for blocks of size 2^( 4) =       0.000414309875
  error estimate for blocks of size 2^( 5) =       0.000419322151
  error estimate for blocks of size 2^( 6) =       0.000422770365
  error estimate for blocks of size 2^( 7) =       0.000424700875

      target function =      -0.928297478130
              le_mean =     -17.212146760792
             les_mean =     296.547480957838
             stat err =       0.000420275816
             autocorr =       1.220317249886
   target nu stat err =       0.000420275816
   target dn stat err =       0.009410714105
      target stat err =       0.015708284460
              std dev =       0.538038091145
             le_variance =       0.289484987523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289496249640
                                         uncertainty =       0.009249042114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289496249640
                                         uncertainty =       0.009249042114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380450383
  error estimate for blocks of size 2^( 2) =       0.000393761621
  error estimate for blocks of size 2^( 3) =       0.000405853120
  error estimate for blocks of size 2^( 4) =       0.000414309875
  error estimate for blocks of size 2^( 5) =       0.000419322151
  error estimate for blocks of size 2^( 6) =       0.000422770365
  error estimate for blocks of size 2^( 7) =       0.000424700875

      target function =      -0.928297478130
              le_mean =     -17.212146760792
             les_mean =     296.547480957838
             stat err =       0.000420275816
             autocorr =       1.220317249886
   target nu stat err =       0.000420275816
   target dn stat err =       0.009410714105
      target stat err =       0.015708284460
              std dev =       0.538038091145
             le_variance =       0.289484987523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289496249640
                                         uncertainty =       0.009249042114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289496249640
                                         uncertainty =       0.009249042114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380450383
  error estimate for blocks of size 2^( 2) =       0.000393761621
  error estimate for blocks of size 2^( 3) =       0.000405853120
  error estimate for blocks of size 2^( 4) =       0.000414309875
  error estimate for blocks of size 2^( 5) =       0.000419322151
  error estimate for blocks of size 2^( 6) =       0.000422770365
  error estimate for blocks of size 2^( 7) =       0.000424700875

      target function =      -0.928297478130
              le_mean =     -17.212146760792
             les_mean =     296.547480957838
             stat err =       0.000420275816
             autocorr =       1.220317249886
   target nu stat err =       0.000420275816
   target dn stat err =       0.009410714105
      target stat err =       0.015708284460
              std dev =       0.538038091145
             le_variance =       0.289484987523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289496249640
                                         uncertainty =       0.009249042114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289496249640
                                         uncertainty =       0.009249042114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380450383
  error estimate for blocks of size 2^( 2) =       0.000393761621
  error estimate for blocks of size 2^( 3) =       0.000405853120
  error estimate for blocks of size 2^( 4) =       0.000414309875
  error estimate for blocks of size 2^( 5) =       0.000419322151
  error estimate for blocks of size 2^( 6) =       0.000422770365
  error estimate for blocks of size 2^( 7) =       0.000424700875

      target function =      -0.928297478130
              le_mean =     -17.212146760792
             les_mean =     296.547480957838
             stat err =       0.000420275816
             autocorr =       1.220317249886
   target nu stat err =       0.000420275816
   target dn stat err =       0.009410714105
      target stat err =       0.015708284460
              std dev =       0.538038091145
             le_variance =       0.289484987523


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.928297478130        initial  <--
     9.5367e+29     9.5367e+30             0.0000e+00        -0.928297478130
     3.8147e+30     3.8147e+31             0.0000e+00        -0.928297478130
     1.5259e+31     1.5259e+32             0.0000e+00        -0.928297478130

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1078
  </log>
  <optVariables href="H2O.s045.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0148e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1878
    reference variance = 0.320937
====================================================
  Execution time = 3.7205e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8799e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0049e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288023558864
                                         uncertainty =       0.005250376314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288023558864
                                         uncertainty =       0.005250376314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379468127
  error estimate for blocks of size 2^( 2) =       0.000392769501
  error estimate for blocks of size 2^( 3) =       0.000405097251
  error estimate for blocks of size 2^( 4) =       0.000414820693
  error estimate for blocks of size 2^( 5) =       0.000419728447
  error estimate for blocks of size 2^( 6) =       0.000422203207
  error estimate for blocks of size 2^( 7) =       0.000424466905

      target function =      -0.930911142558
              le_mean =     -17.213100768394
             les_mean =     296.578830038221
             stat err =       0.000420304813
             autocorr =       1.226812292071
   target nu stat err =       0.000420304813
   target dn stat err =       0.005259318215
      target stat err =       0.008865161478
              std dev =       0.536648972160
             le_variance =       0.287992119320


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721310076839e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+30, overlap shift 9.5367e+31 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930994812199       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930994812199       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930994812199       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930994812199       residual = 9.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930994812199       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930994811902       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+30 is 3.381387e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+31, overlap shift 3.8147e+32 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930994812199       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930994812199       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930994812199       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930994812199       residual = 9.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930994812199       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931030273438       residual = 3.78e+06           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+31 is 8.453467e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+32, overlap shift 1.5259e+33 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930994812199       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930994812199       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930994812199       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930994812199       residual = 9.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930994812199       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930994811902       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+32 is 2.113367e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.935931 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7263e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2839
    reference variance = 0.647569
====================================================
  Execution time = 3.6519e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8270e-01
  Total weights = 2.0000e+06
  Execution time = 3.3778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282745950963
                                         uncertainty =       0.003935377242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282745950963
                                         uncertainty =       0.003935377242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375966396
  error estimate for blocks of size 2^( 2) =       0.000389453367
  error estimate for blocks of size 2^( 3) =       0.000401591242
  error estimate for blocks of size 2^( 4) =       0.000410732250
  error estimate for blocks of size 2^( 5) =       0.000415616906
  error estimate for blocks of size 2^( 6) =       0.000418018472
  error estimate for blocks of size 2^( 7) =       0.000417996251

      target function =      -0.939987440295
              le_mean =     -17.211899976733
             les_mean =     296.532202129455
             stat err =       0.000415590970
             autocorr =       1.221895726849
   target nu stat err =       0.000415590970
   target dn stat err =       0.003666990275
      target stat err =       0.006309645542
              std dev =       0.531696776122
             le_variance =       0.282701461738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282745950963
                                         uncertainty =       0.003935377242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282745950963
                                         uncertainty =       0.003935377242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375966396
  error estimate for blocks of size 2^( 2) =       0.000389453367
  error estimate for blocks of size 2^( 3) =       0.000401591242
  error estimate for blocks of size 2^( 4) =       0.000410732250
  error estimate for blocks of size 2^( 5) =       0.000415616906
  error estimate for blocks of size 2^( 6) =       0.000418018472
  error estimate for blocks of size 2^( 7) =       0.000417996251

      target function =      -0.939987440295
              le_mean =     -17.211899976733
             les_mean =     296.532202129455
             stat err =       0.000415590970
             autocorr =       1.221895726849
   target nu stat err =       0.000415590970
   target dn stat err =       0.003666990275
      target stat err =       0.006309645542
              std dev =       0.531696776122
             le_variance =       0.282701461738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282745950963
                                         uncertainty =       0.003935377242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282745950963
                                         uncertainty =       0.003935377242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375966396
  error estimate for blocks of size 2^( 2) =       0.000389453367
  error estimate for blocks of size 2^( 3) =       0.000401591242
  error estimate for blocks of size 2^( 4) =       0.000410732250
  error estimate for blocks of size 2^( 5) =       0.000415616906
  error estimate for blocks of size 2^( 6) =       0.000418018472
  error estimate for blocks of size 2^( 7) =       0.000417996251

      target function =      -0.939987440295
              le_mean =     -17.211899976733
             les_mean =     296.532202129455
             stat err =       0.000415590970
             autocorr =       1.221895726849
   target nu stat err =       0.000415590970
   target dn stat err =       0.003666990275
      target stat err =       0.006309645542
              std dev =       0.531696776122
             le_variance =       0.282701461738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282745950963
                                         uncertainty =       0.003935377242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282745950963
                                         uncertainty =       0.003935377242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375966396
  error estimate for blocks of size 2^( 2) =       0.000389453367
  error estimate for blocks of size 2^( 3) =       0.000401591242
  error estimate for blocks of size 2^( 4) =       0.000410732250
  error estimate for blocks of size 2^( 5) =       0.000415616906
  error estimate for blocks of size 2^( 6) =       0.000418018472
  error estimate for blocks of size 2^( 7) =       0.000417996251

      target function =      -0.939987440295
              le_mean =     -17.211899976733
             les_mean =     296.532202129455
             stat err =       0.000415590970
             autocorr =       1.221895726849
   target nu stat err =       0.000415590970
   target dn stat err =       0.003666990275
      target stat err =       0.006309645542
              std dev =       0.531696776122
             le_variance =       0.282701461738


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939987440295        initial  <--
     9.5367e+30     9.5367e+31             3.3814e-35        -0.939987440295
     3.8147e+31     3.8147e+32             8.4535e-36        -0.939987440295
     1.5259e+32     1.5259e+33             2.1134e-36        -0.939987440295

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.5705
  </log>
  <optVariables href="H2O.s046.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0084e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1639
    reference variance = 0.186945
====================================================
  Execution time = 3.7768e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7847e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.9323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278530355051
                                         uncertainty =       0.002199685849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278530355051
                                         uncertainty =       0.002199685849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373142873
  error estimate for blocks of size 2^( 2) =       0.000386717394
  error estimate for blocks of size 2^( 3) =       0.000399065442
  error estimate for blocks of size 2^( 4) =       0.000407938565
  error estimate for blocks of size 2^( 5) =       0.000414036487
  error estimate for blocks of size 2^( 6) =       0.000417949282
  error estimate for blocks of size 2^( 7) =       0.000419486640

      target function =      -0.947276580153
              le_mean =     -17.212372815218
             les_mean =     296.544248997836
             stat err =       0.000414852744
             autocorr =       1.236054532597
   target nu stat err =       0.000414852744
   target dn stat err =       0.002403181878
      target stat err =       0.004241677458
              std dev =       0.527703711381
             le_variance =       0.278471207005


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721237281522e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+31, overlap shift 9.5367e+32 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947294331618       residual = 9.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947294331618       residual = 9.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+32, overlap shift 3.8147e+33 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947294331618       residual = 9.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947294331618       residual = 9.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+33, overlap shift 1.5259e+34 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947294331618       residual = 9.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947294331618       residual = 9.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.937048 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7708e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2102
    reference variance = 0.243763
====================================================
  Execution time = 3.6948e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7545e-01
  Total weights = 2.0000e+06
  Execution time = 3.3776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275400484372
                                         uncertainty =       0.001851798124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275400484372
                                         uncertainty =       0.001851798124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371110024
  error estimate for blocks of size 2^( 2) =       0.000384689044
  error estimate for blocks of size 2^( 3) =       0.000397439925
  error estimate for blocks of size 2^( 4) =       0.000405853663
  error estimate for blocks of size 2^( 5) =       0.000411012913
  error estimate for blocks of size 2^( 6) =       0.000413870494
  error estimate for blocks of size 2^( 7) =       0.000413021270

      target function =      -0.952587656826
              le_mean =     -17.211562804591
             les_mean =     296.513339339108
             stat err =       0.000410939585
             autocorr =       1.226169712794
   target nu stat err =       0.000410939585
   target dn stat err =       0.001989495114
      target stat err =       0.003569030451
              std dev =       0.524828829679
             le_variance =       0.275445300462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275400484372
                                         uncertainty =       0.001851798124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275400484372
                                         uncertainty =       0.001851798124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371110024
  error estimate for blocks of size 2^( 2) =       0.000384689044
  error estimate for blocks of size 2^( 3) =       0.000397439925
  error estimate for blocks of size 2^( 4) =       0.000405853663
  error estimate for blocks of size 2^( 5) =       0.000411012913
  error estimate for blocks of size 2^( 6) =       0.000413870494
  error estimate for blocks of size 2^( 7) =       0.000413021270

      target function =      -0.952587656826
              le_mean =     -17.211562804591
             les_mean =     296.513339339108
             stat err =       0.000410939585
             autocorr =       1.226169712794
   target nu stat err =       0.000410939585
   target dn stat err =       0.001989495114
      target stat err =       0.003569030451
              std dev =       0.524828829679
             le_variance =       0.275445300462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275400484372
                                         uncertainty =       0.001851798124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275400484372
                                         uncertainty =       0.001851798124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371110024
  error estimate for blocks of size 2^( 2) =       0.000384689044
  error estimate for blocks of size 2^( 3) =       0.000397439925
  error estimate for blocks of size 2^( 4) =       0.000405853663
  error estimate for blocks of size 2^( 5) =       0.000411012913
  error estimate for blocks of size 2^( 6) =       0.000413870494
  error estimate for blocks of size 2^( 7) =       0.000413021270

      target function =      -0.952587656826
              le_mean =     -17.211562804591
             les_mean =     296.513339339108
             stat err =       0.000410939585
             autocorr =       1.226169712794
   target nu stat err =       0.000410939585
   target dn stat err =       0.001989495114
      target stat err =       0.003569030451
              std dev =       0.524828829679
             le_variance =       0.275445300462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275400484372
                                         uncertainty =       0.001851798124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275400484372
                                         uncertainty =       0.001851798124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371110024
  error estimate for blocks of size 2^( 2) =       0.000384689044
  error estimate for blocks of size 2^( 3) =       0.000397439925
  error estimate for blocks of size 2^( 4) =       0.000405853663
  error estimate for blocks of size 2^( 5) =       0.000411012913
  error estimate for blocks of size 2^( 6) =       0.000413870494
  error estimate for blocks of size 2^( 7) =       0.000413021270

      target function =      -0.952587656826
              le_mean =     -17.211562804591
             les_mean =     296.513339339108
             stat err =       0.000410939585
             autocorr =       1.226169712794
   target nu stat err =       0.000410939585
   target dn stat err =       0.001989495114
      target stat err =       0.003569030451
              std dev =       0.524828829679
             le_variance =       0.275445300462


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.952587656826        initial  <--
     9.5367e+31     9.5367e+32             0.0000e+00        -0.952587656826
     3.8147e+32     3.8147e+33             0.0000e+00        -0.952587656826
     1.5259e+33     1.5259e+34             0.0000e+00        -0.952587656826

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0044
  </log>
  <optVariables href="H2O.s047.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0172e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2544
    reference variance = 0.232336
====================================================
  Execution time = 3.7003e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7977e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0162e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279846805604
                                         uncertainty =       0.002308512493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279846805604
                                         uncertainty =       0.002308512493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374011884
  error estimate for blocks of size 2^( 2) =       0.000387862361
  error estimate for blocks of size 2^( 3) =       0.000400185907
  error estimate for blocks of size 2^( 4) =       0.000409351320
  error estimate for blocks of size 2^( 5) =       0.000415258892
  error estimate for blocks of size 2^( 6) =       0.000417216224
  error estimate for blocks of size 2^( 7) =       0.000418670450

      target function =      -0.945044389732
              le_mean =     -17.212007141221
             les_mean =     296.532959468594
             stat err =       0.000415124222
             autocorr =       1.231928051442
   target nu stat err =       0.000415124222
   target dn stat err =       0.002260384057
      target stat err =       0.003976776769
              std dev =       0.528932679105
             le_variance =       0.279769779025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721200714122e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+32, overlap shift 9.5367e+33 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945060067444       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945060067444       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+33, overlap shift 3.8147e+34 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945060067444       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945060067444       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+34, overlap shift 1.5259e+35 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945060067444       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945060067444       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.938158 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7173e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.3154
    reference variance = 1.24987
====================================================
  Execution time = 3.6786e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8148e-01
  Total weights = 2.0000e+06
  Execution time = 3.3852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281452398446
                                         uncertainty =       0.003045521806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281452398446
                                         uncertainty =       0.003045521806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375156162
  error estimate for blocks of size 2^( 2) =       0.000388529200
  error estimate for blocks of size 2^( 3) =       0.000400707351
  error estimate for blocks of size 2^( 4) =       0.000409475597
  error estimate for blocks of size 2^( 5) =       0.000415293607
  error estimate for blocks of size 2^( 6) =       0.000419542633
  error estimate for blocks of size 2^( 7) =       0.000421444606

      target function =      -0.942087666292
              le_mean =     -17.211802089525
             les_mean =     296.527615320594
             stat err =       0.000416439111
             autocorr =       1.232193324351
   target nu stat err =       0.000416439111
   target dn stat err =       0.003131848892
      target stat err =       0.005426206923
              std dev =       0.530550932867
             le_variance =       0.281484292366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281452398446
                                         uncertainty =       0.003045521806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281452398446
                                         uncertainty =       0.003045521806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375156162
  error estimate for blocks of size 2^( 2) =       0.000388529200
  error estimate for blocks of size 2^( 3) =       0.000400707351
  error estimate for blocks of size 2^( 4) =       0.000409475597
  error estimate for blocks of size 2^( 5) =       0.000415293607
  error estimate for blocks of size 2^( 6) =       0.000419542633
  error estimate for blocks of size 2^( 7) =       0.000421444606

      target function =      -0.942087666292
              le_mean =     -17.211802089525
             les_mean =     296.527615320594
             stat err =       0.000416439111
             autocorr =       1.232193324351
   target nu stat err =       0.000416439111
   target dn stat err =       0.003131848892
      target stat err =       0.005426206923
              std dev =       0.530550932867
             le_variance =       0.281484292366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281452398446
                                         uncertainty =       0.003045521806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281452398446
                                         uncertainty =       0.003045521806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375156162
  error estimate for blocks of size 2^( 2) =       0.000388529200
  error estimate for blocks of size 2^( 3) =       0.000400707351
  error estimate for blocks of size 2^( 4) =       0.000409475597
  error estimate for blocks of size 2^( 5) =       0.000415293607
  error estimate for blocks of size 2^( 6) =       0.000419542633
  error estimate for blocks of size 2^( 7) =       0.000421444606

      target function =      -0.942087666292
              le_mean =     -17.211802089525
             les_mean =     296.527615320594
             stat err =       0.000416439111
             autocorr =       1.232193324351
   target nu stat err =       0.000416439111
   target dn stat err =       0.003131848892
      target stat err =       0.005426206923
              std dev =       0.530550932867
             le_variance =       0.281484292366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281452398446
                                         uncertainty =       0.003045521806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281452398446
                                         uncertainty =       0.003045521806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375156162
  error estimate for blocks of size 2^( 2) =       0.000388529200
  error estimate for blocks of size 2^( 3) =       0.000400707351
  error estimate for blocks of size 2^( 4) =       0.000409475597
  error estimate for blocks of size 2^( 5) =       0.000415293607
  error estimate for blocks of size 2^( 6) =       0.000419542633
  error estimate for blocks of size 2^( 7) =       0.000421444606

      target function =      -0.942087666292
              le_mean =     -17.211802089525
             les_mean =     296.527615320594
             stat err =       0.000416439111
             autocorr =       1.232193324351
   target nu stat err =       0.000416439111
   target dn stat err =       0.003131848892
      target stat err =       0.005426206923
              std dev =       0.530550932867
             le_variance =       0.281484292366


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942087666292        initial  <--
     9.5367e+32     9.5367e+33             0.0000e+00        -0.942087666292
     3.8147e+33     3.8147e+34             0.0000e+00        -0.942087666292
     1.5259e+34     1.5259e+35             0.0000e+00        -0.942087666292

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9562
  </log>
  <optVariables href="H2O.s048.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0113e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2327
    reference variance = 0.145919
====================================================
  Execution time = 3.7497e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7678e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0087e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276872584948
                                         uncertainty =       0.002218465546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276872584948
                                         uncertainty =       0.002218465546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372009319
  error estimate for blocks of size 2^( 2) =       0.000385668906
  error estimate for blocks of size 2^( 3) =       0.000398434085
  error estimate for blocks of size 2^( 4) =       0.000407249215
  error estimate for blocks of size 2^( 5) =       0.000412286015
  error estimate for blocks of size 2^( 6) =       0.000413762262
  error estimate for blocks of size 2^( 7) =       0.000415012396

      target function =      -0.950237020077
              le_mean =     -17.211910021607
             les_mean =     296.526628319678
             stat err =       0.000412077472
             autocorr =       1.227015666214
   target nu stat err =       0.000412077472
   target dn stat err =       0.002174325028
      target stat err =       0.003870541916
              std dev =       0.526100623610
             le_variance =       0.276781866163


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721191002161e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+33, overlap shift 9.5367e+34 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950251742462       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950251742462       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950251698494       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+33 is 1.218696e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+34, overlap shift 3.8147e+35 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950251742462       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950251742462       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950251579285       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+34 is 3.046740e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+35, overlap shift 1.5259e+36 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950251742462       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950251742462       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950251742462       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+35 is 7.616849e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.939582 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7593e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.1755
    reference variance = 0.547949
====================================================
  Execution time = 3.7159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8095e-01
  Total weights = 2.0000e+06
  Execution time = 3.3531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280954970218
                                         uncertainty =       0.002719039469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280954970218
                                         uncertainty =       0.002719039469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374797468
  error estimate for blocks of size 2^( 2) =       0.000388651662
  error estimate for blocks of size 2^( 3) =       0.000401134015
  error estimate for blocks of size 2^( 4) =       0.000410493437
  error estimate for blocks of size 2^( 5) =       0.000415695297
  error estimate for blocks of size 2^( 6) =       0.000417796528
  error estimate for blocks of size 2^( 7) =       0.000419192974

      target function =      -0.942992800963
              le_mean =     -17.212376184508
             les_mean =     296.546840061218
             stat err =       0.000415794559
             autocorr =       1.230734305646
   target nu stat err =       0.000415794559
   target dn stat err =       0.002711610030
      target stat err =       0.004727369525
              std dev =       0.530043662993
             le_variance =       0.280946284679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280954970218
                                         uncertainty =       0.002719039469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280954970218
                                         uncertainty =       0.002719039469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374797468
  error estimate for blocks of size 2^( 2) =       0.000388651662
  error estimate for blocks of size 2^( 3) =       0.000401134015
  error estimate for blocks of size 2^( 4) =       0.000410493437
  error estimate for blocks of size 2^( 5) =       0.000415695297
  error estimate for blocks of size 2^( 6) =       0.000417796528
  error estimate for blocks of size 2^( 7) =       0.000419192974

      target function =      -0.942992800963
              le_mean =     -17.212376184508
             les_mean =     296.546840061218
             stat err =       0.000415794559
             autocorr =       1.230734305646
   target nu stat err =       0.000415794559
   target dn stat err =       0.002711610030
      target stat err =       0.004727369525
              std dev =       0.530043662993
             le_variance =       0.280946284679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280954970218
                                         uncertainty =       0.002719039469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280954970218
                                         uncertainty =       0.002719039469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374797468
  error estimate for blocks of size 2^( 2) =       0.000388651662
  error estimate for blocks of size 2^( 3) =       0.000401134015
  error estimate for blocks of size 2^( 4) =       0.000410493437
  error estimate for blocks of size 2^( 5) =       0.000415695297
  error estimate for blocks of size 2^( 6) =       0.000417796528
  error estimate for blocks of size 2^( 7) =       0.000419192974

      target function =      -0.942992800963
              le_mean =     -17.212376184508
             les_mean =     296.546840061218
             stat err =       0.000415794559
             autocorr =       1.230734305646
   target nu stat err =       0.000415794559
   target dn stat err =       0.002711610030
      target stat err =       0.004727369525
              std dev =       0.530043662993
             le_variance =       0.280946284679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280954970218
                                         uncertainty =       0.002719039469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280954970218
                                         uncertainty =       0.002719039469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374797468
  error estimate for blocks of size 2^( 2) =       0.000388651662
  error estimate for blocks of size 2^( 3) =       0.000401134015
  error estimate for blocks of size 2^( 4) =       0.000410493437
  error estimate for blocks of size 2^( 5) =       0.000415695297
  error estimate for blocks of size 2^( 6) =       0.000417796528
  error estimate for blocks of size 2^( 7) =       0.000419192974

      target function =      -0.942992800963
              le_mean =     -17.212376184508
             les_mean =     296.546840061218
             stat err =       0.000415794559
             autocorr =       1.230734305646
   target nu stat err =       0.000415794559
   target dn stat err =       0.002711610030
      target stat err =       0.004727369525
              std dev =       0.530043662993
             le_variance =       0.280946284679


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942992800963        initial  <--
     9.5367e+33     9.5367e+34             1.2187e-38        -0.942992800963
     3.8147e+34     3.8147e+35             3.0467e-39        -0.942992800963
     1.5259e+35     1.5259e+36             7.6168e-40        -0.942992800963

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 57.1420
  </log>
  <optVariables href="H2O.s049.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0474e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.3088
    reference variance = 0.620474
====================================================
  Execution time = 3.7255e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8179e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0065e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281689907480
                                         uncertainty =       0.002178779428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281689907480
                                         uncertainty =       0.002178779428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375363033
  error estimate for blocks of size 2^( 2) =       0.000389189492
  error estimate for blocks of size 2^( 3) =       0.000402016911
  error estimate for blocks of size 2^( 4) =       0.000410738683
  error estimate for blocks of size 2^( 5) =       0.000416161630
  error estimate for blocks of size 2^( 6) =       0.000419512641
  error estimate for blocks of size 2^( 7) =       0.000419865912

      target function =      -0.941545758653
              le_mean =     -17.212302080706
             les_mean =     296.545137590403
             stat err =       0.000416569716
             autocorr =       1.231607681556
   target nu stat err =       0.000416569716
   target dn stat err =       0.002277214445
      target stat err =       0.003979013796
              std dev =       0.530843492785
             le_variance =       0.281794813832


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721230208071e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+34, overlap shift 9.5367e+35 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941561417383       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941561417383       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+35, overlap shift 3.8147e+36 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941561417383       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941561417383       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+36, overlap shift 1.5259e+37 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941561417383       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941561417383       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.940652 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7328e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.171
    reference variance = 0.231404
====================================================
  Execution time = 3.6876e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8070e-01
  Total weights = 2.0000e+06
  Execution time = 3.3653e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280690257808
                                         uncertainty =       0.002222377638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280690257808
                                         uncertainty =       0.002222377638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374633200
  error estimate for blocks of size 2^( 2) =       0.000388125708
  error estimate for blocks of size 2^( 3) =       0.000400214760
  error estimate for blocks of size 2^( 4) =       0.000409717467
  error estimate for blocks of size 2^( 5) =       0.000415239820
  error estimate for blocks of size 2^( 6) =       0.000417804268
  error estimate for blocks of size 2^( 7) =       0.000420283566

      target function =      -0.943436642285
              le_mean =     -17.212084866440
             les_mean =     296.536565377793
             stat err =       0.000415761280
             autocorr =       1.231616669914
   target nu stat err =       0.000415761280
   target dn stat err =       0.002292220847
      target stat err =       0.004018128365
              std dev =       0.529811351902
             le_variance =       0.280700068604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280690257808
                                         uncertainty =       0.002222377638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280690257808
                                         uncertainty =       0.002222377638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374633200
  error estimate for blocks of size 2^( 2) =       0.000388125708
  error estimate for blocks of size 2^( 3) =       0.000400214760
  error estimate for blocks of size 2^( 4) =       0.000409717467
  error estimate for blocks of size 2^( 5) =       0.000415239820
  error estimate for blocks of size 2^( 6) =       0.000417804268
  error estimate for blocks of size 2^( 7) =       0.000420283566

      target function =      -0.943436642285
              le_mean =     -17.212084866440
             les_mean =     296.536565377793
             stat err =       0.000415761280
             autocorr =       1.231616669914
   target nu stat err =       0.000415761280
   target dn stat err =       0.002292220847
      target stat err =       0.004018128365
              std dev =       0.529811351902
             le_variance =       0.280700068604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280690257808
                                         uncertainty =       0.002222377638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280690257808
                                         uncertainty =       0.002222377638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374633200
  error estimate for blocks of size 2^( 2) =       0.000388125708
  error estimate for blocks of size 2^( 3) =       0.000400214760
  error estimate for blocks of size 2^( 4) =       0.000409717467
  error estimate for blocks of size 2^( 5) =       0.000415239820
  error estimate for blocks of size 2^( 6) =       0.000417804268
  error estimate for blocks of size 2^( 7) =       0.000420283566

      target function =      -0.943436642285
              le_mean =     -17.212084866440
             les_mean =     296.536565377793
             stat err =       0.000415761280
             autocorr =       1.231616669914
   target nu stat err =       0.000415761280
   target dn stat err =       0.002292220847
      target stat err =       0.004018128365
              std dev =       0.529811351902
             le_variance =       0.280700068604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280690257808
                                         uncertainty =       0.002222377638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280690257808
                                         uncertainty =       0.002222377638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374633200
  error estimate for blocks of size 2^( 2) =       0.000388125708
  error estimate for blocks of size 2^( 3) =       0.000400214760
  error estimate for blocks of size 2^( 4) =       0.000409717467
  error estimate for blocks of size 2^( 5) =       0.000415239820
  error estimate for blocks of size 2^( 6) =       0.000417804268
  error estimate for blocks of size 2^( 7) =       0.000420283566

      target function =      -0.943436642285
              le_mean =     -17.212084866440
             les_mean =     296.536565377793
             stat err =       0.000415761280
             autocorr =       1.231616669914
   target nu stat err =       0.000415761280
   target dn stat err =       0.002292220847
      target stat err =       0.004018128365
              std dev =       0.529811351902
             le_variance =       0.280700068604


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943436642285        initial  <--
     9.5367e+34     9.5367e+35             0.0000e+00        -0.943436642285
     3.8147e+35     3.8147e+36             0.0000e+00        -0.943436642285
     1.5259e+36     1.5259e+37             0.0000e+00        -0.943436642285

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.8928
  </log>
  <optVariables href="H2O.s050.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0123e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1772
    reference variance = 0.430852
====================================================
  Execution time = 3.7054e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8586e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0045e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285827684698
                                         uncertainty =       0.005505908595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285827684698
                                         uncertainty =       0.005505908595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378058125
  error estimate for blocks of size 2^( 2) =       0.000391492440
  error estimate for blocks of size 2^( 3) =       0.000403290232
  error estimate for blocks of size 2^( 4) =       0.000412664250
  error estimate for blocks of size 2^( 5) =       0.000417597967
  error estimate for blocks of size 2^( 6) =       0.000419146668
  error estimate for blocks of size 2^( 7) =       0.000420284467

      target function =      -0.934566187625
              le_mean =     -17.211931969387
             les_mean =     296.536457867643
             stat err =       0.000417423338
             autocorr =       1.219091494039
   target nu stat err =       0.000417423338
   target dn stat err =       0.005809008184
      target stat err =       0.009839537320
              std dev =       0.534654927742
             le_variance =       0.285855891759


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721193196939e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+35, overlap shift 9.5367e+36 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934669133322       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934669133322       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934669494629       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+35 is 1.699182e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+36, overlap shift 3.8147e+37 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934669133322       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934669133322       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934669494629       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+36 is 4.247955e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+37, overlap shift 1.5259e+38 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934669133322       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934669133322       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934669133322       residual = 8.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934669494629       residual = 6.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.000000000000       residual = 1.39e+08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 1.15e+12           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+37 is 1.231154e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.942319 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7108e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2614
    reference variance = 2.05729
====================================================
  Execution time = 3.7128e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8163e-01
  Total weights = 2.0000e+06
  Execution time = 3.3759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281401009315
                                         uncertainty =       0.002872811292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281401009315
                                         uncertainty =       0.002872811292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375253690
  error estimate for blocks of size 2^( 2) =       0.000388592093
  error estimate for blocks of size 2^( 3) =       0.000400715540
  error estimate for blocks of size 2^( 4) =       0.000409443224
  error estimate for blocks of size 2^( 5) =       0.000415016553
  error estimate for blocks of size 2^( 6) =       0.000418431394
  error estimate for blocks of size 2^( 7) =       0.000418018323

      target function =      -0.941823583192
              le_mean =     -17.212056923278
             les_mean =     296.536534053728
             stat err =       0.000415227373
             autocorr =       1.224396298734
   target nu stat err =       0.000415227373
   target dn stat err =       0.003171609071
      target stat err =       0.005493115558
              std dev =       0.530688858370
             le_variance =       0.281630664398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281401009315
                                         uncertainty =       0.002872811292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281401009315
                                         uncertainty =       0.002872811292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375253690
  error estimate for blocks of size 2^( 2) =       0.000388592093
  error estimate for blocks of size 2^( 3) =       0.000400715540
  error estimate for blocks of size 2^( 4) =       0.000409443224
  error estimate for blocks of size 2^( 5) =       0.000415016553
  error estimate for blocks of size 2^( 6) =       0.000418431394
  error estimate for blocks of size 2^( 7) =       0.000418018323

      target function =      -0.941823583192
              le_mean =     -17.212056923278
             les_mean =     296.536534053728
             stat err =       0.000415227373
             autocorr =       1.224396298734
   target nu stat err =       0.000415227373
   target dn stat err =       0.003171609071
      target stat err =       0.005493115558
              std dev =       0.530688858370
             le_variance =       0.281630664398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281401009315
                                         uncertainty =       0.002872811292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281401009315
                                         uncertainty =       0.002872811292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375253690
  error estimate for blocks of size 2^( 2) =       0.000388592093
  error estimate for blocks of size 2^( 3) =       0.000400715540
  error estimate for blocks of size 2^( 4) =       0.000409443224
  error estimate for blocks of size 2^( 5) =       0.000415016553
  error estimate for blocks of size 2^( 6) =       0.000418431394
  error estimate for blocks of size 2^( 7) =       0.000418018323

      target function =      -0.941823583192
              le_mean =     -17.212056923278
             les_mean =     296.536534053728
             stat err =       0.000415227373
             autocorr =       1.224396298734
   target nu stat err =       0.000415227373
   target dn stat err =       0.003171609071
      target stat err =       0.005493115558
              std dev =       0.530688858370
             le_variance =       0.281630664398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281401009315
                                         uncertainty =       0.002872811292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281401009315
                                         uncertainty =       0.002872811292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375253690
  error estimate for blocks of size 2^( 2) =       0.000388592093
  error estimate for blocks of size 2^( 3) =       0.000400715540
  error estimate for blocks of size 2^( 4) =       0.000409443224
  error estimate for blocks of size 2^( 5) =       0.000415016553
  error estimate for blocks of size 2^( 6) =       0.000418431394
  error estimate for blocks of size 2^( 7) =       0.000418018323

      target function =      -0.941823583192
              le_mean =     -17.212056923278
             les_mean =     296.536534053728
             stat err =       0.000415227373
             autocorr =       1.224396298734
   target nu stat err =       0.000415227373
   target dn stat err =       0.003171609071
      target stat err =       0.005493115558
              std dev =       0.530688858370
             le_variance =       0.281630664398


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941823583192        initial  <--
     9.5367e+35     9.5367e+36             1.6992e-40        -0.941823583192
     3.8147e+36     3.8147e+37             4.2480e-41        -0.941823583192
     1.5259e+37     1.5259e+38             1.2312e-41        -0.941823583192

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1622
  </log>
  <optVariables href="H2O.s051.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0127e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2051
    reference variance = 0.345836
====================================================
  Execution time = 3.7542e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8100e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0111e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280971076669
                                         uncertainty =       0.002709464719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280971076669
                                         uncertainty =       0.002709464719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374835763
  error estimate for blocks of size 2^( 2) =       0.000388376376
  error estimate for blocks of size 2^( 3) =       0.000400462826
  error estimate for blocks of size 2^( 4) =       0.000409080891
  error estimate for blocks of size 2^( 5) =       0.000414365313
  error estimate for blocks of size 2^( 6) =       0.000416718533
  error estimate for blocks of size 2^( 7) =       0.000419637070

      target function =      -0.942911504073
              le_mean =     -17.211949462007
             les_mean =     296.532207840854
             stat err =       0.000414950452
             autocorr =       1.225491893586
   target nu stat err =       0.000414950452
   target dn stat err =       0.002846789207
      target stat err =       0.004951949318
              std dev =       0.530097819922
             le_variance =       0.281003698686


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721194946201e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+36, overlap shift 9.5367e+37 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942936407261       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942936407261       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+37, overlap shift 3.8147e+38 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942936407261       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942936407261       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+38, overlap shift 1.5259e+39 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942936407261       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942936407261       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.943413 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7661e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2466
    reference variance = 0.222992
====================================================
  Execution time = 3.6436e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7984e-01
  Total weights = 2.0000e+06
  Execution time = 3.3823e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279857712296
                                         uncertainty =       0.002480061908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279857712296
                                         uncertainty =       0.002480061908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374055754
  error estimate for blocks of size 2^( 2) =       0.000387891025
  error estimate for blocks of size 2^( 3) =       0.000400356850
  error estimate for blocks of size 2^( 4) =       0.000409421315
  error estimate for blocks of size 2^( 5) =       0.000415523425
  error estimate for blocks of size 2^( 6) =       0.000418696773
  error estimate for blocks of size 2^( 7) =       0.000422541338

      target function =      -0.944922917624
              le_mean =     -17.211975442065
             les_mean =     296.531933893224
             stat err =       0.000416545713
             autocorr =       1.240088433691
   target nu stat err =       0.000416545713
   target dn stat err =       0.002852834229
      target stat err =       0.004983861857
              std dev =       0.528994721057
             le_variance =       0.279835414906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279857712296
                                         uncertainty =       0.002480061908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279857712296
                                         uncertainty =       0.002480061908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374055754
  error estimate for blocks of size 2^( 2) =       0.000387891025
  error estimate for blocks of size 2^( 3) =       0.000400356850
  error estimate for blocks of size 2^( 4) =       0.000409421315
  error estimate for blocks of size 2^( 5) =       0.000415523425
  error estimate for blocks of size 2^( 6) =       0.000418696773
  error estimate for blocks of size 2^( 7) =       0.000422541338

      target function =      -0.944922917624
              le_mean =     -17.211975442065
             les_mean =     296.531933893224
             stat err =       0.000416545713
             autocorr =       1.240088433691
   target nu stat err =       0.000416545713
   target dn stat err =       0.002852834229
      target stat err =       0.004983861857
              std dev =       0.528994721057
             le_variance =       0.279835414906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279857712296
                                         uncertainty =       0.002480061908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279857712296
                                         uncertainty =       0.002480061908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374055754
  error estimate for blocks of size 2^( 2) =       0.000387891025
  error estimate for blocks of size 2^( 3) =       0.000400356850
  error estimate for blocks of size 2^( 4) =       0.000409421315
  error estimate for blocks of size 2^( 5) =       0.000415523425
  error estimate for blocks of size 2^( 6) =       0.000418696773
  error estimate for blocks of size 2^( 7) =       0.000422541338

      target function =      -0.944922917624
              le_mean =     -17.211975442065
             les_mean =     296.531933893224
             stat err =       0.000416545713
             autocorr =       1.240088433691
   target nu stat err =       0.000416545713
   target dn stat err =       0.002852834229
      target stat err =       0.004983861857
              std dev =       0.528994721057
             le_variance =       0.279835414906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279857712296
                                         uncertainty =       0.002480061908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279857712296
                                         uncertainty =       0.002480061908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374055754
  error estimate for blocks of size 2^( 2) =       0.000387891025
  error estimate for blocks of size 2^( 3) =       0.000400356850
  error estimate for blocks of size 2^( 4) =       0.000409421315
  error estimate for blocks of size 2^( 5) =       0.000415523425
  error estimate for blocks of size 2^( 6) =       0.000418696773
  error estimate for blocks of size 2^( 7) =       0.000422541338

      target function =      -0.944922917624
              le_mean =     -17.211975442065
             les_mean =     296.531933893224
             stat err =       0.000416545713
             autocorr =       1.240088433691
   target nu stat err =       0.000416545713
   target dn stat err =       0.002852834229
      target stat err =       0.004983861857
              std dev =       0.528994721057
             le_variance =       0.279835414906


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944922917624        initial  <--
     9.5367e+36     9.5367e+37             0.0000e+00        -0.944922917624
     3.8147e+37     3.8147e+38             0.0000e+00        -0.944922917624
     1.5259e+38     1.5259e+39             0.0000e+00        -0.944922917624

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 56.3146
  </log>
  <optVariables href="H2O.s052.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0398e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2399
    reference variance = 0.21233
====================================================
  Execution time = 3.7244e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7947e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0035e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279426219087
                                         uncertainty =       0.002264194632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279426219087
                                         uncertainty =       0.002264194632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373810558
  error estimate for blocks of size 2^( 2) =       0.000386910703
  error estimate for blocks of size 2^( 3) =       0.000399450192
  error estimate for blocks of size 2^( 4) =       0.000408386148
  error estimate for blocks of size 2^( 5) =       0.000414306978
  error estimate for blocks of size 2^( 6) =       0.000416726781
  error estimate for blocks of size 2^( 7) =       0.000418628945

      target function =      -0.945571243173
              le_mean =     -17.211765964337
             les_mean =     296.524356138585
             stat err =       0.000414512213
             autocorr =       1.229621743220
   target nu stat err =       0.000414512213
   target dn stat err =       0.002456446013
      target stat err =       0.004312185535
              std dev =       0.528647961501
             le_variance =       0.279468667199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721176596434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+37, overlap shift 9.5367e+38 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945589986405       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945589986405       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945587158203       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+37 is 1.368462e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+38, overlap shift 3.8147e+39 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945589986405       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945589986405       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945589986405       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945587158203       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945312500000       residual = 4.79e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+38 is 3.897978e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+39, overlap shift 1.5259e+40 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945589986405       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945589986405       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945589986405       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945589065552       residual = 7.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+39 is 9.744945e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.945036 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7288e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.3015
    reference variance = 0.375903
====================================================
  Execution time = 3.6718e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7620e-01
  Total weights = 2.0000e+06
  Execution time = 3.3731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276229499868
                                         uncertainty =       0.002046903949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276229499868
                                         uncertainty =       0.002046903949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371616194
  error estimate for blocks of size 2^( 2) =       0.000385058077
  error estimate for blocks of size 2^( 3) =       0.000397721586
  error estimate for blocks of size 2^( 4) =       0.000406246925
  error estimate for blocks of size 2^( 5) =       0.000412536547
  error estimate for blocks of size 2^( 6) =       0.000415011905
  error estimate for blocks of size 2^( 7) =       0.000415106313

      target function =      -0.951248086129
              le_mean =     -17.212325683253
             les_mean =     296.540352479132
             stat err =       0.000412225423
             autocorr =       1.230496215898
   target nu stat err =       0.000412225423
   target dn stat err =       0.002035645551
      target stat err =       0.003643976121
              std dev =       0.525544661159
             le_variance =       0.276197190872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276229499868
                                         uncertainty =       0.002046903949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276229499868
                                         uncertainty =       0.002046903949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371616194
  error estimate for blocks of size 2^( 2) =       0.000385058077
  error estimate for blocks of size 2^( 3) =       0.000397721586
  error estimate for blocks of size 2^( 4) =       0.000406246925
  error estimate for blocks of size 2^( 5) =       0.000412536547
  error estimate for blocks of size 2^( 6) =       0.000415011905
  error estimate for blocks of size 2^( 7) =       0.000415106313

      target function =      -0.951248086129
              le_mean =     -17.212325683253
             les_mean =     296.540352479132
             stat err =       0.000412225423
             autocorr =       1.230496215898
   target nu stat err =       0.000412225423
   target dn stat err =       0.002035645551
      target stat err =       0.003643976121
              std dev =       0.525544661159
             le_variance =       0.276197190872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276229499868
                                         uncertainty =       0.002046903949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276229499868
                                         uncertainty =       0.002046903949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371616194
  error estimate for blocks of size 2^( 2) =       0.000385058077
  error estimate for blocks of size 2^( 3) =       0.000397721586
  error estimate for blocks of size 2^( 4) =       0.000406246925
  error estimate for blocks of size 2^( 5) =       0.000412536547
  error estimate for blocks of size 2^( 6) =       0.000415011905
  error estimate for blocks of size 2^( 7) =       0.000415106313

      target function =      -0.951248086129
              le_mean =     -17.212325683253
             les_mean =     296.540352479132
             stat err =       0.000412225423
             autocorr =       1.230496215898
   target nu stat err =       0.000412225423
   target dn stat err =       0.002035645551
      target stat err =       0.003643976121
              std dev =       0.525544661159
             le_variance =       0.276197190872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276229499868
                                         uncertainty =       0.002046903949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276229499868
                                         uncertainty =       0.002046903949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371616194
  error estimate for blocks of size 2^( 2) =       0.000385058077
  error estimate for blocks of size 2^( 3) =       0.000397721586
  error estimate for blocks of size 2^( 4) =       0.000406246925
  error estimate for blocks of size 2^( 5) =       0.000412536547
  error estimate for blocks of size 2^( 6) =       0.000415011905
  error estimate for blocks of size 2^( 7) =       0.000415106313

      target function =      -0.951248086129
              le_mean =     -17.212325683253
             les_mean =     296.540352479132
             stat err =       0.000412225423
             autocorr =       1.230496215898
   target nu stat err =       0.000412225423
   target dn stat err =       0.002035645551
      target stat err =       0.003643976121
              std dev =       0.525544661159
             le_variance =       0.276197190872


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951248086129        initial  <--
     9.5367e+37     9.5367e+38             1.3685e-42        -0.951248086129
     3.8147e+38     3.8147e+39             3.8980e-43        -0.951248086129
     1.5259e+39     1.5259e+40             9.7449e-44        -0.951248086129

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7506
  </log>
  <optVariables href="H2O.s053.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0104e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.3398
    reference variance = 0.167237
====================================================
  Execution time = 3.7320e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8180e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0116e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281725083951
                                         uncertainty =       0.002951497604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281725083951
                                         uncertainty =       0.002951497604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375363404
  error estimate for blocks of size 2^( 2) =       0.000388940052
  error estimate for blocks of size 2^( 3) =       0.000401305719
  error estimate for blocks of size 2^( 4) =       0.000409965740
  error estimate for blocks of size 2^( 5) =       0.000415407553
  error estimate for blocks of size 2^( 6) =       0.000417840050
  error estimate for blocks of size 2^( 7) =       0.000419734414

      target function =      -0.941543023901
              le_mean =     -17.212053316836
             les_mean =     296.536574610186
             stat err =       0.000415736939
             autocorr =       1.226685896591
   target nu stat err =       0.000415736939
   target dn stat err =       0.003084630310
      target stat err =       0.005342298595
              std dev =       0.530844016151
             le_variance =       0.281795369483


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721205331684e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+38, overlap shift 9.5367e+39 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941572456941       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941572456941       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941558837891       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+38 is 1.181870e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+39, overlap shift 3.8147e+40 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941572456941       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941572456941       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941589355469       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+39 is 2.954674e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+40, overlap shift 1.5259e+41 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941572456941       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941572456941       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941528320312       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+40 is 7.386686e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.946398 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.0848e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2081
    reference variance = 0.172921
====================================================
  Execution time = 3.6745e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7796e-01
  Total weights = 2.0000e+06
  Execution time = 3.3780e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277961015609
                                         uncertainty =       0.002093177984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277961015609
                                         uncertainty =       0.002093177984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372801532
  error estimate for blocks of size 2^( 2) =       0.000386753703
  error estimate for blocks of size 2^( 3) =       0.000399665236
  error estimate for blocks of size 2^( 4) =       0.000409582498
  error estimate for blocks of size 2^( 5) =       0.000415265271
  error estimate for blocks of size 2^( 6) =       0.000417167895
  error estimate for blocks of size 2^( 7) =       0.000418629698

      target function =      -0.948165070878
              le_mean =     -17.212405698223
             les_mean =     296.544871745139
             stat err =       0.000415161341
             autocorr =       1.240162044841
   target nu stat err =       0.000415161341
   target dn stat err =       0.002060015667
      target stat err =       0.003664057351
              std dev =       0.527220982050
             le_variance =       0.277961963913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277961015609
                                         uncertainty =       0.002093177984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277961015609
                                         uncertainty =       0.002093177984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372801532
  error estimate for blocks of size 2^( 2) =       0.000386753703
  error estimate for blocks of size 2^( 3) =       0.000399665236
  error estimate for blocks of size 2^( 4) =       0.000409582498
  error estimate for blocks of size 2^( 5) =       0.000415265271
  error estimate for blocks of size 2^( 6) =       0.000417167895
  error estimate for blocks of size 2^( 7) =       0.000418629698

      target function =      -0.948165070878
              le_mean =     -17.212405698223
             les_mean =     296.544871745139
             stat err =       0.000415161341
             autocorr =       1.240162044841
   target nu stat err =       0.000415161341
   target dn stat err =       0.002060015667
      target stat err =       0.003664057351
              std dev =       0.527220982050
             le_variance =       0.277961963913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277961015609
                                         uncertainty =       0.002093177984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277961015609
                                         uncertainty =       0.002093177984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372801532
  error estimate for blocks of size 2^( 2) =       0.000386753703
  error estimate for blocks of size 2^( 3) =       0.000399665236
  error estimate for blocks of size 2^( 4) =       0.000409582498
  error estimate for blocks of size 2^( 5) =       0.000415265271
  error estimate for blocks of size 2^( 6) =       0.000417167895
  error estimate for blocks of size 2^( 7) =       0.000418629698

      target function =      -0.948165070878
              le_mean =     -17.212405698223
             les_mean =     296.544871745139
             stat err =       0.000415161341
             autocorr =       1.240162044841
   target nu stat err =       0.000415161341
   target dn stat err =       0.002060015667
      target stat err =       0.003664057351
              std dev =       0.527220982050
             le_variance =       0.277961963913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277961015609
                                         uncertainty =       0.002093177984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277961015609
                                         uncertainty =       0.002093177984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372801532
  error estimate for blocks of size 2^( 2) =       0.000386753703
  error estimate for blocks of size 2^( 3) =       0.000399665236
  error estimate for blocks of size 2^( 4) =       0.000409582498
  error estimate for blocks of size 2^( 5) =       0.000415265271
  error estimate for blocks of size 2^( 6) =       0.000417167895
  error estimate for blocks of size 2^( 7) =       0.000418629698

      target function =      -0.948165070878
              le_mean =     -17.212405698223
             les_mean =     296.544871745139
             stat err =       0.000415161341
             autocorr =       1.240162044841
   target nu stat err =       0.000415161341
   target dn stat err =       0.002060015667
      target stat err =       0.003664057351
              std dev =       0.527220982050
             le_variance =       0.277961963913


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948165070878        initial  <--
     9.5367e+38     9.5367e+39             1.1819e-43        -0.948165070878
     3.8147e+39     3.8147e+40             2.9547e-44        -0.948165070878
     1.5259e+40     1.5259e+41             7.3867e-45        -0.948165070878

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7830
  </log>
  <optVariables href="H2O.s054.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0464e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1964
    reference variance = 0.211046
====================================================
  Execution time = 3.7241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9074e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0229e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290799555063
                                         uncertainty =       0.008049391081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290799555063
                                         uncertainty =       0.008049391081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381272450
  error estimate for blocks of size 2^( 2) =       0.000394686722
  error estimate for blocks of size 2^( 3) =       0.000406746713
  error estimate for blocks of size 2^( 4) =       0.000415836669
  error estimate for blocks of size 2^( 5) =       0.000421678913
  error estimate for blocks of size 2^( 6) =       0.000424554064
  error estimate for blocks of size 2^( 7) =       0.000424501132

      target function =      -0.926234132768
              le_mean =     -17.212789826835
             les_mean =     296.570870840454
             stat err =       0.000421642695
             autocorr =       1.222977055039
   target nu stat err =       0.000421642695
   target dn stat err =       0.008104251110
      target stat err =       0.013488897165
              std dev =       0.539200670452
             le_variance =       0.290737363016


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721278982684e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+39, overlap shift 9.5367e+40 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926430971422       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926430971422       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+40, overlap shift 3.8147e+41 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926430971422       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926430971422       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+41, overlap shift 1.5259e+42 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926430971422       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926430971422       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.947501 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7478e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2615
    reference variance = 0.330857
====================================================
  Execution time = 3.6596e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8640e-01
  Total weights = 2.0000e+06
  Execution time = 3.4350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286452379155
                                         uncertainty =       0.005175579509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286452379155
                                         uncertainty =       0.005175579509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378416681
  error estimate for blocks of size 2^( 2) =       0.000391873283
  error estimate for blocks of size 2^( 3) =       0.000404156749
  error estimate for blocks of size 2^( 4) =       0.000411853871
  error estimate for blocks of size 2^( 5) =       0.000417861649
  error estimate for blocks of size 2^( 6) =       0.000420705094
  error estimate for blocks of size 2^( 7) =       0.000422615212

      target function =      -0.933636449292
              le_mean =     -17.212427054537
             les_mean =     296.554043333687
             stat err =       0.000418258956
             autocorr =       1.221658874329
   target nu stat err =       0.000418258956
   target dn stat err =       0.005329415855
      target stat err =       0.009022876685
              std dev =       0.535162002695
             le_variance =       0.286398369129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286452379155
                                         uncertainty =       0.005175579509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286452379155
                                         uncertainty =       0.005175579509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378416681
  error estimate for blocks of size 2^( 2) =       0.000391873283
  error estimate for blocks of size 2^( 3) =       0.000404156749
  error estimate for blocks of size 2^( 4) =       0.000411853871
  error estimate for blocks of size 2^( 5) =       0.000417861649
  error estimate for blocks of size 2^( 6) =       0.000420705094
  error estimate for blocks of size 2^( 7) =       0.000422615212

      target function =      -0.933636449292
              le_mean =     -17.212427054537
             les_mean =     296.554043333687
             stat err =       0.000418258956
             autocorr =       1.221658874329
   target nu stat err =       0.000418258956
   target dn stat err =       0.005329415855
      target stat err =       0.009022876685
              std dev =       0.535162002695
             le_variance =       0.286398369129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286452379155
                                         uncertainty =       0.005175579509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286452379155
                                         uncertainty =       0.005175579509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378416681
  error estimate for blocks of size 2^( 2) =       0.000391873283
  error estimate for blocks of size 2^( 3) =       0.000404156749
  error estimate for blocks of size 2^( 4) =       0.000411853871
  error estimate for blocks of size 2^( 5) =       0.000417861649
  error estimate for blocks of size 2^( 6) =       0.000420705094
  error estimate for blocks of size 2^( 7) =       0.000422615212

      target function =      -0.933636449292
              le_mean =     -17.212427054537
             les_mean =     296.554043333687
             stat err =       0.000418258956
             autocorr =       1.221658874329
   target nu stat err =       0.000418258956
   target dn stat err =       0.005329415855
      target stat err =       0.009022876685
              std dev =       0.535162002695
             le_variance =       0.286398369129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286452379155
                                         uncertainty =       0.005175579509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286452379155
                                         uncertainty =       0.005175579509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378416681
  error estimate for blocks of size 2^( 2) =       0.000391873283
  error estimate for blocks of size 2^( 3) =       0.000404156749
  error estimate for blocks of size 2^( 4) =       0.000411853871
  error estimate for blocks of size 2^( 5) =       0.000417861649
  error estimate for blocks of size 2^( 6) =       0.000420705094
  error estimate for blocks of size 2^( 7) =       0.000422615212

      target function =      -0.933636449292
              le_mean =     -17.212427054537
             les_mean =     296.554043333687
             stat err =       0.000418258956
             autocorr =       1.221658874329
   target nu stat err =       0.000418258956
   target dn stat err =       0.005329415855
      target stat err =       0.009022876685
              std dev =       0.535162002695
             le_variance =       0.286398369129


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933636449292        initial  <--
     9.5367e+39     9.5367e+40             0.0000e+00        -0.933636449292
     3.8147e+40     3.8147e+41             0.0000e+00        -0.933636449292
     1.5259e+41     1.5259e+42             0.0000e+00        -0.933636449292

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7003
  </log>
  <optVariables href="H2O.s055.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0118e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1975
    reference variance = 0.225461
====================================================
  Execution time = 3.7390e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7831e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0102e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277963364325
                                         uncertainty =       0.002317998910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277963364325
                                         uncertainty =       0.002317998910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373033803
  error estimate for blocks of size 2^( 2) =       0.000386562544
  error estimate for blocks of size 2^( 3) =       0.000399138859
  error estimate for blocks of size 2^( 4) =       0.000408086898
  error estimate for blocks of size 2^( 5) =       0.000413433273
  error estimate for blocks of size 2^( 6) =       0.000418794244
  error estimate for blocks of size 2^( 7) =       0.000419565234

      target function =      -0.947540674980
              le_mean =     -17.212932758899
             les_mean =     296.563362459714
             stat err =       0.000414969912
             autocorr =       1.237476163140
   target nu stat err =       0.000414969912
   target dn stat err =       0.002169239105
      target stat err =       0.003849025967
              std dev =       0.527549463554
             le_variance =       0.278308436496


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721293275890e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+40, overlap shift 9.5367e+41 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947555316957       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947555316957       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+41, overlap shift 3.8147e+42 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947555316957       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947555316957       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+42, overlap shift 1.5259e+43 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947555316957       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947555316957       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.948622 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7500e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1854
    reference variance = 0.247649
====================================================
  Execution time = 3.6738e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7804e-01
  Total weights = 2.0000e+06
  Execution time = 3.3712e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278116924980
                                         uncertainty =       0.003052667823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278116924980
                                         uncertainty =       0.003052667823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372855758
  error estimate for blocks of size 2^( 2) =       0.000386309771
  error estimate for blocks of size 2^( 3) =       0.000398885300
  error estimate for blocks of size 2^( 4) =       0.000408060546
  error estimate for blocks of size 2^( 5) =       0.000413117971
  error estimate for blocks of size 2^( 6) =       0.000415898093
  error estimate for blocks of size 2^( 7) =       0.000416458594

      target function =      -0.947985763528
              le_mean =     -17.213014140658
             les_mean =     296.565898499645
             stat err =       0.000413383801
             autocorr =       1.229207496227
   target nu stat err =       0.000413383801
   target dn stat err =       0.002999794698
      target stat err =       0.005278169764
              std dev =       0.527297669422
             le_variance =       0.278042832178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278116924980
                                         uncertainty =       0.003052667823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278116924980
                                         uncertainty =       0.003052667823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372855758
  error estimate for blocks of size 2^( 2) =       0.000386309771
  error estimate for blocks of size 2^( 3) =       0.000398885300
  error estimate for blocks of size 2^( 4) =       0.000408060546
  error estimate for blocks of size 2^( 5) =       0.000413117971
  error estimate for blocks of size 2^( 6) =       0.000415898093
  error estimate for blocks of size 2^( 7) =       0.000416458594

      target function =      -0.947985763528
              le_mean =     -17.213014140658
             les_mean =     296.565898499645
             stat err =       0.000413383801
             autocorr =       1.229207496227
   target nu stat err =       0.000413383801
   target dn stat err =       0.002999794698
      target stat err =       0.005278169764
              std dev =       0.527297669422
             le_variance =       0.278042832178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278116924980
                                         uncertainty =       0.003052667823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278116924980
                                         uncertainty =       0.003052667823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372855758
  error estimate for blocks of size 2^( 2) =       0.000386309771
  error estimate for blocks of size 2^( 3) =       0.000398885300
  error estimate for blocks of size 2^( 4) =       0.000408060546
  error estimate for blocks of size 2^( 5) =       0.000413117971
  error estimate for blocks of size 2^( 6) =       0.000415898093
  error estimate for blocks of size 2^( 7) =       0.000416458594

      target function =      -0.947985763528
              le_mean =     -17.213014140658
             les_mean =     296.565898499645
             stat err =       0.000413383801
             autocorr =       1.229207496227
   target nu stat err =       0.000413383801
   target dn stat err =       0.002999794698
      target stat err =       0.005278169764
              std dev =       0.527297669422
             le_variance =       0.278042832178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278116924980
                                         uncertainty =       0.003052667823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278116924980
                                         uncertainty =       0.003052667823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372855758
  error estimate for blocks of size 2^( 2) =       0.000386309771
  error estimate for blocks of size 2^( 3) =       0.000398885300
  error estimate for blocks of size 2^( 4) =       0.000408060546
  error estimate for blocks of size 2^( 5) =       0.000413117971
  error estimate for blocks of size 2^( 6) =       0.000415898093
  error estimate for blocks of size 2^( 7) =       0.000416458594

      target function =      -0.947985763528
              le_mean =     -17.213014140658
             les_mean =     296.565898499645
             stat err =       0.000413383801
             autocorr =       1.229207496227
   target nu stat err =       0.000413383801
   target dn stat err =       0.002999794698
      target stat err =       0.005278169764
              std dev =       0.527297669422
             le_variance =       0.278042832178


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947985763528        initial  <--
     9.5367e+40     9.5367e+41             0.0000e+00        -0.947985763528
     3.8147e+41     3.8147e+42             0.0000e+00        -0.947985763528
     1.5259e+42     1.5259e+43             0.0000e+00        -0.947985763528

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.7540
  </log>
  <optVariables href="H2O.s056.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0128e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2511
    reference variance = 0.250071
====================================================
  Execution time = 3.7317e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7599e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0044e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276032513805
                                         uncertainty =       0.001850948569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276032513805
                                         uncertainty =       0.001850948569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371477119
  error estimate for blocks of size 2^( 2) =       0.000385255119
  error estimate for blocks of size 2^( 3) =       0.000397553284
  error estimate for blocks of size 2^( 4) =       0.000407268534
  error estimate for blocks of size 2^( 5) =       0.000413319817
  error estimate for blocks of size 2^( 6) =       0.000416926981
  error estimate for blocks of size 2^( 7) =       0.000419260164

      target function =      -0.951601527493
              le_mean =     -17.212629348561
             les_mean =     296.550599452928
             stat err =       0.000414193874
             autocorr =       1.243206308177
   target nu stat err =       0.000414193874
   target dn stat err =       0.001987984504
      target stat err =       0.003567854796
              std dev =       0.525347979885
             le_variance =       0.275990499970


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721262934856e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+41, overlap shift 9.5367e+42 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951613772801       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951613772801       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+42, overlap shift 3.8147e+43 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951613772801       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951613772801       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+43, overlap shift 1.5259e+44 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951613772801       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951613772801       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.949723 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7368e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2486
    reference variance = 0.668941
====================================================
  Execution time = 3.6522e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.0618e-01
  Total weights = 2.0000e+06
  Execution time = 3.3834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306185643280
                                         uncertainty =       0.021704201534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306185643280
                                         uncertainty =       0.021704201534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391266142
  error estimate for blocks of size 2^( 2) =       0.000404230362
  error estimate for blocks of size 2^( 3) =       0.000416312083
  error estimate for blocks of size 2^( 4) =       0.000424831356
  error estimate for blocks of size 2^( 5) =       0.000430509472
  error estimate for blocks of size 2^( 6) =       0.000433011599
  error estimate for blocks of size 2^( 7) =       0.000436654785

      target function =      -0.900224778649
              le_mean =     -17.212214016281
             les_mean =     296.566489576516
             stat err =       0.000431251803
             autocorr =       1.214835044841
   target nu stat err =       0.000431251803
   target dn stat err =       0.021869598289
      target stat err =       0.034342817715
              std dev =       0.553333884154
             le_variance =       0.306178387353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306185643280
                                         uncertainty =       0.021704201534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306185643280
                                         uncertainty =       0.021704201534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391266142
  error estimate for blocks of size 2^( 2) =       0.000404230362
  error estimate for blocks of size 2^( 3) =       0.000416312083
  error estimate for blocks of size 2^( 4) =       0.000424831356
  error estimate for blocks of size 2^( 5) =       0.000430509472
  error estimate for blocks of size 2^( 6) =       0.000433011599
  error estimate for blocks of size 2^( 7) =       0.000436654785

      target function =      -0.900224778649
              le_mean =     -17.212214016281
             les_mean =     296.566489576516
             stat err =       0.000431251803
             autocorr =       1.214835044841
   target nu stat err =       0.000431251803
   target dn stat err =       0.021869598289
      target stat err =       0.034342817715
              std dev =       0.553333884154
             le_variance =       0.306178387353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306185643280
                                         uncertainty =       0.021704201534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306185643280
                                         uncertainty =       0.021704201534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391266142
  error estimate for blocks of size 2^( 2) =       0.000404230362
  error estimate for blocks of size 2^( 3) =       0.000416312083
  error estimate for blocks of size 2^( 4) =       0.000424831356
  error estimate for blocks of size 2^( 5) =       0.000430509472
  error estimate for blocks of size 2^( 6) =       0.000433011599
  error estimate for blocks of size 2^( 7) =       0.000436654785

      target function =      -0.900224778649
              le_mean =     -17.212214016281
             les_mean =     296.566489576516
             stat err =       0.000431251803
             autocorr =       1.214835044841
   target nu stat err =       0.000431251803
   target dn stat err =       0.021869598289
      target stat err =       0.034342817715
              std dev =       0.553333884154
             le_variance =       0.306178387353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306185643280
                                         uncertainty =       0.021704201534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306185643280
                                         uncertainty =       0.021704201534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391266142
  error estimate for blocks of size 2^( 2) =       0.000404230362
  error estimate for blocks of size 2^( 3) =       0.000416312083
  error estimate for blocks of size 2^( 4) =       0.000424831356
  error estimate for blocks of size 2^( 5) =       0.000430509472
  error estimate for blocks of size 2^( 6) =       0.000433011599
  error estimate for blocks of size 2^( 7) =       0.000436654785

      target function =      -0.900224778649
              le_mean =     -17.212214016281
             les_mean =     296.566489576516
             stat err =       0.000431251803
             autocorr =       1.214835044841
   target nu stat err =       0.000431251803
   target dn stat err =       0.021869598289
      target stat err =       0.034342817715
              std dev =       0.553333884154
             le_variance =       0.306178387353


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.900224778649        initial  <--
     9.5367e+41     9.5367e+42             0.0000e+00        -0.900224778649
     3.8147e+42     3.8147e+43             0.0000e+00        -0.900224778649
     1.5259e+43     1.5259e+44             0.0000e+00        -0.900224778649

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.5518
  </log>
  <optVariables href="H2O.s057.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0093e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.181
    reference variance = 0.205032
====================================================
  Execution time = 3.7379e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8179e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0014e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281844116092
                                         uncertainty =       0.002827194271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281844116092
                                         uncertainty =       0.002827194271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375360829
  error estimate for blocks of size 2^( 2) =       0.000388938706
  error estimate for blocks of size 2^( 3) =       0.000401307523
  error estimate for blocks of size 2^( 4) =       0.000410996335
  error estimate for blocks of size 2^( 5) =       0.000416439366
  error estimate for blocks of size 2^( 6) =       0.000419596517
  error estimate for blocks of size 2^( 7) =       0.000421524242

      target function =      -0.941522407365
              le_mean =     -17.212709212617
             les_mean =     296.559149801291
             stat err =       0.000417139115
             autocorr =       1.234991393866
   target nu stat err =       0.000417139115
   target dn stat err =       0.002822816716
      target stat err =       0.004904758138
              std dev =       0.530840375320
             le_variance =       0.281791504070


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721270921262e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+42, overlap shift 9.5367e+43 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941546989445       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941546989445       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+43, overlap shift 3.8147e+44 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941546989445       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941546989445       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+44, overlap shift 1.5259e+45 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941546989445       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941546989445       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.950819 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7401e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.1502
    reference variance = 0.177933
====================================================
  Execution time = 3.7546e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7633e-01
  Total weights = 2.0000e+06
  Execution time = 3.4995e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313552390
                                         uncertainty =       0.001738248336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313552390
                                         uncertainty =       0.001738248336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371703009
  error estimate for blocks of size 2^( 2) =       0.000385916279
  error estimate for blocks of size 2^( 3) =       0.000398539673
  error estimate for blocks of size 2^( 4) =       0.000407172727
  error estimate for blocks of size 2^( 5) =       0.000411845197
  error estimate for blocks of size 2^( 6) =       0.000412856575
  error estimate for blocks of size 2^( 7) =       0.000414420848

      target function =      -0.951027233469
              le_mean =     -17.212201806121
             les_mean =     296.536217130149
             stat err =       0.000411573837
             autocorr =       1.226036404201
   target nu stat err =       0.000411573837
   target dn stat err =       0.001955110817
      target stat err =       0.003503491897
              std dev =       0.525667436373
             le_variance =       0.276326253663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313552390
                                         uncertainty =       0.001738248336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313552390
                                         uncertainty =       0.001738248336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371703009
  error estimate for blocks of size 2^( 2) =       0.000385916279
  error estimate for blocks of size 2^( 3) =       0.000398539673
  error estimate for blocks of size 2^( 4) =       0.000407172727
  error estimate for blocks of size 2^( 5) =       0.000411845197
  error estimate for blocks of size 2^( 6) =       0.000412856575
  error estimate for blocks of size 2^( 7) =       0.000414420848

      target function =      -0.951027233469
              le_mean =     -17.212201806121
             les_mean =     296.536217130149
             stat err =       0.000411573837
             autocorr =       1.226036404201
   target nu stat err =       0.000411573837
   target dn stat err =       0.001955110817
      target stat err =       0.003503491897
              std dev =       0.525667436373
             le_variance =       0.276326253663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313552390
                                         uncertainty =       0.001738248336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313552390
                                         uncertainty =       0.001738248336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371703009
  error estimate for blocks of size 2^( 2) =       0.000385916279
  error estimate for blocks of size 2^( 3) =       0.000398539673
  error estimate for blocks of size 2^( 4) =       0.000407172727
  error estimate for blocks of size 2^( 5) =       0.000411845197
  error estimate for blocks of size 2^( 6) =       0.000412856575
  error estimate for blocks of size 2^( 7) =       0.000414420848

      target function =      -0.951027233469
              le_mean =     -17.212201806121
             les_mean =     296.536217130149
             stat err =       0.000411573837
             autocorr =       1.226036404201
   target nu stat err =       0.000411573837
   target dn stat err =       0.001955110817
      target stat err =       0.003503491897
              std dev =       0.525667436373
             le_variance =       0.276326253663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313552390
                                         uncertainty =       0.001738248336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313552390
                                         uncertainty =       0.001738248336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371703009
  error estimate for blocks of size 2^( 2) =       0.000385916279
  error estimate for blocks of size 2^( 3) =       0.000398539673
  error estimate for blocks of size 2^( 4) =       0.000407172727
  error estimate for blocks of size 2^( 5) =       0.000411845197
  error estimate for blocks of size 2^( 6) =       0.000412856575
  error estimate for blocks of size 2^( 7) =       0.000414420848

      target function =      -0.951027233469
              le_mean =     -17.212201806121
             les_mean =     296.536217130149
             stat err =       0.000411573837
             autocorr =       1.226036404201
   target nu stat err =       0.000411573837
   target dn stat err =       0.001955110817
      target stat err =       0.003503491897
              std dev =       0.525667436373
             le_variance =       0.276326253663


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951027233469        initial  <--
     9.5367e+42     9.5367e+43             0.0000e+00        -0.951027233469
     3.8147e+43     3.8147e+44             0.0000e+00        -0.951027233469
     1.5259e+44     1.5259e+45             0.0000e+00        -0.951027233469

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.7123
  </log>
  <optVariables href="H2O.s058.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0212e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1974
    reference variance = 0.198466
====================================================
  Execution time = 3.7317e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8791e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0031e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287970842272
                                         uncertainty =       0.006448789873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287970842272
                                         uncertainty =       0.006448789873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379416298
  error estimate for blocks of size 2^( 2) =       0.000392798931
  error estimate for blocks of size 2^( 3) =       0.000404974883
  error estimate for blocks of size 2^( 4) =       0.000414492981
  error estimate for blocks of size 2^( 5) =       0.000420054585
  error estimate for blocks of size 2^( 6) =       0.000420299521
  error estimate for blocks of size 2^( 7) =       0.000420032331

      target function =      -0.931068482336
              le_mean =     -17.212011686066
             les_mean =     296.541259591765
             stat err =       0.000418719854
             autocorr =       1.217909852081
   target nu stat err =       0.000418719854
   target dn stat err =       0.006407731683
      target stat err =       0.010769318644
              std dev =       0.536575674481
             le_variance =       0.287913454445


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721201168607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+43, overlap shift 9.5367e+44 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931201414305       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931201414305       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+44, overlap shift 3.8147e+45 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931201414305       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931201414305       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+45, overlap shift 1.5259e+46 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931201414305       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931201414305       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.951968 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7356e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1803
    reference variance = 0.154117
====================================================
  Execution time = 3.6814e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7709e-01
  Total weights = 2.0000e+06
  Execution time = 3.3675e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277105935783
                                         uncertainty =       0.003232507772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277105935783
                                         uncertainty =       0.003232507772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372214190
  error estimate for blocks of size 2^( 2) =       0.000385394598
  error estimate for blocks of size 2^( 3) =       0.000398357007
  error estimate for blocks of size 2^( 4) =       0.000407572482
  error estimate for blocks of size 2^( 5) =       0.000413838896
  error estimate for blocks of size 2^( 6) =       0.000416538866
  error estimate for blocks of size 2^( 7) =       0.000420597599

      target function =      -0.949682570881
              le_mean =     -17.211999736309
             les_mean =     296.530021590081
             stat err =       0.000414636961
             autocorr =       1.240938259696
   target nu stat err =       0.000414636961
   target dn stat err =       0.004092807219
      target stat err =       0.007178484626
              std dev =       0.526390355077
             le_variance =       0.277086805918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277105935783
                                         uncertainty =       0.003232507772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277105935783
                                         uncertainty =       0.003232507772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372214190
  error estimate for blocks of size 2^( 2) =       0.000385394598
  error estimate for blocks of size 2^( 3) =       0.000398357007
  error estimate for blocks of size 2^( 4) =       0.000407572482
  error estimate for blocks of size 2^( 5) =       0.000413838896
  error estimate for blocks of size 2^( 6) =       0.000416538866
  error estimate for blocks of size 2^( 7) =       0.000420597599

      target function =      -0.949682570881
              le_mean =     -17.211999736309
             les_mean =     296.530021590081
             stat err =       0.000414636961
             autocorr =       1.240938259696
   target nu stat err =       0.000414636961
   target dn stat err =       0.004092807219
      target stat err =       0.007178484626
              std dev =       0.526390355077
             le_variance =       0.277086805918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277105935783
                                         uncertainty =       0.003232507772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277105935783
                                         uncertainty =       0.003232507772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372214190
  error estimate for blocks of size 2^( 2) =       0.000385394598
  error estimate for blocks of size 2^( 3) =       0.000398357007
  error estimate for blocks of size 2^( 4) =       0.000407572482
  error estimate for blocks of size 2^( 5) =       0.000413838896
  error estimate for blocks of size 2^( 6) =       0.000416538866
  error estimate for blocks of size 2^( 7) =       0.000420597599

      target function =      -0.949682570881
              le_mean =     -17.211999736309
             les_mean =     296.530021590081
             stat err =       0.000414636961
             autocorr =       1.240938259696
   target nu stat err =       0.000414636961
   target dn stat err =       0.004092807219
      target stat err =       0.007178484626
              std dev =       0.526390355077
             le_variance =       0.277086805918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277105935783
                                         uncertainty =       0.003232507772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277105935783
                                         uncertainty =       0.003232507772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372214190
  error estimate for blocks of size 2^( 2) =       0.000385394598
  error estimate for blocks of size 2^( 3) =       0.000398357007
  error estimate for blocks of size 2^( 4) =       0.000407572482
  error estimate for blocks of size 2^( 5) =       0.000413838896
  error estimate for blocks of size 2^( 6) =       0.000416538866
  error estimate for blocks of size 2^( 7) =       0.000420597599

      target function =      -0.949682570881
              le_mean =     -17.211999736309
             les_mean =     296.530021590081
             stat err =       0.000414636961
             autocorr =       1.240938259696
   target nu stat err =       0.000414636961
   target dn stat err =       0.004092807219
      target stat err =       0.007178484626
              std dev =       0.526390355077
             le_variance =       0.277086805918


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949682570881        initial  <--
     9.5367e+43     9.5367e+44             0.0000e+00        -0.949682570881
     3.8147e+44     3.8147e+45             0.0000e+00        -0.949682570881
     1.5259e+45     1.5259e+46             0.0000e+00        -0.949682570881

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.8465
  </log>
  <optVariables href="H2O.s059.opt.xml">
 uu_0                 1.977359e-01 1 1  ON 0
 uu_1                 4.330421e-02 1 1  ON 1
 uu_2                -4.189153e-02 1 1  ON 2
 uu_3                -9.235418e-02 1 1  ON 3
 uu_4                -1.237595e-01 1 1  ON 4
 uu_5                -1.319003e-01 1 1  ON 5
 uu_6                -1.107254e-01 1 1  ON 6
 uu_7                -4.251128e-02 1 1  ON 7
 uu_8                 8.648501e-02 1 1  ON 8
 uu_9                 1.220595e-01 1 1  ON 9
 ud_0                 3.027506e-01 1 1  ON 10
 ud_1                 7.593987e-02 1 1  ON 11
 ud_2                -1.845255e-02 1 1  ON 12
 ud_3                -6.888169e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357228e-01 1 1  ON 15
 ud_6                -1.369091e-01 1 1  ON 16
 ud_7                -9.605788e-02 1 1  ON 17
 ud_8                 1.390956e-03 1 1  ON 18
 ud_9                 9.066614e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098417e-01 1 1  ON 21
 eO_2                -4.963458e-02 1 1  ON 22
 eO_3                 1.714418e-01 1 1  ON 23
 eO_4                 2.547985e-01 1 1  ON 24
 eO_5                 2.930467e-01 1 1  ON 25
 eO_6                 2.514184e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796091e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.952026e-01 1 1  ON 30
eH1_1                -9.632963e-02 1 1  ON 31
eH1_2                -4.927974e-02 1 1  ON 32
eH1_3                -1.897650e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.420695e-02 1 1  ON 35
eH1_6                 7.670189e-02 1 1  ON 36
eH1_7                 1.107277e-01 1 1  ON 37
eH1_8                 9.201553e-02 1 1  ON 38
eH1_9                 2.427332e-02 1 1  ON 39
eH2_0                -1.961784e-01 1 1  ON 40
eH2_1                -9.716661e-02 1 1  ON 41
eH2_2                -5.029959e-02 1 1  ON 42
eH2_3                -2.014948e-02 1 1  ON 43
eH2_4                 1.553987e-02 1 1  ON 44
eH2_5                 2.428062e-02 1 1  ON 45
eH2_6                 7.650803e-02 1 1  ON 46
eH2_7                 1.129198e-01 1 1  ON 47
eH2_8                 9.607272e-02 1 1  ON 48
eH2_9                 2.646814e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0121e+02 secs
  Total Execution time = 6.1068e+03 secs

=========================================================
  A new xml input file : H2O.s059.cont.xml
