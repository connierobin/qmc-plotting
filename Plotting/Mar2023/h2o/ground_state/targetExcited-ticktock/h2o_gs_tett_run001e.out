Rank =    0  Free Memory = 73263 MB
Rank =    1  Free Memory = 73262 MB
Rank =    2  Free Memory = 73261 MB
Rank =    3  Free Memory = 73261 MB
Rank =    4  Free Memory = 73261 MB
Rank =    5  Free Memory = 73261 MB
Rank =    6  Free Memory = 73261 MB
Rank =    7  Free Memory = 73260 MB
Rank =    8  Free Memory = 73260 MB
Rank =    9  Free Memory = 73260 MB
Rank =   10  Free Memory = 73260 MB
Rank =   11  Free Memory = 73260 MB
Rank =   12  Free Memory = 73260 MB
Rank =   13  Free Memory = 73260 MB
Rank =   14  Free Memory = 73259 MB
Rank =   15  Free Memory = 73247 MB
Rank =   16  Free Memory = 73246 MB
Rank =   17  Free Memory = 73246 MB
Rank =   18  Free Memory = 73246 MB
Rank =   19  Free Memory = 73246 MB
Rank =   20  Free Memory = 73246 MB
Rank =   21  Free Memory = 73246 MB
Rank =   22  Free Memory = 73246 MB
Rank =   23  Free Memory = 73246 MB
Rank =   24  Free Memory = 73246 MB
Rank =   25  Free Memory = 73246 MB
Rank =   26  Free Memory = 73246 MB
Rank =   27  Free Memory = 73246 MB
Rank =   28  Free Memory = 73246 MB
Rank =   29  Free Memory = 73246 MB
Rank =   30  Free Memory = 73246 MB
Rank =   31  Free Memory = 73246 MB
Rank =   32  Free Memory = 73218 MB
Rank =   33  Free Memory = 73218 MB
Rank =   34  Free Memory = 73218 MB
Rank =   35  Free Memory = 73218 MB
Rank =   36  Free Memory = 73218 MB
Rank =   37  Free Memory = 73218 MB
Rank =   38  Free Memory = 73218 MB
Rank =   39  Free Memory = 73218 MB
Rank =   40  Free Memory = 73218 MB
Rank =   41  Free Memory = 73217 MB
Rank =   42  Free Memory = 73217 MB
Rank =   43  Free Memory = 73217 MB
Rank =   44  Free Memory = 73217 MB
Rank =   45  Free Memory = 73217 MB
Rank =   46  Free Memory = 73217 MB
Rank =   47  Free Memory = 73217 MB
Rank =   48  Free Memory = 73217 MB
Rank =   49  Free Memory = 73217 MB
Rank =   50  Free Memory = 73217 MB
Rank =   51  Free Memory = 73217 MB
Rank =   52  Free Memory = 73217 MB
Rank =   53  Free Memory = 73217 MB
Rank =   54  Free Memory = 73217 MB
Rank =   55  Free Memory = 73217 MB
Rank =   56  Free Memory = 73217 MB
Rank =   57  Free Memory = 73217 MB
Rank =   58  Free Memory = 73217 MB
Rank =   59  Free Memory = 73217 MB
Rank =   60  Free Memory = 73217 MB
Rank =   61  Free Memory = 73217 MB
Rank =   62  Free Memory = 73217 MB
Rank =   63  Free Memory = 73217 MB
Rank =   64  Free Memory = 89081 MB
Rank =   65  Free Memory = 89081 MB
Rank =   66  Free Memory = 89081 MB
Rank =   67  Free Memory = 89081 MB
Rank =   68  Free Memory = 89081 MB
Rank =   69  Free Memory = 89081 MB
Rank =   70  Free Memory = 89081 MB
Rank =   71  Free Memory = 89081 MB
Rank =   72  Free Memory = 89081 MB
Rank =   73  Free Memory = 89081 MB
Rank =   74  Free Memory = 89081 MB
Rank =   75  Free Memory = 89081 MB
Rank =   76  Free Memory = 89081 MB
Rank =   77  Free Memory = 89081 MB
Rank =   78  Free Memory = 89081 MB
Rank =   79  Free Memory = 89081 MB
Rank =   80  Free Memory = 89081 MB
Rank =   81  Free Memory = 89081 MB
Rank =   82  Free Memory = 89081 MB
Rank =   83  Free Memory = 89081 MB
Rank =   84  Free Memory = 89081 MB
Rank =   85  Free Memory = 89081 MB
Rank =   86  Free Memory = 89081 MB
Rank =   87  Free Memory = 89081 MB
Rank =   88  Free Memory = 89081 MB
Rank =   89  Free Memory = 89081 MB
Rank =   90  Free Memory = 89081 MB
Rank =   91  Free Memory = 89081 MB
Rank =   92  Free Memory = 89081 MB
Rank =   93  Free Memory = 89081 MB
Rank =   94  Free Memory = 89081 MB
Rank =   95  Free Memory = 89081 MB
Rank =   96  Free Memory = 75605 MB
Rank =   97  Free Memory = 75605 MB
Rank =   98  Free Memory = 75605 MB
Rank =   99  Free Memory = 75605 MB
Rank =  100  Free Memory = 75605 MB
Rank =  101  Free Memory = 75605 MB
Rank =  102  Free Memory = 75605 MB
Rank =  103  Free Memory = 75605 MB
Rank =  104  Free Memory = 75605 MB
Rank =  105  Free Memory = 75605 MB
Rank =  106  Free Memory = 75605 MB
Rank =  107  Free Memory = 75605 MB
Rank =  108  Free Memory = 75605 MB
Rank =  109  Free Memory = 75605 MB
Rank =  110  Free Memory = 75605 MB
Rank =  111  Free Memory = 75605 MB
Rank =  112  Free Memory = 75605 MB
Rank =  113  Free Memory = 75605 MB
Rank =  114  Free Memory = 75605 MB
Rank =  115  Free Memory = 75605 MB
Rank =  116  Free Memory = 75605 MB
Rank =  117  Free Memory = 75605 MB
Rank =  118  Free Memory = 75605 MB
Rank =  119  Free Memory = 75605 MB
Rank =  120  Free Memory = 75605 MB
Rank =  121  Free Memory = 75605 MB
Rank =  122  Free Memory = 75605 MB
Rank =  123  Free Memory = 75605 MB
Rank =  124  Free Memory = 75605 MB
Rank =  125  Free Memory = 75605 MB
Rank =  126  Free Memory = 75605 MB
Rank =  127  Free Memory = 75605 MB
  Input file(s): opt_h2o_gs_tett_run001e.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_tett_run001e.xml

  Project = H2O
  date    = 2023-03-08 16:59:39 PST
  host    = n0082.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 891

  Range of prime numbers to use as seeds over processors and threads = 6959-8117


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.977335e-01    1         1 OFF
     uu_1                 4.330275e-02    1         1 OFF
     uu_2                -4.189267e-02    1         1 OFF
     uu_3                -9.235608e-02    1         1 OFF
     uu_4                -1.237610e-01    1         1 OFF
     uu_5                -1.319011e-01    1         1 OFF
     uu_6                -1.107245e-01    1         1 OFF
     uu_7                -4.250637e-02    1         1 OFF
     uu_8                 8.649074e-02    1         1 OFF
     uu_9                 1.220586e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.027539e-01    1         1 OFF
     ud_1                 7.594091e-02    1         1 OFF
     ud_2                -1.844949e-02    1         1 OFF
     ud_3                -6.887856e-02    1         1 OFF
     ud_4                -1.085322e-01    1         1 OFF
     ud_5                -1.357271e-01    1         1 OFF
     ud_6                -1.369140e-01    1         1 OFF
     ud_7                -9.606118e-02    1         1 OFF
     ud_8                 1.393232e-03    1         1 OFF
     ud_9                 9.066699e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.845925e-01    1         1 OFF
     eO_1                -4.098450e-01    1         1 OFF
     eO_2                -4.963899e-02    1         1 OFF
     eO_3                 1.714430e-01    1         1 OFF
     eO_4                 2.548074e-01    1         1 OFF
     eO_5                 2.930546e-01    1         1 OFF
     eO_6                 2.514179e-01    1         1 OFF
     eO_7                 1.164920e-01    1         1 OFF
     eO_8                 2.796077e-02    1         1 OFF
     eO_9                 1.837741e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.951983e-01    1         1 OFF
     eH1_1                -9.632854e-02    1         1 OFF
     eH1_2                -4.928336e-02    1         1 OFF
     eH1_3                -1.897920e-02    1         1 OFF
     eH1_4                 1.663156e-02    1         1 OFF
     eH1_5                 2.420856e-02    1         1 OFF
     eH1_6                 7.670269e-02    1         1 OFF
     eH1_7                 1.107286e-01    1         1 OFF
     eH1_8                 9.201372e-02    1         1 OFF
     eH1_9                 2.427304e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.961719e-01    1         1 OFF
     eH2_1                -9.716667e-02    1         1 OFF
     eH2_2                -5.030255e-02    1         1 OFF
     eH2_3                -2.015281e-02    1         1 OFF
     eH2_4                 1.553497e-02    1         1 OFF
     eH2_5                 2.428197e-02    1         1 OFF
     eH2_6                 7.651160e-02    1         1 OFF
     eH2_7                 1.129216e-01    1         1 OFF
     eH2_8                 9.607113e-02    1         1 OFF
     eH2_9                 2.646776e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.698206e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.9963e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2033
    reference variance = 0.244814
====================================================
  Execution time = 1.5290e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7624e-01
  Total weights = 1.957631781e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266900598110
                                         uncertainty =       0.001933871230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266900598110
                                         uncertainty =       0.001933871230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365291653
  error estimate for blocks of size 2^( 2) =       0.000379315604
  error estimate for blocks of size 2^( 3) =       0.000392345839
  error estimate for blocks of size 2^( 4) =       0.000401643732
  error estimate for blocks of size 2^( 5) =       0.000407861075
  error estimate for blocks of size 2^( 6) =       0.000410013385
  error estimate for blocks of size 2^( 7) =       0.000411458131

      target function =      -0.951122781379
              le_mean =     -17.211877004882
             les_mean =     296.524952062542
             stat err =       0.000407744081
             autocorr =       1.245936280860
   target nu stat err =       0.000407744081
   target dn stat err =       0.002171655796
      target stat err =       0.003736570688
              std dev =       0.516600410038
             le_variance =       0.266875983651


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721187700488e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951136510908       residual = 7.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951221823461       residual = 5.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951230766414       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951234395229       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951234180891       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951234114338       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951234149858       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951234076940       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951234102030       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951234119670       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 3.713859e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951136510908       residual = 7.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951162677133       residual = 5.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951165326951       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951166326502       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951166259322       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951166232626       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951166244615       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951166225101       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951166231523       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951166235964       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.141383e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951136510908       residual = 7.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951143445703       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951144140110       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951144395856       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951144378011       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951144370492       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951144373725       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951144368784       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951144370391       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951144371494       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.026914e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006677 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7846e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001 -4.143744e-02                3 1 ON  0
ci_002 -3.160954e-02                3 1 ON  1
ci_003 -2.612885e-02                3 1 ON  2
ci_004 2.365269e-02                 3 1 ON  3
ci_005 2.381949e-02                 3 1 ON  4
ci_006 -2.093609e-02                3 1 ON  5
ci_007 -2.043380e-02                3 1 ON  6
ci_008 -8.580061e-03                3 1 ON  7
ci_009 -1.430254e-02                3 1 ON  8
ci_010 -9.616032e-03                3 1 ON  9
ci_011 -1.060769e-02                3 1 ON  10
ci_012 -9.777134e-03                3 1 ON  11
ci_013 -1.994495e-02                3 1 ON  12
ci_014 1.252378e-02                 3 1 ON  13
ci_015 1.260019e-02                 3 1 ON  14
ci_016 1.707174e-02                 3 1 ON  15
ci_017 1.627463e-02                 3 1 ON  16
ci_018 9.882813e-03                 3 1 ON  17
ci_019 1.003680e-02                 3 1 ON  18
ci_020 1.718288e-02                 3 1 ON  19
ci_021 1.703614e-02                 3 1 ON  20
ci_022 9.265112e-03                 3 1 ON  21
ci_023 9.509257e-03                 3 1 ON  22
ci_024 9.713785e-03                 3 1 ON  23
ci_025 9.454042e-03                 3 1 ON  24
ci_026 1.113934e-02                 3 1 ON  25
ci_027 1.153457e-02                 3 1 ON  26
ci_028 -1.492721e-02                3 1 ON  27
ci_029 -1.549517e-02                3 1 ON  28
ci_030 -9.404123e-03                3 1 ON  29
ci_031 -8.987418e-03                3 1 ON  30
ci_032 -1.484432e-02                3 1 ON  31
ci_033 5.756206e-03                 3 1 ON  32
ci_034 5.625064e-03                 3 1 ON  33
ci_035 -5.032102e-03                3 1 ON  34
ci_036 -1.254078e-02                3 1 ON  35
ci_037 -1.253156e-02                3 1 ON  36
ci_038 1.750001e-03                 3 1 ON  37
ci_039 1.734547e-03                 3 1 ON  38
ci_040 -3.031274e-03                3 1 ON  39
ci_041 8.797048e-03                 3 1 ON  40
ci_042 8.879406e-03                 3 1 ON  41
ci_043 -4.004493e-03                3 1 ON  42
ci_044 -4.108370e-03                3 1 ON  43
ci_045 -3.222114e-03                3 1 ON  44
ci_046 5.718441e-03                 3 1 ON  45
ci_047 5.611270e-03                 3 1 ON  46
ci_048 -1.256498e-02                3 1 ON  47
ci_049 -1.366923e-02                3 1 ON  48
ci_050 3.421247e-03                 3 1 ON  49
ci_051 3.236771e-03                 3 1 ON  50
ci_052 -2.281085e-03                3 1 ON  51
ci_053 -2.504001e-03                3 1 ON  52
ci_054 -2.879638e-03                3 1 ON  53
ci_055 -2.928934e-03                3 1 ON  54
ci_056 5.325455e-03                 3 1 ON  55
ci_057 5.160856e-03                 3 1 ON  56
ci_058 -1.808157e-03                3 1 ON  57
ci_059 -1.980222e-03                3 1 ON  58
ci_060 4.925640e-03                 3 1 ON  59
ci_061 5.552915e-03                 3 1 ON  60
ci_062 -3.579537e-03                3 1 ON  61
ci_063 -4.065500e-03                3 1 ON  62
ci_064 -3.030242e-03                3 1 ON  63
ci_065 -4.348836e-03                3 1 ON  64
ci_066 4.492785e-03                 3 1 ON  65
ci_067 4.325322e-03                 3 1 ON  66
ci_068 -4.346047e-03                3 1 ON  67
ci_069 -4.793319e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1835
    reference variance = 0.237913
====================================================
  Execution time = 1.3565e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7915e-01
  Total weights = 1.9574e+06
  Execution time = 1.8608e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268768289315
                                         uncertainty =       0.001515530932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268768289315
                                         uncertainty =       0.001515530932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366550330
  error estimate for blocks of size 2^( 2) =       0.000380483118
  error estimate for blocks of size 2^( 3) =       0.000393172344
  error estimate for blocks of size 2^( 4) =       0.000401842187
  error estimate for blocks of size 2^( 5) =       0.000406378849
  error estimate for blocks of size 2^( 6) =       0.000410165070
  error estimate for blocks of size 2^( 7) =       0.000414145796

      target function =      -0.946161673296
              le_mean =     -17.212134563336
             les_mean =     296.536778689289
             stat err =       0.000408132975
             autocorr =       1.239755775015
   target nu stat err =       0.000408132975
   target dn stat err =       0.001871547978
      target stat err =       0.003209857096
              std dev =       0.518380448431
             le_variance =       0.268718289316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268776837282
                                         uncertainty =       0.001518147242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268776837282
                                         uncertainty =       0.001518147242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366556188
  error estimate for blocks of size 2^( 2) =       0.000380476825
  error estimate for blocks of size 2^( 3) =       0.000393152636
  error estimate for blocks of size 2^( 4) =       0.000401805565
  error estimate for blocks of size 2^( 5) =       0.000406337267
  error estimate for blocks of size 2^( 6) =       0.000410128561
  error estimate for blocks of size 2^( 7) =       0.000414098253

      target function =      -0.942446571415
              le_mean =     -17.212134191116
             les_mean =     296.538993087727
             stat err =       0.000408092412
             autocorr =       1.239469735328
   target nu stat err =       0.000408092412
   target dn stat err =       0.002464064658
      target stat err =       0.004148469021
              std dev =       0.518388732774
             le_variance =       0.268726878267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268768822150
                                         uncertainty =       0.001517100151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268768822150
                                         uncertainty =       0.001517100151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366550714
  error estimate for blocks of size 2^( 2) =       0.000380476028
  error estimate for blocks of size 2^( 3) =       0.000393156836
  error estimate for blocks of size 2^( 4) =       0.000401816829
  error estimate for blocks of size 2^( 5) =       0.000406351298
  error estimate for blocks of size 2^( 6) =       0.000410140623
  error estimate for blocks of size 2^( 7) =       0.000414113194

      target function =      -0.945576461606
              le_mean =     -17.212133600973
             les_mean =     296.537095751239
             stat err =       0.000408105486
             autocorr =       1.239586180397
   target nu stat err =       0.000408105486
   target dn stat err =       0.001898667094
      target stat err =       0.003250097449
              std dev =       0.518380991160
             le_variance =       0.268718851996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268767565376
                                         uncertainty =       0.001515731604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268767565376
                                         uncertainty =       0.001515731604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366549840
  error estimate for blocks of size 2^( 2) =       0.000380481643
  error estimate for blocks of size 2^( 3) =       0.000393169733
  error estimate for blocks of size 2^( 4) =       0.000401838260
  error estimate for blocks of size 2^( 5) =       0.000406374632
  error estimate for blocks of size 2^( 6) =       0.000410161316
  error estimate for blocks of size 2^( 7) =       0.000414140942

      target function =      -0.946212479738
              le_mean =     -17.212134337675
             les_mean =     296.536740523687
             stat err =       0.000408128787
             autocorr =       1.239733652769
   target nu stat err =       0.000408128787
   target dn stat err =       0.001870836470
      target stat err =       0.003209031238
              std dev =       0.518379754405
             le_variance =       0.268717569777


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946161673296        initial
     2.5000e-01     2.5000e+00             3.7139e-04        -0.942446571415
     1.0000e+00     1.0000e+01             1.1414e-04        -0.945576461606
     4.0000e+00     4.0000e+01             3.0269e-05        -0.946212479738  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 2.2958e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001                -4.145614e-02 3 1  ON 0
ci_002                -3.160049e-02 3 1  ON 1
ci_003                -2.618068e-02 3 1  ON 2
ci_004                 2.367470e-02 3 1  ON 3
ci_005                 2.383948e-02 3 1  ON 4
ci_006                -2.093001e-02 3 1  ON 5
ci_007                -2.043887e-02 3 1  ON 6
ci_008                -8.588497e-03 3 1  ON 7
ci_009                -1.432058e-02 3 1  ON 8
ci_010                -9.616759e-03 3 1  ON 9
ci_011                -1.061629e-02 3 1  ON 10
ci_012                -9.805947e-03 3 1  ON 11
ci_013                -1.993969e-02 3 1  ON 12
ci_014                 1.256665e-02 3 1  ON 13
ci_015                 1.254455e-02 3 1  ON 14
ci_016                 1.712442e-02 3 1  ON 15
ci_017                 1.630224e-02 3 1  ON 16
ci_018                 9.871165e-03 3 1  ON 17
ci_019                 1.002135e-02 3 1  ON 18
ci_020                 1.717819e-02 3 1  ON 19
ci_021                 1.702260e-02 3 1  ON 20
ci_022                 9.214116e-03 3 1  ON 21
ci_023                 9.458321e-03 3 1  ON 22
ci_024                 9.656934e-03 3 1  ON 23
ci_025                 9.444053e-03 3 1  ON 24
ci_026                 1.109999e-02 3 1  ON 25
ci_027                 1.154297e-02 3 1  ON 26
ci_028                -1.496141e-02 3 1  ON 27
ci_029                -1.551744e-02 3 1  ON 28
ci_030                -9.421406e-03 3 1  ON 29
ci_031                -9.009940e-03 3 1  ON 30
ci_032                -1.485657e-02 3 1  ON 31
ci_033                 5.727805e-03 3 1  ON 32
ci_034                 5.613658e-03 3 1  ON 33
ci_035                -5.045917e-03 3 1  ON 34
ci_036                -1.253241e-02 3 1  ON 35
ci_037                -1.251118e-02 3 1  ON 36
ci_038                 1.758918e-03 3 1  ON 37
ci_039                 1.726113e-03 3 1  ON 38
ci_040                -3.026553e-03 3 1  ON 39
ci_041                 8.797981e-03 3 1  ON 40
ci_042                 8.885678e-03 3 1  ON 41
ci_043                -4.005296e-03 3 1  ON 42
ci_044                -4.082173e-03 3 1  ON 43
ci_045                -3.229167e-03 3 1  ON 44
ci_046                 5.726405e-03 3 1  ON 45
ci_047                 5.620043e-03 3 1  ON 46
ci_048                -1.252052e-02 3 1  ON 47
ci_049                -1.364935e-02 3 1  ON 48
ci_050                 3.420760e-03 3 1  ON 49
ci_051                 3.230061e-03 3 1  ON 50
ci_052                -2.268020e-03 3 1  ON 51
ci_053                -2.435300e-03 3 1  ON 52
ci_054                -2.892817e-03 3 1  ON 53
ci_055                -2.923340e-03 3 1  ON 54
ci_056                 5.322598e-03 3 1  ON 55
ci_057                 5.153011e-03 3 1  ON 56
ci_058                -1.724288e-03 3 1  ON 57
ci_059                -1.989739e-03 3 1  ON 58
ci_060                 4.934719e-03 3 1  ON 59
ci_061                 5.534266e-03 3 1  ON 60
ci_062                -3.591334e-03 3 1  ON 61
ci_063                -4.102543e-03 3 1  ON 62
ci_064                -3.019347e-03 3 1  ON 63
ci_065                -4.342332e-03 3 1  ON 64
ci_066                 4.503385e-03 3 1  ON 65
ci_067                 4.318021e-03 3 1  ON 66
ci_068                -4.333756e-03 3 1  ON 67
ci_069                -4.827779e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0811e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2686
    reference variance = 0.176805
====================================================
  Execution time = 1.4007e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7932e-01
  Total weights = 1.957083624e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5061e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267950945174
                                         uncertainty =       0.002599520433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267950945174
                                         uncertainty =       0.002599520433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366043832
  error estimate for blocks of size 2^( 2) =       0.000379940270
  error estimate for blocks of size 2^( 3) =       0.000393185138
  error estimate for blocks of size 2^( 4) =       0.000402675542
  error estimate for blocks of size 2^( 5) =       0.000406790002
  error estimate for blocks of size 2^( 6) =       0.000409731409
  error estimate for blocks of size 2^( 7) =       0.000410628633

      target function =      -0.945920324899
              le_mean =     -17.211749375849
             les_mean =     296.523637874074
             stat err =       0.000407456397
             autocorr =       1.239070714859
   target nu stat err =       0.000407456397
   target dn stat err =       0.003870619156
      target stat err =       0.006501002024
              std dev =       0.517664152300
             le_variance =       0.267976174576


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721174937585e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945963619711       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946058923718       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946071029706       residual = 7.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946074135817       residual = 9.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946074234504       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946074242476       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946074309133       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946074354351       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946074353124       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946074354548       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.630377e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945963619711       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945988847656       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945992010227       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945992810466       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945992833694       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945992835035       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945992851913       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945992863217       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945992862884       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945992863246       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 6.935652e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945963619711       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945970020849       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945970820448       residual = 7.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945971022020       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945971027725       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945971028015       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945971032247       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945971035072       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945971034987       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945971035078       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.757957e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010349 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6523e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -4.146191e-02 3 1  ON 0
ci_002                -3.157679e-02 3 1  ON 1
ci_003                -2.615704e-02 3 1  ON 2
ci_004                 2.365781e-02 3 1  ON 3
ci_005                 2.383561e-02 3 1  ON 4
ci_006                -2.093808e-02 3 1  ON 5
ci_007                -2.044189e-02 3 1  ON 6
ci_008                -8.584744e-03 3 1  ON 7
ci_009                -1.433837e-02 3 1  ON 8
ci_010                -9.626461e-03 3 1  ON 9
ci_011                -1.058802e-02 3 1  ON 10
ci_012                -9.815093e-03 3 1  ON 11
ci_013                -1.994985e-02 3 1  ON 12
ci_014                 1.257831e-02 3 1  ON 13
ci_015                 1.253878e-02 3 1  ON 14
ci_016                 1.708257e-02 3 1  ON 15
ci_017                 1.630535e-02 3 1  ON 16
ci_018                 9.896192e-03 3 1  ON 17
ci_019                 1.003880e-02 3 1  ON 18
ci_020                 1.718194e-02 3 1  ON 19
ci_021                 1.703134e-02 3 1  ON 20
ci_022                 9.236416e-03 3 1  ON 21
ci_023                 9.475510e-03 3 1  ON 22
ci_024                 9.642357e-03 3 1  ON 23
ci_025                 9.411009e-03 3 1  ON 24
ci_026                 1.111846e-02 3 1  ON 25
ci_027                 1.153204e-02 3 1  ON 26
ci_028                -1.495898e-02 3 1  ON 27
ci_029                -1.550600e-02 3 1  ON 28
ci_030                -9.396496e-03 3 1  ON 29
ci_031                -9.003252e-03 3 1  ON 30
ci_032                -1.487033e-02 3 1  ON 31
ci_033                 5.658449e-03 3 1  ON 32
ci_034                 5.604413e-03 3 1  ON 33
ci_035                -5.050190e-03 3 1  ON 34
ci_036                -1.254768e-02 3 1  ON 35
ci_037                -1.251289e-02 3 1  ON 36
ci_038                 1.755204e-03 3 1  ON 37
ci_039                 1.734794e-03 3 1  ON 38
ci_040                -3.031643e-03 3 1  ON 39
ci_041                 8.801440e-03 3 1  ON 40
ci_042                 8.874606e-03 3 1  ON 41
ci_043                -4.003041e-03 3 1  ON 42
ci_044                -4.131164e-03 3 1  ON 43
ci_045                -3.219965e-03 3 1  ON 44
ci_046                 5.734077e-03 3 1  ON 45
ci_047                 5.620693e-03 3 1  ON 46
ci_048                -1.253164e-02 3 1  ON 47
ci_049                -1.363726e-02 3 1  ON 48
ci_050                 3.420086e-03 3 1  ON 49
ci_051                 3.222313e-03 3 1  ON 50
ci_052                -2.291313e-03 3 1  ON 51
ci_053                -2.441268e-03 3 1  ON 52
ci_054                -2.886278e-03 3 1  ON 53
ci_055                -2.921933e-03 3 1  ON 54
ci_056                 5.316723e-03 3 1  ON 55
ci_057                 5.154384e-03 3 1  ON 56
ci_058                -1.718917e-03 3 1  ON 57
ci_059                -2.002018e-03 3 1  ON 58
ci_060                 4.881498e-03 3 1  ON 59
ci_061                 5.552323e-03 3 1  ON 60
ci_062                -3.598002e-03 3 1  ON 61
ci_063                -4.104327e-03 3 1  ON 62
ci_064                -3.013258e-03 3 1  ON 63
ci_065                -4.340027e-03 3 1  ON 64
ci_066                 4.467870e-03 3 1  ON 65
ci_067                 4.311308e-03 3 1  ON 66
ci_068                -4.305354e-03 3 1  ON 67
ci_069                -4.821277e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1536
    reference variance = 0.246443
====================================================
  Execution time = 1.3651e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8079e-01
  Total weights = 1.9573e+06
  Execution time = 1.8515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268489033404
                                         uncertainty =       0.001681220694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268489033404
                                         uncertainty =       0.001681220694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366348858
  error estimate for blocks of size 2^( 2) =       0.000380285595
  error estimate for blocks of size 2^( 3) =       0.000393132088
  error estimate for blocks of size 2^( 4) =       0.000403679567
  error estimate for blocks of size 2^( 5) =       0.000408178257
  error estimate for blocks of size 2^( 6) =       0.000411769841
  error estimate for blocks of size 2^( 7) =       0.000411982951

      target function =      -0.943150112852
              le_mean =     -17.212182843904
             les_mean =     296.540244223563
             stat err =       0.000408902654
             autocorr =       1.245805300790
   target nu stat err =       0.000408902654
   target dn stat err =       0.002491977261
      target stat err =       0.004200862386
              std dev =       0.518095523587
             le_variance =       0.268422971561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268455362502
                                         uncertainty =       0.001672572271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268455362502
                                         uncertainty =       0.001672572271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366325921
  error estimate for blocks of size 2^( 2) =       0.000380265611
  error estimate for blocks of size 2^( 3) =       0.000393113486
  error estimate for blocks of size 2^( 4) =       0.000403660829
  error estimate for blocks of size 2^( 5) =       0.000408160383
  error estimate for blocks of size 2^( 6) =       0.000411752545
  error estimate for blocks of size 2^( 7) =       0.000411969222

      target function =      -0.943471082519
              le_mean =     -17.212183541191
             les_mean =     296.540075282801
             stat err =       0.000408885745
             autocorr =       1.245858266297
   target nu stat err =       0.000408885745
   target dn stat err =       0.002463494679
      target stat err =       0.004157050291
              std dev =       0.518063086349
             le_variance =       0.268389361438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268469591787
                                         uncertainty =       0.001676632719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268469591787
                                         uncertainty =       0.001676632719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366335613
  error estimate for blocks of size 2^( 2) =       0.000380273921
  error estimate for blocks of size 2^( 3) =       0.000393121166
  error estimate for blocks of size 2^( 4) =       0.000403668595
  error estimate for blocks of size 2^( 5) =       0.000408167734
  error estimate for blocks of size 2^( 6) =       0.000411759656
  error estimate for blocks of size 2^( 7) =       0.000411974729

      target function =      -0.943534625609
              le_mean =     -17.212183018822
             les_mean =     296.540018992454
             stat err =       0.000408892678
             autocorr =       1.245834596815
   target nu stat err =       0.000408892678
   target dn stat err =       0.002471300600
      target stat err =       0.004170379534
              std dev =       0.518076792587
             le_variance =       0.268403563017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268486353126
                                         uncertainty =       0.001680634481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268486353126
                                         uncertainty =       0.001680634481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366347032
  error estimate for blocks of size 2^( 2) =       0.000380283973
  error estimate for blocks of size 2^( 3) =       0.000393130569
  error estimate for blocks of size 2^( 4) =       0.000403678044
  error estimate for blocks of size 2^( 5) =       0.000408176792
  error estimate for blocks of size 2^( 6) =       0.000411768410
  error estimate for blocks of size 2^( 7) =       0.000411981783

      target function =      -0.943315811561
              le_mean =     -17.212182832028
             les_mean =     296.540144108580
             stat err =       0.000408901257
             autocorr =       1.245809210514
   target nu stat err =       0.000408901257
   target dn stat err =       0.002486243699
      target stat err =       0.004192931597
              std dev =       0.518092941083
             le_variance =       0.268420295600


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943150112852        initial
     1.0000e+00     1.0000e+01             2.6304e-04        -0.943471082519
     4.0000e+00     4.0000e+01             6.9357e-05        -0.943534625609  <--
     1.6000e+01     1.6000e+02             1.7580e-05        -0.943315811561

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 2.6923e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -4.146191e-02 3 1  ON 0
ci_002                -3.157679e-02 3 1  ON 1
ci_003                -2.615704e-02 3 1  ON 2
ci_004                 2.365781e-02 3 1  ON 3
ci_005                 2.383561e-02 3 1  ON 4
ci_006                -2.093808e-02 3 1  ON 5
ci_007                -2.044189e-02 3 1  ON 6
ci_008                -8.584744e-03 3 1  ON 7
ci_009                -1.433837e-02 3 1  ON 8
ci_010                -9.626461e-03 3 1  ON 9
ci_011                -1.058802e-02 3 1  ON 10
ci_012                -9.815093e-03 3 1  ON 11
ci_013                -1.994985e-02 3 1  ON 12
ci_014                 1.257831e-02 3 1  ON 13
ci_015                 1.253878e-02 3 1  ON 14
ci_016                 1.708257e-02 3 1  ON 15
ci_017                 1.630535e-02 3 1  ON 16
ci_018                 9.896192e-03 3 1  ON 17
ci_019                 1.003880e-02 3 1  ON 18
ci_020                 1.718194e-02 3 1  ON 19
ci_021                 1.703134e-02 3 1  ON 20
ci_022                 9.236416e-03 3 1  ON 21
ci_023                 9.475510e-03 3 1  ON 22
ci_024                 9.642357e-03 3 1  ON 23
ci_025                 9.411009e-03 3 1  ON 24
ci_026                 1.111846e-02 3 1  ON 25
ci_027                 1.153204e-02 3 1  ON 26
ci_028                -1.495898e-02 3 1  ON 27
ci_029                -1.550600e-02 3 1  ON 28
ci_030                -9.396496e-03 3 1  ON 29
ci_031                -9.003252e-03 3 1  ON 30
ci_032                -1.487033e-02 3 1  ON 31
ci_033                 5.658449e-03 3 1  ON 32
ci_034                 5.604413e-03 3 1  ON 33
ci_035                -5.050190e-03 3 1  ON 34
ci_036                -1.254768e-02 3 1  ON 35
ci_037                -1.251289e-02 3 1  ON 36
ci_038                 1.755204e-03 3 1  ON 37
ci_039                 1.734794e-03 3 1  ON 38
ci_040                -3.031643e-03 3 1  ON 39
ci_041                 8.801440e-03 3 1  ON 40
ci_042                 8.874606e-03 3 1  ON 41
ci_043                -4.003041e-03 3 1  ON 42
ci_044                -4.131164e-03 3 1  ON 43
ci_045                -3.219965e-03 3 1  ON 44
ci_046                 5.734077e-03 3 1  ON 45
ci_047                 5.620693e-03 3 1  ON 46
ci_048                -1.253164e-02 3 1  ON 47
ci_049                -1.363726e-02 3 1  ON 48
ci_050                 3.420086e-03 3 1  ON 49
ci_051                 3.222313e-03 3 1  ON 50
ci_052                -2.291313e-03 3 1  ON 51
ci_053                -2.441268e-03 3 1  ON 52
ci_054                -2.886278e-03 3 1  ON 53
ci_055                -2.921933e-03 3 1  ON 54
ci_056                 5.316723e-03 3 1  ON 55
ci_057                 5.154384e-03 3 1  ON 56
ci_058                -1.718917e-03 3 1  ON 57
ci_059                -2.002018e-03 3 1  ON 58
ci_060                 4.881498e-03 3 1  ON 59
ci_061                 5.552323e-03 3 1  ON 60
ci_062                -3.598002e-03 3 1  ON 61
ci_063                -4.104327e-03 3 1  ON 62
ci_064                -3.013258e-03 3 1  ON 63
ci_065                -4.340027e-03 3 1  ON 64
ci_066                 4.467870e-03 3 1  ON 65
ci_067                 4.311308e-03 3 1  ON 66
ci_068                -4.305354e-03 3 1  ON 67
ci_069                -4.821277e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3475e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1575
    reference variance = 0.450867
====================================================
  Execution time = 1.4945e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7564e-01
  Total weights = 1.957216473e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.4063e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265636186246
                                         uncertainty =       0.001509430630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265636186246
                                         uncertainty =       0.001509430630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364409989
  error estimate for blocks of size 2^( 2) =       0.000378789930
  error estimate for blocks of size 2^( 3) =       0.000391760842
  error estimate for blocks of size 2^( 4) =       0.000400986110
  error estimate for blocks of size 2^( 5) =       0.000406944828
  error estimate for blocks of size 2^( 6) =       0.000408981667
  error estimate for blocks of size 2^( 7) =       0.000409339353

      target function =      -0.952176214570
              le_mean =     -17.212694760368
             les_mean =     296.552499680947
             stat err =       0.000406562989
             autocorr =       1.244729940989
   target nu stat err =       0.000406562989
   target dn stat err =       0.001734942630
      target stat err =       0.003027316323
              std dev =       0.515353548489
             le_variance =       0.265589279941


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721269476037e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952184724067       residual = 7.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952214688231       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952219040810       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952220418886       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952220811512       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952220889746       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952220931711       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952220945288       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952220955877       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952220954328       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 9.768409e-05

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952184724067       residual = 7.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952192665007       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952193802446       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952194155519       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952194255799       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952194275644       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952194286275       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952194289624       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952194292269       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952194291878       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 2.554761e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952184724067       residual = 7.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952186739563       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952187027170       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952187115971       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952187141173       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952187146152       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952187148818       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952187149651       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952187150312       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952187150214       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 6.461416e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.014059 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8360e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -4.144888e-02 3 1  ON 0
ci_002                -3.156545e-02 3 1  ON 1
ci_003                -2.614624e-02 3 1  ON 2
ci_004                 2.366564e-02 3 1  ON 3
ci_005                 2.382093e-02 3 1  ON 4
ci_006                -2.093240e-02 3 1  ON 5
ci_007                -2.044615e-02 3 1  ON 6
ci_008                -8.586787e-03 3 1  ON 7
ci_009                -1.435894e-02 3 1  ON 8
ci_010                -9.611738e-03 3 1  ON 9
ci_011                -1.057913e-02 3 1  ON 10
ci_012                -9.829561e-03 3 1  ON 11
ci_013                -1.996540e-02 3 1  ON 12
ci_014                 1.257501e-02 3 1  ON 13
ci_015                 1.254010e-02 3 1  ON 14
ci_016                 1.707408e-02 3 1  ON 15
ci_017                 1.633090e-02 3 1  ON 16
ci_018                 9.915008e-03 3 1  ON 17
ci_019                 1.005085e-02 3 1  ON 18
ci_020                 1.717155e-02 3 1  ON 19
ci_021                 1.703699e-02 3 1  ON 20
ci_022                 9.233323e-03 3 1  ON 21
ci_023                 9.477417e-03 3 1  ON 22
ci_024                 9.626324e-03 3 1  ON 23
ci_025                 9.428218e-03 3 1  ON 24
ci_026                 1.109898e-02 3 1  ON 25
ci_027                 1.151457e-02 3 1  ON 26
ci_028                -1.496259e-02 3 1  ON 27
ci_029                -1.548561e-02 3 1  ON 28
ci_030                -9.379114e-03 3 1  ON 29
ci_031                -8.998196e-03 3 1  ON 30
ci_032                -1.485865e-02 3 1  ON 31
ci_033                 5.649711e-03 3 1  ON 32
ci_034                 5.609554e-03 3 1  ON 33
ci_035                -5.040681e-03 3 1  ON 34
ci_036                -1.254105e-02 3 1  ON 35
ci_037                -1.251893e-02 3 1  ON 36
ci_038                 1.748400e-03 3 1  ON 37
ci_039                 1.732078e-03 3 1  ON 38
ci_040                -3.030285e-03 3 1  ON 39
ci_041                 8.798016e-03 3 1  ON 40
ci_042                 8.870958e-03 3 1  ON 41
ci_043                -3.998255e-03 3 1  ON 42
ci_044                -4.119989e-03 3 1  ON 43
ci_045                -3.215604e-03 3 1  ON 44
ci_046                 5.737400e-03 3 1  ON 45
ci_047                 5.619713e-03 3 1  ON 46
ci_048                -1.254545e-02 3 1  ON 47
ci_049                -1.362502e-02 3 1  ON 48
ci_050                 3.427277e-03 3 1  ON 49
ci_051                 3.233204e-03 3 1  ON 50
ci_052                -2.291073e-03 3 1  ON 51
ci_053                -2.439045e-03 3 1  ON 52
ci_054                -2.884321e-03 3 1  ON 53
ci_055                -2.924357e-03 3 1  ON 54
ci_056                 5.328339e-03 3 1  ON 55
ci_057                 5.161331e-03 3 1  ON 56
ci_058                -1.734818e-03 3 1  ON 57
ci_059                -1.992269e-03 3 1  ON 58
ci_060                 4.871653e-03 3 1  ON 59
ci_061                 5.571444e-03 3 1  ON 60
ci_062                -3.602743e-03 3 1  ON 61
ci_063                -4.111661e-03 3 1  ON 62
ci_064                -3.005045e-03 3 1  ON 63
ci_065                -4.335905e-03 3 1  ON 64
ci_066                 4.473970e-03 3 1  ON 65
ci_067                 4.311059e-03 3 1  ON 66
ci_068                -4.314756e-03 3 1  ON 67
ci_069                -4.827802e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2345
    reference variance = 0.141373
====================================================
  Execution time = 1.7061e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8749e-01
  Total weights = 1.9573e+06
  Execution time = 1.8433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269165115328
                                         uncertainty =       0.002047304920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269165115328
                                         uncertainty =       0.002047304920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366804292
  error estimate for blocks of size 2^( 2) =       0.000380388260
  error estimate for blocks of size 2^( 3) =       0.000392830829
  error estimate for blocks of size 2^( 4) =       0.000402004061
  error estimate for blocks of size 2^( 5) =       0.000407851662
  error estimate for blocks of size 2^( 6) =       0.000410767393
  error estimate for blocks of size 2^( 7) =       0.000413104968

      target function =      -0.932374289220
              le_mean =     -17.211762423618
             les_mean =     296.532292676759
             stat err =       0.000408432021
             autocorr =       1.239854577347
   target nu stat err =       0.000408432021
   target dn stat err =       0.005561729125
      target stat err =       0.009048619831
              std dev =       0.518739604290
             le_variance =       0.269090777059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269156706264
                                         uncertainty =       0.002051142291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269156706264
                                         uncertainty =       0.002051142291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366798577
  error estimate for blocks of size 2^( 2) =       0.000380382085
  error estimate for blocks of size 2^( 3) =       0.000392824678
  error estimate for blocks of size 2^( 4) =       0.000401997179
  error estimate for blocks of size 2^( 5) =       0.000407842372
  error estimate for blocks of size 2^( 6) =       0.000410759149
  error estimate for blocks of size 2^( 7) =       0.000413097285

      target function =      -0.932498854813
              le_mean =     -17.211763270069
             les_mean =     296.532246329782
             stat err =       0.000408423996
             autocorr =       1.239844487314
   target nu stat err =       0.000408423996
   target dn stat err =       0.005493021157
      target stat err =       0.008939902721
              std dev =       0.518731522802
             le_variance =       0.269082392748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269160221228
                                         uncertainty =       0.002049336372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269160221228
                                         uncertainty =       0.002049336372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366800965
  error estimate for blocks of size 2^( 2) =       0.000380384667
  error estimate for blocks of size 2^( 3) =       0.000392827229
  error estimate for blocks of size 2^( 4) =       0.000402000051
  error estimate for blocks of size 2^( 5) =       0.000407846405
  error estimate for blocks of size 2^( 6) =       0.000410762671
  error estimate for blocks of size 2^( 7) =       0.000413100550

      target function =      -0.932486374191
              le_mean =     -17.211762815742
             les_mean =     296.532237767686
             stat err =       0.000408427419
             autocorr =       1.239849126668
   target nu stat err =       0.000408427419
   target dn stat err =       0.005525224312
      target stat err =       0.008991745803
              std dev =       0.518734899993
             le_variance =       0.269085896470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269164431867
                                         uncertainty =       0.002047561802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269164431867
                                         uncertainty =       0.002047561802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366803827
  error estimate for blocks of size 2^( 2) =       0.000380387761
  error estimate for blocks of size 2^( 3) =       0.000392830329
  error estimate for blocks of size 2^( 4) =       0.000402003510
  error estimate for blocks of size 2^( 5) =       0.000407850952
  error estimate for blocks of size 2^( 6) =       0.000410766749
  error estimate for blocks of size 2^( 7) =       0.000413104360

      target function =      -0.932392128288
              le_mean =     -17.211762464838
             les_mean =     296.532283185438
             stat err =       0.000408431393
             autocorr =       1.239853903627
   target nu stat err =       0.000408431393
   target dn stat err =       0.005557055903
      target stat err =       0.009041407776
              std dev =       0.518738947215
             le_variance =       0.269090095358


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932374289220        initial
     1.0000e+00     1.0000e+01             9.7684e-05        -0.932498854813  <--
     4.0000e+00     4.0000e+01             2.5548e-05        -0.932486374191
     1.6000e+01     1.6000e+02             6.4614e-06        -0.932392128288

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.6376e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -4.141213e-02 3 1  ON 0
ci_002                -3.153348e-02 3 1  ON 1
ci_003                -2.611594e-02 3 1  ON 2
ci_004                 2.368726e-02 3 1  ON 3
ci_005                 2.377920e-02 3 1  ON 4
ci_006                -2.091637e-02 3 1  ON 5
ci_007                -2.045821e-02 3 1  ON 6
ci_008                -8.592423e-03 3 1  ON 7
ci_009                -1.441634e-02 3 1  ON 8
ci_010                -9.570667e-03 3 1  ON 9
ci_011                -1.055436e-02 3 1  ON 10
ci_012                -9.870027e-03 3 1  ON 11
ci_013                -2.000957e-02 3 1  ON 12
ci_014                 1.256586e-02 3 1  ON 13
ci_015                 1.254357e-02 3 1  ON 14
ci_016                 1.705029e-02 3 1  ON 15
ci_017                 1.640304e-02 3 1  ON 16
ci_018                 9.967428e-03 3 1  ON 17
ci_019                 1.008418e-02 3 1  ON 18
ci_020                 1.714270e-02 3 1  ON 19
ci_021                 1.705338e-02 3 1  ON 20
ci_022                 9.224568e-03 3 1  ON 21
ci_023                 9.482740e-03 3 1  ON 22
ci_024                 9.581338e-03 3 1  ON 23
ci_025                 9.476601e-03 3 1  ON 24
ci_026                 1.104503e-02 3 1  ON 25
ci_027                 1.146575e-02 3 1  ON 26
ci_028                -1.497272e-02 3 1  ON 27
ci_029                -1.542817e-02 3 1  ON 28
ci_030                -9.331097e-03 3 1  ON 29
ci_031                -8.983941e-03 3 1  ON 30
ci_032                -1.482589e-02 3 1  ON 31
ci_033                 5.625157e-03 3 1  ON 32
ci_034                 5.623935e-03 3 1  ON 33
ci_035                -5.014234e-03 3 1  ON 34
ci_036                -1.252257e-02 3 1  ON 35
ci_037                -1.253553e-02 3 1  ON 36
ci_038                 1.729489e-03 3 1  ON 37
ci_039                 1.724534e-03 3 1  ON 38
ci_040                -3.026522e-03 3 1  ON 39
ci_041                 8.788547e-03 3 1  ON 40
ci_042                 8.860447e-03 3 1  ON 41
ci_043                -3.984947e-03 3 1  ON 42
ci_044                -4.088901e-03 3 1  ON 43
ci_045                -3.203483e-03 3 1  ON 44
ci_046                 5.746703e-03 3 1  ON 45
ci_047                 5.616980e-03 3 1  ON 46
ci_048                -1.258412e-02 3 1  ON 47
ci_049                -1.359054e-02 3 1  ON 48
ci_050                 3.447141e-03 3 1  ON 49
ci_051                 3.263291e-03 3 1  ON 50
ci_052                -2.290374e-03 3 1  ON 51
ci_053                -2.432916e-03 3 1  ON 52
ci_054                -2.878864e-03 3 1  ON 53
ci_055                -2.930873e-03 3 1  ON 54
ci_056                 5.360707e-03 3 1  ON 55
ci_057                 5.180647e-03 3 1  ON 56
ci_058                -1.778924e-03 3 1  ON 57
ci_059                -1.965257e-03 3 1  ON 58
ci_060                 4.844149e-03 3 1  ON 59
ci_061                 5.624993e-03 3 1  ON 60
ci_062                -3.615837e-03 3 1  ON 61
ci_063                -4.132316e-03 3 1  ON 62
ci_064                -2.982292e-03 3 1  ON 63
ci_065                -4.324477e-03 3 1  ON 64
ci_066                 4.491014e-03 3 1  ON 65
ci_067                 4.310334e-03 3 1  ON 66
ci_068                -4.341040e-03 3 1  ON 67
ci_069                -4.846076e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4743e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2389
    reference variance = 0.255996
====================================================
  Execution time = 1.4075e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7397e-01
  Total weights = 1.957181215e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5088e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264448528640
                                         uncertainty =       0.001350109680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264448528640
                                         uncertainty =       0.001350109680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363625220
  error estimate for blocks of size 2^( 2) =       0.000377565488
  error estimate for blocks of size 2^( 3) =       0.000390235254
  error estimate for blocks of size 2^( 4) =       0.000399269254
  error estimate for blocks of size 2^( 5) =       0.000404217856
  error estimate for blocks of size 2^( 6) =       0.000406959035
  error estimate for blocks of size 2^( 7) =       0.000407062705

      target function =      -0.954975267618
              le_mean =     -17.211814780870
             les_mean =     296.520538140221
             stat err =       0.000404377212
             autocorr =       1.236702827601
   target nu stat err =       0.000404377212
   target dn stat err =       0.001800435976
      target stat err =       0.003147081838
              std dev =       0.514243717828
             le_variance =       0.264446601326


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721181478087e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.954984585978       residual = 6.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.955068237919       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.955086757646       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.955090622131       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.955091503478       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.955091772222       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.955091770201       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.955091797009       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.955091804570       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.955091812495       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 4.149187e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.954984585978       residual = 6.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.955010227667       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.955015645894       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.955016718105       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.955016948930       residual = 9.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.955017025415       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.955017025235       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.955017031555       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.955017034299       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.955017036195       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.243225e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.954984585978       residual = 6.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.954991380447       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.954992794389       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.954993069479       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.954993127579       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.954993147354       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.954993147361       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.954993148892       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.954993149645       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.954993150111       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.270724e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6593e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -4.138679e-02 3 1  ON 0
ci_002                -3.154217e-02 3 1  ON 1
ci_003                -2.609728e-02 3 1  ON 2
ci_004                 2.366123e-02 3 1  ON 3
ci_005                 2.378706e-02 3 1  ON 4
ci_006                -2.084261e-02 3 1  ON 5
ci_007                -2.050479e-02 3 1  ON 6
ci_008                -8.631103e-03 3 1  ON 7
ci_009                -1.444148e-02 3 1  ON 8
ci_010                -9.580525e-03 3 1  ON 9
ci_011                -1.051112e-02 3 1  ON 10
ci_012                -9.950051e-03 3 1  ON 11
ci_013                -1.998966e-02 3 1  ON 12
ci_014                 1.252166e-02 3 1  ON 13
ci_015                 1.259667e-02 3 1  ON 14
ci_016                 1.700297e-02 3 1  ON 15
ci_017                 1.644782e-02 3 1  ON 16
ci_018                 9.996572e-03 3 1  ON 17
ci_019                 1.010851e-02 3 1  ON 18
ci_020                 1.713560e-02 3 1  ON 19
ci_021                 1.702035e-02 3 1  ON 20
ci_022                 9.240180e-03 3 1  ON 21
ci_023                 9.490369e-03 3 1  ON 22
ci_024                 9.704956e-03 3 1  ON 23
ci_025                 9.480382e-03 3 1  ON 24
ci_026                 1.099918e-02 3 1  ON 25
ci_027                 1.146869e-02 3 1  ON 26
ci_028                -1.496830e-02 3 1  ON 27
ci_029                -1.537970e-02 3 1  ON 28
ci_030                -9.280220e-03 3 1  ON 29
ci_031                -8.976439e-03 3 1  ON 30
ci_032                -1.486467e-02 3 1  ON 31
ci_033                 5.644444e-03 3 1  ON 32
ci_034                 5.499613e-03 3 1  ON 33
ci_035                -5.020549e-03 3 1  ON 34
ci_036                -1.248926e-02 3 1  ON 35
ci_037                -1.256162e-02 3 1  ON 36
ci_038                 1.692046e-03 3 1  ON 37
ci_039                 1.742992e-03 3 1  ON 38
ci_040                -3.011022e-03 3 1  ON 39
ci_041                 8.803556e-03 3 1  ON 40
ci_042                 8.895660e-03 3 1  ON 41
ci_043                -3.989461e-03 3 1  ON 42
ci_044                -4.053886e-03 3 1  ON 43
ci_045                -3.178130e-03 3 1  ON 44
ci_046                 5.752499e-03 3 1  ON 45
ci_047                 5.618383e-03 3 1  ON 46
ci_048                -1.257026e-02 3 1  ON 47
ci_049                -1.353949e-02 3 1  ON 48
ci_050                 3.466070e-03 3 1  ON 49
ci_051                 3.208981e-03 3 1  ON 50
ci_052                -2.343177e-03 3 1  ON 51
ci_053                -2.429071e-03 3 1  ON 52
ci_054                -2.859258e-03 3 1  ON 53
ci_055                -2.924497e-03 3 1  ON 54
ci_056                 5.304283e-03 3 1  ON 55
ci_057                 5.182062e-03 3 1  ON 56
ci_058                -1.722742e-03 3 1  ON 57
ci_059                -1.954512e-03 3 1  ON 58
ci_060                 4.855900e-03 3 1  ON 59
ci_061                 5.606480e-03 3 1  ON 60
ci_062                -3.610861e-03 3 1  ON 61
ci_063                -4.074857e-03 3 1  ON 62
ci_064                -2.991955e-03 3 1  ON 63
ci_065                -4.309597e-03 3 1  ON 64
ci_066                 4.483510e-03 3 1  ON 65
ci_067                 4.309904e-03 3 1  ON 66
ci_068                -4.420212e-03 3 1  ON 67
ci_069                -4.826081e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2052
    reference variance = 0.711968
====================================================
  Execution time = 1.3449e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7882e-01
  Total weights = 1.9573e+06
  Execution time = 1.8456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.213766
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265189061412
                                         uncertainty =       0.001485481732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265189061412
                                         uncertainty =       0.001485481732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364138867
  error estimate for blocks of size 2^( 2) =       0.000377986427
  error estimate for blocks of size 2^( 3) =       0.000390571223
  error estimate for blocks of size 2^( 4) =       0.000400317523
  error estimate for blocks of size 2^( 5) =       0.000406459941
  error estimate for blocks of size 2^( 6) =       0.000408740702
  error estimate for blocks of size 2^( 7) =       0.000411814916

      target function =      -0.935294301493
              le_mean =     -17.211895215814
             les_mean =     296.535028690580
             stat err =       0.000406833271
             autocorr =       1.248242168124
   target nu stat err =       0.000406833271
   target dn stat err =       0.007355691731
      target stat err =       0.012030001879
              std dev =       0.514970124975
             le_variance =       0.265194229617

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00862654
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265212477027
                                         uncertainty =       0.001482178857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265212477027
                                         uncertainty =       0.001482178857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364155424
  error estimate for blocks of size 2^( 2) =       0.000377996942
  error estimate for blocks of size 2^( 3) =       0.000390571558
  error estimate for blocks of size 2^( 4) =       0.000400310824
  error estimate for blocks of size 2^( 5) =       0.000406446499
  error estimate for blocks of size 2^( 6) =       0.000408727791
  error estimate for blocks of size 2^( 7) =       0.000411794184

      target function =      -0.942993041661
              le_mean =     -17.211898182219
             les_mean =     296.530530081301
             stat err =       0.000406819824
             autocorr =       1.248046165487
   target nu stat err =       0.000406819824
   target dn stat err =       0.003136230832
      target stat err =       0.005253238903
              std dev =       0.514993539234
             le_variance =       0.265218345452

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.222938
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265191103806
                                         uncertainty =       0.001483467400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265191103806
                                         uncertainty =       0.001483467400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364140572
  error estimate for blocks of size 2^( 2) =       0.000377984724
  error estimate for blocks of size 2^( 3) =       0.000390564307
  error estimate for blocks of size 2^( 4) =       0.000400307397
  error estimate for blocks of size 2^( 5) =       0.000406445872
  error estimate for blocks of size 2^( 6) =       0.000408724056
  error estimate for blocks of size 2^( 7) =       0.000411793315

      target function =      -0.946102511785
              le_mean =     -17.211895563564
             les_mean =     296.528576595479
             stat err =       0.000406817660
             autocorr =       1.248134694152
   target nu stat err =       0.000406817660
   target dn stat err =       0.002699329923
      target stat err =       0.004565621883
              std dev =       0.514972535233
             le_variance =       0.265196712044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265187860294
                                         uncertainty =       0.001485205644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265187860294
                                         uncertainty =       0.001485205644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364138083
  error estimate for blocks of size 2^( 2) =       0.000377985243
  error estimate for blocks of size 2^( 3) =       0.000390569528
  error estimate for blocks of size 2^( 4) =       0.000400316044
  error estimate for blocks of size 2^( 5) =       0.000406458134
  error estimate for blocks of size 2^( 6) =       0.000408738299
  error estimate for blocks of size 2^( 7) =       0.000411810549

      target function =      -0.944839089575
              le_mean =     -17.211894932377
             les_mean =     296.529311754861
             stat err =       0.000406830757
             autocorr =       1.248232119175
   target nu stat err =       0.000406830757
   target dn stat err =       0.002754668409
      target stat err =       0.004644647934
              std dev =       0.514969015921
             le_variance =       0.265193087359


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935294301493        initial
     2.5000e-01     2.5000e+00             4.1492e-04        -0.942993041661
     1.0000e+00     1.0000e+01             1.2432e-04        -0.946102511785  <--
     4.0000e+00     4.0000e+01             3.2707e-05        -0.944839089575

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.2775e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -4.138679e-02 3 1  ON 0
ci_002                -3.154217e-02 3 1  ON 1
ci_003                -2.609728e-02 3 1  ON 2
ci_004                 2.366123e-02 3 1  ON 3
ci_005                 2.378706e-02 3 1  ON 4
ci_006                -2.084261e-02 3 1  ON 5
ci_007                -2.050479e-02 3 1  ON 6
ci_008                -8.631103e-03 3 1  ON 7
ci_009                -1.444148e-02 3 1  ON 8
ci_010                -9.580525e-03 3 1  ON 9
ci_011                -1.051112e-02 3 1  ON 10
ci_012                -9.950051e-03 3 1  ON 11
ci_013                -1.998966e-02 3 1  ON 12
ci_014                 1.252166e-02 3 1  ON 13
ci_015                 1.259667e-02 3 1  ON 14
ci_016                 1.700297e-02 3 1  ON 15
ci_017                 1.644782e-02 3 1  ON 16
ci_018                 9.996572e-03 3 1  ON 17
ci_019                 1.010851e-02 3 1  ON 18
ci_020                 1.713560e-02 3 1  ON 19
ci_021                 1.702035e-02 3 1  ON 20
ci_022                 9.240180e-03 3 1  ON 21
ci_023                 9.490369e-03 3 1  ON 22
ci_024                 9.704956e-03 3 1  ON 23
ci_025                 9.480382e-03 3 1  ON 24
ci_026                 1.099918e-02 3 1  ON 25
ci_027                 1.146869e-02 3 1  ON 26
ci_028                -1.496830e-02 3 1  ON 27
ci_029                -1.537970e-02 3 1  ON 28
ci_030                -9.280220e-03 3 1  ON 29
ci_031                -8.976439e-03 3 1  ON 30
ci_032                -1.486467e-02 3 1  ON 31
ci_033                 5.644444e-03 3 1  ON 32
ci_034                 5.499613e-03 3 1  ON 33
ci_035                -5.020549e-03 3 1  ON 34
ci_036                -1.248926e-02 3 1  ON 35
ci_037                -1.256162e-02 3 1  ON 36
ci_038                 1.692046e-03 3 1  ON 37
ci_039                 1.742992e-03 3 1  ON 38
ci_040                -3.011022e-03 3 1  ON 39
ci_041                 8.803556e-03 3 1  ON 40
ci_042                 8.895660e-03 3 1  ON 41
ci_043                -3.989461e-03 3 1  ON 42
ci_044                -4.053886e-03 3 1  ON 43
ci_045                -3.178130e-03 3 1  ON 44
ci_046                 5.752499e-03 3 1  ON 45
ci_047                 5.618383e-03 3 1  ON 46
ci_048                -1.257026e-02 3 1  ON 47
ci_049                -1.353949e-02 3 1  ON 48
ci_050                 3.466070e-03 3 1  ON 49
ci_051                 3.208981e-03 3 1  ON 50
ci_052                -2.343177e-03 3 1  ON 51
ci_053                -2.429071e-03 3 1  ON 52
ci_054                -2.859258e-03 3 1  ON 53
ci_055                -2.924497e-03 3 1  ON 54
ci_056                 5.304283e-03 3 1  ON 55
ci_057                 5.182062e-03 3 1  ON 56
ci_058                -1.722742e-03 3 1  ON 57
ci_059                -1.954512e-03 3 1  ON 58
ci_060                 4.855900e-03 3 1  ON 59
ci_061                 5.606480e-03 3 1  ON 60
ci_062                -3.610861e-03 3 1  ON 61
ci_063                -4.074857e-03 3 1  ON 62
ci_064                -2.991955e-03 3 1  ON 63
ci_065                -4.309597e-03 3 1  ON 64
ci_066                 4.483510e-03 3 1  ON 65
ci_067                 4.309904e-03 3 1  ON 66
ci_068                -4.420212e-03 3 1  ON 67
ci_069                -4.826081e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9378e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1446
    reference variance = 0.336019
====================================================
  Execution time = 1.4033e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7697e-01
  Total weights = 1.957515866e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4846e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264407678454
                                         uncertainty =       0.001271882572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264407678454
                                         uncertainty =       0.001271882572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363562358
  error estimate for blocks of size 2^( 2) =       0.000377406017
  error estimate for blocks of size 2^( 3) =       0.000390114276
  error estimate for blocks of size 2^( 4) =       0.000399399997
  error estimate for blocks of size 2^( 5) =       0.000404859402
  error estimate for blocks of size 2^( 6) =       0.000407529193
  error estimate for blocks of size 2^( 7) =       0.000408695668

      target function =      -0.949884022094
              le_mean =     -17.211480446055
             les_mean =     296.512025306758
             stat err =       0.000405121065
             autocorr =       1.241686127007
   target nu stat err =       0.000405121065
   target dn stat err =       0.002543758068
      target stat err =       0.004339360550
              std dev =       0.514154817142
             le_variance =       0.264355175990


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721148044605e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949902687476       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950107808671       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950131543022       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950135528084       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950136389433       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950136527421       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950136620411       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950136679593       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950136648578       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950136648342       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.572667e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949902687476       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949965998698       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949972995725       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949974136993       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949974368055       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949974404016       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949974427569       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949974443079       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949974434978       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949974435150       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.731866e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949902687476       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949919501255       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949921331873       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949921627771       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949921686410       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949921695451       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949921701325       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949921705231       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949921703195       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949921703257       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.609514e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.021339 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6526e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -4.141661e-02 3 1  ON 0
ci_002                -3.157493e-02 3 1  ON 1
ci_003                -2.599205e-02 3 1  ON 2
ci_004                 2.362400e-02 3 1  ON 3
ci_005                 2.379137e-02 3 1  ON 4
ci_006                -2.079537e-02 3 1  ON 5
ci_007                -2.052854e-02 3 1  ON 6
ci_008                -8.639245e-03 3 1  ON 7
ci_009                -1.450973e-02 3 1  ON 8
ci_010                -9.561416e-03 3 1  ON 9
ci_011                -1.048951e-02 3 1  ON 10
ci_012                -1.004643e-02 3 1  ON 11
ci_013                -1.994739e-02 3 1  ON 12
ci_014                 1.254044e-02 3 1  ON 13
ci_015                 1.260636e-02 3 1  ON 14
ci_016                 1.697267e-02 3 1  ON 15
ci_017                 1.639255e-02 3 1  ON 16
ci_018                 1.001496e-02 3 1  ON 17
ci_019                 1.007250e-02 3 1  ON 18
ci_020                 1.709866e-02 3 1  ON 19
ci_021                 1.701282e-02 3 1  ON 20
ci_022                 9.250889e-03 3 1  ON 21
ci_023                 9.490035e-03 3 1  ON 22
ci_024                 9.659357e-03 3 1  ON 23
ci_025                 9.466826e-03 3 1  ON 24
ci_026                 1.098955e-02 3 1  ON 25
ci_027                 1.137760e-02 3 1  ON 26
ci_028                -1.493966e-02 3 1  ON 27
ci_029                -1.537652e-02 3 1  ON 28
ci_030                -9.453407e-03 3 1  ON 29
ci_031                -8.990912e-03 3 1  ON 30
ci_032                -1.484073e-02 3 1  ON 31
ci_033                 5.721603e-03 3 1  ON 32
ci_034                 5.514101e-03 3 1  ON 33
ci_035                -5.028999e-03 3 1  ON 34
ci_036                -1.249289e-02 3 1  ON 35
ci_037                -1.251510e-02 3 1  ON 36
ci_038                 1.686416e-03 3 1  ON 37
ci_039                 1.745531e-03 3 1  ON 38
ci_040                -2.978539e-03 3 1  ON 39
ci_041                 8.817314e-03 3 1  ON 40
ci_042                 8.887103e-03 3 1  ON 41
ci_043                -4.013550e-03 3 1  ON 42
ci_044                -3.976774e-03 3 1  ON 43
ci_045                -3.157931e-03 3 1  ON 44
ci_046                 5.745096e-03 3 1  ON 45
ci_047                 5.639172e-03 3 1  ON 46
ci_048                -1.246345e-02 3 1  ON 47
ci_049                -1.350763e-02 3 1  ON 48
ci_050                 3.493852e-03 3 1  ON 49
ci_051                 3.288458e-03 3 1  ON 50
ci_052                -2.364815e-03 3 1  ON 51
ci_053                -2.453822e-03 3 1  ON 52
ci_054                -2.827770e-03 3 1  ON 53
ci_055                -2.792700e-03 3 1  ON 54
ci_056                 5.294689e-03 3 1  ON 55
ci_057                 5.173280e-03 3 1  ON 56
ci_058                -1.676942e-03 3 1  ON 57
ci_059                -1.952342e-03 3 1  ON 58
ci_060                 4.876195e-03 3 1  ON 59
ci_061                 5.588151e-03 3 1  ON 60
ci_062                -3.640827e-03 3 1  ON 61
ci_063                -4.073133e-03 3 1  ON 62
ci_064                -3.036948e-03 3 1  ON 63
ci_065                -4.304279e-03 3 1  ON 64
ci_066                 4.449568e-03 3 1  ON 65
ci_067                 4.329445e-03 3 1  ON 66
ci_068                -4.456149e-03 3 1  ON 67
ci_069                -4.882375e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1249
    reference variance = 0.203259
====================================================
  Execution time = 1.3529e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8134e-01
  Total weights = 1.9574e+06
  Execution time = 1.8483e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269138214549
                                         uncertainty =       0.001500856317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269138214549
                                         uncertainty =       0.001500856317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366825824
  error estimate for blocks of size 2^( 2) =       0.000380789072
  error estimate for blocks of size 2^( 3) =       0.000393809426
  error estimate for blocks of size 2^( 4) =       0.000403175883
  error estimate for blocks of size 2^( 5) =       0.000408681154
  error estimate for blocks of size 2^( 6) =       0.000410579030
  error estimate for blocks of size 2^( 7) =       0.000412808506

      target function =      -0.942640716038
              le_mean =     -17.211987082179
             les_mean =     296.533810506712
             stat err =       0.000408811143
             autocorr =       1.242011583357
   target nu stat err =       0.000408811143
   target dn stat err =       0.002449674994
      target stat err =       0.004125730723
              std dev =       0.518770055826
             le_variance =       0.269122370821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269118482205
                                         uncertainty =       0.001501740476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269118482205
                                         uncertainty =       0.001501740476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366812698
  error estimate for blocks of size 2^( 2) =       0.000380754326
  error estimate for blocks of size 2^( 3) =       0.000393762020
  error estimate for blocks of size 2^( 4) =       0.000403120776
  error estimate for blocks of size 2^( 5) =       0.000408627096
  error estimate for blocks of size 2^( 6) =       0.000410530606
  error estimate for blocks of size 2^( 7) =       0.000412782308

      target function =      -0.942525880117
              le_mean =     -17.211986716666
             les_mean =     296.533866805741
             stat err =       0.000408765196
             autocorr =       1.241821287098
   target nu stat err =       0.000408765196
   target dn stat err =       0.002491928198
      target stat err =       0.004193727539
              std dev =       0.518751492515
             le_variance =       0.269103110986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269117769243
                                         uncertainty =       0.001501176050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269117769243
                                         uncertainty =       0.001501176050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366812083
  error estimate for blocks of size 2^( 2) =       0.000380762118
  error estimate for blocks of size 2^( 3) =       0.000393774788
  error estimate for blocks of size 2^( 4) =       0.000403136566
  error estimate for blocks of size 2^( 5) =       0.000408642525
  error estimate for blocks of size 2^( 6) =       0.000410544062
  error estimate for blocks of size 2^( 7) =       0.000412786994

      target function =      -0.942727332658
              le_mean =     -17.211985868839
             les_mean =     296.533716301719
             stat err =       0.000408777537
             autocorr =       1.241900428955
   target nu stat err =       0.000408777537
   target dn stat err =       0.002472360981
      target stat err =       0.004163517829
              std dev =       0.518750623148
             le_variance =       0.269102209016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269133951087
                                         uncertainty =       0.001500851567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269133951087
                                         uncertainty =       0.001500851567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366822944
  error estimate for blocks of size 2^( 2) =       0.000380784446
  error estimate for blocks of size 2^( 3) =       0.000393803768
  error estimate for blocks of size 2^( 4) =       0.000403169611
  error estimate for blocks of size 2^( 5) =       0.000408675072
  error estimate for blocks of size 2^( 6) =       0.000410573426
  error estimate for blocks of size 2^( 7) =       0.000412804811

      target function =      -0.942594210181
              le_mean =     -17.211986785121
             les_mean =     296.533828297001
             stat err =       0.000408805730
             autocorr =       1.241998191858
   target nu stat err =       0.000408805730
   target dn stat err =       0.002452571420
      target stat err =       0.004130055565
              std dev =       0.518765982781
             le_variance =       0.269118144891


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942640716038        initial
     2.5000e-01     2.5000e+00             5.5727e-04        -0.942525880117
     1.0000e+00     1.0000e+01             1.7319e-04        -0.942727332658  <--
     4.0000e+00     4.0000e+01             4.6095e-05        -0.942594210181

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.2839e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -4.141661e-02 3 1  ON 0
ci_002                -3.157493e-02 3 1  ON 1
ci_003                -2.599205e-02 3 1  ON 2
ci_004                 2.362400e-02 3 1  ON 3
ci_005                 2.379137e-02 3 1  ON 4
ci_006                -2.079537e-02 3 1  ON 5
ci_007                -2.052854e-02 3 1  ON 6
ci_008                -8.639245e-03 3 1  ON 7
ci_009                -1.450973e-02 3 1  ON 8
ci_010                -9.561416e-03 3 1  ON 9
ci_011                -1.048951e-02 3 1  ON 10
ci_012                -1.004643e-02 3 1  ON 11
ci_013                -1.994739e-02 3 1  ON 12
ci_014                 1.254044e-02 3 1  ON 13
ci_015                 1.260636e-02 3 1  ON 14
ci_016                 1.697267e-02 3 1  ON 15
ci_017                 1.639255e-02 3 1  ON 16
ci_018                 1.001496e-02 3 1  ON 17
ci_019                 1.007250e-02 3 1  ON 18
ci_020                 1.709866e-02 3 1  ON 19
ci_021                 1.701282e-02 3 1  ON 20
ci_022                 9.250889e-03 3 1  ON 21
ci_023                 9.490035e-03 3 1  ON 22
ci_024                 9.659357e-03 3 1  ON 23
ci_025                 9.466826e-03 3 1  ON 24
ci_026                 1.098955e-02 3 1  ON 25
ci_027                 1.137760e-02 3 1  ON 26
ci_028                -1.493966e-02 3 1  ON 27
ci_029                -1.537652e-02 3 1  ON 28
ci_030                -9.453407e-03 3 1  ON 29
ci_031                -8.990912e-03 3 1  ON 30
ci_032                -1.484073e-02 3 1  ON 31
ci_033                 5.721603e-03 3 1  ON 32
ci_034                 5.514101e-03 3 1  ON 33
ci_035                -5.028999e-03 3 1  ON 34
ci_036                -1.249289e-02 3 1  ON 35
ci_037                -1.251510e-02 3 1  ON 36
ci_038                 1.686416e-03 3 1  ON 37
ci_039                 1.745531e-03 3 1  ON 38
ci_040                -2.978539e-03 3 1  ON 39
ci_041                 8.817314e-03 3 1  ON 40
ci_042                 8.887103e-03 3 1  ON 41
ci_043                -4.013550e-03 3 1  ON 42
ci_044                -3.976774e-03 3 1  ON 43
ci_045                -3.157931e-03 3 1  ON 44
ci_046                 5.745096e-03 3 1  ON 45
ci_047                 5.639172e-03 3 1  ON 46
ci_048                -1.246345e-02 3 1  ON 47
ci_049                -1.350763e-02 3 1  ON 48
ci_050                 3.493852e-03 3 1  ON 49
ci_051                 3.288458e-03 3 1  ON 50
ci_052                -2.364815e-03 3 1  ON 51
ci_053                -2.453822e-03 3 1  ON 52
ci_054                -2.827770e-03 3 1  ON 53
ci_055                -2.792700e-03 3 1  ON 54
ci_056                 5.294689e-03 3 1  ON 55
ci_057                 5.173280e-03 3 1  ON 56
ci_058                -1.676942e-03 3 1  ON 57
ci_059                -1.952342e-03 3 1  ON 58
ci_060                 4.876195e-03 3 1  ON 59
ci_061                 5.588151e-03 3 1  ON 60
ci_062                -3.640827e-03 3 1  ON 61
ci_063                -4.073133e-03 3 1  ON 62
ci_064                -3.036948e-03 3 1  ON 63
ci_065                -4.304279e-03 3 1  ON 64
ci_066                 4.449568e-03 3 1  ON 65
ci_067                 4.329445e-03 3 1  ON 66
ci_068                -4.456149e-03 3 1  ON 67
ci_069                -4.882375e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9382e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2484
    reference variance = 0.231735
====================================================
  Execution time = 1.3921e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8021e-01
  Total weights = 1.956911363e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269409712924
                                         uncertainty =       0.001578986580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269409712924
                                         uncertainty =       0.001578986580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367007048
  error estimate for blocks of size 2^( 2) =       0.000380798610
  error estimate for blocks of size 2^( 3) =       0.000393024273
  error estimate for blocks of size 2^( 4) =       0.000402262558
  error estimate for blocks of size 2^( 5) =       0.000407007510
  error estimate for blocks of size 2^( 6) =       0.000409499446
  error estimate for blocks of size 2^( 7) =       0.000410853333

      target function =      -0.944462636769
              le_mean =     -17.211472505318
             les_mean =     296.514994489697
             stat err =       0.000407405712
             autocorr =       1.232268697173
   target nu stat err =       0.000407405712
   target dn stat err =       0.002346627638
      target stat err =       0.003968359773
              std dev =       0.519026345402
             le_variance =       0.269388347221


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721147250532e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944478312371       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944600123462       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944615235651       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944621526792       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944622036910       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944621986110       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944622009379       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944621988023       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944621936931       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944621939344       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 4.270109e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944478312371       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944515713345       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944520159678       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944521917613       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944522054916       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944522036859       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944522042162       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944522036848       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944522024002       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944522024875       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.279139e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944478312371       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944488228147       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944489390626       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944489842628       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944489877600       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944489872644       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944489873925       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944489872604       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944489869416       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944489869654       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.365220e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024819 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6424e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -4.135768e-02 3 1  ON 0
ci_002                -3.159549e-02 3 1  ON 1
ci_003                -2.586413e-02 3 1  ON 2
ci_004                 2.355327e-02 3 1  ON 3
ci_005                 2.379842e-02 3 1  ON 4
ci_006                -2.074927e-02 3 1  ON 5
ci_007                -2.053390e-02 3 1  ON 6
ci_008                -8.640970e-03 3 1  ON 7
ci_009                -1.449670e-02 3 1  ON 8
ci_010                -9.500699e-03 3 1  ON 9
ci_011                -1.040781e-02 3 1  ON 10
ci_012                -1.000911e-02 3 1  ON 11
ci_013                -1.992712e-02 3 1  ON 12
ci_014                 1.248529e-02 3 1  ON 13
ci_015                 1.261908e-02 3 1  ON 14
ci_016                 1.701763e-02 3 1  ON 15
ci_017                 1.643683e-02 3 1  ON 16
ci_018                 9.969286e-03 3 1  ON 17
ci_019                 1.009969e-02 3 1  ON 18
ci_020                 1.705683e-02 3 1  ON 19
ci_021                 1.696938e-02 3 1  ON 20
ci_022                 9.209124e-03 3 1  ON 21
ci_023                 9.480610e-03 3 1  ON 22
ci_024                 9.731736e-03 3 1  ON 23
ci_025                 9.514660e-03 3 1  ON 24
ci_026                 1.102278e-02 3 1  ON 25
ci_027                 1.146271e-02 3 1  ON 26
ci_028                -1.494871e-02 3 1  ON 27
ci_029                -1.529985e-02 3 1  ON 28
ci_030                -9.498714e-03 3 1  ON 29
ci_031                -8.971199e-03 3 1  ON 30
ci_032                -1.482382e-02 3 1  ON 31
ci_033                 5.743523e-03 3 1  ON 32
ci_034                 5.479189e-03 3 1  ON 33
ci_035                -5.004687e-03 3 1  ON 34
ci_036                -1.248120e-02 3 1  ON 35
ci_037                -1.254855e-02 3 1  ON 36
ci_038                 1.686021e-03 3 1  ON 37
ci_039                 1.712540e-03 3 1  ON 38
ci_040                -2.961859e-03 3 1  ON 39
ci_041                 8.811586e-03 3 1  ON 40
ci_042                 8.905516e-03 3 1  ON 41
ci_043                -4.002781e-03 3 1  ON 42
ci_044                -4.028605e-03 3 1  ON 43
ci_045                -3.160297e-03 3 1  ON 44
ci_046                 5.738248e-03 3 1  ON 45
ci_047                 5.668715e-03 3 1  ON 46
ci_048                -1.251544e-02 3 1  ON 47
ci_049                -1.346125e-02 3 1  ON 48
ci_050                 3.407171e-03 3 1  ON 49
ci_051                 3.297632e-03 3 1  ON 50
ci_052                -2.360414e-03 3 1  ON 51
ci_053                -2.395208e-03 3 1  ON 52
ci_054                -2.801964e-03 3 1  ON 53
ci_055                -2.772013e-03 3 1  ON 54
ci_056                 5.261672e-03 3 1  ON 55
ci_057                 5.199209e-03 3 1  ON 56
ci_058                -1.610818e-03 3 1  ON 57
ci_059                -1.888592e-03 3 1  ON 58
ci_060                 4.899891e-03 3 1  ON 59
ci_061                 5.551791e-03 3 1  ON 60
ci_062                -3.648842e-03 3 1  ON 61
ci_063                -4.053210e-03 3 1  ON 62
ci_064                -3.007347e-03 3 1  ON 63
ci_065                -4.320868e-03 3 1  ON 64
ci_066                 4.448811e-03 3 1  ON 65
ci_067                 4.340111e-03 3 1  ON 66
ci_068                -4.448565e-03 3 1  ON 67
ci_069                -4.865744e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2027
    reference variance = 0.187371
====================================================
  Execution time = 1.3447e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8059e-01
  Total weights = 1.9574e+06
  Execution time = 1.8538e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269013552071
                                         uncertainty =       0.001844880738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269013552071
                                         uncertainty =       0.001844880738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366725175
  error estimate for blocks of size 2^( 2) =       0.000380677978
  error estimate for blocks of size 2^( 3) =       0.000393237194
  error estimate for blocks of size 2^( 4) =       0.000401879937
  error estimate for blocks of size 2^( 5) =       0.000408222501
  error estimate for blocks of size 2^( 6) =       0.000411693137
  error estimate for blocks of size 2^( 7) =       0.000413338825

      target function =      -0.943993642533
              le_mean =     -17.212341536152
             les_mean =     296.545202007808
             stat err =       0.000408783600
             autocorr =       1.242525979744
   target nu stat err =       0.000408783600
   target dn stat err =       0.002448672887
      target stat err =       0.004138489753
              std dev =       0.518627716769
             le_variance =       0.268974708601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268950193812
                                         uncertainty =       0.001836266357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268950193812
                                         uncertainty =       0.001836266357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366682070
  error estimate for blocks of size 2^( 2) =       0.000380665416
  error estimate for blocks of size 2^( 3) =       0.000393255507
  error estimate for blocks of size 2^( 4) =       0.000401922492
  error estimate for blocks of size 2^( 5) =       0.000408283062
  error estimate for blocks of size 2^( 6) =       0.000411771326
  error estimate for blocks of size 2^( 7) =       0.000413431281

      target function =      -0.942783070462
              le_mean =     -17.212339045005
             les_mean =     296.545844085442
             stat err =       0.000408852041
             autocorr =       1.243234317099
   target nu stat err =       0.000408852041
   target dn stat err =       0.002504719212
      target stat err =       0.004219690622
              std dev =       0.518566757105
             le_variance =       0.268911481574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268969382528
                                         uncertainty =       0.001839410905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268969382528
                                         uncertainty =       0.001839410905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366695123
  error estimate for blocks of size 2^( 2) =       0.000380667038
  error estimate for blocks of size 2^( 3) =       0.000393244788
  error estimate for blocks of size 2^( 4) =       0.000401902580
  error estimate for blocks of size 2^( 5) =       0.000408255465
  error estimate for blocks of size 2^( 6) =       0.000411737320
  error estimate for blocks of size 2^( 7) =       0.000413391451

      target function =      -0.932014754597
              le_mean =     -17.212338631503
             les_mean =     296.552330734156
             stat err =       0.000408821704
             autocorr =       1.242961340729
   target nu stat err =       0.000408821704
   target dn stat err =       0.006441012034
      target stat err =       0.010474527266
              std dev =       0.518585215608
             le_variance =       0.268930625847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269006660866
                                         uncertainty =       0.001844142372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269006660866
                                         uncertainty =       0.001844142372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366720486
  error estimate for blocks of size 2^( 2) =       0.000380675740
  error estimate for blocks of size 2^( 3) =       0.000393237411
  error estimate for blocks of size 2^( 4) =       0.000401882111
  error estimate for blocks of size 2^( 5) =       0.000408226100
  error estimate for blocks of size 2^( 6) =       0.000411698179
  error estimate for blocks of size 2^( 7) =       0.000413344960

      target function =      -0.943992070530
              le_mean =     -17.212341090243
             les_mean =     296.545187601904
             stat err =       0.000408787838
             autocorr =       1.242583517901
   target nu stat err =       0.000408787838
   target dn stat err =       0.002448126614
      target stat err =       0.004137578750
              std dev =       0.518621085036
             le_variance =       0.268967829844


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943993642533        initial  <--
     2.5000e-01     2.5000e+00             4.2701e-04        -0.942783070462
     1.0000e+00     1.0000e+01             1.2791e-04        -0.932014754597
     4.0000e+00     4.0000e+01             3.3652e-05        -0.943992070530

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8187
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -4.141661e-02 3 1  ON 0
ci_002                -3.157493e-02 3 1  ON 1
ci_003                -2.599205e-02 3 1  ON 2
ci_004                 2.362400e-02 3 1  ON 3
ci_005                 2.379137e-02 3 1  ON 4
ci_006                -2.079537e-02 3 1  ON 5
ci_007                -2.052854e-02 3 1  ON 6
ci_008                -8.639245e-03 3 1  ON 7
ci_009                -1.450973e-02 3 1  ON 8
ci_010                -9.561416e-03 3 1  ON 9
ci_011                -1.048951e-02 3 1  ON 10
ci_012                -1.004643e-02 3 1  ON 11
ci_013                -1.994739e-02 3 1  ON 12
ci_014                 1.254044e-02 3 1  ON 13
ci_015                 1.260636e-02 3 1  ON 14
ci_016                 1.697267e-02 3 1  ON 15
ci_017                 1.639255e-02 3 1  ON 16
ci_018                 1.001496e-02 3 1  ON 17
ci_019                 1.007250e-02 3 1  ON 18
ci_020                 1.709866e-02 3 1  ON 19
ci_021                 1.701282e-02 3 1  ON 20
ci_022                 9.250889e-03 3 1  ON 21
ci_023                 9.490035e-03 3 1  ON 22
ci_024                 9.659357e-03 3 1  ON 23
ci_025                 9.466826e-03 3 1  ON 24
ci_026                 1.098955e-02 3 1  ON 25
ci_027                 1.137760e-02 3 1  ON 26
ci_028                -1.493966e-02 3 1  ON 27
ci_029                -1.537652e-02 3 1  ON 28
ci_030                -9.453407e-03 3 1  ON 29
ci_031                -8.990912e-03 3 1  ON 30
ci_032                -1.484073e-02 3 1  ON 31
ci_033                 5.721603e-03 3 1  ON 32
ci_034                 5.514101e-03 3 1  ON 33
ci_035                -5.028999e-03 3 1  ON 34
ci_036                -1.249289e-02 3 1  ON 35
ci_037                -1.251510e-02 3 1  ON 36
ci_038                 1.686416e-03 3 1  ON 37
ci_039                 1.745531e-03 3 1  ON 38
ci_040                -2.978539e-03 3 1  ON 39
ci_041                 8.817314e-03 3 1  ON 40
ci_042                 8.887103e-03 3 1  ON 41
ci_043                -4.013550e-03 3 1  ON 42
ci_044                -3.976774e-03 3 1  ON 43
ci_045                -3.157931e-03 3 1  ON 44
ci_046                 5.745096e-03 3 1  ON 45
ci_047                 5.639172e-03 3 1  ON 46
ci_048                -1.246345e-02 3 1  ON 47
ci_049                -1.350763e-02 3 1  ON 48
ci_050                 3.493852e-03 3 1  ON 49
ci_051                 3.288458e-03 3 1  ON 50
ci_052                -2.364815e-03 3 1  ON 51
ci_053                -2.453822e-03 3 1  ON 52
ci_054                -2.827770e-03 3 1  ON 53
ci_055                -2.792700e-03 3 1  ON 54
ci_056                 5.294689e-03 3 1  ON 55
ci_057                 5.173280e-03 3 1  ON 56
ci_058                -1.676942e-03 3 1  ON 57
ci_059                -1.952342e-03 3 1  ON 58
ci_060                 4.876195e-03 3 1  ON 59
ci_061                 5.588151e-03 3 1  ON 60
ci_062                -3.640827e-03 3 1  ON 61
ci_063                -4.073133e-03 3 1  ON 62
ci_064                -3.036948e-03 3 1  ON 63
ci_065                -4.304279e-03 3 1  ON 64
ci_066                 4.449568e-03 3 1  ON 65
ci_067                 4.329445e-03 3 1  ON 66
ci_068                -4.456149e-03 3 1  ON 67
ci_069                -4.882375e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9271e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1246
    reference variance = 0.28368
====================================================
  Execution time = 1.3992e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7812e-01
  Total weights = 1.957122300e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5070e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267451297220
                                         uncertainty =       0.001539235417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267451297220
                                         uncertainty =       0.001539235417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365708050
  error estimate for blocks of size 2^( 2) =       0.000379492685
  error estimate for blocks of size 2^( 3) =       0.000392246963
  error estimate for blocks of size 2^( 4) =       0.000401601556
  error estimate for blocks of size 2^( 5) =       0.000406312142
  error estimate for blocks of size 2^( 6) =       0.000409278591
  error estimate for blocks of size 2^( 7) =       0.000411257788

      target function =      -0.947963340383
              le_mean =     -17.211973482530
             les_mean =     296.530153552763
             stat err =       0.000407112519
             autocorr =       1.239252703230
   target nu stat err =       0.000407112519
   target dn stat err =       0.002078780867
      target stat err =       0.003560022085
              std dev =       0.517189284094
             le_variance =       0.267484755582


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721197348253e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947975641196       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947994853529       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947997452495       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947998115711       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947998221981       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947998294129       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947998301690       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947998306257       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947998312948       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947998315501       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 4.752034e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947975641196       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947980563789       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947981225836       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947981393629       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947981420252       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947981438361       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947981440300       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947981441432       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947981443113       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947981443744       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.216209e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947975641196       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947976879547       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947977045845       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947977087918       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947977094577       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947977099109       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947977099597       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947977099879       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947977100300       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947977100457       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 3.058683e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028291 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6508e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -4.141613e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599418e-02 3 1  ON 2
ci_004                 2.363303e-02 3 1  ON 3
ci_005                 2.378626e-02 3 1  ON 4
ci_006                -2.078761e-02 3 1  ON 5
ci_007                -2.052483e-02 3 1  ON 6
ci_008                -8.640573e-03 3 1  ON 7
ci_009                -1.451210e-02 3 1  ON 8
ci_010                -9.553386e-03 3 1  ON 9
ci_011                -1.048534e-02 3 1  ON 10
ci_012                -1.003774e-02 3 1  ON 11
ci_013                -1.994757e-02 3 1  ON 12
ci_014                 1.253804e-02 3 1  ON 13
ci_015                 1.260878e-02 3 1  ON 14
ci_016                 1.696088e-02 3 1  ON 15
ci_017                 1.639236e-02 3 1  ON 16
ci_018                 1.001460e-02 3 1  ON 17
ci_019                 1.008111e-02 3 1  ON 18
ci_020                 1.709720e-02 3 1  ON 19
ci_021                 1.701188e-02 3 1  ON 20
ci_022                 9.245200e-03 3 1  ON 21
ci_023                 9.492932e-03 3 1  ON 22
ci_024                 9.663710e-03 3 1  ON 23
ci_025                 9.460000e-03 3 1  ON 24
ci_026                 1.098871e-02 3 1  ON 25
ci_027                 1.138048e-02 3 1  ON 26
ci_028                -1.494841e-02 3 1  ON 27
ci_029                -1.538016e-02 3 1  ON 28
ci_030                -9.441245e-03 3 1  ON 29
ci_031                -8.993548e-03 3 1  ON 30
ci_032                -1.483588e-02 3 1  ON 31
ci_033                 5.723523e-03 3 1  ON 32
ci_034                 5.515372e-03 3 1  ON 33
ci_035                -5.026927e-03 3 1  ON 34
ci_036                -1.249012e-02 3 1  ON 35
ci_037                -1.251046e-02 3 1  ON 36
ci_038                 1.686541e-03 3 1  ON 37
ci_039                 1.743693e-03 3 1  ON 38
ci_040                -2.980565e-03 3 1  ON 39
ci_041                 8.806664e-03 3 1  ON 40
ci_042                 8.882045e-03 3 1  ON 41
ci_043                -4.010907e-03 3 1  ON 42
ci_044                -3.979257e-03 3 1  ON 43
ci_045                -3.149339e-03 3 1  ON 44
ci_046                 5.743117e-03 3 1  ON 45
ci_047                 5.639901e-03 3 1  ON 46
ci_048                -1.246441e-02 3 1  ON 47
ci_049                -1.350367e-02 3 1  ON 48
ci_050                 3.495421e-03 3 1  ON 49
ci_051                 3.286804e-03 3 1  ON 50
ci_052                -2.365708e-03 3 1  ON 51
ci_053                -2.455048e-03 3 1  ON 52
ci_054                -2.821802e-03 3 1  ON 53
ci_055                -2.793140e-03 3 1  ON 54
ci_056                 5.297798e-03 3 1  ON 55
ci_057                 5.166612e-03 3 1  ON 56
ci_058                -1.676330e-03 3 1  ON 57
ci_059                -1.950456e-03 3 1  ON 58
ci_060                 4.881264e-03 3 1  ON 59
ci_061                 5.584322e-03 3 1  ON 60
ci_062                -3.639860e-03 3 1  ON 61
ci_063                -4.069902e-03 3 1  ON 62
ci_064                -3.040206e-03 3 1  ON 63
ci_065                -4.303270e-03 3 1  ON 64
ci_066                 4.446872e-03 3 1  ON 65
ci_067                 4.331971e-03 3 1  ON 66
ci_068                -4.465789e-03 3 1  ON 67
ci_069                -4.887952e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.175
    reference variance = 0.344325
====================================================
  Execution time = 1.3562e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7764e-01
  Total weights = 1.9573e+06
  Execution time = 1.8609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267328816207
                                         uncertainty =       0.001294701723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267328816207
                                         uncertainty =       0.001294701723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365615156
  error estimate for blocks of size 2^( 2) =       0.000379346974
  error estimate for blocks of size 2^( 3) =       0.000391743556
  error estimate for blocks of size 2^( 4) =       0.000400763330
  error estimate for blocks of size 2^( 5) =       0.000406041621
  error estimate for blocks of size 2^( 6) =       0.000411041619
  error estimate for blocks of size 2^( 7) =       0.000411543280

      target function =      -0.948771100778
              le_mean =     -17.211674426785
             les_mean =     296.519373983555
             stat err =       0.000407347462
             autocorr =       1.241313989354
   target nu stat err =       0.000407347462
   target dn stat err =       0.001845608413
      target stat err =       0.003181621070
              std dev =       0.517057911939
             le_variance =       0.267348884298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267327713151
                                         uncertainty =       0.001295581022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267327713151
                                         uncertainty =       0.001295581022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365614400
  error estimate for blocks of size 2^( 2) =       0.000379347437
  error estimate for blocks of size 2^( 3) =       0.000391745498
  error estimate for blocks of size 2^( 4) =       0.000400767162
  error estimate for blocks of size 2^( 5) =       0.000406044844
  error estimate for blocks of size 2^( 6) =       0.000411045683
  error estimate for blocks of size 2^( 7) =       0.000411543967

      target function =      -0.948746179145
              le_mean =     -17.211674465509
             les_mean =     296.519390140583
             stat err =       0.000407350414
             autocorr =       1.241337111042
   target nu stat err =       0.000407350414
   target dn stat err =       0.001848638401
      target stat err =       0.003186414884
              std dev =       0.517056843035
             le_variance =       0.267347778929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267328133149
                                         uncertainty =       0.001295149113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267328133149
                                         uncertainty =       0.001295149113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365614688
  error estimate for blocks of size 2^( 2) =       0.000379347128
  error estimate for blocks of size 2^( 3) =       0.000391744467
  error estimate for blocks of size 2^( 4) =       0.000400765209
  error estimate for blocks of size 2^( 5) =       0.000406043198
  error estimate for blocks of size 2^( 6) =       0.000411043628
  error estimate for blocks of size 2^( 7) =       0.000411543558

      target function =      -0.948772495650
              le_mean =     -17.211674434543
             les_mean =     296.519373410798
             stat err =       0.000407348899
             autocorr =       1.241325919874
   target nu stat err =       0.000407348899
   target dn stat err =       0.001847000192
      target stat err =       0.003183907006
              std dev =       0.517057250230
             le_variance =       0.267348200015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267328717315
                                         uncertainty =       0.001294757745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267328717315
                                         uncertainty =       0.001294757745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365615088
  error estimate for blocks of size 2^( 2) =       0.000379346984
  error estimate for blocks of size 2^( 3) =       0.000391743661
  error estimate for blocks of size 2^( 4) =       0.000400763557
  error estimate for blocks of size 2^( 5) =       0.000406041811
  error estimate for blocks of size 2^( 6) =       0.000411041863
  error estimate for blocks of size 2^( 7) =       0.000411543307

      target function =      -0.948772202250
              le_mean =     -17.211674426243
             les_mean =     296.519373307773
             stat err =       0.000407347635
             autocorr =       1.241315498685
   target nu stat err =       0.000407347635
   target dn stat err =       0.001845775069
      target stat err =       0.003181900888
              std dev =       0.517057816160
             le_variance =       0.267348785252


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948771100778        initial
     2.5000e+00     2.5000e+01             4.7520e-05        -0.948746179145
     1.0000e+01     1.0000e+02             1.2162e-05        -0.948772495650  <--
     4.0000e+01     4.0000e+02             3.0587e-06        -0.948772202250

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.2966e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -4.141613e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599418e-02 3 1  ON 2
ci_004                 2.363303e-02 3 1  ON 3
ci_005                 2.378626e-02 3 1  ON 4
ci_006                -2.078761e-02 3 1  ON 5
ci_007                -2.052483e-02 3 1  ON 6
ci_008                -8.640573e-03 3 1  ON 7
ci_009                -1.451210e-02 3 1  ON 8
ci_010                -9.553386e-03 3 1  ON 9
ci_011                -1.048534e-02 3 1  ON 10
ci_012                -1.003774e-02 3 1  ON 11
ci_013                -1.994757e-02 3 1  ON 12
ci_014                 1.253804e-02 3 1  ON 13
ci_015                 1.260878e-02 3 1  ON 14
ci_016                 1.696088e-02 3 1  ON 15
ci_017                 1.639236e-02 3 1  ON 16
ci_018                 1.001460e-02 3 1  ON 17
ci_019                 1.008111e-02 3 1  ON 18
ci_020                 1.709720e-02 3 1  ON 19
ci_021                 1.701188e-02 3 1  ON 20
ci_022                 9.245200e-03 3 1  ON 21
ci_023                 9.492932e-03 3 1  ON 22
ci_024                 9.663710e-03 3 1  ON 23
ci_025                 9.460000e-03 3 1  ON 24
ci_026                 1.098871e-02 3 1  ON 25
ci_027                 1.138048e-02 3 1  ON 26
ci_028                -1.494841e-02 3 1  ON 27
ci_029                -1.538016e-02 3 1  ON 28
ci_030                -9.441245e-03 3 1  ON 29
ci_031                -8.993548e-03 3 1  ON 30
ci_032                -1.483588e-02 3 1  ON 31
ci_033                 5.723523e-03 3 1  ON 32
ci_034                 5.515372e-03 3 1  ON 33
ci_035                -5.026927e-03 3 1  ON 34
ci_036                -1.249012e-02 3 1  ON 35
ci_037                -1.251046e-02 3 1  ON 36
ci_038                 1.686541e-03 3 1  ON 37
ci_039                 1.743693e-03 3 1  ON 38
ci_040                -2.980565e-03 3 1  ON 39
ci_041                 8.806664e-03 3 1  ON 40
ci_042                 8.882045e-03 3 1  ON 41
ci_043                -4.010907e-03 3 1  ON 42
ci_044                -3.979257e-03 3 1  ON 43
ci_045                -3.149339e-03 3 1  ON 44
ci_046                 5.743117e-03 3 1  ON 45
ci_047                 5.639901e-03 3 1  ON 46
ci_048                -1.246441e-02 3 1  ON 47
ci_049                -1.350367e-02 3 1  ON 48
ci_050                 3.495421e-03 3 1  ON 49
ci_051                 3.286804e-03 3 1  ON 50
ci_052                -2.365708e-03 3 1  ON 51
ci_053                -2.455048e-03 3 1  ON 52
ci_054                -2.821802e-03 3 1  ON 53
ci_055                -2.793140e-03 3 1  ON 54
ci_056                 5.297798e-03 3 1  ON 55
ci_057                 5.166612e-03 3 1  ON 56
ci_058                -1.676330e-03 3 1  ON 57
ci_059                -1.950456e-03 3 1  ON 58
ci_060                 4.881264e-03 3 1  ON 59
ci_061                 5.584322e-03 3 1  ON 60
ci_062                -3.639860e-03 3 1  ON 61
ci_063                -4.069902e-03 3 1  ON 62
ci_064                -3.040206e-03 3 1  ON 63
ci_065                -4.303270e-03 3 1  ON 64
ci_066                 4.446872e-03 3 1  ON 65
ci_067                 4.331971e-03 3 1  ON 66
ci_068                -4.465789e-03 3 1  ON 67
ci_069                -4.887952e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9481e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7190e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1736
    reference variance = 0.388339
====================================================
  Execution time = 1.3882e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8650e-01
  Total weights = 1.957671122e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274386269152
                                         uncertainty =       0.001787760908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274386269152
                                         uncertainty =       0.001787760908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370393558
  error estimate for blocks of size 2^( 2) =       0.000384488671
  error estimate for blocks of size 2^( 3) =       0.000397002738
  error estimate for blocks of size 2^( 4) =       0.000406157527
  error estimate for blocks of size 2^( 5) =       0.000412450916
  error estimate for blocks of size 2^( 6) =       0.000416212773
  error estimate for blocks of size 2^( 7) =       0.000420177308

      target function =      -0.934111435322
              le_mean =     -17.212298523225
             les_mean =     296.549719403633
             stat err =       0.000413749631
             autocorr =       1.247809793185
   target nu stat err =       0.000413749631
   target dn stat err =       0.002806779824
      target stat err =       0.004630204284
              std dev =       0.523815593236
             le_variance =       0.274382775717


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721229852323e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934132401474       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934145930265       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934147630345       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934148429593       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934148487857       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934148489110       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934148482105       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934148478007       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934148477169       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934148477231       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 3.972563e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934132401474       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934135865937       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934136299056       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934136501381       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934136515957       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934136516233       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934136514450       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934136513440       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934136513215       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934136513233       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.017101e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934132401474       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934133272889       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934133381686       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934133432426       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934133436071       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934133436137       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934133435689       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934133435438       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934133435381       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934133435385       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 2.558183e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031780 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6405e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -4.141938e-02 3 1  ON 0
ci_002                -3.158259e-02 3 1  ON 1
ci_003                -2.599376e-02 3 1  ON 2
ci_004                 2.363020e-02 3 1  ON 3
ci_005                 2.377916e-02 3 1  ON 4
ci_006                -2.078201e-02 3 1  ON 5
ci_007                -2.051763e-02 3 1  ON 6
ci_008                -8.649302e-03 3 1  ON 7
ci_009                -1.451169e-02 3 1  ON 8
ci_010                -9.553779e-03 3 1  ON 9
ci_011                -1.048749e-02 3 1  ON 10
ci_012                -1.004428e-02 3 1  ON 11
ci_013                -1.994734e-02 3 1  ON 12
ci_014                 1.253730e-02 3 1  ON 13
ci_015                 1.260880e-02 3 1  ON 14
ci_016                 1.695965e-02 3 1  ON 15
ci_017                 1.639130e-02 3 1  ON 16
ci_018                 1.001161e-02 3 1  ON 17
ci_019                 1.007944e-02 3 1  ON 18
ci_020                 1.709153e-02 3 1  ON 19
ci_021                 1.701150e-02 3 1  ON 20
ci_022                 9.246971e-03 3 1  ON 21
ci_023                 9.496559e-03 3 1  ON 22
ci_024                 9.661134e-03 3 1  ON 23
ci_025                 9.459885e-03 3 1  ON 24
ci_026                 1.098978e-02 3 1  ON 25
ci_027                 1.137361e-02 3 1  ON 26
ci_028                -1.495578e-02 3 1  ON 27
ci_029                -1.537577e-02 3 1  ON 28
ci_030                -9.438668e-03 3 1  ON 29
ci_031                -9.003719e-03 3 1  ON 30
ci_032                -1.484080e-02 3 1  ON 31
ci_033                 5.728304e-03 3 1  ON 32
ci_034                 5.516197e-03 3 1  ON 33
ci_035                -5.028234e-03 3 1  ON 34
ci_036                -1.248745e-02 3 1  ON 35
ci_037                -1.250800e-02 3 1  ON 36
ci_038                 1.688999e-03 3 1  ON 37
ci_039                 1.742435e-03 3 1  ON 38
ci_040                -2.981122e-03 3 1  ON 39
ci_041                 8.797005e-03 3 1  ON 40
ci_042                 8.879792e-03 3 1  ON 41
ci_043                -4.009718e-03 3 1  ON 42
ci_044                -3.974934e-03 3 1  ON 43
ci_045                -3.150882e-03 3 1  ON 44
ci_046                 5.744581e-03 3 1  ON 45
ci_047                 5.644221e-03 3 1  ON 46
ci_048                -1.246293e-02 3 1  ON 47
ci_049                -1.349975e-02 3 1  ON 48
ci_050                 3.496657e-03 3 1  ON 49
ci_051                 3.289019e-03 3 1  ON 50
ci_052                -2.359558e-03 3 1  ON 51
ci_053                -2.459953e-03 3 1  ON 52
ci_054                -2.815038e-03 3 1  ON 53
ci_055                -2.795492e-03 3 1  ON 54
ci_056                 5.297001e-03 3 1  ON 55
ci_057                 5.168796e-03 3 1  ON 56
ci_058                -1.678970e-03 3 1  ON 57
ci_059                -1.947722e-03 3 1  ON 58
ci_060                 4.878104e-03 3 1  ON 59
ci_061                 5.584259e-03 3 1  ON 60
ci_062                -3.643917e-03 3 1  ON 61
ci_063                -4.067337e-03 3 1  ON 62
ci_064                -3.045199e-03 3 1  ON 63
ci_065                -4.304948e-03 3 1  ON 64
ci_066                 4.452814e-03 3 1  ON 65
ci_067                 4.336665e-03 3 1  ON 66
ci_068                -4.464475e-03 3 1  ON 67
ci_069                -4.885086e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1714
    reference variance = 0.527658
====================================================
  Execution time = 1.3546e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7677e-01
  Total weights = 1.9575e+06
  Execution time = 1.8409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266557229514
                                         uncertainty =       0.001343340698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266557229514
                                         uncertainty =       0.001343340698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365053600
  error estimate for blocks of size 2^( 2) =       0.000379168313
  error estimate for blocks of size 2^( 3) =       0.000391849806
  error estimate for blocks of size 2^( 4) =       0.000401145485
  error estimate for blocks of size 2^( 5) =       0.000406578948
  error estimate for blocks of size 2^( 6) =       0.000409412157
  error estimate for blocks of size 2^( 7) =       0.000408927753

      target function =      -0.950271817711
              le_mean =     -17.212529493441
             les_mean =     296.547933261189
             stat err =       0.000406516086
             autocorr =       1.240058575046
   target nu stat err =       0.000406516086
   target dn stat err =       0.001774169745
      target stat err =       0.003078909703
              std dev =       0.516263751718
             le_variance =       0.266528261338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266559408977
                                         uncertainty =       0.001343532449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266559408977
                                         uncertainty =       0.001343532449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365055113
  error estimate for blocks of size 2^( 2) =       0.000379168241
  error estimate for blocks of size 2^( 3) =       0.000391849914
  error estimate for blocks of size 2^( 4) =       0.000401144948
  error estimate for blocks of size 2^( 5) =       0.000406578019
  error estimate for blocks of size 2^( 6) =       0.000409412585
  error estimate for blocks of size 2^( 7) =       0.000408929178

      target function =      -0.950192228285
              le_mean =     -17.212530005467
             les_mean =     296.547998076559
             stat err =       0.000406516182
             autocorr =       1.240048885044
   target nu stat err =       0.000406516182
   target dn stat err =       0.001774515425
      target stat err =       0.003078977978
              std dev =       0.516265891605
             le_variance =       0.266530470834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266558236935
                                         uncertainty =       0.001343436398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266558236935
                                         uncertainty =       0.001343436398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365054300
  error estimate for blocks of size 2^( 2) =       0.000379168202
  error estimate for blocks of size 2^( 3) =       0.000391849785
  error estimate for blocks of size 2^( 4) =       0.000401145138
  error estimate for blocks of size 2^( 5) =       0.000406578398
  error estimate for blocks of size 2^( 6) =       0.000409412287
  error estimate for blocks of size 2^( 7) =       0.000408928395

      target function =      -0.950234750955
              le_mean =     -17.212529743136
             les_mean =     296.547963833445
             stat err =       0.000406516055
             autocorr =       1.240053625878
   target nu stat err =       0.000406516055
   target dn stat err =       0.001774282386
      target stat err =       0.003078862257
              std dev =       0.516264742343
             le_variance =       0.266529284187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266557343005
                                         uncertainty =       0.001343352417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266557343005
                                         uncertainty =       0.001343352417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365053679
  error estimate for blocks of size 2^( 2) =       0.000379168290
  error estimate for blocks of size 2^( 3) =       0.000391849795
  error estimate for blocks of size 2^( 4) =       0.000401145433
  error estimate for blocks of size 2^( 5) =       0.000406578870
  error estimate for blocks of size 2^( 6) =       0.000409412164
  error estimate for blocks of size 2^( 7) =       0.000408927824

      target function =      -0.950268416135
              le_mean =     -17.212529523571
             les_mean =     296.547936315247
             stat err =       0.000406516073
             autocorr =       1.240057958268
   target nu stat err =       0.000406516073
   target dn stat err =       0.001774178984
      target stat err =       0.003078903586
              std dev =       0.516263863516
             le_variance =       0.266528376773


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950271817711        initial  <--
     2.5000e+00     2.5000e+01             3.9726e-05        -0.950192228285
     1.0000e+01     1.0000e+02             1.0171e-05        -0.950234750955
     4.0000e+01     4.0000e+02             2.5582e-06        -0.950268416135

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8533
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -4.141613e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599418e-02 3 1  ON 2
ci_004                 2.363303e-02 3 1  ON 3
ci_005                 2.378626e-02 3 1  ON 4
ci_006                -2.078761e-02 3 1  ON 5
ci_007                -2.052483e-02 3 1  ON 6
ci_008                -8.640573e-03 3 1  ON 7
ci_009                -1.451210e-02 3 1  ON 8
ci_010                -9.553386e-03 3 1  ON 9
ci_011                -1.048534e-02 3 1  ON 10
ci_012                -1.003774e-02 3 1  ON 11
ci_013                -1.994757e-02 3 1  ON 12
ci_014                 1.253804e-02 3 1  ON 13
ci_015                 1.260878e-02 3 1  ON 14
ci_016                 1.696088e-02 3 1  ON 15
ci_017                 1.639236e-02 3 1  ON 16
ci_018                 1.001460e-02 3 1  ON 17
ci_019                 1.008111e-02 3 1  ON 18
ci_020                 1.709720e-02 3 1  ON 19
ci_021                 1.701188e-02 3 1  ON 20
ci_022                 9.245200e-03 3 1  ON 21
ci_023                 9.492932e-03 3 1  ON 22
ci_024                 9.663710e-03 3 1  ON 23
ci_025                 9.460000e-03 3 1  ON 24
ci_026                 1.098871e-02 3 1  ON 25
ci_027                 1.138048e-02 3 1  ON 26
ci_028                -1.494841e-02 3 1  ON 27
ci_029                -1.538016e-02 3 1  ON 28
ci_030                -9.441245e-03 3 1  ON 29
ci_031                -8.993548e-03 3 1  ON 30
ci_032                -1.483588e-02 3 1  ON 31
ci_033                 5.723523e-03 3 1  ON 32
ci_034                 5.515372e-03 3 1  ON 33
ci_035                -5.026927e-03 3 1  ON 34
ci_036                -1.249012e-02 3 1  ON 35
ci_037                -1.251046e-02 3 1  ON 36
ci_038                 1.686541e-03 3 1  ON 37
ci_039                 1.743693e-03 3 1  ON 38
ci_040                -2.980565e-03 3 1  ON 39
ci_041                 8.806664e-03 3 1  ON 40
ci_042                 8.882045e-03 3 1  ON 41
ci_043                -4.010907e-03 3 1  ON 42
ci_044                -3.979257e-03 3 1  ON 43
ci_045                -3.149339e-03 3 1  ON 44
ci_046                 5.743117e-03 3 1  ON 45
ci_047                 5.639901e-03 3 1  ON 46
ci_048                -1.246441e-02 3 1  ON 47
ci_049                -1.350367e-02 3 1  ON 48
ci_050                 3.495421e-03 3 1  ON 49
ci_051                 3.286804e-03 3 1  ON 50
ci_052                -2.365708e-03 3 1  ON 51
ci_053                -2.455048e-03 3 1  ON 52
ci_054                -2.821802e-03 3 1  ON 53
ci_055                -2.793140e-03 3 1  ON 54
ci_056                 5.297798e-03 3 1  ON 55
ci_057                 5.166612e-03 3 1  ON 56
ci_058                -1.676330e-03 3 1  ON 57
ci_059                -1.950456e-03 3 1  ON 58
ci_060                 4.881264e-03 3 1  ON 59
ci_061                 5.584322e-03 3 1  ON 60
ci_062                -3.639860e-03 3 1  ON 61
ci_063                -4.069902e-03 3 1  ON 62
ci_064                -3.040206e-03 3 1  ON 63
ci_065                -4.303270e-03 3 1  ON 64
ci_066                 4.446872e-03 3 1  ON 65
ci_067                 4.331971e-03 3 1  ON 66
ci_068                -4.465789e-03 3 1  ON 67
ci_069                -4.887952e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9274e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7188e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.182
    reference variance = 0.170814
====================================================
  Execution time = 1.3802e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7488e-01
  Total weights = 1.957042296e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264545413995
                                         uncertainty =       0.001329538717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264545413995
                                         uncertainty =       0.001329538717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363671785
  error estimate for blocks of size 2^( 2) =       0.000377507150
  error estimate for blocks of size 2^( 3) =       0.000390442586
  error estimate for blocks of size 2^( 4) =       0.000399904134
  error estimate for blocks of size 2^( 5) =       0.000405519451
  error estimate for blocks of size 2^( 6) =       0.000409139124
  error estimate for blocks of size 2^( 7) =       0.000410589830

      target function =      -0.953427388618
              le_mean =     -17.211755022961
             les_mean =     296.519391235551
             stat err =       0.000406288135
             autocorr =       1.248099074878
   target nu stat err =       0.000406288135
   target dn stat err =       0.001737673858
      target stat err =       0.003034111258
              std dev =       0.514309571303
             le_variance =       0.264514335134


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721175502296e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953436035994       residual = 6.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953437188836       residual = 8.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953437345629       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953437431907       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953437441738       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953437446560       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953437448278       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953437447904       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953437447774       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953437447741       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 4.765818e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953436035994       residual = 6.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953436324908       residual = 8.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953436364180       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953436385780       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953436388236       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953436389442       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953436389871       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953436389778       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953436389745       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953436389737       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 1.193912e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953436035994       residual = 6.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953436108266       residual = 8.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953436118089       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953436123490       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953436124105       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953436124406       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953436124513       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953436124490       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953436124482       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953436124480       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+02 is 2.986320e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.035315 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6309e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -4.141639e-02 3 1  ON 0
ci_002                -3.157788e-02 3 1  ON 1
ci_003                -2.599335e-02 3 1  ON 2
ci_004                 2.363308e-02 3 1  ON 3
ci_005                 2.378651e-02 3 1  ON 4
ci_006                -2.078757e-02 3 1  ON 5
ci_007                -2.052435e-02 3 1  ON 6
ci_008                -8.640880e-03 3 1  ON 7
ci_009                -1.451248e-02 3 1  ON 8
ci_010                -9.554010e-03 3 1  ON 9
ci_011                -1.048470e-02 3 1  ON 10
ci_012                -1.003766e-02 3 1  ON 11
ci_013                -1.994677e-02 3 1  ON 12
ci_014                 1.253824e-02 3 1  ON 13
ci_015                 1.260942e-02 3 1  ON 14
ci_016                 1.696070e-02 3 1  ON 15
ci_017                 1.639244e-02 3 1  ON 16
ci_018                 1.001464e-02 3 1  ON 17
ci_019                 1.008175e-02 3 1  ON 18
ci_020                 1.709626e-02 3 1  ON 19
ci_021                 1.701150e-02 3 1  ON 20
ci_022                 9.244568e-03 3 1  ON 21
ci_023                 9.492629e-03 3 1  ON 22
ci_024                 9.662516e-03 3 1  ON 23
ci_025                 9.459809e-03 3 1  ON 24
ci_026                 1.098877e-02 3 1  ON 25
ci_027                 1.138052e-02 3 1  ON 26
ci_028                -1.494844e-02 3 1  ON 27
ci_029                -1.538033e-02 3 1  ON 28
ci_030                -9.440956e-03 3 1  ON 29
ci_031                -8.994059e-03 3 1  ON 30
ci_032                -1.483626e-02 3 1  ON 31
ci_033                 5.723246e-03 3 1  ON 32
ci_034                 5.516146e-03 3 1  ON 33
ci_035                -5.027256e-03 3 1  ON 34
ci_036                -1.249002e-02 3 1  ON 35
ci_037                -1.251078e-02 3 1  ON 36
ci_038                 1.686455e-03 3 1  ON 37
ci_039                 1.743642e-03 3 1  ON 38
ci_040                -2.980516e-03 3 1  ON 39
ci_041                 8.805696e-03 3 1  ON 40
ci_042                 8.882169e-03 3 1  ON 41
ci_043                -4.010884e-03 3 1  ON 42
ci_044                -3.978995e-03 3 1  ON 43
ci_045                -3.149627e-03 3 1  ON 44
ci_046                 5.742818e-03 3 1  ON 45
ci_047                 5.640249e-03 3 1  ON 46
ci_048                -1.246508e-02 3 1  ON 47
ci_049                -1.350339e-02 3 1  ON 48
ci_050                 3.495462e-03 3 1  ON 49
ci_051                 3.286757e-03 3 1  ON 50
ci_052                -2.365523e-03 3 1  ON 51
ci_053                -2.455304e-03 3 1  ON 52
ci_054                -2.821142e-03 3 1  ON 53
ci_055                -2.793102e-03 3 1  ON 54
ci_056                 5.297370e-03 3 1  ON 55
ci_057                 5.166480e-03 3 1  ON 56
ci_058                -1.676823e-03 3 1  ON 57
ci_059                -1.950437e-03 3 1  ON 58
ci_060                 4.881793e-03 3 1  ON 59
ci_061                 5.584180e-03 3 1  ON 60
ci_062                -3.640043e-03 3 1  ON 61
ci_063                -4.069842e-03 3 1  ON 62
ci_064                -3.040402e-03 3 1  ON 63
ci_065                -4.303192e-03 3 1  ON 64
ci_066                 4.447235e-03 3 1  ON 65
ci_067                 4.332076e-03 3 1  ON 66
ci_068                -4.466345e-03 3 1  ON 67
ci_069                -4.887879e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.3208
    reference variance = 0.89289
====================================================
  Execution time = 1.3687e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7808e-01
  Total weights = 1.9575e+06
  Execution time = 1.8563e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264655166384
                                         uncertainty =       0.001527624980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264655166384
                                         uncertainty =       0.001527624980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363802939
  error estimate for blocks of size 2^( 2) =       0.000377809118
  error estimate for blocks of size 2^( 3) =       0.000390554359
  error estimate for blocks of size 2^( 4) =       0.000400065496
  error estimate for blocks of size 2^( 5) =       0.000404979203
  error estimate for blocks of size 2^( 6) =       0.000407509465
  error estimate for blocks of size 2^( 7) =       0.000407293155

      target function =      -0.948027096003
              le_mean =     -17.212507060965
             les_mean =     296.548481070298
             stat err =       0.000404961830
             autocorr =       1.239069806238
   target nu stat err =       0.000404961830
   target dn stat err =       0.003261491744
      target stat err =       0.005523034189
              std dev =       0.514495050215
             le_variance =       0.264705156695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264654614659
                                         uncertainty =       0.001527565972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264654614659
                                         uncertainty =       0.001527565972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363802576
  error estimate for blocks of size 2^( 2) =       0.000377808557
  error estimate for blocks of size 2^( 3) =       0.000390553593
  error estimate for blocks of size 2^( 4) =       0.000400064679
  error estimate for blocks of size 2^( 5) =       0.000404978227
  error estimate for blocks of size 2^( 6) =       0.000407508456
  error estimate for blocks of size 2^( 7) =       0.000407292285

      target function =      -0.948023020583
              le_mean =     -17.212507086312
             les_mean =     296.548484370288
             stat err =       0.000404960912
             autocorr =       1.239066663641
   target nu stat err =       0.000404960912
   target dn stat err =       0.003261521790
      target stat err =       0.005523037178
              std dev =       0.514494536326
             le_variance =       0.264704627910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264654888990
                                         uncertainty =       0.001527595400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264654888990
                                         uncertainty =       0.001527595400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363802756
  error estimate for blocks of size 2^( 2) =       0.000377808836
  error estimate for blocks of size 2^( 3) =       0.000390553975
  error estimate for blocks of size 2^( 4) =       0.000400065086
  error estimate for blocks of size 2^( 5) =       0.000404978713
  error estimate for blocks of size 2^( 6) =       0.000407508959
  error estimate for blocks of size 2^( 7) =       0.000407292718

      target function =      -0.948025151500
              le_mean =     -17.212507073565
             les_mean =     296.548482662259
             stat err =       0.000404961369
             autocorr =       1.239068231565
   target nu stat err =       0.000404961369
   target dn stat err =       0.003261505941
      target stat err =       0.005523035384
              std dev =       0.514494791814
             le_variance =       0.264704890803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264655131593
                                         uncertainty =       0.001527621279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264655131593
                                         uncertainty =       0.001527621279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363802916
  error estimate for blocks of size 2^( 2) =       0.000377809082
  error estimate for blocks of size 2^( 3) =       0.000390554311
  error estimate for blocks of size 2^( 4) =       0.000400065444
  error estimate for blocks of size 2^( 5) =       0.000404979142
  error estimate for blocks of size 2^( 6) =       0.000407509402
  error estimate for blocks of size 2^( 7) =       0.000407293101

      target function =      -0.948026863484
              le_mean =     -17.212507062530
             les_mean =     296.548481262650
             stat err =       0.000404961772
             autocorr =       1.239069609339
   target nu stat err =       0.000404961772
   target dn stat err =       0.003261493427
      target stat err =       0.005523034307
              std dev =       0.514495017802
             le_variance =       0.264705123343


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948027096003        initial  <--
     2.5000e+01     2.5000e+02             4.7658e-06        -0.948023020583
     1.0000e+02     1.0000e+03             1.1939e-06        -0.948025151500
     4.0000e+02     4.0000e+03             2.9863e-07        -0.948026863484

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0667
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -4.141613e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599418e-02 3 1  ON 2
ci_004                 2.363303e-02 3 1  ON 3
ci_005                 2.378626e-02 3 1  ON 4
ci_006                -2.078761e-02 3 1  ON 5
ci_007                -2.052483e-02 3 1  ON 6
ci_008                -8.640573e-03 3 1  ON 7
ci_009                -1.451210e-02 3 1  ON 8
ci_010                -9.553386e-03 3 1  ON 9
ci_011                -1.048534e-02 3 1  ON 10
ci_012                -1.003774e-02 3 1  ON 11
ci_013                -1.994757e-02 3 1  ON 12
ci_014                 1.253804e-02 3 1  ON 13
ci_015                 1.260878e-02 3 1  ON 14
ci_016                 1.696088e-02 3 1  ON 15
ci_017                 1.639236e-02 3 1  ON 16
ci_018                 1.001460e-02 3 1  ON 17
ci_019                 1.008111e-02 3 1  ON 18
ci_020                 1.709720e-02 3 1  ON 19
ci_021                 1.701188e-02 3 1  ON 20
ci_022                 9.245200e-03 3 1  ON 21
ci_023                 9.492932e-03 3 1  ON 22
ci_024                 9.663710e-03 3 1  ON 23
ci_025                 9.460000e-03 3 1  ON 24
ci_026                 1.098871e-02 3 1  ON 25
ci_027                 1.138048e-02 3 1  ON 26
ci_028                -1.494841e-02 3 1  ON 27
ci_029                -1.538016e-02 3 1  ON 28
ci_030                -9.441245e-03 3 1  ON 29
ci_031                -8.993548e-03 3 1  ON 30
ci_032                -1.483588e-02 3 1  ON 31
ci_033                 5.723523e-03 3 1  ON 32
ci_034                 5.515372e-03 3 1  ON 33
ci_035                -5.026927e-03 3 1  ON 34
ci_036                -1.249012e-02 3 1  ON 35
ci_037                -1.251046e-02 3 1  ON 36
ci_038                 1.686541e-03 3 1  ON 37
ci_039                 1.743693e-03 3 1  ON 38
ci_040                -2.980565e-03 3 1  ON 39
ci_041                 8.806664e-03 3 1  ON 40
ci_042                 8.882045e-03 3 1  ON 41
ci_043                -4.010907e-03 3 1  ON 42
ci_044                -3.979257e-03 3 1  ON 43
ci_045                -3.149339e-03 3 1  ON 44
ci_046                 5.743117e-03 3 1  ON 45
ci_047                 5.639901e-03 3 1  ON 46
ci_048                -1.246441e-02 3 1  ON 47
ci_049                -1.350367e-02 3 1  ON 48
ci_050                 3.495421e-03 3 1  ON 49
ci_051                 3.286804e-03 3 1  ON 50
ci_052                -2.365708e-03 3 1  ON 51
ci_053                -2.455048e-03 3 1  ON 52
ci_054                -2.821802e-03 3 1  ON 53
ci_055                -2.793140e-03 3 1  ON 54
ci_056                 5.297798e-03 3 1  ON 55
ci_057                 5.166612e-03 3 1  ON 56
ci_058                -1.676330e-03 3 1  ON 57
ci_059                -1.950456e-03 3 1  ON 58
ci_060                 4.881264e-03 3 1  ON 59
ci_061                 5.584322e-03 3 1  ON 60
ci_062                -3.639860e-03 3 1  ON 61
ci_063                -4.069902e-03 3 1  ON 62
ci_064                -3.040206e-03 3 1  ON 63
ci_065                -4.303270e-03 3 1  ON 64
ci_066                 4.446872e-03 3 1  ON 65
ci_067                 4.331971e-03 3 1  ON 66
ci_068                -4.465789e-03 3 1  ON 67
ci_069                -4.887952e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9383e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7195e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1809
    reference variance = 0.153345
====================================================
  Execution time = 1.5709e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7712e-01
  Total weights = 1.957500787e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266467761517
                                         uncertainty =       0.001504607972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266467761517
                                         uncertainty =       0.001504607972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364985327
  error estimate for blocks of size 2^( 2) =       0.000378739552
  error estimate for blocks of size 2^( 3) =       0.000391693789
  error estimate for blocks of size 2^( 4) =       0.000400376670
  error estimate for blocks of size 2^( 5) =       0.000406265147
  error estimate for blocks of size 2^( 6) =       0.000410114453
  error estimate for blocks of size 2^( 7) =       0.000409776320

      target function =      -0.949667692543
              le_mean =     -17.212318277047
             les_mean =     296.541015884926
             stat err =       0.000406633148
             autocorr =       1.241237090985
   target nu stat err =       0.000406633148
   target dn stat err =       0.001921647593
      target stat err =       0.003315913660
              std dev =       0.516167199930
             le_variance =       0.266428578284


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721231827705e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949678138421       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949678329273       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949678353590       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949678365356       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949678367041       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949678366977       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949678367093       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949678367121       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949678367066       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949678367061       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 4.405674e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949678138421       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949678186146       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949678192226       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949678195168       residual = 9.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949678195588       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949678195571       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949678195602       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949678195609       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949678195598       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949678195595       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+03 is 1.101618e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949678138421       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949678150353       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949678151873       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949678152611       residual = 9.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949678152712       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949678152708       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949678152718       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949678152723       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949678152713       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949678152714       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+03 is 2.754171e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.038833 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8388e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.141609e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599407e-02 3 1  ON 2
ci_004                 2.363301e-02 3 1  ON 3
ci_005                 2.378622e-02 3 1  ON 4
ci_006                -2.078762e-02 3 1  ON 5
ci_007                -2.052494e-02 3 1  ON 6
ci_008                -8.640553e-03 3 1  ON 7
ci_009                -1.451203e-02 3 1  ON 8
ci_010                -9.553432e-03 3 1  ON 9
ci_011                -1.048529e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994755e-02 3 1  ON 12
ci_014                 1.253798e-02 3 1  ON 13
ci_015                 1.260886e-02 3 1  ON 14
ci_016                 1.696087e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001460e-02 3 1  ON 17
ci_019                 1.008114e-02 3 1  ON 18
ci_020                 1.709713e-02 3 1  ON 19
ci_021                 1.701189e-02 3 1  ON 20
ci_022                 9.245241e-03 3 1  ON 21
ci_023                 9.492916e-03 3 1  ON 22
ci_024                 9.663673e-03 3 1  ON 23
ci_025                 9.459897e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138048e-02 3 1  ON 26
ci_028                -1.494851e-02 3 1  ON 27
ci_029                -1.538010e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993615e-03 3 1  ON 30
ci_032                -1.483587e-02 3 1  ON 31
ci_033                 5.723535e-03 3 1  ON 32
ci_034                 5.515335e-03 3 1  ON 33
ci_035                -5.026962e-03 3 1  ON 34
ci_036                -1.249018e-02 3 1  ON 35
ci_037                -1.251042e-02 3 1  ON 36
ci_038                 1.686550e-03 3 1  ON 37
ci_039                 1.743695e-03 3 1  ON 38
ci_040                -2.980598e-03 3 1  ON 39
ci_041                 8.806596e-03 3 1  ON 40
ci_042                 8.882032e-03 3 1  ON 41
ci_043                -4.010890e-03 3 1  ON 42
ci_044                -3.979253e-03 3 1  ON 43
ci_045                -3.149283e-03 3 1  ON 44
ci_046                 5.743115e-03 3 1  ON 45
ci_047                 5.639863e-03 3 1  ON 46
ci_048                -1.246436e-02 3 1  ON 47
ci_049                -1.350363e-02 3 1  ON 48
ci_050                 3.495430e-03 3 1  ON 49
ci_051                 3.286777e-03 3 1  ON 50
ci_052                -2.365770e-03 3 1  ON 51
ci_053                -2.455052e-03 3 1  ON 52
ci_054                -2.821749e-03 3 1  ON 53
ci_055                -2.793143e-03 3 1  ON 54
ci_056                 5.297724e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676418e-03 3 1  ON 57
ci_059                -1.950469e-03 3 1  ON 58
ci_060                 4.881258e-03 3 1  ON 59
ci_061                 5.584217e-03 3 1  ON 60
ci_062                -3.639886e-03 3 1  ON 61
ci_063                -4.069858e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303202e-03 3 1  ON 64
ci_066                 4.446878e-03 3 1  ON 65
ci_067                 4.331988e-03 3 1  ON 66
ci_068                -4.465770e-03 3 1  ON 67
ci_069                -4.888000e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1737
    reference variance = 0.216199
====================================================
  Execution time = 1.3601e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7735e-01
  Total weights = 1.9574e+06
  Execution time = 2.1588e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266946557962
                                         uncertainty =       0.001612971579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266946557962
                                         uncertainty =       0.001612971579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365333589
  error estimate for blocks of size 2^( 2) =       0.000379647131
  error estimate for blocks of size 2^( 3) =       0.000391722598
  error estimate for blocks of size 2^( 4) =       0.000400333559
  error estimate for blocks of size 2^( 5) =       0.000405085535
  error estimate for blocks of size 2^( 6) =       0.000406061225
  error estimate for blocks of size 2^( 7) =       0.000408340962

      target function =      -0.949269465712
              le_mean =     -17.212162407581
             les_mean =     296.535881921183
             stat err =       0.000404955321
             autocorr =       1.228669312516
   target nu stat err =       0.000404955321
   target dn stat err =       0.002199198121
      target stat err =       0.003768801661
              std dev =       0.516659716677
             le_variance =       0.266937262836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266946485164
                                         uncertainty =       0.001612954183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266946485164
                                         uncertainty =       0.001612954183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365333539
  error estimate for blocks of size 2^( 2) =       0.000379647094
  error estimate for blocks of size 2^( 3) =       0.000391722556
  error estimate for blocks of size 2^( 4) =       0.000400333530
  error estimate for blocks of size 2^( 5) =       0.000405085525
  error estimate for blocks of size 2^( 6) =       0.000406061222
  error estimate for blocks of size 2^( 7) =       0.000408340946

      target function =      -0.949269450345
              le_mean =     -17.212162406523
             les_mean =     296.535881894564
             stat err =       0.000404955306
             autocorr =       1.228669561767
   target nu stat err =       0.000404955306
   target dn stat err =       0.002199111899
      target stat err =       0.003768659123
              std dev =       0.516659645468
             le_variance =       0.266937189255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266946521542
                                         uncertainty =       0.001612962879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266946521542
                                         uncertainty =       0.001612962879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365333564
  error estimate for blocks of size 2^( 2) =       0.000379647112
  error estimate for blocks of size 2^( 3) =       0.000391722577
  error estimate for blocks of size 2^( 4) =       0.000400333544
  error estimate for blocks of size 2^( 5) =       0.000405085530
  error estimate for blocks of size 2^( 6) =       0.000406061224
  error estimate for blocks of size 2^( 7) =       0.000408340954

      target function =      -0.949269486130
              le_mean =     -17.212162407051
             les_mean =     296.535881891127
             stat err =       0.000404955313
             autocorr =       1.228669437184
   target nu stat err =       0.000404955313
   target dn stat err =       0.002199154905
      target stat err =       0.003768730437
              std dev =       0.516659681052
             le_variance =       0.266937226025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266946553408
                                         uncertainty =       0.001612970491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266946553408
                                         uncertainty =       0.001612970491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365333586
  error estimate for blocks of size 2^( 2) =       0.000379647129
  error estimate for blocks of size 2^( 3) =       0.000391722596
  error estimate for blocks of size 2^( 4) =       0.000400333557
  error estimate for blocks of size 2^( 5) =       0.000405085535
  error estimate for blocks of size 2^( 6) =       0.000406061225
  error estimate for blocks of size 2^( 7) =       0.000408340961

      target function =      -0.949269471851
              le_mean =     -17.212162407514
             les_mean =     296.535881915291
             stat err =       0.000404955320
             autocorr =       1.228669328104
   target nu stat err =       0.000404955320
   target dn stat err =       0.002199192709
      target stat err =       0.003768792769
              std dev =       0.516659712222
             le_variance =       0.266937258233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949269465712        initial
     2.5000e+02     2.5000e+03             4.4057e-07        -0.949269450345
     1.0000e+03     1.0000e+04             1.1016e-07        -0.949269486130  <--
     4.0000e+03     4.0000e+04             2.7542e-08        -0.949269471851

*****************************************************************************
Applying the update for shift_i =   1.0000e+03     and shift_s =   1.0000e+04
*****************************************************************************

  Execution time = 2.3986e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.141609e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599407e-02 3 1  ON 2
ci_004                 2.363301e-02 3 1  ON 3
ci_005                 2.378622e-02 3 1  ON 4
ci_006                -2.078762e-02 3 1  ON 5
ci_007                -2.052494e-02 3 1  ON 6
ci_008                -8.640553e-03 3 1  ON 7
ci_009                -1.451203e-02 3 1  ON 8
ci_010                -9.553432e-03 3 1  ON 9
ci_011                -1.048529e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994755e-02 3 1  ON 12
ci_014                 1.253798e-02 3 1  ON 13
ci_015                 1.260886e-02 3 1  ON 14
ci_016                 1.696087e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001460e-02 3 1  ON 17
ci_019                 1.008114e-02 3 1  ON 18
ci_020                 1.709713e-02 3 1  ON 19
ci_021                 1.701189e-02 3 1  ON 20
ci_022                 9.245241e-03 3 1  ON 21
ci_023                 9.492916e-03 3 1  ON 22
ci_024                 9.663673e-03 3 1  ON 23
ci_025                 9.459897e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138048e-02 3 1  ON 26
ci_028                -1.494851e-02 3 1  ON 27
ci_029                -1.538010e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993615e-03 3 1  ON 30
ci_032                -1.483587e-02 3 1  ON 31
ci_033                 5.723535e-03 3 1  ON 32
ci_034                 5.515335e-03 3 1  ON 33
ci_035                -5.026962e-03 3 1  ON 34
ci_036                -1.249018e-02 3 1  ON 35
ci_037                -1.251042e-02 3 1  ON 36
ci_038                 1.686550e-03 3 1  ON 37
ci_039                 1.743695e-03 3 1  ON 38
ci_040                -2.980598e-03 3 1  ON 39
ci_041                 8.806596e-03 3 1  ON 40
ci_042                 8.882032e-03 3 1  ON 41
ci_043                -4.010890e-03 3 1  ON 42
ci_044                -3.979253e-03 3 1  ON 43
ci_045                -3.149283e-03 3 1  ON 44
ci_046                 5.743115e-03 3 1  ON 45
ci_047                 5.639863e-03 3 1  ON 46
ci_048                -1.246436e-02 3 1  ON 47
ci_049                -1.350363e-02 3 1  ON 48
ci_050                 3.495430e-03 3 1  ON 49
ci_051                 3.286777e-03 3 1  ON 50
ci_052                -2.365770e-03 3 1  ON 51
ci_053                -2.455052e-03 3 1  ON 52
ci_054                -2.821749e-03 3 1  ON 53
ci_055                -2.793143e-03 3 1  ON 54
ci_056                 5.297724e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676418e-03 3 1  ON 57
ci_059                -1.950469e-03 3 1  ON 58
ci_060                 4.881258e-03 3 1  ON 59
ci_061                 5.584217e-03 3 1  ON 60
ci_062                -3.639886e-03 3 1  ON 61
ci_063                -4.069858e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303202e-03 3 1  ON 64
ci_066                 4.446878e-03 3 1  ON 65
ci_067                 4.331988e-03 3 1  ON 66
ci_068                -4.465770e-03 3 1  ON 67
ci_069                -4.888000e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2399e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1743
    reference variance = 0.160535
====================================================
  Execution time = 1.3807e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7472e-01
  Total weights = 1.957592994e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5031e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264897814243
                                         uncertainty =       0.001272902005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264897814243
                                         uncertainty =       0.001272902005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363897384
  error estimate for blocks of size 2^( 2) =       0.000378127502
  error estimate for blocks of size 2^( 3) =       0.000391227821
  error estimate for blocks of size 2^( 4) =       0.000401148271
  error estimate for blocks of size 2^( 5) =       0.000406235265
  error estimate for blocks of size 2^( 6) =       0.000410106249
  error estimate for blocks of size 2^( 7) =       0.000412320181

      target function =      -0.953729075321
              le_mean =     -17.212375440129
             les_mean =     296.540584560646
             stat err =       0.000407452492
             autocorr =       1.253707106869
   target nu stat err =       0.000407452492
   target dn stat err =       0.001809006996
      target stat err =       0.003157805498
              std dev =       0.514628616340
             le_variance =       0.264842612756


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721237544013e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953738395228       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953738585896       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953738610637       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953738614227       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953738615850       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953738616254       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953738616360       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953738616344       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953738616354       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953738616345       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 4.675549e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953738395228       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953738442907       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953738449094       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953738449991       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953738450397       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953738450498       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953738450524       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953738450520       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953738450523       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953738450521       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+03 is 1.169135e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953738395228       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953738407149       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953738408695       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953738408920       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953738409021       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953738409047       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953738409053       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953738409057       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953738409053       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953738409052       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+03 is 2.922991e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042345 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6319e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.141614e-02 3 1  ON 0
ci_002                -3.157720e-02 3 1  ON 1
ci_003                -2.599408e-02 3 1  ON 2
ci_004                 2.363301e-02 3 1  ON 3
ci_005                 2.378628e-02 3 1  ON 4
ci_006                -2.078762e-02 3 1  ON 5
ci_007                -2.052500e-02 3 1  ON 6
ci_008                -8.640482e-03 3 1  ON 7
ci_009                -1.451207e-02 3 1  ON 8
ci_010                -9.553430e-03 3 1  ON 9
ci_011                -1.048528e-02 3 1  ON 10
ci_012                -1.003782e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253801e-02 3 1  ON 13
ci_015                 1.260890e-02 3 1  ON 14
ci_016                 1.696081e-02 3 1  ON 15
ci_017                 1.639231e-02 3 1  ON 16
ci_018                 1.001469e-02 3 1  ON 17
ci_019                 1.008116e-02 3 1  ON 18
ci_020                 1.709712e-02 3 1  ON 19
ci_021                 1.701183e-02 3 1  ON 20
ci_022                 9.245259e-03 3 1  ON 21
ci_023                 9.492915e-03 3 1  ON 22
ci_024                 9.663724e-03 3 1  ON 23
ci_025                 9.460006e-03 3 1  ON 24
ci_026                 1.098878e-02 3 1  ON 25
ci_027                 1.138040e-02 3 1  ON 26
ci_028                -1.494859e-02 3 1  ON 27
ci_029                -1.538014e-02 3 1  ON 28
ci_030                -9.441161e-03 3 1  ON 29
ci_031                -8.993629e-03 3 1  ON 30
ci_032                -1.483588e-02 3 1  ON 31
ci_033                 5.723521e-03 3 1  ON 32
ci_034                 5.515362e-03 3 1  ON 33
ci_035                -5.026918e-03 3 1  ON 34
ci_036                -1.249012e-02 3 1  ON 35
ci_037                -1.251050e-02 3 1  ON 36
ci_038                 1.686568e-03 3 1  ON 37
ci_039                 1.743697e-03 3 1  ON 38
ci_040                -2.980656e-03 3 1  ON 39
ci_041                 8.806501e-03 3 1  ON 40
ci_042                 8.882031e-03 3 1  ON 41
ci_043                -4.010879e-03 3 1  ON 42
ci_044                -3.979257e-03 3 1  ON 43
ci_045                -3.149320e-03 3 1  ON 44
ci_046                 5.743062e-03 3 1  ON 45
ci_047                 5.639891e-03 3 1  ON 46
ci_048                -1.246440e-02 3 1  ON 47
ci_049                -1.350362e-02 3 1  ON 48
ci_050                 3.495483e-03 3 1  ON 49
ci_051                 3.286757e-03 3 1  ON 50
ci_052                -2.365711e-03 3 1  ON 51
ci_053                -2.455132e-03 3 1  ON 52
ci_054                -2.821702e-03 3 1  ON 53
ci_055                -2.793142e-03 3 1  ON 54
ci_056                 5.297731e-03 3 1  ON 55
ci_057                 5.166732e-03 3 1  ON 56
ci_058                -1.676445e-03 3 1  ON 57
ci_059                -1.950466e-03 3 1  ON 58
ci_060                 4.881375e-03 3 1  ON 59
ci_061                 5.584191e-03 3 1  ON 60
ci_062                -3.639866e-03 3 1  ON 61
ci_063                -4.069811e-03 3 1  ON 62
ci_064                -3.040342e-03 3 1  ON 63
ci_065                -4.303218e-03 3 1  ON 64
ci_066                 4.446890e-03 3 1  ON 65
ci_067                 4.332053e-03 3 1  ON 66
ci_068                -4.465858e-03 3 1  ON 67
ci_069                -4.887970e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.203
    reference variance = 0.177308
====================================================
  Execution time = 1.3596e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8014e-01
  Total weights = 1.9572e+06
  Execution time = 1.8640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269575736098
                                         uncertainty =       0.001672518210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269575736098
                                         uncertainty =       0.001672518210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367123384
  error estimate for blocks of size 2^( 2) =       0.000381183088
  error estimate for blocks of size 2^( 3) =       0.000393660907
  error estimate for blocks of size 2^( 4) =       0.000402084994
  error estimate for blocks of size 2^( 5) =       0.000407195701
  error estimate for blocks of size 2^( 6) =       0.000408572091
  error estimate for blocks of size 2^( 7) =       0.000408042258

      target function =      -0.944593904170
              le_mean =     -17.212023267330
             les_mean =     296.533883469719
             stat err =       0.000406473761
             autocorr =       1.225860177390
   target nu stat err =       0.000406473761
   target dn stat err =       0.002187504898
      target stat err =       0.003712871687
              std dev =       0.519190868061
             le_variance =       0.269559157478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269575736336
                                         uncertainty =       0.001672523245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269575736336
                                         uncertainty =       0.001672523245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367123384
  error estimate for blocks of size 2^( 2) =       0.000381183059
  error estimate for blocks of size 2^( 3) =       0.000393660842
  error estimate for blocks of size 2^( 4) =       0.000402084926
  error estimate for blocks of size 2^( 5) =       0.000407195626
  error estimate for blocks of size 2^( 6) =       0.000408572019
  error estimate for blocks of size 2^( 7) =       0.000408042212

      target function =      -0.944593214296
              le_mean =     -17.212023264819
             les_mean =     296.533883797508
             stat err =       0.000406473696
             autocorr =       1.225859782248
   target nu stat err =       0.000406473696
   target dn stat err =       0.002187506529
      target stat err =       0.003712868990
              std dev =       0.519190868568
             le_variance =       0.269559158004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269575736205
                                         uncertainty =       0.001672520728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269575736205
                                         uncertainty =       0.001672520728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367123384
  error estimate for blocks of size 2^( 2) =       0.000381183074
  error estimate for blocks of size 2^( 3) =       0.000393660875
  error estimate for blocks of size 2^( 4) =       0.000402084960
  error estimate for blocks of size 2^( 5) =       0.000407195663
  error estimate for blocks of size 2^( 6) =       0.000408572055
  error estimate for blocks of size 2^( 7) =       0.000408042235

      target function =      -0.944593574238
              le_mean =     -17.212023266072
             les_mean =     296.533883624525
             stat err =       0.000406473728
             autocorr =       1.225859979774
   target nu stat err =       0.000406473728
   target dn stat err =       0.002187505639
      target stat err =       0.003712870331
              std dev =       0.519190868303
             le_variance =       0.269559157729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269575736110
                                         uncertainty =       0.001672518525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269575736110
                                         uncertainty =       0.001672518525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367123384
  error estimate for blocks of size 2^( 2) =       0.000381183086
  error estimate for blocks of size 2^( 3) =       0.000393660903
  error estimate for blocks of size 2^( 4) =       0.000402084990
  error estimate for blocks of size 2^( 5) =       0.000407195696
  error estimate for blocks of size 2^( 6) =       0.000408572086
  error estimate for blocks of size 2^( 7) =       0.000408042255

      target function =      -0.944593864377
              le_mean =     -17.212023267172
             les_mean =     296.533883488192
             stat err =       0.000406473757
             autocorr =       1.225860152688
   target nu stat err =       0.000406473757
   target dn stat err =       0.002187504983
      target stat err =       0.003712871516
              std dev =       0.519190868090
             le_variance =       0.269559157508


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944593904170        initial  <--
     2.5000e+02     2.5000e+03             4.6755e-07        -0.944593214296
     1.0000e+03     1.0000e+04             1.1691e-07        -0.944593574238
     4.0000e+03     4.0000e+04             2.9230e-08        -0.944593864377

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0038
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.141609e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599407e-02 3 1  ON 2
ci_004                 2.363301e-02 3 1  ON 3
ci_005                 2.378622e-02 3 1  ON 4
ci_006                -2.078762e-02 3 1  ON 5
ci_007                -2.052494e-02 3 1  ON 6
ci_008                -8.640553e-03 3 1  ON 7
ci_009                -1.451203e-02 3 1  ON 8
ci_010                -9.553432e-03 3 1  ON 9
ci_011                -1.048529e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994755e-02 3 1  ON 12
ci_014                 1.253798e-02 3 1  ON 13
ci_015                 1.260886e-02 3 1  ON 14
ci_016                 1.696087e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001460e-02 3 1  ON 17
ci_019                 1.008114e-02 3 1  ON 18
ci_020                 1.709713e-02 3 1  ON 19
ci_021                 1.701189e-02 3 1  ON 20
ci_022                 9.245241e-03 3 1  ON 21
ci_023                 9.492916e-03 3 1  ON 22
ci_024                 9.663673e-03 3 1  ON 23
ci_025                 9.459897e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138048e-02 3 1  ON 26
ci_028                -1.494851e-02 3 1  ON 27
ci_029                -1.538010e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993615e-03 3 1  ON 30
ci_032                -1.483587e-02 3 1  ON 31
ci_033                 5.723535e-03 3 1  ON 32
ci_034                 5.515335e-03 3 1  ON 33
ci_035                -5.026962e-03 3 1  ON 34
ci_036                -1.249018e-02 3 1  ON 35
ci_037                -1.251042e-02 3 1  ON 36
ci_038                 1.686550e-03 3 1  ON 37
ci_039                 1.743695e-03 3 1  ON 38
ci_040                -2.980598e-03 3 1  ON 39
ci_041                 8.806596e-03 3 1  ON 40
ci_042                 8.882032e-03 3 1  ON 41
ci_043                -4.010890e-03 3 1  ON 42
ci_044                -3.979253e-03 3 1  ON 43
ci_045                -3.149283e-03 3 1  ON 44
ci_046                 5.743115e-03 3 1  ON 45
ci_047                 5.639863e-03 3 1  ON 46
ci_048                -1.246436e-02 3 1  ON 47
ci_049                -1.350363e-02 3 1  ON 48
ci_050                 3.495430e-03 3 1  ON 49
ci_051                 3.286777e-03 3 1  ON 50
ci_052                -2.365770e-03 3 1  ON 51
ci_053                -2.455052e-03 3 1  ON 52
ci_054                -2.821749e-03 3 1  ON 53
ci_055                -2.793143e-03 3 1  ON 54
ci_056                 5.297724e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676418e-03 3 1  ON 57
ci_059                -1.950469e-03 3 1  ON 58
ci_060                 4.881258e-03 3 1  ON 59
ci_061                 5.584217e-03 3 1  ON 60
ci_062                -3.639886e-03 3 1  ON 61
ci_063                -4.069858e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303202e-03 3 1  ON 64
ci_066                 4.446878e-03 3 1  ON 65
ci_067                 4.331988e-03 3 1  ON 66
ci_068                -4.465770e-03 3 1  ON 67
ci_069                -4.888000e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.187
    reference variance = 0.21331
====================================================
  Execution time = 1.3819e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7714e-01
  Total weights = 1.957375139e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265978901498
                                         uncertainty =       0.001449638155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265978901498
                                         uncertainty =       0.001449638155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364666068
  error estimate for blocks of size 2^( 2) =       0.000378850154
  error estimate for blocks of size 2^( 3) =       0.000392436024
  error estimate for blocks of size 2^( 4) =       0.000402418164
  error estimate for blocks of size 2^( 5) =       0.000408204904
  error estimate for blocks of size 2^( 6) =       0.000409802466
  error estimate for blocks of size 2^( 7) =       0.000412048625

      target function =      -0.949631068140
              le_mean =     -17.212360816348
             les_mean =     296.542500559635
             stat err =       0.000408118540
             autocorr =       1.252512128677
   target nu stat err =       0.000408118540
   target dn stat err =       0.002218464124
      target stat err =       0.003805944095
              std dev =       0.515715698787
             le_variance =       0.265962681976


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721236081635e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949645275501       residual = 7.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949645288572       residual = 8.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949645290327       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949645291019       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949645291091       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949645291117       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949645291125       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949645291130       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949645291127       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 4.346486e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949645275501       residual = 7.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949645278769       residual = 8.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949645279208       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949645279381       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949645279400       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949645279406       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949645279397       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949645279408       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949645279385       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+04 is 1.086649e-08

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949645275501       residual = 7.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949645276318       residual = 8.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949645276428       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949645276474       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949645276476       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949645276478       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949645276521       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949645276413       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949645276478       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+04 is 2.716640e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049779 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6316e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.141609e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599407e-02 3 1  ON 2
ci_004                 2.363301e-02 3 1  ON 3
ci_005                 2.378622e-02 3 1  ON 4
ci_006                -2.078763e-02 3 1  ON 5
ci_007                -2.052494e-02 3 1  ON 6
ci_008                -8.640559e-03 3 1  ON 7
ci_009                -1.451203e-02 3 1  ON 8
ci_010                -9.553430e-03 3 1  ON 9
ci_011                -1.048529e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994755e-02 3 1  ON 12
ci_014                 1.253798e-02 3 1  ON 13
ci_015                 1.260885e-02 3 1  ON 14
ci_016                 1.696087e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001459e-02 3 1  ON 17
ci_019                 1.008115e-02 3 1  ON 18
ci_020                 1.709712e-02 3 1  ON 19
ci_021                 1.701189e-02 3 1  ON 20
ci_022                 9.245248e-03 3 1  ON 21
ci_023                 9.492910e-03 3 1  ON 22
ci_024                 9.663665e-03 3 1  ON 23
ci_025                 9.459890e-03 3 1  ON 24
ci_026                 1.098874e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494851e-02 3 1  ON 27
ci_029                -1.538010e-02 3 1  ON 28
ci_030                -9.441172e-03 3 1  ON 29
ci_031                -8.993606e-03 3 1  ON 30
ci_032                -1.483587e-02 3 1  ON 31
ci_033                 5.723532e-03 3 1  ON 32
ci_034                 5.515339e-03 3 1  ON 33
ci_035                -5.026960e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251042e-02 3 1  ON 36
ci_038                 1.686553e-03 3 1  ON 37
ci_039                 1.743695e-03 3 1  ON 38
ci_040                -2.980594e-03 3 1  ON 39
ci_041                 8.806591e-03 3 1  ON 40
ci_042                 8.882031e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979257e-03 3 1  ON 43
ci_045                -3.149282e-03 3 1  ON 44
ci_046                 5.743113e-03 3 1  ON 45
ci_047                 5.639867e-03 3 1  ON 46
ci_048                -1.246437e-02 3 1  ON 47
ci_049                -1.350363e-02 3 1  ON 48
ci_050                 3.495428e-03 3 1  ON 49
ci_051                 3.286776e-03 3 1  ON 50
ci_052                -2.365771e-03 3 1  ON 51
ci_053                -2.455060e-03 3 1  ON 52
ci_054                -2.821748e-03 3 1  ON 53
ci_055                -2.793140e-03 3 1  ON 54
ci_056                 5.297727e-03 3 1  ON 55
ci_057                 5.166684e-03 3 1  ON 56
ci_058                -1.676421e-03 3 1  ON 57
ci_059                -1.950466e-03 3 1  ON 58
ci_060                 4.881266e-03 3 1  ON 59
ci_061                 5.584214e-03 3 1  ON 60
ci_062                -3.639892e-03 3 1  ON 61
ci_063                -4.069855e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303201e-03 3 1  ON 64
ci_066                 4.446874e-03 3 1  ON 65
ci_067                 4.331988e-03 3 1  ON 66
ci_068                -4.465769e-03 3 1  ON 67
ci_069                -4.887999e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2529
    reference variance = 0.173509
====================================================
  Execution time = 1.3543e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7842e-01
  Total weights = 1.9574e+06
  Execution time = 1.8430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268075198685
                                         uncertainty =       0.001463515905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268075198685
                                         uncertainty =       0.001463515905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366165306
  error estimate for blocks of size 2^( 2) =       0.000379790127
  error estimate for blocks of size 2^( 3) =       0.000392258725
  error estimate for blocks of size 2^( 4) =       0.000400812609
  error estimate for blocks of size 2^( 5) =       0.000405234720
  error estimate for blocks of size 2^( 6) =       0.000408230679
  error estimate for blocks of size 2^( 7) =       0.000409131496

      target function =      -0.947474844572
              le_mean =     -17.212508196006
             les_mean =     296.548860385868
             stat err =       0.000405852376
             autocorr =       1.228518781139
   target nu stat err =       0.000405852376
   target dn stat err =       0.002102650941
      target stat err =       0.003598749559
              std dev =       0.517835941943
             le_variance =       0.268154062768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268075197808
                                         uncertainty =       0.001463515633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268075197808
                                         uncertainty =       0.001463515633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366165306
  error estimate for blocks of size 2^( 2) =       0.000379790126
  error estimate for blocks of size 2^( 3) =       0.000392258724
  error estimate for blocks of size 2^( 4) =       0.000400812607
  error estimate for blocks of size 2^( 5) =       0.000405234718
  error estimate for blocks of size 2^( 6) =       0.000408230677
  error estimate for blocks of size 2^( 7) =       0.000409131495

      target function =      -0.947474896024
              le_mean =     -17.212508196302
             les_mean =     296.548860365438
             stat err =       0.000405852374
             autocorr =       1.228518770419
   target nu stat err =       0.000405852374
   target dn stat err =       0.002102639419
      target stat err =       0.003598731008
              std dev =       0.517835941574
             le_variance =       0.268154062386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268075198246
                                         uncertainty =       0.001463515769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268075198246
                                         uncertainty =       0.001463515769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366165306
  error estimate for blocks of size 2^( 2) =       0.000379790126
  error estimate for blocks of size 2^( 3) =       0.000392258725
  error estimate for blocks of size 2^( 4) =       0.000400812608
  error estimate for blocks of size 2^( 5) =       0.000405234719
  error estimate for blocks of size 2^( 6) =       0.000408230678
  error estimate for blocks of size 2^( 7) =       0.000409131495

      target function =      -0.947474870423
              le_mean =     -17.212508196154
             les_mean =     296.548860375578
             stat err =       0.000405852375
             autocorr =       1.228518775767
   target nu stat err =       0.000405852375
   target dn stat err =       0.002102645180
      target stat err =       0.003598740284
              std dev =       0.517835941758
             le_variance =       0.268154062577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268075198630
                                         uncertainty =       0.001463515888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268075198630
                                         uncertainty =       0.001463515888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366165306
  error estimate for blocks of size 2^( 2) =       0.000379790127
  error estimate for blocks of size 2^( 3) =       0.000392258725
  error estimate for blocks of size 2^( 4) =       0.000400812609
  error estimate for blocks of size 2^( 5) =       0.000405234720
  error estimate for blocks of size 2^( 6) =       0.000408230679
  error estimate for blocks of size 2^( 7) =       0.000409131496

      target function =      -0.947474847817
              le_mean =     -17.212508196025
             les_mean =     296.548860384573
             stat err =       0.000405852376
             autocorr =       1.228518780461
   target nu stat err =       0.000405852376
   target dn stat err =       0.002102650221
      target stat err =       0.003598748400
              std dev =       0.517835941919
             le_variance =       0.268154062744


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947474844572        initial
     2.5000e+03     2.5000e+04             4.3465e-08        -0.947474896024  <--
     1.0000e+04     1.0000e+05             1.0866e-08        -0.947474870423
     4.0000e+04     4.0000e+05             2.7166e-09        -0.947474847817

*****************************************************************************
Applying the update for shift_i =   2.5000e+03     and shift_s =   2.5000e+04
*****************************************************************************

  Execution time = 2.2838e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157723e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363300e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078763e-02 3 1  ON 5
ci_007                -2.052496e-02 3 1  ON 6
ci_008                -8.640575e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553426e-03 3 1  ON 9
ci_011                -1.048531e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994755e-02 3 1  ON 12
ci_014                 1.253798e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639233e-02 3 1  ON 16
ci_018                 1.001458e-02 3 1  ON 17
ci_019                 1.008118e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701189e-02 3 1  ON 20
ci_022                 9.245269e-03 3 1  ON 21
ci_023                 9.492892e-03 3 1  ON 22
ci_024                 9.663641e-03 3 1  ON 23
ci_025                 9.459868e-03 3 1  ON 24
ci_026                 1.098874e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538011e-02 3 1  ON 28
ci_030                -9.441180e-03 3 1  ON 29
ci_031                -8.993581e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723521e-03 3 1  ON 32
ci_034                 5.515353e-03 3 1  ON 33
ci_035                -5.026956e-03 3 1  ON 34
ci_036                -1.249020e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686562e-03 3 1  ON 37
ci_039                 1.743695e-03 3 1  ON 38
ci_040                -2.980583e-03 3 1  ON 39
ci_041                 8.806577e-03 3 1  ON 40
ci_042                 8.882028e-03 3 1  ON 41
ci_043                -4.010888e-03 3 1  ON 42
ci_044                -3.979271e-03 3 1  ON 43
ci_045                -3.149278e-03 3 1  ON 44
ci_046                 5.743109e-03 3 1  ON 45
ci_047                 5.639876e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350363e-02 3 1  ON 48
ci_050                 3.495424e-03 3 1  ON 49
ci_051                 3.286773e-03 3 1  ON 50
ci_052                -2.365772e-03 3 1  ON 51
ci_053                -2.455083e-03 3 1  ON 52
ci_054                -2.821743e-03 3 1  ON 53
ci_055                -2.793132e-03 3 1  ON 54
ci_056                 5.297733e-03 3 1  ON 55
ci_057                 5.166679e-03 3 1  ON 56
ci_058                -1.676429e-03 3 1  ON 57
ci_059                -1.950459e-03 3 1  ON 58
ci_060                 4.881289e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639909e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303200e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331988e-03 3 1  ON 66
ci_068                -4.465766e-03 3 1  ON 67
ci_069                -4.887999e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9169e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7195e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1664
    reference variance = 0.189699
====================================================
  Execution time = 1.3917e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8247e-01
  Total weights = 1.957395195e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5130e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266482582054
                                         uncertainty =       0.001781761797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266482582054
                                         uncertainty =       0.001781761797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364979499
  error estimate for blocks of size 2^( 2) =       0.000378582963
  error estimate for blocks of size 2^( 3) =       0.000391402085
  error estimate for blocks of size 2^( 4) =       0.000400642015
  error estimate for blocks of size 2^( 5) =       0.000405614667
  error estimate for blocks of size 2^( 6) =       0.000409013383
  error estimate for blocks of size 2^( 7) =       0.000411584526

      target function =      -0.940700675757
              le_mean =     -17.211989164667
             les_mean =     296.535041998265
             stat err =       0.000406713648
             autocorr =       1.241768243894
   target nu stat err =       0.000406713648
   target dn stat err =       0.003615077066
      target stat err =       0.006013317200
              std dev =       0.516158958083
             le_variance =       0.266420070009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721198916467e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940738242595       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940738357192       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940738381417       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940738386234       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940738387541       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940738387795       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940738387701       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940738387734       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940738387731       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940738387742       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 3.246586e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940738242595       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940738271247       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940738277304       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940738278508       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940738278832       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940738278895       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940738278875       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940738278883       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940738278884       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940738278885       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 8.117150e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940738242595       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940738249759       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940738251273       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940738251574       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940738251653       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940738251662       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940738251681       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940738251674       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940738251689       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940738251669       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+04 is 2.029330e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6448e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.141607e-02 3 1  ON 0
ci_002                -3.157724e-02 3 1  ON 1
ci_003                -2.599401e-02 3 1  ON 2
ci_004                 2.363308e-02 3 1  ON 3
ci_005                 2.378618e-02 3 1  ON 4
ci_006                -2.078763e-02 3 1  ON 5
ci_007                -2.052497e-02 3 1  ON 6
ci_008                -8.640544e-03 3 1  ON 7
ci_009                -1.451208e-02 3 1  ON 8
ci_010                -9.553363e-03 3 1  ON 9
ci_011                -1.048528e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994751e-02 3 1  ON 12
ci_014                 1.253798e-02 3 1  ON 13
ci_015                 1.260883e-02 3 1  ON 14
ci_016                 1.696083e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001463e-02 3 1  ON 17
ci_019                 1.008118e-02 3 1  ON 18
ci_020                 1.709711e-02 3 1  ON 19
ci_021                 1.701189e-02 3 1  ON 20
ci_022                 9.245256e-03 3 1  ON 21
ci_023                 9.492892e-03 3 1  ON 22
ci_024                 9.663675e-03 3 1  ON 23
ci_025                 9.459928e-03 3 1  ON 24
ci_026                 1.098869e-02 3 1  ON 25
ci_027                 1.138043e-02 3 1  ON 26
ci_028                -1.494851e-02 3 1  ON 27
ci_029                -1.538010e-02 3 1  ON 28
ci_030                -9.441171e-03 3 1  ON 29
ci_031                -8.993572e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723550e-03 3 1  ON 32
ci_034                 5.515383e-03 3 1  ON 33
ci_035                -5.026945e-03 3 1  ON 34
ci_036                -1.249021e-02 3 1  ON 35
ci_037                -1.251044e-02 3 1  ON 36
ci_038                 1.686540e-03 3 1  ON 37
ci_039                 1.743692e-03 3 1  ON 38
ci_040                -2.980580e-03 3 1  ON 39
ci_041                 8.806588e-03 3 1  ON 40
ci_042                 8.882017e-03 3 1  ON 41
ci_043                -4.010885e-03 3 1  ON 42
ci_044                -3.979285e-03 3 1  ON 43
ci_045                -3.149271e-03 3 1  ON 44
ci_046                 5.743101e-03 3 1  ON 45
ci_047                 5.639905e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350360e-02 3 1  ON 48
ci_050                 3.495403e-03 3 1  ON 49
ci_051                 3.286776e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455100e-03 3 1  ON 52
ci_054                -2.821732e-03 3 1  ON 53
ci_055                -2.793140e-03 3 1  ON 54
ci_056                 5.297730e-03 3 1  ON 55
ci_057                 5.166660e-03 3 1  ON 56
ci_058                -1.676399e-03 3 1  ON 57
ci_059                -1.950444e-03 3 1  ON 58
ci_060                 4.881295e-03 3 1  ON 59
ci_061                 5.584213e-03 3 1  ON 60
ci_062                -3.639914e-03 3 1  ON 61
ci_063                -4.069804e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303191e-03 3 1  ON 64
ci_066                 4.446874e-03 3 1  ON 65
ci_067                 4.331987e-03 3 1  ON 66
ci_068                -4.465797e-03 3 1  ON 67
ci_069                -4.887967e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.158
    reference variance = 0.507567
====================================================
  Execution time = 1.3528e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8423e-01
  Total weights = 1.9573e+06
  Execution time = 1.8445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271509369732
                                         uncertainty =       0.003129537145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271509369732
                                         uncertainty =       0.003129537145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368421080
  error estimate for blocks of size 2^( 2) =       0.000382688051
  error estimate for blocks of size 2^( 3) =       0.000395876285
  error estimate for blocks of size 2^( 4) =       0.000406347841
  error estimate for blocks of size 2^( 5) =       0.000412133022
  error estimate for blocks of size 2^( 6) =       0.000414140602
  error estimate for blocks of size 2^( 7) =       0.000415579924

      target function =      -0.937804506458
              le_mean =     -17.212447947413
             les_mean =     296.552593794176
             stat err =       0.000412050347
             autocorr =       1.250868412928
   target nu stat err =       0.000412050347
   target dn stat err =       0.003822847687
      target stat err =       0.006321863778
              std dev =       0.521026088339
             le_variance =       0.271468184730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271509398415
                                         uncertainty =       0.003129515802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271509398415
                                         uncertainty =       0.003129515802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368421100
  error estimate for blocks of size 2^( 2) =       0.000382688072
  error estimate for blocks of size 2^( 3) =       0.000395876310
  error estimate for blocks of size 2^( 4) =       0.000406347862
  error estimate for blocks of size 2^( 5) =       0.000412133044
  error estimate for blocks of size 2^( 6) =       0.000414140612
  error estimate for blocks of size 2^( 7) =       0.000415579927

      target function =      -0.937804224141
              le_mean =     -17.212447947218
             les_mean =     296.552593959358
             stat err =       0.000412050361
             autocorr =       1.250868364545
   target nu stat err =       0.000412050361
   target dn stat err =       0.003822845854
      target stat err =       0.006321857006
              std dev =       0.521026116180
             le_variance =       0.271468213742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271509384070
                                         uncertainty =       0.003129526472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271509384070
                                         uncertainty =       0.003129526472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368421090
  error estimate for blocks of size 2^( 2) =       0.000382688061
  error estimate for blocks of size 2^( 3) =       0.000395876297
  error estimate for blocks of size 2^( 4) =       0.000406347851
  error estimate for blocks of size 2^( 5) =       0.000412133033
  error estimate for blocks of size 2^( 6) =       0.000414140607
  error estimate for blocks of size 2^( 7) =       0.000415579926

      target function =      -0.937804365434
              le_mean =     -17.212447947315
             les_mean =     296.552593876674
             stat err =       0.000412050354
             autocorr =       1.250868388738
   target nu stat err =       0.000412050354
   target dn stat err =       0.003822846768
      target stat err =       0.006321860389
              std dev =       0.521026102256
             le_variance =       0.271468199232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271509371524
                                         uncertainty =       0.003129535811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271509371524
                                         uncertainty =       0.003129535811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368421081
  error estimate for blocks of size 2^( 2) =       0.000382688052
  error estimate for blocks of size 2^( 3) =       0.000395876287
  error estimate for blocks of size 2^( 4) =       0.000406347842
  error estimate for blocks of size 2^( 5) =       0.000412133023
  error estimate for blocks of size 2^( 6) =       0.000414140603
  error estimate for blocks of size 2^( 7) =       0.000415579925

      target function =      -0.937804488845
              le_mean =     -17.212447947400
             les_mean =     296.552593804478
             stat err =       0.000412050348
             autocorr =       1.250868409899
   target nu stat err =       0.000412050348
   target dn stat err =       0.003822847571
      target stat err =       0.006321863354
              std dev =       0.521026090078
             le_variance =       0.271468186542


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.937804506458        initial  <--
     6.2500e+02     6.2500e+03             3.2466e-07        -0.937804224141
     2.5000e+03     2.5000e+04             8.1171e-08        -0.937804365434
     1.0000e+04     1.0000e+05             2.0293e-08        -0.937804488845

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8467
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157723e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363300e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078763e-02 3 1  ON 5
ci_007                -2.052496e-02 3 1  ON 6
ci_008                -8.640575e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553426e-03 3 1  ON 9
ci_011                -1.048531e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994755e-02 3 1  ON 12
ci_014                 1.253798e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639233e-02 3 1  ON 16
ci_018                 1.001458e-02 3 1  ON 17
ci_019                 1.008118e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701189e-02 3 1  ON 20
ci_022                 9.245269e-03 3 1  ON 21
ci_023                 9.492892e-03 3 1  ON 22
ci_024                 9.663641e-03 3 1  ON 23
ci_025                 9.459868e-03 3 1  ON 24
ci_026                 1.098874e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538011e-02 3 1  ON 28
ci_030                -9.441180e-03 3 1  ON 29
ci_031                -8.993581e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723521e-03 3 1  ON 32
ci_034                 5.515353e-03 3 1  ON 33
ci_035                -5.026956e-03 3 1  ON 34
ci_036                -1.249020e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686562e-03 3 1  ON 37
ci_039                 1.743695e-03 3 1  ON 38
ci_040                -2.980583e-03 3 1  ON 39
ci_041                 8.806577e-03 3 1  ON 40
ci_042                 8.882028e-03 3 1  ON 41
ci_043                -4.010888e-03 3 1  ON 42
ci_044                -3.979271e-03 3 1  ON 43
ci_045                -3.149278e-03 3 1  ON 44
ci_046                 5.743109e-03 3 1  ON 45
ci_047                 5.639876e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350363e-02 3 1  ON 48
ci_050                 3.495424e-03 3 1  ON 49
ci_051                 3.286773e-03 3 1  ON 50
ci_052                -2.365772e-03 3 1  ON 51
ci_053                -2.455083e-03 3 1  ON 52
ci_054                -2.821743e-03 3 1  ON 53
ci_055                -2.793132e-03 3 1  ON 54
ci_056                 5.297733e-03 3 1  ON 55
ci_057                 5.166679e-03 3 1  ON 56
ci_058                -1.676429e-03 3 1  ON 57
ci_059                -1.950459e-03 3 1  ON 58
ci_060                 4.881289e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639909e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303200e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331988e-03 3 1  ON 66
ci_068                -4.465766e-03 3 1  ON 67
ci_069                -4.887999e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9311e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2164
    reference variance = 0.188748
====================================================
  Execution time = 1.3921e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5317e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8079e-01
  Total weights = 1.957404593e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4897e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267426919938
                                         uncertainty =       0.001401531602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267426919938
                                         uncertainty =       0.001401531602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365711743
  error estimate for blocks of size 2^( 2) =       0.000379483252
  error estimate for blocks of size 2^( 3) =       0.000392195304
  error estimate for blocks of size 2^( 4) =       0.000401701603
  error estimate for blocks of size 2^( 5) =       0.000406932948
  error estimate for blocks of size 2^( 6) =       0.000408844333
  error estimate for blocks of size 2^( 7) =       0.000410545916

      target function =      -0.943493513367
              le_mean =     -17.211680383283
             les_mean =     296.522733220824
             stat err =       0.000407006200
             autocorr =       1.238580501905
   target nu stat err =       0.000407006200
   target dn stat err =       0.002679432106
      target stat err =       0.004506392536
              std dev =       0.517194506494
             le_variance =       0.267490157548


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721168038328e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943514105293       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943514111082       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943514112104       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943514112360       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943514112384       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943514112397       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943514112399       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943514112402       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943514112403       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943514112409       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+03 is 2.038199e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943514105293       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943514106740       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943514106996       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943514107065       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943514107062       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943514107069       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943514107060       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943514107066       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943514107044       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943514107038       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+04 is 5.095540e-09

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943514105293       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943514105655       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943514105719       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943514105735       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943514105737       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943514105393       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943514105737       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943514105738       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943514105693       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943514105726       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+05 is 1.273887e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066304 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6428e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363300e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078763e-02 3 1  ON 5
ci_007                -2.052496e-02 3 1  ON 6
ci_008                -8.640573e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553431e-03 3 1  ON 9
ci_011                -1.048531e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994754e-02 3 1  ON 12
ci_014                 1.253798e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639233e-02 3 1  ON 16
ci_018                 1.001458e-02 3 1  ON 17
ci_019                 1.008118e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701189e-02 3 1  ON 20
ci_022                 9.245267e-03 3 1  ON 21
ci_023                 9.492892e-03 3 1  ON 22
ci_024                 9.663641e-03 3 1  ON 23
ci_025                 9.459867e-03 3 1  ON 24
ci_026                 1.098874e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441177e-03 3 1  ON 29
ci_031                -8.993583e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723526e-03 3 1  ON 32
ci_034                 5.515352e-03 3 1  ON 33
ci_035                -5.026955e-03 3 1  ON 34
ci_036                -1.249020e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686564e-03 3 1  ON 37
ci_039                 1.743695e-03 3 1  ON 38
ci_040                -2.980583e-03 3 1  ON 39
ci_041                 8.806576e-03 3 1  ON 40
ci_042                 8.882026e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979275e-03 3 1  ON 43
ci_045                -3.149277e-03 3 1  ON 44
ci_046                 5.743108e-03 3 1  ON 45
ci_047                 5.639874e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350362e-02 3 1  ON 48
ci_050                 3.495422e-03 3 1  ON 49
ci_051                 3.286770e-03 3 1  ON 50
ci_052                -2.365774e-03 3 1  ON 51
ci_053                -2.455080e-03 3 1  ON 52
ci_054                -2.821742e-03 3 1  ON 53
ci_055                -2.793133e-03 3 1  ON 54
ci_056                 5.297734e-03 3 1  ON 55
ci_057                 5.166681e-03 3 1  ON 56
ci_058                -1.676432e-03 3 1  ON 57
ci_059                -1.950459e-03 3 1  ON 58
ci_060                 4.881288e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639910e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303200e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331989e-03 3 1  ON 66
ci_068                -4.465768e-03 3 1  ON 67
ci_069                -4.888000e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1329
    reference variance = 0.156692
====================================================
  Execution time = 1.3436e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8305e-01
  Total weights = 1.9575e+06
  Execution time = 1.8741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270698374763
                                         uncertainty =       0.001737144977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270698374763
                                         uncertainty =       0.001737144977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367887676
  error estimate for blocks of size 2^( 2) =       0.000381493860
  error estimate for blocks of size 2^( 3) =       0.000394017519
  error estimate for blocks of size 2^( 4) =       0.000403960483
  error estimate for blocks of size 2^( 5) =       0.000410086628
  error estimate for blocks of size 2^( 6) =       0.000412861248
  error estimate for blocks of size 2^( 7) =       0.000413485876

      target function =      -0.939773283687
              le_mean =     -17.212938981463
             les_mean =     296.568318470688
             stat err =       0.000410098559
             autocorr =       1.242641938701
   target nu stat err =       0.000410098559
   target dn stat err =       0.002638792661
      target stat err =       0.004416540462
              std dev =       0.520271741067
             le_variance =       0.270682684552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270698373388
                                         uncertainty =       0.001737144963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270698373388
                                         uncertainty =       0.001737144963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367887675
  error estimate for blocks of size 2^( 2) =       0.000381493859
  error estimate for blocks of size 2^( 3) =       0.000394017519
  error estimate for blocks of size 2^( 4) =       0.000403960483
  error estimate for blocks of size 2^( 5) =       0.000410086627
  error estimate for blocks of size 2^( 6) =       0.000412861247
  error estimate for blocks of size 2^( 7) =       0.000413485876

      target function =      -0.939773398420
              le_mean =     -17.212938981508
             les_mean =     296.568318402781
             stat err =       0.000410098558
             autocorr =       1.242641942026
   target nu stat err =       0.000410098558
   target dn stat err =       0.002638789847
      target stat err =       0.004416536942
              std dev =       0.520271739756
             le_variance =       0.270682683189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270698374075
                                         uncertainty =       0.001737144970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270698374075
                                         uncertainty =       0.001737144970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367887676
  error estimate for blocks of size 2^( 2) =       0.000381493860
  error estimate for blocks of size 2^( 3) =       0.000394017519
  error estimate for blocks of size 2^( 4) =       0.000403960483
  error estimate for blocks of size 2^( 5) =       0.000410086628
  error estimate for blocks of size 2^( 6) =       0.000412861248
  error estimate for blocks of size 2^( 7) =       0.000413485876

      target function =      -0.939773341095
              le_mean =     -17.212938981486
             les_mean =     296.568318436709
             stat err =       0.000410098559
             autocorr =       1.242641940360
   target nu stat err =       0.000410098559
   target dn stat err =       0.002638791253
      target stat err =       0.004416538702
              std dev =       0.520271740411
             le_variance =       0.270682683871

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270698374677
                                         uncertainty =       0.001737144976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270698374677
                                         uncertainty =       0.001737144976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367887676
  error estimate for blocks of size 2^( 2) =       0.000381493860
  error estimate for blocks of size 2^( 3) =       0.000394017519
  error estimate for blocks of size 2^( 4) =       0.000403960483
  error estimate for blocks of size 2^( 5) =       0.000410086628
  error estimate for blocks of size 2^( 6) =       0.000412861248
  error estimate for blocks of size 2^( 7) =       0.000413485876

      target function =      -0.939773290867
              le_mean =     -17.212938981466
             les_mean =     296.568318466438
             stat err =       0.000410098559
             autocorr =       1.242641938894
   target nu stat err =       0.000410098559
   target dn stat err =       0.002638792485
      target stat err =       0.004416540242
              std dev =       0.520271740985
             le_variance =       0.270682684467


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939773283687        initial
     6.2500e+03     6.2500e+04             2.0382e-08        -0.939773398420  <--
     2.5000e+04     2.5000e+05             5.0955e-09        -0.939773341095
     1.0000e+05     1.0000e+06             1.2739e-09        -0.939773290867

*****************************************************************************
Applying the update for shift_i =   6.2500e+03     and shift_s =   6.2500e+04
*****************************************************************************

  Execution time = 2.2827e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640567e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459864e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441171e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9282e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2184
    reference variance = 0.189437
====================================================
  Execution time = 1.3940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5314e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8294e-01
  Total weights = 1.957415028e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269844645855
                                         uncertainty =       0.001456589812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269844645855
                                         uncertainty =       0.001456589812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367298704
  error estimate for blocks of size 2^( 2) =       0.000381346904
  error estimate for blocks of size 2^( 3) =       0.000394001450
  error estimate for blocks of size 2^( 4) =       0.000404097356
  error estimate for blocks of size 2^( 5) =       0.000409594089
  error estimate for blocks of size 2^( 6) =       0.000412437775
  error estimate for blocks of size 2^( 7) =       0.000414117974

      target function =      -0.939954691074
              le_mean =     -17.212587577596
             les_mean =     296.556109215291
             stat err =       0.000410061798
             autocorr =       1.246406861462
   target nu stat err =       0.000410061798
   target dn stat err =       0.002655243260
      target stat err =       0.004442106966
              std dev =       0.519438809297
             le_variance =       0.269816676603


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721258757760e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939974421124       residual = 3.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939974489049       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939974495962       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939974497191       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939974497280       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939974497297       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939974497311       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939974497311       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939974497305       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939974497301       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 1.142613e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939974421124       residual = 3.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939974438106       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939974439834       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939974440147       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939974440163       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939974440169       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939974440172       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939974440170       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939974440162       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939974440175       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+03 is 2.856648e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939974421124       residual = 3.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939974425370       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939974425802       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939974425879       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939974425890       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939974425869       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939974425883       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939974425872       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939974425869       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939974425856       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+04 is 7.141693e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074600 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6446e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.141607e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599404e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378620e-02 3 1  ON 4
ci_006                -2.078763e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640586e-03 3 1  ON 7
ci_009                -1.451203e-02 3 1  ON 8
ci_010                -9.553452e-03 3 1  ON 9
ci_011                -1.048529e-02 3 1  ON 10
ci_012                -1.003776e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253798e-02 3 1  ON 13
ci_015                 1.260883e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639236e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008116e-02 3 1  ON 18
ci_020                 1.709710e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245251e-03 3 1  ON 21
ci_023                 9.492885e-03 3 1  ON 22
ci_024                 9.663639e-03 3 1  ON 23
ci_025                 9.459861e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138046e-02 3 1  ON 26
ci_028                -1.494853e-02 3 1  ON 27
ci_029                -1.538015e-02 3 1  ON 28
ci_030                -9.441155e-03 3 1  ON 29
ci_031                -8.993590e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723538e-03 3 1  ON 32
ci_034                 5.515351e-03 3 1  ON 33
ci_035                -5.026950e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686573e-03 3 1  ON 37
ci_039                 1.743697e-03 3 1  ON 38
ci_040                -2.980575e-03 3 1  ON 39
ci_041                 8.806554e-03 3 1  ON 40
ci_042                 8.882010e-03 3 1  ON 41
ci_043                -4.010886e-03 3 1  ON 42
ci_044                -3.979290e-03 3 1  ON 43
ci_045                -3.149274e-03 3 1  ON 44
ci_046                 5.743106e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246440e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495404e-03 3 1  ON 49
ci_051                 3.286759e-03 3 1  ON 50
ci_052                -2.365773e-03 3 1  ON 51
ci_053                -2.455069e-03 3 1  ON 52
ci_054                -2.821730e-03 3 1  ON 53
ci_055                -2.793139e-03 3 1  ON 54
ci_056                 5.297734e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676436e-03 3 1  ON 57
ci_059                -1.950452e-03 3 1  ON 58
ci_060                 4.881300e-03 3 1  ON 59
ci_061                 5.584203e-03 3 1  ON 60
ci_062                -3.639908e-03 3 1  ON 61
ci_063                -4.069848e-03 3 1  ON 62
ci_064                -3.040282e-03 3 1  ON 63
ci_065                -4.303210e-03 3 1  ON 64
ci_066                 4.446860e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465803e-03 3 1  ON 67
ci_069                -4.888006e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2212
    reference variance = 0.231985
====================================================
  Execution time = 1.3559e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7815e-01
  Total weights = 1.9578e+06
  Execution time = 1.8447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266643526369
                                         uncertainty =       0.001640235299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266643526369
                                         uncertainty =       0.001640235299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365200959
  error estimate for blocks of size 2^( 2) =       0.000378980804
  error estimate for blocks of size 2^( 3) =       0.000392053760
  error estimate for blocks of size 2^( 4) =       0.000401564249
  error estimate for blocks of size 2^( 5) =       0.000407067254
  error estimate for blocks of size 2^( 6) =       0.000409398717
  error estimate for blocks of size 2^( 7) =       0.000411407666

      target function =      -0.947900515839
              le_mean =     -17.211746762035
             les_mean =     296.522381465416
             stat err =       0.000407359472
             autocorr =       1.244204647374
   target nu stat err =       0.000407359472
   target dn stat err =       0.002233814891
      target stat err =       0.003813001021
              std dev =       0.516472148991
             le_variance =       0.266743480683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266643512330
                                         uncertainty =       0.001640235049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266643512330
                                         uncertainty =       0.001640235049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365200950
  error estimate for blocks of size 2^( 2) =       0.000378980798
  error estimate for blocks of size 2^( 3) =       0.000392053760
  error estimate for blocks of size 2^( 4) =       0.000401564251
  error estimate for blocks of size 2^( 5) =       0.000407067259
  error estimate for blocks of size 2^( 6) =       0.000409398721
  error estimate for blocks of size 2^( 7) =       0.000411407669

      target function =      -0.947900418892
              le_mean =     -17.211746762422
             les_mean =     296.522381536354
             stat err =       0.000407359475
             autocorr =       1.244204731456
   target nu stat err =       0.000407359475
   target dn stat err =       0.002233843834
      target stat err =       0.003813047902
              std dev =       0.516472135835
             le_variance =       0.266743467094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266643519348
                                         uncertainty =       0.001640235174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266643519348
                                         uncertainty =       0.001640235174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365200954
  error estimate for blocks of size 2^( 2) =       0.000378980801
  error estimate for blocks of size 2^( 3) =       0.000392053760
  error estimate for blocks of size 2^( 4) =       0.000401564250
  error estimate for blocks of size 2^( 5) =       0.000407067257
  error estimate for blocks of size 2^( 6) =       0.000409398719
  error estimate for blocks of size 2^( 7) =       0.000411407668

      target function =      -0.947900467442
              le_mean =     -17.211746762229
             les_mean =     296.522381500838
             stat err =       0.000407359473
             autocorr =       1.244204689408
   target nu stat err =       0.000407359473
   target dn stat err =       0.002233829362
      target stat err =       0.003813024461
              std dev =       0.516472142412
             le_variance =       0.266743473888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266643525491
                                         uncertainty =       0.001640235283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266643525491
                                         uncertainty =       0.001640235283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365200958
  error estimate for blocks of size 2^( 2) =       0.000378980803
  error estimate for blocks of size 2^( 3) =       0.000392053760
  error estimate for blocks of size 2^( 4) =       0.000401564249
  error estimate for blocks of size 2^( 5) =       0.000407067254
  error estimate for blocks of size 2^( 6) =       0.000409398717
  error estimate for blocks of size 2^( 7) =       0.000411407666

      target function =      -0.947900509798
              le_mean =     -17.211746762059
             les_mean =     296.522381469839
             stat err =       0.000407359472
             autocorr =       1.244204652617
   target nu stat err =       0.000407359472
   target dn stat err =       0.002233816699
      target stat err =       0.003813003951
              std dev =       0.516472148169
             le_variance =       0.266743479834


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947900515839        initial  <--
     1.5625e+03     1.5625e+04             1.1426e-07        -0.947900418892
     6.2500e+03     6.2500e+04             2.8566e-08        -0.947900467442
     2.5000e+04     2.5000e+05             7.1417e-09        -0.947900509798

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8793
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640567e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459864e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441171e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9374e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2898
    reference variance = 0.29065
====================================================
  Execution time = 1.3901e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5312e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7871e-01
  Total weights = 1.957283657e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268697222725
                                         uncertainty =       0.001531254891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268697222725
                                         uncertainty =       0.001531254891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366498131
  error estimate for blocks of size 2^( 2) =       0.000380298450
  error estimate for blocks of size 2^( 3) =       0.000392909387
  error estimate for blocks of size 2^( 4) =       0.000401938638
  error estimate for blocks of size 2^( 5) =       0.000408233956
  error estimate for blocks of size 2^( 6) =       0.000410633173
  error estimate for blocks of size 2^( 7) =       0.000410534842

      target function =      -0.946978739362
              le_mean =     -17.211968625308
             les_mean =     296.530574242279
             stat err =       0.000407835152
             autocorr =       1.238299742738
   target nu stat err =       0.000407835152
   target dn stat err =       0.002033820615
      target stat err =       0.003479357765
              std dev =       0.518306627724
             le_variance =       0.268641760342


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721196862531e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946990546656       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946990549075       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946990549399       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946990549487       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946990549504       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946990549482       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946990549526       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946990549492       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946990549500       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946990549496       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+04 is 6.286266e-09

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946990546656       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946990547261       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946990547341       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946990547362       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946990547216       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946990547351       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946990547364       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946990547484       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946990547557       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946990547347       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+04 is 1.571571e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946990546656       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946990546807       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946990546827       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946990546851       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946990546737       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946990546793       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946990546501       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946990546695       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946990546781       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946990546695       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+05 is 3.928932e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082827 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6428e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492892e-03 3 1  ON 22
ci_024                 9.663639e-03 3 1  ON 23
ci_025                 9.459865e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441171e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515351e-03 3 1  ON 33
ci_035                -5.026952e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806574e-03 3 1  ON 40
ci_042                 8.882021e-03 3 1  ON 41
ci_043                -4.010890e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495419e-03 3 1  ON 49
ci_051                 3.286761e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455067e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297736e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881283e-03 3 1  ON 59
ci_061                 5.584205e-03 3 1  ON 60
ci_062                -3.639912e-03 3 1  ON 61
ci_063                -4.069844e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303200e-03 3 1  ON 64
ci_066                 4.446860e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465776e-03 3 1  ON 67
ci_069                -4.888000e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1692
    reference variance = 1.2979
====================================================
  Execution time = 1.3534e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7879e-01
  Total weights = 1.9574e+06
  Execution time = 1.8523e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266129119104
                                         uncertainty =       0.001429022157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266129119104
                                         uncertainty =       0.001429022157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364780646
  error estimate for blocks of size 2^( 2) =       0.000378609921
  error estimate for blocks of size 2^( 3) =       0.000391386577
  error estimate for blocks of size 2^( 4) =       0.000400841899
  error estimate for blocks of size 2^( 5) =       0.000405786418
  error estimate for blocks of size 2^( 6) =       0.000408757432
  error estimate for blocks of size 2^( 7) =       0.000411734666

      target function =      -0.946832263345
              le_mean =     -17.211815882936
             les_mean =     296.525400308673
             stat err =       0.000406780104
             autocorr =       1.243528749382
   target nu stat err =       0.000406780104
   target dn stat err =       0.002190253360
      target stat err =       0.003733333463
              std dev =       0.515877736178
             le_variance =       0.266129838684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266129118351
                                         uncertainty =       0.001429022016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266129118351
                                         uncertainty =       0.001429022016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364780645
  error estimate for blocks of size 2^( 2) =       0.000378609920
  error estimate for blocks of size 2^( 3) =       0.000391386576
  error estimate for blocks of size 2^( 4) =       0.000400841899
  error estimate for blocks of size 2^( 5) =       0.000405786418
  error estimate for blocks of size 2^( 6) =       0.000408757432
  error estimate for blocks of size 2^( 7) =       0.000411734666

      target function =      -0.946832260403
              le_mean =     -17.211815882958
             les_mean =     296.525400311171
             stat err =       0.000406780103
             autocorr =       1.243528751184
   target nu stat err =       0.000406780103
   target dn stat err =       0.002190252597
      target stat err =       0.003733332188
              std dev =       0.515877735439
             le_variance =       0.266129837922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266129118728
                                         uncertainty =       0.001429022086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266129118728
                                         uncertainty =       0.001429022086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364780645
  error estimate for blocks of size 2^( 2) =       0.000378609921
  error estimate for blocks of size 2^( 3) =       0.000391386576
  error estimate for blocks of size 2^( 4) =       0.000400841899
  error estimate for blocks of size 2^( 5) =       0.000405786418
  error estimate for blocks of size 2^( 6) =       0.000408757432
  error estimate for blocks of size 2^( 7) =       0.000411734666

      target function =      -0.946832261875
              le_mean =     -17.211815882947
             les_mean =     296.525400309922
             stat err =       0.000406780104
             autocorr =       1.243528750274
   target nu stat err =       0.000406780104
   target dn stat err =       0.002190252978
      target stat err =       0.003733332825
              std dev =       0.515877735809
             le_variance =       0.266129838303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266129119057
                                         uncertainty =       0.001429022148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266129119057
                                         uncertainty =       0.001429022148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364780645
  error estimate for blocks of size 2^( 2) =       0.000378609921
  error estimate for blocks of size 2^( 3) =       0.000391386577
  error estimate for blocks of size 2^( 4) =       0.000400841899
  error estimate for blocks of size 2^( 5) =       0.000405786418
  error estimate for blocks of size 2^( 6) =       0.000408757432
  error estimate for blocks of size 2^( 7) =       0.000411734666

      target function =      -0.946832263162
              le_mean =     -17.211815882938
             les_mean =     296.525400308829
             stat err =       0.000406780104
             autocorr =       1.243528749494
   target nu stat err =       0.000406780104
   target dn stat err =       0.002190253312
      target stat err =       0.003733333383
              std dev =       0.515877736132
             le_variance =       0.266129838636


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946832263345        initial  <--
     1.5625e+04     1.5625e+05             6.2863e-09        -0.946832260403
     6.2500e+04     6.2500e+05             1.5716e-09        -0.946832261875
     2.5000e+05     2.5000e+06             3.9289e-10        -0.946832263162

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9448
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640567e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459864e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441171e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9406e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.22
    reference variance = 0.178443
====================================================
  Execution time = 1.3779e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8378e-01
  Total weights = 1.957526699e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268078156216
                                         uncertainty =       0.001806840181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268078156216
                                         uncertainty =       0.001806840181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366094080
  error estimate for blocks of size 2^( 2) =       0.000379581868
  error estimate for blocks of size 2^( 3) =       0.000392290562
  error estimate for blocks of size 2^( 4) =       0.000401670582
  error estimate for blocks of size 2^( 5) =       0.000407355623
  error estimate for blocks of size 2^( 6) =       0.000409480528
  error estimate for blocks of size 2^( 7) =       0.000411301118

      target function =      -0.938469380419
              le_mean =     -17.212334349407
             les_mean =     296.548234460988
             stat err =       0.000407451963
             autocorr =       1.238703644879
   target nu stat err =       0.000407451963
   target dn stat err =       0.006293270302
      target stat err =       0.010377018413
              std dev =       0.517735213212
             le_variance =       0.268049751000


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721233434941e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938583269312       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938583269805       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938583269860       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938583269875       residual = 8.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938583269806       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938583269742       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938583269879       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938583270029       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938583270052       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938583269803       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+05 is 1.126057e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938583269312       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938583269435       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938583269449       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938583269453       residual = 8.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938583269729       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938583270118       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938583269208       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938583269457       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938583269242       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938583269502       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+05 is 2.815142e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938583269312       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938583269343       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938583269346       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938583269347       residual = 8.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938583269163       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938583268034       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938583268428       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938583267519       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938583268518       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938583265105       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+06 is 7.037857e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091151 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6285e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640567e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459864e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441171e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2039
    reference variance = 0.200365
====================================================
  Execution time = 1.3598e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8152e-01
  Total weights = 1.9572e+06
  Execution time = 1.8537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269271673927
                                         uncertainty =       0.001929288592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269271673927
                                         uncertainty =       0.001929288592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366896526
  error estimate for blocks of size 2^( 2) =       0.000380838103
  error estimate for blocks of size 2^( 3) =       0.000393533503
  error estimate for blocks of size 2^( 4) =       0.000402817034
  error estimate for blocks of size 2^( 5) =       0.000409098087
  error estimate for blocks of size 2^( 6) =       0.000412848389
  error estimate for blocks of size 2^( 7) =       0.000415894838

      target function =      -0.942290129463
              le_mean =     -17.211737678004
             les_mean =     296.525430924130
             stat err =       0.000410164587
             autocorr =       1.249767199675
   target nu stat err =       0.000410164587
   target dn stat err =       0.002766853064
      target stat err =       0.004639412982
              std dev =       0.518870043566
             le_variance =       0.269226122110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269271673989
                                         uncertainty =       0.001929288633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269271673989
                                         uncertainty =       0.001929288633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366896526
  error estimate for blocks of size 2^( 2) =       0.000380838103
  error estimate for blocks of size 2^( 3) =       0.000393533503
  error estimate for blocks of size 2^( 4) =       0.000402817034
  error estimate for blocks of size 2^( 5) =       0.000409098087
  error estimate for blocks of size 2^( 6) =       0.000412848389
  error estimate for blocks of size 2^( 7) =       0.000415894838

      target function =      -0.942290126637
              le_mean =     -17.211737678010
             les_mean =     296.525430926035
             stat err =       0.000410164587
             autocorr =       1.249767200471
   target nu stat err =       0.000410164587
   target dn stat err =       0.002766853414
      target stat err =       0.004639413528
              std dev =       0.518870043626
             le_variance =       0.269226122173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269271673958
                                         uncertainty =       0.001929288612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269271673958
                                         uncertainty =       0.001929288612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366896526
  error estimate for blocks of size 2^( 2) =       0.000380838103
  error estimate for blocks of size 2^( 3) =       0.000393533503
  error estimate for blocks of size 2^( 4) =       0.000402817034
  error estimate for blocks of size 2^( 5) =       0.000409098087
  error estimate for blocks of size 2^( 6) =       0.000412848389
  error estimate for blocks of size 2^( 7) =       0.000415894838

      target function =      -0.942290128050
              le_mean =     -17.211737678007
             les_mean =     296.525430925082
             stat err =       0.000410164587
             autocorr =       1.249767200063
   target nu stat err =       0.000410164587
   target dn stat err =       0.002766853239
      target stat err =       0.004639413255
              std dev =       0.518870043596
             le_variance =       0.269226122141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269271673930
                                         uncertainty =       0.001929288595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269271673930
                                         uncertainty =       0.001929288595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366896526
  error estimate for blocks of size 2^( 2) =       0.000380838103
  error estimate for blocks of size 2^( 3) =       0.000393533503
  error estimate for blocks of size 2^( 4) =       0.000402817034
  error estimate for blocks of size 2^( 5) =       0.000409098087
  error estimate for blocks of size 2^( 6) =       0.000412848389
  error estimate for blocks of size 2^( 7) =       0.000415894838

      target function =      -0.942290129287
              le_mean =     -17.211737678004
             les_mean =     296.525430924249
             stat err =       0.000410164587
             autocorr =       1.249767199725
   target nu stat err =       0.000410164587
   target dn stat err =       0.002766853086
      target stat err =       0.004639413017
              std dev =       0.518870043570
             le_variance =       0.269226122114


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942290129463        initial  <--
     1.5625e+05     1.5625e+06             1.1261e-09        -0.942290126637
     6.2500e+05     6.2500e+06             2.8151e-10        -0.942290128050
     2.5000e+06     2.5000e+07             7.0379e-11        -0.942290129287

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.0844
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640567e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459864e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441171e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3404e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2612
    reference variance = 0.130379
====================================================
  Execution time = 1.6221e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7599e-01
  Total weights = 1.957356366e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4703e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266066769578
                                         uncertainty =       0.001601620731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266066769578
                                         uncertainty =       0.001601620731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364726873
  error estimate for blocks of size 2^( 2) =       0.000378952250
  error estimate for blocks of size 2^( 3) =       0.000391606402
  error estimate for blocks of size 2^( 4) =       0.000401151516
  error estimate for blocks of size 2^( 5) =       0.000405497258
  error estimate for blocks of size 2^( 6) =       0.000409088153
  error estimate for blocks of size 2^( 7) =       0.000410806049

      target function =      -0.951571997149
              le_mean =     -17.212659309518
             les_mean =     296.551632216044
             stat err =       0.000406635744
             autocorr =       1.243012732255
   target nu stat err =       0.000406635744
   target dn stat err =       0.002189433692
      target stat err =       0.003774642511
              std dev =       0.515801689737
             le_variance =       0.266051383136


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721265930952e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951585923203       residual = 7.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951585923220       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951585923223       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951585923224       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951585923224       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951585923224       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951585923224       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951585923224       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951585923224       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951585921645       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+06 is 6.461884e-11

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951585923203       residual = 7.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951585923207       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951585923208       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951585923208       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951585923208       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951585923208       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951585923208       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951585921748       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951585927382       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951585918876       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+06 is 1.615465e-11

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951585923203       residual = 7.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951585923204       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951585923204       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951585940666       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951585915962       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951585881881       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951585930897       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951585937425       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951585917401       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951585896361       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+07 is 4.038702e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094695 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8700e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640567e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441171e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2027
    reference variance = 0.166253
====================================================
  Execution time = 1.3678e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7847e-01
  Total weights = 1.9572e+06
  Execution time = 1.8256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268072966591
                                         uncertainty =       0.001679835496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268072966591
                                         uncertainty =       0.001679835496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366093391
  error estimate for blocks of size 2^( 2) =       0.000379770496
  error estimate for blocks of size 2^( 3) =       0.000392398399
  error estimate for blocks of size 2^( 4) =       0.000401473446
  error estimate for blocks of size 2^( 5) =       0.000405365720
  error estimate for blocks of size 2^( 6) =       0.000408319988
  error estimate for blocks of size 2^( 7) =       0.000407830369

      target function =      -0.947362547514
              le_mean =     -17.211314779161
             les_mean =     296.507826116129
             stat err =       0.000405747381
             autocorr =       1.228365678225
   target nu stat err =       0.000405747381
   target dn stat err =       0.002083438332
      target stat err =       0.003558382966
              std dev =       0.517734238111
             le_variance =       0.268048741312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268072966585
                                         uncertainty =       0.001679835495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268072966585
                                         uncertainty =       0.001679835495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366093391
  error estimate for blocks of size 2^( 2) =       0.000379770496
  error estimate for blocks of size 2^( 3) =       0.000392398399
  error estimate for blocks of size 2^( 4) =       0.000401473446
  error estimate for blocks of size 2^( 5) =       0.000405365720
  error estimate for blocks of size 2^( 6) =       0.000408319988
  error estimate for blocks of size 2^( 7) =       0.000407830369

      target function =      -0.947362547552
              le_mean =     -17.211314779161
             les_mean =     296.507826116110
             stat err =       0.000405747381
             autocorr =       1.228365678187
   target nu stat err =       0.000405747381
   target dn stat err =       0.002083438330
      target stat err =       0.003558382963
              std dev =       0.517734238105
             le_variance =       0.268048741306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268072966588
                                         uncertainty =       0.001679835495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268072966588
                                         uncertainty =       0.001679835495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366093391
  error estimate for blocks of size 2^( 2) =       0.000379770496
  error estimate for blocks of size 2^( 3) =       0.000392398399
  error estimate for blocks of size 2^( 4) =       0.000401473446
  error estimate for blocks of size 2^( 5) =       0.000405365720
  error estimate for blocks of size 2^( 6) =       0.000408319988
  error estimate for blocks of size 2^( 7) =       0.000407830369

      target function =      -0.947362547533
              le_mean =     -17.211314779161
             les_mean =     296.507826116120
             stat err =       0.000405747381
             autocorr =       1.228365678202
   target nu stat err =       0.000405747381
   target dn stat err =       0.002083438331
      target stat err =       0.003558382964
              std dev =       0.517734238108
             le_variance =       0.268048741309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268072966591
                                         uncertainty =       0.001679835496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268072966591
                                         uncertainty =       0.001679835496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366093391
  error estimate for blocks of size 2^( 2) =       0.000379770496
  error estimate for blocks of size 2^( 3) =       0.000392398399
  error estimate for blocks of size 2^( 4) =       0.000401473446
  error estimate for blocks of size 2^( 5) =       0.000405365720
  error estimate for blocks of size 2^( 6) =       0.000408319988
  error estimate for blocks of size 2^( 7) =       0.000407830369

      target function =      -0.947362547517
              le_mean =     -17.211314779161
             les_mean =     296.507826116128
             stat err =       0.000405747381
             autocorr =       1.228365678221
   target nu stat err =       0.000405747381
   target dn stat err =       0.002083438332
      target stat err =       0.003558382966
              std dev =       0.517734238111
             le_variance =       0.268048741312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947362547514        initial
     1.5625e+06     1.5625e+07             6.4619e-11        -0.947362547552  <--
     6.2500e+06     6.2500e+07             1.6155e-11        -0.947362547533
     2.5000e+07     2.5000e+08             4.0387e-12        -0.947362547517

*****************************************************************************
Applying the update for shift_i =   1.5625e+06     and shift_s =   1.5625e+07
*****************************************************************************

  Execution time = 2.2904e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640567e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441171e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1610e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2105
    reference variance = 0.186474
====================================================
  Execution time = 1.3791e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7699e-01
  Total weights = 1.957328796e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265863543015
                                         uncertainty =       0.001505310009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265863543015
                                         uncertainty =       0.001505310009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364628241
  error estimate for blocks of size 2^( 2) =       0.000378635079
  error estimate for blocks of size 2^( 3) =       0.000391523524
  error estimate for blocks of size 2^( 4) =       0.000400414800
  error estimate for blocks of size 2^( 5) =       0.000406191856
  error estimate for blocks of size 2^( 6) =       0.000408707722
  error estimate for blocks of size 2^( 7) =       0.000409223006

      target function =      -0.949886859883
              le_mean =     -17.212683457473
             les_mean =     296.553461567660
             stat err =       0.000406134346
             autocorr =       1.240620153873
   target nu stat err =       0.000406134346
   target dn stat err =       0.002193721300
      target stat err =       0.003768625557
              std dev =       0.515662203472
             le_variance =       0.265907508090


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721268345747e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949900802755       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949900802893       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949900802909       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949900802915       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949900802434       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949900802916       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949900802729       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949900803050       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949900803221       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949900802774       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+05 is 4.459149e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949900802755       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949900802790       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949900802794       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949900802795       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949900802795       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949900803189       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949900802796       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949900802796       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949900802796       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949900802796       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+06 is 1.114787e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949900802755       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949900802764       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949900802765       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949900802765       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949900802765       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949900798470       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949900802552       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949900811058       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949900802765       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949900802765       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+06 is 2.786973e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098207 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6321e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640567e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441171e-03 3 1  ON 29
ci_031                -8.993586e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2712
    reference variance = 0.242702
====================================================
  Execution time = 1.3761e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8239e-01
  Total weights = 1.9572e+06
  Execution time = 1.8219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268851789324
                                         uncertainty =       0.001509357347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268851789324
                                         uncertainty =       0.001509357347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366650946
  error estimate for blocks of size 2^( 2) =       0.000380253150
  error estimate for blocks of size 2^( 3) =       0.000392363492
  error estimate for blocks of size 2^( 4) =       0.000401736941
  error estimate for blocks of size 2^( 5) =       0.000407657362
  error estimate for blocks of size 2^( 6) =       0.000410457778
  error estimate for blocks of size 2^( 7) =       0.000412236247

      target function =      -0.940838642676
              le_mean =     -17.211344912904
             les_mean =     296.512782235077
             stat err =       0.000408022082
             autocorr =       1.238402198805
   target nu stat err =       0.000408022082
   target dn stat err =       0.003012975168
      target stat err =       0.005022976102
              std dev =       0.518522740940
             le_variance =       0.268865832872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268851789239
                                         uncertainty =       0.001509357340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268851789239
                                         uncertainty =       0.001509357340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366650946
  error estimate for blocks of size 2^( 2) =       0.000380253150
  error estimate for blocks of size 2^( 3) =       0.000392363492
  error estimate for blocks of size 2^( 4) =       0.000401736941
  error estimate for blocks of size 2^( 5) =       0.000407657362
  error estimate for blocks of size 2^( 6) =       0.000410457778
  error estimate for blocks of size 2^( 7) =       0.000412236247

      target function =      -0.940838643181
              le_mean =     -17.211344912903
             les_mean =     296.512782234727
             stat err =       0.000408022082
             autocorr =       1.238402199062
   target nu stat err =       0.000408022082
   target dn stat err =       0.003012975134
      target stat err =       0.005022976052
              std dev =       0.518522740858
             le_variance =       0.268865832787

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268851789282
                                         uncertainty =       0.001509357343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268851789282
                                         uncertainty =       0.001509357343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366650946
  error estimate for blocks of size 2^( 2) =       0.000380253150
  error estimate for blocks of size 2^( 3) =       0.000392363492
  error estimate for blocks of size 2^( 4) =       0.000401736941
  error estimate for blocks of size 2^( 5) =       0.000407657362
  error estimate for blocks of size 2^( 6) =       0.000410457778
  error estimate for blocks of size 2^( 7) =       0.000412236247

      target function =      -0.940838642929
              le_mean =     -17.211344912904
             les_mean =     296.512782234902
             stat err =       0.000408022082
             autocorr =       1.238402198919
   target nu stat err =       0.000408022082
   target dn stat err =       0.003012975151
      target stat err =       0.005022976077
              std dev =       0.518522740899
             le_variance =       0.268865832829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268851789319
                                         uncertainty =       0.001509357347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268851789319
                                         uncertainty =       0.001509357347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366650946
  error estimate for blocks of size 2^( 2) =       0.000380253150
  error estimate for blocks of size 2^( 3) =       0.000392363492
  error estimate for blocks of size 2^( 4) =       0.000401736941
  error estimate for blocks of size 2^( 5) =       0.000407657362
  error estimate for blocks of size 2^( 6) =       0.000410457778
  error estimate for blocks of size 2^( 7) =       0.000412236247

      target function =      -0.940838642708
              le_mean =     -17.211344912904
             les_mean =     296.512782235055
             stat err =       0.000408022082
             autocorr =       1.238402198810
   target nu stat err =       0.000408022082
   target dn stat err =       0.003012975166
      target stat err =       0.005022976098
              std dev =       0.518522740935
             le_variance =       0.268865832867


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940838642676        initial
     3.9062e+05     3.9062e+06             4.4591e-10        -0.940838643181  <--
     1.5625e+06     1.5625e+07             1.1148e-10        -0.940838642929
     6.2500e+06     6.2500e+07             2.7870e-11        -0.940838642708

*****************************************************************************
Applying the update for shift_i =   3.9062e+05     and shift_s =   3.9062e+06
*****************************************************************************

  Execution time = 2.2983e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993586e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9311e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1543
    reference variance = 0.16401
====================================================
  Execution time = 1.4032e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7773e-01
  Total weights = 1.957451436e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267762242898
                                         uncertainty =       0.002085951379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267762242898
                                         uncertainty =       0.002085951379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365881521
  error estimate for blocks of size 2^( 2) =       0.000380118297
  error estimate for blocks of size 2^( 3) =       0.000393038282
  error estimate for blocks of size 2^( 4) =       0.000401654241
  error estimate for blocks of size 2^( 5) =       0.000406258968
  error estimate for blocks of size 2^( 6) =       0.000408991626
  error estimate for blocks of size 2^( 7) =       0.000409988871

      target function =      -0.948607201420
              le_mean =     -17.211600084085
             les_mean =     296.516907450028
             stat err =       0.000406723427
             autocorr =       1.235712452752
   target nu stat err =       0.000406723427
   target dn stat err =       0.002325902022
      target stat err =       0.003969218273
              std dev =       0.517434609502
             le_variance =       0.267738575110


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721160008409e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948623007743       residual = 9.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948623008073       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948623008115       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948623008126       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948623008094       residual = 9.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948623007972       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948623008091       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948623008128       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948623008128       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948623008128       residual = 1.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+04 is 9.295557e-10

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948623007743       residual = 9.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948623007825       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948623007836       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948623007839       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948623007839       residual = 9.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948623007839       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948623007839       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948623007839       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948623007839       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948623008530       residual = 1.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+05 is 2.323890e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948623007743       residual = 9.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948623007763       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948623007766       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948623007767       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948623007767       residual = 9.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948623007767       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948623007767       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948623007767       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948623007767       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948623007767       residual = 1.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+06 is 5.809729e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101690 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6512e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441171e-03 3 1  ON 29
ci_031                -8.993586e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806574e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040283e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2189
    reference variance = 0.18788
====================================================
  Execution time = 1.3739e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8217e-01
  Total weights = 1.9576e+06
  Execution time = 1.8145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269404154246
                                         uncertainty =       0.001977896869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269404154246
                                         uncertainty =       0.001977896869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366978620
  error estimate for blocks of size 2^( 2) =       0.000380809876
  error estimate for blocks of size 2^( 3) =       0.000393293307
  error estimate for blocks of size 2^( 4) =       0.000401863411
  error estimate for blocks of size 2^( 5) =       0.000407546415
  error estimate for blocks of size 2^( 6) =       0.000411037375
  error estimate for blocks of size 2^( 7) =       0.000412210808

      target function =      -0.941219734387
              le_mean =     -17.212304713879
             les_mean =     296.545604934774
             stat err =       0.000408164502
             autocorr =       1.237054795571
   target nu stat err =       0.000408164502
   target dn stat err =       0.002528619764
      target stat err =       0.004244404639
              std dev =       0.518986141320
             le_variance =       0.269346614882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269404154392
                                         uncertainty =       0.001977896919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269404154392
                                         uncertainty =       0.001977896919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366978620
  error estimate for blocks of size 2^( 2) =       0.000380809876
  error estimate for blocks of size 2^( 3) =       0.000393293308
  error estimate for blocks of size 2^( 4) =       0.000401863411
  error estimate for blocks of size 2^( 5) =       0.000407546415
  error estimate for blocks of size 2^( 6) =       0.000411037375
  error estimate for blocks of size 2^( 7) =       0.000412210808

      target function =      -0.941219732411
              le_mean =     -17.212304713893
             les_mean =     296.545604936434
             stat err =       0.000408164502
             autocorr =       1.237054796413
   target nu stat err =       0.000408164502
   target dn stat err =       0.002528619887
      target stat err =       0.004244404821
              std dev =       0.518986141461
             le_variance =       0.269346615029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269404154319
                                         uncertainty =       0.001977896894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269404154319
                                         uncertainty =       0.001977896894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366978620
  error estimate for blocks of size 2^( 2) =       0.000380809876
  error estimate for blocks of size 2^( 3) =       0.000393293308
  error estimate for blocks of size 2^( 4) =       0.000401863411
  error estimate for blocks of size 2^( 5) =       0.000407546415
  error estimate for blocks of size 2^( 6) =       0.000411037375
  error estimate for blocks of size 2^( 7) =       0.000412210808

      target function =      -0.941219733399
              le_mean =     -17.212304713886
             les_mean =     296.545604935604
             stat err =       0.000408164502
             autocorr =       1.237054796000
   target nu stat err =       0.000408164502
   target dn stat err =       0.002528619825
      target stat err =       0.004244404730
              std dev =       0.518986141391
             le_variance =       0.269346614955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269404154255
                                         uncertainty =       0.001977896872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269404154255
                                         uncertainty =       0.001977896872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366978620
  error estimate for blocks of size 2^( 2) =       0.000380809876
  error estimate for blocks of size 2^( 3) =       0.000393293307
  error estimate for blocks of size 2^( 4) =       0.000401863411
  error estimate for blocks of size 2^( 5) =       0.000407546415
  error estimate for blocks of size 2^( 6) =       0.000411037375
  error estimate for blocks of size 2^( 7) =       0.000412210808

      target function =      -0.941219734263
              le_mean =     -17.212304713880
             les_mean =     296.545604934878
             stat err =       0.000408164502
             autocorr =       1.237054795623
   target nu stat err =       0.000408164502
   target dn stat err =       0.002528619772
      target stat err =       0.004244404650
              std dev =       0.518986141329
             le_variance =       0.269346614892


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941219734387        initial  <--
     9.7656e+04     9.7656e+05             9.2956e-10        -0.941219732411
     3.9062e+05     3.9062e+06             2.3239e-10        -0.941219733399
     1.5625e+06     1.5625e+07             5.8097e-11        -0.941219734263

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0467
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993586e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9573e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1776
    reference variance = 0.175399
====================================================
  Execution time = 1.3883e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7859e-01
  Total weights = 1.957252413e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267081350824
                                         uncertainty =       0.001801790357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267081350824
                                         uncertainty =       0.001801790357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365389661
  error estimate for blocks of size 2^( 2) =       0.000379186025
  error estimate for blocks of size 2^( 3) =       0.000391806723
  error estimate for blocks of size 2^( 4) =       0.000400760295
  error estimate for blocks of size 2^( 5) =       0.000405840319
  error estimate for blocks of size 2^( 6) =       0.000408784039
  error estimate for blocks of size 2^( 7) =       0.000411247803

      target function =      -0.947153895462
              le_mean =     -17.211324830385
             les_mean =     296.508294692299
             stat err =       0.000406658114
             autocorr =       1.238643632040
   target nu stat err =       0.000406658114
   target dn stat err =       0.002394481463
      target stat err =       0.004068046833
              std dev =       0.516739014762
             le_variance =       0.267019209377


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721132483039e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947170285169       residual = 3.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947170285268       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947170285276       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947170285278       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947170285436       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947170285592       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947170284812       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947170284815       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947170285612       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947170286987       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+05 is 1.927375e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947170285169       residual = 3.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947170285194       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947170285196       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947170287874       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947170287725       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947170289158       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947170286417       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947170281185       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947170290502       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947170282875       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+06 is 4.818438e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947170285169       residual = 3.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947170285175       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947170285176       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947170285176       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947170285144       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947170283478       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947170274797       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947170277595       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947170302251       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947170303959       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+07 is 1.204610e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105187 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6360e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2035
    reference variance = 0.20722
====================================================
  Execution time = 1.3603e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7881e-01
  Total weights = 1.9574e+06
  Execution time = 1.8266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268165413771
                                         uncertainty =       0.001491004440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268165413771
                                         uncertainty =       0.001491004440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366176424
  error estimate for blocks of size 2^( 2) =       0.000379811023
  error estimate for blocks of size 2^( 3) =       0.000392581344
  error estimate for blocks of size 2^( 4) =       0.000401880777
  error estimate for blocks of size 2^( 5) =       0.000406830566
  error estimate for blocks of size 2^( 6) =       0.000408881739
  error estimate for blocks of size 2^( 7) =       0.000410469464

      target function =      -0.946807170611
              le_mean =     -17.211807889625
             les_mean =     296.525141122438
             stat err =       0.000407015637
             autocorr =       1.235496244523
   target nu stat err =       0.000407015637
   target dn stat err =       0.002047507745
      target stat err =       0.003499182043
              std dev =       0.517851665228
             le_variance =       0.268170347179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268165413749
                                         uncertainty =       0.001491004440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268165413749
                                         uncertainty =       0.001491004440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366176424
  error estimate for blocks of size 2^( 2) =       0.000379811023
  error estimate for blocks of size 2^( 3) =       0.000392581344
  error estimate for blocks of size 2^( 4) =       0.000401880777
  error estimate for blocks of size 2^( 5) =       0.000406830566
  error estimate for blocks of size 2^( 6) =       0.000408881739
  error estimate for blocks of size 2^( 7) =       0.000410469464

      target function =      -0.946807171292
              le_mean =     -17.211807889621
             les_mean =     296.525141121904
             stat err =       0.000407015637
             autocorr =       1.235496244479
   target nu stat err =       0.000407015637
   target dn stat err =       0.002047507620
      target stat err =       0.003499181842
              std dev =       0.517851665206
             le_variance =       0.268170347157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268165413760
                                         uncertainty =       0.001491004440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268165413760
                                         uncertainty =       0.001491004440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366176424
  error estimate for blocks of size 2^( 2) =       0.000379811023
  error estimate for blocks of size 2^( 3) =       0.000392581344
  error estimate for blocks of size 2^( 4) =       0.000401880777
  error estimate for blocks of size 2^( 5) =       0.000406830566
  error estimate for blocks of size 2^( 6) =       0.000408881739
  error estimate for blocks of size 2^( 7) =       0.000410469464

      target function =      -0.946807170951
              le_mean =     -17.211807889623
             les_mean =     296.525141122171
             stat err =       0.000407015637
             autocorr =       1.235496244495
   target nu stat err =       0.000407015637
   target dn stat err =       0.002047507682
      target stat err =       0.003499181943
              std dev =       0.517851665217
             le_variance =       0.268170347168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268165413770
                                         uncertainty =       0.001491004440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268165413770
                                         uncertainty =       0.001491004440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366176424
  error estimate for blocks of size 2^( 2) =       0.000379811023
  error estimate for blocks of size 2^( 3) =       0.000392581344
  error estimate for blocks of size 2^( 4) =       0.000401880777
  error estimate for blocks of size 2^( 5) =       0.000406830566
  error estimate for blocks of size 2^( 6) =       0.000408881739
  error estimate for blocks of size 2^( 7) =       0.000410469464

      target function =      -0.946807170654
              le_mean =     -17.211807889624
             les_mean =     296.525141122404
             stat err =       0.000407015637
             autocorr =       1.235496244526
   target nu stat err =       0.000407015637
   target dn stat err =       0.002047507737
      target stat err =       0.003499182030
              std dev =       0.517851665227
             le_variance =       0.268170347178


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946807170611        initial
     9.7656e+05     9.7656e+06             1.9274e-10        -0.946807171292  <--
     3.9062e+06     3.9062e+07             4.8184e-11        -0.946807170951
     1.5625e+07     1.5625e+08             1.2046e-11        -0.946807170654

*****************************************************************************
Applying the update for shift_i =   9.7656e+05     and shift_s =   9.7656e+06
*****************************************************************************

  Execution time = 2.2930e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640567e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9296e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2636
    reference variance = 0.40068
====================================================
  Execution time = 1.3883e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7744e-01
  Total weights = 1.956898310e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265374339122
                                         uncertainty =       0.001516027517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265374339122
                                         uncertainty =       0.001516027517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364399366
  error estimate for blocks of size 2^( 2) =       0.000378303331
  error estimate for blocks of size 2^( 3) =       0.000390982040
  error estimate for blocks of size 2^( 4) =       0.000399286275
  error estimate for blocks of size 2^( 5) =       0.000404927061
  error estimate for blocks of size 2^( 6) =       0.000407477786
  error estimate for blocks of size 2^( 7) =       0.000407041684

      target function =      -0.949092437000
              le_mean =     -17.211833935559
             les_mean =     296.524670916820
             stat err =       0.000404683202
             autocorr =       1.233318165727
   target nu stat err =       0.000404683202
   target dn stat err =       0.002543142907
      target stat err =       0.004333940601
              std dev =       0.515338525886
             le_variance =       0.265573796262


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721183393556e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949111367427       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949111367536       residual = 6.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949111367551       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949111367556       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949111367590       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949111367274       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949111367579       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949111367374       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949111367775       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949111367206       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+05 is 4.495536e-10

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949111367427       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949111367455       residual = 6.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949111367458       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949111367460       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949111366506       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949111366816       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949111367050       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949111367374       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949111366484       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949111368597       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+05 is 1.123884e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949111367427       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949111367434       residual = 6.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949111367435       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949111367434       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949111368159       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949111369057       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949111371503       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949111367272       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949111364108       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949111357398       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+06 is 2.809711e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113433 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6392e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1412
    reference variance = 0.312172
====================================================
  Execution time = 1.3501e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8024e-01
  Total weights = 1.9574e+06
  Execution time = 1.8268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267353986599
                                         uncertainty =       0.001427351197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267353986599
                                         uncertainty =       0.001427351197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365579258
  error estimate for blocks of size 2^( 2) =       0.000379374201
  error estimate for blocks of size 2^( 3) =       0.000391878486
  error estimate for blocks of size 2^( 4) =       0.000401216016
  error estimate for blocks of size 2^( 5) =       0.000406703742
  error estimate for blocks of size 2^( 6) =       0.000410907016
  error estimate for blocks of size 2^( 7) =       0.000413349433

      target function =      -0.944411329609
              le_mean =     -17.211813931378
             les_mean =     296.526777805072
             stat err =       0.000408044052
             autocorr =       1.245807691504
   target nu stat err =       0.000408044052
   target dn stat err =       0.002893392798
      target stat err =       0.004868331385
              std dev =       0.517007145114
             le_variance =       0.267296388099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267353986573
                                         uncertainty =       0.001427351196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267353986573
                                         uncertainty =       0.001427351196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365579258
  error estimate for blocks of size 2^( 2) =       0.000379374201
  error estimate for blocks of size 2^( 3) =       0.000391878486
  error estimate for blocks of size 2^( 4) =       0.000401216016
  error estimate for blocks of size 2^( 5) =       0.000406703742
  error estimate for blocks of size 2^( 6) =       0.000410907016
  error estimate for blocks of size 2^( 7) =       0.000413349433

      target function =      -0.944411329524
              le_mean =     -17.211813931376
             les_mean =     296.526777805080
             stat err =       0.000408044052
             autocorr =       1.245807691814
   target nu stat err =       0.000408044052
   target dn stat err =       0.002893392812
      target stat err =       0.004868331407
              std dev =       0.517007145088
             le_variance =       0.267296388072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267353986586
                                         uncertainty =       0.001427351196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267353986586
                                         uncertainty =       0.001427351196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365579258
  error estimate for blocks of size 2^( 2) =       0.000379374201
  error estimate for blocks of size 2^( 3) =       0.000391878486
  error estimate for blocks of size 2^( 4) =       0.000401216016
  error estimate for blocks of size 2^( 5) =       0.000406703742
  error estimate for blocks of size 2^( 6) =       0.000410907016
  error estimate for blocks of size 2^( 7) =       0.000413349433

      target function =      -0.944411329567
              le_mean =     -17.211813931377
             les_mean =     296.526777805076
             stat err =       0.000408044052
             autocorr =       1.245807691659
   target nu stat err =       0.000408044052
   target dn stat err =       0.002893392805
      target stat err =       0.004868331396
              std dev =       0.517007145101
             le_variance =       0.267296388085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267353986597
                                         uncertainty =       0.001427351197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267353986597
                                         uncertainty =       0.001427351197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365579258
  error estimate for blocks of size 2^( 2) =       0.000379374201
  error estimate for blocks of size 2^( 3) =       0.000391878486
  error estimate for blocks of size 2^( 4) =       0.000401216016
  error estimate for blocks of size 2^( 5) =       0.000406703742
  error estimate for blocks of size 2^( 6) =       0.000410907016
  error estimate for blocks of size 2^( 7) =       0.000413349433

      target function =      -0.944411329603
              le_mean =     -17.211813931378
             les_mean =     296.526777805072
             stat err =       0.000408044052
             autocorr =       1.245807691520
   target nu stat err =       0.000408044052
   target dn stat err =       0.002893392799
      target stat err =       0.004868331386
              std dev =       0.517007145112
             le_variance =       0.267296388097


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944411329609        initial  <--
     2.4414e+05     2.4414e+06             4.4955e-10        -0.944411329524
     9.7656e+05     9.7656e+06             1.1239e-10        -0.944411329567
     3.9062e+06     3.9062e+07             2.8097e-11        -0.944411329603

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8355
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640567e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9256e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2241
    reference variance = 0.204083
====================================================
  Execution time = 1.4053e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8420e-01
  Total weights = 1.957449697e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268321888836
                                         uncertainty =       0.001695349079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268321888836
                                         uncertainty =       0.001695349079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366262942
  error estimate for blocks of size 2^( 2) =       0.000379987644
  error estimate for blocks of size 2^( 3) =       0.000392951609
  error estimate for blocks of size 2^( 4) =       0.000401952067
  error estimate for blocks of size 2^( 5) =       0.000407882370
  error estimate for blocks of size 2^( 6) =       0.000411021653
  error estimate for blocks of size 2^( 7) =       0.000413207559

      target function =      -0.937830625925
              le_mean =     -17.211980206341
             les_mean =     296.536467186169
             stat err =       0.000408515912
             autocorr =       1.244033271727
   target nu stat err =       0.000408515912
   target dn stat err =       0.004312590254
      target stat err =       0.007115423535
              std dev =       0.517974019990
             le_variance =       0.268297085385


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721198020634e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937883522563       residual = 7.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937883522657       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937883522665       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937883522666       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937883521527       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937883522583       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937883521604       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937883522651       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937883520884       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937883524018       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937883524385       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+06 is 1.262717e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937883522563       residual = 7.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937883522586       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937883522588       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937883522594       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937883522445       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937883526674       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937883522854       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937883574247       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937883518905       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937883514966       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937883504049       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+06 is 3.156790e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937883522563       residual = 7.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937883522569       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937883522569       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937883521397       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937883520635       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937883491169       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937883508950       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937883445204       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937883594184       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937883577990       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937883508491       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+07 is 7.891962e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118301 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6568e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2712
    reference variance = 0.202904
====================================================
  Execution time = 1.3512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7531e-01
  Total weights = 1.9574e+06
  Execution time = 1.8195e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266050205102
                                         uncertainty =       0.001758161016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266050205102
                                         uncertainty =       0.001758161016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364721604
  error estimate for blocks of size 2^( 2) =       0.000378667464
  error estimate for blocks of size 2^( 3) =       0.000391331447
  error estimate for blocks of size 2^( 4) =       0.000400411856
  error estimate for blocks of size 2^( 5) =       0.000406303956
  error estimate for blocks of size 2^( 6) =       0.000409183854
  error estimate for blocks of size 2^( 7) =       0.000410689910

      target function =      -0.952727369182
              le_mean =     -17.212763569964
             les_mean =     296.554542805009
             stat err =       0.000406647394
             autocorr =       1.243119870074
   target nu stat err =       0.000406647394
   target dn stat err =       0.002018803080
      target stat err =       0.003500685040
              std dev =       0.515794239303
             le_variance =       0.266043697298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266050205102
                                         uncertainty =       0.001758161017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266050205102
                                         uncertainty =       0.001758161017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364721604
  error estimate for blocks of size 2^( 2) =       0.000378667464
  error estimate for blocks of size 2^( 3) =       0.000391331447
  error estimate for blocks of size 2^( 4) =       0.000400411856
  error estimate for blocks of size 2^( 5) =       0.000406303956
  error estimate for blocks of size 2^( 6) =       0.000409183854
  error estimate for blocks of size 2^( 7) =       0.000410689910

      target function =      -0.952727369221
              le_mean =     -17.212763569965
             les_mean =     296.554542805022
             stat err =       0.000406647394
             autocorr =       1.243119870160
   target nu stat err =       0.000406647394
   target dn stat err =       0.002018803078
      target stat err =       0.003500685037
              std dev =       0.515794239302
             le_variance =       0.266043697298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266050205102
                                         uncertainty =       0.001758161016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266050205102
                                         uncertainty =       0.001758161016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364721604
  error estimate for blocks of size 2^( 2) =       0.000378667464
  error estimate for blocks of size 2^( 3) =       0.000391331447
  error estimate for blocks of size 2^( 4) =       0.000400411856
  error estimate for blocks of size 2^( 5) =       0.000406303956
  error estimate for blocks of size 2^( 6) =       0.000409183854
  error estimate for blocks of size 2^( 7) =       0.000410689910

      target function =      -0.952727369201
              le_mean =     -17.212763569964
             les_mean =     296.554542805016
             stat err =       0.000406647394
             autocorr =       1.243119870113
   target nu stat err =       0.000406647394
   target dn stat err =       0.002018803079
      target stat err =       0.003500685038
              std dev =       0.515794239302
             le_variance =       0.266043697298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266050205102
                                         uncertainty =       0.001758161016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266050205102
                                         uncertainty =       0.001758161016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364721604
  error estimate for blocks of size 2^( 2) =       0.000378667464
  error estimate for blocks of size 2^( 3) =       0.000391331447
  error estimate for blocks of size 2^( 4) =       0.000400411856
  error estimate for blocks of size 2^( 5) =       0.000406303956
  error estimate for blocks of size 2^( 6) =       0.000409183854
  error estimate for blocks of size 2^( 7) =       0.000410689910

      target function =      -0.952727369184
              le_mean =     -17.212763569964
             les_mean =     296.554542805010
             stat err =       0.000406647394
             autocorr =       1.243119870083
   target nu stat err =       0.000406647394
   target dn stat err =       0.002018803080
      target stat err =       0.003500685039
              std dev =       0.515794239303
             le_variance =       0.266043697298


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.952727369182        initial
     2.4414e+06     2.4414e+07             1.2627e-10        -0.952727369221  <--
     9.7656e+06     9.7656e+07             3.1568e-11        -0.952727369201
     3.9062e+07     3.9062e+08             7.8920e-12        -0.952727369184

*****************************************************************************
Applying the update for shift_i =   2.4414e+06     and shift_s =   2.4414e+07
*****************************************************************************

  Execution time = 2.2821e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9396e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1901
    reference variance = 1.06769
====================================================
  Execution time = 1.3757e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8040e-01
  Total weights = 1.957261577e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269668622567
                                         uncertainty =       0.002592846545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269668622567
                                         uncertainty =       0.002592846545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367244571
  error estimate for blocks of size 2^( 2) =       0.000380933444
  error estimate for blocks of size 2^( 3) =       0.000393843009
  error estimate for blocks of size 2^( 4) =       0.000402798482
  error estimate for blocks of size 2^( 5) =       0.000409342656
  error estimate for blocks of size 2^( 6) =       0.000412615182
  error estimate for blocks of size 2^( 7) =       0.000415633241

      target function =      -0.944124362818
              le_mean =     -17.211494440036
             les_mean =     296.515942067850
             stat err =       0.000410097390
             autocorr =       1.246990781721
   target nu stat err =       0.000410097390
   target dn stat err =       0.003467106278
      target stat err =       0.005807840952
              std dev =       0.519362252941
             le_variance =       0.269737149779


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721149444004e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944158703099       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944158703195       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944158703210       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944158703214       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944158703214       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944158703874       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944158703388       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944158702931       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944158703474       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944158702758       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+05 is 3.067443e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944158703099       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944158703123       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944158703127       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944158703128       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944158704397       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944158699137       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944158703258       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944158697839       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944158700233       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944158705709       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+06 is 7.668605e-11

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944158703099       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944158703105       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944158703106       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944158703106       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944158703106       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944158703106       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944158703106       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944158697813       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944158707853       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944158705991       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+06 is 1.917155e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6233e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1688
    reference variance = 0.195803
====================================================
  Execution time = 1.3680e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7696e-01
  Total weights = 1.9572e+06
  Execution time = 1.8276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265730064807
                                         uncertainty =       0.001281069023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265730064807
                                         uncertainty =       0.001281069023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364534546
  error estimate for blocks of size 2^( 2) =       0.000378129758
  error estimate for blocks of size 2^( 3) =       0.000390647751
  error estimate for blocks of size 2^( 4) =       0.000399542295
  error estimate for blocks of size 2^( 5) =       0.000405061427
  error estimate for blocks of size 2^( 6) =       0.000407688254
  error estimate for blocks of size 2^( 7) =       0.000409382105

      target function =      -0.949931668929
              le_mean =     -17.212458149921
             les_mean =     296.545677503857
             stat err =       0.000405418520
             autocorr =       1.236886315527
   target nu stat err =       0.000405418520
   target dn stat err =       0.001807408000
      target stat err =       0.003130402093
              std dev =       0.515529699123
             le_variance =       0.265770870678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265730064825
                                         uncertainty =       0.001281069022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265730064825
                                         uncertainty =       0.001281069022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364534546
  error estimate for blocks of size 2^( 2) =       0.000378129758
  error estimate for blocks of size 2^( 3) =       0.000390647751
  error estimate for blocks of size 2^( 4) =       0.000399542295
  error estimate for blocks of size 2^( 5) =       0.000405061427
  error estimate for blocks of size 2^( 6) =       0.000407688254
  error estimate for blocks of size 2^( 7) =       0.000409382105

      target function =      -0.949931645461
              le_mean =     -17.212458149922
             les_mean =     296.545677517812
             stat err =       0.000405418520
             autocorr =       1.236886315442
   target nu stat err =       0.000405418520
   target dn stat err =       0.001807409003
      target stat err =       0.003130403588
              std dev =       0.515529699142
             le_variance =       0.265770870697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265730064816
                                         uncertainty =       0.001281069022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265730064816
                                         uncertainty =       0.001281069022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364534546
  error estimate for blocks of size 2^( 2) =       0.000378129758
  error estimate for blocks of size 2^( 3) =       0.000390647751
  error estimate for blocks of size 2^( 4) =       0.000399542295
  error estimate for blocks of size 2^( 5) =       0.000405061427
  error estimate for blocks of size 2^( 6) =       0.000407688254
  error estimate for blocks of size 2^( 7) =       0.000409382105

      target function =      -0.949931657195
              le_mean =     -17.212458149921
             les_mean =     296.545677510834
             stat err =       0.000405418520
             autocorr =       1.236886315489
   target nu stat err =       0.000405418520
   target dn stat err =       0.001807408502
      target stat err =       0.003130402840
              std dev =       0.515529699132
             le_variance =       0.265770870687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265730064808
                                         uncertainty =       0.001281069023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265730064808
                                         uncertainty =       0.001281069023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364534546
  error estimate for blocks of size 2^( 2) =       0.000378129758
  error estimate for blocks of size 2^( 3) =       0.000390647751
  error estimate for blocks of size 2^( 4) =       0.000399542295
  error estimate for blocks of size 2^( 5) =       0.000405061427
  error estimate for blocks of size 2^( 6) =       0.000407688254
  error estimate for blocks of size 2^( 7) =       0.000409382105

      target function =      -0.949931667463
              le_mean =     -17.212458149921
             les_mean =     296.545677504729
             stat err =       0.000405418520
             autocorr =       1.236886315520
   target nu stat err =       0.000405418520
   target dn stat err =       0.001807408063
      target stat err =       0.003130402186
              std dev =       0.515529699124
             le_variance =       0.265770870679


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949931668929        initial  <--
     6.1035e+05     6.1035e+06             3.0674e-10        -0.949931645461
     2.4414e+06     2.4414e+07             7.6686e-11        -0.949931657195
     9.7656e+06     9.7656e+07             1.9172e-11        -0.949931667463

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0002
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9240e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2723
    reference variance = 0.300477
====================================================
  Execution time = 1.5123e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5310e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8085e-01
  Total weights = 1.957604579e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.8196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267590430365
                                         uncertainty =       0.001601385032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267590430365
                                         uncertainty =       0.001601385032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365731916
  error estimate for blocks of size 2^( 2) =       0.000379643922
  error estimate for blocks of size 2^( 3) =       0.000391962980
  error estimate for blocks of size 2^( 4) =       0.000401608278
  error estimate for blocks of size 2^( 5) =       0.000407483007
  error estimate for blocks of size 2^( 6) =       0.000409910016
  error estimate for blocks of size 2^( 7) =       0.000410588966

      target function =      -0.943405556810
              le_mean =     -17.212004551620
             les_mean =     296.533949219250
             stat err =       0.000407397567
             autocorr =       1.240826723316
   target nu stat err =       0.000407397567
   target dn stat err =       0.002679526565
      target stat err =       0.004508552831
              std dev =       0.517223036225
             le_variance =       0.267519669202


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721200455162e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943426007892       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943426007898       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943426007899       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943426008493       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943426004752       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943426006923       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943426014081       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943426002193       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943426004359       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943425991821       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+06 is 1.601247e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943426007892       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943426007894       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943426007894       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943426008012       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943425980464       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943425978143       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943425991205       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943426007894       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943425979594       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943426002371       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+07 is 4.003127e-12

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943426007892       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943426007892       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943426007892       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943426007892       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943426047179       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943426091392       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943426054230       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943425929290       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943426003629       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943426015736       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+07 is 1.000785e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125264 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7952e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1549
    reference variance = 0.206256
====================================================
  Execution time = 1.3653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7816e-01
  Total weights = 1.9570e+06
  Execution time = 2.1955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266901315692
                                         uncertainty =       0.001379426655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266901315692
                                         uncertainty =       0.001379426655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365317359
  error estimate for blocks of size 2^( 2) =       0.000379228982
  error estimate for blocks of size 2^( 3) =       0.000391483505
  error estimate for blocks of size 2^( 4) =       0.000401688843
  error estimate for blocks of size 2^( 5) =       0.000408170505
  error estimate for blocks of size 2^( 6) =       0.000410803625
  error estimate for blocks of size 2^( 7) =       0.000414463118

      target function =      -0.947891651499
              le_mean =     -17.211685572438
             les_mean =     296.520280693027
             stat err =       0.000408781523
             autocorr =       1.252108301465
   target nu stat err =       0.000408781523
   target dn stat err =       0.002054156950
      target stat err =       0.003517781260
              std dev =       0.516636764338
             le_variance =       0.266913546266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266901315690
                                         uncertainty =       0.001379426655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266901315690
                                         uncertainty =       0.001379426655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365317359
  error estimate for blocks of size 2^( 2) =       0.000379228982
  error estimate for blocks of size 2^( 3) =       0.000391483505
  error estimate for blocks of size 2^( 4) =       0.000401688843
  error estimate for blocks of size 2^( 5) =       0.000408170505
  error estimate for blocks of size 2^( 6) =       0.000410803625
  error estimate for blocks of size 2^( 7) =       0.000414463118

      target function =      -0.947891651653
              le_mean =     -17.211685572438
             les_mean =     296.520280692930
             stat err =       0.000408781523
             autocorr =       1.252108301486
   target nu stat err =       0.000408781523
   target dn stat err =       0.002054156946
      target stat err =       0.003517781255
              std dev =       0.516636764337
             le_variance =       0.266913546264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266901315691
                                         uncertainty =       0.001379426655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266901315691
                                         uncertainty =       0.001379426655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365317359
  error estimate for blocks of size 2^( 2) =       0.000379228982
  error estimate for blocks of size 2^( 3) =       0.000391483505
  error estimate for blocks of size 2^( 4) =       0.000401688843
  error estimate for blocks of size 2^( 5) =       0.000408170505
  error estimate for blocks of size 2^( 6) =       0.000410803625
  error estimate for blocks of size 2^( 7) =       0.000414463118

      target function =      -0.947891651576
              le_mean =     -17.211685572438
             les_mean =     296.520280692978
             stat err =       0.000408781523
             autocorr =       1.252108301477
   target nu stat err =       0.000408781523
   target dn stat err =       0.002054156948
      target stat err =       0.003517781257
              std dev =       0.516636764337
             le_variance =       0.266913546265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266901315692
                                         uncertainty =       0.001379426655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266901315692
                                         uncertainty =       0.001379426655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365317359
  error estimate for blocks of size 2^( 2) =       0.000379228982
  error estimate for blocks of size 2^( 3) =       0.000391483505
  error estimate for blocks of size 2^( 4) =       0.000401688843
  error estimate for blocks of size 2^( 5) =       0.000408170505
  error estimate for blocks of size 2^( 6) =       0.000410803625
  error estimate for blocks of size 2^( 7) =       0.000414463118

      target function =      -0.947891651509
              le_mean =     -17.211685572438
             les_mean =     296.520280693021
             stat err =       0.000408781523
             autocorr =       1.252108301479
   target nu stat err =       0.000408781523
   target dn stat err =       0.002054156949
      target stat err =       0.003517781259
              std dev =       0.516636764338
             le_variance =       0.266913546265


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947891651499        initial
     6.1035e+06     6.1035e+07             1.6012e-11        -0.947891651653  <--
     2.4414e+07     2.4414e+08             4.0031e-12        -0.947891651576
     9.7656e+07     9.7656e+08             1.0008e-12        -0.947891651509

*****************************************************************************
Applying the update for shift_i =   6.1035e+06     and shift_s =   6.1035e+07
*****************************************************************************

  Execution time = 2.4275e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2233e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.156
    reference variance = 0.266983
====================================================
  Execution time = 1.3836e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8429e-01
  Total weights = 1.957472170e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269615180416
                                         uncertainty =       0.001829422321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269615180416
                                         uncertainty =       0.001829422321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367117885
  error estimate for blocks of size 2^( 2) =       0.000380959961
  error estimate for blocks of size 2^( 3) =       0.000393334801
  error estimate for blocks of size 2^( 4) =       0.000401735377
  error estimate for blocks of size 2^( 5) =       0.000407520376
  error estimate for blocks of size 2^( 6) =       0.000410229762
  error estimate for blocks of size 2^( 7) =       0.000411624105

      target function =      -0.937717267879
              le_mean =     -17.211834803540
             les_mean =     296.531550149222
             stat err =       0.000407777405
             autocorr =       1.233772911917
   target nu stat err =       0.000407777405
   target dn stat err =       0.002665088530
      target stat err =       0.004430347621
              std dev =       0.519183091252
             le_variance =       0.269551082242


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721183480354e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937737333211       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937737333251       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937737333255       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937737333257       residual = 6.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937737332961       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937737333257       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937737333252       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937737333257       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937737331417       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937737333257       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+06 is 8.091717e-11

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937737333211       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937737333221       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937737333222       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937737333223       residual = 6.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937737333482       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937737333223       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937737333223       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937737333223       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937737329119       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937737336017       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+06 is 2.022930e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937737333211       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937737333213       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937737333214       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937737333214       residual = 6.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937737332212       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937737350873       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937737333214       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937737374520       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937737307241       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937737333214       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+07 is 5.057323e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128713 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6339e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2442
    reference variance = 0.470879
====================================================
  Execution time = 1.3521e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7364e-01
  Total weights = 1.9572e+06
  Execution time = 1.8315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264621605541
                                         uncertainty =       0.001353620079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264621605541
                                         uncertainty =       0.001353620079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363747454
  error estimate for blocks of size 2^( 2) =       0.000377541245
  error estimate for blocks of size 2^( 3) =       0.000390155842
  error estimate for blocks of size 2^( 4) =       0.000399554763
  error estimate for blocks of size 2^( 5) =       0.000406445220
  error estimate for blocks of size 2^( 6) =       0.000410471388
  error estimate for blocks of size 2^( 7) =       0.000412973087

      target function =      -0.955564193333
              le_mean =     -17.212613806448
             les_mean =     296.547718360240
             stat err =       0.000407361114
             autocorr =       1.254178110419
   target nu stat err =       0.000407361114
   target dn stat err =       0.001723746983
      target stat err =       0.003029613960
              std dev =       0.514416582165
             le_variance =       0.264624420006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264621605533
                                         uncertainty =       0.001353620080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264621605533
                                         uncertainty =       0.001353620080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363747454
  error estimate for blocks of size 2^( 2) =       0.000377541245
  error estimate for blocks of size 2^( 3) =       0.000390155842
  error estimate for blocks of size 2^( 4) =       0.000399554763
  error estimate for blocks of size 2^( 5) =       0.000406445220
  error estimate for blocks of size 2^( 6) =       0.000410471388
  error estimate for blocks of size 2^( 7) =       0.000412973087

      target function =      -0.955564193352
              le_mean =     -17.212613806447
             les_mean =     296.547718360207
             stat err =       0.000407361114
             autocorr =       1.254178110465
   target nu stat err =       0.000407361114
   target dn stat err =       0.001723746979
      target stat err =       0.003029613955
              std dev =       0.514416582157
             le_variance =       0.264624419998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264621605537
                                         uncertainty =       0.001353620080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264621605537
                                         uncertainty =       0.001353620080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363747454
  error estimate for blocks of size 2^( 2) =       0.000377541245
  error estimate for blocks of size 2^( 3) =       0.000390155842
  error estimate for blocks of size 2^( 4) =       0.000399554763
  error estimate for blocks of size 2^( 5) =       0.000406445220
  error estimate for blocks of size 2^( 6) =       0.000410471388
  error estimate for blocks of size 2^( 7) =       0.000412973087

      target function =      -0.955564193342
              le_mean =     -17.212613806448
             les_mean =     296.547718360223
             stat err =       0.000407361114
             autocorr =       1.254178110442
   target nu stat err =       0.000407361114
   target dn stat err =       0.001723746981
      target stat err =       0.003029613957
              std dev =       0.514416582161
             le_variance =       0.264624420002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264621605541
                                         uncertainty =       0.001353620080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264621605541
                                         uncertainty =       0.001353620080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363747454
  error estimate for blocks of size 2^( 2) =       0.000377541245
  error estimate for blocks of size 2^( 3) =       0.000390155842
  error estimate for blocks of size 2^( 4) =       0.000399554763
  error estimate for blocks of size 2^( 5) =       0.000406445220
  error estimate for blocks of size 2^( 6) =       0.000410471388
  error estimate for blocks of size 2^( 7) =       0.000412973087

      target function =      -0.955564193334
              le_mean =     -17.212613806448
             les_mean =     296.547718360238
             stat err =       0.000407361114
             autocorr =       1.254178110439
   target nu stat err =       0.000407361114
   target dn stat err =       0.001723746983
      target stat err =       0.003029613960
              std dev =       0.514416582164
             le_variance =       0.264624420006


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.955564193333        initial
     1.5259e+06     1.5259e+07             8.0917e-11        -0.955564193352  <--
     6.1035e+06     6.1035e+07             2.0229e-11        -0.955564193342
     2.4414e+07     2.4414e+08             5.0573e-12        -0.955564193334

*****************************************************************************
Applying the update for shift_i =   1.5259e+06     and shift_s =   1.5259e+07
*****************************************************************************

  Execution time = 2.2877e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9228e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2609
    reference variance = 0.250352
====================================================
  Execution time = 1.3787e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7723e-01
  Total weights = 1.957396698e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266286906208
                                         uncertainty =       0.001349272872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266286906208
                                         uncertainty =       0.001349272872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364931562
  error estimate for blocks of size 2^( 2) =       0.000378643217
  error estimate for blocks of size 2^( 3) =       0.000391388102
  error estimate for blocks of size 2^( 4) =       0.000401038631
  error estimate for blocks of size 2^( 5) =       0.000406102542
  error estimate for blocks of size 2^( 6) =       0.000408996353
  error estimate for blocks of size 2^( 7) =       0.000411229070

      target function =      -0.949460924199
              le_mean =     -17.211823943575
             les_mean =     296.524112471467
             stat err =       0.000406841649
             autocorr =       1.242876454105
   target nu stat err =       0.000406841649
   target dn stat err =       0.001943674351
      target stat err =       0.003347698402
              std dev =       0.516091163740
             le_variance =       0.266350089291


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721182394358e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949471684323       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949471684378       residual = 7.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949471684386       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949471684389       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949471684390       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949471684389       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949471684389       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949471684585       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949471684389       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+05 is 2.787941e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949471684323       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949471684337       residual = 7.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949471684339       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949471685362       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949471684340       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949471684340       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949471684340       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949471682456       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949471683008       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+06 is 6.969852e-11

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949471684323       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949471684327       residual = 7.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949471684327       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949471684328       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949471684328       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949471684328       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949471684328       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949471684328       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949471684328       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+06 is 1.742465e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131750 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6276e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245259e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2574
    reference variance = 0.385161
====================================================
  Execution time = 1.3502e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7755e-01
  Total weights = 1.9575e+06
  Execution time = 1.8243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266230529430
                                         uncertainty =       0.001220938261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266230529430
                                         uncertainty =       0.001220938261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364828834
  error estimate for blocks of size 2^( 2) =       0.000379158614
  error estimate for blocks of size 2^( 3) =       0.000391978831
  error estimate for blocks of size 2^( 4) =       0.000401159414
  error estimate for blocks of size 2^( 5) =       0.000406660019
  error estimate for blocks of size 2^( 6) =       0.000409483014
  error estimate for blocks of size 2^( 7) =       0.000413070915

      target function =      -0.948884884285
              le_mean =     -17.210712695691
             les_mean =     296.486182402871
             stat err =       0.000407593341
             autocorr =       1.248176065189
   target nu stat err =       0.000407593341
   target dn stat err =       0.001871548232
      target stat err =       0.003219135216
              std dev =       0.515945884302
             le_variance =       0.266200155528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266230529402
                                         uncertainty =       0.001220938258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266230529402
                                         uncertainty =       0.001220938258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364828833
  error estimate for blocks of size 2^( 2) =       0.000379158614
  error estimate for blocks of size 2^( 3) =       0.000391978831
  error estimate for blocks of size 2^( 4) =       0.000401159414
  error estimate for blocks of size 2^( 5) =       0.000406660019
  error estimate for blocks of size 2^( 6) =       0.000409483014
  error estimate for blocks of size 2^( 7) =       0.000413070915

      target function =      -0.948884883603
              le_mean =     -17.210712695695
             les_mean =     296.486182403428
             stat err =       0.000407593341
             autocorr =       1.248176065287
   target nu stat err =       0.000407593341
   target dn stat err =       0.001871548214
      target stat err =       0.003219135183
              std dev =       0.515945884274
             le_variance =       0.266200155499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266230529416
                                         uncertainty =       0.001220938259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266230529416
                                         uncertainty =       0.001220938259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364828834
  error estimate for blocks of size 2^( 2) =       0.000379158614
  error estimate for blocks of size 2^( 3) =       0.000391978831
  error estimate for blocks of size 2^( 4) =       0.000401159414
  error estimate for blocks of size 2^( 5) =       0.000406660019
  error estimate for blocks of size 2^( 6) =       0.000409483014
  error estimate for blocks of size 2^( 7) =       0.000413070915

      target function =      -0.948884883944
              le_mean =     -17.210712695693
             les_mean =     296.486182403149
             stat err =       0.000407593341
             autocorr =       1.248176065241
   target nu stat err =       0.000407593341
   target dn stat err =       0.001871548223
      target stat err =       0.003219135200
              std dev =       0.515945884288
             le_variance =       0.266200155514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266230529428
                                         uncertainty =       0.001220938260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266230529428
                                         uncertainty =       0.001220938260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364828834
  error estimate for blocks of size 2^( 2) =       0.000379158614
  error estimate for blocks of size 2^( 3) =       0.000391978831
  error estimate for blocks of size 2^( 4) =       0.000401159414
  error estimate for blocks of size 2^( 5) =       0.000406660019
  error estimate for blocks of size 2^( 6) =       0.000409483014
  error estimate for blocks of size 2^( 7) =       0.000413070915

      target function =      -0.948884884242
              le_mean =     -17.210712695691
             les_mean =     296.486182402906
             stat err =       0.000407593341
             autocorr =       1.248176065190
   target nu stat err =       0.000407593341
   target dn stat err =       0.001871548231
      target stat err =       0.003219135214
              std dev =       0.515945884300
             le_variance =       0.266200155527


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948884884285        initial  <--
     3.8147e+05     3.8147e+06             2.7879e-10        -0.948884883603
     1.5259e+06     1.5259e+07             6.9699e-11        -0.948884883944
     6.1035e+06     6.1035e+07             1.7425e-11        -0.948884884242

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8196
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9102e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1947
    reference variance = 0.179785
====================================================
  Execution time = 1.3817e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8231e-01
  Total weights = 1.957203668e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269720462508
                                         uncertainty =       0.001834664428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269720462508
                                         uncertainty =       0.001834664428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367251282
  error estimate for blocks of size 2^( 2) =       0.000381221306
  error estimate for blocks of size 2^( 3) =       0.000394148208
  error estimate for blocks of size 2^( 4) =       0.000403560064
  error estimate for blocks of size 2^( 5) =       0.000408511004
  error estimate for blocks of size 2^( 6) =       0.000411148968
  error estimate for blocks of size 2^( 7) =       0.000412942631

      target function =      -0.940964100836
              le_mean =     -17.211337250317
             les_mean =     296.512444825432
             stat err =       0.000409040667
             autocorr =       1.240527321153
   target nu stat err =       0.000409040667
   target dn stat err =       0.002775482455
      target stat err =       0.004636832518
              std dev =       0.519371743931
             le_variance =       0.269747008393


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721133725032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940985879595       residual = 3.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940985879620       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940985879626       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940985879627       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940985879627       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940985879627       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940985887495       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940985873497       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940985879627       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940985869828       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940985887478       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+06 is 5.207908e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940985879595       residual = 3.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940985879602       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940985879603       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940985879603       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940985879604       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940985918858       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940985900194       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940985859785       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940985881646       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940985845543       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940985892917       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+07 is 1.301977e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940985879595       residual = 3.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940985879597       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940985879597       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940985879598       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940985890671       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940985918185       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940986028737       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940985897457       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940985877989       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940985872621       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940985867207       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+07 is 3.254956e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135835 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6305e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2013
    reference variance = 0.150816
====================================================
  Execution time = 1.3352e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7625e-01
  Total weights = 1.9573e+06
  Execution time = 1.8339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266668702309
                                         uncertainty =       0.001548729465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266668702309
                                         uncertainty =       0.001548729465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365153568
  error estimate for blocks of size 2^( 2) =       0.000379425995
  error estimate for blocks of size 2^( 3) =       0.000392242888
  error estimate for blocks of size 2^( 4) =       0.000401845821
  error estimate for blocks of size 2^( 5) =       0.000407396255
  error estimate for blocks of size 2^( 6) =       0.000411304436
  error estimate for blocks of size 2^( 7) =       0.000413377403

      target function =      -0.951120783182
              le_mean =     -17.212352393447
             les_mean =     296.541329870652
             stat err =       0.000408480978
             autocorr =       1.251389705885
   target nu stat err =       0.000408480978
   target dn stat err =       0.001853983487
      target stat err =       0.003215282423
              std dev =       0.516405128397
             le_variance =       0.266674256634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266668702307
                                         uncertainty =       0.001548729465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266668702307
                                         uncertainty =       0.001548729465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365153568
  error estimate for blocks of size 2^( 2) =       0.000379425995
  error estimate for blocks of size 2^( 3) =       0.000392242888
  error estimate for blocks of size 2^( 4) =       0.000401845821
  error estimate for blocks of size 2^( 5) =       0.000407396255
  error estimate for blocks of size 2^( 6) =       0.000411304436
  error estimate for blocks of size 2^( 7) =       0.000413377403

      target function =      -0.951120783200
              le_mean =     -17.212352393446
             les_mean =     296.541329870629
             stat err =       0.000408480979
             autocorr =       1.251389705997
   target nu stat err =       0.000408480979
   target dn stat err =       0.001853983487
      target stat err =       0.003215282423
              std dev =       0.516405128395
             le_variance =       0.266674256633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266668702308
                                         uncertainty =       0.001548729465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266668702308
                                         uncertainty =       0.001548729465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365153568
  error estimate for blocks of size 2^( 2) =       0.000379425995
  error estimate for blocks of size 2^( 3) =       0.000392242888
  error estimate for blocks of size 2^( 4) =       0.000401845821
  error estimate for blocks of size 2^( 5) =       0.000407396255
  error estimate for blocks of size 2^( 6) =       0.000411304436
  error estimate for blocks of size 2^( 7) =       0.000413377403

      target function =      -0.951120783191
              le_mean =     -17.212352393446
             les_mean =     296.541329870641
             stat err =       0.000408480978
             autocorr =       1.251389705936
   target nu stat err =       0.000408480978
   target dn stat err =       0.001853983487
      target stat err =       0.003215282423
              std dev =       0.516405128396
             le_variance =       0.266674256634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266668702309
                                         uncertainty =       0.001548729465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266668702309
                                         uncertainty =       0.001548729465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365153568
  error estimate for blocks of size 2^( 2) =       0.000379425995
  error estimate for blocks of size 2^( 3) =       0.000392242888
  error estimate for blocks of size 2^( 4) =       0.000401845821
  error estimate for blocks of size 2^( 5) =       0.000407396255
  error estimate for blocks of size 2^( 6) =       0.000411304436
  error estimate for blocks of size 2^( 7) =       0.000413377403

      target function =      -0.951120783184
              le_mean =     -17.212352393447
             les_mean =     296.541329870651
             stat err =       0.000408480978
             autocorr =       1.251389705898
   target nu stat err =       0.000408480978
   target dn stat err =       0.001853983487
      target stat err =       0.003215282423
              std dev =       0.516405128397
             le_variance =       0.266674256634


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951120783182        initial
     3.8147e+06     3.8147e+07             5.2079e-11        -0.951120783200  <--
     1.5259e+07     1.5259e+08             1.3020e-11        -0.951120783191
     6.1035e+07     6.1035e+08             3.2550e-12        -0.951120783184

*****************************************************************************
Applying the update for shift_i =   3.8147e+06     and shift_s =   3.8147e+07
*****************************************************************************

  Execution time = 2.2693e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9021e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2266
    reference variance = 0.150046
====================================================
  Execution time = 1.3780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7763e-01
  Total weights = 1.957165137e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266462730495
                                         uncertainty =       0.001665232469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266462730495
                                         uncertainty =       0.001665232469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364982503
  error estimate for blocks of size 2^( 2) =       0.000378801122
  error estimate for blocks of size 2^( 3) =       0.000391621547
  error estimate for blocks of size 2^( 4) =       0.000400950624
  error estimate for blocks of size 2^( 5) =       0.000406520171
  error estimate for blocks of size 2^( 6) =       0.000409477893
  error estimate for blocks of size 2^( 7) =       0.000413126392

      target function =      -0.948782424525
              le_mean =     -17.211977336185
             les_mean =     296.529798345586
             stat err =       0.000407518770
             autocorr =       1.246668950143
   target nu stat err =       0.000407518770
   target dn stat err =       0.002066676350
      target stat err =       0.003546308664
              std dev =       0.516163205827
             le_variance =       0.266424455049


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721197733619e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948794689533       residual = 9.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948794689563       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948794689567       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948794689589       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948794690707       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948794689129       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948794689541       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948794689686       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948794688007       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948794689523       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+05 is 1.417482e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948794689533       residual = 9.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948794689541       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948794689542       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948794689542       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948794686857       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948794692713       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948794686095       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948794699528       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948794694270       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948794698417       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+06 is 3.543711e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948794689533       residual = 9.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948794689535       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948794689536       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948794689536       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948794678199       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948794692125       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948794680583       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948794687277       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948794685960       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948794698613       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+07 is 8.859251e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139395 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6263e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2186
    reference variance = 0.27006
====================================================
  Execution time = 1.3386e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8069e-01
  Total weights = 1.9573e+06
  Execution time = 1.8267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267192812652
                                         uncertainty =       0.001520044214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267192812652
                                         uncertainty =       0.001520044214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365500883
  error estimate for blocks of size 2^( 2) =       0.000379510891
  error estimate for blocks of size 2^( 3) =       0.000392291379
  error estimate for blocks of size 2^( 4) =       0.000402276586
  error estimate for blocks of size 2^( 5) =       0.000407948344
  error estimate for blocks of size 2^( 6) =       0.000411575309
  error estimate for blocks of size 2^( 7) =       0.000414046539

      target function =      -0.943648795079
              le_mean =     -17.211293897542
             les_mean =     296.509326938906
             stat err =       0.000408961695
             autocorr =       1.251954088196
   target nu stat err =       0.000408961695
   target dn stat err =       0.003071662880
      target stat err =       0.005148919363
              std dev =       0.516896305744
             le_variance =       0.267181790892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267192812645
                                         uncertainty =       0.001520044214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267192812645
                                         uncertainty =       0.001520044214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365500883
  error estimate for blocks of size 2^( 2) =       0.000379510891
  error estimate for blocks of size 2^( 3) =       0.000392291379
  error estimate for blocks of size 2^( 4) =       0.000402276586
  error estimate for blocks of size 2^( 5) =       0.000407948344
  error estimate for blocks of size 2^( 6) =       0.000411575309
  error estimate for blocks of size 2^( 7) =       0.000414046539

      target function =      -0.943648794948
              le_mean =     -17.211293897544
             les_mean =     296.509326939033
             stat err =       0.000408961695
             autocorr =       1.251954088252
   target nu stat err =       0.000408961695
   target dn stat err =       0.003071662862
      target stat err =       0.005148919333
              std dev =       0.516896305737
             le_variance =       0.267181790884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267192812649
                                         uncertainty =       0.001520044214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267192812649
                                         uncertainty =       0.001520044214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365500883
  error estimate for blocks of size 2^( 2) =       0.000379510891
  error estimate for blocks of size 2^( 3) =       0.000392291379
  error estimate for blocks of size 2^( 4) =       0.000402276586
  error estimate for blocks of size 2^( 5) =       0.000407948344
  error estimate for blocks of size 2^( 6) =       0.000411575309
  error estimate for blocks of size 2^( 7) =       0.000414046539

      target function =      -0.943648795014
              le_mean =     -17.211293897543
             les_mean =     296.509326938970
             stat err =       0.000408961695
             autocorr =       1.251954088223
   target nu stat err =       0.000408961695
   target dn stat err =       0.003071662871
      target stat err =       0.005148919348
              std dev =       0.516896305740
             le_variance =       0.267181790888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267192812652
                                         uncertainty =       0.001520044214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267192812652
                                         uncertainty =       0.001520044214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365500883
  error estimate for blocks of size 2^( 2) =       0.000379510891
  error estimate for blocks of size 2^( 3) =       0.000392291379
  error estimate for blocks of size 2^( 4) =       0.000402276586
  error estimate for blocks of size 2^( 5) =       0.000407948344
  error estimate for blocks of size 2^( 6) =       0.000411575309
  error estimate for blocks of size 2^( 7) =       0.000414046539

      target function =      -0.943648795071
              le_mean =     -17.211293897542
             les_mean =     296.509326938914
             stat err =       0.000408961695
             autocorr =       1.251954088186
   target nu stat err =       0.000408961695
   target dn stat err =       0.003071662879
      target stat err =       0.005148919361
              std dev =       0.516896305743
             le_variance =       0.267181790891


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943648795079        initial  <--
     9.5367e+05     9.5367e+06             1.4175e-10        -0.943648794948
     3.8147e+06     3.8147e+07             3.5437e-11        -0.943648795014
     1.5259e+07     1.5259e+08             8.8593e-12        -0.943648795071

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7232
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8993e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1994
    reference variance = 0.289416
====================================================
  Execution time = 1.4066e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7903e-01
  Total weights = 1.957430470e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267129603672
                                         uncertainty =       0.001392482700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267129603672
                                         uncertainty =       0.001392482700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365455672
  error estimate for blocks of size 2^( 2) =       0.000379352877
  error estimate for blocks of size 2^( 3) =       0.000392548094
  error estimate for blocks of size 2^( 4) =       0.000402199938
  error estimate for blocks of size 2^( 5) =       0.000407437480
  error estimate for blocks of size 2^( 6) =       0.000410055495
  error estimate for blocks of size 2^( 7) =       0.000411989101

      target function =      -0.946456787559
              le_mean =     -17.212601203243
             les_mean =     296.552670083200
             stat err =       0.000407920504
             autocorr =       1.245895615988
   target nu stat err =       0.000407920504
   target dn stat err =       0.002252645979
      target stat err =       0.003838812816
              std dev =       0.516832367561
             le_variance =       0.267115696159


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721260120324e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946471212070       residual = 9.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946471212073       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946471212073       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946471212073       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946471212074       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946471212074       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946471212074       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946471210948       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946471212074       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946471225280       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+06 is 1.073088e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946471212070       residual = 9.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946471212070       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946471212071       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946471212071       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946471212071       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946471212071       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946471212071       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946471266792       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946471212071       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946471308078       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+07 is 2.682685e-12

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946471212070       residual = 9.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946471212070       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946471212070       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946471212070       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946471212070       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946471212070       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946471212070       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946471344876       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946471212070       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946471212070       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+08 is 6.706447e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142890 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6553e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1781
    reference variance = 0.198702
====================================================
  Execution time = 1.3418e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7652e-01
  Total weights = 1.9573e+06
  Execution time = 1.8196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264876932241
                                         uncertainty =       0.001295186889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264876932241
                                         uncertainty =       0.001295186889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363885608
  error estimate for blocks of size 2^( 2) =       0.000377922853
  error estimate for blocks of size 2^( 3) =       0.000390434323
  error estimate for blocks of size 2^( 4) =       0.000399972656
  error estimate for blocks of size 2^( 5) =       0.000406210493
  error estimate for blocks of size 2^( 6) =       0.000410709048
  error estimate for blocks of size 2^( 7) =       0.000413896867

      target function =      -0.950631730871
              le_mean =     -17.211812538417
             les_mean =     296.523014154814
             stat err =       0.000407697266
             autocorr =       1.255295116400
   target nu stat err =       0.000407697266
   target dn stat err =       0.003085045417
      target stat err =       0.005251756984
              std dev =       0.514611962454
             le_variance =       0.264825471901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264876932240
                                         uncertainty =       0.001295186889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264876932240
                                         uncertainty =       0.001295186889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363885608
  error estimate for blocks of size 2^( 2) =       0.000377922853
  error estimate for blocks of size 2^( 3) =       0.000390434323
  error estimate for blocks of size 2^( 4) =       0.000399972656
  error estimate for blocks of size 2^( 5) =       0.000406210493
  error estimate for blocks of size 2^( 6) =       0.000410709048
  error estimate for blocks of size 2^( 7) =       0.000413896867

      target function =      -0.950631730924
              le_mean =     -17.211812538417
             les_mean =     296.523014154785
             stat err =       0.000407697266
             autocorr =       1.255295116393
   target nu stat err =       0.000407697266
   target dn stat err =       0.003085045392
      target stat err =       0.005251756943
              std dev =       0.514611962454
             le_variance =       0.264825471901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264876932241
                                         uncertainty =       0.001295186889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264876932241
                                         uncertainty =       0.001295186889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363885608
  error estimate for blocks of size 2^( 2) =       0.000377922853
  error estimate for blocks of size 2^( 3) =       0.000390434323
  error estimate for blocks of size 2^( 4) =       0.000399972656
  error estimate for blocks of size 2^( 5) =       0.000406210493
  error estimate for blocks of size 2^( 6) =       0.000410709048
  error estimate for blocks of size 2^( 7) =       0.000413896867

      target function =      -0.950631730897
              le_mean =     -17.211812538417
             les_mean =     296.523014154800
             stat err =       0.000407697266
             autocorr =       1.255295116399
   target nu stat err =       0.000407697266
   target dn stat err =       0.003085045405
      target stat err =       0.005251756964
              std dev =       0.514611962454
             le_variance =       0.264825471901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264876932241
                                         uncertainty =       0.001295186889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264876932241
                                         uncertainty =       0.001295186889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363885608
  error estimate for blocks of size 2^( 2) =       0.000377922853
  error estimate for blocks of size 2^( 3) =       0.000390434323
  error estimate for blocks of size 2^( 4) =       0.000399972656
  error estimate for blocks of size 2^( 5) =       0.000406210493
  error estimate for blocks of size 2^( 6) =       0.000410709048
  error estimate for blocks of size 2^( 7) =       0.000413896867

      target function =      -0.950631730874
              le_mean =     -17.211812538417
             les_mean =     296.523014154813
             stat err =       0.000407697266
             autocorr =       1.255295116402
   target nu stat err =       0.000407697266
   target dn stat err =       0.003085045415
      target stat err =       0.005251756981
              std dev =       0.514611962454
             le_variance =       0.264825471901


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950631730871        initial
     9.5367e+06     9.5367e+07             1.0731e-11        -0.950631730924  <--
     3.8147e+07     3.8147e+08             2.6827e-12        -0.950631730897
     1.5259e+08     1.5259e+09             6.7064e-13        -0.950631730874

*****************************************************************************
Applying the update for shift_i =   9.5367e+06     and shift_s =   9.5367e+07
*****************************************************************************

  Execution time = 2.2714e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743105e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9273e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.3555
    reference variance = 0.742511
====================================================
  Execution time = 1.3842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7909e-01
  Total weights = 1.957557137e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267731900960
                                         uncertainty =       0.002499115046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267731900960
                                         uncertainty =       0.002499115046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365913146
  error estimate for blocks of size 2^( 2) =       0.000379896260
  error estimate for blocks of size 2^( 3) =       0.000392381710
  error estimate for blocks of size 2^( 4) =       0.000401409935
  error estimate for blocks of size 2^( 5) =       0.000406171182
  error estimate for blocks of size 2^( 6) =       0.000409202716
  error estimate for blocks of size 2^( 7) =       0.000411823347

      target function =      -0.946330680766
              le_mean =     -17.211852297376
             les_mean =     296.526946149547
             stat err =       0.000407151795
             autocorr =       1.238102730738
   target nu stat err =       0.000407151795
   target dn stat err =       0.003094595846
      target stat err =       0.005220848563
              std dev =       0.517479334239
             le_variance =       0.267784861365


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721185229738e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946358133707       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946358133729       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946358133732       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946358133733       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946358133693       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946358135926       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946358132781       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946358130603       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946358133771       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946358137699       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+06 is 5.153881e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946358133707       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946358133712       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946358133713       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946358138084       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946358139464       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946358133713       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946358112959       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946358140676       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946358118353       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946358139754       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+06 is 1.288471e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946358133707       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946358133708       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946358133708       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946358133708       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946358133708       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946358133708       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946358034412       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946358167690       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946358111811       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946358133708       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+07 is 3.221176e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146393 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6320e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2409
    reference variance = 0.196127
====================================================
  Execution time = 1.3438e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7550e-01
  Total weights = 1.9573e+06
  Execution time = 1.8207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265917503281
                                         uncertainty =       0.002128123851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265917503281
                                         uncertainty =       0.002128123851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364627391
  error estimate for blocks of size 2^( 2) =       0.000378200420
  error estimate for blocks of size 2^( 3) =       0.000391051002
  error estimate for blocks of size 2^( 4) =       0.000400025491
  error estimate for blocks of size 2^( 5) =       0.000405494126
  error estimate for blocks of size 2^( 6) =       0.000408868794
  error estimate for blocks of size 2^( 7) =       0.000410221974

      target function =      -0.952353058146
              le_mean =     -17.211371917798
             les_mean =     296.506824480946
             stat err =       0.000406152597
             autocorr =       1.240737441554
   target nu stat err =       0.000406152597
   target dn stat err =       0.002380356533
      target stat err =       0.004088826414
              std dev =       0.515661001585
             le_variance =       0.265906268556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265917503276
                                         uncertainty =       0.002128123853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265917503276
                                         uncertainty =       0.002128123853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364627391
  error estimate for blocks of size 2^( 2) =       0.000378200420
  error estimate for blocks of size 2^( 3) =       0.000391051002
  error estimate for blocks of size 2^( 4) =       0.000400025491
  error estimate for blocks of size 2^( 5) =       0.000405494126
  error estimate for blocks of size 2^( 6) =       0.000408868794
  error estimate for blocks of size 2^( 7) =       0.000410221974

      target function =      -0.952353058297
              le_mean =     -17.211371917798
             les_mean =     296.506824480851
             stat err =       0.000406152597
             autocorr =       1.240737441566
   target nu stat err =       0.000406152597
   target dn stat err =       0.002380356535
      target stat err =       0.004088826419
              std dev =       0.515661001580
             le_variance =       0.265906268550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265917503278
                                         uncertainty =       0.002128123852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265917503278
                                         uncertainty =       0.002128123852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364627391
  error estimate for blocks of size 2^( 2) =       0.000378200420
  error estimate for blocks of size 2^( 3) =       0.000391051002
  error estimate for blocks of size 2^( 4) =       0.000400025491
  error estimate for blocks of size 2^( 5) =       0.000405494126
  error estimate for blocks of size 2^( 6) =       0.000408868794
  error estimate for blocks of size 2^( 7) =       0.000410221974

      target function =      -0.952353058222
              le_mean =     -17.211371917798
             les_mean =     296.506824480899
             stat err =       0.000406152597
             autocorr =       1.240737441555
   target nu stat err =       0.000406152597
   target dn stat err =       0.002380356534
      target stat err =       0.004088826417
              std dev =       0.515661001582
             le_variance =       0.265906268553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265917503281
                                         uncertainty =       0.002128123851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265917503281
                                         uncertainty =       0.002128123851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364627391
  error estimate for blocks of size 2^( 2) =       0.000378200420
  error estimate for blocks of size 2^( 3) =       0.000391051002
  error estimate for blocks of size 2^( 4) =       0.000400025491
  error estimate for blocks of size 2^( 5) =       0.000405494126
  error estimate for blocks of size 2^( 6) =       0.000408868794
  error estimate for blocks of size 2^( 7) =       0.000410221974

      target function =      -0.952353058155
              le_mean =     -17.211371917798
             les_mean =     296.506824480940
             stat err =       0.000406152597
             autocorr =       1.240737441544
   target nu stat err =       0.000406152597
   target dn stat err =       0.002380356533
      target stat err =       0.004088826415
              std dev =       0.515661001585
             le_variance =       0.265906268555


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.952353058146        initial
     2.3842e+06     2.3842e+07             5.1539e-11        -0.952353058297  <--
     9.5367e+06     9.5367e+07             1.2885e-11        -0.952353058222
     3.8147e+07     3.8147e+08             3.2212e-12        -0.952353058155

*****************************************************************************
Applying the update for shift_i =   2.3842e+06     and shift_s =   2.3842e+07
*****************************************************************************

  Execution time = 2.2815e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9142e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2189
    reference variance = 0.572213
====================================================
  Execution time = 1.4009e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7744e-01
  Total weights = 1.957219632e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5064e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267427439249
                                         uncertainty =       0.001436191647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267427439249
                                         uncertainty =       0.001436191647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365711462
  error estimate for blocks of size 2^( 2) =       0.000379484916
  error estimate for blocks of size 2^( 3) =       0.000392468128
  error estimate for blocks of size 2^( 4) =       0.000401915588
  error estimate for blocks of size 2^( 5) =       0.000407648398
  error estimate for blocks of size 2^( 6) =       0.000411466381
  error estimate for blocks of size 2^( 7) =       0.000415711949

      target function =      -0.949123376213
              le_mean =     -17.212141237515
             les_mean =     296.535242136918
             stat err =       0.000409185579
             autocorr =       1.251882286291
   target nu stat err =       0.000409185579
   target dn stat err =       0.001844283899
      target stat err =       0.003185268469
              std dev =       0.517194109847
             le_variance =       0.267489747261


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721214123752e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949133005609       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949133005646       residual = 9.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949133005655       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949133005656       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949133005656       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949133005656       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949133005656       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949133005417       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949133005656       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949133006403       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+05 is 2.642465e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949133005609       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949133005619       residual = 9.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949133005621       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949133005621       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949133005621       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949133005621       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949133005621       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949133005621       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949133005621       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949133005621       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+06 is 6.606166e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949133005609       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949133005612       residual = 9.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949133005612       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949133005612       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949133005612       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949133015974       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949133009129       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949133007165       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949133012491       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949133005612       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+06 is 1.651541e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149938 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6524e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245259e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676439e-03 3 1  ON 57
ci_059                -1.950460e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2498
    reference variance = 0.30623
====================================================
  Execution time = 1.3833e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8243e-01
  Total weights = 1.9574e+06
  Execution time = 1.8238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268693519044
                                         uncertainty =       0.002270860317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268693519044
                                         uncertainty =       0.002270860317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366487410
  error estimate for blocks of size 2^( 2) =       0.000380631942
  error estimate for blocks of size 2^( 3) =       0.000393010602
  error estimate for blocks of size 2^( 4) =       0.000402230952
  error estimate for blocks of size 2^( 5) =       0.000406990151
  error estimate for blocks of size 2^( 6) =       0.000409134679
  error estimate for blocks of size 2^( 7) =       0.000408515010

      target function =      -0.940739798303
              le_mean =     -17.212197242014
             les_mean =     296.542160222201
             stat err =       0.000406717698
             autocorr =       1.231595297224
   target nu stat err =       0.000406717698
   target dn stat err =       0.005093507452
      target stat err =       0.008447157200
              std dev =       0.518291465390
             le_variance =       0.268626043096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268693519071
                                         uncertainty =       0.002270860344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268693519071
                                         uncertainty =       0.002270860344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366487410
  error estimate for blocks of size 2^( 2) =       0.000380631942
  error estimate for blocks of size 2^( 3) =       0.000393010602
  error estimate for blocks of size 2^( 4) =       0.000402230952
  error estimate for blocks of size 2^( 5) =       0.000406990151
  error estimate for blocks of size 2^( 6) =       0.000409134679
  error estimate for blocks of size 2^( 7) =       0.000408515010

      target function =      -0.940739798030
              le_mean =     -17.212197242015
             les_mean =     296.542160222413
             stat err =       0.000406717698
             autocorr =       1.231595297231
   target nu stat err =       0.000406717698
   target dn stat err =       0.005093507537
      target stat err =       0.008447157335
              std dev =       0.518291465416
             le_variance =       0.268626043123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268693519058
                                         uncertainty =       0.002270860330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268693519058
                                         uncertainty =       0.002270860330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366487410
  error estimate for blocks of size 2^( 2) =       0.000380631942
  error estimate for blocks of size 2^( 3) =       0.000393010602
  error estimate for blocks of size 2^( 4) =       0.000402230952
  error estimate for blocks of size 2^( 5) =       0.000406990151
  error estimate for blocks of size 2^( 6) =       0.000409134679
  error estimate for blocks of size 2^( 7) =       0.000408515010

      target function =      -0.940739798166
              le_mean =     -17.212197242014
             les_mean =     296.542160222307
             stat err =       0.000406717698
             autocorr =       1.231595297229
   target nu stat err =       0.000406717698
   target dn stat err =       0.005093507495
      target stat err =       0.008447157268
              std dev =       0.518291465403
             le_variance =       0.268626043109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268693519046
                                         uncertainty =       0.002270860319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268693519046
                                         uncertainty =       0.002270860319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366487410
  error estimate for blocks of size 2^( 2) =       0.000380631942
  error estimate for blocks of size 2^( 3) =       0.000393010602
  error estimate for blocks of size 2^( 4) =       0.000402230952
  error estimate for blocks of size 2^( 5) =       0.000406990151
  error estimate for blocks of size 2^( 6) =       0.000409134679
  error estimate for blocks of size 2^( 7) =       0.000408515010

      target function =      -0.940739798286
              le_mean =     -17.212197242014
             les_mean =     296.542160222214
             stat err =       0.000406717698
             autocorr =       1.231595297224
   target nu stat err =       0.000406717698
   target dn stat err =       0.005093507457
      target stat err =       0.008447157208
              std dev =       0.518291465391
             le_variance =       0.268626043098


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940739798303        initial  <--
     5.9605e+05     5.9605e+06             2.6425e-10        -0.940739798030
     2.3842e+06     2.3842e+07             6.6062e-11        -0.940739798166
     9.5367e+06     9.5367e+07             1.6515e-11        -0.940739798286

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.6365
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3167e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1514
    reference variance = 0.296649
====================================================
  Execution time = 1.6048e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7410e-01
  Total weights = 1.957368244e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264489773165
                                         uncertainty =       0.001622266656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264489773165
                                         uncertainty =       0.001622266656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363679238
  error estimate for blocks of size 2^( 2) =       0.000378119278
  error estimate for blocks of size 2^( 3) =       0.000391060549
  error estimate for blocks of size 2^( 4) =       0.000400392885
  error estimate for blocks of size 2^( 5) =       0.000405952527
  error estimate for blocks of size 2^( 6) =       0.000408899824
  error estimate for blocks of size 2^( 7) =       0.000409705242

      target function =      -0.954763280009
              le_mean =     -17.212018592819
             les_mean =     296.527683424387
             stat err =       0.000406237619
             autocorr =       1.247737592423
   target nu stat err =       0.000406237619
   target dn stat err =       0.001843278345
      target stat err =       0.003218663087
              std dev =       0.514320110899
             le_variance =       0.264525176475


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721201859282e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.954773087653       residual = 8.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.954773087659       residual = 8.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.954773087659       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.954773087659       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.954773087664       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.954773089618       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.954773095708       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.954773095725       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.954773067959       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.954773095847       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+06 is 1.990914e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.954773087653       residual = 8.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.954773087654       residual = 8.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.954773087654       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.954773087654       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.954773087955       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.954773076715       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.954773123822       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.954773057926       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.954773062997       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.954773071935       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+07 is 4.977279e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.954773087653       residual = 8.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.954773087653       residual = 8.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.954773087653       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.954773087654       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.954773122489       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.954773203428       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.954772989013       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.954773023162       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.954773034967       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.954773104865       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+07 is 1.244324e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153490 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8705e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.266
    reference variance = 0.238758
====================================================
  Execution time = 1.3568e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8277e-01
  Total weights = 1.9573e+06
  Execution time = 1.8520e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268747972542
                                         uncertainty =       0.001614910170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268747972542
                                         uncertainty =       0.001614910170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366561301
  error estimate for blocks of size 2^( 2) =       0.000380533366
  error estimate for blocks of size 2^( 3) =       0.000393721821
  error estimate for blocks of size 2^( 4) =       0.000402879317
  error estimate for blocks of size 2^( 5) =       0.000408638922
  error estimate for blocks of size 2^( 6) =       0.000411374821
  error estimate for blocks of size 2^( 7) =       0.000413455205

      target function =      -0.940225576800
              le_mean =     -17.211878145677
             les_mean =     296.531517459088
             stat err =       0.000409087066
             autocorr =       1.245484341165
   target nu stat err =       0.000409087066
   target dn stat err =       0.002703031863
      target stat err =       0.004516289659
              std dev =       0.518395963246
             le_variance =       0.268734374710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268747972541
                                         uncertainty =       0.001614910170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268747972541
                                         uncertainty =       0.001614910170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366561301
  error estimate for blocks of size 2^( 2) =       0.000380533366
  error estimate for blocks of size 2^( 3) =       0.000393721821
  error estimate for blocks of size 2^( 4) =       0.000402879317
  error estimate for blocks of size 2^( 5) =       0.000408638922
  error estimate for blocks of size 2^( 6) =       0.000411374821
  error estimate for blocks of size 2^( 7) =       0.000413455205

      target function =      -0.940225576789
              le_mean =     -17.211878145677
             les_mean =     296.531517459093
             stat err =       0.000409087066
             autocorr =       1.245484341160
   target nu stat err =       0.000409087066
   target dn stat err =       0.002703031862
      target stat err =       0.004516289657
              std dev =       0.518395963245
             le_variance =       0.268734374709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268747972541
                                         uncertainty =       0.001614910170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268747972541
                                         uncertainty =       0.001614910170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366561301
  error estimate for blocks of size 2^( 2) =       0.000380533366
  error estimate for blocks of size 2^( 3) =       0.000393721821
  error estimate for blocks of size 2^( 4) =       0.000402879317
  error estimate for blocks of size 2^( 5) =       0.000408638922
  error estimate for blocks of size 2^( 6) =       0.000411374821
  error estimate for blocks of size 2^( 7) =       0.000413455205

      target function =      -0.940225576795
              le_mean =     -17.211878145677
             les_mean =     296.531517459091
             stat err =       0.000409087066
             autocorr =       1.245484341146
   target nu stat err =       0.000409087066
   target dn stat err =       0.002703031863
      target stat err =       0.004516289658
              std dev =       0.518395963246
             le_variance =       0.268734374709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268747972542
                                         uncertainty =       0.001614910170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268747972542
                                         uncertainty =       0.001614910170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366561301
  error estimate for blocks of size 2^( 2) =       0.000380533366
  error estimate for blocks of size 2^( 3) =       0.000393721821
  error estimate for blocks of size 2^( 4) =       0.000402879317
  error estimate for blocks of size 2^( 5) =       0.000408638922
  error estimate for blocks of size 2^( 6) =       0.000411374821
  error estimate for blocks of size 2^( 7) =       0.000413455205

      target function =      -0.940225576800
              le_mean =     -17.211878145677
             les_mean =     296.531517459088
             stat err =       0.000409087066
             autocorr =       1.245484341162
   target nu stat err =       0.000409087066
   target dn stat err =       0.002703031863
      target stat err =       0.004516289659
              std dev =       0.518395963246
             le_variance =       0.268734374710


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940225576800        initial  <--
     5.9605e+06     5.9605e+07             1.9909e-11        -0.940225576789
     2.3842e+07     2.3842e+08             4.9773e-12        -0.940225576795
     9.5367e+07     9.5367e+08             1.2443e-12        -0.940225576800

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8960
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1607e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.215
    reference variance = 0.189665
====================================================
  Execution time = 1.3769e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8334e-01
  Total weights = 1.957361082e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269012998404
                                         uncertainty =       0.002653342205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269012998404
                                         uncertainty =       0.002653342205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366795809
  error estimate for blocks of size 2^( 2) =       0.000380530002
  error estimate for blocks of size 2^( 3) =       0.000392893288
  error estimate for blocks of size 2^( 4) =       0.000401639822
  error estimate for blocks of size 2^( 5) =       0.000407565083
  error estimate for blocks of size 2^( 6) =       0.000411793166
  error estimate for blocks of size 2^( 7) =       0.000411335196

      target function =      -0.939250275220
              le_mean =     -17.211471995177
             les_mean =     296.518109196006
             stat err =       0.000408083317
             autocorr =       1.237795647514
   target nu stat err =       0.000408083317
   target dn stat err =       0.004035712106
      target stat err =       0.006676981899
              std dev =       0.518727607724
             le_variance =       0.269078331015


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721147199518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939297133675       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939297133676       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939297133676       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939297103897       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939297116386       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939296922638       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939297172083       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939297194506       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939297148038       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939297062702       residual = 6.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+07 is 4.139477e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939297133675       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939297133675       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939297133675       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939297133675       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939297133706       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939296951067       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939296880132       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939296945519       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939297454632       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939296694463       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+08 is 1.034920e-12

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939297133675       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939297133675       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939297133675       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939296874032       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939297133410       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939297100573       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939297224240       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939296832939       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939297116433       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939296180805       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+08 is 2.587034e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157031 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6247e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1512
    reference variance = 0.210208
====================================================
  Execution time = 1.3415e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7899e-01
  Total weights = 1.9574e+06
  Execution time = 1.8653e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268944061415
                                         uncertainty =       0.001382752848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268944061415
                                         uncertainty =       0.001382752848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366716966
  error estimate for blocks of size 2^( 2) =       0.000380605075
  error estimate for blocks of size 2^( 3) =       0.000393191270
  error estimate for blocks of size 2^( 4) =       0.000402238936
  error estimate for blocks of size 2^( 5) =       0.000408579497
  error estimate for blocks of size 2^( 6) =       0.000410527954
  error estimate for blocks of size 2^( 7) =       0.000411307223

      target function =      -0.946500070343
              le_mean =     -17.211742705951
             les_mean =     296.523081352461
             stat err =       0.000408163403
             autocorr =       1.238814038168
   target nu stat err =       0.000408163403
   target dn stat err =       0.001834634758
      target stat err =       0.003149672926
              std dev =       0.518616106675
             le_variance =       0.268962666103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268944061415
                                         uncertainty =       0.001382752848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268944061415
                                         uncertainty =       0.001382752848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366716966
  error estimate for blocks of size 2^( 2) =       0.000380605075
  error estimate for blocks of size 2^( 3) =       0.000393191270
  error estimate for blocks of size 2^( 4) =       0.000402238936
  error estimate for blocks of size 2^( 5) =       0.000408579497
  error estimate for blocks of size 2^( 6) =       0.000410527954
  error estimate for blocks of size 2^( 7) =       0.000411307223

      target function =      -0.946500070355
              le_mean =     -17.211742705951
             les_mean =     296.523081352452
             stat err =       0.000408163403
             autocorr =       1.238814038166
   target nu stat err =       0.000408163403
   target dn stat err =       0.001834634758
      target stat err =       0.003149672926
              std dev =       0.518616106675
             le_variance =       0.268962666103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268944061415
                                         uncertainty =       0.001382752848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268944061415
                                         uncertainty =       0.001382752848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366716966
  error estimate for blocks of size 2^( 2) =       0.000380605075
  error estimate for blocks of size 2^( 3) =       0.000393191270
  error estimate for blocks of size 2^( 4) =       0.000402238936
  error estimate for blocks of size 2^( 5) =       0.000408579497
  error estimate for blocks of size 2^( 6) =       0.000410527954
  error estimate for blocks of size 2^( 7) =       0.000411307223

      target function =      -0.946500070349
              le_mean =     -17.211742705951
             les_mean =     296.523081352456
             stat err =       0.000408163403
             autocorr =       1.238814038160
   target nu stat err =       0.000408163403
   target dn stat err =       0.001834634758
      target stat err =       0.003149672926
              std dev =       0.518616106675
             le_variance =       0.268962666103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268944061415
                                         uncertainty =       0.001382752848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268944061415
                                         uncertainty =       0.001382752848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366716966
  error estimate for blocks of size 2^( 2) =       0.000380605075
  error estimate for blocks of size 2^( 3) =       0.000393191270
  error estimate for blocks of size 2^( 4) =       0.000402238936
  error estimate for blocks of size 2^( 5) =       0.000408579497
  error estimate for blocks of size 2^( 6) =       0.000410527954
  error estimate for blocks of size 2^( 7) =       0.000411307223

      target function =      -0.946500070343
              le_mean =     -17.211742705951
             les_mean =     296.523081352460
             stat err =       0.000408163403
             autocorr =       1.238814038163
   target nu stat err =       0.000408163403
   target dn stat err =       0.001834634758
      target stat err =       0.003149672926
              std dev =       0.518616106675
             le_variance =       0.268962666103


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946500070343        initial
     5.9605e+07     5.9605e+08             4.1395e-12        -0.946500070355  <--
     2.3842e+08     2.3842e+09             1.0349e-12        -0.946500070349
     9.5367e+08     9.5367e+09             2.5870e-13        -0.946500070343

*****************************************************************************
Applying the update for shift_i =   5.9605e+07     and shift_s =   5.9605e+08
*****************************************************************************

  Execution time = 2.2918e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9171e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1933
    reference variance = 0.228475
====================================================
  Execution time = 1.3845e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8069e-01
  Total weights = 1.957228077e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268885027662
                                         uncertainty =       0.001876986162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268885027662
                                         uncertainty =       0.001876986162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366680374
  error estimate for blocks of size 2^( 2) =       0.000380245017
  error estimate for blocks of size 2^( 3) =       0.000393183226
  error estimate for blocks of size 2^( 4) =       0.000402581699
  error estimate for blocks of size 2^( 5) =       0.000407918837
  error estimate for blocks of size 2^( 6) =       0.000410804992
  error estimate for blocks of size 2^( 7) =       0.000411105122

      target function =      -0.943669603841
              le_mean =     -17.211796928848
             les_mean =     296.526641434271
             stat err =       0.000408102663
             autocorr =       1.238692550058
   target nu stat err =       0.000408102663
   target dn stat err =       0.002585747434
      target stat err =       0.004355741450
              std dev =       0.518564357756
             le_variance =       0.268908993135


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721179692885e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943688724129       residual = 3.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943688724136       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943688724137       residual = 9.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943688723159       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943688730090       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943688727394       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943688754324       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943688724138       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943688724138       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943688724138       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943688716238       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+07 is 1.524574e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943688724129       residual = 3.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943688724131       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943688724131       residual = 9.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943688724131       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943688724131       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943688724131       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943688724131       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943688724131       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943688724131       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943688724131       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943688724131       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+07 is 3.811435e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943688724129       residual = 3.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943688724129       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943688724129       residual = 9.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943688724129       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943688724129       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943688724129       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943688724129       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943688724129       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943688724129       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943688724129       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943688724129       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+08 is 9.528600e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161127 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6323e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1885
    reference variance = 0.293299
====================================================
  Execution time = 1.3499e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8132e-01
  Total weights = 1.9575e+06
  Execution time = 1.8573e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267269613766
                                         uncertainty =       0.001415112960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267269613766
                                         uncertainty =       0.001415112960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365560110
  error estimate for blocks of size 2^( 2) =       0.000379500879
  error estimate for blocks of size 2^( 3) =       0.000392116391
  error estimate for blocks of size 2^( 4) =       0.000401053093
  error estimate for blocks of size 2^( 5) =       0.000406971560
  error estimate for blocks of size 2^( 6) =       0.000409536850
  error estimate for blocks of size 2^( 7) =       0.000412315785

      target function =      -0.942604817133
              le_mean =     -17.212154233260
             les_mean =     296.539570093081
             stat err =       0.000407469322
             autocorr =       1.242430873796
   target nu stat err =       0.000407469322
   target dn stat err =       0.004020959390
      target stat err =       0.006708601570
              std dev =       0.516980065016
             le_variance =       0.267268387624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267269613765
                                         uncertainty =       0.001415112960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267269613765
                                         uncertainty =       0.001415112960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365560110
  error estimate for blocks of size 2^( 2) =       0.000379500879
  error estimate for blocks of size 2^( 3) =       0.000392116391
  error estimate for blocks of size 2^( 4) =       0.000401053093
  error estimate for blocks of size 2^( 5) =       0.000406971560
  error estimate for blocks of size 2^( 6) =       0.000409536850
  error estimate for blocks of size 2^( 7) =       0.000412315785

      target function =      -0.942604817166
              le_mean =     -17.212154233260
             les_mean =     296.539570093060
             stat err =       0.000407469322
             autocorr =       1.242430873816
   target nu stat err =       0.000407469322
   target dn stat err =       0.004020959388
      target stat err =       0.006708601567
              std dev =       0.516980065015
             le_variance =       0.267268387623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267269613765
                                         uncertainty =       0.001415112960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267269613765
                                         uncertainty =       0.001415112960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365560110
  error estimate for blocks of size 2^( 2) =       0.000379500879
  error estimate for blocks of size 2^( 3) =       0.000392116391
  error estimate for blocks of size 2^( 4) =       0.000401053093
  error estimate for blocks of size 2^( 5) =       0.000406971560
  error estimate for blocks of size 2^( 6) =       0.000409536850
  error estimate for blocks of size 2^( 7) =       0.000412315785

      target function =      -0.942604817149
              le_mean =     -17.212154233260
             les_mean =     296.539570093070
             stat err =       0.000407469322
             autocorr =       1.242430873807
   target nu stat err =       0.000407469322
   target dn stat err =       0.004020959389
      target stat err =       0.006708601569
              std dev =       0.516980065015
             le_variance =       0.267268387623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267269613766
                                         uncertainty =       0.001415112960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267269613766
                                         uncertainty =       0.001415112960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365560110
  error estimate for blocks of size 2^( 2) =       0.000379500879
  error estimate for blocks of size 2^( 3) =       0.000392116391
  error estimate for blocks of size 2^( 4) =       0.000401053093
  error estimate for blocks of size 2^( 5) =       0.000406971560
  error estimate for blocks of size 2^( 6) =       0.000409536850
  error estimate for blocks of size 2^( 7) =       0.000412315785

      target function =      -0.942604817135
              le_mean =     -17.212154233260
             les_mean =     296.539570093079
             stat err =       0.000407469322
             autocorr =       1.242430873799
   target nu stat err =       0.000407469322
   target dn stat err =       0.004020959390
      target stat err =       0.006708601570
              std dev =       0.516980065016
             le_variance =       0.267268387624


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942604817133        initial
     1.4901e+07     1.4901e+08             1.5246e-11        -0.942604817166  <--
     5.9605e+07     5.9605e+08             3.8114e-12        -0.942604817149
     2.3842e+08     2.3842e+09             9.5286e-13        -0.942604817135

*****************************************************************************
Applying the update for shift_i =   1.4901e+07     and shift_s =   1.4901e+08
*****************************************************************************

  Execution time = 2.2885e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9214e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1963
    reference variance = 0.304837
====================================================
  Execution time = 1.4080e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7864e-01
  Total weights = 1.957452363e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267025838998
                                         uncertainty =       0.001409748197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267025838998
                                         uncertainty =       0.001409748197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365467657
  error estimate for blocks of size 2^( 2) =       0.000379322937
  error estimate for blocks of size 2^( 3) =       0.000392213030
  error estimate for blocks of size 2^( 4) =       0.000401537496
  error estimate for blocks of size 2^( 5) =       0.000407531195
  error estimate for blocks of size 2^( 6) =       0.000410020364
  error estimate for blocks of size 2^( 7) =       0.000411812961

      target function =      -0.947092457335
              le_mean =     -17.211900207622
             les_mean =     296.528149719738
             stat err =       0.000407725504
             autocorr =       1.244623106830
   target nu stat err =       0.000407725504
   target dn stat err =       0.002083000303
      target stat err =       0.003560267637
              std dev =       0.516849316607
             le_variance =       0.267133216077


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721190020762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947104761716       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947104761722       residual = 7.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947104761723       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947104761440       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947104761724       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947104766114       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947104761634       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947104761724       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947104759933       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947104759684       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+06 is 3.086611e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947104761716       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947104761717       residual = 7.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947104761718       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947104761718       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947104763803       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947104742679       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947104761718       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947104761718       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947104761718       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947104746877       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+07 is 7.716573e-12

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947104761716       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947104761716       residual = 7.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947104761716       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947104761716       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947104761716       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947104825367       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947104823014       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947104786862       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947104761716       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947104648699       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+07 is 1.929179e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164601 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6613e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2054
    reference variance = 0.19724
====================================================
  Execution time = 1.3760e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7937e-01
  Total weights = 1.9575e+06
  Execution time = 1.8514e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268040033054
                                         uncertainty =       0.001596519219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268040033054
                                         uncertainty =       0.001596519219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366074754
  error estimate for blocks of size 2^( 2) =       0.000379889487
  error estimate for blocks of size 2^( 3) =       0.000392669937
  error estimate for blocks of size 2^( 4) =       0.000402647547
  error estimate for blocks of size 2^( 5) =       0.000408199800
  error estimate for blocks of size 2^( 6) =       0.000410405748
  error estimate for blocks of size 2^( 7) =       0.000410588847

      target function =      -0.945906902300
              le_mean =     -17.213161903193
             les_mean =     296.572308156533
             stat err =       0.000407960485
             autocorr =       1.241928633367
   target nu stat err =       0.000407960485
   target dn stat err =       0.002285049116
      target stat err =       0.003891744017
              std dev =       0.517707882569
             le_variance =       0.268021451674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268040033057
                                         uncertainty =       0.001596519219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268040033057
                                         uncertainty =       0.001596519219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366074754
  error estimate for blocks of size 2^( 2) =       0.000379889487
  error estimate for blocks of size 2^( 3) =       0.000392669937
  error estimate for blocks of size 2^( 4) =       0.000402647547
  error estimate for blocks of size 2^( 5) =       0.000408199800
  error estimate for blocks of size 2^( 6) =       0.000410405748
  error estimate for blocks of size 2^( 7) =       0.000410588847

      target function =      -0.945906902296
              le_mean =     -17.213161903194
             les_mean =     296.572308156542
             stat err =       0.000407960485
             autocorr =       1.241928633366
   target nu stat err =       0.000407960485
   target dn stat err =       0.002285049115
      target stat err =       0.003891744016
              std dev =       0.517707882572
             le_variance =       0.268021451677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268040033055
                                         uncertainty =       0.001596519219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268040033055
                                         uncertainty =       0.001596519219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366074754
  error estimate for blocks of size 2^( 2) =       0.000379889487
  error estimate for blocks of size 2^( 3) =       0.000392669937
  error estimate for blocks of size 2^( 4) =       0.000402647547
  error estimate for blocks of size 2^( 5) =       0.000408199800
  error estimate for blocks of size 2^( 6) =       0.000410405748
  error estimate for blocks of size 2^( 7) =       0.000410588847

      target function =      -0.945906902298
              le_mean =     -17.213161903194
             les_mean =     296.572308156537
             stat err =       0.000407960485
             autocorr =       1.241928633364
   target nu stat err =       0.000407960485
   target dn stat err =       0.002285049115
      target stat err =       0.003891744016
              std dev =       0.517707882570
             le_variance =       0.268021451675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268040033054
                                         uncertainty =       0.001596519219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268040033054
                                         uncertainty =       0.001596519219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366074754
  error estimate for blocks of size 2^( 2) =       0.000379889487
  error estimate for blocks of size 2^( 3) =       0.000392669937
  error estimate for blocks of size 2^( 4) =       0.000402647547
  error estimate for blocks of size 2^( 5) =       0.000408199800
  error estimate for blocks of size 2^( 6) =       0.000410405748
  error estimate for blocks of size 2^( 7) =       0.000410588847

      target function =      -0.945906902300
              le_mean =     -17.213161903193
             les_mean =     296.572308156533
             stat err =       0.000407960485
             autocorr =       1.241928633371
   target nu stat err =       0.000407960485
   target dn stat err =       0.002285049116
      target stat err =       0.003891744017
              std dev =       0.517707882569
             le_variance =       0.268021451674


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945906902300        initial  <--
     3.7253e+06     3.7253e+07             3.0866e-11        -0.945906902296
     1.4901e+07     1.4901e+08             7.7166e-12        -0.945906902298
     5.9605e+07     5.9605e+08             1.9292e-12        -0.945906902300

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1121
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9731e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1497
    reference variance = 0.177352
====================================================
  Execution time = 1.4049e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8096e-01
  Total weights = 1.957452736e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268208962357
                                         uncertainty =       0.001773092499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268208962357
                                         uncertainty =       0.001773092499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366190166
  error estimate for blocks of size 2^( 2) =       0.000380362584
  error estimate for blocks of size 2^( 3) =       0.000393258565
  error estimate for blocks of size 2^( 4) =       0.000402919323
  error estimate for blocks of size 2^( 5) =       0.000408551452
  error estimate for blocks of size 2^( 6) =       0.000410942343
  error estimate for blocks of size 2^( 7) =       0.000413819102

      target function =      -0.943210787065
              le_mean =     -17.211767467114
             les_mean =     296.525898261091
             stat err =       0.000409058055
             autocorr =       1.247833220769
   target nu stat err =       0.000409058055
   target dn stat err =       0.003077523554
      target stat err =       0.005158389858
              std dev =       0.517871098895
             le_variance =       0.268190475071


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721176746711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943238090578       residual = 2.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943238090580       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943238090581       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943238090581       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943238109076       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943238111290       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943238090581       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943238069540       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943238121749       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943238206750       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+07 is 5.919502e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943238090578       residual = 2.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943238090578       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943238090578       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943238090578       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943238090578       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943238104776       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943238090578       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943237688390       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943238090578       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943238286304       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+08 is 1.479864e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943238090578       residual = 2.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943238090578       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943238090578       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943237702025       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943238124686       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943238393628       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943238122820       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943238663577       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943239835535       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943238922239       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+08 is 3.699795e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168043 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6528e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.232
    reference variance = 0.182908
====================================================
  Execution time = 1.3602e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7862e-01
  Total weights = 1.9572e+06
  Execution time = 1.8633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266867776851
                                         uncertainty =       0.001331630549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266867776851
                                         uncertainty =       0.001331630549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365292133
  error estimate for blocks of size 2^( 2) =       0.000379352809
  error estimate for blocks of size 2^( 3) =       0.000392417721
  error estimate for blocks of size 2^( 4) =       0.000401769721
  error estimate for blocks of size 2^( 5) =       0.000407318946
  error estimate for blocks of size 2^( 6) =       0.000411052214
  error estimate for blocks of size 2^( 7) =       0.000413836232

      target function =      -0.947134379178
              le_mean =     -17.211828627131
             les_mean =     296.525660268228
             stat err =       0.000408494278
             autocorr =       1.250521945939
   target nu stat err =       0.000408494278
   target dn stat err =       0.001961678323
      target stat err =       0.003361778129
              std dev =       0.516601088361
             le_variance =       0.266876684495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266867776851
                                         uncertainty =       0.001331630549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266867776851
                                         uncertainty =       0.001331630549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365292133
  error estimate for blocks of size 2^( 2) =       0.000379352809
  error estimate for blocks of size 2^( 3) =       0.000392417721
  error estimate for blocks of size 2^( 4) =       0.000401769721
  error estimate for blocks of size 2^( 5) =       0.000407318946
  error estimate for blocks of size 2^( 6) =       0.000411052214
  error estimate for blocks of size 2^( 7) =       0.000413836232

      target function =      -0.947134379176
              le_mean =     -17.211828627131
             les_mean =     296.525660268232
             stat err =       0.000408494278
             autocorr =       1.250521945938
   target nu stat err =       0.000408494278
   target dn stat err =       0.001961678323
      target stat err =       0.003361778130
              std dev =       0.516601088360
             le_variance =       0.266876684495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266867776851
                                         uncertainty =       0.001331630549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266867776851
                                         uncertainty =       0.001331630549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365292133
  error estimate for blocks of size 2^( 2) =       0.000379352809
  error estimate for blocks of size 2^( 3) =       0.000392417721
  error estimate for blocks of size 2^( 4) =       0.000401769721
  error estimate for blocks of size 2^( 5) =       0.000407318946
  error estimate for blocks of size 2^( 6) =       0.000411052214
  error estimate for blocks of size 2^( 7) =       0.000413836232

      target function =      -0.947134379177
              le_mean =     -17.211828627131
             les_mean =     296.525660268230
             stat err =       0.000408494278
             autocorr =       1.250521945929
   target nu stat err =       0.000408494278
   target dn stat err =       0.001961678323
      target stat err =       0.003361778130
              std dev =       0.516601088360
             le_variance =       0.266876684495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266867776851
                                         uncertainty =       0.001331630549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266867776851
                                         uncertainty =       0.001331630549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365292133
  error estimate for blocks of size 2^( 2) =       0.000379352809
  error estimate for blocks of size 2^( 3) =       0.000392417721
  error estimate for blocks of size 2^( 4) =       0.000401769721
  error estimate for blocks of size 2^( 5) =       0.000407318946
  error estimate for blocks of size 2^( 6) =       0.000411052214
  error estimate for blocks of size 2^( 7) =       0.000413836232

      target function =      -0.947134379178
              le_mean =     -17.211828627131
             les_mean =     296.525660268228
             stat err =       0.000408494278
             autocorr =       1.250521945936
   target nu stat err =       0.000408494278
   target dn stat err =       0.001961678323
      target stat err =       0.003361778129
              std dev =       0.516601088361
             le_variance =       0.266876684495


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947134379178        initial  <--
     3.7253e+07     3.7253e+08             5.9195e-12        -0.947134379176
     1.4901e+08     1.4901e+09             1.4799e-12        -0.947134379177
     5.9605e+08     5.9605e+09             3.6998e-13        -0.947134379178

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9906
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9525e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2855
    reference variance = 0.324271
====================================================
  Execution time = 1.4286e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5319e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8182e-01
  Total weights = 1.957203632e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270268295495
                                         uncertainty =       0.001842426259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270268295495
                                         uncertainty =       0.001842426259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367608972
  error estimate for blocks of size 2^( 2) =       0.000381775396
  error estimate for blocks of size 2^( 3) =       0.000394105863
  error estimate for blocks of size 2^( 4) =       0.000403562153
  error estimate for blocks of size 2^( 5) =       0.000409567661
  error estimate for blocks of size 2^( 6) =       0.000411733077
  error estimate for blocks of size 2^( 7) =       0.000414916398

      target function =      -0.941796595298
              le_mean =     -17.212186291648
             les_mean =     296.541178195337
             stat err =       0.000409944822
             autocorr =       1.243593962625
   target nu stat err =       0.000409944822
   target dn stat err =       0.002588135962
      target stat err =       0.004346294690
              std dev =       0.519877594500
             le_variance =       0.270272713263


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721218629165e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941815784160       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941815784160       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941815784160       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941815784160       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941815784427       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941815949651       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941816643346       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941815801996       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941816194236       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941815061840       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+08 is 5.353170e-13

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941815784160       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941815784160       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941815784160       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941815784160       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941815228227       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941815273917       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941814839906       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941814586869       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941817541745       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941814288171       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+09 is 1.338116e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941815784160       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941815784160       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941815784160       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941816298482       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941815784633       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941815517046       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941819981180       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941820923115       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941818618176       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941811247109       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941821864197       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941815936273       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941810491028       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+09 is 3.342276e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6833e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2101
    reference variance = 0.174924
====================================================
  Execution time = 1.3392e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8099e-01
  Total weights = 1.9571e+06
  Execution time = 1.8520e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269643395060
                                         uncertainty =       0.002598382356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269643395060
                                         uncertainty =       0.002598382356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367176655
  error estimate for blocks of size 2^( 2) =       0.000380947740
  error estimate for blocks of size 2^( 3) =       0.000393295079
  error estimate for blocks of size 2^( 4) =       0.000402568919
  error estimate for blocks of size 2^( 5) =       0.000408903440
  error estimate for blocks of size 2^( 6) =       0.000411724661
  error estimate for blocks of size 2^( 7) =       0.000412515594

      target function =      -0.943158155983
              le_mean =     -17.212237638697
             les_mean =     296.542115862209
             stat err =       0.000408928154
             autocorr =       1.240349003395
   target nu stat err =       0.000408928154
   target dn stat err =       0.003496114810
      target stat err =       0.005851657995
              std dev =       0.519266204642
             le_variance =       0.269637391283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269643395060
                                         uncertainty =       0.002598382356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269643395060
                                         uncertainty =       0.002598382356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367176655
  error estimate for blocks of size 2^( 2) =       0.000380947740
  error estimate for blocks of size 2^( 3) =       0.000393295079
  error estimate for blocks of size 2^( 4) =       0.000402568919
  error estimate for blocks of size 2^( 5) =       0.000408903440
  error estimate for blocks of size 2^( 6) =       0.000411724661
  error estimate for blocks of size 2^( 7) =       0.000412515594

      target function =      -0.943158155976
              le_mean =     -17.212237638697
             les_mean =     296.542115862214
             stat err =       0.000408928154
             autocorr =       1.240349003393
   target nu stat err =       0.000408928154
   target dn stat err =       0.003496114810
      target stat err =       0.005851657995
              std dev =       0.519266204642
             le_variance =       0.269637391283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269643395060
                                         uncertainty =       0.002598382356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269643395060
                                         uncertainty =       0.002598382356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367176655
  error estimate for blocks of size 2^( 2) =       0.000380947740
  error estimate for blocks of size 2^( 3) =       0.000393295079
  error estimate for blocks of size 2^( 4) =       0.000402568919
  error estimate for blocks of size 2^( 5) =       0.000408903440
  error estimate for blocks of size 2^( 6) =       0.000411724661
  error estimate for blocks of size 2^( 7) =       0.000412515594

      target function =      -0.943158155979
              le_mean =     -17.212237638697
             les_mean =     296.542115862212
             stat err =       0.000408928154
             autocorr =       1.240349003392
   target nu stat err =       0.000408928154
   target dn stat err =       0.003496114810
      target stat err =       0.005851657995
              std dev =       0.519266204642
             le_variance =       0.269637391283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269643395060
                                         uncertainty =       0.002598382356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269643395060
                                         uncertainty =       0.002598382356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367176655
  error estimate for blocks of size 2^( 2) =       0.000380947740
  error estimate for blocks of size 2^( 3) =       0.000393295079
  error estimate for blocks of size 2^( 4) =       0.000402568919
  error estimate for blocks of size 2^( 5) =       0.000408903440
  error estimate for blocks of size 2^( 6) =       0.000411724661
  error estimate for blocks of size 2^( 7) =       0.000412515594

      target function =      -0.943158155982
              le_mean =     -17.212237638697
             les_mean =     296.542115862210
             stat err =       0.000408928154
             autocorr =       1.240349003393
   target nu stat err =       0.000408928154
   target dn stat err =       0.003496114810
      target stat err =       0.005851657995
              std dev =       0.519266204642
             le_variance =       0.269637391284


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943158155983        initial  <--
     3.7253e+08     3.7253e+09             5.3532e-13        -0.943158155976
     1.4901e+09     1.4901e+10             1.3381e-13        -0.943158155979
     5.9605e+09     5.9605e+10             3.3423e-14        -0.943158155982

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7737
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9630e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2196
    reference variance = 0.213427
====================================================
  Execution time = 1.4614e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7760e-01
  Total weights = 1.957343897e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266496757867
                                         uncertainty =       0.001358332241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266496757867
                                         uncertainty =       0.001358332241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364995734
  error estimate for blocks of size 2^( 2) =       0.000378697061
  error estimate for blocks of size 2^( 3) =       0.000391655390
  error estimate for blocks of size 2^( 4) =       0.000401109471
  error estimate for blocks of size 2^( 5) =       0.000406658051
  error estimate for blocks of size 2^( 6) =       0.000409668019
  error estimate for blocks of size 2^( 7) =       0.000412154787

      target function =      -0.948839461602
              le_mean =     -17.212144151766
             les_mean =     296.535510610833
             stat err =       0.000407397582
             autocorr =       1.245837262403
   target nu stat err =       0.000407397582
   target dn stat err =       0.001958101986
      target stat err =       0.003369313207
              std dev =       0.516181917749
             le_variance =       0.266443772211


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721214415177e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948850377272       residual = 6.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948850377272       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948850377272       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948850157939       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948850377272       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948850377272       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948850377272       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948849557889       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948843706042       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948855341830       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948850377272       residual = 5.25e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+09 is 2.479810e-14

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948850377272       residual = 6.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948850377272       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948850377272       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948852205492       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948850377272       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948869923280       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948850377272       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948850377272       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948850377272       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948857619506       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948874009967       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948845110631       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948849893350       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948863217361       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948868032190       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948850205665       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948850020148       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948846515825       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948854553342       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948851668532       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948853003675       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948848944849       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948854207269       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948846712350       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+10 is 6.198530e-15

solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948850377272       residual = 6.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948850377272       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948850377272       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948850377272       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948854168421       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948850377272       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948850377272       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948860189764       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948850377272       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948850377272       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948850377272       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948698068856       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948806891380       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948687106016       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948960748037       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948842984818       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948961320970       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948849264070       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948881373533       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948843232881       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948861943650       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948919636268       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948840988136       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948841238165       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948811555360       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.948868067788       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.948820143492       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.948863651368       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.948845407102       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.948840399615       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.948828404042       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.948902864886       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.948874831361       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.948849959059       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.948846818980       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.948846476384       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.948846314803       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.948839580039       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.948873092065       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.948846936258       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.948856985294       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.948870813777       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.948843942195       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.948809564286       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.948800464916       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.948883528200       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.948826816946       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.948982281366       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.948736707250       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.948789498025       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.948851476096       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.948859726230       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.948875494915       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.948856288932       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.948846729912       residual = 4.48e-06           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.948930857961       residual = 1.69e-05           smallest_sin_value = 9.95e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+10 is 1.553072e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256204 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7203e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1567
    reference variance = 0.183623
====================================================
  Execution time = 1.4472e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8071e-01
  Total weights = 1.9569e+06
  Execution time = 1.8507e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268893938664
                                         uncertainty =       0.001601413479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268893938664
                                         uncertainty =       0.001601413479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366646691
  error estimate for blocks of size 2^( 2) =       0.000380544117
  error estimate for blocks of size 2^( 3) =       0.000393347785
  error estimate for blocks of size 2^( 4) =       0.000402712295
  error estimate for blocks of size 2^( 5) =       0.000408287192
  error estimate for blocks of size 2^( 6) =       0.000411865038
  error estimate for blocks of size 2^( 7) =       0.000415926024

      target function =      -0.943632168042
              le_mean =     -17.211706600645
             les_mean =     296.523553001470
             stat err =       0.000409697637
             autocorr =       1.248623139631
   target nu stat err =       0.000409697637
   target dn stat err =       0.002639503202
      target stat err =       0.004443216013
              std dev =       0.518516722832
             le_variance =       0.268859591857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268893938664
                                         uncertainty =       0.001601413479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268893938664
                                         uncertainty =       0.001601413479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366646691
  error estimate for blocks of size 2^( 2) =       0.000380544117
  error estimate for blocks of size 2^( 3) =       0.000393347785
  error estimate for blocks of size 2^( 4) =       0.000402712295
  error estimate for blocks of size 2^( 5) =       0.000408287192
  error estimate for blocks of size 2^( 6) =       0.000411865038
  error estimate for blocks of size 2^( 7) =       0.000415926024

      target function =      -0.943632168042
              le_mean =     -17.211706600645
             les_mean =     296.523553001470
             stat err =       0.000409697637
             autocorr =       1.248623139634
   target nu stat err =       0.000409697637
   target dn stat err =       0.002639503202
      target stat err =       0.004443216013
              std dev =       0.518516722832
             le_variance =       0.268859591857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268893938664
                                         uncertainty =       0.001601413479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268893938664
                                         uncertainty =       0.001601413479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366646691
  error estimate for blocks of size 2^( 2) =       0.000380544117
  error estimate for blocks of size 2^( 3) =       0.000393347785
  error estimate for blocks of size 2^( 4) =       0.000402712295
  error estimate for blocks of size 2^( 5) =       0.000408287192
  error estimate for blocks of size 2^( 6) =       0.000411865038
  error estimate for blocks of size 2^( 7) =       0.000415926024

      target function =      -0.943632168042
              le_mean =     -17.211706600645
             les_mean =     296.523553001470
             stat err =       0.000409697637
             autocorr =       1.248623139631
   target nu stat err =       0.000409697637
   target dn stat err =       0.002639503202
      target stat err =       0.004443216013
              std dev =       0.518516722832
             le_variance =       0.268859591857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268893938664
                                         uncertainty =       0.001601413479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268893938664
                                         uncertainty =       0.001601413479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366646691
  error estimate for blocks of size 2^( 2) =       0.000380544117
  error estimate for blocks of size 2^( 3) =       0.000393347785
  error estimate for blocks of size 2^( 4) =       0.000402712295
  error estimate for blocks of size 2^( 5) =       0.000408287192
  error estimate for blocks of size 2^( 6) =       0.000411865038
  error estimate for blocks of size 2^( 7) =       0.000415926024

      target function =      -0.943632168042
              le_mean =     -17.211706600645
             les_mean =     296.523553001470
             stat err =       0.000409697637
             autocorr =       1.248623139631
   target nu stat err =       0.000409697637
   target dn stat err =       0.002639503202
      target stat err =       0.004443216013
              std dev =       0.518516722832
             le_variance =       0.268859591857


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943632168042        initial
     3.7253e+09     3.7253e+10             2.4798e-14        -0.943632168042
     1.4901e+10     1.4901e+11             6.1985e-15        -0.943632168042
     5.9605e+10     5.9605e+11             1.5531e-15        -0.943632168042  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e+10     and shift_s =   5.9605e+11
*****************************************************************************

  Execution time = 2.3802e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1012e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1664
    reference variance = 0.238898
====================================================
  Execution time = 1.6605e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7652e-01
  Total weights = 1.957167863e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4937e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266414421231
                                         uncertainty =       0.001310212122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266414421231
                                         uncertainty =       0.001310212122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365053703
  error estimate for blocks of size 2^( 2) =       0.000379112562
  error estimate for blocks of size 2^( 3) =       0.000391706142
  error estimate for blocks of size 2^( 4) =       0.000400926979
  error estimate for blocks of size 2^( 5) =       0.000405921861
  error estimate for blocks of size 2^( 6) =       0.000407878227
  error estimate for blocks of size 2^( 7) =       0.000409671742

      target function =      -0.950670492271
              le_mean =     -17.212043341194
             les_mean =     296.530952569424
             stat err =       0.000406099702
             autocorr =       1.237518855286
   target nu stat err =       0.000406099702
   target dn stat err =       0.001717535866
      target stat err =       0.002985651373
              std dev =       0.516263898146
             le_variance =       0.266528412529


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721204334119e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950678815852       residual = 8.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950678815852       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950678815852       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950678815852       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950665486228       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950699688043       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950658716425       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950701669927       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950690572671       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950669625961       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.950678724246       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.950694970897       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.950655326688       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.950649266583       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.950660826720       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.950667531629       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.950665090917       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.950711601917       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.950685355480       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.950692746659       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.950664761395       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.950695969348       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.950667467247       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.950679430457       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.950659853033       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.950719333823       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.950621183735       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.950679401758       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.950674720497       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.950670109619       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.950683555293       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.950675347140       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.950700218519       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.950690627649       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.950697129296       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.950691112166       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.950687209523       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.950678283462       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.950674925241       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.950685715564       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.950670532918       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.950677198818       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.950667306082       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.950663762595       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.950682671749       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.950676505178       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.950677258060       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.950692016816       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.950687109290       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.950687751918       residual = 1.73e-08           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.950687035957       residual = 4.50e-08           smallest_sin_value = 9.98e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.950672669013       residual = 1.59e-07           smallest_sin_value = 9.94e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.950676693972       residual = 1.49e-07           smallest_sin_value = 9.92e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.950660543069       residual = 1.21e-07           smallest_sin_value = 9.92e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+10 is 7.841538e-15

solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950678815852       residual = 8.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950678815852       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950678815852       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950678815852       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950678818085       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950664058166       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950659530762       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950749532798       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950609592513       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950715534171       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.950555349203       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.950775918452       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.950626168385       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.950578493366       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.950607240560       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.950654705336       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.950730533211       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.950638002940       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.950520991132       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.950626817357       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.950720897053       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.950716646242       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.950604311634       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.950776280642       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.950573358022       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.950643107681       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.950795539251       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.950669659028       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.950739726388       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.950729247635       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.950546008222       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.950644753613       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.950701072368       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.950581316215       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.950665822226       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.950594842434       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.950740599421       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.950637477326       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.950800577970       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.950704738204       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.950804007055       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.950676942895       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.950785778860       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.950631036000       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.950650835401       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.950704518649       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.950552115610       residual = 2.13e-06           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.950754208859       residual = 2.70e-06           smallest_sin_value = 9.98e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.950767515125       residual = 9.47e-07           smallest_sin_value = 9.98e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.950697980442       residual = 1.33e-06           smallest_sin_value = 9.96e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.950691141474       residual = 8.00e-07           smallest_sin_value = 9.94e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+10 is 1.962500e-15

solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950678815852       residual = 8.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950678815852       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950678815852       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950659818442       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950678803644       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950679112224       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950939067290       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950792630220       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950326348366       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950827744169       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.950350996067       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.950720889176       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.950409965070       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951017722789       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.950573403335       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951043719598       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.950210485521       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951034197832       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.950541987081       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.950654503317       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951402517445       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.950113727299       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951054322494       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.950194812471       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.950540994605       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.950940731208       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.950597243851       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951556530287       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.950800875052       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.951061806751       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.950790044055       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.950910587038       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.951572425531       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.950374187877       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.950435473471       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.950961101573       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.950901953100       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.950860245241       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.950972672316       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.950213275000       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.950585791843       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.950415350310       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.951085497841       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.950551267115       residual = 1.94e-05           smallest_sin_value = 9.99e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.950580933306       residual = 3.91e-05           smallest_sin_value = 9.99e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.950344897988       residual = 9.62e-06           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.950941341286       residual = 6.38e-06           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.950431031822       residual = 4.81e-06           smallest_sin_value = 9.98e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.951070178165       residual = 2.39e-05           smallest_sin_value = 9.95e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.950300679630       residual = 4.65e-05           smallest_sin_value = 9.93e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+11 is 4.929706e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.416569 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9265e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.17
    reference variance = 0.174555
====================================================
  Execution time = 1.6051e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8113e-01
  Total weights = 1.9576e+06
  Execution time = 1.9834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267973205712
                                         uncertainty =       0.001701338803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267973205712
                                         uncertainty =       0.001701338803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366046084
  error estimate for blocks of size 2^( 2) =       0.000379678331
  error estimate for blocks of size 2^( 3) =       0.000392252777
  error estimate for blocks of size 2^( 4) =       0.000401295540
  error estimate for blocks of size 2^( 5) =       0.000407274733
  error estimate for blocks of size 2^( 6) =       0.000409581884
  error estimate for blocks of size 2^( 7) =       0.000412794758

      target function =      -0.942941054002
              le_mean =     -17.211872596221
             les_mean =     296.529687100347
             stat err =       0.000407736729
             autocorr =       1.240761010485
   target nu stat err =       0.000407736729
   target dn stat err =       0.002459280856
      target stat err =       0.004142804965
              std dev =       0.517667337030
             le_variance =       0.267979471827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267973205712
                                         uncertainty =       0.001701338803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267973205712
                                         uncertainty =       0.001701338803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366046084
  error estimate for blocks of size 2^( 2) =       0.000379678331
  error estimate for blocks of size 2^( 3) =       0.000392252777
  error estimate for blocks of size 2^( 4) =       0.000401295540
  error estimate for blocks of size 2^( 5) =       0.000407274733
  error estimate for blocks of size 2^( 6) =       0.000409581884
  error estimate for blocks of size 2^( 7) =       0.000412794758

      target function =      -0.942941054002
              le_mean =     -17.211872596221
             les_mean =     296.529687100347
             stat err =       0.000407736729
             autocorr =       1.240761010482
   target nu stat err =       0.000407736729
   target dn stat err =       0.002459280856
      target stat err =       0.004142804965
              std dev =       0.517667337030
             le_variance =       0.267979471827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267973205712
                                         uncertainty =       0.001701338803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267973205712
                                         uncertainty =       0.001701338803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366046084
  error estimate for blocks of size 2^( 2) =       0.000379678331
  error estimate for blocks of size 2^( 3) =       0.000392252777
  error estimate for blocks of size 2^( 4) =       0.000401295540
  error estimate for blocks of size 2^( 5) =       0.000407274733
  error estimate for blocks of size 2^( 6) =       0.000409581884
  error estimate for blocks of size 2^( 7) =       0.000412794758

      target function =      -0.942941054002
              le_mean =     -17.211872596221
             les_mean =     296.529687100347
             stat err =       0.000407736729
             autocorr =       1.240761010479
   target nu stat err =       0.000407736729
   target dn stat err =       0.002459280856
      target stat err =       0.004142804965
              std dev =       0.517667337030
             le_variance =       0.267979471827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267973205712
                                         uncertainty =       0.001701338803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267973205712
                                         uncertainty =       0.001701338803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366046084
  error estimate for blocks of size 2^( 2) =       0.000379678331
  error estimate for blocks of size 2^( 3) =       0.000392252777
  error estimate for blocks of size 2^( 4) =       0.000401295540
  error estimate for blocks of size 2^( 5) =       0.000407274733
  error estimate for blocks of size 2^( 6) =       0.000409581884
  error estimate for blocks of size 2^( 7) =       0.000412794758

      target function =      -0.942941054002
              le_mean =     -17.211872596221
             les_mean =     296.529687100347
             stat err =       0.000407736729
             autocorr =       1.240761010486
   target nu stat err =       0.000407736729
   target dn stat err =       0.002459280856
      target stat err =       0.004142804965
              std dev =       0.517667337030
             le_variance =       0.267979471827


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942941054002        initial
     1.4901e+10     1.4901e+11             7.8415e-15        -0.942941054002  <--
     5.9605e+10     5.9605e+11             1.9625e-15        -0.942941054002
     2.3842e+11     2.3842e+12             4.9297e-16        -0.942941054002

*****************************************************************************
Applying the update for shift_i =   1.4901e+10     and shift_s =   1.4901e+11
*****************************************************************************

  Execution time = 2.5510e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2544
    reference variance = 0.156109
====================================================
  Execution time = 1.3970e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7854e-01
  Total weights = 1.957346766e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267445854878
                                         uncertainty =       0.001420422979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267445854878
                                         uncertainty =       0.001420422979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365636136
  error estimate for blocks of size 2^( 2) =       0.000379714516
  error estimate for blocks of size 2^( 3) =       0.000392555107
  error estimate for blocks of size 2^( 4) =       0.000401716268
  error estimate for blocks of size 2^( 5) =       0.000407780903
  error estimate for blocks of size 2^( 6) =       0.000409768341
  error estimate for blocks of size 2^( 7) =       0.000411098233

      target function =      -0.947260782802
              le_mean =     -17.212055349610
             les_mean =     296.533392406349
             stat err =       0.000407590936
             autocorr =       1.242655696329
   target nu stat err =       0.000407590936
   target dn stat err =       0.002052885218
      target stat err =       0.003513107346
              std dev =       0.517087581974
             le_variance =       0.267379567432


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721205534961e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947272833429       residual = 8.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947272833429       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947272833429       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947272833429       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947272833543       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947272768153       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947275482533       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947266551696       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947271557480       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947275748083       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+09 is 6.007049e-14

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947272833429       residual = 8.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947272833429       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947272833429       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947271803709       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947280195776       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947272067218       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947278716893       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947247036664       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947268528724       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947268056557       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947286033029       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947275063725       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947267599351       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947298935198       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947258658878       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947289071089       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947267553540       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947277900417       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947255485311       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947261480377       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947258235159       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947280042522       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947252911624       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947268793001       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947264092646       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947258909273       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947278926381       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947269259700       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947292551846       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947278689246       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947305563037       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947298304155       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947266188235       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947249549943       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947281474210       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947281850533       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947297023771       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947257744155       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947279607452       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947267626557       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947272013665       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947271544270       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947275242244       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947277851886       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.947261590758       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.947281875751       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.947265590829       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.947281158852       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.947269995651       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.947273767771       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.947274530271       residual = 6.59e-07           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.947275272052       residual = 5.39e-07           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.947272636039       residual = 8.70e-08           smallest_sin_value = 9.97e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.947235196198       residual = 1.68e-07           smallest_sin_value = 9.93e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.947263675311       residual = 7.15e-08           smallest_sin_value = 9.93e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+10 is 1.502822e-14

solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947272833429       residual = 8.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947272833429       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947272833429       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947272833429       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947272833291       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947283023721       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947305952198       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947297402216       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947284245932       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947274510984       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947275773698       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.947233744604       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.947337328639       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.947166895810       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.947176246405       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.947237078879       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.947240408798       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.947350744703       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947347195709       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947152016525       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947336660729       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947298834875       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.947222571750       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.947307656846       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947378365882       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.947219294621       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947257703272       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.947354892581       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947377293108       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.947233988925       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.947211496647       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.947250050123       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947248891852       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947234624503       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.947255253525       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947295015831       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947267342089       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.947322736476       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.947401474255       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947438511230       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.947350139214       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.947194604071       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947327184316       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947224579679       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.947239983614       residual = 4.15e-07           smallest_sin_value = 9.99e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.947277582720       residual = 1.38e-06           smallest_sin_value = 9.98e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.947233180544       residual = 9.54e-07           smallest_sin_value = 9.97e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.947260044790       residual = 2.35e-06           smallest_sin_value = 9.94e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+10 is 3.751110e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.529306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6583e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1315
    reference variance = 0.385408
====================================================
  Execution time = 1.3390e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7557e-01
  Total weights = 1.9574e+06
  Execution time = 1.8318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266328281511
                                         uncertainty =       0.001489979553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266328281511
                                         uncertainty =       0.001489979553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364946126
  error estimate for blocks of size 2^( 2) =       0.000379119654
  error estimate for blocks of size 2^( 3) =       0.000391570968
  error estimate for blocks of size 2^( 4) =       0.000400772522
  error estimate for blocks of size 2^( 5) =       0.000406217614
  error estimate for blocks of size 2^( 6) =       0.000411276107
  error estimate for blocks of size 2^( 7) =       0.000411075685

      target function =      -0.952278663170
              le_mean =     -17.212465920848
             les_mean =     296.544556418046
             stat err =       0.000407335482
             autocorr =       1.245796103137
   target nu stat err =       0.000407335482
   target dn stat err =       0.001779607664
      target stat err =       0.003100500429
              std dev =       0.516111761183
             le_variance =       0.266371350031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266328281511
                                         uncertainty =       0.001489979553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266328281511
                                         uncertainty =       0.001489979553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364946126
  error estimate for blocks of size 2^( 2) =       0.000379119654
  error estimate for blocks of size 2^( 3) =       0.000391570968
  error estimate for blocks of size 2^( 4) =       0.000400772522
  error estimate for blocks of size 2^( 5) =       0.000406217614
  error estimate for blocks of size 2^( 6) =       0.000411276107
  error estimate for blocks of size 2^( 7) =       0.000411075685

      target function =      -0.952278663170
              le_mean =     -17.212465920848
             les_mean =     296.544556418047
             stat err =       0.000407335482
             autocorr =       1.245796103143
   target nu stat err =       0.000407335482
   target dn stat err =       0.001779607664
      target stat err =       0.003100500429
              std dev =       0.516111761183
             le_variance =       0.266371350031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266328281511
                                         uncertainty =       0.001489979553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266328281511
                                         uncertainty =       0.001489979553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364946126
  error estimate for blocks of size 2^( 2) =       0.000379119654
  error estimate for blocks of size 2^( 3) =       0.000391570968
  error estimate for blocks of size 2^( 4) =       0.000400772522
  error estimate for blocks of size 2^( 5) =       0.000406217614
  error estimate for blocks of size 2^( 6) =       0.000411276107
  error estimate for blocks of size 2^( 7) =       0.000411075685

      target function =      -0.952278663170
              le_mean =     -17.212465920848
             les_mean =     296.544556418047
             stat err =       0.000407335482
             autocorr =       1.245796103145
   target nu stat err =       0.000407335482
   target dn stat err =       0.001779607664
      target stat err =       0.003100500429
              std dev =       0.516111761183
             le_variance =       0.266371350031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266328281511
                                         uncertainty =       0.001489979553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266328281511
                                         uncertainty =       0.001489979553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364946126
  error estimate for blocks of size 2^( 2) =       0.000379119654
  error estimate for blocks of size 2^( 3) =       0.000391570968
  error estimate for blocks of size 2^( 4) =       0.000400772522
  error estimate for blocks of size 2^( 5) =       0.000406217614
  error estimate for blocks of size 2^( 6) =       0.000411276107
  error estimate for blocks of size 2^( 7) =       0.000411075685

      target function =      -0.952278663170
              le_mean =     -17.212465920848
             les_mean =     296.544556418046
             stat err =       0.000407335482
             autocorr =       1.245796103145
   target nu stat err =       0.000407335482
   target dn stat err =       0.001779607664
      target stat err =       0.003100500429
              std dev =       0.516111761183
             le_variance =       0.266371350031


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.952278663170        initial
     3.7253e+09     3.7253e+10             6.0070e-14        -0.952278663170  <--
     1.4901e+10     1.4901e+11             1.5028e-14        -0.952278663170
     5.9605e+10     5.9605e+11             3.7511e-15        -0.952278663170

*****************************************************************************
Applying the update for shift_i =   3.7253e+09     and shift_s =   3.7253e+10
*****************************************************************************

  Execution time = 2.2691e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9290e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1733
    reference variance = 0.171352
====================================================
  Execution time = 1.4251e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8003e-01
  Total weights = 1.957375281e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4916e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266379413863
                                         uncertainty =       0.001519235285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266379413863
                                         uncertainty =       0.001519235285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364932147
  error estimate for blocks of size 2^( 2) =       0.000378879428
  error estimate for blocks of size 2^( 3) =       0.000391864559
  error estimate for blocks of size 2^( 4) =       0.000400927579
  error estimate for blocks of size 2^( 5) =       0.000406672791
  error estimate for blocks of size 2^( 6) =       0.000409427501
  error estimate for blocks of size 2^( 7) =       0.000411137353

      target function =      -0.944769875793
              le_mean =     -17.212335586142
             les_mean =     296.544523983603
             stat err =       0.000407041306
             autocorr =       1.244092641652
   target nu stat err =       0.000407041306
   target dn stat err =       0.003153136426
      target stat err =       0.005305154489
              std dev =       0.516091991931
             le_variance =       0.266350944136


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721233558614e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944798696829       residual = 5.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944798696829       residual = 7.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944798696829       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944798500271       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944798753457       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944798306651       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944799001221       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944798628431       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944799704168       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+08 is 1.031353e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944798696829       residual = 5.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944798696829       residual = 7.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944798696829       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944798785036       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944798335035       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944797744882       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944798925196       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944800766660       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944802312642       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944801600169       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+09 is 2.579166e-14

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944798696829       residual = 5.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944798696829       residual = 7.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944798696829       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944798696829       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944801103129       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944792826694       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944768360906       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944812844941       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944794933042       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944787328425       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944805033262       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944789194002       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944776870757       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944802149003       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944769151443       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944843764629       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944830438925       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944836284943       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944801765652       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944799418198       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944792325566       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944815545920       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944805097463       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944808250359       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944799574217       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944780726057       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944799472003       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944786138063       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944809750802       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.944811500784       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944805879904       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944786722208       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.944789086993       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944793853261       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944805300047       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944790478912       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.944793372859       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944799474500       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944795794631       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.944790429946       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.944798707601       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.944795454489       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.944789075807       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.944792671585       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.944802121197       residual = 1.08e-07           smallest_sin_value = 9.99e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.944803274622       residual = 2.03e-07           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.944793386795       residual = 1.09e-07           smallest_sin_value = 9.97e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.944795124594       residual = 1.28e-07           smallest_sin_value = 9.94e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+10 is 6.449450e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.577671 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6798e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2857
    reference variance = 0.249027
====================================================
  Execution time = 1.3491e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7715e-01
  Total weights = 1.9572e+06
  Execution time = 1.8257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266377593144
                                         uncertainty =       0.001450757829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266377593144
                                         uncertainty =       0.001450757829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364953099
  error estimate for blocks of size 2^( 2) =       0.000379136087
  error estimate for blocks of size 2^( 3) =       0.000392183275
  error estimate for blocks of size 2^( 4) =       0.000401932300
  error estimate for blocks of size 2^( 5) =       0.000407739023
  error estimate for blocks of size 2^( 6) =       0.000409738762
  error estimate for blocks of size 2^( 7) =       0.000411427098

      target function =      -0.949591765306
              le_mean =     -17.211784678726
             les_mean =     296.522683568483
             stat err =       0.000407709296
             autocorr =       1.248036003639
   target nu stat err =       0.000407709296
   target dn stat err =       0.001741812725
      target stat err =       0.003017968554
              std dev =       0.516121622923
             le_variance =       0.266381529649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266377593144
                                         uncertainty =       0.001450757829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266377593144
                                         uncertainty =       0.001450757829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364953099
  error estimate for blocks of size 2^( 2) =       0.000379136087
  error estimate for blocks of size 2^( 3) =       0.000392183275
  error estimate for blocks of size 2^( 4) =       0.000401932300
  error estimate for blocks of size 2^( 5) =       0.000407739023
  error estimate for blocks of size 2^( 6) =       0.000409738762
  error estimate for blocks of size 2^( 7) =       0.000411427098

      target function =      -0.949591765306
              le_mean =     -17.211784678726
             les_mean =     296.522683568483
             stat err =       0.000407709296
             autocorr =       1.248036003638
   target nu stat err =       0.000407709296
   target dn stat err =       0.001741812725
      target stat err =       0.003017968554
              std dev =       0.516121622923
             le_variance =       0.266381529649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266377593144
                                         uncertainty =       0.001450757829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266377593144
                                         uncertainty =       0.001450757829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364953099
  error estimate for blocks of size 2^( 2) =       0.000379136087
  error estimate for blocks of size 2^( 3) =       0.000392183275
  error estimate for blocks of size 2^( 4) =       0.000401932300
  error estimate for blocks of size 2^( 5) =       0.000407739023
  error estimate for blocks of size 2^( 6) =       0.000409738762
  error estimate for blocks of size 2^( 7) =       0.000411427098

      target function =      -0.949591765306
              le_mean =     -17.211784678726
             les_mean =     296.522683568483
             stat err =       0.000407709296
             autocorr =       1.248036003638
   target nu stat err =       0.000407709296
   target dn stat err =       0.001741812725
      target stat err =       0.003017968554
              std dev =       0.516121622923
             le_variance =       0.266381529649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266377593144
                                         uncertainty =       0.001450757829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266377593144
                                         uncertainty =       0.001450757829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364953099
  error estimate for blocks of size 2^( 2) =       0.000379136087
  error estimate for blocks of size 2^( 3) =       0.000392183275
  error estimate for blocks of size 2^( 4) =       0.000401932300
  error estimate for blocks of size 2^( 5) =       0.000407739023
  error estimate for blocks of size 2^( 6) =       0.000409738762
  error estimate for blocks of size 2^( 7) =       0.000411427098

      target function =      -0.949591765306
              le_mean =     -17.211784678726
             les_mean =     296.522683568483
             stat err =       0.000407709296
             autocorr =       1.248036003638
   target nu stat err =       0.000407709296
   target dn stat err =       0.001741812725
      target stat err =       0.003017968554
              std dev =       0.516121622923
             le_variance =       0.266381529649


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949591765306        initial
     9.3132e+08     9.3132e+09             1.0314e-13        -0.949591765306  <--
     3.7253e+09     3.7253e+10             2.5792e-14        -0.949591765306
     1.4901e+10     1.4901e+11             6.4495e-15        -0.949591765306

*****************************************************************************
Applying the update for shift_i =   9.3132e+08     and shift_s =   9.3132e+09
*****************************************************************************

  Execution time = 2.2787e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9616e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2128
    reference variance = 0.249576
====================================================
  Execution time = 1.3919e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7843e-01
  Total weights = 1.957617323e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267619099445
                                         uncertainty =       0.001558990867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267619099445
                                         uncertainty =       0.001558990867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365754052
  error estimate for blocks of size 2^( 2) =       0.000379664607
  error estimate for blocks of size 2^( 3) =       0.000392316323
  error estimate for blocks of size 2^( 4) =       0.000401826500
  error estimate for blocks of size 2^( 5) =       0.000408382752
  error estimate for blocks of size 2^( 6) =       0.000410672668
  error estimate for blocks of size 2^( 7) =       0.000412121894

      target function =      -0.947459241087
              le_mean =     -17.212244448852
             les_mean =     296.539786880713
             stat err =       0.000408250954
             autocorr =       1.245879740184
   target nu stat err =       0.000408250954
   target dn stat err =       0.002010154075
      target stat err =       0.003445960123
              std dev =       0.517254340857
             le_variance =       0.267552053136


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721224444885e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947470737037       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947470737038       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947470737038       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947470737038       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947470645977       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947470786740       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947470737038       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947470737038       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947470737038       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947470995893       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+08 is 6.342617e-13

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947470737037       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947470737037       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947470737037       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947470872273       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947470737038       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947470737038       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947470737038       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947470737038       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947472690027       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947470737038       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+08 is 1.585627e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947470737037       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947470737037       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947470737037       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947470737037       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947470737037       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947470737037       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947470737037       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947470737037       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947478745770       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947470737037       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+09 is 3.964057e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.581154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6385e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2923
    reference variance = 0.246273
====================================================
  Execution time = 1.3688e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7851e-01
  Total weights = 1.9572e+06
  Execution time = 1.8297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266317055441
                                         uncertainty =       0.001461553266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266317055441
                                         uncertainty =       0.001461553266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364896531
  error estimate for blocks of size 2^( 2) =       0.000379006841
  error estimate for blocks of size 2^( 3) =       0.000391568251
  error estimate for blocks of size 2^( 4) =       0.000400756915
  error estimate for blocks of size 2^( 5) =       0.000406281805
  error estimate for blocks of size 2^( 6) =       0.000409200960
  error estimate for blocks of size 2^( 7) =       0.000410238845

      target function =      -0.947317531933
              le_mean =     -17.212590692289
             les_mean =     296.551792618697
             stat err =       0.000406619631
             autocorr =       1.241758707961
   target nu stat err =       0.000406619631
   target dn stat err =       0.002445581910
      target stat err =       0.004163415287
              std dev =       0.516041623208
             le_variance =       0.266298956884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266317055441
                                         uncertainty =       0.001461553266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266317055441
                                         uncertainty =       0.001461553266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364896531
  error estimate for blocks of size 2^( 2) =       0.000379006841
  error estimate for blocks of size 2^( 3) =       0.000391568251
  error estimate for blocks of size 2^( 4) =       0.000400756915
  error estimate for blocks of size 2^( 5) =       0.000406281805
  error estimate for blocks of size 2^( 6) =       0.000409200960
  error estimate for blocks of size 2^( 7) =       0.000410238845

      target function =      -0.947317531931
              le_mean =     -17.212590692289
             les_mean =     296.551792618697
             stat err =       0.000406619631
             autocorr =       1.241758707967
   target nu stat err =       0.000406619631
   target dn stat err =       0.002445581910
      target stat err =       0.004163415287
              std dev =       0.516041623209
             le_variance =       0.266298956884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266317055441
                                         uncertainty =       0.001461553266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266317055441
                                         uncertainty =       0.001461553266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364896531
  error estimate for blocks of size 2^( 2) =       0.000379006841
  error estimate for blocks of size 2^( 3) =       0.000391568251
  error estimate for blocks of size 2^( 4) =       0.000400756915
  error estimate for blocks of size 2^( 5) =       0.000406281805
  error estimate for blocks of size 2^( 6) =       0.000409200960
  error estimate for blocks of size 2^( 7) =       0.000410238845

      target function =      -0.947317531932
              le_mean =     -17.212590692289
             les_mean =     296.551792618697
             stat err =       0.000406619631
             autocorr =       1.241758707966
   target nu stat err =       0.000406619631
   target dn stat err =       0.002445581910
      target stat err =       0.004163415287
              std dev =       0.516041623209
             le_variance =       0.266298956884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266317055441
                                         uncertainty =       0.001461553266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266317055441
                                         uncertainty =       0.001461553266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364896531
  error estimate for blocks of size 2^( 2) =       0.000379006841
  error estimate for blocks of size 2^( 3) =       0.000391568251
  error estimate for blocks of size 2^( 4) =       0.000400756915
  error estimate for blocks of size 2^( 5) =       0.000406281805
  error estimate for blocks of size 2^( 6) =       0.000409200960
  error estimate for blocks of size 2^( 7) =       0.000410238845

      target function =      -0.947317531932
              le_mean =     -17.212590692289
             les_mean =     296.551792618697
             stat err =       0.000406619631
             autocorr =       1.241758707966
   target nu stat err =       0.000406619631
   target dn stat err =       0.002445581910
      target stat err =       0.004163415287
              std dev =       0.516041623208
             le_variance =       0.266298956884


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947317531933        initial  <--
     2.3283e+08     2.3283e+09             6.3426e-13        -0.947317531931
     9.3132e+08     9.3132e+09             1.5856e-13        -0.947317531932
     3.7253e+09     3.7253e+10             3.9641e-14        -0.947317531932

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0374
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9438e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.1485
    reference variance = 0.220201
====================================================
  Execution time = 1.3868e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8071e-01
  Total weights = 1.957372041e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4715e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268091832450
                                         uncertainty =       0.001819746084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268091832450
                                         uncertainty =       0.001819746084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366081246
  error estimate for blocks of size 2^( 2) =       0.000379916433
  error estimate for blocks of size 2^( 3) =       0.000392537964
  error estimate for blocks of size 2^( 4) =       0.000401796864
  error estimate for blocks of size 2^( 5) =       0.000407634988
  error estimate for blocks of size 2^( 6) =       0.000410679451
  error estimate for blocks of size 2^( 7) =       0.000413672497

      target function =      -0.943648580847
              le_mean =     -17.212604908909
             les_mean =     296.554475969986
             stat err =       0.000408445950
             autocorr =       1.244841983057
   target nu stat err =       0.000408445950
   target dn stat err =       0.002760965834
      target stat err =       0.004650029117
              std dev =       0.517717062651
             le_variance =       0.268030956960


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721260490891e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943670419571       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943670419571       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943670419571       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943670419571       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943670419571       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943670419571       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943668497266       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943671644769       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943670419571       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943669505775       residual = 7.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+09 is 6.966613e-14

solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943670419571       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943670419571       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943670419571       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943659872406       residual = 5.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943667946687       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943672367469       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943671434061       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943675242025       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943638787421       residual = 5.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943668551413       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943676739642       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943660698390       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+09 is 1.740149e-14

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943670419571       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943670419571       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943670419571       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943670419571       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943670418571       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943667875121       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943661790761       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943632612857       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943623431282       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943657121752       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943724637917       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943598541444       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943630197742       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943756553126       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943632240487       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943684790505       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943635650158       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943652416991       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943678688321       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943612735702       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943687653025       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943648896080       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943671786804       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943713584455       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943609064820       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.943739355216       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.943626805179       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.943667337725       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.943628873020       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.943658963231       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.943610183111       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.943637447985       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.943658289277       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.943659756944       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.943718467907       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.943650362179       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.943668042481       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.943686692270       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.943707191432       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943637151166       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.943731373038       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.943652528411       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.943688089177       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.943689290983       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.943681813250       residual = 3.29e-07           smallest_sin_value = 9.99e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.943689055248       residual = 2.22e-08           smallest_sin_value = 9.98e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.943712558224       residual = 5.82e-07           smallest_sin_value = 9.94e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.943782700235       residual = 3.80e-07           smallest_sin_value = 9.94e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+10 is 4.348284e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.627839 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6392e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2489
    reference variance = 0.233717
====================================================
  Execution time = 1.3992e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7672e-01
  Total weights = 1.9572e+06
  Execution time = 1.8273e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266512206399
                                         uncertainty =       0.001306654441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266512206399
                                         uncertainty =       0.001306654441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365057835
  error estimate for blocks of size 2^( 2) =       0.000379473286
  error estimate for blocks of size 2^( 3) =       0.000392595432
  error estimate for blocks of size 2^( 4) =       0.000402175929
  error estimate for blocks of size 2^( 5) =       0.000408035206
  error estimate for blocks of size 2^( 6) =       0.000411391462
  error estimate for blocks of size 2^( 7) =       0.000412284363

      target function =      -0.950328066551
              le_mean =     -17.212167351806
             les_mean =     296.535427247831
             stat err =       0.000408471740
             autocorr =       1.251989489725
   target nu stat err =       0.000408471740
   target dn stat err =       0.001673811054
      target stat err =       0.002913807157
              std dev =       0.516269741364
             le_variance =       0.266534445848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266512206399
                                         uncertainty =       0.001306654441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266512206399
                                         uncertainty =       0.001306654441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365057835
  error estimate for blocks of size 2^( 2) =       0.000379473286
  error estimate for blocks of size 2^( 3) =       0.000392595432
  error estimate for blocks of size 2^( 4) =       0.000402175929
  error estimate for blocks of size 2^( 5) =       0.000408035206
  error estimate for blocks of size 2^( 6) =       0.000411391462
  error estimate for blocks of size 2^( 7) =       0.000412284363

      target function =      -0.950328066550
              le_mean =     -17.212167351806
             les_mean =     296.535427247832
             stat err =       0.000408471740
             autocorr =       1.251989489725
   target nu stat err =       0.000408471740
   target dn stat err =       0.001673811054
      target stat err =       0.002913807157
              std dev =       0.516269741364
             le_variance =       0.266534445848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266512206399
                                         uncertainty =       0.001306654441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266512206399
                                         uncertainty =       0.001306654441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365057835
  error estimate for blocks of size 2^( 2) =       0.000379473286
  error estimate for blocks of size 2^( 3) =       0.000392595432
  error estimate for blocks of size 2^( 4) =       0.000402175929
  error estimate for blocks of size 2^( 5) =       0.000408035206
  error estimate for blocks of size 2^( 6) =       0.000411391462
  error estimate for blocks of size 2^( 7) =       0.000412284363

      target function =      -0.950328066550
              le_mean =     -17.212167351806
             les_mean =     296.535427247831
             stat err =       0.000408471740
             autocorr =       1.251989489724
   target nu stat err =       0.000408471740
   target dn stat err =       0.001673811054
      target stat err =       0.002913807157
              std dev =       0.516269741364
             le_variance =       0.266534445848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266512206399
                                         uncertainty =       0.001306654441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266512206399
                                         uncertainty =       0.001306654441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365057835
  error estimate for blocks of size 2^( 2) =       0.000379473286
  error estimate for blocks of size 2^( 3) =       0.000392595432
  error estimate for blocks of size 2^( 4) =       0.000402175929
  error estimate for blocks of size 2^( 5) =       0.000408035206
  error estimate for blocks of size 2^( 6) =       0.000411391462
  error estimate for blocks of size 2^( 7) =       0.000412284363

      target function =      -0.950328066551
              le_mean =     -17.212167351806
             les_mean =     296.535427247831
             stat err =       0.000408471740
             autocorr =       1.251989489724
   target nu stat err =       0.000408471740
   target dn stat err =       0.001673811054
      target stat err =       0.002913807157
              std dev =       0.516269741364
             le_variance =       0.266534445848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950328066551        initial  <--
     2.3283e+09     2.3283e+10             6.9666e-14        -0.950328066550
     9.3132e+09     9.3132e+10             1.7401e-14        -0.950328066550
     3.7253e+10     3.7253e+11             4.3483e-15        -0.950328066551

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3827
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1667
    reference variance = 0.346102
====================================================
  Execution time = 1.3877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7718e-01
  Total weights = 1.957320512e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266061758064
                                         uncertainty =       0.001610522297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266061758064
                                         uncertainty =       0.001610522297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364697934
  error estimate for blocks of size 2^( 2) =       0.000378708313
  error estimate for blocks of size 2^( 3) =       0.000391173642
  error estimate for blocks of size 2^( 4) =       0.000400446513
  error estimate for blocks of size 2^( 5) =       0.000405435172
  error estimate for blocks of size 2^( 6) =       0.000408015760
  error estimate for blocks of size 2^( 7) =       0.000408883293

      target function =      -0.949551502746
              le_mean =     -17.212186736996
             les_mean =     296.536554084680
             stat err =       0.000405695185
             autocorr =       1.237465501092
   target nu stat err =       0.000405695185
   target dn stat err =       0.001942563702
      target stat err =       0.003348327569
              std dev =       0.515760763972
             le_variance =       0.266009165653


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721218673700e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949562334078       residual = 6.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949562334078       residual = 6.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949562334078       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949562334079       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949562337016       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949547625598       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949537006965       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949555367985       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949559638860       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949542872210       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949632178579       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949554225995       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949558276522       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949578472049       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949578294444       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949570542606       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949548393169       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949594361279       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949513272522       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949642574764       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949514611434       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949512552410       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949559706401       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949539600516       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.949578592605       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.949556920437       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.949546921033       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.949588817317       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.949598069724       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.949554044091       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.949573170900       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.949530749956       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.949558733614       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.949556970350       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.949587611959       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.949564921190       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.949576181455       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.949563828777       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.949547796957       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.949559274456       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.949559244860       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.949558330697       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.949576199983       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.949570301875       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.949566585633       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.949580012820       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.949573860743       residual = 1.16e-05           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.949543297360       residual = 1.42e-07           smallest_sin_value = 9.96e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.949562926978       residual = 2.41e-08           smallest_sin_value = 9.92e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+10 is 5.148160e-15

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949562334078       residual = 6.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949562334078       residual = 6.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949562334078       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949562334078       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949580221108       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949552903109       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949555696714       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949612287572       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949450535004       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949291617779       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949542865456       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949729956787       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949474234691       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949582050091       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949635861972       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949491638960       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949604601268       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949624777743       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949535797960       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949625601087       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949557499909       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949524727233       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949560926965       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949483914553       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.949465087474       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.949552335420       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.949488962138       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.949635025905       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.949619332523       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.949464381795       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.949568049883       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.949625688027       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.949558864887       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.949566130779       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.949604586737       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.949633103394       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.949537381962       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.949597231971       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.949499165781       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.949585604981       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.949545477978       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.949617889676       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.949581901353       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.949611647384       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.949658023900       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.949560985022       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.949520853739       residual = 6.44e-06           smallest_sin_value = 9.98e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.949584838638       residual = 1.35e-05           smallest_sin_value = 9.97e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+10 is 1.264269e-15

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949562334078       residual = 6.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949562334078       residual = 6.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949562334078       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949562334078       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949562334078       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949442152009       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949505513475       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949541131562       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949027291512       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950284540106       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948737423712       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949169344621       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.950990433770       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949277530094       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949916588002       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949843996957       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949594141208       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949613204921       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.950165318352       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.950084459389       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949779089724       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949139449360       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949848042658       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949560517076       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.949648695106       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.949484700182       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.950068211692       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.950037696081       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.949550599321       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.948808189200       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.948877975690       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.949598166505       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.949090733970       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.949445371607       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.949590390842       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.949327420719       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.949544782129       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.949597343127       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.949372687464       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.950101596595       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.950049195086       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.950228889133       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.949586635022       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.949741289791       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.949949341933       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.949218938039       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.949703522418       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.949660375932       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.950103639104       residual = 1.32e-05           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.949291847699       residual = 5.65e-05           smallest_sin_value = 9.98e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+11 is 3.155277e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.767201 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6482e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1701
    reference variance = 0.148263
====================================================
  Execution time = 1.3707e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7964e-01
  Total weights = 1.9574e+06
  Execution time = 1.8310e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267325554633
                                         uncertainty =       0.001573017494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267325554633
                                         uncertainty =       0.001573017494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365783734
  error estimate for blocks of size 2^( 2) =       0.000379632707
  error estimate for blocks of size 2^( 3) =       0.000391845753
  error estimate for blocks of size 2^( 4) =       0.000400382145
  error estimate for blocks of size 2^( 5) =       0.000406263359
  error estimate for blocks of size 2^( 6) =       0.000409003920
  error estimate for blocks of size 2^( 7) =       0.000409828439

      target function =      -0.945418992745
              le_mean =     -17.212013468005
             les_mean =     296.533050742349
             stat err =       0.000406369466
             autocorr =       1.234222210049
   target nu stat err =       0.000406369466
   target dn stat err =       0.002210269630
      target stat err =       0.003756410429
              std dev =       0.517296318009
             le_variance =       0.267595480625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267325554633
                                         uncertainty =       0.001573017494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267325554633
                                         uncertainty =       0.001573017494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365783734
  error estimate for blocks of size 2^( 2) =       0.000379632707
  error estimate for blocks of size 2^( 3) =       0.000391845753
  error estimate for blocks of size 2^( 4) =       0.000400382145
  error estimate for blocks of size 2^( 5) =       0.000406263359
  error estimate for blocks of size 2^( 6) =       0.000409003920
  error estimate for blocks of size 2^( 7) =       0.000409828439

      target function =      -0.945418992745
              le_mean =     -17.212013468005
             les_mean =     296.533050742349
             stat err =       0.000406369466
             autocorr =       1.234222210048
   target nu stat err =       0.000406369466
   target dn stat err =       0.002210269630
      target stat err =       0.003756410429
              std dev =       0.517296318009
             le_variance =       0.267595480625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267325554633
                                         uncertainty =       0.001573017494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267325554633
                                         uncertainty =       0.001573017494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365783734
  error estimate for blocks of size 2^( 2) =       0.000379632707
  error estimate for blocks of size 2^( 3) =       0.000391845753
  error estimate for blocks of size 2^( 4) =       0.000400382145
  error estimate for blocks of size 2^( 5) =       0.000406263359
  error estimate for blocks of size 2^( 6) =       0.000409003920
  error estimate for blocks of size 2^( 7) =       0.000409828439

      target function =      -0.945418992745
              le_mean =     -17.212013468005
             les_mean =     296.533050742349
             stat err =       0.000406369466
             autocorr =       1.234222210048
   target nu stat err =       0.000406369466
   target dn stat err =       0.002210269630
      target stat err =       0.003756410429
              std dev =       0.517296318009
             le_variance =       0.267595480625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267325554633
                                         uncertainty =       0.001573017494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267325554633
                                         uncertainty =       0.001573017494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365783734
  error estimate for blocks of size 2^( 2) =       0.000379632707
  error estimate for blocks of size 2^( 3) =       0.000391845753
  error estimate for blocks of size 2^( 4) =       0.000400382145
  error estimate for blocks of size 2^( 5) =       0.000406263359
  error estimate for blocks of size 2^( 6) =       0.000409003920
  error estimate for blocks of size 2^( 7) =       0.000409828439

      target function =      -0.945418992745
              le_mean =     -17.212013468005
             les_mean =     296.533050742349
             stat err =       0.000406369466
             autocorr =       1.234222210050
   target nu stat err =       0.000406369466
   target dn stat err =       0.002210269630
      target stat err =       0.003756410429
              std dev =       0.517296318009
             le_variance =       0.267595480625


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945418992745        initial
     2.3283e+10     2.3283e+11             5.1482e-15        -0.945418992745
     9.3132e+10     9.3132e+11             1.2643e-15        -0.945418992745
     3.7253e+11     3.7253e+12             3.1553e-16        -0.945418992745  <--

*****************************************************************************
Applying the update for shift_i =   3.7253e+11     and shift_s =   3.7253e+12
*****************************************************************************

  Execution time = 2.3045e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9533e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.245
    reference variance = 0.135675
====================================================
  Execution time = 1.3989e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7568e-01
  Total weights = 1.957511650e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265893618245
                                         uncertainty =       0.001350237486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265893618245
                                         uncertainty =       0.001350237486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364597249
  error estimate for blocks of size 2^( 2) =       0.000378167696
  error estimate for blocks of size 2^( 3) =       0.000390678223
  error estimate for blocks of size 2^( 4) =       0.000400091114
  error estimate for blocks of size 2^( 5) =       0.000405918320
  error estimate for blocks of size 2^( 6) =       0.000408860640
  error estimate for blocks of size 2^( 7) =       0.000410937025

      target function =      -0.952086115869
              le_mean =     -17.212192211966
             les_mean =     296.535242130563
             stat err =       0.000406451775
             autocorr =       1.242771466001
   target nu stat err =       0.000406451775
   target dn stat err =       0.001775119502
      target stat err =       0.003089944431
              std dev =       0.515618374260
             le_variance =       0.265862307875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721219221197e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952095156035       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952095156035       residual = 8.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952095156035       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952095156035       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952094940334       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952141237802       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952126384674       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952095156035       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952126736515       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952088206983       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.952101106972       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.952213933045       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951819394447       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.952274414017       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.952020147121       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.952087365713       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951975089119       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.952286424464       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.952029983935       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.952103383566       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.952040246481       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.952059855529       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.952137483126       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.952020165205       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.952143761555       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.952095129936       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.952141760319       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.952141705689       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.952094063133       residual = 8.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.952141979996       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951976946857       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.952087077443       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.952071643480       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.952063909696       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.952119355427       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.952096388555       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.952162057626       residual = 7.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.952064440336       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.952101672189       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.952164906703       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.952047588582       residual = 6.20e-05           smallest_sin_value = 9.99e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.952107279309       residual = 4.16e-05           smallest_sin_value = 9.98e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.951973077414       residual = 3.61e-05           smallest_sin_value = 9.94e-01
davidson iteration   43 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         43 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+10 is 1.053009e-15

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952095156035       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952095156035       residual = 8.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952095156035       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952095156035       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952116162977       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952256177236       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952450119697       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953079449561       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952100234777       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953003000078       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.952463478080       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.952135167212       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.952538616931       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.952312435045       residual = 9.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.952291920156       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951923551706       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.952379448310       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.952222946468       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.952478680686       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.952545188764       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.952045878284       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.952088354315       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.952378742462       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.952552170317       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.952395483791       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951679086481       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.951793060537       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951663069691       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.952563078134       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.952239200846       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951759416803       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.951637321681       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.951931594755       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.952490518036       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.951861448669       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.952553490133       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.952460064120       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.952167040827       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.952370271192       residual = 1.49e-04           smallest_sin_value = 9.99e-01
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.952324418828       residual = 9.57e-05           smallest_sin_value = 9.97e-01
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.952049997638       residual = 8.58e-06           smallest_sin_value = 9.97e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.952412886546       residual = 3.25e-05           smallest_sin_value = 9.94e-01
davidson iteration   42 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+11 is 2.676324e-16

solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952095156035       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952095156035       residual = 8.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952095156035       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952095156035       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952095156035       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952095156035       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952095156035       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952095156035       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952095156035       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952095156035       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.952095156035       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945632765657       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951600788386       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.955878426159       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.954822290442       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.952250192141       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.952174072982       residual = 9.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951995531226       residual = 6.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.952182994651       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951987245554       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.952073478539       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.952124742274       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.952322787131       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.952217966666       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.952137989953       residual = 5.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.952037336344       residual = 8.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.951971176999       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.952071832661       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.952267167182       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.951828294187       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951986665925       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.950051981576       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.951823784607       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.951065186785       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.951977183289       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.952090093559       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.952125810915       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.952042870956       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.952080518433       residual = 7.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.952017456200       residual = 8.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.952130721063       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.952074934185       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.952032634790       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.952098540004       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.951914863465       residual = 6.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.952250385271       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.952145028955       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.951919668572       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.952037769860       residual = 7.16e-04           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.952223190862       residual = 1.53e-03           smallest_sin_value = 9.98e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.952363694545       residual = 5.29e-03           smallest_sin_value = 9.97e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+12 is 6.598429e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.881671 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6590e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2525
    reference variance = 0.219791
====================================================
  Execution time = 1.3915e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8356e-01
  Total weights = 1.9573e+06
  Execution time = 1.8311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271156463078
                                         uncertainty =       0.001589067160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271156463078
                                         uncertainty =       0.001589067160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368199754
  error estimate for blocks of size 2^( 2) =       0.000382102599
  error estimate for blocks of size 2^( 3) =       0.000394818051
  error estimate for blocks of size 2^( 4) =       0.000405104203
  error estimate for blocks of size 2^( 5) =       0.000410284052
  error estimate for blocks of size 2^( 6) =       0.000412363863
  error estimate for blocks of size 2^( 7) =       0.000415795728

      target function =      -0.938923760605
              le_mean =     -17.212027564097
             les_mean =     296.537454563487
             stat err =       0.000410886962
             autocorr =       1.245310737215
   target nu stat err =       0.000410886962
   target dn stat err =       0.002455770165
      target stat err =       0.004104572076
              std dev =       0.520713085733
             le_variance =       0.271142117653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271156463078
                                         uncertainty =       0.001589067160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271156463078
                                         uncertainty =       0.001589067160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368199754
  error estimate for blocks of size 2^( 2) =       0.000382102599
  error estimate for blocks of size 2^( 3) =       0.000394818051
  error estimate for blocks of size 2^( 4) =       0.000405104203
  error estimate for blocks of size 2^( 5) =       0.000410284052
  error estimate for blocks of size 2^( 6) =       0.000412363863
  error estimate for blocks of size 2^( 7) =       0.000415795728

      target function =      -0.938923760605
              le_mean =     -17.212027564097
             les_mean =     296.537454563487
             stat err =       0.000410886962
             autocorr =       1.245310737215
   target nu stat err =       0.000410886962
   target dn stat err =       0.002455770165
      target stat err =       0.004104572076
              std dev =       0.520713085733
             le_variance =       0.271142117653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271156463078
                                         uncertainty =       0.001589067160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271156463078
                                         uncertainty =       0.001589067160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368199754
  error estimate for blocks of size 2^( 2) =       0.000382102599
  error estimate for blocks of size 2^( 3) =       0.000394818051
  error estimate for blocks of size 2^( 4) =       0.000405104203
  error estimate for blocks of size 2^( 5) =       0.000410284052
  error estimate for blocks of size 2^( 6) =       0.000412363863
  error estimate for blocks of size 2^( 7) =       0.000415795728

      target function =      -0.938923760605
              le_mean =     -17.212027564097
             les_mean =     296.537454563487
             stat err =       0.000410886962
             autocorr =       1.245310737212
   target nu stat err =       0.000410886962
   target dn stat err =       0.002455770165
      target stat err =       0.004104572076
              std dev =       0.520713085733
             le_variance =       0.271142117653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271156463078
                                         uncertainty =       0.001589067160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271156463078
                                         uncertainty =       0.001589067160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368199754
  error estimate for blocks of size 2^( 2) =       0.000382102599
  error estimate for blocks of size 2^( 3) =       0.000394818051
  error estimate for blocks of size 2^( 4) =       0.000405104203
  error estimate for blocks of size 2^( 5) =       0.000410284052
  error estimate for blocks of size 2^( 6) =       0.000412363863
  error estimate for blocks of size 2^( 7) =       0.000415795728

      target function =      -0.938923760605
              le_mean =     -17.212027564097
             les_mean =     296.537454563487
             stat err =       0.000410886962
             autocorr =       1.245310737214
   target nu stat err =       0.000410886962
   target dn stat err =       0.002455770165
      target stat err =       0.004104572076
              std dev =       0.520713085733
             le_variance =       0.271142117653


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938923760605        initial  <--
     9.3132e+10     9.3132e+11             1.0530e-15        -0.938923760605
     3.7253e+11     3.7253e+12             2.6763e-16        -0.938923760605
     1.4901e+12     1.4901e+13             6.5984e-17        -0.938923760605

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2816
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9894e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2471
    reference variance = 0.243449
====================================================
  Execution time = 1.3991e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7762e-01
  Total weights = 1.957603272e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4619e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266913790281
                                         uncertainty =       0.001560060077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266913790281
                                         uncertainty =       0.001560060077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365313790
  error estimate for blocks of size 2^( 2) =       0.000379069433
  error estimate for blocks of size 2^( 3) =       0.000391413986
  error estimate for blocks of size 2^( 4) =       0.000400351093
  error estimate for blocks of size 2^( 5) =       0.000405770140
  error estimate for blocks of size 2^( 6) =       0.000408330629
  error estimate for blocks of size 2^( 7) =       0.000411183870

      target function =      -0.948810991161
              le_mean =     -17.212027447032
             les_mean =     296.531508406192
             stat err =       0.000406408933
             autocorr =       1.237640059345
   target nu stat err =       0.000406408933
   target dn stat err =       0.001905545428
      target stat err =       0.003281788367
              std dev =       0.516631716290
             le_variance =       0.266908330277


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721202744703e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948821302543       residual = 6.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948821302543       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948821302543       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948821302543       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948854307056       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947756066537       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947240916811       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947939062008       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950519704799       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948838768558       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949000136079       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.950380607752       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948510877628       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948683372690       residual = 9.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948480334564       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948584526658       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948564851559       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948350993300       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947337531749       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948289839810       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949078348260       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948090894773       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949304966749       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949574139689       residual = 9.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.949010459524       residual = 9.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.948566013970       residual = 5.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.949013000392       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.948539922902       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.948108973656       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.948739138705       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.948684734323       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.948793652748       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.949171435320       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.948362975672       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.948088980285       residual = 5.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.949053530618       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.948628082859       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.948796181335       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.948823368620       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947905827075       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.949113595463       residual = 9.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.949844347549       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.947654076535       residual = 9.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.947784504386       residual = 8.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.948826669423       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.948248772122       residual = 8.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.948189961623       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.948308824314       residual = 8.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.948184687677       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.948354892086       residual = 6.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.948223646790       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.949939959556       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.949610362289       residual = 4.47e-04           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.948659032060       residual = 2.88e-05           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.949262864432       residual = 5.45e-04           smallest_sin_value = 9.98e-01
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.949606817198       residual = 2.03e-04           smallest_sin_value = 9.94e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+11 is 9.904518e-17

solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948821302543       residual = 6.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948821302543       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948821302543       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948821302543       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948821302543       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949251873769       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945959470736       residual = 9.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937655237814       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948152820073       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944092829444       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946701733248       residual = 8.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948649482992       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945182601193       residual = 7.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.952605771518       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951206164036       residual = 5.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949247226315       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949002218562       residual = 5.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948148409847       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.950216033703       residual = 8.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.947485038053       residual = 4.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949946763033       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.952473646341       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949074630314       residual = 4.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949760857420       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.950596978605       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.946527898266       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.947195281112       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.950820686024       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.947920051637       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.949016237084       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.948135649977       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.950853967244       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947671807981       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.950209053134       residual = 7.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.949960408220       residual = 7.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.948909536969       residual = 5.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.949434896922       residual = 8.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.949332988410       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.950605619241       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.950304510026       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.948180293784       residual = 8.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.948346564022       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.949447280728       residual = 7.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.948227752082       residual = 1.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.949005103359       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.951675246592       residual = 6.80e-02           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.947277717991       residual = 1.62e-02           smallest_sin_value = 9.98e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.948737241585       residual = 1.04e-01           smallest_sin_value = 9.98e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.954889615575       residual = 2.10e-01           smallest_sin_value = 9.93e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+12 is 2.685551e-17

solving harmonic davidson linear method for identity shift 1.4901e+13, overlap shift 1.4901e+14 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948821302543       residual = 6.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948821302543       residual = 6.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.996431 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6573e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2191
    reference variance = 0.200647
====================================================
  Execution time = 1.5121e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7749e-01
  Total weights = 1.9574e+06
  Execution time = 2.0578e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266700122456
                                         uncertainty =       0.001763697702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266700122456
                                         uncertainty =       0.001763697702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365136001
  error estimate for blocks of size 2^( 2) =       0.000379016208
  error estimate for blocks of size 2^( 3) =       0.000392118969
  error estimate for blocks of size 2^( 4) =       0.000401728685
  error estimate for blocks of size 2^( 5) =       0.000407845669
  error estimate for blocks of size 2^( 6) =       0.000410229337
  error estimate for blocks of size 2^( 7) =       0.000413219336

      target function =      -0.949017518722
              le_mean =     -17.212018837403
             les_mean =     296.531085721137
             stat err =       0.000408255757
             autocorr =       1.250130421961
   target nu stat err =       0.000408255757
   target dn stat err =       0.002347843948
      target stat err =       0.004012469210
              std dev =       0.516380285234
             le_variance =       0.266648598978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266700122456
                                         uncertainty =       0.001763697702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266700122456
                                         uncertainty =       0.001763697702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365136001
  error estimate for blocks of size 2^( 2) =       0.000379016208
  error estimate for blocks of size 2^( 3) =       0.000392118969
  error estimate for blocks of size 2^( 4) =       0.000401728685
  error estimate for blocks of size 2^( 5) =       0.000407845669
  error estimate for blocks of size 2^( 6) =       0.000410229337
  error estimate for blocks of size 2^( 7) =       0.000413219336

      target function =      -0.949017518722
              le_mean =     -17.212018837403
             les_mean =     296.531085721137
             stat err =       0.000408255757
             autocorr =       1.250130421962
   target nu stat err =       0.000408255757
   target dn stat err =       0.002347843948
      target stat err =       0.004012469210
              std dev =       0.516380285234
             le_variance =       0.266648598978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266700122456
                                         uncertainty =       0.001763697702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266700122456
                                         uncertainty =       0.001763697702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365136001
  error estimate for blocks of size 2^( 2) =       0.000379016208
  error estimate for blocks of size 2^( 3) =       0.000392118969
  error estimate for blocks of size 2^( 4) =       0.000401728685
  error estimate for blocks of size 2^( 5) =       0.000407845669
  error estimate for blocks of size 2^( 6) =       0.000410229337
  error estimate for blocks of size 2^( 7) =       0.000413219336

      target function =      -0.949017518722
              le_mean =     -17.212018837403
             les_mean =     296.531085721137
             stat err =       0.000408255757
             autocorr =       1.250130421961
   target nu stat err =       0.000408255757
   target dn stat err =       0.002347843948
      target stat err =       0.004012469210
              std dev =       0.516380285234
             le_variance =       0.266648598978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266700122456
                                         uncertainty =       0.001763697702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266700122456
                                         uncertainty =       0.001763697702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365136001
  error estimate for blocks of size 2^( 2) =       0.000379016208
  error estimate for blocks of size 2^( 3) =       0.000392118969
  error estimate for blocks of size 2^( 4) =       0.000401728685
  error estimate for blocks of size 2^( 5) =       0.000407845669
  error estimate for blocks of size 2^( 6) =       0.000410229337
  error estimate for blocks of size 2^( 7) =       0.000413219336

      target function =      -0.949017518722
              le_mean =     -17.212018837403
             les_mean =     296.531085721137
             stat err =       0.000408255757
             autocorr =       1.250130421961
   target nu stat err =       0.000408255757
   target dn stat err =       0.002347843948
      target stat err =       0.004012469210
              std dev =       0.516380285234
             le_variance =       0.266648598978


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949017518722        initial
     9.3132e+11     9.3132e+12             9.9045e-17        -0.949017518722
     3.7253e+12     3.7253e+13             2.6856e-17        -0.949017518722  <--
     1.4901e+13     1.4901e+14             0.0000e+00        -0.949017518722

*****************************************************************************
Applying the update for shift_i =   3.7253e+12     and shift_s =   3.7253e+13
*****************************************************************************

  Execution time = 2.4585e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1179e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2023
    reference variance = 0.230747
====================================================
  Execution time = 1.6481e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7455e-01
  Total weights = 1.957690234e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.263335667836
                                         uncertainty =       0.001288084847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.263335667836
                                         uncertainty =       0.001288084847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000362889977
  error estimate for blocks of size 2^( 2) =       0.000376970778
  error estimate for blocks of size 2^( 3) =       0.000389406790
  error estimate for blocks of size 2^( 4) =       0.000398441650
  error estimate for blocks of size 2^( 5) =       0.000403641555
  error estimate for blocks of size 2^( 6) =       0.000406504573
  error estimate for blocks of size 2^( 7) =       0.000407317851

      target function =      -0.953976751529
              le_mean =     -17.211401488246
             les_mean =     296.506886741873
             stat err =       0.000403976407
             autocorr =       1.239258931064
   target nu stat err =       0.000403976407
   target dn stat err =       0.002096558294
      target stat err =       0.003629004544
              std dev =       0.513203927464
             le_variance =       0.263378271164


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721140148825e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953989466165       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953989466165       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953989466165       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953842440983       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953689537117       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953867478900       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953679116084       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952734229882       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.956270676642       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.954069721364       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.954299725570       residual = 7.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.953056344531       residual = 5.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.952656819061       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.954779826157       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.955148989160       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.955284857650       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.954122152686       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.954008632433       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.954542522761       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.953659212522       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.955172160263       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.953844874193       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.954805985876       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.954264094347       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.955503649213       residual = 6.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.954886160347       residual = 6.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.954584398971       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.952402552187       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.953419015912       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.954957757294       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.953555713210       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.953438105814       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.953855254760       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.953841812330       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.953602200311       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.951989858311       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.954818814900       residual = 9.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.955559795657       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.954060866211       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.953160464090       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.956396459909       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.952657260648       residual = 7.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.955870146803       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.953331474232       residual = 3.46e-04           smallest_sin_value = 9.98e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.953973737172       residual = 3.82e-04           smallest_sin_value = 9.98e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.956230845747       residual = 2.34e-04           smallest_sin_value = 9.95e-01
davidson iteration   46 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+11 is 1.356514e-16

solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953989466165       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953989466165       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953989466165       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953989466164       residual = 7.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.954426521609       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953989834930       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952363402253       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.959479167331       residual = 9.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.960638658971       residual = 4.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953959020100       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.950003436258       residual = 5.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.953953834703       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.954453730012       residual = 7.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.954342442719       residual = 3.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.954655501310       residual = 6.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.954406390598       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.953621411805       residual = 8.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.954011835484       residual = 9.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.953909425597       residual = 9.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.953403102560       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.953764273864       residual = 7.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.954186111218       residual = 1.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.954800613292       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.953278072428       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.953299392110       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.953817345475       residual = 1.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.953275645970       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.953077918159       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.954326262631       residual = 6.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.954148919030       residual = 6.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.954691584145       residual = 7.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.953425508703       residual = 3.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.953353114323       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.955764603475       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.954864533450       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.953607412871       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.952999045477       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.951050907333       residual = 1.84e-02           smallest_sin_value = 9.99e-01
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.954756561402       residual = 2.76e-02           smallest_sin_value = 9.98e-01
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.953310812266       residual = 9.45e-02           smallest_sin_value = 9.96e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+12 is 3.516495e-17

solving harmonic davidson linear method for identity shift 1.4901e+13, overlap shift 1.4901e+14 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953989466165       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953989466165       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.57e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.063352 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9017e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2266
    reference variance = 0.528738
====================================================
  Execution time = 1.3764e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7770e-01
  Total weights = 1.9574e+06
  Execution time = 1.8294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264971869227
                                         uncertainty =       0.001268306973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264971869227
                                         uncertainty =       0.001268306973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364000753
  error estimate for blocks of size 2^( 2) =       0.000378225826
  error estimate for blocks of size 2^( 3) =       0.000390963916
  error estimate for blocks of size 2^( 4) =       0.000400047673
  error estimate for blocks of size 2^( 5) =       0.000405504187
  error estimate for blocks of size 2^( 6) =       0.000406652390
  error estimate for blocks of size 2^( 7) =       0.000407264374

      target function =      -0.948651764260
              le_mean =     -17.211246194924
             les_mean =     296.504693537499
             stat err =       0.000404867156
             autocorr =       1.237144787287
   target nu stat err =       0.000404867156
   target dn stat err =       0.002214526861
      target stat err =       0.003782773893
              std dev =       0.514774801736
             le_variance =       0.264993096502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264971869227
                                         uncertainty =       0.001268306973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264971869227
                                         uncertainty =       0.001268306973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364000753
  error estimate for blocks of size 2^( 2) =       0.000378225826
  error estimate for blocks of size 2^( 3) =       0.000390963916
  error estimate for blocks of size 2^( 4) =       0.000400047673
  error estimate for blocks of size 2^( 5) =       0.000405504187
  error estimate for blocks of size 2^( 6) =       0.000406652390
  error estimate for blocks of size 2^( 7) =       0.000407264374

      target function =      -0.948651764260
              le_mean =     -17.211246194924
             les_mean =     296.504693537499
             stat err =       0.000404867156
             autocorr =       1.237144787285
   target nu stat err =       0.000404867156
   target dn stat err =       0.002214526861
      target stat err =       0.003782773893
              std dev =       0.514774801736
             le_variance =       0.264993096502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264971869227
                                         uncertainty =       0.001268306973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264971869227
                                         uncertainty =       0.001268306973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364000753
  error estimate for blocks of size 2^( 2) =       0.000378225826
  error estimate for blocks of size 2^( 3) =       0.000390963916
  error estimate for blocks of size 2^( 4) =       0.000400047673
  error estimate for blocks of size 2^( 5) =       0.000405504187
  error estimate for blocks of size 2^( 6) =       0.000406652390
  error estimate for blocks of size 2^( 7) =       0.000407264374

      target function =      -0.948651764259
              le_mean =     -17.211246194924
             les_mean =     296.504693537499
             stat err =       0.000404867156
             autocorr =       1.237144787291
   target nu stat err =       0.000404867156
   target dn stat err =       0.002214526861
      target stat err =       0.003782773893
              std dev =       0.514774801736
             le_variance =       0.264993096502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264971869227
                                         uncertainty =       0.001268306973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264971869227
                                         uncertainty =       0.001268306973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364000753
  error estimate for blocks of size 2^( 2) =       0.000378225826
  error estimate for blocks of size 2^( 3) =       0.000390963916
  error estimate for blocks of size 2^( 4) =       0.000400047673
  error estimate for blocks of size 2^( 5) =       0.000405504187
  error estimate for blocks of size 2^( 6) =       0.000406652390
  error estimate for blocks of size 2^( 7) =       0.000407264374

      target function =      -0.948651764260
              le_mean =     -17.211246194924
             les_mean =     296.504693537499
             stat err =       0.000404867156
             autocorr =       1.237144787287
   target nu stat err =       0.000404867156
   target dn stat err =       0.002214526861
      target stat err =       0.003782773893
              std dev =       0.514774801736
             le_variance =       0.264993096502


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948651764260        initial  <--
     9.3132e+11     9.3132e+12             1.3565e-16        -0.948651764260
     3.7253e+12     3.7253e+13             3.5165e-17        -0.948651764259
     1.4901e+13     1.4901e+14             0.0000e+00        -0.948651764260

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9989
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2252e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1561
    reference variance = 0.223866
====================================================
  Execution time = 1.4042e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7546e-01
  Total weights = 1.957528939e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4625e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264276892067
                                         uncertainty =       0.001405045358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264276892067
                                         uncertainty =       0.001405045358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363485737
  error estimate for blocks of size 2^( 2) =       0.000377476571
  error estimate for blocks of size 2^( 3) =       0.000390546254
  error estimate for blocks of size 2^( 4) =       0.000400052948
  error estimate for blocks of size 2^( 5) =       0.000406217825
  error estimate for blocks of size 2^( 6) =       0.000408390756
  error estimate for blocks of size 2^( 7) =       0.000409094474

      target function =      -0.952418463516
              le_mean =     -17.211257314830
             les_mean =     296.502841671533
             stat err =       0.000405939001
             autocorr =       1.247230748234
   target nu stat err =       0.000405939001
   target dn stat err =       0.001936861958
      target stat err =       0.003352952759
              std dev =       0.514046458890
             le_variance =       0.264243761897


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721125731483e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+12, overlap shift 9.3132e+13 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952429237845       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952429237845       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.04e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+13, overlap shift 3.7253e+14 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952429237845       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952429237845       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.04e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4901e+14, overlap shift 1.4901e+15 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952429237845       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952429237845       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.04e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.064360 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6511e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2431
    reference variance = 0.218668
====================================================
  Execution time = 1.3713e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8086e-01
  Total weights = 1.9571e+06
  Execution time = 1.8288e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268014590878
                                         uncertainty =       0.001792635566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268014590878
                                         uncertainty =       0.001792635566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366096688
  error estimate for blocks of size 2^( 2) =       0.000379788947
  error estimate for blocks of size 2^( 3) =       0.000392122843
  error estimate for blocks of size 2^( 4) =       0.000401789522
  error estimate for blocks of size 2^( 5) =       0.000407108892
  error estimate for blocks of size 2^( 6) =       0.000409350932
  error estimate for blocks of size 2^( 7) =       0.000412044959

      target function =      -0.943384223323
              le_mean =     -17.212046993710
             les_mean =     296.535422532910
             stat err =       0.000407573576
             autocorr =       1.239425534959
   target nu stat err =       0.000407573576
   target dn stat err =       0.002776883433
      target stat err =       0.004668506135
              std dev =       0.517738901983
             le_variance =       0.268053570626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268014590878
                                         uncertainty =       0.001792635566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268014590878
                                         uncertainty =       0.001792635566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366096688
  error estimate for blocks of size 2^( 2) =       0.000379788947
  error estimate for blocks of size 2^( 3) =       0.000392122843
  error estimate for blocks of size 2^( 4) =       0.000401789522
  error estimate for blocks of size 2^( 5) =       0.000407108892
  error estimate for blocks of size 2^( 6) =       0.000409350932
  error estimate for blocks of size 2^( 7) =       0.000412044959

      target function =      -0.943384223323
              le_mean =     -17.212046993710
             les_mean =     296.535422532910
             stat err =       0.000407573576
             autocorr =       1.239425534959
   target nu stat err =       0.000407573576
   target dn stat err =       0.002776883433
      target stat err =       0.004668506135
              std dev =       0.517738901983
             le_variance =       0.268053570626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268014590878
                                         uncertainty =       0.001792635566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268014590878
                                         uncertainty =       0.001792635566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366096688
  error estimate for blocks of size 2^( 2) =       0.000379788947
  error estimate for blocks of size 2^( 3) =       0.000392122843
  error estimate for blocks of size 2^( 4) =       0.000401789522
  error estimate for blocks of size 2^( 5) =       0.000407108892
  error estimate for blocks of size 2^( 6) =       0.000409350932
  error estimate for blocks of size 2^( 7) =       0.000412044959

      target function =      -0.943384223323
              le_mean =     -17.212046993710
             les_mean =     296.535422532910
             stat err =       0.000407573576
             autocorr =       1.239425534959
   target nu stat err =       0.000407573576
   target dn stat err =       0.002776883433
      target stat err =       0.004668506135
              std dev =       0.517738901983
             le_variance =       0.268053570626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268014590878
                                         uncertainty =       0.001792635566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268014590878
                                         uncertainty =       0.001792635566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366096688
  error estimate for blocks of size 2^( 2) =       0.000379788947
  error estimate for blocks of size 2^( 3) =       0.000392122843
  error estimate for blocks of size 2^( 4) =       0.000401789522
  error estimate for blocks of size 2^( 5) =       0.000407108892
  error estimate for blocks of size 2^( 6) =       0.000409350932
  error estimate for blocks of size 2^( 7) =       0.000412044959

      target function =      -0.943384223323
              le_mean =     -17.212046993710
             les_mean =     296.535422532910
             stat err =       0.000407573576
             autocorr =       1.239425534959
   target nu stat err =       0.000407573576
   target dn stat err =       0.002776883433
      target stat err =       0.004668506135
              std dev =       0.517738901983
             le_variance =       0.268053570626


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943384223323        initial  <--
     9.3132e+12     9.3132e+13             0.0000e+00        -0.943384223323
     3.7253e+13     3.7253e+14             0.0000e+00        -0.943384223323
     1.4901e+14     1.4901e+15             0.0000e+00        -0.943384223323

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9325
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9450e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2691
    reference variance = 0.236392
====================================================
  Execution time = 1.4204e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7922e-01
  Total weights = 1.957214327e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268020618962
                                         uncertainty =       0.001806809587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268020618962
                                         uncertainty =       0.001806809587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366080318
  error estimate for blocks of size 2^( 2) =       0.000380127326
  error estimate for blocks of size 2^( 3) =       0.000393000293
  error estimate for blocks of size 2^( 4) =       0.000401814217
  error estimate for blocks of size 2^( 5) =       0.000407274792
  error estimate for blocks of size 2^( 6) =       0.000411296348
  error estimate for blocks of size 2^( 7) =       0.000412074563

      target function =      -0.946129397514
              le_mean =     -17.212069056308
             les_mean =     296.534539764631
             stat err =       0.000408114980
             autocorr =       1.242831669623
   target nu stat err =       0.000408114980
   target dn stat err =       0.002193132683
      target stat err =       0.003734832736
              std dev =       0.517715751014
             le_variance =       0.268029598848


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721206905631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946143072889       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946143072889       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946143072889       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946143072889       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946143072828       residual = 3.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952681584094       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945493773564       residual = 6.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.126388917186       residual = 2.11e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.846035767208       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.813544532700       residual = 1.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918152249053       residual = 3.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.990600998564       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938148107248       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910644254604       residual = 7.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.134365280731       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951641020646       residual = 2.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944761910686       residual = 6.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926675203314       residual = 6.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937256977433       residual = 5.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945823864949       residual = 2.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.947818160479       residual = 1.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939925464003       residual = 5.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.954253114654       residual = 1.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949889143117       residual = 8.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.959079626739       residual = 6.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.933569093552       residual = 2.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.916164500294       residual = 4.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.939841274173       residual = 8.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938732610815       residual = 1.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.950532717980       residual = 5.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.953253592904       residual = 3.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.885672417916       residual = 1.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.925113268590       residual = 3.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939364494093       residual = 2.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.951868913627       residual = 2.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.920522370693       residual = 1.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934830573672       residual = 1.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.948813513130       residual = 6.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.949842894098       residual = 1.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.940817286224       residual = 1.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.950912333470       residual = 7.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.941200114236       residual = 6.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.939406448315       residual = 8.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.946417518866       residual = 1.48e+01           smallest_sin_value = 9.99e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.929709104318       residual = 1.01e+01           smallest_sin_value = 9.98e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.935402724512       residual = 5.91e+01           smallest_sin_value = 9.95e-01
davidson iteration   46 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+13 is 1.849308e-18

solving harmonic davidson linear method for identity shift 3.7253e+14, overlap shift 3.7253e+15 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946143072889       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946143072889       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946143072889       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946143072891       residual = 3.65e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946143072889       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to small subspace S singular value of 7.17e-01
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+14 is 3.839422e-19

solving harmonic davidson linear method for identity shift 1.4901e+15, overlap shift 1.4901e+16 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946143072889       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946143072889       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946143072889       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946143072894       residual = 6.25e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946143072889       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946143073421       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946143069886       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946406121045       residual = 2.52e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =       0.732496398453       residual = 1.75e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -1.621096237497       residual = 6.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -1.690224614268       residual = 1.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =       0.474225947377       residual = 2.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.000150308648       residual = 1.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       1.832887753794       residual = 5.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.085382571362       residual = 4.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.934817997347       residual = 2.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -1.543212248334       residual = 4.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -1.609891352290       residual = 5.21e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746152261958       residual = 8.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.998218612565       residual = 6.48e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -2.263311895899       residual = 4.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -2.783890258574       residual = 2.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.174994933596       residual = 2.73e+04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.273297859543       residual = 1.27e+04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.252314535401       residual = 9.49e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.504864996494       residual = 8.75e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.311924252949       residual = 5.43e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.263346275069       residual = 6.86e+04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.783813465989       residual = 2.72e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -2.841369265643       residual = 6.35e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.963814293568       residual = 2.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -2.498145180408       residual = 3.17e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.765772759279       residual = 3.68e+04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.149340064228       residual = 1.91e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.552930278730       residual = 2.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       0.023859351820       residual = 2.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.862490771648       residual = 3.38e+04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.810707710532       residual = 1.90e+04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       0.542411706769       residual = 1.00e+04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.585299591878       residual = 2.37e+04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.571880393978       residual = 1.69e+04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.822142620631       residual = 2.31e+04           smallest_sin_value = 9.99e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.326673146894       residual = 8.25e+02           smallest_sin_value = 9.98e-01
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.023980033864       residual = 3.49e+02           smallest_sin_value = 9.97e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.703129667253       residual = 1.46e+02           smallest_sin_value = 9.96e-01
davidson iteration   45 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         45 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+15 is 1.124087e-19

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.142036 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6763e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2645
    reference variance = 0.377619
====================================================
  Execution time = 1.3614e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7811e-01
  Total weights = 1.9572e+06
  Execution time = 1.8321e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266982745034
                                         uncertainty =       0.001444609251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266982745034
                                         uncertainty =       0.001444609251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365330401
  error estimate for blocks of size 2^( 2) =       0.000379024056
  error estimate for blocks of size 2^( 3) =       0.000391716057
  error estimate for blocks of size 2^( 4) =       0.000400792220
  error estimate for blocks of size 2^( 5) =       0.000406594371
  error estimate for blocks of size 2^( 6) =       0.000410748044
  error estimate for blocks of size 2^( 7) =       0.000412034271

      target function =      -0.947978806267
              le_mean =     -17.211709653565
             les_mean =     296.521055216984
             stat err =       0.000407542226
             autocorr =       1.244438963092
   target nu stat err =       0.000407542226
   target dn stat err =       0.002417317128
      target stat err =       0.004115912396
              std dev =       0.516655207830
             le_variance =       0.266932603778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266982745034
                                         uncertainty =       0.001444609251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266982745034
                                         uncertainty =       0.001444609251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365330401
  error estimate for blocks of size 2^( 2) =       0.000379024056
  error estimate for blocks of size 2^( 3) =       0.000391716057
  error estimate for blocks of size 2^( 4) =       0.000400792220
  error estimate for blocks of size 2^( 5) =       0.000406594371
  error estimate for blocks of size 2^( 6) =       0.000410748044
  error estimate for blocks of size 2^( 7) =       0.000412034271

      target function =      -0.947978806267
              le_mean =     -17.211709653565
             les_mean =     296.521055216984
             stat err =       0.000407542226
             autocorr =       1.244438963094
   target nu stat err =       0.000407542226
   target dn stat err =       0.002417317128
      target stat err =       0.004115912396
              std dev =       0.516655207830
             le_variance =       0.266932603778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266982745034
                                         uncertainty =       0.001444609251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266982745034
                                         uncertainty =       0.001444609251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365330401
  error estimate for blocks of size 2^( 2) =       0.000379024056
  error estimate for blocks of size 2^( 3) =       0.000391716057
  error estimate for blocks of size 2^( 4) =       0.000400792220
  error estimate for blocks of size 2^( 5) =       0.000406594371
  error estimate for blocks of size 2^( 6) =       0.000410748044
  error estimate for blocks of size 2^( 7) =       0.000412034271

      target function =      -0.947978806267
              le_mean =     -17.211709653565
             les_mean =     296.521055216984
             stat err =       0.000407542226
             autocorr =       1.244438963092
   target nu stat err =       0.000407542226
   target dn stat err =       0.002417317128
      target stat err =       0.004115912396
              std dev =       0.516655207830
             le_variance =       0.266932603778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266982745034
                                         uncertainty =       0.001444609251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266982745034
                                         uncertainty =       0.001444609251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365330401
  error estimate for blocks of size 2^( 2) =       0.000379024056
  error estimate for blocks of size 2^( 3) =       0.000391716057
  error estimate for blocks of size 2^( 4) =       0.000400792220
  error estimate for blocks of size 2^( 5) =       0.000406594371
  error estimate for blocks of size 2^( 6) =       0.000410748044
  error estimate for blocks of size 2^( 7) =       0.000412034271

      target function =      -0.947978806267
              le_mean =     -17.211709653565
             les_mean =     296.521055216984
             stat err =       0.000407542226
             autocorr =       1.244438963092
   target nu stat err =       0.000407542226
   target dn stat err =       0.002417317128
      target stat err =       0.004115912396
              std dev =       0.516655207830
             le_variance =       0.266932603778


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947978806267        initial
     9.3132e+13     9.3132e+14             1.8493e-18        -0.947978806267  <--
     3.7253e+14     3.7253e+15             3.8394e-19        -0.947978806267
     1.4901e+15     1.4901e+16             1.1241e-19        -0.947978806267

*****************************************************************************
Applying the update for shift_i =   9.3132e+13     and shift_s =   9.3132e+14
*****************************************************************************

  Execution time = 2.2917e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9686e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2352
    reference variance = 0.139327
====================================================
  Execution time = 1.4200e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8280e-01
  Total weights = 1.957414274e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271659501394
                                         uncertainty =       0.002013711807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271659501394
                                         uncertainty =       0.002013711807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368525252
  error estimate for blocks of size 2^( 2) =       0.000382338456
  error estimate for blocks of size 2^( 3) =       0.000395214527
  error estimate for blocks of size 2^( 4) =       0.000404481502
  error estimate for blocks of size 2^( 5) =       0.000410302009
  error estimate for blocks of size 2^( 6) =       0.000412110983
  error estimate for blocks of size 2^( 7) =       0.000412859147

      target function =      -0.940176004136
              le_mean =     -17.212342481984
             les_mean =     296.547538614620
             stat err =       0.000409938410
             autocorr =       1.237378945078
   target nu stat err =       0.000409938410
   target dn stat err =       0.002342028730
      target stat err =       0.003932742136
              std dev =       0.521173409057
             le_variance =       0.271621722308


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721234248198e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+13, overlap shift 2.3283e+14 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940191518314       residual = 9.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940191518314       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940191518314       residual = 9.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 7.05e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+13 is 5.501459e-18

solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940191518314       residual = 9.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940191518314       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940191518314       residual = 9.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 7.05e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+13 is 1.375365e-18

solving harmonic davidson linear method for identity shift 3.7253e+14, overlap shift 3.7253e+15 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940191518314       residual = 9.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940191518314       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940191518314       residual = 9.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 7.05e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+14 is 3.438412e-19

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.143367 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6691e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.1579
    reference variance = 0.148728
====================================================
  Execution time = 1.3563e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8351e-01
  Total weights = 1.9574e+06
  Execution time = 1.8228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269126694078
                                         uncertainty =       0.001664800393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269126694078
                                         uncertainty =       0.001664800393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366820877
  error estimate for blocks of size 2^( 2) =       0.000380640228
  error estimate for blocks of size 2^( 3) =       0.000392900328
  error estimate for blocks of size 2^( 4) =       0.000402190807
  error estimate for blocks of size 2^( 5) =       0.000408289993
  error estimate for blocks of size 2^( 6) =       0.000411268029
  error estimate for blocks of size 2^( 7) =       0.000413822940

      target function =      -0.938993415779
              le_mean =     -17.212537545635
             les_mean =     296.554959648689
             stat err =       0.000408892942
             autocorr =       1.242542177063
   target nu stat err =       0.000408892942
   target dn stat err =       0.003548084213
      target stat err =       0.005888696172
              std dev =       0.518763058840
             le_variance =       0.269115111217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269126694078
                                         uncertainty =       0.001664800393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269126694078
                                         uncertainty =       0.001664800393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366820877
  error estimate for blocks of size 2^( 2) =       0.000380640228
  error estimate for blocks of size 2^( 3) =       0.000392900328
  error estimate for blocks of size 2^( 4) =       0.000402190807
  error estimate for blocks of size 2^( 5) =       0.000408289993
  error estimate for blocks of size 2^( 6) =       0.000411268029
  error estimate for blocks of size 2^( 7) =       0.000413822940

      target function =      -0.938993415779
              le_mean =     -17.212537545635
             les_mean =     296.554959648689
             stat err =       0.000408892942
             autocorr =       1.242542177063
   target nu stat err =       0.000408892942
   target dn stat err =       0.003548084213
      target stat err =       0.005888696172
              std dev =       0.518763058840
             le_variance =       0.269115111217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269126694078
                                         uncertainty =       0.001664800393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269126694078
                                         uncertainty =       0.001664800393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366820877
  error estimate for blocks of size 2^( 2) =       0.000380640228
  error estimate for blocks of size 2^( 3) =       0.000392900328
  error estimate for blocks of size 2^( 4) =       0.000402190807
  error estimate for blocks of size 2^( 5) =       0.000408289993
  error estimate for blocks of size 2^( 6) =       0.000411268029
  error estimate for blocks of size 2^( 7) =       0.000413822940

      target function =      -0.938993415779
              le_mean =     -17.212537545635
             les_mean =     296.554959648688
             stat err =       0.000408892942
             autocorr =       1.242542177061
   target nu stat err =       0.000408892942
   target dn stat err =       0.003548084213
      target stat err =       0.005888696172
              std dev =       0.518763058840
             le_variance =       0.269115111217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269126694078
                                         uncertainty =       0.001664800393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269126694078
                                         uncertainty =       0.001664800393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366820877
  error estimate for blocks of size 2^( 2) =       0.000380640228
  error estimate for blocks of size 2^( 3) =       0.000392900328
  error estimate for blocks of size 2^( 4) =       0.000402190807
  error estimate for blocks of size 2^( 5) =       0.000408289993
  error estimate for blocks of size 2^( 6) =       0.000411268029
  error estimate for blocks of size 2^( 7) =       0.000413822940

      target function =      -0.938993415779
              le_mean =     -17.212537545635
             les_mean =     296.554959648689
             stat err =       0.000408892942
             autocorr =       1.242542177063
   target nu stat err =       0.000408892942
   target dn stat err =       0.003548084213
      target stat err =       0.005888696172
              std dev =       0.518763058840
             le_variance =       0.269115111217


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938993415779        initial
     2.3283e+13     2.3283e+14             5.5015e-18        -0.938993415779
     9.3132e+13     9.3132e+14             1.3754e-18        -0.938993415779  <--
     3.7253e+14     3.7253e+15             3.4384e-19        -0.938993415779

*****************************************************************************
Applying the update for shift_i =   9.3132e+13     and shift_s =   9.3132e+14
*****************************************************************************

  Execution time = 2.2759e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9461e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2136
    reference variance = 0.278179
====================================================
  Execution time = 1.3975e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7843e-01
  Total weights = 1.957476876e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4868e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267353931661
                                         uncertainty =       0.001592923271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267353931661
                                         uncertainty =       0.001592923271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365615432
  error estimate for blocks of size 2^( 2) =       0.000379608884
  error estimate for blocks of size 2^( 3) =       0.000392628177
  error estimate for blocks of size 2^( 4) =       0.000401939773
  error estimate for blocks of size 2^( 5) =       0.000408114759
  error estimate for blocks of size 2^( 6) =       0.000410541912
  error estimate for blocks of size 2^( 7) =       0.000413038382

      target function =      -0.947439083156
              le_mean =     -17.211987933478
             les_mean =     296.530963503734
             stat err =       0.000408408706
             autocorr =       1.247788412325
   target nu stat err =       0.000408408706
   target dn stat err =       0.002157694135
      target stat err =       0.003686279323
              std dev =       0.517058301893
             le_variance =       0.267349287556


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721198793348e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+13, overlap shift 2.3283e+14 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947452222892       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947452222892       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947452222892       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 7.06e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+13 is 3.401575e-18

solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947452222892       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947452222892       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947452222892       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 7.06e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+13 is 8.503937e-19

solving harmonic davidson linear method for identity shift 3.7253e+14, overlap shift 3.7253e+15 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947452222892       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947452222892       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947452222892       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.769466232757       residual = 9.38e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.030758233599       residual = 2.54e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.800913386602       residual = 9.38e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -1.116534305512       residual = 9.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.155959527923       residual = 5.02e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.337148582573       residual = 2.94e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.533551707963       residual = 1.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -1.523506168570       residual = 3.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.289846220442       residual = 1.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.772051715600       residual = 1.07e+03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.768786895853       residual = 7.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.986979200257       residual = 1.32e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.524134192223       residual = 2.58e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.988543716654       residual = 9.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.678469839083       residual = 1.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -1.463427432814       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.119956061646       residual = 7.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.083674919545       residual = 7.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.850028061455       residual = 4.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       0.096899972308       residual = 2.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.900427419251       residual = 2.99e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.809746056042       residual = 5.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.077775894986       residual = 1.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.181084781278       residual = 5.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951870312158       residual = 1.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.597945107592       residual = 1.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.908007230246       residual = 2.87e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.304467916977       residual = 5.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.903074829042       residual = 1.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.380627715150       residual = 9.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.173986433103       residual = 4.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.084333834293       residual = 1.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.954688435616       residual = 1.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.773733618201       residual = 4.28e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.209164622418       residual = 4.33e+03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.719381912613       residual = 4.80e+03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.660896126490       residual = 3.26e+03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.509213103988       residual = 4.12e+03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.494707704563       residual = 4.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.573276863637       residual = 7.57e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.125962561265       residual = 1.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -1.296729640121       residual = 2.70e+03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.693027843158       residual = 7.41e+01           smallest_sin_value = 9.98e-01
davidson iteration   46:   krylov dim =  47   tar_fn =       0.219121528145       residual = 5.38e+01           smallest_sin_value = 9.98e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.572186168816       residual = 3.02e+01           smallest_sin_value = 9.97e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.532746714689       residual = 2.60e+01           smallest_sin_value = 9.96e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.047459542306       residual = 3.92e+01           smallest_sin_value = 9.93e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.77e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+14 is 2.125984e-19

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.194528 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6518e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2561
    reference variance = 0.198709
====================================================
  Execution time = 1.3670e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7775e-01
  Total weights = 1.9575e+06
  Execution time = 1.8247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265833013494
                                         uncertainty =       0.001710059596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265833013494
                                         uncertainty =       0.001710059596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364549395
  error estimate for blocks of size 2^( 2) =       0.000378064380
  error estimate for blocks of size 2^( 3) =       0.000390456174
  error estimate for blocks of size 2^( 4) =       0.000399393146
  error estimate for blocks of size 2^( 5) =       0.000404320777
  error estimate for blocks of size 2^( 6) =       0.000407603187
  error estimate for blocks of size 2^( 7) =       0.000409123093

      target function =      -0.948589159733
              le_mean =     -17.212141408878
             les_mean =     296.535559518199
             stat err =       0.000405110051
             autocorr =       1.234904209631
   target nu stat err =       0.000405110051
   target dn stat err =       0.002652036416
      target stat err =       0.004512529900
              std dev =       0.515550699191
             le_variance =       0.265792523437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265833013494
                                         uncertainty =       0.001710059596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265833013494
                                         uncertainty =       0.001710059596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364549395
  error estimate for blocks of size 2^( 2) =       0.000378064380
  error estimate for blocks of size 2^( 3) =       0.000390456174
  error estimate for blocks of size 2^( 4) =       0.000399393146
  error estimate for blocks of size 2^( 5) =       0.000404320777
  error estimate for blocks of size 2^( 6) =       0.000407603187
  error estimate for blocks of size 2^( 7) =       0.000409123093

      target function =      -0.948589159733
              le_mean =     -17.212141408878
             les_mean =     296.535559518199
             stat err =       0.000405110051
             autocorr =       1.234904209631
   target nu stat err =       0.000405110051
   target dn stat err =       0.002652036416
      target stat err =       0.004512529900
              std dev =       0.515550699191
             le_variance =       0.265792523437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265833013494
                                         uncertainty =       0.001710059596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265833013494
                                         uncertainty =       0.001710059596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364549395
  error estimate for blocks of size 2^( 2) =       0.000378064380
  error estimate for blocks of size 2^( 3) =       0.000390456174
  error estimate for blocks of size 2^( 4) =       0.000399393146
  error estimate for blocks of size 2^( 5) =       0.000404320777
  error estimate for blocks of size 2^( 6) =       0.000407603187
  error estimate for blocks of size 2^( 7) =       0.000409123093

      target function =      -0.948589159733
              le_mean =     -17.212141408878
             les_mean =     296.535559518199
             stat err =       0.000405110051
             autocorr =       1.234904209631
   target nu stat err =       0.000405110051
   target dn stat err =       0.002652036416
      target stat err =       0.004512529900
              std dev =       0.515550699191
             le_variance =       0.265792523437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265833013494
                                         uncertainty =       0.001710059596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265833013494
                                         uncertainty =       0.001710059596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364549395
  error estimate for blocks of size 2^( 2) =       0.000378064380
  error estimate for blocks of size 2^( 3) =       0.000390456174
  error estimate for blocks of size 2^( 4) =       0.000399393146
  error estimate for blocks of size 2^( 5) =       0.000404320777
  error estimate for blocks of size 2^( 6) =       0.000407603187
  error estimate for blocks of size 2^( 7) =       0.000409123093

      target function =      -0.948589159733
              le_mean =     -17.212141408878
             les_mean =     296.535559518199
             stat err =       0.000405110051
             autocorr =       1.234904209631
   target nu stat err =       0.000405110051
   target dn stat err =       0.002652036416
      target stat err =       0.004512529900
              std dev =       0.515550699191
             le_variance =       0.265792523437


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948589159733        initial
     2.3283e+13     2.3283e+14             3.4016e-18        -0.948589159733
     9.3132e+13     9.3132e+14             8.5039e-19        -0.948589159733  <--
     3.7253e+14     3.7253e+15             2.1260e-19        -0.948589159733

*****************************************************************************
Applying the update for shift_i =   9.3132e+13     and shift_s =   9.3132e+14
*****************************************************************************

  Execution time = 2.2921e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9445e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.166
    reference variance = 0.175655
====================================================
  Execution time = 1.3868e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7689e-01
  Total weights = 1.957272765e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266727065161
                                         uncertainty =       0.001627115113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266727065161
                                         uncertainty =       0.001627115113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365235766
  error estimate for blocks of size 2^( 2) =       0.000378902522
  error estimate for blocks of size 2^( 3) =       0.000392012687
  error estimate for blocks of size 2^( 4) =       0.000401542654
  error estimate for blocks of size 2^( 5) =       0.000406938111
  error estimate for blocks of size 2^( 6) =       0.000409471285
  error estimate for blocks of size 2^( 7) =       0.000410899005

      target function =      -0.950005176695
              le_mean =     -17.211110796890
             les_mean =     296.499225009476
             stat err =       0.000407212764
             autocorr =       1.243071657367
   target nu stat err =       0.000407212764
   target dn stat err =       0.002102241623
      target stat err =       0.003608000014
              std dev =       0.516521374333
             le_variance =       0.266794330143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721111079689e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+13, overlap shift 2.3283e+14 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950017915405       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950017915405       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950017915405       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950017915405       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+14, overlap shift 3.7253e+15 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950017915405       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950017915405       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.195567 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6394e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.3085
    reference variance = 1.59178
====================================================
  Execution time = 1.3776e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7959e-01
  Total weights = 1.9572e+06
  Execution time = 1.8277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264468774517
                                         uncertainty =       0.001338930596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264468774517
                                         uncertainty =       0.001338930596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363752231
  error estimate for blocks of size 2^( 2) =       0.000377519425
  error estimate for blocks of size 2^( 3) =       0.000390015609
  error estimate for blocks of size 2^( 4) =       0.000400040336
  error estimate for blocks of size 2^( 5) =       0.000405224754
  error estimate for blocks of size 2^( 6) =       0.000408854804
  error estimate for blocks of size 2^( 7) =       0.000410532146

      target function =      -0.945496478410
              le_mean =     -17.212179738143
             les_mean =     296.538719141348
             stat err =       0.000406163010
             autocorr =       1.246778797149
   target nu stat err =       0.000406163010
   target dn stat err =       0.003346823082
      target stat err =       0.005632000145
              std dev =       0.514423337743
             le_variance =       0.264631370415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264468774517
                                         uncertainty =       0.001338930596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264468774517
                                         uncertainty =       0.001338930596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363752231
  error estimate for blocks of size 2^( 2) =       0.000377519425
  error estimate for blocks of size 2^( 3) =       0.000390015609
  error estimate for blocks of size 2^( 4) =       0.000400040336
  error estimate for blocks of size 2^( 5) =       0.000405224754
  error estimate for blocks of size 2^( 6) =       0.000408854804
  error estimate for blocks of size 2^( 7) =       0.000410532146

      target function =      -0.945496478410
              le_mean =     -17.212179738143
             les_mean =     296.538719141348
             stat err =       0.000406163010
             autocorr =       1.246778797150
   target nu stat err =       0.000406163010
   target dn stat err =       0.003346823082
      target stat err =       0.005632000145
              std dev =       0.514423337743
             le_variance =       0.264631370415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264468774517
                                         uncertainty =       0.001338930596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264468774517
                                         uncertainty =       0.001338930596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363752231
  error estimate for blocks of size 2^( 2) =       0.000377519425
  error estimate for blocks of size 2^( 3) =       0.000390015609
  error estimate for blocks of size 2^( 4) =       0.000400040336
  error estimate for blocks of size 2^( 5) =       0.000405224754
  error estimate for blocks of size 2^( 6) =       0.000408854804
  error estimate for blocks of size 2^( 7) =       0.000410532146

      target function =      -0.945496478410
              le_mean =     -17.212179738143
             les_mean =     296.538719141348
             stat err =       0.000406163010
             autocorr =       1.246778797150
   target nu stat err =       0.000406163010
   target dn stat err =       0.003346823082
      target stat err =       0.005632000145
              std dev =       0.514423337743
             le_variance =       0.264631370415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264468774517
                                         uncertainty =       0.001338930596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264468774517
                                         uncertainty =       0.001338930596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363752231
  error estimate for blocks of size 2^( 2) =       0.000377519425
  error estimate for blocks of size 2^( 3) =       0.000390015609
  error estimate for blocks of size 2^( 4) =       0.000400040336
  error estimate for blocks of size 2^( 5) =       0.000405224754
  error estimate for blocks of size 2^( 6) =       0.000408854804
  error estimate for blocks of size 2^( 7) =       0.000410532146

      target function =      -0.945496478410
              le_mean =     -17.212179738143
             les_mean =     296.538719141348
             stat err =       0.000406163010
             autocorr =       1.246778797150
   target nu stat err =       0.000406163010
   target dn stat err =       0.003346823082
      target stat err =       0.005632000145
              std dev =       0.514423337743
             le_variance =       0.264631370415


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945496478410        initial  <--
     2.3283e+13     2.3283e+14             0.0000e+00        -0.945496478410
     9.3132e+13     9.3132e+14             0.0000e+00        -0.945496478410
     3.7253e+14     3.7253e+15             0.0000e+00        -0.945496478410

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9859
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9386e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2457
    reference variance = 0.279478
====================================================
  Execution time = 1.3992e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7826e-01
  Total weights = 1.957349736e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267218218311
                                         uncertainty =       0.001417930833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267218218311
                                         uncertainty =       0.001417930833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365547477
  error estimate for blocks of size 2^( 2) =       0.000379368650
  error estimate for blocks of size 2^( 3) =       0.000391780247
  error estimate for blocks of size 2^( 4) =       0.000401007655
  error estimate for blocks of size 2^( 5) =       0.000406847245
  error estimate for blocks of size 2^( 6) =       0.000409976976
  error estimate for blocks of size 2^( 7) =       0.000411523520

      target function =      -0.947732966405
              le_mean =     -17.211968144924
             les_mean =     296.530105309231
             stat err =       0.000407338849
             autocorr =       1.241721164084
   target nu stat err =       0.000407338849
   target dn stat err =       0.002308138494
      target stat err =       0.003935665317
              std dev =       0.516962199124
             le_variance =       0.267249915323


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721196814492e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+14, overlap shift 2.3283e+15 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947748296092       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947748296092       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947748296092       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947748296093       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947748320779       residual = 4.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.644298628565       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.974013001570       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.707034011061       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.013741634214       residual = 6.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.807240532980       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -1.184950150399       residual = 8.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.083110760037       residual = 1.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.086619302992       residual = 1.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.862647179554       residual = 5.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.966295813129       residual = 9.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916325232295       residual = 1.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.880857991529       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934394419774       residual = 2.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.813241057127       residual = 5.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.259066374103       residual = 2.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.012112408062       residual = 1.22e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.114607277322       residual = 7.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.928720369174       residual = 7.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.895697757802       residual = 2.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.018000418930       residual = 6.60e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.804342359933       residual = 2.44e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.996752153540       residual = 1.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.989531278969       residual = 6.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.968506007213       residual = 5.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.091753631050       residual = 1.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.976574643119       residual = 1.99e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.828382378206       residual = 2.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.968513734858       residual = 5.85e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.918340939972       residual = 7.21e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.945995278542       residual = 4.15e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.947348752568       residual = 3.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.925497536594       residual = 4.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.009794331964       residual = 2.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.964843835768       residual = 1.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.866752697253       residual = 2.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.043609872158       residual = 4.63e+02           smallest_sin_value = 9.98e-01
davidson iteration   41: stopping due to imaginary component in cost function
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+14 is 5.587579e-19

solving harmonic davidson linear method for identity shift 9.3132e+14, overlap shift 9.3132e+15 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947748296092       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947748296092       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947748296092       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.980394819782       residual = 2.76e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.220080985405       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -1.707504240860       residual = 5.90e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.871153598678       residual = 1.40e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.337864977390       residual = 1.11e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.393531772377       residual = 3.00e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =       1.270004591785       residual = 3.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -5.283565114354       residual = 1.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =       0.716115838188       residual = 1.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.332692475702       residual = 1.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.739582796921       residual = 1.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.641681621515       residual = 5.68e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.986616309927       residual = 1.34e+03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -1.017728288351       residual = 3.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.868372572072       residual = 3.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.862286845725       residual = 1.17e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.372191007113       residual = 2.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.286041162922       residual = 5.03e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.041584129889       residual = 1.31e+04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.852246819679       residual = 1.28e+04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =       0.081043779023       residual = 1.08e+04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.097108124819       residual = 2.92e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.526463219987       residual = 2.12e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.766784267540       residual = 2.42e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.126032747803       residual = 3.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928325641640       residual = 3.89e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.479882601002       residual = 4.14e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.660350009307       residual = 1.76e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.340673337428       residual = 2.90e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.413925166432       residual = 3.89e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.168247315601       residual = 2.13e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.791894471722       residual = 3.25e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.075608044458       residual = 4.58e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.660176006022       residual = 3.63e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.730887266813       residual = 3.40e+03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -1.243536061828       residual = 4.46e+03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       0.478521886090       residual = 3.05e+03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.771785689517       residual = 4.85e+03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.249139647920       residual = 1.73e+03           smallest_sin_value = 9.99e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.484876581629       residual = 9.66e+03           smallest_sin_value = 9.99e-01
davidson iteration   43:   krylov dim =  44   tar_fn =      -1.512710413992       residual = 5.39e+03           smallest_sin_value = 9.96e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -1.760732882374       residual = 3.68e+02           smallest_sin_value = 9.94e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.138479358663       residual = 1.02e+04           smallest_sin_value = 9.93e-01
davidson iteration   46 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+14 is 1.607727e-19

solving harmonic davidson linear method for identity shift 3.7253e+15, overlap shift 3.7253e+16 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947748296092       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947748296092       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947748296092       residual = 1.02e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947748296092       residual = 2.52e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934943648158       residual = 3.97e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -1.132816552057       residual = 5.73e+02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.631539698988       residual = 1.55e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =       1.481317168477       residual = 4.04e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =       2.040102170884       residual = 3.05e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -4.524126263990       residual = 1.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       0.226585755912       residual = 2.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   11 stopping due to too large eigenvalue change
davidson solver did not converge after         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+15 is 3.492237e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.276556 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6605e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.3017
    reference variance = 0.155895
====================================================
  Execution time = 1.3550e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8340e-01
  Total weights = 1.9575e+06
  Execution time = 1.8280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269447525302
                                         uncertainty =       0.001948583742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269447525302
                                         uncertainty =       0.001948583742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367039440
  error estimate for blocks of size 2^( 2) =       0.000381095128
  error estimate for blocks of size 2^( 3) =       0.000394149130
  error estimate for blocks of size 2^( 4) =       0.000403498927
  error estimate for blocks of size 2^( 5) =       0.000408576715
  error estimate for blocks of size 2^( 6) =       0.000412531689
  error estimate for blocks of size 2^( 7) =       0.000415091785

      target function =      -0.939177515470
              le_mean =     -17.211043793949
             les_mean =     296.503424348051
             stat err =       0.000409924779
             autocorr =       1.247334331692
   target nu stat err =       0.000409924779
   target dn stat err =       0.002888159777
      target stat err =       0.004800182518
              std dev =       0.519072153500
             le_variance =       0.269435900539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269447525302
                                         uncertainty =       0.001948583742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269447525302
                                         uncertainty =       0.001948583742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367039440
  error estimate for blocks of size 2^( 2) =       0.000381095128
  error estimate for blocks of size 2^( 3) =       0.000394149130
  error estimate for blocks of size 2^( 4) =       0.000403498927
  error estimate for blocks of size 2^( 5) =       0.000408576715
  error estimate for blocks of size 2^( 6) =       0.000412531689
  error estimate for blocks of size 2^( 7) =       0.000415091785

      target function =      -0.939177515470
              le_mean =     -17.211043793949
             les_mean =     296.503424348051
             stat err =       0.000409924779
             autocorr =       1.247334331690
   target nu stat err =       0.000409924779
   target dn stat err =       0.002888159777
      target stat err =       0.004800182518
              std dev =       0.519072153500
             le_variance =       0.269435900539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269447525302
                                         uncertainty =       0.001948583742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269447525302
                                         uncertainty =       0.001948583742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367039440
  error estimate for blocks of size 2^( 2) =       0.000381095128
  error estimate for blocks of size 2^( 3) =       0.000394149130
  error estimate for blocks of size 2^( 4) =       0.000403498927
  error estimate for blocks of size 2^( 5) =       0.000408576715
  error estimate for blocks of size 2^( 6) =       0.000412531689
  error estimate for blocks of size 2^( 7) =       0.000415091785

      target function =      -0.939177515470
              le_mean =     -17.211043793949
             les_mean =     296.503424348051
             stat err =       0.000409924779
             autocorr =       1.247334331690
   target nu stat err =       0.000409924779
   target dn stat err =       0.002888159777
      target stat err =       0.004800182518
              std dev =       0.519072153500
             le_variance =       0.269435900539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269447525302
                                         uncertainty =       0.001948583742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269447525302
                                         uncertainty =       0.001948583742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367039440
  error estimate for blocks of size 2^( 2) =       0.000381095128
  error estimate for blocks of size 2^( 3) =       0.000394149130
  error estimate for blocks of size 2^( 4) =       0.000403498927
  error estimate for blocks of size 2^( 5) =       0.000408576715
  error estimate for blocks of size 2^( 6) =       0.000412531689
  error estimate for blocks of size 2^( 7) =       0.000415091785

      target function =      -0.939177515470
              le_mean =     -17.211043793949
             les_mean =     296.503424348051
             stat err =       0.000409924779
             autocorr =       1.247334331690
   target nu stat err =       0.000409924779
   target dn stat err =       0.002888159777
      target stat err =       0.004800182518
              std dev =       0.519072153500
             le_variance =       0.269435900539


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939177515470        initial  <--
     2.3283e+14     2.3283e+15             5.5876e-19        -0.939177515470
     9.3132e+14     9.3132e+15             1.6077e-19        -0.939177515470
     3.7253e+15     3.7253e+16             3.4922e-20        -0.939177515470

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7714
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9409e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2915
    reference variance = 0.238541
====================================================
  Execution time = 1.6148e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8269e-01
  Total weights = 1.957133299e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4846e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268818339891
                                         uncertainty =       0.001680728052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268818339891
                                         uncertainty =       0.001680728052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366592158
  error estimate for blocks of size 2^( 2) =       0.000380410185
  error estimate for blocks of size 2^( 3) =       0.000392960732
  error estimate for blocks of size 2^( 4) =       0.000401946426
  error estimate for blocks of size 2^( 5) =       0.000409006267
  error estimate for blocks of size 2^( 6) =       0.000411523814
  error estimate for blocks of size 2^( 7) =       0.000413290904

      target function =      -0.940315027669
              le_mean =     -17.211084053203
             les_mean =     296.504107326048
             stat err =       0.000408941853
             autocorr =       1.244390767971
   target nu stat err =       0.000408941853
   target dn stat err =       0.003890935066
      target stat err =       0.006450241480
              std dev =       0.518439601504
             le_variance =       0.268779620407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721108405320e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+15, overlap shift 2.3283e+16 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940358053286       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940358053286       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+15, overlap shift 9.3132e+16 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940358053286       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940358053286       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+16, overlap shift 3.7253e+17 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940358053286       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940358053286       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.277597 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8639e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2779
    reference variance = 0.336528
====================================================
  Execution time = 1.6159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8000e-01
  Total weights = 1.9572e+06
  Execution time = 1.8186e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267798058340
                                         uncertainty =       0.001686229881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267798058340
                                         uncertainty =       0.001686229881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365920302
  error estimate for blocks of size 2^( 2) =       0.000379951449
  error estimate for blocks of size 2^( 3) =       0.000392254782
  error estimate for blocks of size 2^( 4) =       0.000401241890
  error estimate for blocks of size 2^( 5) =       0.000406807606
  error estimate for blocks of size 2^( 6) =       0.000409793476
  error estimate for blocks of size 2^( 7) =       0.000409252055

      target function =      -0.944819011209
              le_mean =     -17.211909186244
             les_mean =     296.529820304061
             stat err =       0.000406773757
             autocorr =       1.235756323191
   target nu stat err =       0.000406773757
   target dn stat err =       0.002099214451
      target stat err =       0.003569720489
              std dev =       0.517489453940
             le_variance =       0.267795334939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267798058340
                                         uncertainty =       0.001686229881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267798058340
                                         uncertainty =       0.001686229881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365920302
  error estimate for blocks of size 2^( 2) =       0.000379951449
  error estimate for blocks of size 2^( 3) =       0.000392254782
  error estimate for blocks of size 2^( 4) =       0.000401241890
  error estimate for blocks of size 2^( 5) =       0.000406807606
  error estimate for blocks of size 2^( 6) =       0.000409793476
  error estimate for blocks of size 2^( 7) =       0.000409252055

      target function =      -0.944819011209
              le_mean =     -17.211909186244
             les_mean =     296.529820304061
             stat err =       0.000406773757
             autocorr =       1.235756323191
   target nu stat err =       0.000406773757
   target dn stat err =       0.002099214451
      target stat err =       0.003569720489
              std dev =       0.517489453940
             le_variance =       0.267795334939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267798058340
                                         uncertainty =       0.001686229881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267798058340
                                         uncertainty =       0.001686229881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365920302
  error estimate for blocks of size 2^( 2) =       0.000379951449
  error estimate for blocks of size 2^( 3) =       0.000392254782
  error estimate for blocks of size 2^( 4) =       0.000401241890
  error estimate for blocks of size 2^( 5) =       0.000406807606
  error estimate for blocks of size 2^( 6) =       0.000409793476
  error estimate for blocks of size 2^( 7) =       0.000409252055

      target function =      -0.944819011209
              le_mean =     -17.211909186244
             les_mean =     296.529820304061
             stat err =       0.000406773757
             autocorr =       1.235756323191
   target nu stat err =       0.000406773757
   target dn stat err =       0.002099214451
      target stat err =       0.003569720489
              std dev =       0.517489453940
             le_variance =       0.267795334939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267798058340
                                         uncertainty =       0.001686229881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267798058340
                                         uncertainty =       0.001686229881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365920302
  error estimate for blocks of size 2^( 2) =       0.000379951449
  error estimate for blocks of size 2^( 3) =       0.000392254782
  error estimate for blocks of size 2^( 4) =       0.000401241890
  error estimate for blocks of size 2^( 5) =       0.000406807606
  error estimate for blocks of size 2^( 6) =       0.000409793476
  error estimate for blocks of size 2^( 7) =       0.000409252055

      target function =      -0.944819011209
              le_mean =     -17.211909186244
             les_mean =     296.529820304061
             stat err =       0.000406773757
             autocorr =       1.235756323191
   target nu stat err =       0.000406773757
   target dn stat err =       0.002099214451
      target stat err =       0.003569720489
              std dev =       0.517489453940
             le_variance =       0.267795334939


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944819011209        initial  <--
     2.3283e+15     2.3283e+16             0.0000e+00        -0.944819011209
     9.3132e+15     9.3132e+16             0.0000e+00        -0.944819011209
     3.7253e+16     3.7253e+17             0.0000e+00        -0.944819011209

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.3563
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4018e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1758
    reference variance = 0.376719
====================================================
  Execution time = 1.4128e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7664e-01
  Total weights = 1.957545875e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266878736472
                                         uncertainty =       0.001383469096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266878736472
                                         uncertainty =       0.001383469096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365271348
  error estimate for blocks of size 2^( 2) =       0.000379424946
  error estimate for blocks of size 2^( 3) =       0.000392165129
  error estimate for blocks of size 2^( 4) =       0.000401942329
  error estimate for blocks of size 2^( 5) =       0.000407713635
  error estimate for blocks of size 2^( 6) =       0.000410357698
  error estimate for blocks of size 2^( 7) =       0.000412502884

      target function =      -0.950470918264
              le_mean =     -17.212074602096
             les_mean =     296.532147123187
             stat err =       0.000408129137
             autocorr =       1.248429399929
   target nu stat err =       0.000408129137
   target dn stat err =       0.001790172555
      target stat err =       0.003104456934
              std dev =       0.516571693634
             le_variance =       0.266846314664


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721207460210e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+16, overlap shift 2.3283e+17 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950480101644       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950480101644       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.11e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+16, overlap shift 9.3132e+17 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950480101644       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950480101644       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.11e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+17, overlap shift 3.7253e+18 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950480101644       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950480101644       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.11e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+17 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.278645 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6600e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.275
    reference variance = 0.220951
====================================================
  Execution time = 1.3882e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8042e-01
  Total weights = 1.9574e+06
  Execution time = 1.8279e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267710469825
                                         uncertainty =       0.001571212270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267710469825
                                         uncertainty =       0.001571212270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365860078
  error estimate for blocks of size 2^( 2) =       0.000379575378
  error estimate for blocks of size 2^( 3) =       0.000392483272
  error estimate for blocks of size 2^( 4) =       0.000401865453
  error estimate for blocks of size 2^( 5) =       0.000406767921
  error estimate for blocks of size 2^( 6) =       0.000410566207
  error estimate for blocks of size 2^( 7) =       0.000410043077

      target function =      -0.944123437665
              le_mean =     -17.211756484123
             les_mean =     296.524978906100
             stat err =       0.000407310665
             autocorr =       1.239428610324
   target nu stat err =       0.000407310665
   target dn stat err =       0.002192380364
      target stat err =       0.003715637313
              std dev =       0.517404284602
             le_variance =       0.267707193724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267710469825
                                         uncertainty =       0.001571212270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267710469825
                                         uncertainty =       0.001571212270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365860078
  error estimate for blocks of size 2^( 2) =       0.000379575378
  error estimate for blocks of size 2^( 3) =       0.000392483272
  error estimate for blocks of size 2^( 4) =       0.000401865453
  error estimate for blocks of size 2^( 5) =       0.000406767921
  error estimate for blocks of size 2^( 6) =       0.000410566207
  error estimate for blocks of size 2^( 7) =       0.000410043077

      target function =      -0.944123437665
              le_mean =     -17.211756484123
             les_mean =     296.524978906100
             stat err =       0.000407310665
             autocorr =       1.239428610324
   target nu stat err =       0.000407310665
   target dn stat err =       0.002192380364
      target stat err =       0.003715637313
              std dev =       0.517404284602
             le_variance =       0.267707193724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267710469825
                                         uncertainty =       0.001571212270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267710469825
                                         uncertainty =       0.001571212270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365860078
  error estimate for blocks of size 2^( 2) =       0.000379575378
  error estimate for blocks of size 2^( 3) =       0.000392483272
  error estimate for blocks of size 2^( 4) =       0.000401865453
  error estimate for blocks of size 2^( 5) =       0.000406767921
  error estimate for blocks of size 2^( 6) =       0.000410566207
  error estimate for blocks of size 2^( 7) =       0.000410043077

      target function =      -0.944123437665
              le_mean =     -17.211756484123
             les_mean =     296.524978906100
             stat err =       0.000407310665
             autocorr =       1.239428610324
   target nu stat err =       0.000407310665
   target dn stat err =       0.002192380364
      target stat err =       0.003715637313
              std dev =       0.517404284602
             le_variance =       0.267707193724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267710469825
                                         uncertainty =       0.001571212270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267710469825
                                         uncertainty =       0.001571212270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365860078
  error estimate for blocks of size 2^( 2) =       0.000379575378
  error estimate for blocks of size 2^( 3) =       0.000392483272
  error estimate for blocks of size 2^( 4) =       0.000401865453
  error estimate for blocks of size 2^( 5) =       0.000406767921
  error estimate for blocks of size 2^( 6) =       0.000410566207
  error estimate for blocks of size 2^( 7) =       0.000410043077

      target function =      -0.944123437665
              le_mean =     -17.211756484123
             les_mean =     296.524978906100
             stat err =       0.000407310665
             autocorr =       1.239428610324
   target nu stat err =       0.000407310665
   target dn stat err =       0.002192380364
      target stat err =       0.003715637313
              std dev =       0.517404284602
             le_variance =       0.267707193724


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944123437665        initial  <--
     2.3283e+16     2.3283e+17             0.0000e+00        -0.944123437665
     9.3132e+16     9.3132e+17             0.0000e+00        -0.944123437665
     3.7253e+17     3.7253e+18             0.0000e+00        -0.944123437665

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1034
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9710e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1943
    reference variance = 0.324614
====================================================
  Execution time = 1.3912e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7941e-01
  Total weights = 1.957465408e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4736e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268083487746
                                         uncertainty =       0.002336424700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268083487746
                                         uncertainty =       0.002336424700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366105622
  error estimate for blocks of size 2^( 2) =       0.000379905309
  error estimate for blocks of size 2^( 3) =       0.000392795898
  error estimate for blocks of size 2^( 4) =       0.000402085070
  error estimate for blocks of size 2^( 5) =       0.000407683315
  error estimate for blocks of size 2^( 6) =       0.000410078406
  error estimate for blocks of size 2^( 7) =       0.000412713232

      target function =      -0.945782207480
              le_mean =     -17.211344932650
             les_mean =     296.509804215898
             stat err =       0.000408140006
             autocorr =       1.242812282025
   target nu stat err =       0.000408140006
   target dn stat err =       0.002864308841
      target stat err =       0.004830111557
              std dev =       0.517751535963
             le_variance =       0.268066652992


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721134493265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+17, overlap shift 2.3283e+18 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945805602066       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945805602066       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945805602066       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945805602066       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945805602066       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945805602066       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945772973154       residual = 3.48e+02           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+17 is 5.690847e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+17, overlap shift 9.3132e+18 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945805602066       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945805602066       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945805602066       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945805602066       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945805602066       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945805602066       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945805602125       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945806067905       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+17 is 1.437571e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+18, overlap shift 3.7253e+19 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945805602066       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945805602066       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945805602066       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945805602066       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945805602066       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945805600194       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945805602125       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945805592686       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.895358261716       residual = 7.87e-01           smallest_sin_value = 1.00e+00
davidson iteration    9 stopping due to too large eigenvalue change
davidson solver did not converge after          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+18 is 3.593267e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.281786 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6395e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.3005
    reference variance = 0.361967
====================================================
  Execution time = 1.3622e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7577e-01
  Total weights = 1.9575e+06
  Execution time = 1.8233e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264486788299
                                         uncertainty =       0.001262818945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264486788299
                                         uncertainty =       0.001262818945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363625971
  error estimate for blocks of size 2^( 2) =       0.000377434423
  error estimate for blocks of size 2^( 3) =       0.000390196062
  error estimate for blocks of size 2^( 4) =       0.000399833219
  error estimate for blocks of size 2^( 5) =       0.000405987996
  error estimate for blocks of size 2^( 6) =       0.000408085066
  error estimate for blocks of size 2^( 7) =       0.000411001899

      target function =      -0.951930504455
              le_mean =     -17.212138846624
             les_mean =     296.533495364186
             stat err =       0.000406227045
             autocorr =       1.248038201170
   target nu stat err =       0.000406227045
   target dn stat err =       0.001868495897
      target stat err =       0.003242365162
              std dev =       0.514244780224
             le_variance =       0.264447693987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264486788299
                                         uncertainty =       0.001262818945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264486788299
                                         uncertainty =       0.001262818945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363625971
  error estimate for blocks of size 2^( 2) =       0.000377434423
  error estimate for blocks of size 2^( 3) =       0.000390196062
  error estimate for blocks of size 2^( 4) =       0.000399833219
  error estimate for blocks of size 2^( 5) =       0.000405987996
  error estimate for blocks of size 2^( 6) =       0.000408085066
  error estimate for blocks of size 2^( 7) =       0.000411001899

      target function =      -0.951930504455
              le_mean =     -17.212138846624
             les_mean =     296.533495364186
             stat err =       0.000406227045
             autocorr =       1.248038201170
   target nu stat err =       0.000406227045
   target dn stat err =       0.001868495897
      target stat err =       0.003242365162
              std dev =       0.514244780224
             le_variance =       0.264447693987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264486788299
                                         uncertainty =       0.001262818945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264486788299
                                         uncertainty =       0.001262818945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363625971
  error estimate for blocks of size 2^( 2) =       0.000377434423
  error estimate for blocks of size 2^( 3) =       0.000390196062
  error estimate for blocks of size 2^( 4) =       0.000399833219
  error estimate for blocks of size 2^( 5) =       0.000405987996
  error estimate for blocks of size 2^( 6) =       0.000408085066
  error estimate for blocks of size 2^( 7) =       0.000411001899

      target function =      -0.951930504455
              le_mean =     -17.212138846624
             les_mean =     296.533495364186
             stat err =       0.000406227045
             autocorr =       1.248038201170
   target nu stat err =       0.000406227045
   target dn stat err =       0.001868495897
      target stat err =       0.003242365162
              std dev =       0.514244780224
             le_variance =       0.264447693987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264486788299
                                         uncertainty =       0.001262818945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264486788299
                                         uncertainty =       0.001262818945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363625971
  error estimate for blocks of size 2^( 2) =       0.000377434423
  error estimate for blocks of size 2^( 3) =       0.000390196062
  error estimate for blocks of size 2^( 4) =       0.000399833219
  error estimate for blocks of size 2^( 5) =       0.000405987996
  error estimate for blocks of size 2^( 6) =       0.000408085066
  error estimate for blocks of size 2^( 7) =       0.000411001899

      target function =      -0.951930504455
              le_mean =     -17.212138846624
             les_mean =     296.533495364186
             stat err =       0.000406227045
             autocorr =       1.248038201170
   target nu stat err =       0.000406227045
   target dn stat err =       0.001868495897
      target stat err =       0.003242365162
              std dev =       0.514244780224
             le_variance =       0.264447693987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951930504455        initial  <--
     2.3283e+17     2.3283e+18             5.6908e-22        -0.951930504455
     9.3132e+17     9.3132e+18             1.4376e-22        -0.951930504455
     3.7253e+18     3.7253e+19             3.5933e-23        -0.951930504455

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8152
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9234e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2129
    reference variance = 0.23572
====================================================
  Execution time = 1.4059e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7543e-01
  Total weights = 1.957179097e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264129787021
                                         uncertainty =       0.001215810412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264129787021
                                         uncertainty =       0.001215810412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363396449
  error estimate for blocks of size 2^( 2) =       0.000377443810
  error estimate for blocks of size 2^( 3) =       0.000390399662
  error estimate for blocks of size 2^( 4) =       0.000399508672
  error estimate for blocks of size 2^( 5) =       0.000404902679
  error estimate for blocks of size 2^( 6) =       0.000408678435
  error estimate for blocks of size 2^( 7) =       0.000409538481

      target function =      -0.952510299254
              le_mean =     -17.211946069532
             les_mean =     296.526512710146
             stat err =       0.000405657067
             autocorr =       1.246111007287
   target nu stat err =       0.000405657067
   target dn stat err =       0.001835596433
      target stat err =       0.003190536179
              std dev =       0.513920187320
             le_variance =       0.264113958935


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721194606953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+18, overlap shift 2.3283e+19 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952519916478       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952519916478       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.92e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+18 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+18, overlap shift 9.3132e+19 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952519916478       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952519916478       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+19, overlap shift 3.7253e+20 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952519916478       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952519916478       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.282820 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6589e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2154
    reference variance = 0.219674
====================================================
  Execution time = 1.3624e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7868e-01
  Total weights = 1.9573e+06
  Execution time = 1.8235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267614679329
                                         uncertainty =       0.001496247977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267614679329
                                         uncertainty =       0.001496247977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365754596
  error estimate for blocks of size 2^( 2) =       0.000379581506
  error estimate for blocks of size 2^( 3) =       0.000392306003
  error estimate for blocks of size 2^( 4) =       0.000400945806
  error estimate for blocks of size 2^( 5) =       0.000408044187
  error estimate for blocks of size 2^( 6) =       0.000411836040
  error estimate for blocks of size 2^( 7) =       0.000413273907

      target function =      -0.947000267448
              le_mean =     -17.210905021147
             les_mean =     296.493930503672
             stat err =       0.000408524985
             autocorr =       1.247549140351
   target nu stat err =       0.000408524985
   target dn stat err =       0.002133642232
      target stat err =       0.003636154114
              std dev =       0.517255110212
             le_variance =       0.267552849041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267614679329
                                         uncertainty =       0.001496247977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267614679329
                                         uncertainty =       0.001496247977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365754596
  error estimate for blocks of size 2^( 2) =       0.000379581506
  error estimate for blocks of size 2^( 3) =       0.000392306003
  error estimate for blocks of size 2^( 4) =       0.000400945806
  error estimate for blocks of size 2^( 5) =       0.000408044187
  error estimate for blocks of size 2^( 6) =       0.000411836040
  error estimate for blocks of size 2^( 7) =       0.000413273907

      target function =      -0.947000267448
              le_mean =     -17.210905021147
             les_mean =     296.493930503672
             stat err =       0.000408524985
             autocorr =       1.247549140351
   target nu stat err =       0.000408524985
   target dn stat err =       0.002133642232
      target stat err =       0.003636154114
              std dev =       0.517255110212
             le_variance =       0.267552849041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267614679329
                                         uncertainty =       0.001496247977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267614679329
                                         uncertainty =       0.001496247977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365754596
  error estimate for blocks of size 2^( 2) =       0.000379581506
  error estimate for blocks of size 2^( 3) =       0.000392306003
  error estimate for blocks of size 2^( 4) =       0.000400945806
  error estimate for blocks of size 2^( 5) =       0.000408044187
  error estimate for blocks of size 2^( 6) =       0.000411836040
  error estimate for blocks of size 2^( 7) =       0.000413273907

      target function =      -0.947000267448
              le_mean =     -17.210905021147
             les_mean =     296.493930503672
             stat err =       0.000408524985
             autocorr =       1.247549140351
   target nu stat err =       0.000408524985
   target dn stat err =       0.002133642232
      target stat err =       0.003636154114
              std dev =       0.517255110212
             le_variance =       0.267552849041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267614679329
                                         uncertainty =       0.001496247977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267614679329
                                         uncertainty =       0.001496247977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365754596
  error estimate for blocks of size 2^( 2) =       0.000379581506
  error estimate for blocks of size 2^( 3) =       0.000392306003
  error estimate for blocks of size 2^( 4) =       0.000400945806
  error estimate for blocks of size 2^( 5) =       0.000408044187
  error estimate for blocks of size 2^( 6) =       0.000411836040
  error estimate for blocks of size 2^( 7) =       0.000413273907

      target function =      -0.947000267448
              le_mean =     -17.210905021147
             les_mean =     296.493930503672
             stat err =       0.000408524985
             autocorr =       1.247549140351
   target nu stat err =       0.000408524985
   target dn stat err =       0.002133642232
      target stat err =       0.003636154114
              std dev =       0.517255110212
             le_variance =       0.267552849041


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947000267448        initial  <--
     2.3283e+18     2.3283e+19             0.0000e+00        -0.947000267448
     9.3132e+18     9.3132e+19             0.0000e+00        -0.947000267448
     3.7253e+19     3.7253e+20             0.0000e+00        -0.947000267448

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8440
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9451e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2118
    reference variance = 0.213783
====================================================
  Execution time = 1.4263e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8063e-01
  Total weights = 1.957482746e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268563734071
                                         uncertainty =       0.001833980882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268563734071
                                         uncertainty =       0.001833980882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366491373
  error estimate for blocks of size 2^( 2) =       0.000380224130
  error estimate for blocks of size 2^( 3) =       0.000392861239
  error estimate for blocks of size 2^( 4) =       0.000401936682
  error estimate for blocks of size 2^( 5) =       0.000406891095
  error estimate for blocks of size 2^( 6) =       0.000407280575
  error estimate for blocks of size 2^( 7) =       0.000410324278

      target function =      -0.943789054481
              le_mean =     -17.212846340777
             les_mean =     296.562708480021
             stat err =       0.000406608157
             autocorr =       1.230905357895
   target nu stat err =       0.000406608157
   target dn stat err =       0.002428682464
      target stat err =       0.004107180996
              std dev =       0.518297070366
             le_variance =       0.268631853150


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721284634078e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+19, overlap shift 2.3283e+20 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943805965736       residual = 9.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943805965736       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943805965736       residual = 9.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+19 is 5.330011e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+19, overlap shift 9.3132e+20 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943805965736       residual = 9.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943805965736       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943805965736       residual = 9.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+19 is 1.332503e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+20, overlap shift 3.7253e+21 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943805965736       residual = 9.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943805965736       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943805965736       residual = 9.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+20 is 3.331257e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.284195 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6779e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.1474
    reference variance = 0.114832
====================================================
  Execution time = 1.3535e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7906e-01
  Total weights = 1.9574e+06
  Execution time = 1.8331e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266132967511
                                         uncertainty =       0.001252753977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266132967511
                                         uncertainty =       0.001252753977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364772234
  error estimate for blocks of size 2^( 2) =       0.000378717712
  error estimate for blocks of size 2^( 3) =       0.000391253201
  error estimate for blocks of size 2^( 4) =       0.000400647838
  error estimate for blocks of size 2^( 5) =       0.000406278725
  error estimate for blocks of size 2^( 6) =       0.000409615024
  error estimate for blocks of size 2^( 7) =       0.000408645840

      target function =      -0.946383600526
              le_mean =     -17.212084230628
             les_mean =     296.534907221670
             stat err =       0.000406296857
             autocorr =       1.240633141214
   target nu stat err =       0.000406296857
   target dn stat err =       0.002564183475
      target stat err =       0.004346752030
              std dev =       0.515865841049
             le_variance =       0.266117565961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266132967511
                                         uncertainty =       0.001252753977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266132967511
                                         uncertainty =       0.001252753977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364772234
  error estimate for blocks of size 2^( 2) =       0.000378717712
  error estimate for blocks of size 2^( 3) =       0.000391253201
  error estimate for blocks of size 2^( 4) =       0.000400647838
  error estimate for blocks of size 2^( 5) =       0.000406278725
  error estimate for blocks of size 2^( 6) =       0.000409615024
  error estimate for blocks of size 2^( 7) =       0.000408645840

      target function =      -0.946383600526
              le_mean =     -17.212084230628
             les_mean =     296.534907221670
             stat err =       0.000406296857
             autocorr =       1.240633141216
   target nu stat err =       0.000406296857
   target dn stat err =       0.002564183475
      target stat err =       0.004346752030
              std dev =       0.515865841049
             le_variance =       0.266117565961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266132967511
                                         uncertainty =       0.001252753977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266132967511
                                         uncertainty =       0.001252753977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364772234
  error estimate for blocks of size 2^( 2) =       0.000378717712
  error estimate for blocks of size 2^( 3) =       0.000391253201
  error estimate for blocks of size 2^( 4) =       0.000400647838
  error estimate for blocks of size 2^( 5) =       0.000406278725
  error estimate for blocks of size 2^( 6) =       0.000409615024
  error estimate for blocks of size 2^( 7) =       0.000408645840

      target function =      -0.946383600526
              le_mean =     -17.212084230628
             les_mean =     296.534907221670
             stat err =       0.000406296857
             autocorr =       1.240633141216
   target nu stat err =       0.000406296857
   target dn stat err =       0.002564183475
      target stat err =       0.004346752030
              std dev =       0.515865841049
             le_variance =       0.266117565961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266132967511
                                         uncertainty =       0.001252753977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266132967511
                                         uncertainty =       0.001252753977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364772234
  error estimate for blocks of size 2^( 2) =       0.000378717712
  error estimate for blocks of size 2^( 3) =       0.000391253201
  error estimate for blocks of size 2^( 4) =       0.000400647838
  error estimate for blocks of size 2^( 5) =       0.000406278725
  error estimate for blocks of size 2^( 6) =       0.000409615024
  error estimate for blocks of size 2^( 7) =       0.000408645840

      target function =      -0.946383600526
              le_mean =     -17.212084230628
             les_mean =     296.534907221670
             stat err =       0.000406296857
             autocorr =       1.240633141216
   target nu stat err =       0.000406296857
   target dn stat err =       0.002564183475
      target stat err =       0.004346752030
              std dev =       0.515865841049
             le_variance =       0.266117565961


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946383600526        initial  <--
     2.3283e+19     2.3283e+20             5.3300e-24        -0.946383600526
     9.3132e+19     9.3132e+20             1.3325e-24        -0.946383600526
     3.7253e+20     3.7253e+21             3.3313e-25        -0.946383600526

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7873
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9572e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2754
    reference variance = 0.157792
====================================================
  Execution time = 1.4460e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7868e-01
  Total weights = 1.957472028e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5454e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265620772422
                                         uncertainty =       0.001568265438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265620772422
                                         uncertainty =       0.001568265438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364406169
  error estimate for blocks of size 2^( 2) =       0.000378561017
  error estimate for blocks of size 2^( 3) =       0.000391675370
  error estimate for blocks of size 2^( 4) =       0.000401625897
  error estimate for blocks of size 2^( 5) =       0.000408069647
  error estimate for blocks of size 2^( 6) =       0.000411676788
  error estimate for blocks of size 2^( 7) =       0.000413535326

      target function =      -0.947012424352
              le_mean =     -17.211285674203
             les_mean =     296.507030238300
             stat err =       0.000408726915
             autocorr =       1.258041691052
   target nu stat err =       0.000408726915
   target dn stat err =       0.002457693616
      target stat err =       0.004171237904
              std dev =       0.515348145762
             le_variance =       0.265583711340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721128567420e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+20, overlap shift 2.3283e+21 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947029713224       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947029713224       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+20, overlap shift 9.3132e+21 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947029713224       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947029713224       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+21, overlap shift 3.7253e+22 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947029713224       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947029713224       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.285284 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7014e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2029
    reference variance = 0.587031
====================================================
  Execution time = 1.3544e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7521e-01
  Total weights = 1.9576e+06
  Execution time = 1.8370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265248647047
                                         uncertainty =       0.001321105156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265248647047
                                         uncertainty =       0.001321105156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364199941
  error estimate for blocks of size 2^( 2) =       0.000378302337
  error estimate for blocks of size 2^( 3) =       0.000390940102
  error estimate for blocks of size 2^( 4) =       0.000400091866
  error estimate for blocks of size 2^( 5) =       0.000406016866
  error estimate for blocks of size 2^( 6) =       0.000408667037
  error estimate for blocks of size 2^( 7) =       0.000410721909

      target function =      -0.952879718629
              le_mean =     -17.212235615894
             les_mean =     296.536268859758
             stat err =       0.000406374420
             autocorr =       1.245010411667
   target nu stat err =       0.000406374420
   target dn stat err =       0.001756223398
      target stat err =       0.003064033789
              std dev =       0.515056495341
             le_variance =       0.265283193393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265248647047
                                         uncertainty =       0.001321105156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265248647047
                                         uncertainty =       0.001321105156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364199941
  error estimate for blocks of size 2^( 2) =       0.000378302337
  error estimate for blocks of size 2^( 3) =       0.000390940102
  error estimate for blocks of size 2^( 4) =       0.000400091866
  error estimate for blocks of size 2^( 5) =       0.000406016866
  error estimate for blocks of size 2^( 6) =       0.000408667037
  error estimate for blocks of size 2^( 7) =       0.000410721909

      target function =      -0.952879718629
              le_mean =     -17.212235615894
             les_mean =     296.536268859758
             stat err =       0.000406374420
             autocorr =       1.245010411667
   target nu stat err =       0.000406374420
   target dn stat err =       0.001756223398
      target stat err =       0.003064033789
              std dev =       0.515056495341
             le_variance =       0.265283193393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265248647047
                                         uncertainty =       0.001321105156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265248647047
                                         uncertainty =       0.001321105156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364199941
  error estimate for blocks of size 2^( 2) =       0.000378302337
  error estimate for blocks of size 2^( 3) =       0.000390940102
  error estimate for blocks of size 2^( 4) =       0.000400091866
  error estimate for blocks of size 2^( 5) =       0.000406016866
  error estimate for blocks of size 2^( 6) =       0.000408667037
  error estimate for blocks of size 2^( 7) =       0.000410721909

      target function =      -0.952879718629
              le_mean =     -17.212235615894
             les_mean =     296.536268859758
             stat err =       0.000406374420
             autocorr =       1.245010411667
   target nu stat err =       0.000406374420
   target dn stat err =       0.001756223398
      target stat err =       0.003064033789
              std dev =       0.515056495341
             le_variance =       0.265283193393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265248647047
                                         uncertainty =       0.001321105156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265248647047
                                         uncertainty =       0.001321105156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364199941
  error estimate for blocks of size 2^( 2) =       0.000378302337
  error estimate for blocks of size 2^( 3) =       0.000390940102
  error estimate for blocks of size 2^( 4) =       0.000400091866
  error estimate for blocks of size 2^( 5) =       0.000406016866
  error estimate for blocks of size 2^( 6) =       0.000408667037
  error estimate for blocks of size 2^( 7) =       0.000410721909

      target function =      -0.952879718629
              le_mean =     -17.212235615894
             les_mean =     296.536268859758
             stat err =       0.000406374420
             autocorr =       1.245010411667
   target nu stat err =       0.000406374420
   target dn stat err =       0.001756223398
      target stat err =       0.003064033789
              std dev =       0.515056495341
             le_variance =       0.265283193393


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.952879718629        initial  <--
     2.3283e+20     2.3283e+21             0.0000e+00        -0.952879718629
     9.3132e+20     9.3132e+21             0.0000e+00        -0.952879718629
     3.7253e+21     3.7253e+22             0.0000e+00        -0.952879718629

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7709
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2511
    reference variance = 0.292412
====================================================
  Execution time = 1.4303e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8214e-01
  Total weights = 1.956991077e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269242659631
                                         uncertainty =       0.001750407175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269242659631
                                         uncertainty =       0.001750407175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366929522
  error estimate for blocks of size 2^( 2) =       0.000380845289
  error estimate for blocks of size 2^( 3) =       0.000393426775
  error estimate for blocks of size 2^( 4) =       0.000402491985
  error estimate for blocks of size 2^( 5) =       0.000408411414
  error estimate for blocks of size 2^( 6) =       0.000412187888
  error estimate for blocks of size 2^( 7) =       0.000413198816

      target function =      -0.941270480555
              le_mean =     -17.212242133438
             les_mean =     296.543418152895
             stat err =       0.000409072526
             autocorr =       1.242897495927
   target nu stat err =       0.000409072526
   target dn stat err =       0.002677777063
      target stat err =       0.004488031162
              std dev =       0.518916707075
             le_variance =       0.269274548881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721224213344e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+21, overlap shift 2.3283e+22 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941290854684       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941290854684       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+21, overlap shift 9.3132e+22 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941290854684       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941290854684       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+22, overlap shift 3.7253e+23 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941290854684       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941290854684       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.286352 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6790e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.246
    reference variance = 0.151726
====================================================
  Execution time = 1.3548e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8233e-01
  Total weights = 1.9576e+06
  Execution time = 1.8824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269874696120
                                         uncertainty =       0.001934927816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269874696120
                                         uncertainty =       0.001934927816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367367589
  error estimate for blocks of size 2^( 2) =       0.000381413171
  error estimate for blocks of size 2^( 3) =       0.000393660349
  error estimate for blocks of size 2^( 4) =       0.000403146871
  error estimate for blocks of size 2^( 5) =       0.000408169506
  error estimate for blocks of size 2^( 6) =       0.000411584573
  error estimate for blocks of size 2^( 7) =       0.000413465694

      target function =      -0.940941126506
              le_mean =     -17.211697555001
             les_mean =     296.524865321854
             stat err =       0.000409091661
             autocorr =       1.240051086331
   target nu stat err =       0.000409091661
   target dn stat err =       0.002746734484
      target stat err =       0.004592836026
              std dev =       0.519536226883
             le_variance =       0.269917891044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269874696120
                                         uncertainty =       0.001934927816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269874696120
                                         uncertainty =       0.001934927816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367367589
  error estimate for blocks of size 2^( 2) =       0.000381413171
  error estimate for blocks of size 2^( 3) =       0.000393660349
  error estimate for blocks of size 2^( 4) =       0.000403146871
  error estimate for blocks of size 2^( 5) =       0.000408169506
  error estimate for blocks of size 2^( 6) =       0.000411584573
  error estimate for blocks of size 2^( 7) =       0.000413465694

      target function =      -0.940941126506
              le_mean =     -17.211697555001
             les_mean =     296.524865321854
             stat err =       0.000409091661
             autocorr =       1.240051086331
   target nu stat err =       0.000409091661
   target dn stat err =       0.002746734484
      target stat err =       0.004592836026
              std dev =       0.519536226883
             le_variance =       0.269917891044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269874696120
                                         uncertainty =       0.001934927816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269874696120
                                         uncertainty =       0.001934927816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367367589
  error estimate for blocks of size 2^( 2) =       0.000381413171
  error estimate for blocks of size 2^( 3) =       0.000393660349
  error estimate for blocks of size 2^( 4) =       0.000403146871
  error estimate for blocks of size 2^( 5) =       0.000408169506
  error estimate for blocks of size 2^( 6) =       0.000411584573
  error estimate for blocks of size 2^( 7) =       0.000413465694

      target function =      -0.940941126506
              le_mean =     -17.211697555001
             les_mean =     296.524865321854
             stat err =       0.000409091661
             autocorr =       1.240051086331
   target nu stat err =       0.000409091661
   target dn stat err =       0.002746734484
      target stat err =       0.004592836026
              std dev =       0.519536226883
             le_variance =       0.269917891044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269874696120
                                         uncertainty =       0.001934927816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269874696120
                                         uncertainty =       0.001934927816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367367589
  error estimate for blocks of size 2^( 2) =       0.000381413171
  error estimate for blocks of size 2^( 3) =       0.000393660349
  error estimate for blocks of size 2^( 4) =       0.000403146871
  error estimate for blocks of size 2^( 5) =       0.000408169506
  error estimate for blocks of size 2^( 6) =       0.000411584573
  error estimate for blocks of size 2^( 7) =       0.000413465694

      target function =      -0.940941126506
              le_mean =     -17.211697555001
             les_mean =     296.524865321854
             stat err =       0.000409091661
             autocorr =       1.240051086331
   target nu stat err =       0.000409091661
   target dn stat err =       0.002746734484
      target stat err =       0.004592836026
              std dev =       0.519536226883
             le_variance =       0.269917891044


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940941126506        initial  <--
     2.3283e+21     2.3283e+22             0.0000e+00        -0.940941126506
     9.3132e+21     9.3132e+22             0.0000e+00        -0.940941126506
     3.7253e+22     3.7253e+23             0.0000e+00        -0.940941126506

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8381
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9677e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2238
    reference variance = 0.361619
====================================================
  Execution time = 1.4144e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5316e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7785e-01
  Total weights = 1.957468659e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4727e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267135869107
                                         uncertainty =       0.001520960159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267135869107
                                         uncertainty =       0.001520960159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365439790
  error estimate for blocks of size 2^( 2) =       0.000379272742
  error estimate for blocks of size 2^( 3) =       0.000391741305
  error estimate for blocks of size 2^( 4) =       0.000401602804
  error estimate for blocks of size 2^( 5) =       0.000407485887
  error estimate for blocks of size 2^( 6) =       0.000410865536
  error estimate for blocks of size 2^( 7) =       0.000411437501

      target function =      -0.948417225577
              le_mean =     -17.211981765593
             les_mean =     296.530167242440
             stat err =       0.000407847932
             autocorr =       1.245560607721
   target nu stat err =       0.000407847932
   target dn stat err =       0.002229111349
      target stat err =       0.003811168530
              std dev =       0.516809906628
             le_variance =       0.267092479589


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721198176559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+22, overlap shift 2.3283e+23 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948431358210       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948431358210       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+22, overlap shift 9.3132e+23 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948431358210       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948431358210       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+23, overlap shift 3.7253e+24 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948431358210       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948431358210       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.287443 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6623e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2853
    reference variance = 0.852709
====================================================
  Execution time = 1.5686e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8563e-01
  Total weights = 1.9574e+06
  Execution time = 1.8298e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270457488892
                                         uncertainty =       0.002095561720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270457488892
                                         uncertainty =       0.002095561720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367722306
  error estimate for blocks of size 2^( 2) =       0.000381570334
  error estimate for blocks of size 2^( 3) =       0.000393970784
  error estimate for blocks of size 2^( 4) =       0.000402695111
  error estimate for blocks of size 2^( 5) =       0.000408714471
  error estimate for blocks of size 2^( 6) =       0.000412057843
  error estimate for blocks of size 2^( 7) =       0.000414529746

      target function =      -0.935496202020
              le_mean =     -17.212094209003
             les_mean =     296.541815474575
             stat err =       0.000409499293
             autocorr =       1.240127566036
   target nu stat err =       0.000409499293
   target dn stat err =       0.004462326934
      target stat err =       0.007325353279
              std dev =       0.520037872964
             le_variance =       0.270439389317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270457488892
                                         uncertainty =       0.002095561720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270457488892
                                         uncertainty =       0.002095561720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367722306
  error estimate for blocks of size 2^( 2) =       0.000381570334
  error estimate for blocks of size 2^( 3) =       0.000393970784
  error estimate for blocks of size 2^( 4) =       0.000402695111
  error estimate for blocks of size 2^( 5) =       0.000408714471
  error estimate for blocks of size 2^( 6) =       0.000412057843
  error estimate for blocks of size 2^( 7) =       0.000414529746

      target function =      -0.935496202020
              le_mean =     -17.212094209003
             les_mean =     296.541815474575
             stat err =       0.000409499293
             autocorr =       1.240127566036
   target nu stat err =       0.000409499293
   target dn stat err =       0.004462326934
      target stat err =       0.007325353279
              std dev =       0.520037872964
             le_variance =       0.270439389317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270457488892
                                         uncertainty =       0.002095561720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270457488892
                                         uncertainty =       0.002095561720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367722306
  error estimate for blocks of size 2^( 2) =       0.000381570334
  error estimate for blocks of size 2^( 3) =       0.000393970784
  error estimate for blocks of size 2^( 4) =       0.000402695111
  error estimate for blocks of size 2^( 5) =       0.000408714471
  error estimate for blocks of size 2^( 6) =       0.000412057843
  error estimate for blocks of size 2^( 7) =       0.000414529746

      target function =      -0.935496202020
              le_mean =     -17.212094209003
             les_mean =     296.541815474575
             stat err =       0.000409499293
             autocorr =       1.240127566036
   target nu stat err =       0.000409499293
   target dn stat err =       0.004462326934
      target stat err =       0.007325353279
              std dev =       0.520037872964
             le_variance =       0.270439389317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270457488892
                                         uncertainty =       0.002095561720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270457488892
                                         uncertainty =       0.002095561720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367722306
  error estimate for blocks of size 2^( 2) =       0.000381570334
  error estimate for blocks of size 2^( 3) =       0.000393970784
  error estimate for blocks of size 2^( 4) =       0.000402695111
  error estimate for blocks of size 2^( 5) =       0.000408714471
  error estimate for blocks of size 2^( 6) =       0.000412057843
  error estimate for blocks of size 2^( 7) =       0.000414529746

      target function =      -0.935496202020
              le_mean =     -17.212094209003
             les_mean =     296.541815474575
             stat err =       0.000409499293
             autocorr =       1.240127566036
   target nu stat err =       0.000409499293
   target dn stat err =       0.004462326934
      target stat err =       0.007325353279
              std dev =       0.520037872964
             le_variance =       0.270439389317


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935496202020        initial  <--
     2.3283e+22     2.3283e+23             0.0000e+00        -0.935496202020
     9.3132e+22     9.3132e+23             0.0000e+00        -0.935496202020
     3.7253e+23     3.7253e+24             0.0000e+00        -0.935496202020

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.9405
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1571e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2111
    reference variance = 0.293139
====================================================
  Execution time = 1.6259e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5316e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7913e-01
  Total weights = 1.957395714e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268717112737
                                         uncertainty =       0.001679779606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268717112737
                                         uncertainty =       0.001679779606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366557771
  error estimate for blocks of size 2^( 2) =       0.000380748667
  error estimate for blocks of size 2^( 3) =       0.000393223772
  error estimate for blocks of size 2^( 4) =       0.000402355886
  error estimate for blocks of size 2^( 5) =       0.000408189076
  error estimate for blocks of size 2^( 6) =       0.000410885606
  error estimate for blocks of size 2^( 7) =       0.000413561023

      target function =      -0.946267830516
              le_mean =     -17.211718272463
             les_mean =     296.522377349124
             stat err =       0.000408747898
             autocorr =       1.243443914398
   target nu stat err =       0.000408747898
   target dn stat err =       0.002071168672
      target stat err =       0.003534007234
              std dev =       0.518390971617
             le_variance =       0.268729199454


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721171827246e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+23, overlap shift 2.3283e+24 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946279835854       residual = 8.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946279835854       residual = 8.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+23, overlap shift 9.3132e+24 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946279835854       residual = 8.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946279835854       residual = 8.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+24, overlap shift 3.7253e+25 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946279835854       residual = 8.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946279835854       residual = 8.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.288536 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8764e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.288
    reference variance = 0.221623
====================================================
  Execution time = 1.3969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8142e-01
  Total weights = 1.9571e+06
  Execution time = 1.8361e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269080509961
                                         uncertainty =       0.001652373847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269080509961
                                         uncertainty =       0.001652373847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366781802
  error estimate for blocks of size 2^( 2) =       0.000380765272
  error estimate for blocks of size 2^( 3) =       0.000393705455
  error estimate for blocks of size 2^( 4) =       0.000402940054
  error estimate for blocks of size 2^( 5) =       0.000409396794
  error estimate for blocks of size 2^( 6) =       0.000412679830
  error estimate for blocks of size 2^( 7) =       0.000415848488

      target function =      -0.942460389338
              le_mean =     -17.211974607904
             les_mean =     296.533491991462
             stat err =       0.000410216291
             autocorr =       1.250864446807
   target nu stat err =       0.000410216291
   target dn stat err =       0.002179481985
      target stat err =       0.003684329950
              std dev =       0.518707798492
             le_variance =       0.269057780217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269080509961
                                         uncertainty =       0.001652373847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269080509961
                                         uncertainty =       0.001652373847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366781802
  error estimate for blocks of size 2^( 2) =       0.000380765272
  error estimate for blocks of size 2^( 3) =       0.000393705455
  error estimate for blocks of size 2^( 4) =       0.000402940054
  error estimate for blocks of size 2^( 5) =       0.000409396794
  error estimate for blocks of size 2^( 6) =       0.000412679830
  error estimate for blocks of size 2^( 7) =       0.000415848488

      target function =      -0.942460389338
              le_mean =     -17.211974607904
             les_mean =     296.533491991462
             stat err =       0.000410216291
             autocorr =       1.250864446809
   target nu stat err =       0.000410216291
   target dn stat err =       0.002179481985
      target stat err =       0.003684329950
              std dev =       0.518707798492
             le_variance =       0.269057780217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269080509961
                                         uncertainty =       0.001652373847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269080509961
                                         uncertainty =       0.001652373847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366781802
  error estimate for blocks of size 2^( 2) =       0.000380765272
  error estimate for blocks of size 2^( 3) =       0.000393705455
  error estimate for blocks of size 2^( 4) =       0.000402940054
  error estimate for blocks of size 2^( 5) =       0.000409396794
  error estimate for blocks of size 2^( 6) =       0.000412679830
  error estimate for blocks of size 2^( 7) =       0.000415848488

      target function =      -0.942460389338
              le_mean =     -17.211974607904
             les_mean =     296.533491991462
             stat err =       0.000410216291
             autocorr =       1.250864446809
   target nu stat err =       0.000410216291
   target dn stat err =       0.002179481985
      target stat err =       0.003684329950
              std dev =       0.518707798492
             le_variance =       0.269057780217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269080509961
                                         uncertainty =       0.001652373847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269080509961
                                         uncertainty =       0.001652373847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366781802
  error estimate for blocks of size 2^( 2) =       0.000380765272
  error estimate for blocks of size 2^( 3) =       0.000393705455
  error estimate for blocks of size 2^( 4) =       0.000402940054
  error estimate for blocks of size 2^( 5) =       0.000409396794
  error estimate for blocks of size 2^( 6) =       0.000412679830
  error estimate for blocks of size 2^( 7) =       0.000415848488

      target function =      -0.942460389338
              le_mean =     -17.211974607904
             les_mean =     296.533491991462
             stat err =       0.000410216291
             autocorr =       1.250864446809
   target nu stat err =       0.000410216291
   target dn stat err =       0.002179481985
      target stat err =       0.003684329950
              std dev =       0.518707798492
             le_variance =       0.269057780217


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942460389338        initial  <--
     2.3283e+23     2.3283e+24             0.0000e+00        -0.942460389338
     9.3132e+23     9.3132e+24             0.0000e+00        -0.942460389338
     3.7253e+24     3.7253e+25             0.0000e+00        -0.942460389338

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2010
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1971e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2047
    reference variance = 0.157882
====================================================
  Execution time = 1.3990e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7757e-01
  Total weights = 1.957287316e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4852e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266755423697
                                         uncertainty =       0.001556289025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266755423697
                                         uncertainty =       0.001556289025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365175487
  error estimate for blocks of size 2^( 2) =       0.000379207021
  error estimate for blocks of size 2^( 3) =       0.000392090720
  error estimate for blocks of size 2^( 4) =       0.000401318558
  error estimate for blocks of size 2^( 5) =       0.000407061455
  error estimate for blocks of size 2^( 6) =       0.000409543073
  error estimate for blocks of size 2^( 7) =       0.000411178788

      target function =      -0.948878572318
              le_mean =     -17.211377408030
             les_mean =     296.509077818711
             stat err =       0.000407275469
             autocorr =       1.243865066311
   target nu stat err =       0.000407275469
   target dn stat err =       0.002164322793
      target stat err =       0.003703588927
              std dev =       0.516436125870
             le_variance =       0.266706272103


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721137740803e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+24, overlap shift 2.3283e+25 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948892083048       residual = 7.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948892083048       residual = 7.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+24, overlap shift 9.3132e+25 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948892083048       residual = 7.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948892083048       residual = 7.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+25, overlap shift 3.7253e+26 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948892083048       residual = 7.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948892083048       residual = 7.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.289580 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6482e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2451
    reference variance = 0.183743
====================================================
  Execution time = 1.3774e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7960e-01
  Total weights = 1.9573e+06
  Execution time = 1.8254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269011960218
                                         uncertainty =       0.001868584487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269011960218
                                         uncertainty =       0.001868584487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366735818
  error estimate for blocks of size 2^( 2) =       0.000380376069
  error estimate for blocks of size 2^( 3) =       0.000392874075
  error estimate for blocks of size 2^( 4) =       0.000402228250
  error estimate for blocks of size 2^( 5) =       0.000408153232
  error estimate for blocks of size 2^( 6) =       0.000411542357
  error estimate for blocks of size 2^( 7) =       0.000413122698

      target function =      -0.945479353714
              le_mean =     -17.211638751381
             les_mean =     296.520109037763
             stat err =       0.000408761634
             autocorr =       1.242320347228
   target nu stat err =       0.000408761634
   target dn stat err =       0.002346180036
      target stat err =       0.003977700156
              std dev =       0.518642766964
             le_variance =       0.268990319724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269011960218
                                         uncertainty =       0.001868584487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269011960218
                                         uncertainty =       0.001868584487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366735818
  error estimate for blocks of size 2^( 2) =       0.000380376069
  error estimate for blocks of size 2^( 3) =       0.000392874075
  error estimate for blocks of size 2^( 4) =       0.000402228250
  error estimate for blocks of size 2^( 5) =       0.000408153232
  error estimate for blocks of size 2^( 6) =       0.000411542357
  error estimate for blocks of size 2^( 7) =       0.000413122698

      target function =      -0.945479353714
              le_mean =     -17.211638751381
             les_mean =     296.520109037763
             stat err =       0.000408761634
             autocorr =       1.242320347228
   target nu stat err =       0.000408761634
   target dn stat err =       0.002346180036
      target stat err =       0.003977700156
              std dev =       0.518642766964
             le_variance =       0.268990319724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269011960218
                                         uncertainty =       0.001868584487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269011960218
                                         uncertainty =       0.001868584487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366735818
  error estimate for blocks of size 2^( 2) =       0.000380376069
  error estimate for blocks of size 2^( 3) =       0.000392874075
  error estimate for blocks of size 2^( 4) =       0.000402228250
  error estimate for blocks of size 2^( 5) =       0.000408153232
  error estimate for blocks of size 2^( 6) =       0.000411542357
  error estimate for blocks of size 2^( 7) =       0.000413122698

      target function =      -0.945479353714
              le_mean =     -17.211638751381
             les_mean =     296.520109037763
             stat err =       0.000408761634
             autocorr =       1.242320347228
   target nu stat err =       0.000408761634
   target dn stat err =       0.002346180036
      target stat err =       0.003977700156
              std dev =       0.518642766964
             le_variance =       0.268990319724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269011960218
                                         uncertainty =       0.001868584487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269011960218
                                         uncertainty =       0.001868584487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366735818
  error estimate for blocks of size 2^( 2) =       0.000380376069
  error estimate for blocks of size 2^( 3) =       0.000392874075
  error estimate for blocks of size 2^( 4) =       0.000402228250
  error estimate for blocks of size 2^( 5) =       0.000408153232
  error estimate for blocks of size 2^( 6) =       0.000411542357
  error estimate for blocks of size 2^( 7) =       0.000413122698

      target function =      -0.945479353714
              le_mean =     -17.211638751381
             les_mean =     296.520109037763
             stat err =       0.000408761634
             autocorr =       1.242320347228
   target nu stat err =       0.000408761634
   target dn stat err =       0.002346180036
      target stat err =       0.003977700156
              std dev =       0.518642766964
             le_variance =       0.268990319724


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945479353714        initial  <--
     2.3283e+24     2.3283e+25             0.0000e+00        -0.945479353714
     9.3132e+24     9.3132e+25             0.0000e+00        -0.945479353714
     3.7253e+25     3.7253e+26             0.0000e+00        -0.945479353714

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0100
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9498e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.1954
    reference variance = 0.27409
====================================================
  Execution time = 1.4339e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7812e-01
  Total weights = 1.957500002e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4838e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267061268311
                                         uncertainty =       0.001432188496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267061268311
                                         uncertainty =       0.001432188496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365396863
  error estimate for blocks of size 2^( 2) =       0.000378936295
  error estimate for blocks of size 2^( 3) =       0.000391504508
  error estimate for blocks of size 2^( 4) =       0.000400821472
  error estimate for blocks of size 2^( 5) =       0.000406673300
  error estimate for blocks of size 2^( 6) =       0.000409186132
  error estimate for blocks of size 2^( 7) =       0.000409129752

      target function =      -0.947964566179
              le_mean =     -17.211900383552
             les_mean =     296.527635263609
             stat err =       0.000406452664
             autocorr =       1.237343613949
   target nu stat err =       0.000406452664
   target dn stat err =       0.002054500204
      target stat err =       0.003519441820
              std dev =       0.516749198599
             le_variance =       0.267029734253


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721190038355e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+25, overlap shift 2.3283e+26 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947976828851       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947976828851       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947976828851       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947976828786       residual = 4.10e+03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+25 is 4.314507e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+25, overlap shift 9.3132e+26 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947976828851       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947976828851       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947976828851       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947976828851       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+25 is 1.078627e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+26, overlap shift 3.7253e+27 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947976828851       residual = 9.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947976828851       residual = 8.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947976828851       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947976828851       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+26 is 3.053910e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.291210 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6830e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.166
    reference variance = 0.271225
====================================================
  Execution time = 1.3745e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7960e-01
  Total weights = 1.9576e+06
  Execution time = 1.8239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992687935
                                         uncertainty =       0.001558736321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992687935
                                         uncertainty =       0.001558736321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365339219
  error estimate for blocks of size 2^( 2) =       0.000379418500
  error estimate for blocks of size 2^( 3) =       0.000392278728
  error estimate for blocks of size 2^( 4) =       0.000401944983
  error estimate for blocks of size 2^( 5) =       0.000407975739
  error estimate for blocks of size 2^( 6) =       0.000411801792
  error estimate for blocks of size 2^( 7) =       0.000413699247

      target function =      -0.945466882356
              le_mean =     -17.211840963037
             les_mean =     296.527071970302
             stat err =       0.000408855440
             autocorr =       1.252411275866
   target nu stat err =       0.000408855440
   target dn stat err =       0.003199974647
      target stat err =       0.005385856809
              std dev =       0.516667678900
             le_variance =       0.266945490420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992687935
                                         uncertainty =       0.001558736321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992687935
                                         uncertainty =       0.001558736321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365339219
  error estimate for blocks of size 2^( 2) =       0.000379418500
  error estimate for blocks of size 2^( 3) =       0.000392278728
  error estimate for blocks of size 2^( 4) =       0.000401944983
  error estimate for blocks of size 2^( 5) =       0.000407975739
  error estimate for blocks of size 2^( 6) =       0.000411801792
  error estimate for blocks of size 2^( 7) =       0.000413699247

      target function =      -0.945466882356
              le_mean =     -17.211840963037
             les_mean =     296.527071970302
             stat err =       0.000408855440
             autocorr =       1.252411275866
   target nu stat err =       0.000408855440
   target dn stat err =       0.003199974647
      target stat err =       0.005385856809
              std dev =       0.516667678900
             le_variance =       0.266945490420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992687935
                                         uncertainty =       0.001558736321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992687935
                                         uncertainty =       0.001558736321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365339219
  error estimate for blocks of size 2^( 2) =       0.000379418500
  error estimate for blocks of size 2^( 3) =       0.000392278728
  error estimate for blocks of size 2^( 4) =       0.000401944983
  error estimate for blocks of size 2^( 5) =       0.000407975739
  error estimate for blocks of size 2^( 6) =       0.000411801792
  error estimate for blocks of size 2^( 7) =       0.000413699247

      target function =      -0.945466882356
              le_mean =     -17.211840963037
             les_mean =     296.527071970302
             stat err =       0.000408855440
             autocorr =       1.252411275866
   target nu stat err =       0.000408855440
   target dn stat err =       0.003199974647
      target stat err =       0.005385856809
              std dev =       0.516667678900
             le_variance =       0.266945490420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992687935
                                         uncertainty =       0.001558736321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992687935
                                         uncertainty =       0.001558736321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365339219
  error estimate for blocks of size 2^( 2) =       0.000379418500
  error estimate for blocks of size 2^( 3) =       0.000392278728
  error estimate for blocks of size 2^( 4) =       0.000401944983
  error estimate for blocks of size 2^( 5) =       0.000407975739
  error estimate for blocks of size 2^( 6) =       0.000411801792
  error estimate for blocks of size 2^( 7) =       0.000413699247

      target function =      -0.945466882356
              le_mean =     -17.211840963037
             les_mean =     296.527071970302
             stat err =       0.000408855440
             autocorr =       1.252411275866
   target nu stat err =       0.000408855440
   target dn stat err =       0.003199974647
      target stat err =       0.005385856809
              std dev =       0.516667678900
             le_variance =       0.266945490420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945466882356        initial  <--
     2.3283e+25     2.3283e+26             4.3145e-30        -0.945466882356
     9.3132e+25     9.3132e+26             1.0786e-30        -0.945466882356
     3.7253e+26     3.7253e+27             3.0539e-31        -0.945466882356

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9959
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9832e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.19
    reference variance = 0.147793
====================================================
  Execution time = 1.4198e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7784e-01
  Total weights = 1.957742684e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266462888728
                                         uncertainty =       0.001799348370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266462888728
                                         uncertainty =       0.001799348370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364987057
  error estimate for blocks of size 2^( 2) =       0.000378711069
  error estimate for blocks of size 2^( 3) =       0.000391741677
  error estimate for blocks of size 2^( 4) =       0.000401294755
  error estimate for blocks of size 2^( 5) =       0.000406615895
  error estimate for blocks of size 2^( 6) =       0.000408091774
  error estimate for blocks of size 2^( 7) =       0.000409907566

      target function =      -0.948435965199
              le_mean =     -17.212004590722
             les_mean =     296.530941054478
             stat err =       0.000406477498
             autocorr =       1.240275285110
   target nu stat err =       0.000406477498
   target dn stat err =       0.002364747131
      target stat err =       0.004034881901
              std dev =       0.516169645487
             le_variance =       0.266431102922


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721200459072e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+26, overlap shift 2.3283e+27 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948452030407       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948452030407       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+26, overlap shift 9.3132e+27 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948452030407       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948452030407       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+27, overlap shift 3.7253e+28 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948452030407       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948452030407       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.292305 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6744e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.1831
    reference variance = 0.459229
====================================================
  Execution time = 1.3558e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7993e-01
  Total weights = 1.9575e+06
  Execution time = 1.8312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268236972061
                                         uncertainty =       0.001527770701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268236972061
                                         uncertainty =       0.001527770701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366198689
  error estimate for blocks of size 2^( 2) =       0.000380020015
  error estimate for blocks of size 2^( 3) =       0.000392718083
  error estimate for blocks of size 2^( 4) =       0.000401973585
  error estimate for blocks of size 2^( 5) =       0.000408258930
  error estimate for blocks of size 2^( 6) =       0.000410796966
  error estimate for blocks of size 2^( 7) =       0.000411678466

      target function =      -0.944926398135
              le_mean =     -17.211182532312
             les_mean =     296.504729224858
             stat err =       0.000408176987
             autocorr =       1.242405771110
   target nu stat err =       0.000408176987
   target dn stat err =       0.002425788211
      target stat err =       0.004099910876
              std dev =       0.517883152693
             le_variance =       0.268202959844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268236972061
                                         uncertainty =       0.001527770701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268236972061
                                         uncertainty =       0.001527770701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366198689
  error estimate for blocks of size 2^( 2) =       0.000380020015
  error estimate for blocks of size 2^( 3) =       0.000392718083
  error estimate for blocks of size 2^( 4) =       0.000401973585
  error estimate for blocks of size 2^( 5) =       0.000408258930
  error estimate for blocks of size 2^( 6) =       0.000410796966
  error estimate for blocks of size 2^( 7) =       0.000411678466

      target function =      -0.944926398135
              le_mean =     -17.211182532312
             les_mean =     296.504729224858
             stat err =       0.000408176987
             autocorr =       1.242405771110
   target nu stat err =       0.000408176987
   target dn stat err =       0.002425788211
      target stat err =       0.004099910876
              std dev =       0.517883152693
             le_variance =       0.268202959844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268236972061
                                         uncertainty =       0.001527770701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268236972061
                                         uncertainty =       0.001527770701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366198689
  error estimate for blocks of size 2^( 2) =       0.000380020015
  error estimate for blocks of size 2^( 3) =       0.000392718083
  error estimate for blocks of size 2^( 4) =       0.000401973585
  error estimate for blocks of size 2^( 5) =       0.000408258930
  error estimate for blocks of size 2^( 6) =       0.000410796966
  error estimate for blocks of size 2^( 7) =       0.000411678466

      target function =      -0.944926398135
              le_mean =     -17.211182532312
             les_mean =     296.504729224858
             stat err =       0.000408176987
             autocorr =       1.242405771110
   target nu stat err =       0.000408176987
   target dn stat err =       0.002425788211
      target stat err =       0.004099910876
              std dev =       0.517883152693
             le_variance =       0.268202959844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268236972061
                                         uncertainty =       0.001527770701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268236972061
                                         uncertainty =       0.001527770701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366198689
  error estimate for blocks of size 2^( 2) =       0.000380020015
  error estimate for blocks of size 2^( 3) =       0.000392718083
  error estimate for blocks of size 2^( 4) =       0.000401973585
  error estimate for blocks of size 2^( 5) =       0.000408258930
  error estimate for blocks of size 2^( 6) =       0.000410796966
  error estimate for blocks of size 2^( 7) =       0.000411678466

      target function =      -0.944926398135
              le_mean =     -17.211182532312
             les_mean =     296.504729224858
             stat err =       0.000408176987
             autocorr =       1.242405771110
   target nu stat err =       0.000408176987
   target dn stat err =       0.002425788211
      target stat err =       0.004099910876
              std dev =       0.517883152693
             le_variance =       0.268202959844


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944926398135        initial  <--
     2.3283e+26     2.3283e+27             0.0000e+00        -0.944926398135
     9.3132e+26     9.3132e+27             0.0000e+00        -0.944926398135
     3.7253e+27     3.7253e+28             0.0000e+00        -0.944926398135

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7957
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9546e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.243
    reference variance = 0.32633
====================================================
  Execution time = 1.4360e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7526e-01
  Total weights = 1.957474899e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4838e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264861231546
                                         uncertainty =       0.001484834488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264861231546
                                         uncertainty =       0.001484834488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363946972
  error estimate for blocks of size 2^( 2) =       0.000377646661
  error estimate for blocks of size 2^( 3) =       0.000390639388
  error estimate for blocks of size 2^( 4) =       0.000399985932
  error estimate for blocks of size 2^( 5) =       0.000406060565
  error estimate for blocks of size 2^( 6) =       0.000408072291
  error estimate for blocks of size 2^( 7) =       0.000409751039

      target function =      -0.952789113863
              le_mean =     -17.212142718125
             les_mean =     296.533120350681
             stat err =       0.000405967457
             autocorr =       1.244245905148
   target nu stat err =       0.000405967457
   target dn stat err =       0.002044307552
      target stat err =       0.003539126442
              std dev =       0.514698744037
             le_variance =       0.264914797114


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721214271813e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+27, overlap shift 2.3283e+28 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952801285664       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952801285664       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+27, overlap shift 9.3132e+28 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952801285664       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952801285664       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+28, overlap shift 3.7253e+29 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952801285664       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952801285664       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.293342 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6851e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.1929
    reference variance = 0.3629
====================================================
  Execution time = 1.3591e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7810e-01
  Total weights = 1.9574e+06
  Execution time = 1.8302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266793075664
                                         uncertainty =       0.001477587735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266793075664
                                         uncertainty =       0.001477587735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365279790
  error estimate for blocks of size 2^( 2) =       0.000379036461
  error estimate for blocks of size 2^( 3) =       0.000391602597
  error estimate for blocks of size 2^( 4) =       0.000400901817
  error estimate for blocks of size 2^( 5) =       0.000407125384
  error estimate for blocks of size 2^( 6) =       0.000409665615
  error estimate for blocks of size 2^( 7) =       0.000411284453

      target function =      -0.948009267824
              le_mean =     -17.212157609144
             les_mean =     296.536468039886
             stat err =       0.000407244317
             autocorr =       1.242964647949
   target nu stat err =       0.000407244317
   target dn stat err =       0.002022482449
      target stat err =       0.003469174061
              std dev =       0.516583633018
             le_variance =       0.266858649902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266793075664
                                         uncertainty =       0.001477587735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266793075664
                                         uncertainty =       0.001477587735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365279790
  error estimate for blocks of size 2^( 2) =       0.000379036461
  error estimate for blocks of size 2^( 3) =       0.000391602597
  error estimate for blocks of size 2^( 4) =       0.000400901817
  error estimate for blocks of size 2^( 5) =       0.000407125384
  error estimate for blocks of size 2^( 6) =       0.000409665615
  error estimate for blocks of size 2^( 7) =       0.000411284453

      target function =      -0.948009267824
              le_mean =     -17.212157609144
             les_mean =     296.536468039886
             stat err =       0.000407244317
             autocorr =       1.242964647949
   target nu stat err =       0.000407244317
   target dn stat err =       0.002022482449
      target stat err =       0.003469174061
              std dev =       0.516583633018
             le_variance =       0.266858649902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266793075664
                                         uncertainty =       0.001477587735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266793075664
                                         uncertainty =       0.001477587735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365279790
  error estimate for blocks of size 2^( 2) =       0.000379036461
  error estimate for blocks of size 2^( 3) =       0.000391602597
  error estimate for blocks of size 2^( 4) =       0.000400901817
  error estimate for blocks of size 2^( 5) =       0.000407125384
  error estimate for blocks of size 2^( 6) =       0.000409665615
  error estimate for blocks of size 2^( 7) =       0.000411284453

      target function =      -0.948009267824
              le_mean =     -17.212157609144
             les_mean =     296.536468039886
             stat err =       0.000407244317
             autocorr =       1.242964647949
   target nu stat err =       0.000407244317
   target dn stat err =       0.002022482449
      target stat err =       0.003469174061
              std dev =       0.516583633018
             le_variance =       0.266858649902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266793075664
                                         uncertainty =       0.001477587735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266793075664
                                         uncertainty =       0.001477587735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365279790
  error estimate for blocks of size 2^( 2) =       0.000379036461
  error estimate for blocks of size 2^( 3) =       0.000391602597
  error estimate for blocks of size 2^( 4) =       0.000400901817
  error estimate for blocks of size 2^( 5) =       0.000407125384
  error estimate for blocks of size 2^( 6) =       0.000409665615
  error estimate for blocks of size 2^( 7) =       0.000411284453

      target function =      -0.948009267824
              le_mean =     -17.212157609144
             les_mean =     296.536468039886
             stat err =       0.000407244317
             autocorr =       1.242964647949
   target nu stat err =       0.000407244317
   target dn stat err =       0.002022482449
      target stat err =       0.003469174061
              std dev =       0.516583633018
             le_variance =       0.266858649902


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948009267824        initial  <--
     2.3283e+27     2.3283e+28             0.0000e+00        -0.948009267824
     9.3132e+27     9.3132e+28             0.0000e+00        -0.948009267824
     3.7253e+28     3.7253e+29             0.0000e+00        -0.948009267824

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8568
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9734e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1825
    reference variance = 0.155903
====================================================
  Execution time = 1.4221e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7621e-01
  Total weights = 1.957407875e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5382e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266291492941
                                         uncertainty =       0.001331228445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266291492941
                                         uncertainty =       0.001331228445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364906940
  error estimate for blocks of size 2^( 2) =       0.000378937630
  error estimate for blocks of size 2^( 3) =       0.000392025401
  error estimate for blocks of size 2^( 4) =       0.000401343598
  error estimate for blocks of size 2^( 5) =       0.000406417128
  error estimate for blocks of size 2^( 6) =       0.000409897325
  error estimate for blocks of size 2^( 7) =       0.000409812560

      target function =      -0.951186432510
              le_mean =     -17.211811483179
             les_mean =     296.522660647199
             stat err =       0.000406867653
             autocorr =       1.243203093179
   target nu stat err =       0.000406867653
   target dn stat err =       0.001729074627
      target stat err =       0.003006739292
              std dev =       0.516056342940
             le_variance =       0.266314149089


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721181148318e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+28, overlap shift 2.3283e+29 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951194865797       residual = 5.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951194865797       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951194865804       residual = 5.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+28 is 3.837596e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+28, overlap shift 9.3132e+29 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951194865797       residual = 5.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951194865797       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951194865804       residual = 5.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+28 is 9.593990e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+29, overlap shift 3.7253e+30 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951194865797       residual = 5.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951194865797       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951194865745       residual = 5.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+29 is 2.398497e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.294690 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6766e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2762
    reference variance = 0.781947
====================================================
  Execution time = 1.3729e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8002e-01
  Total weights = 1.9573e+06
  Execution time = 1.8230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267919990987
                                         uncertainty =       0.001537352493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267919990987
                                         uncertainty =       0.001537352493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365995813
  error estimate for blocks of size 2^( 2) =       0.000379791539
  error estimate for blocks of size 2^( 3) =       0.000392877034
  error estimate for blocks of size 2^( 4) =       0.000402151041
  error estimate for blocks of size 2^( 5) =       0.000407861713
  error estimate for blocks of size 2^( 6) =       0.000409770650
  error estimate for blocks of size 2^( 7) =       0.000411788090

      target function =      -0.944778924239
              le_mean =     -17.211969608680
             les_mean =     296.531920464312
             stat err =       0.000407892873
             autocorr =       1.242052637274
   target nu stat err =       0.000407892873
   target dn stat err =       0.002661275722
      target stat err =       0.004491351576
              std dev =       0.517596242120
             le_variance =       0.267905869856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267919990987
                                         uncertainty =       0.001537352493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267919990987
                                         uncertainty =       0.001537352493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365995813
  error estimate for blocks of size 2^( 2) =       0.000379791539
  error estimate for blocks of size 2^( 3) =       0.000392877034
  error estimate for blocks of size 2^( 4) =       0.000402151041
  error estimate for blocks of size 2^( 5) =       0.000407861713
  error estimate for blocks of size 2^( 6) =       0.000409770650
  error estimate for blocks of size 2^( 7) =       0.000411788090

      target function =      -0.944778924239
              le_mean =     -17.211969608680
             les_mean =     296.531920464312
             stat err =       0.000407892873
             autocorr =       1.242052637274
   target nu stat err =       0.000407892873
   target dn stat err =       0.002661275722
      target stat err =       0.004491351576
              std dev =       0.517596242120
             le_variance =       0.267905869856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267919990987
                                         uncertainty =       0.001537352493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267919990987
                                         uncertainty =       0.001537352493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365995813
  error estimate for blocks of size 2^( 2) =       0.000379791539
  error estimate for blocks of size 2^( 3) =       0.000392877034
  error estimate for blocks of size 2^( 4) =       0.000402151041
  error estimate for blocks of size 2^( 5) =       0.000407861713
  error estimate for blocks of size 2^( 6) =       0.000409770650
  error estimate for blocks of size 2^( 7) =       0.000411788090

      target function =      -0.944778924239
              le_mean =     -17.211969608680
             les_mean =     296.531920464312
             stat err =       0.000407892873
             autocorr =       1.242052637274
   target nu stat err =       0.000407892873
   target dn stat err =       0.002661275722
      target stat err =       0.004491351576
              std dev =       0.517596242120
             le_variance =       0.267905869856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267919990987
                                         uncertainty =       0.001537352493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267919990987
                                         uncertainty =       0.001537352493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365995813
  error estimate for blocks of size 2^( 2) =       0.000379791539
  error estimate for blocks of size 2^( 3) =       0.000392877034
  error estimate for blocks of size 2^( 4) =       0.000402151041
  error estimate for blocks of size 2^( 5) =       0.000407861713
  error estimate for blocks of size 2^( 6) =       0.000409770650
  error estimate for blocks of size 2^( 7) =       0.000411788090

      target function =      -0.944778924239
              le_mean =     -17.211969608680
             les_mean =     296.531920464312
             stat err =       0.000407892873
             autocorr =       1.242052637274
   target nu stat err =       0.000407892873
   target dn stat err =       0.002661275722
      target stat err =       0.004491351576
              std dev =       0.517596242120
             le_variance =       0.267905869856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944778924239        initial  <--
     2.3283e+28     2.3283e+29             3.8376e-33        -0.944778924239
     9.3132e+28     9.3132e+29             9.5940e-34        -0.944778924239
     3.7253e+29     3.7253e+30             2.3985e-34        -0.944778924239

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9653
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9754e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1425
    reference variance = 0.331512
====================================================
  Execution time = 1.3948e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8079e-01
  Total weights = 1.957308117e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267106101559
                                         uncertainty =       0.001593650414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267106101559
                                         uncertainty =       0.001593650414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365408073
  error estimate for blocks of size 2^( 2) =       0.000379575540
  error estimate for blocks of size 2^( 3) =       0.000392407918
  error estimate for blocks of size 2^( 4) =       0.000401075039
  error estimate for blocks of size 2^( 5) =       0.000407333161
  error estimate for blocks of size 2^( 6) =       0.000408502659
  error estimate for blocks of size 2^( 7) =       0.000412207552

      target function =      -0.943505695315
              le_mean =     -17.212284437217
             les_mean =     296.543527339187
             stat err =       0.000407279603
             autocorr =       1.242307321676
   target nu stat err =       0.000407279603
   target dn stat err =       0.002631893407
      target stat err =       0.004433660573
              std dev =       0.516765052677
             le_variance =       0.267046119668


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721228443722e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+29, overlap shift 2.3283e+30 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943525600700       residual = 5.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943525600700       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943525600700       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943525600700       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943525600700       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -1.000000000000       residual = 1.32e+13           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+29 is 4.683602e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+29, overlap shift 9.3132e+30 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943525600700       residual = 5.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943525600700       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943525600700       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943525600700       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943525600700       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943525599960       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933254504752       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943525593543       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.955621455295       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    9 stopping due to too large eigenvalue change
davidson solver did not converge after          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+29 is 1.238208e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+30, overlap shift 3.7253e+31 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943525600700       residual = 5.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943525600700       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943525600700       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943525600700       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943525600700       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943525598744       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913947863131       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+30 is 3.061535e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.297579 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6435e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1571
    reference variance = 0.15955
====================================================
  Execution time = 1.3716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7812e-01
  Total weights = 1.9575e+06
  Execution time = 1.8337e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267419984158
                                         uncertainty =       0.001672181142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267419984158
                                         uncertainty =       0.001672181142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365632768
  error estimate for blocks of size 2^( 2) =       0.000379682549
  error estimate for blocks of size 2^( 3) =       0.000392628195
  error estimate for blocks of size 2^( 4) =       0.000402326374
  error estimate for blocks of size 2^( 5) =       0.000407039161
  error estimate for blocks of size 2^( 6) =       0.000408136232
  error estimate for blocks of size 2^( 7) =       0.000408174886

      target function =      -0.947958058907
              le_mean =     -17.211938513538
             les_mean =     296.528951429113
             stat err =       0.000406419163
             autocorr =       1.235543765359
   target nu stat err =       0.000406419163
   target dn stat err =       0.002190138337
      target stat err =       0.003742597145
              std dev =       0.517082819530
             le_variance =       0.267374642254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267419984158
                                         uncertainty =       0.001672181142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267419984158
                                         uncertainty =       0.001672181142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365632768
  error estimate for blocks of size 2^( 2) =       0.000379682549
  error estimate for blocks of size 2^( 3) =       0.000392628195
  error estimate for blocks of size 2^( 4) =       0.000402326374
  error estimate for blocks of size 2^( 5) =       0.000407039161
  error estimate for blocks of size 2^( 6) =       0.000408136232
  error estimate for blocks of size 2^( 7) =       0.000408174886

      target function =      -0.947958058907
              le_mean =     -17.211938513538
             les_mean =     296.528951429113
             stat err =       0.000406419163
             autocorr =       1.235543765359
   target nu stat err =       0.000406419163
   target dn stat err =       0.002190138337
      target stat err =       0.003742597145
              std dev =       0.517082819530
             le_variance =       0.267374642254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267419984158
                                         uncertainty =       0.001672181142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267419984158
                                         uncertainty =       0.001672181142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365632768
  error estimate for blocks of size 2^( 2) =       0.000379682549
  error estimate for blocks of size 2^( 3) =       0.000392628195
  error estimate for blocks of size 2^( 4) =       0.000402326374
  error estimate for blocks of size 2^( 5) =       0.000407039161
  error estimate for blocks of size 2^( 6) =       0.000408136232
  error estimate for blocks of size 2^( 7) =       0.000408174886

      target function =      -0.947958058907
              le_mean =     -17.211938513538
             les_mean =     296.528951429113
             stat err =       0.000406419163
             autocorr =       1.235543765359
   target nu stat err =       0.000406419163
   target dn stat err =       0.002190138337
      target stat err =       0.003742597145
              std dev =       0.517082819530
             le_variance =       0.267374642254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267419984158
                                         uncertainty =       0.001672181142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267419984158
                                         uncertainty =       0.001672181142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365632768
  error estimate for blocks of size 2^( 2) =       0.000379682549
  error estimate for blocks of size 2^( 3) =       0.000392628195
  error estimate for blocks of size 2^( 4) =       0.000402326374
  error estimate for blocks of size 2^( 5) =       0.000407039161
  error estimate for blocks of size 2^( 6) =       0.000408136232
  error estimate for blocks of size 2^( 7) =       0.000408174886

      target function =      -0.947958058907
              le_mean =     -17.211938513538
             les_mean =     296.528951429113
             stat err =       0.000406419163
             autocorr =       1.235543765359
   target nu stat err =       0.000406419163
   target dn stat err =       0.002190138337
      target stat err =       0.003742597145
              std dev =       0.517082819530
             le_variance =       0.267374642254


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947958058907        initial  <--
     2.3283e+29     2.3283e+30             4.6836e-34        -0.947958058907
     9.3132e+29     9.3132e+30             1.2382e-34        -0.947958058907
     3.7253e+30     3.7253e+31             3.0615e-35        -0.947958058907

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9672
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9409e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.1351
    reference variance = 0.324136
====================================================
  Execution time = 1.6185e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8163e-01
  Total weights = 1.957563713e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267341080416
                                         uncertainty =       0.001654363239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267341080416
                                         uncertainty =       0.001654363239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365622436
  error estimate for blocks of size 2^( 2) =       0.000379781704
  error estimate for blocks of size 2^( 3) =       0.000392658974
  error estimate for blocks of size 2^( 4) =       0.000401594192
  error estimate for blocks of size 2^( 5) =       0.000406535506
  error estimate for blocks of size 2^( 6) =       0.000408483793
  error estimate for blocks of size 2^( 7) =       0.000411820497

      target function =      -0.942114005066
              le_mean =     -17.213053230873
             les_mean =     296.570835755737
             stat err =       0.000407108497
             autocorr =       1.239808637425
   target nu stat err =       0.000407108497
   target dn stat err =       0.002924746698
      target stat err =       0.004907398058
              std dev =       0.517068207813
             le_variance =       0.267359531531


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721305323087e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+30, overlap shift 2.3283e+31 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942138460057       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942138460057       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+30, overlap shift 9.3132e+31 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942138460057       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942138460057       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+31, overlap shift 3.7253e+32 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942138460057       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942138460057       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.298649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8678e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2379
    reference variance = 0.157313
====================================================
  Execution time = 1.5738e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7985e-01
  Total weights = 1.9573e+06
  Execution time = 1.8261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268553280650
                                         uncertainty =       0.001937042004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268553280650
                                         uncertainty =       0.001937042004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366426048
  error estimate for blocks of size 2^( 2) =       0.000380342136
  error estimate for blocks of size 2^( 3) =       0.000392902736
  error estimate for blocks of size 2^( 4) =       0.000401937788
  error estimate for blocks of size 2^( 5) =       0.000408035535
  error estimate for blocks of size 2^( 6) =       0.000411884961
  error estimate for blocks of size 2^( 7) =       0.000412868627

      target function =      -0.945078320252
              le_mean =     -17.212967673205
             les_mean =     296.566110216233
             stat err =       0.000408681728
             autocorr =       1.243935217402
   target nu stat err =       0.000408681728
   target dn stat err =       0.002787759607
      target stat err =       0.004711406494
              std dev =       0.518204687139
             le_variance =       0.268536097773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268553280650
                                         uncertainty =       0.001937042004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268553280650
                                         uncertainty =       0.001937042004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366426048
  error estimate for blocks of size 2^( 2) =       0.000380342136
  error estimate for blocks of size 2^( 3) =       0.000392902736
  error estimate for blocks of size 2^( 4) =       0.000401937788
  error estimate for blocks of size 2^( 5) =       0.000408035535
  error estimate for blocks of size 2^( 6) =       0.000411884961
  error estimate for blocks of size 2^( 7) =       0.000412868627

      target function =      -0.945078320252
              le_mean =     -17.212967673205
             les_mean =     296.566110216233
             stat err =       0.000408681728
             autocorr =       1.243935217404
   target nu stat err =       0.000408681728
   target dn stat err =       0.002787759607
      target stat err =       0.004711406494
              std dev =       0.518204687139
             le_variance =       0.268536097773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268553280650
                                         uncertainty =       0.001937042004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268553280650
                                         uncertainty =       0.001937042004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366426048
  error estimate for blocks of size 2^( 2) =       0.000380342136
  error estimate for blocks of size 2^( 3) =       0.000392902736
  error estimate for blocks of size 2^( 4) =       0.000401937788
  error estimate for blocks of size 2^( 5) =       0.000408035535
  error estimate for blocks of size 2^( 6) =       0.000411884961
  error estimate for blocks of size 2^( 7) =       0.000412868627

      target function =      -0.945078320252
              le_mean =     -17.212967673205
             les_mean =     296.566110216233
             stat err =       0.000408681728
             autocorr =       1.243935217404
   target nu stat err =       0.000408681728
   target dn stat err =       0.002787759607
      target stat err =       0.004711406494
              std dev =       0.518204687139
             le_variance =       0.268536097773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268553280650
                                         uncertainty =       0.001937042004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268553280650
                                         uncertainty =       0.001937042004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366426048
  error estimate for blocks of size 2^( 2) =       0.000380342136
  error estimate for blocks of size 2^( 3) =       0.000392902736
  error estimate for blocks of size 2^( 4) =       0.000401937788
  error estimate for blocks of size 2^( 5) =       0.000408035535
  error estimate for blocks of size 2^( 6) =       0.000411884961
  error estimate for blocks of size 2^( 7) =       0.000412868627

      target function =      -0.945078320252
              le_mean =     -17.212967673205
             les_mean =     296.566110216233
             stat err =       0.000408681728
             autocorr =       1.243935217404
   target nu stat err =       0.000408681728
   target dn stat err =       0.002787759607
      target stat err =       0.004711406494
              std dev =       0.518204687139
             le_variance =       0.268536097773


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945078320252        initial  <--
     2.3283e+30     2.3283e+31             0.0000e+00        -0.945078320252
     9.3132e+30     9.3132e+31             0.0000e+00        -0.945078320252
     3.7253e+31     3.7253e+32             0.0000e+00        -0.945078320252

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.9659
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3651e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.16
    reference variance = 0.237139
====================================================
  Execution time = 1.3967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8028e-01
  Total weights = 1.957309703e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268293776051
                                         uncertainty =       0.001683559975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268293776051
                                         uncertainty =       0.001683559975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366241087
  error estimate for blocks of size 2^( 2) =       0.000379997100
  error estimate for blocks of size 2^( 3) =       0.000392304603
  error estimate for blocks of size 2^( 4) =       0.000401035590
  error estimate for blocks of size 2^( 5) =       0.000406659853
  error estimate for blocks of size 2^( 6) =       0.000409578357
  error estimate for blocks of size 2^( 7) =       0.000412229687

      target function =      -0.944354131769
              le_mean =     -17.211908154768
             les_mean =     296.530060914183
             stat err =       0.000407375872
             autocorr =       1.237247191921
   target nu stat err =       0.000407375872
   target dn stat err =       0.002509102436
      target stat err =       0.004236902713
              std dev =       0.517943112486
             le_variance =       0.268265067771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721190815477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+31, overlap shift 2.3283e+32 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944371706182       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944371706182       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+31, overlap shift 9.3132e+32 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944371706182       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944371706182       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+32, overlap shift 3.7253e+33 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944371706182       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944371706182       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.299735 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6502e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.1796
    reference variance = 0.233777
====================================================
  Execution time = 1.4212e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7976e-01
  Total weights = 1.9574e+06
  Execution time = 1.8345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265533674579
                                         uncertainty =       0.001396304048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265533674579
                                         uncertainty =       0.001396304048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364350203
  error estimate for blocks of size 2^( 2) =       0.000378303865
  error estimate for blocks of size 2^( 3) =       0.000391249250
  error estimate for blocks of size 2^( 4) =       0.000399718508
  error estimate for blocks of size 2^( 5) =       0.000404521329
  error estimate for blocks of size 2^( 6) =       0.000406237318
  error estimate for blocks of size 2^( 7) =       0.000407236511

      target function =      -0.945178345437
              le_mean =     -17.211982200854
             les_mean =     296.532092651123
             stat err =       0.000404428417
             autocorr =       1.232098117127
   target nu stat err =       0.000404428417
   target dn stat err =       0.004411248071
      target stat err =       0.007389843972
              std dev =       0.515268999035
             le_variance =       0.265502141367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265533674579
                                         uncertainty =       0.001396304048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265533674579
                                         uncertainty =       0.001396304048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364350203
  error estimate for blocks of size 2^( 2) =       0.000378303865
  error estimate for blocks of size 2^( 3) =       0.000391249250
  error estimate for blocks of size 2^( 4) =       0.000399718508
  error estimate for blocks of size 2^( 5) =       0.000404521329
  error estimate for blocks of size 2^( 6) =       0.000406237318
  error estimate for blocks of size 2^( 7) =       0.000407236511

      target function =      -0.945178345437
              le_mean =     -17.211982200854
             les_mean =     296.532092651123
             stat err =       0.000404428417
             autocorr =       1.232098117127
   target nu stat err =       0.000404428417
   target dn stat err =       0.004411248071
      target stat err =       0.007389843972
              std dev =       0.515268999035
             le_variance =       0.265502141367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265533674579
                                         uncertainty =       0.001396304048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265533674579
                                         uncertainty =       0.001396304048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364350203
  error estimate for blocks of size 2^( 2) =       0.000378303865
  error estimate for blocks of size 2^( 3) =       0.000391249250
  error estimate for blocks of size 2^( 4) =       0.000399718508
  error estimate for blocks of size 2^( 5) =       0.000404521329
  error estimate for blocks of size 2^( 6) =       0.000406237318
  error estimate for blocks of size 2^( 7) =       0.000407236511

      target function =      -0.945178345437
              le_mean =     -17.211982200854
             les_mean =     296.532092651123
             stat err =       0.000404428417
             autocorr =       1.232098117127
   target nu stat err =       0.000404428417
   target dn stat err =       0.004411248071
      target stat err =       0.007389843972
              std dev =       0.515268999035
             le_variance =       0.265502141367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265533674579
                                         uncertainty =       0.001396304048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265533674579
                                         uncertainty =       0.001396304048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364350203
  error estimate for blocks of size 2^( 2) =       0.000378303865
  error estimate for blocks of size 2^( 3) =       0.000391249250
  error estimate for blocks of size 2^( 4) =       0.000399718508
  error estimate for blocks of size 2^( 5) =       0.000404521329
  error estimate for blocks of size 2^( 6) =       0.000406237318
  error estimate for blocks of size 2^( 7) =       0.000407236511

      target function =      -0.945178345437
              le_mean =     -17.211982200854
             les_mean =     296.532092651123
             stat err =       0.000404428417
             autocorr =       1.232098117127
   target nu stat err =       0.000404428417
   target dn stat err =       0.004411248071
      target stat err =       0.007389843972
              std dev =       0.515268999035
             le_variance =       0.265502141367


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945178345437        initial  <--
     2.3283e+31     2.3283e+32             0.0000e+00        -0.945178345437
     9.3132e+31     9.3132e+32             0.0000e+00        -0.945178345437
     3.7253e+32     3.7253e+33             0.0000e+00        -0.945178345437

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5010
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0107e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2165
    reference variance = 0.204948
====================================================
  Execution time = 1.4061e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8155e-01
  Total weights = 1.957584330e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269178531792
                                         uncertainty =       0.001916954146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269178531792
                                         uncertainty =       0.001916954146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366813424
  error estimate for blocks of size 2^( 2) =       0.000380667756
  error estimate for blocks of size 2^( 3) =       0.000393208490
  error estimate for blocks of size 2^( 4) =       0.000402677286
  error estimate for blocks of size 2^( 5) =       0.000407733464
  error estimate for blocks of size 2^( 6) =       0.000412810839
  error estimate for blocks of size 2^( 7) =       0.000413232706

      target function =      -0.942248018106
              le_mean =     -17.212312019458
             les_mean =     296.545231562032
             stat err =       0.000409113574
             autocorr =       1.243933992554
   target nu stat err =       0.000409113574
   target dn stat err =       0.002968113032
      target stat err =       0.004973639624
              std dev =       0.518752519389
             le_variance =       0.269104176373


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721231201946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+32, overlap shift 2.3283e+33 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942273063069       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942273063069       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942273063069       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942273063069       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -3.576440875436       residual = 6.66e+15           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+32 is 6.677838e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+32, overlap shift 9.3132e+33 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942273063069       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942273063069       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942273063069       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942273063069       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+32 is 1.669460e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+33, overlap shift 3.7253e+34 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942273063069       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942273063069       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942273063069       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942273063069       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+33 is 4.173649e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.301460 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6561e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.1838
    reference variance = 0.23082
====================================================
  Execution time = 1.3636e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8120e-01
  Total weights = 1.9574e+06
  Execution time = 1.8290e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268522905199
                                         uncertainty =       0.001362862517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268522905199
                                         uncertainty =       0.001362862517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366444316
  error estimate for blocks of size 2^( 2) =       0.000380319442
  error estimate for blocks of size 2^( 3) =       0.000392549354
  error estimate for blocks of size 2^( 4) =       0.000402163061
  error estimate for blocks of size 2^( 5) =       0.000408294231
  error estimate for blocks of size 2^( 6) =       0.000411664122
  error estimate for blocks of size 2^( 7) =       0.000413128177

      target function =      -0.942825215984
              le_mean =     -17.212422413085
             les_mean =     296.548689303908
             stat err =       0.000408812397
             autocorr =       1.244606701786
   target nu stat err =       0.000408812397
   target dn stat err =       0.002510887450
      target stat err =       0.004230800932
              std dev =       0.518230521937
             le_variance =       0.268562873867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268522905199
                                         uncertainty =       0.001362862517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268522905199
                                         uncertainty =       0.001362862517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366444316
  error estimate for blocks of size 2^( 2) =       0.000380319442
  error estimate for blocks of size 2^( 3) =       0.000392549354
  error estimate for blocks of size 2^( 4) =       0.000402163061
  error estimate for blocks of size 2^( 5) =       0.000408294231
  error estimate for blocks of size 2^( 6) =       0.000411664122
  error estimate for blocks of size 2^( 7) =       0.000413128177

      target function =      -0.942825215984
              le_mean =     -17.212422413085
             les_mean =     296.548689303908
             stat err =       0.000408812397
             autocorr =       1.244606701786
   target nu stat err =       0.000408812397
   target dn stat err =       0.002510887450
      target stat err =       0.004230800932
              std dev =       0.518230521937
             le_variance =       0.268562873867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268522905199
                                         uncertainty =       0.001362862517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268522905199
                                         uncertainty =       0.001362862517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366444316
  error estimate for blocks of size 2^( 2) =       0.000380319442
  error estimate for blocks of size 2^( 3) =       0.000392549354
  error estimate for blocks of size 2^( 4) =       0.000402163061
  error estimate for blocks of size 2^( 5) =       0.000408294231
  error estimate for blocks of size 2^( 6) =       0.000411664122
  error estimate for blocks of size 2^( 7) =       0.000413128177

      target function =      -0.942825215984
              le_mean =     -17.212422413085
             les_mean =     296.548689303908
             stat err =       0.000408812397
             autocorr =       1.244606701786
   target nu stat err =       0.000408812397
   target dn stat err =       0.002510887450
      target stat err =       0.004230800932
              std dev =       0.518230521937
             le_variance =       0.268562873867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268522905199
                                         uncertainty =       0.001362862517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268522905199
                                         uncertainty =       0.001362862517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366444316
  error estimate for blocks of size 2^( 2) =       0.000380319442
  error estimate for blocks of size 2^( 3) =       0.000392549354
  error estimate for blocks of size 2^( 4) =       0.000402163061
  error estimate for blocks of size 2^( 5) =       0.000408294231
  error estimate for blocks of size 2^( 6) =       0.000411664122
  error estimate for blocks of size 2^( 7) =       0.000413128177

      target function =      -0.942825215984
              le_mean =     -17.212422413085
             les_mean =     296.548689303908
             stat err =       0.000408812397
             autocorr =       1.244606701786
   target nu stat err =       0.000408812397
   target dn stat err =       0.002510887450
      target stat err =       0.004230800932
              std dev =       0.518230521937
             le_variance =       0.268562873867


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942825215984        initial  <--
     2.3283e+32     2.3283e+33             6.6778e-37        -0.942825215984
     9.3132e+32     9.3132e+33             1.6695e-37        -0.942825215984
     3.7253e+33     3.7253e+34             4.1736e-38        -0.942825215984

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8688
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9437e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1714
    reference variance = 0.256926
====================================================
  Execution time = 1.4211e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7794e-01
  Total weights = 1.957549744e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5234e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266259303679
                                         uncertainty =       0.001327176788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266259303679
                                         uncertainty =       0.001327176788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364883594
  error estimate for blocks of size 2^( 2) =       0.000378506071
  error estimate for blocks of size 2^( 3) =       0.000391381342
  error estimate for blocks of size 2^( 4) =       0.000400848302
  error estimate for blocks of size 2^( 5) =       0.000406437020
  error estimate for blocks of size 2^( 6) =       0.000409748242
  error estimate for blocks of size 2^( 7) =       0.000412638697

      target function =      -0.948275889727
              le_mean =     -17.212146055965
             les_mean =     296.535911523860
             stat err =       0.000407418066
             autocorr =       1.246728511651
   target nu stat err =       0.000407418066
   target dn stat err =       0.001975415759
      target stat err =       0.003393820832
              std dev =       0.516023327100
             le_variance =       0.266280074111


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721214605596e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+33, overlap shift 2.3283e+34 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948287091154       residual = 9.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948287091154       residual = 9.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+33, overlap shift 9.3132e+34 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948287091154       residual = 9.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948287091154       residual = 9.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+34, overlap shift 3.7253e+35 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948287091154       residual = 9.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948287091154       residual = 9.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.302511 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6741e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2499
    reference variance = 0.303666
====================================================
  Execution time = 1.3689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7864e-01
  Total weights = 1.9574e+06
  Execution time = 1.8299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267745044087
                                         uncertainty =       0.001345902972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267745044087
                                         uncertainty =       0.001345902972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365867213
  error estimate for blocks of size 2^( 2) =       0.000379573828
  error estimate for blocks of size 2^( 3) =       0.000392214936
  error estimate for blocks of size 2^( 4) =       0.000401658028
  error estimate for blocks of size 2^( 5) =       0.000407063994
  error estimate for blocks of size 2^( 6) =       0.000407778795
  error estimate for blocks of size 2^( 7) =       0.000409552624

      target function =      -0.947095447109
              le_mean =     -17.211881560045
             les_mean =     296.527506732744
             stat err =       0.000406513360
             autocorr =       1.234532888172
   target nu stat err =       0.000406513360
   target dn stat err =       0.001940094194
      target stat err =       0.003325805808
              std dev =       0.517414374048
             le_variance =       0.267717634471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267745044087
                                         uncertainty =       0.001345902972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267745044087
                                         uncertainty =       0.001345902972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365867213
  error estimate for blocks of size 2^( 2) =       0.000379573828
  error estimate for blocks of size 2^( 3) =       0.000392214936
  error estimate for blocks of size 2^( 4) =       0.000401658028
  error estimate for blocks of size 2^( 5) =       0.000407063994
  error estimate for blocks of size 2^( 6) =       0.000407778795
  error estimate for blocks of size 2^( 7) =       0.000409552624

      target function =      -0.947095447109
              le_mean =     -17.211881560045
             les_mean =     296.527506732744
             stat err =       0.000406513360
             autocorr =       1.234532888172
   target nu stat err =       0.000406513360
   target dn stat err =       0.001940094194
      target stat err =       0.003325805808
              std dev =       0.517414374048
             le_variance =       0.267717634471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267745044087
                                         uncertainty =       0.001345902972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267745044087
                                         uncertainty =       0.001345902972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365867213
  error estimate for blocks of size 2^( 2) =       0.000379573828
  error estimate for blocks of size 2^( 3) =       0.000392214936
  error estimate for blocks of size 2^( 4) =       0.000401658028
  error estimate for blocks of size 2^( 5) =       0.000407063994
  error estimate for blocks of size 2^( 6) =       0.000407778795
  error estimate for blocks of size 2^( 7) =       0.000409552624

      target function =      -0.947095447109
              le_mean =     -17.211881560045
             les_mean =     296.527506732744
             stat err =       0.000406513360
             autocorr =       1.234532888172
   target nu stat err =       0.000406513360
   target dn stat err =       0.001940094194
      target stat err =       0.003325805808
              std dev =       0.517414374048
             le_variance =       0.267717634471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267745044087
                                         uncertainty =       0.001345902972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267745044087
                                         uncertainty =       0.001345902972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365867213
  error estimate for blocks of size 2^( 2) =       0.000379573828
  error estimate for blocks of size 2^( 3) =       0.000392214936
  error estimate for blocks of size 2^( 4) =       0.000401658028
  error estimate for blocks of size 2^( 5) =       0.000407063994
  error estimate for blocks of size 2^( 6) =       0.000407778795
  error estimate for blocks of size 2^( 7) =       0.000409552624

      target function =      -0.947095447109
              le_mean =     -17.211881560045
             les_mean =     296.527506732744
             stat err =       0.000406513360
             autocorr =       1.234532888172
   target nu stat err =       0.000406513360
   target dn stat err =       0.001940094194
      target stat err =       0.003325805808
              std dev =       0.517414374048
             le_variance =       0.267717634471


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947095447109        initial  <--
     2.3283e+33     2.3283e+34             0.0000e+00        -0.947095447109
     9.3132e+33     9.3132e+34             0.0000e+00        -0.947095447109
     3.7253e+34     3.7253e+35             0.0000e+00        -0.947095447109

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9330
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9687e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1609
    reference variance = 0.46509
====================================================
  Execution time = 1.4222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8403e-01
  Total weights = 1.957470329e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270951980111
                                         uncertainty =       0.001617875183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270951980111
                                         uncertainty =       0.001617875183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368047229
  error estimate for blocks of size 2^( 2) =       0.000381710528
  error estimate for blocks of size 2^( 3) =       0.000394224550
  error estimate for blocks of size 2^( 4) =       0.000403268043
  error estimate for blocks of size 2^( 5) =       0.000408920954
  error estimate for blocks of size 2^( 6) =       0.000410719605
  error estimate for blocks of size 2^( 7) =       0.000411636005

      target function =      -0.938146011303
              le_mean =     -17.211745152574
             les_mean =     296.528201619214
             stat err =       0.000408636152
             autocorr =       1.232725746607
   target nu stat err =       0.000408636152
   target dn stat err =       0.002758050983
      target stat err =       0.004584555111
              std dev =       0.520497382652
             le_variance =       0.270917525347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721174515257e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+34, overlap shift 2.3283e+35 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938167191825       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938167191825       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+34, overlap shift 9.3132e+35 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938167191825       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938167191825       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+35, overlap shift 3.7253e+36 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938167191825       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938167191825       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.303619 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6716e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1493
    reference variance = 0.216023
====================================================
  Execution time = 1.3791e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8530e-01
  Total weights = 1.9575e+06
  Execution time = 1.8272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271520435303
                                         uncertainty =       0.001896283951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271520435303
                                         uncertainty =       0.001896283951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368434439
  error estimate for blocks of size 2^( 2) =       0.000382153312
  error estimate for blocks of size 2^( 3) =       0.000394902365
  error estimate for blocks of size 2^( 4) =       0.000404016724
  error estimate for blocks of size 2^( 5) =       0.000410033668
  error estimate for blocks of size 2^( 6) =       0.000413029873
  error estimate for blocks of size 2^( 7) =       0.000414736813

      target function =      -0.936045921677
              le_mean =     -17.211850546258
             les_mean =     296.533102432673
             stat err =       0.000410454269
             autocorr =       1.241106691242
   target nu stat err =       0.000410454269
   target dn stat err =       0.003584978273
      target stat err =       0.005904764416
              std dev =       0.521044980842
             le_variance =       0.271487872061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271520435303
                                         uncertainty =       0.001896283951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271520435303
                                         uncertainty =       0.001896283951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368434439
  error estimate for blocks of size 2^( 2) =       0.000382153312
  error estimate for blocks of size 2^( 3) =       0.000394902365
  error estimate for blocks of size 2^( 4) =       0.000404016724
  error estimate for blocks of size 2^( 5) =       0.000410033668
  error estimate for blocks of size 2^( 6) =       0.000413029873
  error estimate for blocks of size 2^( 7) =       0.000414736813

      target function =      -0.936045921677
              le_mean =     -17.211850546258
             les_mean =     296.533102432673
             stat err =       0.000410454269
             autocorr =       1.241106691241
   target nu stat err =       0.000410454269
   target dn stat err =       0.003584978273
      target stat err =       0.005904764416
              std dev =       0.521044980842
             le_variance =       0.271487872061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271520435303
                                         uncertainty =       0.001896283951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271520435303
                                         uncertainty =       0.001896283951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368434439
  error estimate for blocks of size 2^( 2) =       0.000382153312
  error estimate for blocks of size 2^( 3) =       0.000394902365
  error estimate for blocks of size 2^( 4) =       0.000404016724
  error estimate for blocks of size 2^( 5) =       0.000410033668
  error estimate for blocks of size 2^( 6) =       0.000413029873
  error estimate for blocks of size 2^( 7) =       0.000414736813

      target function =      -0.936045921677
              le_mean =     -17.211850546258
             les_mean =     296.533102432673
             stat err =       0.000410454269
             autocorr =       1.241106691241
   target nu stat err =       0.000410454269
   target dn stat err =       0.003584978273
      target stat err =       0.005904764416
              std dev =       0.521044980842
             le_variance =       0.271487872061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271520435303
                                         uncertainty =       0.001896283951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271520435303
                                         uncertainty =       0.001896283951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368434439
  error estimate for blocks of size 2^( 2) =       0.000382153312
  error estimate for blocks of size 2^( 3) =       0.000394902365
  error estimate for blocks of size 2^( 4) =       0.000404016724
  error estimate for blocks of size 2^( 5) =       0.000410033668
  error estimate for blocks of size 2^( 6) =       0.000413029873
  error estimate for blocks of size 2^( 7) =       0.000414736813

      target function =      -0.936045921677
              le_mean =     -17.211850546258
             les_mean =     296.533102432673
             stat err =       0.000410454269
             autocorr =       1.241106691241
   target nu stat err =       0.000410454269
   target dn stat err =       0.003584978273
      target stat err =       0.005904764416
              std dev =       0.521044980842
             le_variance =       0.271487872061


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936045921677        initial  <--
     2.3283e+34     2.3283e+35             0.0000e+00        -0.936045921677
     9.3132e+34     9.3132e+35             0.0000e+00        -0.936045921677
     3.7253e+35     3.7253e+36             0.0000e+00        -0.936045921677

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0206
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9742e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2011
    reference variance = 0.192387
====================================================
  Execution time = 1.4258e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8079e-01
  Total weights = 1.957278725e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4964e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267460940769
                                         uncertainty =       0.001531847964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267460940769
                                         uncertainty =       0.001531847964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365675975
  error estimate for blocks of size 2^( 2) =       0.000379377652
  error estimate for blocks of size 2^( 3) =       0.000392399961
  error estimate for blocks of size 2^( 4) =       0.000402372344
  error estimate for blocks of size 2^( 5) =       0.000406189655
  error estimate for blocks of size 2^( 6) =       0.000412237816
  error estimate for blocks of size 2^( 7) =       0.000413978011

      target function =      -0.943508637453
              le_mean =     -17.212198180792
             les_mean =     296.540557330449
             stat err =       0.000408694456
             autocorr =       1.249121370688
   target nu stat err =       0.000408694456
   target dn stat err =       0.002415105003
      target stat err =       0.004078237558
              std dev =       0.517143922862
             le_variance =       0.267437836953


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721219818079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+35, overlap shift 2.3283e+36 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943525111219       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943525111219       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943525075912       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+35 is 3.361959e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+35, overlap shift 9.3132e+36 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943525111219       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943525111219       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943525075912       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+35 is 8.404898e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+36, overlap shift 3.7253e+37 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943525111219       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943525111219       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943525314331       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+36 is 2.101225e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.305003 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6761e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.1948
    reference variance = 0.197991
====================================================
  Execution time = 1.3652e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8253e-01
  Total weights = 1.9573e+06
  Execution time = 1.8256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268898326275
                                         uncertainty =       0.001633955612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268898326275
                                         uncertainty =       0.001633955612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366625248
  error estimate for blocks of size 2^( 2) =       0.000380573627
  error estimate for blocks of size 2^( 3) =       0.000393316281
  error estimate for blocks of size 2^( 4) =       0.000403317417
  error estimate for blocks of size 2^( 5) =       0.000409227771
  error estimate for blocks of size 2^( 6) =       0.000412071204
  error estimate for blocks of size 2^( 7) =       0.000413336876

      target function =      -0.940628799564
              le_mean =     -17.212636125529
             les_mean =     296.557373263405
             stat err =       0.000409488317
             autocorr =       1.247493499269
   target nu stat err =       0.000409488317
   target dn stat err =       0.002599189128
      target stat err =       0.004357203875
              std dev =       0.518486398218
             le_variance =       0.268828145137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268898326275
                                         uncertainty =       0.001633955612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268898326275
                                         uncertainty =       0.001633955612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366625248
  error estimate for blocks of size 2^( 2) =       0.000380573627
  error estimate for blocks of size 2^( 3) =       0.000393316281
  error estimate for blocks of size 2^( 4) =       0.000403317417
  error estimate for blocks of size 2^( 5) =       0.000409227771
  error estimate for blocks of size 2^( 6) =       0.000412071204
  error estimate for blocks of size 2^( 7) =       0.000413336876

      target function =      -0.940628799564
              le_mean =     -17.212636125529
             les_mean =     296.557373263405
             stat err =       0.000409488317
             autocorr =       1.247493499269
   target nu stat err =       0.000409488317
   target dn stat err =       0.002599189128
      target stat err =       0.004357203875
              std dev =       0.518486398218
             le_variance =       0.268828145137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268898326275
                                         uncertainty =       0.001633955612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268898326275
                                         uncertainty =       0.001633955612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366625248
  error estimate for blocks of size 2^( 2) =       0.000380573627
  error estimate for blocks of size 2^( 3) =       0.000393316281
  error estimate for blocks of size 2^( 4) =       0.000403317417
  error estimate for blocks of size 2^( 5) =       0.000409227771
  error estimate for blocks of size 2^( 6) =       0.000412071204
  error estimate for blocks of size 2^( 7) =       0.000413336876

      target function =      -0.940628799564
              le_mean =     -17.212636125529
             les_mean =     296.557373263405
             stat err =       0.000409488317
             autocorr =       1.247493499269
   target nu stat err =       0.000409488317
   target dn stat err =       0.002599189128
      target stat err =       0.004357203875
              std dev =       0.518486398218
             le_variance =       0.268828145137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268898326275
                                         uncertainty =       0.001633955612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268898326275
                                         uncertainty =       0.001633955612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366625248
  error estimate for blocks of size 2^( 2) =       0.000380573627
  error estimate for blocks of size 2^( 3) =       0.000393316281
  error estimate for blocks of size 2^( 4) =       0.000403317417
  error estimate for blocks of size 2^( 5) =       0.000409227771
  error estimate for blocks of size 2^( 6) =       0.000412071204
  error estimate for blocks of size 2^( 7) =       0.000413336876

      target function =      -0.940628799564
              le_mean =     -17.212636125529
             les_mean =     296.557373263405
             stat err =       0.000409488317
             autocorr =       1.247493499269
   target nu stat err =       0.000409488317
   target dn stat err =       0.002599189128
      target stat err =       0.004357203875
              std dev =       0.518486398218
             le_variance =       0.268828145137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940628799564        initial  <--
     2.3283e+35     2.3283e+36             3.3620e-40        -0.940628799564
     9.3132e+35     9.3132e+36             8.4049e-41        -0.940628799564
     3.7253e+36     3.7253e+37             2.1012e-41        -0.940628799564

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8805
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9647e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2579
    reference variance = 0.184254
====================================================
  Execution time = 1.4206e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8142e-01
  Total weights = 1.956984855e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270317536654
                                         uncertainty =       0.002009631840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270317536654
                                         uncertainty =       0.002009631840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367565863
  error estimate for blocks of size 2^( 2) =       0.000381908642
  error estimate for blocks of size 2^( 3) =       0.000394187450
  error estimate for blocks of size 2^( 4) =       0.000403138814
  error estimate for blocks of size 2^( 5) =       0.000409183687
  error estimate for blocks of size 2^( 6) =       0.000412420270
  error estimate for blocks of size 2^( 7) =       0.000414523666

      target function =      -0.942480201029
              le_mean =     -17.212850202049
             les_mean =     296.563629383791
             stat err =       0.000409816609
             autocorr =       1.243107739169
   target nu stat err =       0.000409816609
   target dn stat err =       0.002329225567
      target stat err =       0.003934529993
              std dev =       0.519816628771
             le_variance =       0.270209327547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721285020205e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+36, overlap shift 2.3283e+37 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942495745299       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942495745299       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942495745299       residual = 7.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942495745299       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942495745299       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937500000000       residual = 2.09e+09           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+36 is 6.287638e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+36, overlap shift 9.3132e+37 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942495745299       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942495745299       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942495745299       residual = 7.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942495745299       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942495745299       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945312500000       residual = 5.98e+07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932246421318       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+36 is 1.571910e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+37, overlap shift 3.7253e+38 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942495745299       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942495745299       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942495745299       residual = 7.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942495745299       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942495745299       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -1.000000000000       residual = 2.09e+09           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+37 is 3.929774e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.307409 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6739e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.151
    reference variance = 0.463554
====================================================
  Execution time = 1.3706e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8149e-01
  Total weights = 1.9573e+06
  Execution time = 1.8299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267895814107
                                         uncertainty =       0.001610017379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267895814107
                                         uncertainty =       0.001610017379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365960118
  error estimate for blocks of size 2^( 2) =       0.000379681482
  error estimate for blocks of size 2^( 3) =       0.000392056921
  error estimate for blocks of size 2^( 4) =       0.000400947550
  error estimate for blocks of size 2^( 5) =       0.000406502101
  error estimate for blocks of size 2^( 6) =       0.000409121769
  error estimate for blocks of size 2^( 7) =       0.000412276378

      target function =      -0.942352356885
              le_mean =     -17.212620283351
             les_mean =     296.555786363175
             stat err =       0.000407211949
             autocorr =       1.238150708406
   target nu stat err =       0.000407211949
   target dn stat err =       0.002669026883
      target stat err =       0.004486542990
              std dev =       0.517545761584
             le_variance =       0.267853615334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267895814107
                                         uncertainty =       0.001610017379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267895814107
                                         uncertainty =       0.001610017379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365960118
  error estimate for blocks of size 2^( 2) =       0.000379681482
  error estimate for blocks of size 2^( 3) =       0.000392056921
  error estimate for blocks of size 2^( 4) =       0.000400947550
  error estimate for blocks of size 2^( 5) =       0.000406502101
  error estimate for blocks of size 2^( 6) =       0.000409121769
  error estimate for blocks of size 2^( 7) =       0.000412276378

      target function =      -0.942352356885
              le_mean =     -17.212620283351
             les_mean =     296.555786363175
             stat err =       0.000407211949
             autocorr =       1.238150708404
   target nu stat err =       0.000407211949
   target dn stat err =       0.002669026883
      target stat err =       0.004486542990
              std dev =       0.517545761584
             le_variance =       0.267853615334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267895814107
                                         uncertainty =       0.001610017379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267895814107
                                         uncertainty =       0.001610017379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365960118
  error estimate for blocks of size 2^( 2) =       0.000379681482
  error estimate for blocks of size 2^( 3) =       0.000392056921
  error estimate for blocks of size 2^( 4) =       0.000400947550
  error estimate for blocks of size 2^( 5) =       0.000406502101
  error estimate for blocks of size 2^( 6) =       0.000409121769
  error estimate for blocks of size 2^( 7) =       0.000412276378

      target function =      -0.942352356885
              le_mean =     -17.212620283351
             les_mean =     296.555786363175
             stat err =       0.000407211949
             autocorr =       1.238150708404
   target nu stat err =       0.000407211949
   target dn stat err =       0.002669026883
      target stat err =       0.004486542990
              std dev =       0.517545761584
             le_variance =       0.267853615334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267895814107
                                         uncertainty =       0.001610017379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267895814107
                                         uncertainty =       0.001610017379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365960118
  error estimate for blocks of size 2^( 2) =       0.000379681482
  error estimate for blocks of size 2^( 3) =       0.000392056921
  error estimate for blocks of size 2^( 4) =       0.000400947550
  error estimate for blocks of size 2^( 5) =       0.000406502101
  error estimate for blocks of size 2^( 6) =       0.000409121769
  error estimate for blocks of size 2^( 7) =       0.000412276378

      target function =      -0.942352356885
              le_mean =     -17.212620283351
             les_mean =     296.555786363175
             stat err =       0.000407211949
             autocorr =       1.238150708404
   target nu stat err =       0.000407211949
   target dn stat err =       0.002669026883
      target stat err =       0.004486542990
              std dev =       0.517545761584
             le_variance =       0.267853615334


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942352356885        initial  <--
     2.3283e+36     2.3283e+37             6.2876e-41        -0.942352356885
     9.3132e+36     9.3132e+37             1.5719e-41        -0.942352356885
     3.7253e+37     3.7253e+38             3.9298e-42        -0.942352356885

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0634
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9841e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.0451
    reference variance = 1.12228
====================================================
  Execution time = 1.4008e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7713e-01
  Total weights = 1.957445636e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266057050022
                                         uncertainty =       0.001494433325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266057050022
                                         uncertainty =       0.001494433325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364745348
  error estimate for blocks of size 2^( 2) =       0.000378777487
  error estimate for blocks of size 2^( 3) =       0.000391422266
  error estimate for blocks of size 2^( 4) =       0.000401281269
  error estimate for blocks of size 2^( 5) =       0.000407054963
  error estimate for blocks of size 2^( 6) =       0.000408677293
  error estimate for blocks of size 2^( 7) =       0.000409625729

      target function =      -0.949637267725
              le_mean =     -17.212493536647
             les_mean =     296.547067342605
             stat err =       0.000406659814
             autocorr =       1.243033951883
   target nu stat err =       0.000406659814
   target dn stat err =       0.002314106682
      target stat err =       0.003964777046
              std dev =       0.515827818132
             le_variance =       0.266078337959


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721249353665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+37, overlap shift 2.3283e+38 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949652763450       residual = 3.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949652763450       residual = 5.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949652763450       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949653625488       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+37 is 7.186939e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+37, overlap shift 9.3132e+38 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949652763450       residual = 3.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949652763450       residual = 5.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949652763450       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949652763277       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 7.38e+09           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+37 is 1.747182e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+38, overlap shift 3.7253e+39 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949652763450       residual = 3.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949652763450       residual = 5.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949652763450       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937500000000       residual = 4.46e+06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+38 is 4.491837e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.309139 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6554e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2519
    reference variance = 0.40183
====================================================
  Execution time = 1.5930e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7932e-01
  Total weights = 1.9572e+06
  Execution time = 1.8274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268090296085
                                         uncertainty =       0.001829529828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268090296085
                                         uncertainty =       0.001829529828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366148514
  error estimate for blocks of size 2^( 2) =       0.000380230812
  error estimate for blocks of size 2^( 3) =       0.000393215152
  error estimate for blocks of size 2^( 4) =       0.000402007992
  error estimate for blocks of size 2^( 5) =       0.000407640004
  error estimate for blocks of size 2^( 6) =       0.000409754809
  error estimate for blocks of size 2^( 7) =       0.000412885808

      target function =      -0.945941617165
              le_mean =     -17.211334022178
             les_mean =     296.509338931075
             stat err =       0.000408072153
             autocorr =       1.242108023037
   target nu stat err =       0.000408072153
   target dn stat err =       0.002168966861
      target stat err =       0.003688704189
              std dev =       0.517812194749
             le_variance =       0.268129469031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268090296085
                                         uncertainty =       0.001829529828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268090296085
                                         uncertainty =       0.001829529828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366148514
  error estimate for blocks of size 2^( 2) =       0.000380230812
  error estimate for blocks of size 2^( 3) =       0.000393215152
  error estimate for blocks of size 2^( 4) =       0.000402007992
  error estimate for blocks of size 2^( 5) =       0.000407640004
  error estimate for blocks of size 2^( 6) =       0.000409754809
  error estimate for blocks of size 2^( 7) =       0.000412885808

      target function =      -0.945941617165
              le_mean =     -17.211334022178
             les_mean =     296.509338931075
             stat err =       0.000408072153
             autocorr =       1.242108023038
   target nu stat err =       0.000408072153
   target dn stat err =       0.002168966861
      target stat err =       0.003688704189
              std dev =       0.517812194749
             le_variance =       0.268129469031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268090296085
                                         uncertainty =       0.001829529828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268090296085
                                         uncertainty =       0.001829529828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366148514
  error estimate for blocks of size 2^( 2) =       0.000380230812
  error estimate for blocks of size 2^( 3) =       0.000393215152
  error estimate for blocks of size 2^( 4) =       0.000402007992
  error estimate for blocks of size 2^( 5) =       0.000407640004
  error estimate for blocks of size 2^( 6) =       0.000409754809
  error estimate for blocks of size 2^( 7) =       0.000412885808

      target function =      -0.945941617165
              le_mean =     -17.211334022178
             les_mean =     296.509338931075
             stat err =       0.000408072153
             autocorr =       1.242108023038
   target nu stat err =       0.000408072153
   target dn stat err =       0.002168966861
      target stat err =       0.003688704189
              std dev =       0.517812194749
             le_variance =       0.268129469031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268090296085
                                         uncertainty =       0.001829529828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268090296085
                                         uncertainty =       0.001829529828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366148514
  error estimate for blocks of size 2^( 2) =       0.000380230812
  error estimate for blocks of size 2^( 3) =       0.000393215152
  error estimate for blocks of size 2^( 4) =       0.000402007992
  error estimate for blocks of size 2^( 5) =       0.000407640004
  error estimate for blocks of size 2^( 6) =       0.000409754809
  error estimate for blocks of size 2^( 7) =       0.000412885808

      target function =      -0.945941617165
              le_mean =     -17.211334022178
             les_mean =     296.509338931075
             stat err =       0.000408072153
             autocorr =       1.242108023038
   target nu stat err =       0.000408072153
   target dn stat err =       0.002168966861
      target stat err =       0.003688704189
              std dev =       0.517812194749
             le_variance =       0.268129469031


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945941617165        initial  <--
     2.3283e+37     2.3283e+38             7.1869e-42        -0.945941617165
     9.3132e+37     9.3132e+38             1.7472e-42        -0.945941617165
     3.7253e+38     3.7253e+39             4.4918e-43        -0.945941617165

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.2462
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1806e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2471
    reference variance = 0.319589
====================================================
  Execution time = 1.6298e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7955e-01
  Total weights = 1.957378474e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268337675366
                                         uncertainty =       0.002237522956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268337675366
                                         uncertainty =       0.002237522956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366265206
  error estimate for blocks of size 2^( 2) =       0.000380242023
  error estimate for blocks of size 2^( 3) =       0.000393157441
  error estimate for blocks of size 2^( 4) =       0.000402651192
  error estimate for blocks of size 2^( 5) =       0.000409210172
  error estimate for blocks of size 2^( 6) =       0.000411902093
  error estimate for blocks of size 2^( 7) =       0.000413271906

      target function =      -0.945564800675
              le_mean =     -17.211573240197
             les_mean =     296.517799533805
             stat err =       0.000409258841
             autocorr =       1.248546755315
   target nu stat err =       0.000409258841
   target dn stat err =       0.002587639255
      target stat err =       0.004374640062
              std dev =       0.517977222438
             le_variance =       0.268300402965


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721157324020e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+38, overlap shift 2.3283e+39 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945584117419       residual = 6.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945584117419       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945584117419       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945312500000       residual = 5.14e+04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945584117419       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 2.42e+23           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+38 is 4.091324e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+38, overlap shift 9.3132e+39 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945584117419       residual = 6.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945584117419       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945584117419       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945584117419       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945584117419       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945584116521       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+38 is 1.102323e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+39, overlap shift 3.7253e+40 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945584117419       residual = 6.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945584117419       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945584117419       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945584117419       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945584117419       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945584114961       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 1.31e+15           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+39 is 2.755806e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.311615 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8849e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2092
    reference variance = 0.149916
====================================================
  Execution time = 1.3783e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7428e-01
  Total weights = 1.9576e+06
  Execution time = 1.8301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.263986042783
                                         uncertainty =       0.001261553944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.263986042783
                                         uncertainty =       0.001261553944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363297721
  error estimate for blocks of size 2^( 2) =       0.000377136694
  error estimate for blocks of size 2^( 3) =       0.000389842873
  error estimate for blocks of size 2^( 4) =       0.000399670009
  error estimate for blocks of size 2^( 5) =       0.000404357349
  error estimate for blocks of size 2^( 6) =       0.000407870358
  error estimate for blocks of size 2^( 7) =       0.000409220170

      target function =      -0.954458907518
              le_mean =     -17.211933462908
             les_mean =     296.524929222669
             stat err =       0.000405279471
             autocorr =       1.244468376835
   target nu stat err =       0.000405279471
   target dn stat err =       0.001929205749
      target stat err =       0.003358286452
              std dev =       0.513780564071
             le_variance =       0.263970468017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.263986042783
                                         uncertainty =       0.001261553944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.263986042783
                                         uncertainty =       0.001261553944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363297721
  error estimate for blocks of size 2^( 2) =       0.000377136694
  error estimate for blocks of size 2^( 3) =       0.000389842873
  error estimate for blocks of size 2^( 4) =       0.000399670009
  error estimate for blocks of size 2^( 5) =       0.000404357349
  error estimate for blocks of size 2^( 6) =       0.000407870358
  error estimate for blocks of size 2^( 7) =       0.000409220170

      target function =      -0.954458907518
              le_mean =     -17.211933462908
             les_mean =     296.524929222669
             stat err =       0.000405279471
             autocorr =       1.244468376835
   target nu stat err =       0.000405279471
   target dn stat err =       0.001929205749
      target stat err =       0.003358286452
              std dev =       0.513780564071
             le_variance =       0.263970468017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.263986042783
                                         uncertainty =       0.001261553944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.263986042783
                                         uncertainty =       0.001261553944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363297721
  error estimate for blocks of size 2^( 2) =       0.000377136694
  error estimate for blocks of size 2^( 3) =       0.000389842873
  error estimate for blocks of size 2^( 4) =       0.000399670009
  error estimate for blocks of size 2^( 5) =       0.000404357349
  error estimate for blocks of size 2^( 6) =       0.000407870358
  error estimate for blocks of size 2^( 7) =       0.000409220170

      target function =      -0.954458907518
              le_mean =     -17.211933462908
             les_mean =     296.524929222669
             stat err =       0.000405279471
             autocorr =       1.244468376835
   target nu stat err =       0.000405279471
   target dn stat err =       0.001929205749
      target stat err =       0.003358286452
              std dev =       0.513780564071
             le_variance =       0.263970468017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.263986042783
                                         uncertainty =       0.001261553944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.263986042783
                                         uncertainty =       0.001261553944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363297721
  error estimate for blocks of size 2^( 2) =       0.000377136694
  error estimate for blocks of size 2^( 3) =       0.000389842873
  error estimate for blocks of size 2^( 4) =       0.000399670009
  error estimate for blocks of size 2^( 5) =       0.000404357349
  error estimate for blocks of size 2^( 6) =       0.000407870358
  error estimate for blocks of size 2^( 7) =       0.000409220170

      target function =      -0.954458907518
              le_mean =     -17.211933462908
             les_mean =     296.524929222669
             stat err =       0.000405279471
             autocorr =       1.244468376835
   target nu stat err =       0.000405279471
   target dn stat err =       0.001929205749
      target stat err =       0.003358286452
              std dev =       0.513780564071
             le_variance =       0.263970468017


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.954458907518        initial  <--
     2.3283e+38     2.3283e+39             4.0913e-43        -0.954458907518
     9.3132e+38     9.3132e+39             1.1023e-43        -0.954458907518
     3.7253e+39     3.7253e+40             2.7558e-44        -0.954458907518

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1759
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2031e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.1952
    reference variance = 0.253049
====================================================
  Execution time = 1.3932e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7970e-01
  Total weights = 1.957182632e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268723887349
                                         uncertainty =       0.001986389114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268723887349
                                         uncertainty =       0.001986389114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366519427
  error estimate for blocks of size 2^( 2) =       0.000380422090
  error estimate for blocks of size 2^( 3) =       0.000393181008
  error estimate for blocks of size 2^( 4) =       0.000402850080
  error estimate for blocks of size 2^( 5) =       0.000407832148
  error estimate for blocks of size 2^( 6) =       0.000410439500
  error estimate for blocks of size 2^( 7) =       0.000414807037

      target function =      -0.945321612188
              le_mean =     -17.212109958316
             les_mean =     296.536430875548
             stat err =       0.000408982191
             autocorr =       1.245130284756
   target nu stat err =       0.000408982191
   target dn stat err =       0.002342634156
      target stat err =       0.003974146676
              std dev =       0.518336745040
             le_variance =       0.268672981259


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721210995832e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+39, overlap shift 2.3283e+40 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945337450183       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945337450183       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+39, overlap shift 9.3132e+40 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945337450183       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945337450183       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+40, overlap shift 3.7253e+41 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945337450183       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945337450183       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.312694 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6466e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2186
    reference variance = 0.524189
====================================================
  Execution time = 1.3566e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7790e-01
  Total weights = 1.9574e+06
  Execution time = 1.8318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267637681780
                                         uncertainty =       0.001478292705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267637681780
                                         uncertainty =       0.001478292705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365814012
  error estimate for blocks of size 2^( 2) =       0.000379780050
  error estimate for blocks of size 2^( 3) =       0.000392687828
  error estimate for blocks of size 2^( 4) =       0.000400974731
  error estimate for blocks of size 2^( 5) =       0.000407388866
  error estimate for blocks of size 2^( 6) =       0.000411419810
  error estimate for blocks of size 2^( 7) =       0.000413324320

      target function =      -0.948343485340
              le_mean =     -17.211902016369
             les_mean =     296.527466977459
             stat err =       0.000408276932
             autocorr =       1.245629862581
   target nu stat err =       0.000408276932
   target dn stat err =       0.001871714369
      target stat err =       0.003223234319
              std dev =       0.517339137277
             le_variance =       0.267639782959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267637681780
                                         uncertainty =       0.001478292705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267637681780
                                         uncertainty =       0.001478292705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365814012
  error estimate for blocks of size 2^( 2) =       0.000379780050
  error estimate for blocks of size 2^( 3) =       0.000392687828
  error estimate for blocks of size 2^( 4) =       0.000400974731
  error estimate for blocks of size 2^( 5) =       0.000407388866
  error estimate for blocks of size 2^( 6) =       0.000411419810
  error estimate for blocks of size 2^( 7) =       0.000413324320

      target function =      -0.948343485340
              le_mean =     -17.211902016369
             les_mean =     296.527466977459
             stat err =       0.000408276932
             autocorr =       1.245629862581
   target nu stat err =       0.000408276932
   target dn stat err =       0.001871714369
      target stat err =       0.003223234319
              std dev =       0.517339137277
             le_variance =       0.267639782959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267637681780
                                         uncertainty =       0.001478292705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267637681780
                                         uncertainty =       0.001478292705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365814012
  error estimate for blocks of size 2^( 2) =       0.000379780050
  error estimate for blocks of size 2^( 3) =       0.000392687828
  error estimate for blocks of size 2^( 4) =       0.000400974731
  error estimate for blocks of size 2^( 5) =       0.000407388866
  error estimate for blocks of size 2^( 6) =       0.000411419810
  error estimate for blocks of size 2^( 7) =       0.000413324320

      target function =      -0.948343485340
              le_mean =     -17.211902016369
             les_mean =     296.527466977459
             stat err =       0.000408276932
             autocorr =       1.245629862581
   target nu stat err =       0.000408276932
   target dn stat err =       0.001871714369
      target stat err =       0.003223234319
              std dev =       0.517339137277
             le_variance =       0.267639782959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267637681780
                                         uncertainty =       0.001478292705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267637681780
                                         uncertainty =       0.001478292705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365814012
  error estimate for blocks of size 2^( 2) =       0.000379780050
  error estimate for blocks of size 2^( 3) =       0.000392687828
  error estimate for blocks of size 2^( 4) =       0.000400974731
  error estimate for blocks of size 2^( 5) =       0.000407388866
  error estimate for blocks of size 2^( 6) =       0.000411419810
  error estimate for blocks of size 2^( 7) =       0.000413324320

      target function =      -0.948343485340
              le_mean =     -17.211902016369
             les_mean =     296.527466977459
             stat err =       0.000408276932
             autocorr =       1.245629862581
   target nu stat err =       0.000408276932
   target dn stat err =       0.001871714369
      target stat err =       0.003223234319
              std dev =       0.517339137277
             le_variance =       0.267639782959


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948343485340        initial  <--
     2.3283e+39     2.3283e+40             0.0000e+00        -0.948343485340
     9.3132e+39     9.3132e+40             0.0000e+00        -0.948343485340
     3.7253e+40     3.7253e+41             0.0000e+00        -0.948343485340

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8301
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9303e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2311
    reference variance = 0.293923
====================================================
  Execution time = 1.4038e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8275e-01
  Total weights = 1.957444523e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5328e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267615923895
                                         uncertainty =       0.001679852959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267615923895
                                         uncertainty =       0.001679852959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365819315
  error estimate for blocks of size 2^( 2) =       0.000379712282
  error estimate for blocks of size 2^( 3) =       0.000392399084
  error estimate for blocks of size 2^( 4) =       0.000401378534
  error estimate for blocks of size 2^( 5) =       0.000407248215
  error estimate for blocks of size 2^( 6) =       0.000410211133
  error estimate for blocks of size 2^( 7) =       0.000411865196

      target function =      -0.940254912473
              le_mean =     -17.211983996910
             les_mean =     296.535140978271
             stat err =       0.000407675770
             autocorr =       1.241928336436
   target nu stat err =       0.000407675770
   target dn stat err =       0.003028553149
      target stat err =       0.005048150835
              std dev =       0.517346636017
             le_variance =       0.267647541798


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721198399691e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+40, overlap shift 2.3283e+41 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940281083488       residual = 9.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940281083488       residual = 9.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+40, overlap shift 9.3132e+41 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940281083488       residual = 9.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940281083488       residual = 9.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+41, overlap shift 3.7253e+42 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940281083488       residual = 9.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940281083488       residual = 9.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.313812 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6577e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.1913
    reference variance = 0.205979
====================================================
  Execution time = 1.3904e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8377e-01
  Total weights = 1.9571e+06
  Execution time = 1.8301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270834486539
                                         uncertainty =       0.002169887427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270834486539
                                         uncertainty =       0.002169887427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368001539
  error estimate for blocks of size 2^( 2) =       0.000381506944
  error estimate for blocks of size 2^( 3) =       0.000394129130
  error estimate for blocks of size 2^( 4) =       0.000403464871
  error estimate for blocks of size 2^( 5) =       0.000409307473
  error estimate for blocks of size 2^( 6) =       0.000411044142
  error estimate for blocks of size 2^( 7) =       0.000410694086

      target function =      -0.938564513922
              le_mean =     -17.211556189191
             les_mean =     296.521439939756
             stat err =       0.000408627643
             autocorr =       1.232980517929
   target nu stat err =       0.000408627643
   target dn stat err =       0.002831667195
      target stat err =       0.004706478244
              std dev =       0.520432767930
             le_variance =       0.270850265936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270834486539
                                         uncertainty =       0.002169887427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270834486539
                                         uncertainty =       0.002169887427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368001539
  error estimate for blocks of size 2^( 2) =       0.000381506944
  error estimate for blocks of size 2^( 3) =       0.000394129130
  error estimate for blocks of size 2^( 4) =       0.000403464871
  error estimate for blocks of size 2^( 5) =       0.000409307473
  error estimate for blocks of size 2^( 6) =       0.000411044142
  error estimate for blocks of size 2^( 7) =       0.000410694086

      target function =      -0.938564513922
              le_mean =     -17.211556189191
             les_mean =     296.521439939756
             stat err =       0.000408627643
             autocorr =       1.232980517929
   target nu stat err =       0.000408627643
   target dn stat err =       0.002831667195
      target stat err =       0.004706478244
              std dev =       0.520432767930
             le_variance =       0.270850265936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270834486539
                                         uncertainty =       0.002169887427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270834486539
                                         uncertainty =       0.002169887427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368001539
  error estimate for blocks of size 2^( 2) =       0.000381506944
  error estimate for blocks of size 2^( 3) =       0.000394129130
  error estimate for blocks of size 2^( 4) =       0.000403464871
  error estimate for blocks of size 2^( 5) =       0.000409307473
  error estimate for blocks of size 2^( 6) =       0.000411044142
  error estimate for blocks of size 2^( 7) =       0.000410694086

      target function =      -0.938564513922
              le_mean =     -17.211556189191
             les_mean =     296.521439939756
             stat err =       0.000408627643
             autocorr =       1.232980517929
   target nu stat err =       0.000408627643
   target dn stat err =       0.002831667195
      target stat err =       0.004706478244
              std dev =       0.520432767930
             le_variance =       0.270850265936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270834486539
                                         uncertainty =       0.002169887427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270834486539
                                         uncertainty =       0.002169887427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368001539
  error estimate for blocks of size 2^( 2) =       0.000381506944
  error estimate for blocks of size 2^( 3) =       0.000394129130
  error estimate for blocks of size 2^( 4) =       0.000403464871
  error estimate for blocks of size 2^( 5) =       0.000409307473
  error estimate for blocks of size 2^( 6) =       0.000411044142
  error estimate for blocks of size 2^( 7) =       0.000410694086

      target function =      -0.938564513922
              le_mean =     -17.211556189191
             les_mean =     296.521439939756
             stat err =       0.000408627643
             autocorr =       1.232980517929
   target nu stat err =       0.000408627643
   target dn stat err =       0.002831667195
      target stat err =       0.004706478244
              std dev =       0.520432767930
             le_variance =       0.270850265936


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938564513922        initial  <--
     2.3283e+40     2.3283e+41             0.0000e+00        -0.938564513922
     9.3132e+40     9.3132e+41             0.0000e+00        -0.938564513922
     3.7253e+41     3.7253e+42             0.0000e+00        -0.938564513922

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1701
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9753e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2674
    reference variance = 0.19798
====================================================
  Execution time = 1.4011e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7932e-01
  Total weights = 1.957537635e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268059228846
                                         uncertainty =       0.001339359741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268059228846
                                         uncertainty =       0.001339359741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366106467
  error estimate for blocks of size 2^( 2) =       0.000379772465
  error estimate for blocks of size 2^( 3) =       0.000392197539
  error estimate for blocks of size 2^( 4) =       0.000400689503
  error estimate for blocks of size 2^( 5) =       0.000405868987
  error estimate for blocks of size 2^( 6) =       0.000408922947
  error estimate for blocks of size 2^( 7) =       0.000410467541

      target function =      -0.945961303751
              le_mean =     -17.212507963057
             les_mean =     296.549754330340
             stat err =       0.000406487245
             autocorr =       1.232761448330
   target nu stat err =       0.000406487245
   target dn stat err =       0.002347931821
      target stat err =       0.003990310819
              std dev =       0.517752730639
             le_variance =       0.268067890084


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721250796306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+41, overlap shift 2.3283e+42 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945977201253       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945977201253       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945977201253       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953125000000       residual = 3.42e+03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       0.000000000000       residual = 1.62e+10           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+41 is 6.391568e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+41, overlap shift 9.3132e+42 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945977201253       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945977201253       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945977201253       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937500000000       residual = 3.42e+03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945977201253       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+41 is 1.535596e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+42, overlap shift 3.7253e+43 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945977201253       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945977201253       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945977201253       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937500000000       residual = 3.42e+03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+42 is 3.994730e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.315695 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6507e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2128
    reference variance = 0.238362
====================================================
  Execution time = 1.3696e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7693e-01
  Total weights = 1.9575e+06
  Execution time = 1.8359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266371194496
                                         uncertainty =       0.001523545652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266371194496
                                         uncertainty =       0.001523545652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364945403
  error estimate for blocks of size 2^( 2) =       0.000378898024
  error estimate for blocks of size 2^( 3) =       0.000391528435
  error estimate for blocks of size 2^( 4) =       0.000401187702
  error estimate for blocks of size 2^( 5) =       0.000406215288
  error estimate for blocks of size 2^( 6) =       0.000410287279
  error estimate for blocks of size 2^( 7) =       0.000411963644

      target function =      -0.949952612312
              le_mean =     -17.211582885007
             les_mean =     296.515516735452
             stat err =       0.000407413478
             autocorr =       1.246278175979
   target nu stat err =       0.000407413478
   target dn stat err =       0.002052592997
      target stat err =       0.003529023040
              std dev =       0.516110738536
             le_variance =       0.266370294432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266371194496
                                         uncertainty =       0.001523545652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266371194496
                                         uncertainty =       0.001523545652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364945403
  error estimate for blocks of size 2^( 2) =       0.000378898024
  error estimate for blocks of size 2^( 3) =       0.000391528435
  error estimate for blocks of size 2^( 4) =       0.000401187702
  error estimate for blocks of size 2^( 5) =       0.000406215288
  error estimate for blocks of size 2^( 6) =       0.000410287279
  error estimate for blocks of size 2^( 7) =       0.000411963644

      target function =      -0.949952612312
              le_mean =     -17.211582885007
             les_mean =     296.515516735452
             stat err =       0.000407413478
             autocorr =       1.246278175979
   target nu stat err =       0.000407413478
   target dn stat err =       0.002052592997
      target stat err =       0.003529023040
              std dev =       0.516110738536
             le_variance =       0.266370294432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266371194496
                                         uncertainty =       0.001523545652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266371194496
                                         uncertainty =       0.001523545652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364945403
  error estimate for blocks of size 2^( 2) =       0.000378898024
  error estimate for blocks of size 2^( 3) =       0.000391528435
  error estimate for blocks of size 2^( 4) =       0.000401187702
  error estimate for blocks of size 2^( 5) =       0.000406215288
  error estimate for blocks of size 2^( 6) =       0.000410287279
  error estimate for blocks of size 2^( 7) =       0.000411963644

      target function =      -0.949952612312
              le_mean =     -17.211582885007
             les_mean =     296.515516735452
             stat err =       0.000407413478
             autocorr =       1.246278175979
   target nu stat err =       0.000407413478
   target dn stat err =       0.002052592997
      target stat err =       0.003529023040
              std dev =       0.516110738536
             le_variance =       0.266370294432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266371194496
                                         uncertainty =       0.001523545652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266371194496
                                         uncertainty =       0.001523545652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364945403
  error estimate for blocks of size 2^( 2) =       0.000378898024
  error estimate for blocks of size 2^( 3) =       0.000391528435
  error estimate for blocks of size 2^( 4) =       0.000401187702
  error estimate for blocks of size 2^( 5) =       0.000406215288
  error estimate for blocks of size 2^( 6) =       0.000410287279
  error estimate for blocks of size 2^( 7) =       0.000411963644

      target function =      -0.949952612312
              le_mean =     -17.211582885007
             les_mean =     296.515516735452
             stat err =       0.000407413478
             autocorr =       1.246278175979
   target nu stat err =       0.000407413478
   target dn stat err =       0.002052592997
      target stat err =       0.003529023040
              std dev =       0.516110738536
             le_variance =       0.266370294432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949952612312        initial  <--
     2.3283e+41     2.3283e+42             6.3916e-46        -0.949952612312
     9.3132e+41     9.3132e+42             1.5356e-46        -0.949952612312
     3.7253e+42     3.7253e+43             3.9947e-47        -0.949952612312

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9834
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9512e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2076
    reference variance = 0.506681
====================================================
  Execution time = 1.4117e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8159e-01
  Total weights = 1.957499180e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268325458792
                                         uncertainty =       0.001891383791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268325458792
                                         uncertainty =       0.001891383791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366305233
  error estimate for blocks of size 2^( 2) =       0.000380486422
  error estimate for blocks of size 2^( 3) =       0.000393254169
  error estimate for blocks of size 2^( 4) =       0.000403206289
  error estimate for blocks of size 2^( 5) =       0.000409329842
  error estimate for blocks of size 2^( 6) =       0.000412747700
  error estimate for blocks of size 2^( 7) =       0.000415799874

      target function =      -0.942145744530
              le_mean =     -17.211435845481
             les_mean =     296.515117185308
             stat err =       0.000410270926
             autocorr =       1.254455437632
   target nu stat err =       0.000410270926
   target dn stat err =       0.003467375149
      target stat err =       0.005783560124
              std dev =       0.518033827792
             le_variance =       0.268359046737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721143584548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+42, overlap shift 2.3283e+43 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942180231157       residual = 7.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942180231157       residual = 7.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+42, overlap shift 9.3132e+43 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942180231157       residual = 7.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942180231157       residual = 7.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+43, overlap shift 3.7253e+44 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942180231157       residual = 7.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942180231157       residual = 7.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.316787 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6614e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.286
    reference variance = 0.270681
====================================================
  Execution time = 1.3681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7596e-01
  Total weights = 1.9573e+06
  Execution time = 1.8251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265306257397
                                         uncertainty =       0.001266995897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265306257397
                                         uncertainty =       0.001266995897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364203712
  error estimate for blocks of size 2^( 2) =       0.000378013127
  error estimate for blocks of size 2^( 3) =       0.000390591250
  error estimate for blocks of size 2^( 4) =       0.000399905710
  error estimate for blocks of size 2^( 5) =       0.000406446850
  error estimate for blocks of size 2^( 6) =       0.000410507918
  error estimate for blocks of size 2^( 7) =       0.000411836637

      target function =      -0.951601428885
              le_mean =     -17.211850016069
             les_mean =     296.523740372737
             stat err =       0.000407174279
             autocorr =       1.249890407030
   target nu stat err =       0.000407174279
   target dn stat err =       0.002004090803
      target stat err =       0.003462517151
              std dev =       0.515061829536
             le_variance =       0.265288688245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265306257397
                                         uncertainty =       0.001266995897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265306257397
                                         uncertainty =       0.001266995897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364203712
  error estimate for blocks of size 2^( 2) =       0.000378013127
  error estimate for blocks of size 2^( 3) =       0.000390591250
  error estimate for blocks of size 2^( 4) =       0.000399905710
  error estimate for blocks of size 2^( 5) =       0.000406446850
  error estimate for blocks of size 2^( 6) =       0.000410507918
  error estimate for blocks of size 2^( 7) =       0.000411836637

      target function =      -0.951601428885
              le_mean =     -17.211850016069
             les_mean =     296.523740372737
             stat err =       0.000407174279
             autocorr =       1.249890407030
   target nu stat err =       0.000407174279
   target dn stat err =       0.002004090803
      target stat err =       0.003462517151
              std dev =       0.515061829536
             le_variance =       0.265288688245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265306257397
                                         uncertainty =       0.001266995897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265306257397
                                         uncertainty =       0.001266995897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364203712
  error estimate for blocks of size 2^( 2) =       0.000378013127
  error estimate for blocks of size 2^( 3) =       0.000390591250
  error estimate for blocks of size 2^( 4) =       0.000399905710
  error estimate for blocks of size 2^( 5) =       0.000406446850
  error estimate for blocks of size 2^( 6) =       0.000410507918
  error estimate for blocks of size 2^( 7) =       0.000411836637

      target function =      -0.951601428885
              le_mean =     -17.211850016069
             les_mean =     296.523740372737
             stat err =       0.000407174279
             autocorr =       1.249890407030
   target nu stat err =       0.000407174279
   target dn stat err =       0.002004090803
      target stat err =       0.003462517151
              std dev =       0.515061829536
             le_variance =       0.265288688245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265306257397
                                         uncertainty =       0.001266995897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265306257397
                                         uncertainty =       0.001266995897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364203712
  error estimate for blocks of size 2^( 2) =       0.000378013127
  error estimate for blocks of size 2^( 3) =       0.000390591250
  error estimate for blocks of size 2^( 4) =       0.000399905710
  error estimate for blocks of size 2^( 5) =       0.000406446850
  error estimate for blocks of size 2^( 6) =       0.000410507918
  error estimate for blocks of size 2^( 7) =       0.000411836637

      target function =      -0.951601428885
              le_mean =     -17.211850016069
             les_mean =     296.523740372737
             stat err =       0.000407174279
             autocorr =       1.249890407030
   target nu stat err =       0.000407174279
   target dn stat err =       0.002004090803
      target stat err =       0.003462517151
              std dev =       0.515061829536
             le_variance =       0.265288688245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951601428885        initial  <--
     2.3283e+42     2.3283e+43             0.0000e+00        -0.951601428885
     9.3132e+42     9.3132e+43             0.0000e+00        -0.951601428885
     3.7253e+43     3.7253e+44             0.0000e+00        -0.951601428885

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9309
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9572e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.1713
    reference variance = 0.19877
====================================================
  Execution time = 1.4203e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7915e-01
  Total weights = 1.957329605e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268222555875
                                         uncertainty =       0.002603536502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268222555875
                                         uncertainty =       0.002603536502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366179734
  error estimate for blocks of size 2^( 2) =       0.000379946977
  error estimate for blocks of size 2^( 3) =       0.000392880602
  error estimate for blocks of size 2^( 4) =       0.000402100346
  error estimate for blocks of size 2^( 5) =       0.000407240704
  error estimate for blocks of size 2^( 6) =       0.000409942152
  error estimate for blocks of size 2^( 7) =       0.000413200215

      target function =      -0.946210915885
              le_mean =     -17.212021114546
             les_mean =     296.532825137513
             stat err =       0.000408120854
             autocorr =       1.242192674093
   target nu stat err =       0.000408120854
   target dn stat err =       0.003612657282
      target stat err =       0.006080117713
              std dev =       0.517856346712
             le_variance =       0.268175195830


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721202111455e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+43, overlap shift 2.3283e+44 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946249310848       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946249310848       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946249310848       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+43 is 6.021446e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+43, overlap shift 9.3132e+44 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946249310848       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946249310848       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946249310848       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+43 is 1.505361e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+44, overlap shift 3.7253e+45 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946249310848       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946249310848       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946249310848       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+44 is 3.763404e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.318122 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6685e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.0315
    reference variance = 1.31348
====================================================
  Execution time = 1.3788e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9648e-01
  Total weights = 1.9573e+06
  Execution time = 1.8258e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584285258
                                         uncertainty =       0.011580972236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584285258
                                         uncertainty =       0.011580972236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371915969
  error estimate for blocks of size 2^( 2) =       0.000385582028
  error estimate for blocks of size 2^( 3) =       0.000397854259
  error estimate for blocks of size 2^( 4) =       0.000406947702
  error estimate for blocks of size 2^( 5) =       0.000411847246
  error estimate for blocks of size 2^( 6) =       0.000414860561
  error estimate for blocks of size 2^( 7) =       0.000417098891

      target function =      -0.916944134535
              le_mean =     -17.211570001378
             les_mean =     296.534626453061
             stat err =       0.000412688600
             autocorr =       1.231275652243
   target nu stat err =       0.000412688600
   target dn stat err =       0.021313838576
      target stat err =       0.033471261284
              std dev =       0.525968607501
             le_variance =       0.276642976077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584285258
                                         uncertainty =       0.011580972236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584285258
                                         uncertainty =       0.011580972236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371915969
  error estimate for blocks of size 2^( 2) =       0.000385582028
  error estimate for blocks of size 2^( 3) =       0.000397854259
  error estimate for blocks of size 2^( 4) =       0.000406947702
  error estimate for blocks of size 2^( 5) =       0.000411847246
  error estimate for blocks of size 2^( 6) =       0.000414860561
  error estimate for blocks of size 2^( 7) =       0.000417098891

      target function =      -0.916944134535
              le_mean =     -17.211570001378
             les_mean =     296.534626453061
             stat err =       0.000412688600
             autocorr =       1.231275652243
   target nu stat err =       0.000412688600
   target dn stat err =       0.021313838576
      target stat err =       0.033471261284
              std dev =       0.525968607501
             le_variance =       0.276642976077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584285258
                                         uncertainty =       0.011580972236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584285258
                                         uncertainty =       0.011580972236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371915969
  error estimate for blocks of size 2^( 2) =       0.000385582028
  error estimate for blocks of size 2^( 3) =       0.000397854259
  error estimate for blocks of size 2^( 4) =       0.000406947702
  error estimate for blocks of size 2^( 5) =       0.000411847246
  error estimate for blocks of size 2^( 6) =       0.000414860561
  error estimate for blocks of size 2^( 7) =       0.000417098891

      target function =      -0.916944134535
              le_mean =     -17.211570001378
             les_mean =     296.534626453061
             stat err =       0.000412688600
             autocorr =       1.231275652243
   target nu stat err =       0.000412688600
   target dn stat err =       0.021313838576
      target stat err =       0.033471261284
              std dev =       0.525968607501
             le_variance =       0.276642976077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584285258
                                         uncertainty =       0.011580972236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584285258
                                         uncertainty =       0.011580972236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371915969
  error estimate for blocks of size 2^( 2) =       0.000385582028
  error estimate for blocks of size 2^( 3) =       0.000397854259
  error estimate for blocks of size 2^( 4) =       0.000406947702
  error estimate for blocks of size 2^( 5) =       0.000411847246
  error estimate for blocks of size 2^( 6) =       0.000414860561
  error estimate for blocks of size 2^( 7) =       0.000417098891

      target function =      -0.916944134535
              le_mean =     -17.211570001378
             les_mean =     296.534626453061
             stat err =       0.000412688600
             autocorr =       1.231275652243
   target nu stat err =       0.000412688600
   target dn stat err =       0.021313838576
      target stat err =       0.033471261284
              std dev =       0.525968607501
             le_variance =       0.276642976077


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916944134535        initial  <--
     2.3283e+43     2.3283e+44             6.0214e-48        -0.916944134535
     9.3132e+43     9.3132e+44             1.5054e-48        -0.916944134535
     3.7253e+44     3.7253e+45             3.7634e-49        -0.916944134535

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0322
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9723e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.3216
    reference variance = 0.417686
====================================================
  Execution time = 1.4311e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7963e-01
  Total weights = 1.957483736e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268455671339
                                         uncertainty =       0.001488557593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268455671339
                                         uncertainty =       0.001488557593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366375339
  error estimate for blocks of size 2^( 2) =       0.000380486477
  error estimate for blocks of size 2^( 3) =       0.000393077446
  error estimate for blocks of size 2^( 4) =       0.000402254449
  error estimate for blocks of size 2^( 5) =       0.000408607623
  error estimate for blocks of size 2^( 6) =       0.000410618528
  error estimate for blocks of size 2^( 7) =       0.000411690993

      target function =      -0.945438300348
              le_mean =     -17.211900161607
             les_mean =     296.529139219938
             stat err =       0.000408292898
             autocorr =       1.241913032217
   target nu stat err =       0.000408292898
   target dn stat err =       0.001922120504
      target stat err =       0.003285986969
              std dev =       0.518132973752
             le_variance =       0.268461778489


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721190016161e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+44, overlap shift 2.3283e+45 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945448735263       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945448735263       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+44, overlap shift 9.3132e+45 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945448735263       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945448735263       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+45, overlap shift 3.7253e+46 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945448735263       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945448735263       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.319205 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6794e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2355
    reference variance = 0.248698
====================================================
  Execution time = 1.3644e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8026e-01
  Total weights = 1.9574e+06
  Execution time = 1.8226e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268259208542
                                         uncertainty =       0.001695790193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268259208542
                                         uncertainty =       0.001695790193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366289185
  error estimate for blocks of size 2^( 2) =       0.000380566634
  error estimate for blocks of size 2^( 3) =       0.000393681956
  error estimate for blocks of size 2^( 4) =       0.000403114276
  error estimate for blocks of size 2^( 5) =       0.000408272326
  error estimate for blocks of size 2^( 6) =       0.000411525611
  error estimate for blocks of size 2^( 7) =       0.000414494498

      target function =      -0.944383835530
              le_mean =     -17.211741107006
             les_mean =     296.524292227353
             stat err =       0.000409351678
             autocorr =       1.248949730505
   target nu stat err =       0.000409351678
   target dn stat err =       0.002281333772
      target stat err =       0.003863536794
              std dev =       0.518011132617
             le_variance =       0.268335533515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268259208542
                                         uncertainty =       0.001695790193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268259208542
                                         uncertainty =       0.001695790193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366289185
  error estimate for blocks of size 2^( 2) =       0.000380566634
  error estimate for blocks of size 2^( 3) =       0.000393681956
  error estimate for blocks of size 2^( 4) =       0.000403114276
  error estimate for blocks of size 2^( 5) =       0.000408272326
  error estimate for blocks of size 2^( 6) =       0.000411525611
  error estimate for blocks of size 2^( 7) =       0.000414494498

      target function =      -0.944383835530
              le_mean =     -17.211741107006
             les_mean =     296.524292227353
             stat err =       0.000409351678
             autocorr =       1.248949730505
   target nu stat err =       0.000409351678
   target dn stat err =       0.002281333772
      target stat err =       0.003863536794
              std dev =       0.518011132617
             le_variance =       0.268335533515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268259208542
                                         uncertainty =       0.001695790193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268259208542
                                         uncertainty =       0.001695790193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366289185
  error estimate for blocks of size 2^( 2) =       0.000380566634
  error estimate for blocks of size 2^( 3) =       0.000393681956
  error estimate for blocks of size 2^( 4) =       0.000403114276
  error estimate for blocks of size 2^( 5) =       0.000408272326
  error estimate for blocks of size 2^( 6) =       0.000411525611
  error estimate for blocks of size 2^( 7) =       0.000414494498

      target function =      -0.944383835530
              le_mean =     -17.211741107006
             les_mean =     296.524292227353
             stat err =       0.000409351678
             autocorr =       1.248949730505
   target nu stat err =       0.000409351678
   target dn stat err =       0.002281333772
      target stat err =       0.003863536794
              std dev =       0.518011132617
             le_variance =       0.268335533515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268259208542
                                         uncertainty =       0.001695790193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268259208542
                                         uncertainty =       0.001695790193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366289185
  error estimate for blocks of size 2^( 2) =       0.000380566634
  error estimate for blocks of size 2^( 3) =       0.000393681956
  error estimate for blocks of size 2^( 4) =       0.000403114276
  error estimate for blocks of size 2^( 5) =       0.000408272326
  error estimate for blocks of size 2^( 6) =       0.000411525611
  error estimate for blocks of size 2^( 7) =       0.000414494498

      target function =      -0.944383835530
              le_mean =     -17.211741107006
             les_mean =     296.524292227353
             stat err =       0.000409351678
             autocorr =       1.248949730505
   target nu stat err =       0.000409351678
   target dn stat err =       0.002281333772
      target stat err =       0.003863536794
              std dev =       0.518011132617
             le_variance =       0.268335533515


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944383835530        initial  <--
     2.3283e+44     2.3283e+45             0.0000e+00        -0.944383835530
     9.3132e+44     9.3132e+45             0.0000e+00        -0.944383835530
     3.7253e+45     3.7253e+46             0.0000e+00        -0.944383835530

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8410
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9640e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2021
    reference variance = 0.201211
====================================================
  Execution time = 1.6424e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8126e-01
  Total weights = 1.957205147e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267999264852
                                         uncertainty =       0.001430929113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267999264852
                                         uncertainty =       0.001430929113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366042576
  error estimate for blocks of size 2^( 2) =       0.000379757084
  error estimate for blocks of size 2^( 3) =       0.000392416791
  error estimate for blocks of size 2^( 4) =       0.000401943779
  error estimate for blocks of size 2^( 5) =       0.000407487089
  error estimate for blocks of size 2^( 6) =       0.000410324752
  error estimate for blocks of size 2^( 7) =       0.000411233019

      target function =      -0.942726395728
              le_mean =     -17.212089354355
             les_mean =     296.537275986992
             stat err =       0.000407747160
             autocorr =       1.240848278314
   target nu stat err =       0.000407747160
   target dn stat err =       0.002937073640
      target stat err =       0.004925267697
              std dev =       0.517662375802
             le_variance =       0.267974335321


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721208935436e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+45, overlap shift 2.3283e+46 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942751053917       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942751053917       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+45, overlap shift 9.3132e+46 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942751053917       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942751053917       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+46, overlap shift 3.7253e+47 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942751053917       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942751053917       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.320265 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8925e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2657
    reference variance = 0.286574
====================================================
  Execution time = 1.6147e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7951e-01
  Total weights = 1.9577e+06
  Execution time = 1.8294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268253692621
                                         uncertainty =       0.001692285330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268253692621
                                         uncertainty =       0.001692285330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366226846
  error estimate for blocks of size 2^( 2) =       0.000380294529
  error estimate for blocks of size 2^( 3) =       0.000393036256
  error estimate for blocks of size 2^( 4) =       0.000401862247
  error estimate for blocks of size 2^( 5) =       0.000407701905
  error estimate for blocks of size 2^( 6) =       0.000410296476
  error estimate for blocks of size 2^( 7) =       0.000410990678

      target function =      -0.945621320479
              le_mean =     -17.211514088588
             les_mean =     296.515731610741
             stat err =       0.000407712827
             autocorr =       1.239391160555
   target nu stat err =       0.000407712827
   target dn stat err =       0.002229736956
      target stat err =       0.003786808870
              std dev =       0.517922973160
             le_variance =       0.268244206127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268253692621
                                         uncertainty =       0.001692285330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268253692621
                                         uncertainty =       0.001692285330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366226846
  error estimate for blocks of size 2^( 2) =       0.000380294529
  error estimate for blocks of size 2^( 3) =       0.000393036256
  error estimate for blocks of size 2^( 4) =       0.000401862247
  error estimate for blocks of size 2^( 5) =       0.000407701905
  error estimate for blocks of size 2^( 6) =       0.000410296476
  error estimate for blocks of size 2^( 7) =       0.000410990678

      target function =      -0.945621320479
              le_mean =     -17.211514088588
             les_mean =     296.515731610741
             stat err =       0.000407712827
             autocorr =       1.239391160555
   target nu stat err =       0.000407712827
   target dn stat err =       0.002229736956
      target stat err =       0.003786808870
              std dev =       0.517922973160
             le_variance =       0.268244206127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268253692621
                                         uncertainty =       0.001692285330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268253692621
                                         uncertainty =       0.001692285330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366226846
  error estimate for blocks of size 2^( 2) =       0.000380294529
  error estimate for blocks of size 2^( 3) =       0.000393036256
  error estimate for blocks of size 2^( 4) =       0.000401862247
  error estimate for blocks of size 2^( 5) =       0.000407701905
  error estimate for blocks of size 2^( 6) =       0.000410296476
  error estimate for blocks of size 2^( 7) =       0.000410990678

      target function =      -0.945621320479
              le_mean =     -17.211514088588
             les_mean =     296.515731610741
             stat err =       0.000407712827
             autocorr =       1.239391160555
   target nu stat err =       0.000407712827
   target dn stat err =       0.002229736956
      target stat err =       0.003786808870
              std dev =       0.517922973160
             le_variance =       0.268244206127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268253692621
                                         uncertainty =       0.001692285330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268253692621
                                         uncertainty =       0.001692285330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366226846
  error estimate for blocks of size 2^( 2) =       0.000380294529
  error estimate for blocks of size 2^( 3) =       0.000393036256
  error estimate for blocks of size 2^( 4) =       0.000401862247
  error estimate for blocks of size 2^( 5) =       0.000407701905
  error estimate for blocks of size 2^( 6) =       0.000410296476
  error estimate for blocks of size 2^( 7) =       0.000410990678

      target function =      -0.945621320479
              le_mean =     -17.211514088588
             les_mean =     296.515731610741
             stat err =       0.000407712827
             autocorr =       1.239391160555
   target nu stat err =       0.000407712827
   target dn stat err =       0.002229736956
      target stat err =       0.003786808870
              std dev =       0.517922973160
             le_variance =       0.268244206127


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945621320479        initial  <--
     2.3283e+45     2.3283e+46             0.0000e+00        -0.945621320479
     9.3132e+45     9.3132e+46             0.0000e+00        -0.945621320479
     3.7253e+46     3.7253e+47             0.0000e+00        -0.945621320479

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.3921
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4324e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2888
    reference variance = 0.242402
====================================================
  Execution time = 1.3903e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7299e-01
  Total weights = 1.957576999e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264402046609
                                         uncertainty =       0.001290035387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264402046609
                                         uncertainty =       0.001290035387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363623009
  error estimate for blocks of size 2^( 2) =       0.000377516364
  error estimate for blocks of size 2^( 3) =       0.000389968783
  error estimate for blocks of size 2^( 4) =       0.000399712299
  error estimate for blocks of size 2^( 5) =       0.000406096212
  error estimate for blocks of size 2^( 6) =       0.000408670323
  error estimate for blocks of size 2^( 7) =       0.000410132498

      target function =      -0.956672388437
              le_mean =     -17.212306079827
             les_mean =     296.536469358877
             stat err =       0.000406152833
             autocorr =       1.247602571915
   target nu stat err =       0.000406152833
   target dn stat err =       0.001546379913
      target stat err =       0.002740784133
              std dev =       0.514240590800
             le_variance =       0.264443385226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721230607983e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+46, overlap shift 2.3283e+47 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.956679235395       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.956679235395       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+46, overlap shift 9.3132e+47 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.956679235395       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.956679235395       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+47, overlap shift 3.7253e+48 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.956679235395       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.956679235395       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.321394 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6431e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2226
    reference variance = 0.216572
====================================================
  Execution time = 1.3910e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8116e-01
  Total weights = 1.9573e+06
  Execution time = 1.8356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266966048855
                                         uncertainty =       0.001652419513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266966048855
                                         uncertainty =       0.001652419513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365330579
  error estimate for blocks of size 2^( 2) =       0.000379352013
  error estimate for blocks of size 2^( 3) =       0.000391912877
  error estimate for blocks of size 2^( 4) =       0.000401053296
  error estimate for blocks of size 2^( 5) =       0.000406218031
  error estimate for blocks of size 2^( 6) =       0.000409658986
  error estimate for blocks of size 2^( 7) =       0.000409621999

      target function =      -0.942882212508
              le_mean =     -17.211520774897
             les_mean =     296.517603971356
             stat err =       0.000406638078
             autocorr =       1.238922205719
   target nu stat err =       0.000406638078
   target dn stat err =       0.002848167348
      target stat err =       0.004775583923
              std dev =       0.516655460030
             le_variance =       0.266932864378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266966048855
                                         uncertainty =       0.001652419513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266966048855
                                         uncertainty =       0.001652419513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365330579
  error estimate for blocks of size 2^( 2) =       0.000379352013
  error estimate for blocks of size 2^( 3) =       0.000391912877
  error estimate for blocks of size 2^( 4) =       0.000401053296
  error estimate for blocks of size 2^( 5) =       0.000406218031
  error estimate for blocks of size 2^( 6) =       0.000409658986
  error estimate for blocks of size 2^( 7) =       0.000409621999

      target function =      -0.942882212508
              le_mean =     -17.211520774897
             les_mean =     296.517603971356
             stat err =       0.000406638078
             autocorr =       1.238922205721
   target nu stat err =       0.000406638078
   target dn stat err =       0.002848167348
      target stat err =       0.004775583923
              std dev =       0.516655460030
             le_variance =       0.266932864378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266966048855
                                         uncertainty =       0.001652419513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266966048855
                                         uncertainty =       0.001652419513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365330579
  error estimate for blocks of size 2^( 2) =       0.000379352013
  error estimate for blocks of size 2^( 3) =       0.000391912877
  error estimate for blocks of size 2^( 4) =       0.000401053296
  error estimate for blocks of size 2^( 5) =       0.000406218031
  error estimate for blocks of size 2^( 6) =       0.000409658986
  error estimate for blocks of size 2^( 7) =       0.000409621999

      target function =      -0.942882212508
              le_mean =     -17.211520774897
             les_mean =     296.517603971356
             stat err =       0.000406638078
             autocorr =       1.238922205721
   target nu stat err =       0.000406638078
   target dn stat err =       0.002848167348
      target stat err =       0.004775583923
              std dev =       0.516655460030
             le_variance =       0.266932864378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266966048855
                                         uncertainty =       0.001652419513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266966048855
                                         uncertainty =       0.001652419513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365330579
  error estimate for blocks of size 2^( 2) =       0.000379352013
  error estimate for blocks of size 2^( 3) =       0.000391912877
  error estimate for blocks of size 2^( 4) =       0.000401053296
  error estimate for blocks of size 2^( 5) =       0.000406218031
  error estimate for blocks of size 2^( 6) =       0.000409658986
  error estimate for blocks of size 2^( 7) =       0.000409621999

      target function =      -0.942882212508
              le_mean =     -17.211520774897
             les_mean =     296.517603971356
             stat err =       0.000406638078
             autocorr =       1.238922205721
   target nu stat err =       0.000406638078
   target dn stat err =       0.002848167348
      target stat err =       0.004775583923
              std dev =       0.516655460030
             le_variance =       0.266932864378


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942882212508        initial  <--
     2.3283e+46     2.3283e+47             0.0000e+00        -0.942882212508
     9.3132e+46     9.3132e+47             0.0000e+00        -0.942882212508
     3.7253e+47     3.7253e+48             0.0000e+00        -0.942882212508

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2926
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9729e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.37
    reference variance = 0.884647
====================================================
  Execution time = 1.3939e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7689e-01
  Total weights = 1.957381065e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265390505032
                                         uncertainty =       0.001454749018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265390505032
                                         uncertainty =       0.001454749018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364390287
  error estimate for blocks of size 2^( 2) =       0.000378563156
  error estimate for blocks of size 2^( 3) =       0.000391744113
  error estimate for blocks of size 2^( 4) =       0.000400814057
  error estimate for blocks of size 2^( 5) =       0.000406249089
  error estimate for blocks of size 2^( 6) =       0.000410551828
  error estimate for blocks of size 2^( 7) =       0.000412973786

      target function =      -0.950042410882
              le_mean =     -17.212026908564
             les_mean =     296.530756982016
             stat err =       0.000407647190
             autocorr =       1.251512873688
   target nu stat err =       0.000407647190
   target dn stat err =       0.002040669802
      target stat err =       0.003513026583
              std dev =       0.515325685916
             le_variance =       0.265560562565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721202690856e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+47, overlap shift 2.3283e+48 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950054372823       residual = 8.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950054372823       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950054372823       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950054372823       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950054372823       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 8.30e+05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.000000000000       residual = 1.78e+13           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+47 is 6.834693e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+47, overlap shift 9.3132e+48 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950054372823       residual = 8.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950054372823       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950054372823       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -1.000000000000       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950054372823       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 4.59e+07           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+47 is 1.707146e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+48, overlap shift 3.7253e+49 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950054372823       residual = 8.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950054372823       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950054372823       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -1.000000000000       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+48 is 3.754290e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.325041 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6470e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2416
    reference variance = 0.19734
====================================================
  Execution time = 1.3900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7878e-01
  Total weights = 1.9573e+06
  Execution time = 1.8320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266515478982
                                         uncertainty =       0.001305092331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266515478982
                                         uncertainty =       0.001305092331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365064729
  error estimate for blocks of size 2^( 2) =       0.000379295296
  error estimate for blocks of size 2^( 3) =       0.000392105045
  error estimate for blocks of size 2^( 4) =       0.000401219879
  error estimate for blocks of size 2^( 5) =       0.000406603276
  error estimate for blocks of size 2^( 6) =       0.000410306141
  error estimate for blocks of size 2^( 7) =       0.000410265301

      target function =      -0.946866317333
              le_mean =     -17.211908346712
             les_mean =     296.528565216627
             stat err =       0.000407098649
             autocorr =       1.243539465789
   target nu stat err =       0.000407098649
   target dn stat err =       0.002064092199
      target stat err =       0.003527456690
              std dev =       0.516279490252
             le_variance =       0.266544512054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266515478982
                                         uncertainty =       0.001305092331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266515478982
                                         uncertainty =       0.001305092331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365064729
  error estimate for blocks of size 2^( 2) =       0.000379295296
  error estimate for blocks of size 2^( 3) =       0.000392105045
  error estimate for blocks of size 2^( 4) =       0.000401219879
  error estimate for blocks of size 2^( 5) =       0.000406603276
  error estimate for blocks of size 2^( 6) =       0.000410306141
  error estimate for blocks of size 2^( 7) =       0.000410265301

      target function =      -0.946866317333
              le_mean =     -17.211908346712
             les_mean =     296.528565216627
             stat err =       0.000407098649
             autocorr =       1.243539465789
   target nu stat err =       0.000407098649
   target dn stat err =       0.002064092199
      target stat err =       0.003527456690
              std dev =       0.516279490252
             le_variance =       0.266544512054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266515478982
                                         uncertainty =       0.001305092331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266515478982
                                         uncertainty =       0.001305092331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365064729
  error estimate for blocks of size 2^( 2) =       0.000379295296
  error estimate for blocks of size 2^( 3) =       0.000392105045
  error estimate for blocks of size 2^( 4) =       0.000401219879
  error estimate for blocks of size 2^( 5) =       0.000406603276
  error estimate for blocks of size 2^( 6) =       0.000410306141
  error estimate for blocks of size 2^( 7) =       0.000410265301

      target function =      -0.946866317333
              le_mean =     -17.211908346712
             les_mean =     296.528565216627
             stat err =       0.000407098649
             autocorr =       1.243539465789
   target nu stat err =       0.000407098649
   target dn stat err =       0.002064092199
      target stat err =       0.003527456690
              std dev =       0.516279490252
             le_variance =       0.266544512054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266515478982
                                         uncertainty =       0.001305092331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266515478982
                                         uncertainty =       0.001305092331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365064729
  error estimate for blocks of size 2^( 2) =       0.000379295296
  error estimate for blocks of size 2^( 3) =       0.000392105045
  error estimate for blocks of size 2^( 4) =       0.000401219879
  error estimate for blocks of size 2^( 5) =       0.000406603276
  error estimate for blocks of size 2^( 6) =       0.000410306141
  error estimate for blocks of size 2^( 7) =       0.000410265301

      target function =      -0.946866317333
              le_mean =     -17.211908346712
             les_mean =     296.528565216627
             stat err =       0.000407098649
             autocorr =       1.243539465789
   target nu stat err =       0.000407098649
   target dn stat err =       0.002064092199
      target stat err =       0.003527456690
              std dev =       0.516279490252
             le_variance =       0.266544512054


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946866317333        initial  <--
     2.3283e+47     2.3283e+48             6.8347e-52        -0.946866317333
     9.3132e+47     9.3132e+48             1.7071e-52        -0.946866317333
     3.7253e+48     3.7253e+49             3.7543e-53        -0.946866317333

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1602
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9636e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.1661
    reference variance = 0.170322
====================================================
  Execution time = 1.3991e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7727e-01
  Total weights = 1.957142185e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265211024179
                                         uncertainty =       0.001403436242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265211024179
                                         uncertainty =       0.001403436242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364096762
  error estimate for blocks of size 2^( 2) =       0.000377708453
  error estimate for blocks of size 2^( 3) =       0.000390161680
  error estimate for blocks of size 2^( 4) =       0.000399817048
  error estimate for blocks of size 2^( 5) =       0.000405774748
  error estimate for blocks of size 2^( 6) =       0.000408976949
  error estimate for blocks of size 2^( 7) =       0.000410819259

      target function =      -0.949385800251
              le_mean =     -17.211927352596
             les_mean =     296.527710156176
             stat err =       0.000406347001
             autocorr =       1.245548046701
   target nu stat err =       0.000406347001
   target dn stat err =       0.002928178453
      target stat err =       0.004977685109
              std dev =       0.514910578767
             le_variance =       0.265132904126


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721192735260e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+48, overlap shift 2.3283e+49 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949411068874       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949411068874       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+48, overlap shift 9.3132e+49 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949411068874       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949411068874       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+49, overlap shift 3.7253e+50 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949411068874       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949411068874       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.326093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6468e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2553
    reference variance = 0.238372
====================================================
  Execution time = 1.3721e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7848e-01
  Total weights = 1.9574e+06
  Execution time = 1.8378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267719603181
                                         uncertainty =       0.001526116070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267719603181
                                         uncertainty =       0.001526116070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365905291
  error estimate for blocks of size 2^( 2) =       0.000380028177
  error estimate for blocks of size 2^( 3) =       0.000392608290
  error estimate for blocks of size 2^( 4) =       0.000402870056
  error estimate for blocks of size 2^( 5) =       0.000409211788
  error estimate for blocks of size 2^( 6) =       0.000410828895
  error estimate for blocks of size 2^( 7) =       0.000412686554

      target function =      -0.947347220671
              le_mean =     -17.211052455818
             les_mean =     296.498801694541
             stat err =       0.000408899323
             autocorr =       1.248807229851
   target nu stat err =       0.000408899323
   target dn stat err =       0.001971775775
      target stat err =       0.003375036160
              std dev =       0.517468225052
             le_variance =       0.267773363938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267719603181
                                         uncertainty =       0.001526116070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267719603181
                                         uncertainty =       0.001526116070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365905291
  error estimate for blocks of size 2^( 2) =       0.000380028177
  error estimate for blocks of size 2^( 3) =       0.000392608290
  error estimate for blocks of size 2^( 4) =       0.000402870056
  error estimate for blocks of size 2^( 5) =       0.000409211788
  error estimate for blocks of size 2^( 6) =       0.000410828895
  error estimate for blocks of size 2^( 7) =       0.000412686554

      target function =      -0.947347220671
              le_mean =     -17.211052455818
             les_mean =     296.498801694541
             stat err =       0.000408899323
             autocorr =       1.248807229849
   target nu stat err =       0.000408899323
   target dn stat err =       0.001971775775
      target stat err =       0.003375036160
              std dev =       0.517468225052
             le_variance =       0.267773363938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267719603181
                                         uncertainty =       0.001526116070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267719603181
                                         uncertainty =       0.001526116070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365905291
  error estimate for blocks of size 2^( 2) =       0.000380028177
  error estimate for blocks of size 2^( 3) =       0.000392608290
  error estimate for blocks of size 2^( 4) =       0.000402870056
  error estimate for blocks of size 2^( 5) =       0.000409211788
  error estimate for blocks of size 2^( 6) =       0.000410828895
  error estimate for blocks of size 2^( 7) =       0.000412686554

      target function =      -0.947347220671
              le_mean =     -17.211052455818
             les_mean =     296.498801694541
             stat err =       0.000408899323
             autocorr =       1.248807229849
   target nu stat err =       0.000408899323
   target dn stat err =       0.001971775775
      target stat err =       0.003375036160
              std dev =       0.517468225052
             le_variance =       0.267773363938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267719603181
                                         uncertainty =       0.001526116070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267719603181
                                         uncertainty =       0.001526116070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365905291
  error estimate for blocks of size 2^( 2) =       0.000380028177
  error estimate for blocks of size 2^( 3) =       0.000392608290
  error estimate for blocks of size 2^( 4) =       0.000402870056
  error estimate for blocks of size 2^( 5) =       0.000409211788
  error estimate for blocks of size 2^( 6) =       0.000410828895
  error estimate for blocks of size 2^( 7) =       0.000412686554

      target function =      -0.947347220671
              le_mean =     -17.211052455818
             les_mean =     296.498801694541
             stat err =       0.000408899323
             autocorr =       1.248807229849
   target nu stat err =       0.000408899323
   target dn stat err =       0.001971775775
      target stat err =       0.003375036160
              std dev =       0.517468225052
             le_variance =       0.267773363938


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947347220671        initial  <--
     2.3283e+48     2.3283e+49             0.0000e+00        -0.947347220671
     9.3132e+48     9.3132e+49             0.0000e+00        -0.947347220671
     3.7253e+49     3.7253e+50             0.0000e+00        -0.947347220671

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9894
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9463e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2657
    reference variance = 0.212578
====================================================
  Execution time = 1.4087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7782e-01
  Total weights = 1.957247349e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265217137976
                                         uncertainty =       0.001523067704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265217137976
                                         uncertainty =       0.001523067704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364114515
  error estimate for blocks of size 2^( 2) =       0.000378200487
  error estimate for blocks of size 2^( 3) =       0.000390819046
  error estimate for blocks of size 2^( 4) =       0.000399792005
  error estimate for blocks of size 2^( 5) =       0.000406007281
  error estimate for blocks of size 2^( 6) =       0.000407091173
  error estimate for blocks of size 2^( 7) =       0.000408108314

      target function =      -0.948476169783
              le_mean =     -17.212380085723
             les_mean =     296.543846683419
             stat err =       0.000405249693
             autocorr =       1.238709320591
   target nu stat err =       0.000405249693
   target dn stat err =       0.002690804912
      target stat err =       0.004577845412
              std dev =       0.514935685580
             le_variance =       0.265158760284


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721238008572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+49, overlap shift 2.3283e+50 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948497200829       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948497200829       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948730468750       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+49 is 1.106238e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+49, overlap shift 9.3132e+50 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948497200829       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948497200829       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948242187500       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+49 is 2.765595e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+50, overlap shift 3.7253e+51 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948497200829       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948497200829       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949218750000       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+50 is 6.913988e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.327439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6570e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.1926
    reference variance = 0.189566
====================================================
  Execution time = 1.3684e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7732e-01
  Total weights = 1.9574e+06
  Execution time = 1.8249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266128566171
                                         uncertainty =       0.001481661110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266128566171
                                         uncertainty =       0.001481661110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364779195
  error estimate for blocks of size 2^( 2) =       0.000378793448
  error estimate for blocks of size 2^( 3) =       0.000391550903
  error estimate for blocks of size 2^( 4) =       0.000401604502
  error estimate for blocks of size 2^( 5) =       0.000406507855
  error estimate for blocks of size 2^( 6) =       0.000411304177
  error estimate for blocks of size 2^( 7) =       0.000412759849

      target function =      -0.949323067107
              le_mean =     -17.212450796296
             les_mean =     296.545784612294
             stat err =       0.000408044096
             autocorr =       1.251278766107
   target nu stat err =       0.000408044096
   target dn stat err =       0.001941270576
      target stat err =       0.003347176566
              std dev =       0.515875685291
             le_variance =       0.266127722674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266128566171
                                         uncertainty =       0.001481661110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266128566171
                                         uncertainty =       0.001481661110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364779195
  error estimate for blocks of size 2^( 2) =       0.000378793448
  error estimate for blocks of size 2^( 3) =       0.000391550903
  error estimate for blocks of size 2^( 4) =       0.000401604502
  error estimate for blocks of size 2^( 5) =       0.000406507855
  error estimate for blocks of size 2^( 6) =       0.000411304177
  error estimate for blocks of size 2^( 7) =       0.000412759849

      target function =      -0.949323067107
              le_mean =     -17.212450796296
             les_mean =     296.545784612294
             stat err =       0.000408044096
             autocorr =       1.251278766112
   target nu stat err =       0.000408044096
   target dn stat err =       0.001941270576
      target stat err =       0.003347176566
              std dev =       0.515875685291
             le_variance =       0.266127722674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266128566171
                                         uncertainty =       0.001481661110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266128566171
                                         uncertainty =       0.001481661110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364779195
  error estimate for blocks of size 2^( 2) =       0.000378793448
  error estimate for blocks of size 2^( 3) =       0.000391550903
  error estimate for blocks of size 2^( 4) =       0.000401604502
  error estimate for blocks of size 2^( 5) =       0.000406507855
  error estimate for blocks of size 2^( 6) =       0.000411304177
  error estimate for blocks of size 2^( 7) =       0.000412759849

      target function =      -0.949323067107
              le_mean =     -17.212450796296
             les_mean =     296.545784612294
             stat err =       0.000408044096
             autocorr =       1.251278766112
   target nu stat err =       0.000408044096
   target dn stat err =       0.001941270576
      target stat err =       0.003347176566
              std dev =       0.515875685291
             le_variance =       0.266127722674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266128566171
                                         uncertainty =       0.001481661110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266128566171
                                         uncertainty =       0.001481661110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364779195
  error estimate for blocks of size 2^( 2) =       0.000378793448
  error estimate for blocks of size 2^( 3) =       0.000391550903
  error estimate for blocks of size 2^( 4) =       0.000401604502
  error estimate for blocks of size 2^( 5) =       0.000406507855
  error estimate for blocks of size 2^( 6) =       0.000411304177
  error estimate for blocks of size 2^( 7) =       0.000412759849

      target function =      -0.949323067107
              le_mean =     -17.212450796296
             les_mean =     296.545784612294
             stat err =       0.000408044096
             autocorr =       1.251278766112
   target nu stat err =       0.000408044096
   target dn stat err =       0.001941270576
      target stat err =       0.003347176566
              std dev =       0.515875685291
             le_variance =       0.266127722674


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949323067107        initial  <--
     2.3283e+49     2.3283e+50             1.1062e-53        -0.949323067107
     9.3132e+49     9.3132e+50             2.7656e-54        -0.949323067107
     3.7253e+50     3.7253e+51             6.9140e-55        -0.949323067107

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9224
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9498e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2567
    reference variance = 0.166653
====================================================
  Execution time = 1.4054e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7977e-01
  Total weights = 1.957446063e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5411e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268945373386
                                         uncertainty =       0.001328432557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268945373386
                                         uncertainty =       0.001328432557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366662720
  error estimate for blocks of size 2^( 2) =       0.000380731881
  error estimate for blocks of size 2^( 3) =       0.000393265850
  error estimate for blocks of size 2^( 4) =       0.000402459579
  error estimate for blocks of size 2^( 5) =       0.000408728196
  error estimate for blocks of size 2^( 6) =       0.000411786277
  error estimate for blocks of size 2^( 7) =       0.000413747897

      target function =      -0.945204332139
              le_mean =     -17.211719321301
             les_mean =     296.523050786537
             stat err =       0.000409180487
             autocorr =       1.245364032890
   target nu stat err =       0.000409180487
   target dn stat err =       0.002068534783
      target stat err =       0.003522100247
              std dev =       0.518539391640
             le_variance =       0.268883100683


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721171932130e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+50, overlap shift 2.3283e+51 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945216476048       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945216476048       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+50, overlap shift 9.3132e+51 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945216476048       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945216476048       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+51, overlap shift 3.7253e+52 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945216476048       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945216476048       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.328529 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6601e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.0861
    reference variance = 0.711686
====================================================
  Execution time = 1.3861e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7661e-01
  Total weights = 1.9573e+06
  Execution time = 1.8277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992480490
                                         uncertainty =       0.001404791209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992480490
                                         uncertainty =       0.001404791209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365403612
  error estimate for blocks of size 2^( 2) =       0.000379320649
  error estimate for blocks of size 2^( 3) =       0.000391903919
  error estimate for blocks of size 2^( 4) =       0.000400879165
  error estimate for blocks of size 2^( 5) =       0.000406601467
  error estimate for blocks of size 2^( 6) =       0.000409310489
  error estimate for blocks of size 2^( 7) =       0.000412010697

      target function =      -0.950516234763
              le_mean =     -17.212311792602
             les_mean =     296.540289602617
             stat err =       0.000407200454
             autocorr =       1.241854847690
   target nu stat err =       0.000407200454
   target dn stat err =       0.001843896577
      target stat err =       0.003193963917
              std dev =       0.516758743248
             le_variance =       0.267039598723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992480490
                                         uncertainty =       0.001404791209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992480490
                                         uncertainty =       0.001404791209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365403612
  error estimate for blocks of size 2^( 2) =       0.000379320649
  error estimate for blocks of size 2^( 3) =       0.000391903919
  error estimate for blocks of size 2^( 4) =       0.000400879165
  error estimate for blocks of size 2^( 5) =       0.000406601467
  error estimate for blocks of size 2^( 6) =       0.000409310489
  error estimate for blocks of size 2^( 7) =       0.000412010697

      target function =      -0.950516234763
              le_mean =     -17.212311792602
             les_mean =     296.540289602617
             stat err =       0.000407200454
             autocorr =       1.241854847690
   target nu stat err =       0.000407200454
   target dn stat err =       0.001843896577
      target stat err =       0.003193963917
              std dev =       0.516758743248
             le_variance =       0.267039598723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992480490
                                         uncertainty =       0.001404791209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992480490
                                         uncertainty =       0.001404791209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365403612
  error estimate for blocks of size 2^( 2) =       0.000379320649
  error estimate for blocks of size 2^( 3) =       0.000391903919
  error estimate for blocks of size 2^( 4) =       0.000400879165
  error estimate for blocks of size 2^( 5) =       0.000406601467
  error estimate for blocks of size 2^( 6) =       0.000409310489
  error estimate for blocks of size 2^( 7) =       0.000412010697

      target function =      -0.950516234763
              le_mean =     -17.212311792602
             les_mean =     296.540289602617
             stat err =       0.000407200454
             autocorr =       1.241854847690
   target nu stat err =       0.000407200454
   target dn stat err =       0.001843896577
      target stat err =       0.003193963917
              std dev =       0.516758743248
             le_variance =       0.267039598723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992480490
                                         uncertainty =       0.001404791209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266992480490
                                         uncertainty =       0.001404791209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365403612
  error estimate for blocks of size 2^( 2) =       0.000379320649
  error estimate for blocks of size 2^( 3) =       0.000391903919
  error estimate for blocks of size 2^( 4) =       0.000400879165
  error estimate for blocks of size 2^( 5) =       0.000406601467
  error estimate for blocks of size 2^( 6) =       0.000409310489
  error estimate for blocks of size 2^( 7) =       0.000412010697

      target function =      -0.950516234763
              le_mean =     -17.212311792602
             les_mean =     296.540289602617
             stat err =       0.000407200454
             autocorr =       1.241854847690
   target nu stat err =       0.000407200454
   target dn stat err =       0.001843896577
      target stat err =       0.003193963917
              std dev =       0.516758743248
             le_variance =       0.267039598723


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950516234763        initial  <--
     2.3283e+50     2.3283e+51             0.0000e+00        -0.950516234763
     9.3132e+50     9.3132e+51             0.0000e+00        -0.950516234763
     3.7253e+51     3.7253e+52             0.0000e+00        -0.950516234763

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0904
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9698e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.3017
    reference variance = 1.65313
====================================================
  Execution time = 1.3917e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8061e-01
  Total weights = 1.957686727e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267676495740
                                         uncertainty =       0.001827851412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267676495740
                                         uncertainty =       0.001827851412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365893480
  error estimate for blocks of size 2^( 2) =       0.000379936202
  error estimate for blocks of size 2^( 3) =       0.000392686001
  error estimate for blocks of size 2^( 4) =       0.000403061213
  error estimate for blocks of size 2^( 5) =       0.000408574608
  error estimate for blocks of size 2^( 6) =       0.000411296291
  error estimate for blocks of size 2^( 7) =       0.000411538995

      target function =      -0.943805999453
              le_mean =     -17.212121542456
             les_mean =     296.537739979755
             stat err =       0.000408617777
             autocorr =       1.247168608245
   target nu stat err =       0.000408617777
   target dn stat err =       0.002319754705
      target stat err =       0.003924183840
              std dev =       0.517451522115
             le_variance =       0.267756077739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721212154246e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+51, overlap shift 2.3283e+52 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943821445175       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943821445175       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+51, overlap shift 9.3132e+52 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943821445175       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943821445175       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+52, overlap shift 3.7253e+53 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943821445175       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943821445175       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.329589 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6405e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.1283
    reference variance = 0.353106
====================================================
  Execution time = 1.4032e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7742e-01
  Total weights = 1.9569e+06
  Execution time = 1.8293e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266384634657
                                         uncertainty =       0.001498809315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266384634657
                                         uncertainty =       0.001498809315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364934488
  error estimate for blocks of size 2^( 2) =       0.000378878720
  error estimate for blocks of size 2^( 3) =       0.000392090737
  error estimate for blocks of size 2^( 4) =       0.000401109909
  error estimate for blocks of size 2^( 5) =       0.000405964769
  error estimate for blocks of size 2^( 6) =       0.000408254537
  error estimate for blocks of size 2^( 7) =       0.000409434536

      target function =      -0.949100452409
              le_mean =     -17.210741666228
             les_mean =     296.487049447521
             stat err =       0.000406190938
             autocorr =       1.238883997809
   target nu stat err =       0.000406190938
   target dn stat err =       0.002176573865
      target stat err =       0.003720690681
              std dev =       0.516095302308
             le_variance =       0.266354361064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266384634657
                                         uncertainty =       0.001498809315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266384634657
                                         uncertainty =       0.001498809315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364934488
  error estimate for blocks of size 2^( 2) =       0.000378878720
  error estimate for blocks of size 2^( 3) =       0.000392090737
  error estimate for blocks of size 2^( 4) =       0.000401109909
  error estimate for blocks of size 2^( 5) =       0.000405964769
  error estimate for blocks of size 2^( 6) =       0.000408254537
  error estimate for blocks of size 2^( 7) =       0.000409434536

      target function =      -0.949100452409
              le_mean =     -17.210741666228
             les_mean =     296.487049447521
             stat err =       0.000406190938
             autocorr =       1.238883997809
   target nu stat err =       0.000406190938
   target dn stat err =       0.002176573865
      target stat err =       0.003720690681
              std dev =       0.516095302308
             le_variance =       0.266354361064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266384634657
                                         uncertainty =       0.001498809315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266384634657
                                         uncertainty =       0.001498809315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364934488
  error estimate for blocks of size 2^( 2) =       0.000378878720
  error estimate for blocks of size 2^( 3) =       0.000392090737
  error estimate for blocks of size 2^( 4) =       0.000401109909
  error estimate for blocks of size 2^( 5) =       0.000405964769
  error estimate for blocks of size 2^( 6) =       0.000408254537
  error estimate for blocks of size 2^( 7) =       0.000409434536

      target function =      -0.949100452409
              le_mean =     -17.210741666228
             les_mean =     296.487049447521
             stat err =       0.000406190938
             autocorr =       1.238883997809
   target nu stat err =       0.000406190938
   target dn stat err =       0.002176573865
      target stat err =       0.003720690681
              std dev =       0.516095302308
             le_variance =       0.266354361064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266384634657
                                         uncertainty =       0.001498809315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266384634657
                                         uncertainty =       0.001498809315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364934488
  error estimate for blocks of size 2^( 2) =       0.000378878720
  error estimate for blocks of size 2^( 3) =       0.000392090737
  error estimate for blocks of size 2^( 4) =       0.000401109909
  error estimate for blocks of size 2^( 5) =       0.000405964769
  error estimate for blocks of size 2^( 6) =       0.000408254537
  error estimate for blocks of size 2^( 7) =       0.000409434536

      target function =      -0.949100452409
              le_mean =     -17.210741666228
             les_mean =     296.487049447521
             stat err =       0.000406190938
             autocorr =       1.238883997809
   target nu stat err =       0.000406190938
   target dn stat err =       0.002176573865
      target stat err =       0.003720690681
              std dev =       0.516095302308
             le_variance =       0.266354361064


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949100452409        initial  <--
     2.3283e+51     2.3283e+52             0.0000e+00        -0.949100452409
     9.3132e+51     9.3132e+52             0.0000e+00        -0.949100452409
     3.7253e+52     3.7253e+53             0.0000e+00        -0.949100452409

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3158
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9726e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2421
    reference variance = 0.25894
====================================================
  Execution time = 1.4150e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8367e-01
  Total weights = 1.957415794e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5442e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269933054445
                                         uncertainty =       0.001876663864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269933054445
                                         uncertainty =       0.001876663864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367355956
  error estimate for blocks of size 2^( 2) =       0.000381466554
  error estimate for blocks of size 2^( 3) =       0.000393997154
  error estimate for blocks of size 2^( 4) =       0.000403525493
  error estimate for blocks of size 2^( 5) =       0.000408970622
  error estimate for blocks of size 2^( 6) =       0.000412402429
  error estimate for blocks of size 2^( 7) =       0.000412952138

      target function =      -0.938739297043
              le_mean =     -17.212765287600
             les_mean =     296.562961489057
             stat err =       0.000409462671
             autocorr =       1.242380019454
   target nu stat err =       0.000409462671
   target dn stat err =       0.003006958451
      target stat err =       0.005004640621
              std dev =       0.519519775180
             le_variance =       0.269900796803


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721276528760e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+52, overlap shift 2.3283e+53 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938764819428       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938764819428       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+52, overlap shift 9.3132e+53 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938764819428       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938764819428       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+53, overlap shift 3.7253e+54 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938764819428       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938764819428       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.330677 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6701e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.3135
    reference variance = 0.424147
====================================================
  Execution time = 1.5738e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7591e-01
  Total weights = 1.9577e+06
  Execution time = 1.8294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266440309525
                                         uncertainty =       0.001454155572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266440309525
                                         uncertainty =       0.001454155572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364946078
  error estimate for blocks of size 2^( 2) =       0.000378909381
  error estimate for blocks of size 2^( 3) =       0.000391638489
  error estimate for blocks of size 2^( 4) =       0.000401064959
  error estimate for blocks of size 2^( 5) =       0.000406420597
  error estimate for blocks of size 2^( 6) =       0.000409027175
  error estimate for blocks of size 2^( 7) =       0.000409399300

      target function =      -0.951678994089
              le_mean =     -17.211578925801
             les_mean =     296.514357919749
             stat err =       0.000406478008
             autocorr =       1.240556946140
   target nu stat err =       0.000406478008
   target dn stat err =       0.001829987117
      target stat err =       0.003174033459
              std dev =       0.516111693351
             le_variance =       0.266371280013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266440309525
                                         uncertainty =       0.001454155572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266440309525
                                         uncertainty =       0.001454155572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364946078
  error estimate for blocks of size 2^( 2) =       0.000378909381
  error estimate for blocks of size 2^( 3) =       0.000391638489
  error estimate for blocks of size 2^( 4) =       0.000401064959
  error estimate for blocks of size 2^( 5) =       0.000406420597
  error estimate for blocks of size 2^( 6) =       0.000409027175
  error estimate for blocks of size 2^( 7) =       0.000409399300

      target function =      -0.951678994089
              le_mean =     -17.211578925801
             les_mean =     296.514357919749
             stat err =       0.000406478008
             autocorr =       1.240556946147
   target nu stat err =       0.000406478008
   target dn stat err =       0.001829987117
      target stat err =       0.003174033459
              std dev =       0.516111693351
             le_variance =       0.266371280013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266440309525
                                         uncertainty =       0.001454155572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266440309525
                                         uncertainty =       0.001454155572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364946078
  error estimate for blocks of size 2^( 2) =       0.000378909381
  error estimate for blocks of size 2^( 3) =       0.000391638489
  error estimate for blocks of size 2^( 4) =       0.000401064959
  error estimate for blocks of size 2^( 5) =       0.000406420597
  error estimate for blocks of size 2^( 6) =       0.000409027175
  error estimate for blocks of size 2^( 7) =       0.000409399300

      target function =      -0.951678994089
              le_mean =     -17.211578925801
             les_mean =     296.514357919749
             stat err =       0.000406478008
             autocorr =       1.240556946147
   target nu stat err =       0.000406478008
   target dn stat err =       0.001829987117
      target stat err =       0.003174033459
              std dev =       0.516111693351
             le_variance =       0.266371280013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266440309525
                                         uncertainty =       0.001454155572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266440309525
                                         uncertainty =       0.001454155572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364946078
  error estimate for blocks of size 2^( 2) =       0.000378909381
  error estimate for blocks of size 2^( 3) =       0.000391638489
  error estimate for blocks of size 2^( 4) =       0.000401064959
  error estimate for blocks of size 2^( 5) =       0.000406420597
  error estimate for blocks of size 2^( 6) =       0.000409027175
  error estimate for blocks of size 2^( 7) =       0.000409399300

      target function =      -0.951678994089
              le_mean =     -17.211578925801
             les_mean =     296.514357919749
             stat err =       0.000406478008
             autocorr =       1.240556946147
   target nu stat err =       0.000406478008
   target dn stat err =       0.001829987117
      target stat err =       0.003174033459
              std dev =       0.516111693351
             le_variance =       0.266371280013


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951678994089        initial  <--
     2.3283e+52     2.3283e+53             0.0000e+00        -0.951678994089
     9.3132e+52     9.3132e+53             0.0000e+00        -0.951678994089
     3.7253e+53     3.7253e+54             0.0000e+00        -0.951678994089

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2176
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.5924e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1912
    reference variance = 0.225554
====================================================
  Execution time = 1.4120e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8010e-01
  Total weights = 1.957377892e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266138221482
                                         uncertainty =       0.001561032886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266138221482
                                         uncertainty =       0.001561032886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364761477
  error estimate for blocks of size 2^( 2) =       0.000378496743
  error estimate for blocks of size 2^( 3) =       0.000391252667
  error estimate for blocks of size 2^( 4) =       0.000400959077
  error estimate for blocks of size 2^( 5) =       0.000406738153
  error estimate for blocks of size 2^( 6) =       0.000410458171
  error estimate for blocks of size 2^( 7) =       0.000411222975

      target function =      -0.944641145472
              le_mean =     -17.211724083316
             les_mean =     296.523549691954
             stat err =       0.000407344594
             autocorr =       1.247113504209
   target nu stat err =       0.000407344594
   target dn stat err =       0.002473284981
      target stat err =       0.004179226660
              std dev =       0.515850628402
             le_variance =       0.266101870823


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721172408332e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+53, overlap shift 2.3283e+54 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944658625480       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944658625480       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+53, overlap shift 9.3132e+54 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944658625480       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944658625480       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+54, overlap shift 3.7253e+55 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944658625480       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944658625480       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.331789 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6624e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1129
    reference variance = 0.221162
====================================================
  Execution time = 1.8037e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7990e-01
  Total weights = 1.9574e+06
  Execution time = 1.8547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267896224096
                                         uncertainty =       0.001761054112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267896224096
                                         uncertainty =       0.001761054112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365959921
  error estimate for blocks of size 2^( 2) =       0.000379755273
  error estimate for blocks of size 2^( 3) =       0.000392692044
  error estimate for blocks of size 2^( 4) =       0.000402075673
  error estimate for blocks of size 2^( 5) =       0.000407198925
  error estimate for blocks of size 2^( 6) =       0.000410377538
  error estimate for blocks of size 2^( 7) =       0.000413775454

      target function =      -0.944994786462
              le_mean =     -17.212524847663
             les_mean =     296.550914245590
             stat err =       0.000408356898
             autocorr =       1.245124394471
   target nu stat err =       0.000408356898
   target dn stat err =       0.002382790799
      target stat err =       0.004040227627
              std dev =       0.517545482975
             le_variance =       0.267853326948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267896224096
                                         uncertainty =       0.001761054112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267896224096
                                         uncertainty =       0.001761054112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365959921
  error estimate for blocks of size 2^( 2) =       0.000379755273
  error estimate for blocks of size 2^( 3) =       0.000392692044
  error estimate for blocks of size 2^( 4) =       0.000402075673
  error estimate for blocks of size 2^( 5) =       0.000407198925
  error estimate for blocks of size 2^( 6) =       0.000410377538
  error estimate for blocks of size 2^( 7) =       0.000413775454

      target function =      -0.944994786462
              le_mean =     -17.212524847663
             les_mean =     296.550914245590
             stat err =       0.000408356898
             autocorr =       1.245124394473
   target nu stat err =       0.000408356898
   target dn stat err =       0.002382790799
      target stat err =       0.004040227627
              std dev =       0.517545482975
             le_variance =       0.267853326948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267896224096
                                         uncertainty =       0.001761054112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267896224096
                                         uncertainty =       0.001761054112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365959921
  error estimate for blocks of size 2^( 2) =       0.000379755273
  error estimate for blocks of size 2^( 3) =       0.000392692044
  error estimate for blocks of size 2^( 4) =       0.000402075673
  error estimate for blocks of size 2^( 5) =       0.000407198925
  error estimate for blocks of size 2^( 6) =       0.000410377538
  error estimate for blocks of size 2^( 7) =       0.000413775454

      target function =      -0.944994786462
              le_mean =     -17.212524847663
             les_mean =     296.550914245590
             stat err =       0.000408356898
             autocorr =       1.245124394473
   target nu stat err =       0.000408356898
   target dn stat err =       0.002382790799
      target stat err =       0.004040227627
              std dev =       0.517545482975
             le_variance =       0.267853326948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267896224096
                                         uncertainty =       0.001761054112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267896224096
                                         uncertainty =       0.001761054112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365959921
  error estimate for blocks of size 2^( 2) =       0.000379755273
  error estimate for blocks of size 2^( 3) =       0.000392692044
  error estimate for blocks of size 2^( 4) =       0.000402075673
  error estimate for blocks of size 2^( 5) =       0.000407198925
  error estimate for blocks of size 2^( 6) =       0.000410377538
  error estimate for blocks of size 2^( 7) =       0.000413775454

      target function =      -0.944994786462
              le_mean =     -17.212524847663
             les_mean =     296.550914245590
             stat err =       0.000408356898
             autocorr =       1.245124394473
   target nu stat err =       0.000408356898
   target dn stat err =       0.002382790799
      target stat err =       0.004040227627
              std dev =       0.517545482975
             le_variance =       0.267853326948


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944994786462        initial  <--
     2.3283e+53     2.3283e+54             0.0000e+00        -0.944994786462
     9.3132e+53     9.3132e+54             0.0000e+00        -0.944994786462
     3.7253e+54     3.7253e+55             0.0000e+00        -0.944994786462

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.3075
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3954e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2377
    reference variance = 0.202185
====================================================
  Execution time = 1.4329e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7900e-01
  Total weights = 1.957175762e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267653236013
                                         uncertainty =       0.001620507423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267653236013
                                         uncertainty =       0.001620507423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365792209
  error estimate for blocks of size 2^( 2) =       0.000379927768
  error estimate for blocks of size 2^( 3) =       0.000392583824
  error estimate for blocks of size 2^( 4) =       0.000401971867
  error estimate for blocks of size 2^( 5) =       0.000408233430
  error estimate for blocks of size 2^( 6) =       0.000411449716
  error estimate for blocks of size 2^( 7) =       0.000413184165

      target function =      -0.946483552457
              le_mean =     -17.211595863915
             les_mean =     296.518033295247
             stat err =       0.000408709794
             autocorr =       1.248421354366
   target nu stat err =       0.000408709794
   target dn stat err =       0.001966073124
      target stat err =       0.003363061301
              std dev =       0.517308302847
             le_variance =       0.267607880194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721159586391e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+54, overlap shift 2.3283e+55 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946494390008       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946494390008       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+54, overlap shift 9.3132e+55 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946494390008       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946494390008       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+55, overlap shift 3.7253e+56 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946494390008       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946494390008       residual = 9.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.332841 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6820e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.256
    reference variance = 0.287425
====================================================
  Execution time = 1.3718e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8381e-01
  Total weights = 1.9573e+06
  Execution time = 1.8267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272396719245
                                         uncertainty =       0.002782613223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272396719245
                                         uncertainty =       0.002782613223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369042267
  error estimate for blocks of size 2^( 2) =       0.000382858148
  error estimate for blocks of size 2^( 3) =       0.000395546018
  error estimate for blocks of size 2^( 4) =       0.000404864942
  error estimate for blocks of size 2^( 5) =       0.000410030062
  error estimate for blocks of size 2^( 6) =       0.000412793403
  error estimate for blocks of size 2^( 7) =       0.000414408807

      target function =      -0.938490824716
              le_mean =     -17.211405492710
             les_mean =     296.516291173328
             stat err =       0.000410524304
             autocorr =       1.237443924743
   target nu stat err =       0.000410524304
   target dn stat err =       0.003328883217
      target stat err =       0.005513279580
              std dev =       0.521904578685
             le_variance =       0.272384389253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272396719245
                                         uncertainty =       0.002782613223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272396719245
                                         uncertainty =       0.002782613223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369042267
  error estimate for blocks of size 2^( 2) =       0.000382858148
  error estimate for blocks of size 2^( 3) =       0.000395546018
  error estimate for blocks of size 2^( 4) =       0.000404864942
  error estimate for blocks of size 2^( 5) =       0.000410030062
  error estimate for blocks of size 2^( 6) =       0.000412793403
  error estimate for blocks of size 2^( 7) =       0.000414408807

      target function =      -0.938490824716
              le_mean =     -17.211405492710
             les_mean =     296.516291173328
             stat err =       0.000410524304
             autocorr =       1.237443924743
   target nu stat err =       0.000410524304
   target dn stat err =       0.003328883217
      target stat err =       0.005513279580
              std dev =       0.521904578685
             le_variance =       0.272384389253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272396719245
                                         uncertainty =       0.002782613223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272396719245
                                         uncertainty =       0.002782613223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369042267
  error estimate for blocks of size 2^( 2) =       0.000382858148
  error estimate for blocks of size 2^( 3) =       0.000395546018
  error estimate for blocks of size 2^( 4) =       0.000404864942
  error estimate for blocks of size 2^( 5) =       0.000410030062
  error estimate for blocks of size 2^( 6) =       0.000412793403
  error estimate for blocks of size 2^( 7) =       0.000414408807

      target function =      -0.938490824716
              le_mean =     -17.211405492710
             les_mean =     296.516291173328
             stat err =       0.000410524304
             autocorr =       1.237443924743
   target nu stat err =       0.000410524304
   target dn stat err =       0.003328883217
      target stat err =       0.005513279580
              std dev =       0.521904578685
             le_variance =       0.272384389253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272396719245
                                         uncertainty =       0.002782613223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272396719245
                                         uncertainty =       0.002782613223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369042267
  error estimate for blocks of size 2^( 2) =       0.000382858148
  error estimate for blocks of size 2^( 3) =       0.000395546018
  error estimate for blocks of size 2^( 4) =       0.000404864942
  error estimate for blocks of size 2^( 5) =       0.000410030062
  error estimate for blocks of size 2^( 6) =       0.000412793403
  error estimate for blocks of size 2^( 7) =       0.000414408807

      target function =      -0.938490824716
              le_mean =     -17.211405492710
             les_mean =     296.516291173328
             stat err =       0.000410524304
             autocorr =       1.237443924743
   target nu stat err =       0.000410524304
   target dn stat err =       0.003328883217
      target stat err =       0.005513279580
              std dev =       0.521904578685
             le_variance =       0.272384389253


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938490824716        initial  <--
     2.3283e+54     2.3283e+55             0.0000e+00        -0.938490824716
     9.3132e+54     9.3132e+55             0.0000e+00        -0.938490824716
     3.7253e+55     3.7253e+56             0.0000e+00        -0.938490824716

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9527
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9797e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.1942
    reference variance = 0.24663
====================================================
  Execution time = 1.4241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8068e-01
  Total weights = 1.957218427e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5354e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268379865004
                                         uncertainty =       0.001884201296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268379865004
                                         uncertainty =       0.001884201296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366258226
  error estimate for blocks of size 2^( 2) =       0.000379965934
  error estimate for blocks of size 2^( 3) =       0.000392947958
  error estimate for blocks of size 2^( 4) =       0.000402328424
  error estimate for blocks of size 2^( 5) =       0.000407488694
  error estimate for blocks of size 2^( 6) =       0.000410228236
  error estimate for blocks of size 2^( 7) =       0.000412373623

      target function =      -0.943667382233
              le_mean =     -17.211424731367
             les_mean =     296.513825029226
             stat err =       0.000408104744
             autocorr =       1.241562284976
   target nu stat err =       0.000408104744
   target dn stat err =       0.002666563047
      target stat err =       0.004485098595
              std dev =       0.517967350851
             le_variance =       0.268290176547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721142473137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+55, overlap shift 2.3283e+56 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943687798710       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943687798710       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+55, overlap shift 9.3132e+56 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943687798710       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943687798710       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+56, overlap shift 3.7253e+57 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943687798710       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943687798710       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.333962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6783e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2396
    reference variance = 0.399578
====================================================
  Execution time = 1.3547e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8402e-01
  Total weights = 1.9575e+06
  Execution time = 1.8367e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270463457979
                                         uncertainty =       0.003301859074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270463457979
                                         uncertainty =       0.003301859074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367724791
  error estimate for blocks of size 2^( 2) =       0.000381415623
  error estimate for blocks of size 2^( 3) =       0.000393762424
  error estimate for blocks of size 2^( 4) =       0.000402447453
  error estimate for blocks of size 2^( 5) =       0.000407240291
  error estimate for blocks of size 2^( 6) =       0.000410500910
  error estimate for blocks of size 2^( 7) =       0.000411699006

      target function =      -0.938136502146
              le_mean =     -17.211574816112
             les_mean =     296.522328493161
             stat err =       0.000407971915
             autocorr =       1.230877167296
   target nu stat err =       0.000407971915
   target dn stat err =       0.003949520769
      target stat err =       0.006521846776
              std dev =       0.520041386016
             le_variance =       0.270443043170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270463457979
                                         uncertainty =       0.003301859074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270463457979
                                         uncertainty =       0.003301859074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367724791
  error estimate for blocks of size 2^( 2) =       0.000381415623
  error estimate for blocks of size 2^( 3) =       0.000393762424
  error estimate for blocks of size 2^( 4) =       0.000402447453
  error estimate for blocks of size 2^( 5) =       0.000407240291
  error estimate for blocks of size 2^( 6) =       0.000410500910
  error estimate for blocks of size 2^( 7) =       0.000411699006

      target function =      -0.938136502146
              le_mean =     -17.211574816112
             les_mean =     296.522328493161
             stat err =       0.000407971915
             autocorr =       1.230877167296
   target nu stat err =       0.000407971915
   target dn stat err =       0.003949520769
      target stat err =       0.006521846776
              std dev =       0.520041386016
             le_variance =       0.270443043170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270463457979
                                         uncertainty =       0.003301859074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270463457979
                                         uncertainty =       0.003301859074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367724791
  error estimate for blocks of size 2^( 2) =       0.000381415623
  error estimate for blocks of size 2^( 3) =       0.000393762424
  error estimate for blocks of size 2^( 4) =       0.000402447453
  error estimate for blocks of size 2^( 5) =       0.000407240291
  error estimate for blocks of size 2^( 6) =       0.000410500910
  error estimate for blocks of size 2^( 7) =       0.000411699006

      target function =      -0.938136502146
              le_mean =     -17.211574816112
             les_mean =     296.522328493161
             stat err =       0.000407971915
             autocorr =       1.230877167296
   target nu stat err =       0.000407971915
   target dn stat err =       0.003949520769
      target stat err =       0.006521846776
              std dev =       0.520041386016
             le_variance =       0.270443043170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270463457979
                                         uncertainty =       0.003301859074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270463457979
                                         uncertainty =       0.003301859074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367724791
  error estimate for blocks of size 2^( 2) =       0.000381415623
  error estimate for blocks of size 2^( 3) =       0.000393762424
  error estimate for blocks of size 2^( 4) =       0.000402447453
  error estimate for blocks of size 2^( 5) =       0.000407240291
  error estimate for blocks of size 2^( 6) =       0.000410500910
  error estimate for blocks of size 2^( 7) =       0.000411699006

      target function =      -0.938136502146
              le_mean =     -17.211574816112
             les_mean =     296.522328493161
             stat err =       0.000407971915
             autocorr =       1.230877167296
   target nu stat err =       0.000407971915
   target dn stat err =       0.003949520769
      target stat err =       0.006521846776
              std dev =       0.520041386016
             le_variance =       0.270443043170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938136502146        initial  <--
     2.3283e+55     2.3283e+56             0.0000e+00        -0.938136502146
     9.3132e+55     9.3132e+56             0.0000e+00        -0.938136502146
     3.7253e+56     3.7253e+57             0.0000e+00        -0.938136502146

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9961
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9784e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2527
    reference variance = 0.125987
====================================================
  Execution time = 1.4445e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7704e-01
  Total weights = 1.957339475e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267127792682
                                         uncertainty =       0.001319970763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267127792682
                                         uncertainty =       0.001319970763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365399443
  error estimate for blocks of size 2^( 2) =       0.000379548697
  error estimate for blocks of size 2^( 3) =       0.000392494325
  error estimate for blocks of size 2^( 4) =       0.000402055231
  error estimate for blocks of size 2^( 5) =       0.000408576847
  error estimate for blocks of size 2^( 6) =       0.000412260248
  error estimate for blocks of size 2^( 7) =       0.000416924014

      target function =      -0.949782380616
              le_mean =     -17.211816533859
             les_mean =     296.523666994340
             stat err =       0.000409954085
             autocorr =       1.258736062255
   target nu stat err =       0.000409954085
   target dn stat err =       0.001827346879
      target stat err =       0.003160206044
              std dev =       0.516752848067
             le_variance =       0.267033505986


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721181653386e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+56, overlap shift 2.3283e+57 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949791818427       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949791818427       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+56, overlap shift 9.3132e+57 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949791818427       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949791818427       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+57, overlap shift 3.7253e+58 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949791818427       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949791818427       residual = 4.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.335082 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6993e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1789
    reference variance = 0.249602
====================================================
  Execution time = 1.3724e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8018e-01
  Total weights = 1.9573e+06
  Execution time = 1.8215e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267274725563
                                         uncertainty =       0.001762581162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267274725563
                                         uncertainty =       0.001762581162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365568892
  error estimate for blocks of size 2^( 2) =       0.000379254371
  error estimate for blocks of size 2^( 3) =       0.000391968668
  error estimate for blocks of size 2^( 4) =       0.000401681803
  error estimate for blocks of size 2^( 5) =       0.000406747838
  error estimate for blocks of size 2^( 6) =       0.000410787281
  error estimate for blocks of size 2^( 7) =       0.000414845056

      target function =      -0.944509579506
              le_mean =     -17.212092680845
             les_mean =     296.536318443297
             stat err =       0.000408515494
             autocorr =       1.248758913720
   target nu stat err =       0.000408515494
   target dn stat err =       0.002878049089
      target stat err =       0.004846716314
              std dev =       0.516992485435
             le_variance =       0.267281229996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267274725563
                                         uncertainty =       0.001762581162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267274725563
                                         uncertainty =       0.001762581162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365568892
  error estimate for blocks of size 2^( 2) =       0.000379254371
  error estimate for blocks of size 2^( 3) =       0.000391968668
  error estimate for blocks of size 2^( 4) =       0.000401681803
  error estimate for blocks of size 2^( 5) =       0.000406747838
  error estimate for blocks of size 2^( 6) =       0.000410787281
  error estimate for blocks of size 2^( 7) =       0.000414845056

      target function =      -0.944509579506
              le_mean =     -17.212092680845
             les_mean =     296.536318443297
             stat err =       0.000408515494
             autocorr =       1.248758913720
   target nu stat err =       0.000408515494
   target dn stat err =       0.002878049089
      target stat err =       0.004846716314
              std dev =       0.516992485435
             le_variance =       0.267281229996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267274725563
                                         uncertainty =       0.001762581162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267274725563
                                         uncertainty =       0.001762581162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365568892
  error estimate for blocks of size 2^( 2) =       0.000379254371
  error estimate for blocks of size 2^( 3) =       0.000391968668
  error estimate for blocks of size 2^( 4) =       0.000401681803
  error estimate for blocks of size 2^( 5) =       0.000406747838
  error estimate for blocks of size 2^( 6) =       0.000410787281
  error estimate for blocks of size 2^( 7) =       0.000414845056

      target function =      -0.944509579506
              le_mean =     -17.212092680845
             les_mean =     296.536318443297
             stat err =       0.000408515494
             autocorr =       1.248758913720
   target nu stat err =       0.000408515494
   target dn stat err =       0.002878049089
      target stat err =       0.004846716314
              std dev =       0.516992485435
             le_variance =       0.267281229996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267274725563
                                         uncertainty =       0.001762581162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267274725563
                                         uncertainty =       0.001762581162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365568892
  error estimate for blocks of size 2^( 2) =       0.000379254371
  error estimate for blocks of size 2^( 3) =       0.000391968668
  error estimate for blocks of size 2^( 4) =       0.000401681803
  error estimate for blocks of size 2^( 5) =       0.000406747838
  error estimate for blocks of size 2^( 6) =       0.000410787281
  error estimate for blocks of size 2^( 7) =       0.000414845056

      target function =      -0.944509579506
              le_mean =     -17.212092680845
             les_mean =     296.536318443297
             stat err =       0.000408515494
             autocorr =       1.248758913720
   target nu stat err =       0.000408515494
   target dn stat err =       0.002878049089
      target stat err =       0.004846716314
              std dev =       0.516992485435
             le_variance =       0.267281229996


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944509579506        initial  <--
     2.3283e+56     2.3283e+57             0.0000e+00        -0.944509579506
     9.3132e+56     9.3132e+57             0.0000e+00        -0.944509579506
     3.7253e+57     3.7253e+58             0.0000e+00        -0.944509579506

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1062
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0104e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.1755
    reference variance = 0.237359
====================================================
  Execution time = 1.4181e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7524e-01
  Total weights = 1.957145914e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5248e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265449514376
                                         uncertainty =       0.001389711537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265449514376
                                         uncertainty =       0.001389711537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364297757
  error estimate for blocks of size 2^( 2) =       0.000378396476
  error estimate for blocks of size 2^( 3) =       0.000391145323
  error estimate for blocks of size 2^( 4) =       0.000400559513
  error estimate for blocks of size 2^( 5) =       0.000406570546
  error estimate for blocks of size 2^( 6) =       0.000409247883
  error estimate for blocks of size 2^( 7) =       0.000410401586

      target function =      -0.952848155870
              le_mean =     -17.212407381013
             les_mean =     296.542204205202
             stat err =       0.000406694882
             autocorr =       1.246305237849
   target nu stat err =       0.000406694882
   target dn stat err =       0.001737070524
      target stat err =       0.003033401926
              std dev =       0.515194828360
             le_variance =       0.265425711168


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721240738101e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+57, overlap shift 2.3283e+58 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952856800453       residual = 6.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952856800453       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952856800453       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+57 is 3.853730e-62

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+57, overlap shift 9.3132e+58 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952856800453       residual = 6.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952856800453       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952856800453       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+57 is 9.634324e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+58, overlap shift 3.7253e+59 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952856800453       residual = 6.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952856800453       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952856800453       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+58 is 2.408581e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.336385 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6713e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2322
    reference variance = 0.355959
====================================================
  Execution time = 1.3694e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7908e-01
  Total weights = 1.9575e+06
  Execution time = 1.9209e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266417894581
                                         uncertainty =       0.001190151120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266417894581
                                         uncertainty =       0.001190151120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364965509
  error estimate for blocks of size 2^( 2) =       0.000378966121
  error estimate for blocks of size 2^( 3) =       0.000391839212
  error estimate for blocks of size 2^( 4) =       0.000401162664
  error estimate for blocks of size 2^( 5) =       0.000406881358
  error estimate for blocks of size 2^( 6) =       0.000409425204
  error estimate for blocks of size 2^( 7) =       0.000412195461

      target function =      -0.946364654243
              le_mean =     -17.212070732387
             les_mean =     296.534456024472
             stat err =       0.000407416171
             autocorr =       1.246157340466
   target nu stat err =       0.000407416171
   target dn stat err =       0.002277908085
      target stat err =       0.003875602991
              std dev =       0.516139172433
             le_variance =       0.266399645320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266417894581
                                         uncertainty =       0.001190151120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266417894581
                                         uncertainty =       0.001190151120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364965509
  error estimate for blocks of size 2^( 2) =       0.000378966121
  error estimate for blocks of size 2^( 3) =       0.000391839212
  error estimate for blocks of size 2^( 4) =       0.000401162664
  error estimate for blocks of size 2^( 5) =       0.000406881358
  error estimate for blocks of size 2^( 6) =       0.000409425204
  error estimate for blocks of size 2^( 7) =       0.000412195461

      target function =      -0.946364654243
              le_mean =     -17.212070732387
             les_mean =     296.534456024472
             stat err =       0.000407416171
             autocorr =       1.246157340466
   target nu stat err =       0.000407416171
   target dn stat err =       0.002277908085
      target stat err =       0.003875602991
              std dev =       0.516139172433
             le_variance =       0.266399645320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266417894581
                                         uncertainty =       0.001190151120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266417894581
                                         uncertainty =       0.001190151120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364965509
  error estimate for blocks of size 2^( 2) =       0.000378966121
  error estimate for blocks of size 2^( 3) =       0.000391839212
  error estimate for blocks of size 2^( 4) =       0.000401162664
  error estimate for blocks of size 2^( 5) =       0.000406881358
  error estimate for blocks of size 2^( 6) =       0.000409425204
  error estimate for blocks of size 2^( 7) =       0.000412195461

      target function =      -0.946364654243
              le_mean =     -17.212070732387
             les_mean =     296.534456024472
             stat err =       0.000407416171
             autocorr =       1.246157340466
   target nu stat err =       0.000407416171
   target dn stat err =       0.002277908085
      target stat err =       0.003875602991
              std dev =       0.516139172433
             le_variance =       0.266399645320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266417894581
                                         uncertainty =       0.001190151120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266417894581
                                         uncertainty =       0.001190151120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364965509
  error estimate for blocks of size 2^( 2) =       0.000378966121
  error estimate for blocks of size 2^( 3) =       0.000391839212
  error estimate for blocks of size 2^( 4) =       0.000401162664
  error estimate for blocks of size 2^( 5) =       0.000406881358
  error estimate for blocks of size 2^( 6) =       0.000409425204
  error estimate for blocks of size 2^( 7) =       0.000412195461

      target function =      -0.946364654243
              le_mean =     -17.212070732387
             les_mean =     296.534456024472
             stat err =       0.000407416171
             autocorr =       1.246157340466
   target nu stat err =       0.000407416171
   target dn stat err =       0.002277908085
      target stat err =       0.003875602991
              std dev =       0.516139172433
             le_variance =       0.266399645320


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946364654243        initial  <--
     2.3283e+57     2.3283e+58             3.8537e-62        -0.946364654243
     9.3132e+57     9.3132e+58             9.6343e-63        -0.946364654243
     3.7253e+58     3.7253e+59             2.4086e-63        -0.946364654243

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0455
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9786e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2668
    reference variance = 0.244109
====================================================
  Execution time = 1.3947e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7907e-01
  Total weights = 1.957474511e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267218578167
                                         uncertainty =       0.001520386911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267218578167
                                         uncertainty =       0.001520386911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365524301
  error estimate for blocks of size 2^( 2) =       0.000379636420
  error estimate for blocks of size 2^( 3) =       0.000392434052
  error estimate for blocks of size 2^( 4) =       0.000401792114
  error estimate for blocks of size 2^( 5) =       0.000408317637
  error estimate for blocks of size 2^( 6) =       0.000412020103
  error estimate for blocks of size 2^( 7) =       0.000412876513

      target function =      -0.946381272120
              le_mean =     -17.212341196798
             les_mean =     296.543761830430
             stat err =       0.000408751592
             autocorr =       1.250507793267
   target nu stat err =       0.000408751592
   target dn stat err =       0.002125032219
      target stat err =       0.003627199887
              std dev =       0.516929423972
             le_variance =       0.267216029368


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721234119680e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+58, overlap shift 2.3283e+59 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946394063626       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946394063626       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+58, overlap shift 9.3132e+59 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946394063626       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946394063626       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+59, overlap shift 3.7253e+60 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946394063626       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946394063626       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.337561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6428e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.1798
    reference variance = 0.181352
====================================================
  Execution time = 1.3794e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7864e-01
  Total weights = 1.9575e+06
  Execution time = 1.8370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268386392442
                                         uncertainty =       0.001799871112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268386392442
                                         uncertainty =       0.001799871112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366290777
  error estimate for blocks of size 2^( 2) =       0.000380415059
  error estimate for blocks of size 2^( 3) =       0.000393066149
  error estimate for blocks of size 2^( 4) =       0.000402215289
  error estimate for blocks of size 2^( 5) =       0.000408007651
  error estimate for blocks of size 2^( 6) =       0.000410736621
  error estimate for blocks of size 2^( 7) =       0.000413279950

      target function =      -0.947097248759
              le_mean =     -17.212298291704
             les_mean =     296.541855065608
             stat err =       0.000408559878
             autocorr =       1.244111952625
   target nu stat err =       0.000408559878
   target dn stat err =       0.002297643263
      target stat err =       0.003916014432
              std dev =       0.518013384731
             le_variance =       0.268337866760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268386392442
                                         uncertainty =       0.001799871112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268386392442
                                         uncertainty =       0.001799871112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366290777
  error estimate for blocks of size 2^( 2) =       0.000380415059
  error estimate for blocks of size 2^( 3) =       0.000393066149
  error estimate for blocks of size 2^( 4) =       0.000402215289
  error estimate for blocks of size 2^( 5) =       0.000408007651
  error estimate for blocks of size 2^( 6) =       0.000410736621
  error estimate for blocks of size 2^( 7) =       0.000413279950

      target function =      -0.947097248759
              le_mean =     -17.212298291704
             les_mean =     296.541855065608
             stat err =       0.000408559878
             autocorr =       1.244111952625
   target nu stat err =       0.000408559878
   target dn stat err =       0.002297643263
      target stat err =       0.003916014432
              std dev =       0.518013384731
             le_variance =       0.268337866760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268386392442
                                         uncertainty =       0.001799871112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268386392442
                                         uncertainty =       0.001799871112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366290777
  error estimate for blocks of size 2^( 2) =       0.000380415059
  error estimate for blocks of size 2^( 3) =       0.000393066149
  error estimate for blocks of size 2^( 4) =       0.000402215289
  error estimate for blocks of size 2^( 5) =       0.000408007651
  error estimate for blocks of size 2^( 6) =       0.000410736621
  error estimate for blocks of size 2^( 7) =       0.000413279950

      target function =      -0.947097248759
              le_mean =     -17.212298291704
             les_mean =     296.541855065608
             stat err =       0.000408559878
             autocorr =       1.244111952625
   target nu stat err =       0.000408559878
   target dn stat err =       0.002297643263
      target stat err =       0.003916014432
              std dev =       0.518013384731
             le_variance =       0.268337866760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268386392442
                                         uncertainty =       0.001799871112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268386392442
                                         uncertainty =       0.001799871112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366290777
  error estimate for blocks of size 2^( 2) =       0.000380415059
  error estimate for blocks of size 2^( 3) =       0.000393066149
  error estimate for blocks of size 2^( 4) =       0.000402215289
  error estimate for blocks of size 2^( 5) =       0.000408007651
  error estimate for blocks of size 2^( 6) =       0.000410736621
  error estimate for blocks of size 2^( 7) =       0.000413279950

      target function =      -0.947097248759
              le_mean =     -17.212298291704
             les_mean =     296.541855065608
             stat err =       0.000408559878
             autocorr =       1.244111952625
   target nu stat err =       0.000408559878
   target dn stat err =       0.002297643263
      target stat err =       0.003916014432
              std dev =       0.518013384731
             le_variance =       0.268337866760


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947097248759        initial  <--
     2.3283e+58     2.3283e+59             0.0000e+00        -0.947097248759
     9.3132e+58     9.3132e+59             0.0000e+00        -0.947097248759
     3.7253e+59     3.7253e+60             0.0000e+00        -0.947097248759

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0348
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9468e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2167
    reference variance = 0.264802
====================================================
  Execution time = 1.4116e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8375e-01
  Total weights = 1.957466852e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5236e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266065535653
                                         uncertainty =       0.001965021310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266065535653
                                         uncertainty =       0.001965021310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364745399
  error estimate for blocks of size 2^( 2) =       0.000378712322
  error estimate for blocks of size 2^( 3) =       0.000391752867
  error estimate for blocks of size 2^( 4) =       0.000401412524
  error estimate for blocks of size 2^( 5) =       0.000406564660
  error estimate for blocks of size 2^( 6) =       0.000409733561
  error estimate for blocks of size 2^( 7) =       0.000411439281

      target function =      -0.938544816763
              le_mean =     -17.212242558525
             les_mean =     296.545043983499
             stat err =       0.000407287507
             autocorr =       1.246873895016
   target nu stat err =       0.000407287507
   target dn stat err =       0.005536057602
      target stat err =       0.009134385099
              std dev =       0.515827890124
             le_variance =       0.266078412230


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721224255853e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+59, overlap shift 2.3283e+60 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938632787651       residual = 3.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938632787651       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938632787651       residual = 7.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 1.22e+04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+59 is 1.013976e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+59, overlap shift 9.3132e+60 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938632787651       residual = 3.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938632787651       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938632787651       residual = 7.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 1.22e+04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+59 is 2.534939e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+60, overlap shift 3.7253e+61 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938632787651       residual = 3.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938632787651       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938632787651       residual = 7.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =       0.000000000000       residual = 1.22e+04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+60 is 6.337348e-65

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.339245 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6647e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.119
    reference variance = 0.275767
====================================================
  Execution time = 1.4154e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7685e-01
  Total weights = 1.9575e+06
  Execution time = 2.2444e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266636273098
                                         uncertainty =       0.001462920799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266636273098
                                         uncertainty =       0.001462920799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365135436
  error estimate for blocks of size 2^( 2) =       0.000379201920
  error estimate for blocks of size 2^( 3) =       0.000391794962
  error estimate for blocks of size 2^( 4) =       0.000400335818
  error estimate for blocks of size 2^( 5) =       0.000405980792
  error estimate for blocks of size 2^( 6) =       0.000410481316
  error estimate for blocks of size 2^( 7) =       0.000411786157

      target function =      -0.950087177820
              le_mean =     -17.211414833349
             les_mean =     296.509649664884
             stat err =       0.000407146021
             autocorr =       1.243347209505
   target nu stat err =       0.000407146021
   target dn stat err =       0.001919258578
      target stat err =       0.003309457531
              std dev =       0.516379485290
             le_variance =       0.266647772829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266636273098
                                         uncertainty =       0.001462920799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266636273098
                                         uncertainty =       0.001462920799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365135436
  error estimate for blocks of size 2^( 2) =       0.000379201920
  error estimate for blocks of size 2^( 3) =       0.000391794962
  error estimate for blocks of size 2^( 4) =       0.000400335818
  error estimate for blocks of size 2^( 5) =       0.000405980792
  error estimate for blocks of size 2^( 6) =       0.000410481316
  error estimate for blocks of size 2^( 7) =       0.000411786157

      target function =      -0.950087177820
              le_mean =     -17.211414833349
             les_mean =     296.509649664884
             stat err =       0.000407146021
             autocorr =       1.243347209505
   target nu stat err =       0.000407146021
   target dn stat err =       0.001919258578
      target stat err =       0.003309457531
              std dev =       0.516379485290
             le_variance =       0.266647772829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266636273098
                                         uncertainty =       0.001462920799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266636273098
                                         uncertainty =       0.001462920799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365135436
  error estimate for blocks of size 2^( 2) =       0.000379201920
  error estimate for blocks of size 2^( 3) =       0.000391794962
  error estimate for blocks of size 2^( 4) =       0.000400335818
  error estimate for blocks of size 2^( 5) =       0.000405980792
  error estimate for blocks of size 2^( 6) =       0.000410481316
  error estimate for blocks of size 2^( 7) =       0.000411786157

      target function =      -0.950087177820
              le_mean =     -17.211414833349
             les_mean =     296.509649664884
             stat err =       0.000407146021
             autocorr =       1.243347209505
   target nu stat err =       0.000407146021
   target dn stat err =       0.001919258578
      target stat err =       0.003309457531
              std dev =       0.516379485290
             le_variance =       0.266647772829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266636273098
                                         uncertainty =       0.001462920799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266636273098
                                         uncertainty =       0.001462920799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365135436
  error estimate for blocks of size 2^( 2) =       0.000379201920
  error estimate for blocks of size 2^( 3) =       0.000391794962
  error estimate for blocks of size 2^( 4) =       0.000400335818
  error estimate for blocks of size 2^( 5) =       0.000405980792
  error estimate for blocks of size 2^( 6) =       0.000410481316
  error estimate for blocks of size 2^( 7) =       0.000411786157

      target function =      -0.950087177820
              le_mean =     -17.211414833349
             les_mean =     296.509649664884
             stat err =       0.000407146021
             autocorr =       1.243347209505
   target nu stat err =       0.000407146021
   target dn stat err =       0.001919258578
      target stat err =       0.003309457531
              std dev =       0.516379485290
             le_variance =       0.266647772829


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950087177820        initial  <--
     2.3283e+59     2.3283e+60             1.0140e-63        -0.950087177820
     9.3132e+59     9.3132e+60             2.5349e-64        -0.950087177820
     3.7253e+60     3.7253e+61             6.3373e-65        -0.950087177820

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0093
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.181
    reference variance = 0.207097
====================================================
  Execution time = 1.6535e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7770e-01
  Total weights = 1.957232338e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267310287984
                                         uncertainty =       0.001498554256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267310287984
                                         uncertainty =       0.001498554256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365556393
  error estimate for blocks of size 2^( 2) =       0.000379476038
  error estimate for blocks of size 2^( 3) =       0.000392251683
  error estimate for blocks of size 2^( 4) =       0.000401838829
  error estimate for blocks of size 2^( 5) =       0.000406579296
  error estimate for blocks of size 2^( 6) =       0.000409656900
  error estimate for blocks of size 2^( 7) =       0.000411306753

      target function =      -0.948681100237
              le_mean =     -17.212316798708
             les_mean =     296.541551854663
             stat err =       0.000407345444
             autocorr =       1.241700795673
   target nu stat err =       0.000407345444
   target dn stat err =       0.001838553582
      target stat err =       0.003173300319
              std dev =       0.516974809424
             le_variance =       0.267262953579


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721231679871e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+60, overlap shift 2.3283e+61 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948690690613       residual = 9.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948690690613       residual = 9.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+60, overlap shift 9.3132e+61 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948690690613       residual = 9.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948690690613       residual = 9.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+61, overlap shift 3.7253e+62 and omega -1.7748e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948690690613       residual = 9.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948690690613       residual = 9.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.340316 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9029e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.1843
    reference variance = 0.391349
====================================================
  Execution time = 1.3563e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7927e-01
  Total weights = 1.9574e+06
  Execution time = 1.8288e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265898923811
                                         uncertainty =       0.001297878625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265898923811
                                         uncertainty =       0.001297878625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364609017
  error estimate for blocks of size 2^( 2) =       0.000378851669
  error estimate for blocks of size 2^( 3) =       0.000391408337
  error estimate for blocks of size 2^( 4) =       0.000400844921
  error estimate for blocks of size 2^( 5) =       0.000406995926
  error estimate for blocks of size 2^( 6) =       0.000411610493
  error estimate for blocks of size 2^( 7) =       0.000411055629

      target function =      -0.946030286182
              le_mean =     -17.212047521718
             les_mean =     296.533852344042
             stat err =       0.000407626742
             autocorr =       1.249886356386
   target nu stat err =       0.000407626742
   target dn stat err =       0.002773181559
      target stat err =       0.004688329931
              std dev =       0.515635016134
             le_variance =       0.265879469863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265898923811
                                         uncertainty =       0.001297878625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265898923811
                                         uncertainty =       0.001297878625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364609017
  error estimate for blocks of size 2^( 2) =       0.000378851669
  error estimate for blocks of size 2^( 3) =       0.000391408337
  error estimate for blocks of size 2^( 4) =       0.000400844921
  error estimate for blocks of size 2^( 5) =       0.000406995926
  error estimate for blocks of size 2^( 6) =       0.000411610493
  error estimate for blocks of size 2^( 7) =       0.000411055629

      target function =      -0.946030286182
              le_mean =     -17.212047521718
             les_mean =     296.533852344042
             stat err =       0.000407626742
             autocorr =       1.249886356386
   target nu stat err =       0.000407626742
   target dn stat err =       0.002773181559
      target stat err =       0.004688329931
              std dev =       0.515635016134
             le_variance =       0.265879469863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265898923811
                                         uncertainty =       0.001297878625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265898923811
                                         uncertainty =       0.001297878625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364609017
  error estimate for blocks of size 2^( 2) =       0.000378851669
  error estimate for blocks of size 2^( 3) =       0.000391408337
  error estimate for blocks of size 2^( 4) =       0.000400844921
  error estimate for blocks of size 2^( 5) =       0.000406995926
  error estimate for blocks of size 2^( 6) =       0.000411610493
  error estimate for blocks of size 2^( 7) =       0.000411055629

      target function =      -0.946030286182
              le_mean =     -17.212047521718
             les_mean =     296.533852344042
             stat err =       0.000407626742
             autocorr =       1.249886356386
   target nu stat err =       0.000407626742
   target dn stat err =       0.002773181559
      target stat err =       0.004688329931
              std dev =       0.515635016134
             le_variance =       0.265879469863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265898923811
                                         uncertainty =       0.001297878625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265898923811
                                         uncertainty =       0.001297878625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364609017
  error estimate for blocks of size 2^( 2) =       0.000378851669
  error estimate for blocks of size 2^( 3) =       0.000391408337
  error estimate for blocks of size 2^( 4) =       0.000400844921
  error estimate for blocks of size 2^( 5) =       0.000406995926
  error estimate for blocks of size 2^( 6) =       0.000411610493
  error estimate for blocks of size 2^( 7) =       0.000411055629

      target function =      -0.946030286182
              le_mean =     -17.212047521718
             les_mean =     296.533852344042
             stat err =       0.000407626742
             autocorr =       1.249886356386
   target nu stat err =       0.000407626742
   target dn stat err =       0.002773181559
      target stat err =       0.004688329931
              std dev =       0.515635016134
             le_variance =       0.265879469863


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946030286182        initial  <--
     2.3283e+60     2.3283e+61             0.0000e+00        -0.946030286182
     9.3132e+60     9.3132e+61             0.0000e+00        -0.946030286182
     3.7253e+61     3.7253e+62             0.0000e+00        -0.946030286182

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7895
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -4.141608e-02 3 1  ON 0
ci_002                -3.157722e-02 3 1  ON 1
ci_003                -2.599405e-02 3 1  ON 2
ci_004                 2.363299e-02 3 1  ON 3
ci_005                 2.378621e-02 3 1  ON 4
ci_006                -2.078764e-02 3 1  ON 5
ci_007                -2.052495e-02 3 1  ON 6
ci_008                -8.640566e-03 3 1  ON 7
ci_009                -1.451204e-02 3 1  ON 8
ci_010                -9.553445e-03 3 1  ON 9
ci_011                -1.048530e-02 3 1  ON 10
ci_012                -1.003778e-02 3 1  ON 11
ci_013                -1.994753e-02 3 1  ON 12
ci_014                 1.253799e-02 3 1  ON 13
ci_015                 1.260884e-02 3 1  ON 14
ci_016                 1.696085e-02 3 1  ON 15
ci_017                 1.639234e-02 3 1  ON 16
ci_018                 1.001457e-02 3 1  ON 17
ci_019                 1.008119e-02 3 1  ON 18
ci_020                 1.709709e-02 3 1  ON 19
ci_021                 1.701190e-02 3 1  ON 20
ci_022                 9.245258e-03 3 1  ON 21
ci_023                 9.492891e-03 3 1  ON 22
ci_024                 9.663640e-03 3 1  ON 23
ci_025                 9.459863e-03 3 1  ON 24
ci_026                 1.098875e-02 3 1  ON 25
ci_027                 1.138047e-02 3 1  ON 26
ci_028                -1.494850e-02 3 1  ON 27
ci_029                -1.538012e-02 3 1  ON 28
ci_030                -9.441170e-03 3 1  ON 29
ci_031                -8.993587e-03 3 1  ON 30
ci_032                -1.483589e-02 3 1  ON 31
ci_033                 5.723541e-03 3 1  ON 32
ci_034                 5.515350e-03 3 1  ON 33
ci_035                -5.026953e-03 3 1  ON 34
ci_036                -1.249019e-02 3 1  ON 35
ci_037                -1.251040e-02 3 1  ON 36
ci_038                 1.686569e-03 3 1  ON 37
ci_039                 1.743698e-03 3 1  ON 38
ci_040                -2.980581e-03 3 1  ON 39
ci_041                 8.806575e-03 3 1  ON 40
ci_042                 8.882020e-03 3 1  ON 41
ci_043                -4.010889e-03 3 1  ON 42
ci_044                -3.979288e-03 3 1  ON 43
ci_045                -3.149276e-03 3 1  ON 44
ci_046                 5.743104e-03 3 1  ON 45
ci_047                 5.639870e-03 3 1  ON 46
ci_048                -1.246439e-02 3 1  ON 47
ci_049                -1.350361e-02 3 1  ON 48
ci_050                 3.495418e-03 3 1  ON 49
ci_051                 3.286762e-03 3 1  ON 50
ci_052                -2.365779e-03 3 1  ON 51
ci_053                -2.455068e-03 3 1  ON 52
ci_054                -2.821737e-03 3 1  ON 53
ci_055                -2.793134e-03 3 1  ON 54
ci_056                 5.297737e-03 3 1  ON 55
ci_057                 5.166686e-03 3 1  ON 56
ci_058                -1.676440e-03 3 1  ON 57
ci_059                -1.950461e-03 3 1  ON 58
ci_060                 4.881282e-03 3 1  ON 59
ci_061                 5.584206e-03 3 1  ON 60
ci_062                -3.639913e-03 3 1  ON 61
ci_063                -4.069845e-03 3 1  ON 62
ci_064                -3.040284e-03 3 1  ON 63
ci_065                -4.303199e-03 3 1  ON 64
ci_066                 4.446861e-03 3 1  ON 65
ci_067                 4.331992e-03 3 1  ON 66
ci_068                -4.465775e-03 3 1  ON 67
ci_069                -4.888001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1838e+01 secs
  Total Execution time = 4.0316e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
